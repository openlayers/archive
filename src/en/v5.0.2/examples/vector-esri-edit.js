(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{273:function(e,t,s){"use strict";s.r(t);var r=s(3),n=s(2),o=s(203),a=s(50),c=s(69),i=s(100),u=s(170),d=s(29),l=s(4),p=s(131),f=s(8),g=s(13),v=s(51),m=s(63);const w="https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/PDX_Pedestrian_Districts/FeatureServer/",y=new o.a,I=new g.b({loader:function(e,t,s){const r=w+"0/query/?f=json&returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry="+encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}')+"&geometryType=esriGeometryEnvelope&inSR=102100&outFields=*&outSR=102100";$.ajax({url:r,dataType:"jsonp",success:function(e){if(e.error)alert(e.error.message+"\n"+e.error.details.join("\n"));else{const t=y.readFeatures(e,{featureProjection:s});t.length>0&&I.addFeatures(t)}}})},strategy:Object(p.c)(Object(m.b)({tileSize:512}))}),j=new d.a({source:I}),R=new l.a({source:new v.a({attributions:'Tiles Â© <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"})}),S=new c.c({source:I,type:"Polygon"}),b=new i.a;b.setActive(!1);const F=b.getFeatures(),O=new u.a({features:F});O.setActive(!1);const h=new r.a({interactions:Object(a.a)().extend([S,b,O]),layers:[R,j],target:document.getElementById("map"),view:new n.a({center:Object(f.f)([-122.619,45.512]),zoom:12})}),M=document.getElementById("type");M.onchange=function(){S.setActive("DRAW"===M.value),b.setActive("MODIFY"===M.value),O.setActive("MODIFY"===M.value)};const P={};F.on("add",function(e){e.element.on("change",function(e){P[e.target.getId()]=!0})}),F.on("remove",function(e){const t=e.element,s=t.getId();if(!0===P[s]){const e="["+y.writeFeature(t,{featureProjection:h.getView().getProjection()})+"]",r=w+"0/updateFeatures";$.post(r,{f:"json",features:e}).done(function(e){const t=JSON.parse(e);if(t.updateResults&&t.updateResults.length>0)if(!0!==t.updateResults[0].success){const e=t.updateResults[0].error;alert(e.description+" ("+e.code+")")}else delete P[s]})}}),S.on("drawend",function(e){const t=e.feature,s="["+y.writeFeature(t,{featureProjection:h.getView().getProjection()})+"]";$.post("https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/PDX_Pedestrian_Districts/FeatureServer/0/addFeatures",{f:"json",features:s}).done(function(e){const s=JSON.parse(e);if(s.addResults&&s.addResults.length>0)if(!0===s.addResults[0].success)t.setId(s.addResults[0].objectId),I.clear();else{const e=s.addResults[0].error;alert(e.description+" ("+e.code+")")}})})}},[[273,0]]]);
//# sourceMappingURL=vector-esri-edit.js.map