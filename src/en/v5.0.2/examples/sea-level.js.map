{"version":3,"sources":["webpack:///./sea-level.js"],"names":["key","elevation","_src_ol_source_XYZ_js__WEBPACK_IMPORTED_MODULE_6__","url","crossOrigin","transition","raster","_src_ol_source_Raster_js__WEBPACK_IMPORTED_MODULE_5__","sources","operation","pixels","data","pixel","level","map","_src_ol_Map_js__WEBPACK_IMPORTED_MODULE_0__","target","layers","_src_ol_layer_js__WEBPACK_IMPORTED_MODULE_2__","source","_src_ol_layer_js__WEBPACK_IMPORTED_MODULE_3__","opacity","view","_src_ol_View_js__WEBPACK_IMPORTED_MODULE_1__","center","Object","_src_ol_proj_js__WEBPACK_IMPORTED_MODULE_4__","zoom","control","document","getElementById","output","addEventListener","innerText","value","changed","on","event","locations","getElementsByClassName","i","ii","length","relocate","dataset","getView","setCenter","split","Number","setZoom"],"mappings":"2JAuBA,MAAAA,EAAA,4FACAC,EAAA,IAAAC,EAAA,GACAC,IAAA,gFAAgEH,EAChEI,YAAA,YACAC,WAAA,IAGAC,EAAA,IAAAC,EAAA,GACAC,SAAAP,GACAQ,UAzBA,SAAAC,EAAAC,GACA,MAAAC,EAAAF,EAAA,GACAE,EAAA,KACA,QAAAA,EAAA,WAAAA,EAAA,GAAAA,EAAA,SACAD,EAAAE,OACAD,EAAA,OACAA,EAAA,OACAA,EAAA,OACAA,EAAA,QAEAA,EAAA,MAGA,OAAAA,KAeAE,EAAA,IAAAC,EAAA,GACAC,OAAA,MACAC,QACA,IAAAC,EAAA,GACAC,OAAA,IAAAjB,EAAA,GACAC,IAAA,yGAAsGH,MAGtG,IAAAoB,EAAA,GACAC,QAAA,GACAF,OAAAb,KAGAgB,KAAA,IAAAC,EAAA,GACAC,OAAAC,OAAAC,EAAA,EAAAD,GAAA,mBACAE,KAAA,OAIAC,EAAAC,SAAAC,eAAA,SACAC,EAAAF,SAAAC,eAAA,UACAF,EAAAI,iBAAA,mBACAD,EAAAE,UAAAL,EAAAM,MACA5B,EAAA6B,YAEAJ,EAAAE,UAAAL,EAAAM,MAEA5B,EAAA8B,GAAA,4BAAAC,GACAA,EAAA1B,KAAAE,MAAAe,EAAAM,QAGA,MAAAI,EAAAT,SAAAU,uBAAA,YACA,QAAAC,EAAA,EAAAC,EAAAH,EAAAI,OAAsCF,EAAAC,IAAQD,EAC9CF,EAAAE,GAAAR,iBAAA,QAAAW,GAGA,SAAAA,EAAAN,GACA,MAAA1B,EAAA0B,EAAArB,OAAA4B,QACAtB,EAAAR,EAAA+B,UACAvB,EAAAwB,UAAArB,OAAAC,EAAA,EAAAD,CAAAd,EAAAa,OAAAuB,MAAA,KAAAjC,IAAAkC,UACA1B,EAAA2B,QAAAD,OAAArC,EAAAgB","file":"sea-level.js","sourcesContent":["import Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport {Image as ImageLayer, Tile as TileLayer} from '../src/ol/layer.js';\nimport {fromLonLat} from '../src/ol/proj.js';\nimport RasterSource from '../src/ol/source/Raster.js';\nimport XYZ from '../src/ol/source/XYZ.js';\n\nfunction flood(pixels, data) {\n  const pixel = pixels[0];\n  if (pixel[3]) {\n    const height = -10000 + ((pixel[0] * 256 * 256 + pixel[1] * 256 + pixel[2]) * 0.1);\n    if (height <= data.level) {\n      pixel[0] = 145;\n      pixel[1] = 175;\n      pixel[2] = 186;\n      pixel[3] = 255;\n    } else {\n      pixel[3] = 0;\n    }\n  }\n  return pixel;\n}\n\nconst key = 'pk.eyJ1IjoidHNjaGF1YiIsImEiOiJjaW5zYW5lNHkxMTNmdWttM3JyOHZtMmNtIn0.CDIBD8H-G2Gf-cPkIuWtRg';\nconst elevation = new XYZ({\n  url: 'https://api.mapbox.com/v4/mapbox.terrain-rgb/{z}/{x}/{y}.pngraw?access_token=' + key,\n  crossOrigin: 'anonymous',\n  transition: 0\n});\n\nconst raster = new RasterSource({\n  sources: [elevation],\n  operation: flood\n});\n\nconst map = new Map({\n  target: 'map',\n  layers: [\n    new TileLayer({\n      source: new XYZ({\n        url: 'https://api.mapbox.com/styles/v1/tschaub/ciutc102t00c62js5fqd47kqw/tiles/256/{z}/{x}/{y}?access_token=' + key\n      })\n    }),\n    new ImageLayer({\n      opacity: 0.6,\n      source: raster\n    })\n  ],\n  view: new View({\n    center: fromLonLat([-122.3267, 37.8377]),\n    zoom: 11\n  })\n});\n\nconst control = document.getElementById('level');\nconst output = document.getElementById('output');\ncontrol.addEventListener('input', function() {\n  output.innerText = control.value;\n  raster.changed();\n});\noutput.innerText = control.value;\n\nraster.on('beforeoperations', function(event) {\n  event.data.level = control.value;\n});\n\nconst locations = document.getElementsByClassName('location');\nfor (let i = 0, ii = locations.length; i < ii; ++i) {\n  locations[i].addEventListener('click', relocate);\n}\n\nfunction relocate(event) {\n  const data = event.target.dataset;\n  const view = map.getView();\n  view.setCenter(fromLonLat(data.center.split(',').map(Number)));\n  view.setZoom(Number(data.zoom));\n}\n"],"sourceRoot":""}