(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{268:function(e,t,s){"use strict";s.r(t);var r=s(5),n=s(4),o=s(183),c=s(31),a=s(10),i=s(139),u=s(7),d=s(22),l=s(54),p=s(67);const f="https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/PDX_Pedestrian_Districts/FeatureServer/",g=new o.a,v=new d.b({loader:function(e,t,s){const r=f+"0/query/?f=json&returnGeometry=true&spatialRel=esriSpatialRelIntersects&geometry="+encodeURIComponent('{"xmin":'+e[0]+',"ymin":'+e[1]+',"xmax":'+e[2]+',"ymax":'+e[3]+',"spatialReference":{"wkid":102100}}')+"&geometryType=esriGeometryEnvelope&inSR=102100&outFields=*&outSR=102100";$.ajax({url:r,dataType:"jsonp",success:function(e){if(e.error)alert(e.error.message+"\n"+e.error.details.join("\n"));else{const t=g.readFeatures(e,{featureProjection:s});t.length>0&&v.addFeatures(t)}}})},strategy:Object(i.c)(Object(p.b)({tileSize:512}))}),m=new a.e({source:v}),w=new a.d({source:new l.a({attributions:'Tiles Â© <a href="https://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer">ArcGIS</a>',url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"})}),y=new c.d({source:v,type:"Polygon"}),I=new c.i;I.setActive(!1);const j=I.getFeatures(),R=new c.e({features:j});R.setActive(!1);const S=new r.a({interactions:Object(c.l)().extend([y,I,R]),layers:[w,m],target:document.getElementById("map"),view:new n.a({center:Object(u.g)([-122.619,45.512]),zoom:12})}),b=document.getElementById("type");b.onchange=function(){y.setActive("DRAW"===b.value),I.setActive("MODIFY"===b.value),R.setActive("MODIFY"===b.value)};const F={};j.on("add",function(e){e.element.on("change",function(e){F[e.target.getId()]=!0})}),j.on("remove",function(e){const t=e.element,s=t.getId();if(!0===F[s]){const e="["+g.writeFeature(t,{featureProjection:S.getView().getProjection()})+"]",r=f+"0/updateFeatures";$.post(r,{f:"json",features:e}).done(function(e){const t=JSON.parse(e);if(t.updateResults&&t.updateResults.length>0)if(!0!==t.updateResults[0].success){const e=t.updateResults[0].error;alert(e.description+" ("+e.code+")")}else delete F[s]})}}),y.on("drawend",function(e){const t=e.feature,s="["+g.writeFeature(t,{featureProjection:S.getView().getProjection()})+"]";$.post("https://services.arcgis.com/rOo16HdIMeOBI4Mb/arcgis/rest/services/PDX_Pedestrian_Districts/FeatureServer/0/addFeatures",{f:"json",features:s}).done(function(e){const s=JSON.parse(e);if(s.addResults&&s.addResults.length>0)if(!0===s.addResults[0].success)t.setId(s.addResults[0].objectId),v.clear();else{const e=s.addResults[0].error;alert(e.description+" ("+e.code+")")}})})}},[[268,0]]]);
//# sourceMappingURL=vector-esri-edit.js.map