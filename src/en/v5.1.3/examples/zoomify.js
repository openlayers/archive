(window.webpackJsonp=window.webpackJsonp||[]).push([[166],{402:function(e,t,i){"use strict";i.r(t);var r=i(3),o=i(2),n=i(4),a=i(130),c=i(180),s=i(17),u=i(78),l=i(22),p=i(25),h=i(1),f=i(56),g=i(90),v=i(107),m={DEFAULT:"default",TRUNCATED:"truncated"},z=function(e){function t(t,i,r,o,n,a,c){e.call(this,i,r,o,n,a,c),this.zoomifyImage_=null,this.tileSize_=Object(f.d)(t.getTileSize(i[0]))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(c.a);z.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var e=c.a.prototype.getImage.call(this);if(this.state==s.a.LOADED){var t=this.tileSize_;if(e.width==t[0]&&e.height==t[1])return this.zoomifyImage_=e,e;var i=Object(p.a)(t[0],t[1]);return i.drawImage(e,0,0),this.zoomifyImage_=i.canvas,i.canvas}return e};var d=function(e){function t(t){var i=t||{},r=i.size,o=void 0!==i.tierSizeCalculation?i.tierSizeCalculation:m.DEFAULT,n=r[0],c=r[1],s=i.extent||[0,-r[1],r[0],0],p=[],f=i.tileSize||a.b,g=f;switch(o){case m.DEFAULT:for(;n>g||c>g;)p.push([Math.ceil(n/g),Math.ceil(c/g)]),g+=g;break;case m.TRUNCATED:for(var d=n,y=c;d>g||y>g;)p.push([Math.ceil(d/g),Math.ceil(y/g)]),d>>=1,y>>=1;break;default:Object(l.a)(!1,53)}p.push([1,1]),p.reverse();for(var T=[1],b=[0],w=1,O=p.length;w<O;w++)T.push(1<<w),b.push(p[w-1][0]*p[w-1][1]+b[w-1]);T.reverse();var _=new v.a({tileSize:f,extent:s,origin:Object(h.C)(s),resolutions:T}),D=i.url;D&&-1==D.indexOf("{TileGroup}")&&-1==D.indexOf("{tileIndex}")&&(D+="{TileGroup}/{z}-{x}-{y}.jpg");var I=Object(u.c)(D);var j=Object(u.b)(I.map(function(e){return function(t,i,r){if(t){var o=t[0],n=t[1],a=-t[2]-1,c=n+a*p[o][0],s=_.getTileSize(o),u={z:o,x:n,y:a,tileIndex:c,TileGroup:"TileGroup"+((c+b[o])/s|0)};return e.replace(/\{(\w+?)\}/g,function(e,t){return u[t]})}}})),S=z.bind(null,_);e.call(this,{attributions:i.attributions,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,tileClass:S,tileGrid:_,tileUrlFunction:j,transition:i.transition})}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(g.a),y="http://vips.vtech.fr/cgi-bin/iipsrv.fcgi?zoomify=/mnt/MD1/AD00/plan_CHU-4HD-01/FOND.TIF/",T=new n.a({source:new d({url:y,size:[9911,6100],crossOrigin:"anonymous"})}),b=[0,-6100,9911,0];new r.a({layers:[T],target:"map",view:new o.a({resolutions:T.getSource().getTileGrid().getResolutions(),extent:b})}).getView().fit(b),document.getElementById("zoomifyProtocol").addEventListener("change",function(e){var t=e.currentTarget.value;"iip"===t?T.setSource(new d({url:"http://vips.vtech.fr/cgi-bin/iipsrv.fcgi?FIF=/mnt/MD1/AD00/plan_CHU-4HD-01/FOND.TIF&JTL={z},{tileIndex}",size:[9911,6100],crossOrigin:"anonymous"})):"zoomify"===t&&T.setSource(new d({url:y,size:[9911,6100],crossOrigin:"anonymous"}))})}},[[402,0]]]);
//# sourceMappingURL=zoomify.js.map