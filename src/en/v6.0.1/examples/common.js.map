{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///../src/ol/xml.js","webpack:///../src/ol/extent.js","webpack:///../src/ol/centerconstraint.js","webpack:///../src/ol/resolutionconstraint.js","webpack:///../src/ol/View.js","webpack:///../src/ol/Map.js","webpack:///../src/ol/proj/epsg3857.js","webpack:///../src/ol/proj/epsg4326.js","webpack:///../src/ol/proj/projections.js","webpack:///../src/ol/proj.js","webpack:///../src/ol/layer/BaseTile.js","webpack:///../src/ol/layer/Tile.js","webpack:///../src/ol/format/xsd.js","webpack:///../src/ol/geom/GeometryType.js","webpack:///../src/ol/util.js","webpack:///../src/ol/source/OSM.js","webpack:///../src/ol/source/Vector.js","webpack:///../src/ol/style/Style.js","webpack:///../src/ol/obj.js","webpack:///../src/ol/events/EventType.js","webpack:///../src/ol/array.js","webpack:///../src/ol/math.js","webpack:///../src/ol/TileState.js","webpack:///../src/ol/events.js","webpack:///../src/ol/transform.js","webpack:///../src/ol/style/Stroke.js","webpack:///../src/ol/asserts.js","webpack:///../src/ol/geom/GeometryLayout.js","webpack:///../src/ol/layer/Vector.js","webpack:///../src/ol/style/Fill.js","webpack:///../src/ol/Feature.js","webpack:///../src/ol/render/canvas/LabelCache.js","webpack:///../src/ol/render/canvas.js","webpack:///../src/ol/geom/Point.js","webpack:///../src/ol/render/canvas/Instruction.js","webpack:///../src/ol/coordinate.js","webpack:///../src/ol/dom.js","webpack:///../src/ol/ImageState.js","webpack:///../src/ol/format/GeoJSON.js","webpack:///../src/ol/geom/Polygon.js","webpack:///../src/ol/geom/LineString.js","webpack:///../src/ol/Object.js","webpack:///../src/ol/functions.js","webpack:///../src/ol/events/condition.js","webpack:///../src/ol/MapBrowserEventType.js","webpack:///../src/ol/format/Feature.js","webpack:///../src/ol/source/BingMaps.js","webpack:///../src/ol/css.js","webpack:///../src/ol/render/canvas/BuilderType.js","webpack:///../src/ol/events/Event.js","webpack:///../src/ol/source/State.js","webpack:///../src/ol/ViewHint.js","webpack:///../src/ol/style/Circle.js","webpack:///../src/ol/source/XYZ.js","webpack:///../src/ol/Kinetic.js","webpack:///../src/ol/interaction/DoubleClickZoom.js","webpack:///../src/ol/interaction/DragPan.js","webpack:///../src/ol/interaction/DragRotate.js","webpack:///../src/ol/interaction/DragZoom.js","webpack:///../src/ol/events/KeyCode.js","webpack:///../src/ol/interaction/KeyboardPan.js","webpack:///../src/ol/interaction/KeyboardZoom.js","webpack:///../src/ol/interaction/MouseWheelZoom.js","webpack:///../src/ol/interaction/PinchRotate.js","webpack:///../src/ol/interaction.js","webpack:///../src/ol/control/Rotate.js","webpack:///../src/ol/control/Zoom.js","webpack:///../src/ol/control.js","webpack:///../src/ol/format/GMLBase.js","webpack:///../src/ol/source/TileJSON.js","webpack:///../src/ol/tilecoord.js","webpack:///../src/ol/easing.js","webpack:///../src/ol/size.js","webpack:///../src/ol/layer/Property.js","webpack:///../src/ol/interaction/Pointer.js","webpack:///../src/ol/proj/Units.js","webpack:///../src/ol/tilegrid.js","webpack:///../src/ol/CollectionEventType.js","webpack:///../src/ol/Collection.js","webpack:///../src/ol/render/canvas/Immediate.js","webpack:///../src/ol/render.js","webpack:///../src/ol/source/Stamen.js","webpack:///../src/ol/interaction/Draw.js","webpack:///../node_modules/proj4/lib/global.js","webpack:///../node_modules/proj4/lib/constants/values.js","webpack:///../node_modules/proj4/lib/constants/PrimeMeridian.js","webpack:///../node_modules/proj4/lib/constants/units.js","webpack:///../node_modules/proj4/lib/match.js","webpack:///../node_modules/proj4/lib/projString.js","webpack:///../node_modules/wkt-parser/parser.js","webpack:///../node_modules/wkt-parser/process.js","webpack:///../node_modules/wkt-parser/index.js","webpack:///../node_modules/proj4/lib/defs.js","webpack:///../node_modules/proj4/lib/parseCode.js","webpack:///../node_modules/proj4/lib/extend.js","webpack:///../node_modules/proj4/lib/common/msfnz.js","webpack:///../node_modules/proj4/lib/common/sign.js","webpack:///../node_modules/proj4/lib/common/adjust_lon.js","webpack:///../node_modules/proj4/lib/common/tsfnz.js","webpack:///../node_modules/proj4/lib/common/phi2z.js","webpack:///../node_modules/proj4/lib/projections/longlat.js","webpack:///../node_modules/proj4/lib/projections.js","webpack:///../node_modules/proj4/lib/projections/merc.js","webpack:///../node_modules/proj4/lib/constants/Ellipsoid.js","webpack:///../node_modules/proj4/lib/constants/Datum.js","webpack:///../node_modules/proj4/lib/datum.js","webpack:///../node_modules/proj4/lib/Proj.js","webpack:///../node_modules/proj4/lib/deriveConstants.js","webpack:///../node_modules/proj4/lib/datum_transform.js","webpack:///../node_modules/proj4/lib/datumUtils.js","webpack:///../node_modules/proj4/lib/adjust_axis.js","webpack:///../node_modules/proj4/lib/common/toPoint.js","webpack:///../node_modules/proj4/lib/checkSanity.js","webpack:///../node_modules/proj4/lib/transform.js","webpack:///../node_modules/proj4/lib/core.js","webpack:///../node_modules/mgrs/mgrs.js","webpack:///../node_modules/proj4/lib/Point.js","webpack:///../node_modules/proj4/lib/common/pj_enfn.js","webpack:///../node_modules/proj4/lib/common/pj_mlfn.js","webpack:///../node_modules/proj4/lib/common/pj_inv_mlfn.js","webpack:///../node_modules/proj4/lib/projections/tmerc.js","webpack:///../node_modules/proj4/lib/common/sinh.js","webpack:///../node_modules/proj4/lib/common/hypot.js","webpack:///../node_modules/proj4/lib/common/asinhy.js","webpack:///../node_modules/proj4/lib/common/log1py.js","webpack:///../node_modules/proj4/lib/common/gatg.js","webpack:///../node_modules/proj4/lib/common/clens.js","webpack:///../node_modules/proj4/lib/common/clens_cmplx.js","webpack:///../node_modules/proj4/lib/common/cosh.js","webpack:///../node_modules/proj4/lib/projections/etmerc.js","webpack:///../node_modules/proj4/lib/common/adjust_zone.js","webpack:///../node_modules/proj4/lib/projections/utm.js","webpack:///../node_modules/proj4/lib/common/srat.js","webpack:///../node_modules/proj4/lib/projections/gauss.js","webpack:///../node_modules/proj4/lib/projections/sterea.js","webpack:///../node_modules/proj4/lib/projections/stere.js","webpack:///../node_modules/proj4/lib/projections/somerc.js","webpack:///../node_modules/proj4/lib/projections/omerc.js","webpack:///../node_modules/proj4/lib/projections/lcc.js","webpack:///../node_modules/proj4/lib/projections/krovak.js","webpack:///../node_modules/proj4/lib/common/mlfn.js","webpack:///../node_modules/proj4/lib/common/e0fn.js","webpack:///../node_modules/proj4/lib/common/e1fn.js","webpack:///../node_modules/proj4/lib/common/e2fn.js","webpack:///../node_modules/proj4/lib/common/e3fn.js","webpack:///../node_modules/proj4/lib/common/gN.js","webpack:///../node_modules/proj4/lib/common/adjust_lat.js","webpack:///../node_modules/proj4/lib/common/imlfn.js","webpack:///../node_modules/proj4/lib/projections/cass.js","webpack:///../node_modules/proj4/lib/common/qsfnz.js","webpack:///../node_modules/proj4/lib/projections/laea.js","webpack:///../node_modules/proj4/lib/common/asinz.js","webpack:///../node_modules/proj4/lib/projections/aea.js","webpack:///../node_modules/proj4/lib/projections/gnom.js","webpack:///../node_modules/proj4/lib/common/iqsfnz.js","webpack:///../node_modules/proj4/lib/projections/cea.js","webpack:///../node_modules/proj4/lib/projections/eqc.js","webpack:///../node_modules/proj4/lib/projections/poly.js","webpack:///../node_modules/proj4/lib/projections/nzmg.js","webpack:///../node_modules/proj4/lib/projections/mill.js","webpack:///../node_modules/proj4/lib/projections/sinu.js","webpack:///../node_modules/proj4/lib/projections/moll.js","webpack:///../node_modules/proj4/lib/projections/eqdc.js","webpack:///../node_modules/proj4/lib/projections/vandg.js","webpack:///../node_modules/proj4/lib/projections/aeqd.js","webpack:///../node_modules/proj4/lib/projections/ortho.js","webpack:///../node_modules/proj4/lib/projections/qsc.js","webpack:///../node_modules/proj4/lib/projections/robin.js","webpack:///../node_modules/proj4/projs.js","webpack:///../node_modules/proj4/lib/index.js","webpack:///../src/ol/source/TileWMS.js","webpack:///../src/ol/layer/BaseImage.js","webpack:///../src/ol/layer/Image.js","webpack:///../src/ol/proj/Projection.js","webpack:///../src/ol/geom/MultiLineString.js","webpack:///../src/ol/geom/MultiPoint.js","webpack:///../src/ol/control/Control.js","webpack:///../src/ol/has.js","webpack:///../src/ol/style/Text.js","webpack:///../src/ol/style/IconOrigin.js","webpack:///../src/ol/geom/SimpleGeometry.js","webpack:///../src/ol/interaction/Interaction.js","webpack:///../src/ol/Overlay.js","webpack:///../src/ol/geom/flat/transform.js","webpack:///../src/ol/extent/Relationship.js","webpack:///../src/ol/geom/MultiPolygon.js","webpack:///../src/ol/reproj/Tile.js","webpack:///../src/ol/source/TileImage.js","webpack:///../src/ol/tileurlfunction.js","webpack:///../src/ol/geom/flat/deflate.js","webpack:///../src/ol/layer/Layer.js","webpack:///../src/ol/geom/flat/inflate.js","webpack:///../src/ol/tilegrid/TileGrid.js","webpack:///../src/ol/reproj/common.js","webpack:///../src/ol/webgl/ShaderBuilder.js","webpack:///../src/ol/MapProperty.js","webpack:///../src/ol/style/IconAnchorUnits.js","webpack:///../src/ol/OverlayPositioning.js","webpack:///../src/ol/style/IconImage.js","webpack:///../src/ol/style/Icon.js","webpack:///../src/ol/VectorRenderTile.js","webpack:///../src/ol/VectorTile.js","webpack:///../src/ol/source/VectorTile.js","webpack:///../src/ol/uri.js","webpack:///../src/ol/source/WMTSRequestEncoding.js","webpack:///../src/ol/source/WMTS.js","webpack:///../src/ol/geom/flat/closest.js","webpack:///../src/ol/reproj/Image.js","webpack:///../src/ol/source/Image.js","webpack:///../src/ol/format/KML.js","webpack:///../src/ol/layer/VectorTileRenderType.js","webpack:///../src/ol/renderer/canvas/VectorTileLayer.js","webpack:///../src/ol/layer/VectorTile.js","webpack:///../src/ol/format/FormatType.js","webpack:///../src/ol/colorlike.js","webpack:///../src/ol/source/VectorEventType.js","webpack:///../src/ol/ViewProperty.js","webpack:///../src/ol/source/ImageWMS.js","webpack:///../src/ol/Observable.js","webpack:///../src/ol/string.js","webpack:///../src/ol/events/Target.js","webpack:///../src/ol/Disposable.js","webpack:///../src/ol/geom/flat/simplify.js","webpack:///../src/ol/color.js","webpack:///../src/ol/Image.js","webpack:///../src/ol/Tile.js","webpack:///../src/ol/loadingstrategy.js","webpack:///../src/ol/format/XMLFeature.js","webpack:///../src/ol/proj/proj4.js","webpack:///../src/ol/ObjectEventType.js","webpack:///../src/ol/tilegrid/common.js","webpack:///../src/ol/geom/flat/contains.js","webpack:///../src/ol/geom/flat/reverse.js","webpack:///../src/ol/geom/flat/orient.js","webpack:///../src/ol/renderer/vector.js","webpack:///../src/ol/pointer/EventType.js","webpack:///../src/ol/interaction/Select.js","webpack:///../src/ol/render/EventType.js","webpack:///../src/ol/proj/transforms.js","webpack:///../src/ol/style/RegularShape.js","webpack:///../src/ol/render/canvas/Builder.js","webpack:///../src/ol/format/MVT.js","webpack:///../src/ol/MapEventType.js","webpack:///../src/ol/geom/LinearRing.js","webpack:///../src/ol/reproj.js","webpack:///../src/ol/rotationconstraint.js","webpack:///../src/ol/MapBrowserPointerEvent.js","webpack:///../src/ol/layer/TileProperty.js","webpack:///../src/ol/source/common.js","webpack:///../src/ol/source/WMSServerType.js","webpack:///../src/ol/source/Source.js","webpack:///../src/ol/geom/GeometryCollection.js","webpack:///../src/ol/geom/flat/interpolate.js","webpack:///../src/ol/format/XLink.js","webpack:///../node_modules/html-to-image/lib/utils.js","webpack:///../src/ol/geom/flat/intersectsextent.js","webpack:///../src/ol/tilegrid/WMTS.js","webpack:///../src/ol/webgl.js","webpack:///../src/ol/webgl/Buffer.js","webpack:///../src/ol/webgl/ContextEventType.js","webpack:///../src/ol/vec/mat4.js","webpack:///../src/ol/webgl/PostProcessingPass.js","webpack:///../src/ol/webgl/Helper.js","webpack:///../src/ol/renderer/webgl/Layer.js","webpack:///../src/ol/worker/webgl.js","webpack:///../src/ol/webgl/RenderTarget.js","webpack:///../src/ol/renderer/webgl/PointsLayer.js","webpack:///../src/ol/format/OWS.js","webpack:///../src/ol/format/WMTSCapabilities.js","webpack:///../src/ol/sphere.js","webpack:///../src/ol/interaction/Modify.js","webpack:///../src/ol/control/ScaleLine.js","webpack:///../src/ol/interaction/Property.js","webpack:///../src/ol/geom/flat/interiorpoint.js","webpack:///../src/ol/source/Tile.js","webpack:///../src/ol/net.js","webpack:///../src/ol/structs/RBush.js","webpack:///../src/ol/extent/Corner.js","webpack:///../src/ol/TileRange.js","webpack:///../src/ol/source/Raster.js","webpack:///../src/ol/source/Zoomify.js","webpack:///../src/ol/geom/flat/straightchunk.js","webpack:///../src/ol/render/canvas/TextBuilder.js","webpack:///../src/ol/control/MousePosition.js","webpack:///../src/ol/geom/flat/area.js","webpack:///../src/ol/renderer/canvas/Layer.js","webpack:///../src/ol/ImageBase.js","webpack:///../src/ol/format/JSONFeature.js","webpack:///../src/ol/layer/BaseVector.js","webpack:///../src/ol/format/TextFeature.js","webpack:///../src/ol/Geolocation.js","webpack:///../src/ol/format/XML.js","webpack:///../src/ol/style/IconImageCache.js","webpack:///../src/ol/MapEvent.js","webpack:///../src/ol/format/TopoJSON.js","webpack:///../src/ol/interaction/Snap.js","webpack:///../src/ol/geom/flat/textpath.js","webpack:///../src/ol/render/canvas/Executor.js","webpack:///../src/ol/render/canvas/ExecutorGroup.js","webpack:///../src/ol/control/Attribution.js","webpack:///../src/ol/interaction/PinchZoom.js","webpack:///../src/ol/control/ZoomSlider.js","webpack:///../src/ol/render/Box.js","webpack:///../src/ol/interaction/DragBox.js","webpack:///../src/ol/structs/PriorityQueue.js","webpack:///../src/ol/featureloader.js","webpack:///../src/ol/geom/Circle.js","webpack:///../src/ol/interaction/DragRotateAndZoom.js","webpack:///../src/ol/control/FullScreen.js","webpack:///../src/ol/format/GML2.js","webpack:///../src/ol/render/Feature.js","webpack:///../src/ol/AssertionError.js","webpack:///../src/ol/layer/Base.js","webpack:///../src/ol/geom/Geometry.js","webpack:///../src/ol/geom/flat/segments.js","webpack:///../src/ol/structs/LRUCache.js","webpack:///../src/ol/render/Event.js","webpack:///../src/ol/render/VectorContext.js","webpack:///../src/ol/MapBrowserEvent.js","webpack:///../src/ol/TileQueue.js","webpack:///../src/ol/renderer/canvas/TileLayer.js","webpack:///../src/ol/renderer/Layer.js","webpack:///../src/ol/ImageTile.js","webpack:///../src/ol/TileCache.js","webpack:///../src/ol/reproj/Triangulation.js","webpack:///../src/ol/renderer/canvas/ImageLayer.js","webpack:///../node_modules/rbush/rbush.min.js","webpack:///../src/ol/geom/flat/length.js","webpack:///../src/ol/geom/flat/center.js","webpack:///../src/ol/renderer/canvas/VectorLayer.js","webpack:///../src/ol/style/TextPlacement.js","webpack:///../src/ol/style/Image.js","webpack:///../src/ol/ImageCanvas.js","webpack:///../src/ol/interaction/DragAndDrop.js","webpack:///../node_modules/html-to-image/lib/index.js","webpack:///../src/ol/format/WKT.js","webpack:///../src/ol/control/OverviewMap.js","webpack:///../src/ol/source/ImageStatic.js","webpack:///../src/ol/format/EsriJSON.js","webpack:///../src/ol/render/canvas/ImageBuilder.js","webpack:///../src/ol/render/canvas/LineStringBuilder.js","webpack:///../src/ol/render/canvas/PolygonBuilder.js","webpack:///../src/ol/render/canvas/BuilderGroup.js","webpack:///../src/ol/geom/flat/geodesic.js","webpack:///../src/ol/layer/Graticule.js","webpack:///../src/ol/MapBrowserEventHandler.js","webpack:///../src/ol/PluggableMap.js","webpack:///../src/ol/renderer/Map.js","webpack:///../src/ol/renderer/Composite.js","webpack:///../src/ol/source/TileEventType.js","webpack:///../src/ol/source/UrlTile.js","webpack:///../src/ol/layer/Group.js","webpack:///../src/ol/format/GPX.js","webpack:///../src/ol/format/IGC.js","webpack:///../node_modules/@openlayers/pepjs/dist/pep.js","webpack:///../src/ol/renderer/canvas/VectorImageLayer.js","webpack:///../src/ol/layer/VectorImage.js","webpack:///../node_modules/html-to-image/lib/embedResources.js","webpack:///../node_modules/html-to-image/lib/getBlobFromURL.js","webpack:///../node_modules/ieee754/index.js","webpack:///../node_modules/pixelworks/lib/index.js","webpack:///../node_modules/pbf/index.js","webpack:///../src/ol/source/Cluster.js","webpack:///../node_modules/pixelworks/lib/processor.js","webpack:///../node_modules/pixelworks/lib/util.js","webpack:///../node_modules/html-to-image/lib/cloneNode.js","webpack:///../node_modules/html-to-image/lib/clonePseudoElements.js","webpack:///../node_modules/html-to-image/lib/embedWebFonts.js","webpack:///../node_modules/html-to-image/lib/embedImages.js","webpack:///../node_modules/html-to-image/lib/createSvgDataURL.js","webpack:///../node_modules/html-to-image/lib/applyStyleWithOptions.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","DOCUMENT","document","implementation","createDocument","XML_SCHEMA_INSTANCE_URI","createElementNS","namespaceURI","qualifiedName","getAllTextContent","node","normalizeWhitespace","getAllTextContent_","accumulator","nodeType","Node","CDATA_SECTION_NODE","TEXT_NODE","String","nodeValue","replace","let","firstChild","nextSibling","join","isDocument","getAttributeNS","parse","xml","DOMParser","parseFromString","makeArrayExtender","valueReader","opt_this","objectStack","const","undefined","this","array","makeArrayPusher","makeReplacer","makeObjectPropertyPusher","opt_property","localName","makeObjectPropertySetter","makeChildAppender","nodeWriter","appendChild","makeArraySerializer","serializersNS","nodeFactory","serializers","makeSimpleNodeFactory","serialize","opt_nodeName","opt_namespaceURI","fixedNodeName","nodeName","OBJECT_PROPERTY_NODE_FACTORY","makeSequence","orderedKeys","sequence","Array","makeStructureNS","namespaceURIs","structure","opt_structureNS","ii","structureNS","parseNode","parsersNS","firstElementChild","nextElementSibling","parsers","parser","pushParseAndPop","pop","values","opt_keys","pushSerializeAndPop","boundingExtent","coordinates","extent","createEmpty","extendCoordinate","buffer","opt_extent","clone","closestSquaredDistanceXY","x","y","dx","dy","containsCoordinate","coordinate","containsXY","containsExtent","extent1","extent2","coordinateRelationship","minX","minY","maxX","maxY","relationship","UNKNOWN","LEFT","RIGHT","BELOW","ABOVE","INTERSECTING","Infinity","createOrUpdate","createOrUpdateEmpty","createOrUpdateFromCoordinate","createOrUpdateFromCoordinates","extendCoordinates","createOrUpdateFromFlatCoordinates","flatCoordinates","offset","end","stride","extendFlatCoordinates","equals","extend","extendXY","Math","min","max","forEachCorner","callback","val","getBottomLeft","getBottomRight","getTopRight","getTopLeft","getArea","area","isEmpty","getWidth","getHeight","getCenter","getCorner","corner","BOTTOM_LEFT","BOTTOM_RIGHT","TOP_LEFT","TOP_RIGHT","getForViewAndSize","center","resolution","rotation","size","cosRotation","cos","sinRotation","sin","xCos","xSin","yCos","ySin","x0","x1","x2","x3","y0","y1","y2","y3","getIntersection","intersection","intersects","returnOrUpdate","scaleFromCenter","deltaX","deltaY","intersectsSegment","start","startRel","endRel","startX","startY","endX","endY","slope","applyTransform","transformFn","xs","ys","_boundingExtentXYs","createExtent","onlyCenter","smooth","opt_isMoving","viewWidth","viewHeight","ratio","log","none","getViewportClampedResolution","maxExtent","viewportSize","xResolution","yResolution","getSmoothClampedResolution","maxResolution","minResolution","createMinMaxResolution","opt_smooth","opt_maxExtent","direction","cappedMaxRes","DEFAULT_MIN_ZOOM","opt_options","super","options","hints_","animations_","updateAnimationKey_","projection_","projection","targetCenter_","targetResolution_","targetRotation_","applyOptions_","resolutionConstraintInfo","resolutionConstraint","minZoom","maxZoom","zoomFactor","multiWorld","smoothResolutionConstraint","projExtent","getExtent","constrainOnlyCenter","isGlobal","resolutions","constrainResolution","capped","z","floor","createSnapToResolutions","defaultMaxResolution","Units","DEGREES","getMetersPerUnit","pow","defaultMinResolution","power","opt_minResolution","minZoomLevel","ceil","cappedZoomLevel","zoomLevel","newResolution","createSnapToPower","constraint","createResolutionConstraint","maxResolution_","minResolution_","zoomFactor_","resolutions_","minZoom_","centerConstraint","smoothExtentConstraint","createCenterConstraint","rotationConstraint","enableRotation","constrainRotation","createRotationConstraint","constraints_","setRotation","setCenterInternal","setResolution","zoom","setZoom","resolveConstraints","setProperties","options_","getUpdatedOptions_","newOptions","getResolution","getZoom","getCenterInternal","getRotation","animate","var_args","isDef","getAnimating","args","arguments","getProjection","anchor","animateInternal","animationCount","state","animationCallback","Date","now","series","animation","complete","duration","easing","sourceCenter","targetCenter","sourceResolution","targetResolution","getResolutionForZoom","sourceRotation","delta","PI","targetRotation","isNoopAnimation","setHint","ViewHint","ANIMATING","updateAnimations_","getInteracting","INTERACTING","cancelAnimations","cancelAnimationFrame","more","seriesComplete","jj","elapsed","fraction","progress","getSizeFromViewport_","constrainedResolution","calculateCenterZoom","applyTargetState_","constrainedRotation","calculateCenterRotate","filter","Boolean","requestAnimationFrame","currentCenter","currentResolution","opt_rotation","selector","element","querySelector","metrics","getComputedStyle","parseInt","width","height","w","h","abs","ViewProperty","CENTER","getConstraints","getHints","opt_hints","calculateExtent","opt_size","calculateExtentInternal","getMaxResolution","getMinResolution","getMaxZoom","getZoomForResolution","setMaxZoom","getMinZoom","setMinZoom","setConstrainResolution","enabled","RESOLUTION","getResolutions","getResolutionForExtent","getResolutionForExtentInternal","getResolutionForValueFunction","opt_power","ROTATION","getValueForResolutionFunction","getState","nearest","baseLevel","fit","geometryOrExtent","geometry","isArray","getSimplifiedGeometry","getType","GeometryType","CIRCLE","rotate","userProjection","transform","fitInternal","padding","coords","getFlatCoordinates","cosAngle","sinAngle","minRotX","minRotY","maxRotX","maxRotY","getStride","rotX","rotY","isNaN","getConstrainedResolution","centerRotX","centerRotY","getConstrainedCenter","centerOn","position","centerOnInternal","centerX","centerY","adjustCenter","deltaCoordinates","setCenter","adjustCenterInternal","adjustResolution","opt_anchor","adjustResolutionInternal","isMoving","adjustZoom","adjustRotation","adjustRotationInternal","newRotation","hint","changed","opt_doNotCancelAnims","opt_forceMoving","newCenter","set","opt_duration","opt_resolutionDirection","beginInteraction","endInteraction","endInteractionInternal","opt_targetResolution","getConstrainedZoom","targetZoom","opt_direction","targetRes","returnValue","setTimeout","Map","controls","interactions","createRenderer","RADIUS","HALF_SIZE","EXTENT","WORLD_EXTENT","code","units","METERS","global","worldExtent","getPointResolution","point","PROJECTIONS","fromEPSG4326","input","opt_output","opt_dimension","dimension","output","halfSize","tan","atan","exp","METERS_PER_UNIT","opt_axisOrientation","axisOrientation","metersPerUnit","cache","cloneTransform","identityTransform","addProjection","add","getCode","projectionLike","opt_units","pointResolution","getPointResolutionFunc","getUnits","toEPSG4326","getTransformFromProjections","vertices","addEquivalentProjections","projections","forEach","addProjections","source","destination","createProjection","defaultCode","createTransformFromCoordinateTransform","coordTransform","addCoordinateTransforms","forward","inverse","sourceProj","destProj","fromLonLat","opt_projection","toLonLat","lonLat","lon","equivalent","projection1","projection2","equalUnits","sourceProjection","destinationProjection","sourceCode","destinationCode","transformFunc","getTransform","transformExtent","projections2","forwardTransform","inverseTransform","getUserProjection","useGeographic","toUserCoordinate","fromUserCoordinate","destProjection","toUserExtent","fromUserExtent","BaseTile","baseOptions","preload","useInterimTilesOnError","setPreload","setUseInterimTilesOnError","getPreload","TileProperty","PRELOAD","getUseInterimTilesOnError","USE_INTERIM_TILES_ON_ERROR","readBoolean","readBooleanString","string","exec","readDateTime","dateTime","readDecimal","readDecimalString","parseFloat","readNonNegativeInteger","readNonNegativeIntegerString","readString","trim","writeBooleanTextNode","bool","writeStringTextNode","writeCDATASection","createCDATASection","writeDateTimeTextNode","date","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","createTextNode","writeDecimalTextNode","decimal","toPrecision","writeNonNegativeIntegerTextNode","nonNegativeInteger","toString","POINT","LINE_STRING","LINEAR_RING","POLYGON","MULTI_POINT","MULTI_LINE_STRING","MULTI_POLYGON","GEOMETRY_COLLECTION","abstract","Error","uidCounter_","getUid","obj","ol_uid","VERSION","ATTRIBUTION","OSM","attributions","crossOrigin","url","cacheSize","opaque","reprojectionErrorThreshold","tileLoadFunction","wrapX","attributionsCollapsible","VectorSourceEvent","type","opt_feature","feature","VectorSource","READY","loader_","format_","format","overlaps_","overlaps","url_","loader","strategy_","strategy","collection","features","useSpatialIndex","featuresRtree_","loadedExtentsRtree_","nullGeometryFeatures_","idIndex_","uidIndex_","featureChangeKeys_","featuresCollection_","getArray","addFeaturesInternal","bindFeaturesCollection_","addFeature","addFeatureInternal","featureKey","addToIndex_","setupChangeEvents_","getGeometry","insert","dispatchEvent","ADDFEATURE","remove","CHANGE","handleFeatureChange_","PROPERTYCHANGE","valid","id","getId","addFeatures","extents","newFeatures","geometryFeatures","load","modifyingCollection","addEventListener","evt","REMOVEFEATURE","ADD","REMOVE","removeFeature","clear","opt_fast","featureId","removeFeatureInternal","clearEvent","CLEAR","forEachFeature","forEachFeatureAtCoordinateDirect","forEachFeatureInExtent","intersectsCoordinate","forEachInExtent","forEachFeatureIntersectingExtent","intersectsExtent","getFeaturesCollection","getFeatures","getAll","getFeaturesAtCoordinate","getFeaturesInExtent","getInExtent","getClosestFeatureToCoordinate","opt_filter","closestFeature","closestPoint","NaN","minSquaredDistance","previousMinSquaredDistance","closestPointXY","minDistance","sqrt","getFeatureById","getFeatureByUid","uid","getFormat","getOverlaps","getUrl","event","update","sid","removeFromIdIndex_","CHANGEFEATURE","hasFeature","loadFeatures","loadedExtentsRtree","extentsToLoad","loading","extentToLoad","refresh","removeLoadedExtent","removed","setLoader","setUrl","Style","geometry_","geometryFunction_","defaultGeometryFunction","setGeometry","fill_","fill","image_","image","renderer_","renderer","stroke_","stroke","text_","text","zIndex_","zIndex","toFunction","styleFunction","styles","getZIndex","getFill","getImage","getStroke","getText","getRenderer","setRenderer","getGeometryFunction","setFill","setImage","setStroke","setText","setZIndex","defaultStyles","createDefaultStyle","color","radius","createEditingStyle","white","blue","concat","assign","target","var_sources","TypeError","getValues","ERROR","CONTEXTMENU","CLICK","DBLCLICK","DRAGENTER","DRAGOVER","DROP","KEYDOWN","KEYPRESS","LOAD","RESIZE","WHEEL","binarySearch","haystack","needle","opt_comparator","mid","cmp","comparator","numberSafeCompareFunction","low","high","found","a","b","includes","arr","indexOf","linearFindNearest","reverseSubArray","begin","tmp","extension","find","func","arr1","arr2","len1","findIndex","index","every","el","idx","isSorted","opt_func","opt_strict","compare","currentVal","res","clamp","cosh","squaredSegmentDistance","squaredDistance","solveLinearSystem","mat","maxRow","maxEl","absValue","coef","k","toDegrees","angleInRadians","toRadians","angleInDegrees","modulo","lerp","IDLE","LOADING","LOADED","EMPTY","ABORT","listen","listener","opt_once","originalListener","removeEventListener","eventsKey","listenOnce","unlistenByKey","tmp_","reset","multiply","transform1","transform2","a1","b1","c1","d1","e1","f1","a2","b2","c2","d2","e2","f2","e","f","setFromArray","angle","scale","makeScale","translate","compose","dx1","dy1","sx","sy","dx2","dy2","makeInverse","det","Stroke","color_","lineCap_","lineCap","lineDash_","lineDash","lineDashOffset_","lineDashOffset","lineJoin_","lineJoin","miterLimit_","miterLimit","width_","getColor","getLineCap","getLineDash","getLineDashOffset","getLineJoin","getMiterLimit","setColor","setLineCap","setLineDash","setLineDashOffset","setLineJoin","setMiterLimit","setWidth","assert","assertion","errorCode","XY","XYZ","XYM","XYZM","VectorLayer","Fill","Feature","opt_geometryOrProperties","id_","geometryName_","style_","styleFunction_","geometryChangeKey_","handleGeometryChanged_","properties","getProperties","setGeometryName","getGeometryName","style","getStyle","setStyle","getStyleFunction","handleGeometryChange_","createStyleFunction","setId","opt_highWaterMark","consumers","consumer","canvas","consumerId","prune","outer","canExpireCache","peekLastKey","release","measureFont","defaultFont","defaultFillStyle","defaultLineCap","defaultLineDash","defaultLineDashOffset","defaultLineJoin","defaultMiterLimit","defaultStrokeStyle","defaultTextAlign","defaultTextBaseline","defaultPadding","defaultLineWidth","labelCache","checkedFonts","measureContext","textHeights","checkFont","interval","referenceWidth","retries","checked","referenceFonts","len","isAvailable","fontStyle","fontWeight","fontFamily","context","getMeasureContext","available","referenceFont","font","measureText","check","done","split","getCount","clearInterval","fontSpec","families","family","weight","setInterval","div","heights","measureTextHeight","createElement","innerHTML","margin","left","body","offsetHeight","removeChild","measureTextWidth","measureAndCacheTextWidth","measureTextWidths","lines","widths","numLines","currentWidth","rotateAtOffset","offsetX","offsetY","resetTransform","drawImage","opacity","originX","originY","alpha","globalAlpha","setTransform","Point","opt_layout","setCoordinates","layout","getCoordinates","computeExtent","setLayout","Instruction","BEGIN_GEOMETRY","BEGIN_PATH","CLOSE_PATH","CUSTOM","DRAW_CHARS","DRAW_IMAGE","END_GEOMETRY","FILL","MOVE_TO_LINE_TO","SET_FILL_STYLE","SET_STROKE_STYLE","STROKE","fillInstruction","strokeInstruction","beginPathInstruction","closePathInstruction","closestOnCircle","circle","getRadius","closestOnSegment","segment","along","createStringXY","opt_fractionDigits","template","toFixed","toStringXY","degreesToStringHDMS","hemispheres","degrees","normalizedDegrees","dflPrecision","precision","deg","sec","charAt","coordinate1","coordinate2","coord1","coord2","distance","squaredDistanceToSegment","toStringHDMS","createCanvasContext2D","opt_width","opt_height","getContext","outerWidth","offsetWidth","marginLeft","marginRight","outerHeight","marginTop","marginBottom","replaceNode","newNode","oldNode","parent","parentNode","replaceChild","removeNode","removeChildren","lastChild","replaceChildren","children","oldChildren","childNodes","oldChild","newChild","insertBefore","GeoJSON","dataProjection","featureProjection","defaultFeatureProjection","geometryName","extractGeometryName_","extractGeometryName","readFeatureFromObject","geoJSONFeature","readGeometry","readFeaturesFromObject","geoJSONFeatures","readGeometryFromObject","readProjectionFromObject","crs","writeFeatureObject","adaptOptions","writeGeometry","writeFeaturesObject","objects","writeGeometryObject","readPointGeometry","readLineStringGeometry","readPolygonGeometry","readMultiPointGeometry","readMultiLineStringGeometry","readMultiPolygonGeometry","geometries","map","readGeometryCollectionGeometry","geoJSON","writePointGeometry","writeLineStringGeometry","right","rightHanded","writePolygonGeometry","writeMultiPointGeometry","writeMultiLineStringGeometry","writeMultiPolygonGeometry","getGeometriesArray","writeGeometryCollectionGeometry","Polygon","opt_ends","ends_","flatInteriorPointRevision_","flatInteriorPoint_","maxDelta_","maxDeltaRevision_","orientedRevision_","orientedFlatCoordinates_","setFlatCoordinates","appendLinearRing","linearRing","getRevision","getOrientedFlatCoordinates","opt_right","getEnds","getFlatInteriorPoint","flatCenter","getInteriorPoint","getLinearRingCount","getLinearRing","getLinearRings","ends","linearRings","getSimplifiedGeometryInternal","squaredTolerance","simplifiedFlatCoordinates","simplifiedEnds","circular","opt_n","opt_sphereRadius","fromExtent","fromCircle","opt_sides","opt_angle","sides","getLayout","arrayLength","polygon","makeRegular","startAngle","LineString","flatMidpoint_","flatMidpointRevision_","appendCoordinate","forEachSegment","getCoordinateAtM","opt_extrapolate","extrapolate","getCoordinateAt","opt_dest","getLength","getFlatMidpoint","ObjectEvent","oldValue","BaseObject","opt_values","values_","getKeys","keys","notify","eventType","getChangeEventType","opt_silent","unset","changeEventTypeCache","TRUE","FALSE","VOID","memoizeOne","fn","lastResult","lastArgs","lastThis","called","nextArgs","altKeyOnly","mapBrowserEvent","originalEvent","altKey","metaKey","ctrlKey","shiftKey","altShiftKeysOnly","focus","getTargetElement","activeElement","always","mouseActionButton","button","never","pointerMove","singleClick","SINGLECLICK","noModifierKeys","platformModifierKeyOnly","shiftKeyOnly","targetNotEditable","tagName","mouseOnly","pointerEvent","pointerType","primaryAction","isPrimary","POINTERDRAG","POINTERMOVE","POINTERDOWN","POINTERUP","POINTEROVER","POINTEROUT","POINTERENTER","POINTERLEAVE","POINTERCANCEL","FeatureFormat","transformGeometryWithOptions","write","transformed","decimals","round","transformExtentWithOptions","getReadOptions","readProjection","TILE_PIXELS","setWorldExtent","readFeature","readFeatures","writeFeature","writeFeatures","BingMaps","hidpi","tilePixelRatio","transition","hidpi_","culture_","culture","maxZoom_","apiKey_","imagerySet_","imagerySet","handleImageryMetadataResponse","getApiKey","getImagerySet","response","statusCode","statusDescription","authenticationResultCode","resourceSets","resources","resource","zoomMax","tileSize","imageWidth","imageHeight","tileGrid","zoomMin","tileUrlFunction","imageUrlSubdomains","subdomain","quadKeyTileCoord","imageUrl","tileCoord","pixelRatio","charCode","digits","mask","fromCharCode","quadKey","imageryProviders","setAttributions","frameState","viewState","getTileGrid","getZForResolution","zDirection","getTileCoordForCoordAndZ","imageryProvider","intersecting","coverageAreas","coverageArea","bbox","epsg4326Extent","attribution","setState","CLASS_HIDDEN","CLASS_SELECTABLE","CLASS_UNSELECTABLE","CLASS_UNSUPPORTED","CLASS_CONTROL","CLASS_COLLAPSED","getFontParameters","DEFAULT","IMAGE","TEXT","BaseEvent","propagationStopped","stopPropagation","preventDefault","UNDEFINED","CircleStyle","points","setOpacity","getOpacity","setScale","getScale","setRadius","radius_","render","urls","Kinetic","decay","minVelocity","delay","decay_","minVelocity_","delay_","points_","angle_","initialVelocity_","lastIndex","firstIndex","atan2","getDistance","getAngle","stopEvent","MapBrowserEventType","browserEvent","delta_","view","getView","duration_","handleEvent","defaultCondition","stopDown","kinetic_","kinetic","lastCentroid","lastPointersCount_","panning_","condition_","condition","noKinetic_","handleDragEvent","getMap","targetPointers","centroid","handleUpEvent","centerpx","getPixelFromCoordinateInternal","dest","getCoordinateFromPixelInternal","handleDownEvent","Pointer","lastAngle_","getSize","pixel","theta","onBoxEnd","out_","mapExtent","boxPixelExtent","factor","className","minArea","out","UP","DOWN","EventType","keyCode","KeyCode","mapUnitsDelta","pixelDelta_","defaultCondition_","pixelDelta","charCodeAt","Mode","totalDelta_","lastDelta_","maxDelta","timeout_","timeout","useAnchor_","useAnchor","lastAnchor_","startTime_","timeoutId_","mode_","trackpadEventGap_","trackpadTimeoutId_","trackpadDeltaPerZoom_","endInteraction_","sign","wheelEvent","deltaMode","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","clearTimeout","timeLeft","handleWheelZoom_","setMouseAnchor","pointerOptions","anchor_","rotating_","rotationDelta_","threshold_","threshold","rotationDelta","touch0","touch1","clientY","clientX","viewportPosition","getViewport","getBoundingClientRect","top","handlingDownUpSequence","defaults","Collection","altShiftDragRotate","doubleClickZoom","zoomDelta","zoomDuration","dragPan","onFocusOnly","pinchRotate","pinchZoom","PinchZoom","keyboard","mouseWheelZoom","shiftDragZoom","mapEvent","rotation_","autoHide_","contains","classList","label_","label","textContent","tipLabel","setAttribute","title","handleClick_","cssClasses","callResetNorth_","resetNorth","autoHide","resetNorth_","zoomInLabel","zoomOutLabel","zoomInTipLabel","zoomOutTipLabel","inElement","outElement","zoomByDelta_","currentZoom","newZoom","zoomOptions","rotateOptions","Attribution","attributionOptions","GMLNS","ONLY_WHITESPACE_RE","GMLBase","featureType","featureNS","srsName","schemaLocation","FEATURE_COLLECTION_PARSERS","namespace","readFeaturesInternal","child","ft","count","uri","candidate","featureTypes","readFeatureElement","readGeometryElement","getAttribute","GEOMETRY_PARSERS","readFeatureElementInternal","asFeature","test","attributes","_content_","attName","fid","readPoint","readFlatCoordinatesFromNode_","readMultiPoint","MULTIPOINT_PARSERS_","readMultiLineString","lineStrings","MULTILINESTRING_PARSERS_","readMultiPolygon","polygons","MULTIPOLYGON_PARSERS_","pointMemberParser_","POINTMEMBER_PARSERS_","lineStringMemberParser_","LINESTRINGMEMBER_PARSERS_","polygonMemberParser_","POLYGONMEMBER_PARSERS_","readLineString","readFlatLinearRing_","ring","GEOMETRY_FLAT_COORDINATES_PARSERS","readLinearRing","readPolygon","flatLinearRings","FLAT_LINEAR_RINGS_PARSERS","readGeometryFromNode","readFeaturesFromNode","readProjectionFromNode","RING_PARSERS","TileJSON","tileJSON_","tileSize_","jsonp","handleTileJSONResponse","handleTileJSONError","client","XMLHttpRequest","onXHRLoad_","onXHRError_","open","send","tileJSON","status","JSON","responseText","err","getTileJSON","epsg4326Projection","getAttributions","attributionExtent","opt_tileCoord","getKeyZXY","getKey","fromKey","Number","hash","withinExtentAndZ","tileRange","getTileRangeForExtentAndZ","getFullTileRange","easeIn","easeOut","inAndOut","linear","upAndDown","num","hasArea","toSize","OPACITY","VISIBLE","Z_INDEX","MAX_RESOLUTION","MIN_RESOLUTION","MAX_ZOOM","MIN_ZOOM","SOURCE","PointerInteraction","handleMoveEvent","trackedPointers_","updateTrackedPointers_","handledUp","handled","isPointerDraggingEvent","pointerId","pointerEvents","FEET","PIXELS","USFEET","getForProjection","getDefaultTileGrid","createForProjection","setDefaultTileGrid","getTileCoordCenter","projectionExtent","extentFromProjection","worldWidth","worldsAway","createXYZ","xyzOptions","gridOptions","resolutionsFromExtent","opt_maxZoom","opt_tileSize","opt_corner","origin","createForExtent","half","Property","CollectionEvent","opt_element","opt_index","opt_array","unique_","unique","array_","assertUnique_","updateLength_","item","insertAt","elem","removeAt","prev","setAt","opt_except","viewRotation","opt_squaredTolerance","opt_userTransform","context_","pixelRatio_","extent_","transform_","viewRotation_","squaredTolerance_","userTransform_","contextFillState_","contextStrokeState_","contextTextState_","fillState_","strokeState_","imageAnchorX_","imageAnchorY_","imageHeight_","imageOpacity_","imageOriginX_","imageOriginY_","imageRotateWithView_","imageRotation_","imageScale_","imageWidth_","textOffsetX_","textOffsetY_","textRotateWithView_","textRotation_","textScale_","textFillState_","textStrokeState_","textState_","pixelCoordinates_","tmpLocalTransform_","drawImages_","pixelCoordinates","localTransform","drawText_","setContextFillState_","setContextStrokeState_","setContextTextState_","strokeText","fillText","moveToLineTo_","close","moveTo","lineTo","closePath","drawRings_","drawCircle","beginPath","arc","setFillStrokeStyle","setImageStyle","setTextStyle","drawGeometry","drawPoint","drawLineString","drawPolygon","drawMultiPoint","drawMultiLineString","drawMultiPolygon","drawGeometryCollection","drawFeature","simplifyTransformed","flatMidpoint","geometryExtent","flatMidpoints","getFlatMidpoints","flatInteriorPoint","endss","getEndss","flatInteriorPoints","getFlatInteriorPoints","fillState","contextFillState","fillStyle","strokeState","contextStrokeState","lineWidth","strokeStyle","textState","contextTextState","textAlign","textBaseline","fillStyleColor","strokeStyleColor","strokeStyleLineCap","strokeStyleLineDash","strokeStyleLineDashOffset","strokeStyleLineJoin","strokeStyleWidth","strokeStyleMiterLimit","imageStyle","imageAnchor","getAnchor","imageImage","imageOrigin","getOrigin","imageSize","getRotateWithView","textStyle","textFillStyle","textFillStyleColor","textStrokeStyle","textStrokeStyleColor","textStrokeStyleLineCap","textStrokeStyleLineDash","textStrokeStyleLineDashOffset","textStrokeStyleLineJoin","textStrokeStyleWidth","textStrokeStyleMiterLimit","textFont","getFont","textOffsetX","getOffsetX","textOffsetY","getOffsetY","textRotateWithView","textRotation","textScale","textText","textTextAlign","getTextAlign","textTextBaseline","getTextBaseline","toContext","getVectorContext","userTransform","inversePixelTransform","coordinateToPixelTransform","getRenderPixel","renderDeclutterItems","declutterTree","items","declutterItems","zIndexItems","renderDeclutter","ATTRIBUTIONS","LayerConfig","ProviderConfig","Stamen","layer","provider","providerConfig","layerConfig","DrawEventType","DrawEvent","Draw","shouldHandle_","downPx_","downTimeout_","lastDragTime_","freehand_","source_","features_","snapTolerance_","snapTolerance","type_","getMode","stopClick_","stopClick","minPoints_","minPoints","maxPoints_","maxPoints","finishCondition_","finishCondition","geometryFunction","opt_geometry","squaredLength","setCenterAndRadius","Constructor","dragVertexDelay_","dragVertexDelay","finishCoordinate_","sketchFeature_","sketchPoint_","sketchCoords_","sketchLine_","sketchLineCoords_","squaredClickTolerance_","clickTolerance","overlay_","updateWhileInteracting","freehandCondition_","freehand","freehandCondition","ACTIVE","updateState_","setMap","getOverlay","move","pass","addToDrawing_","handlePointerMove_","startDrawing_","circleMode","finishDrawing","atFinish_","abortDrawing_","downPx","clickPx","modifyDrawing_","createOrUpdateSketchPoint_","at","potentiallyDone","potentiallyFinishCoordinates","sketchCoords","finishCoordinate","finishPixel","getPixelFromCoordinate","updateSketchFeatures_","last","sketchLineGeom","removeLastPoint","sketchFeature","getSource","lineString","sketchFeatures","overlaySource","active","getActive","createRegularPolygon","createBox","boxCoordinates","PJD_3PARAM","PJD_7PARAM","PJD_WGS84","PJD_NODATUM","SEC_TO_RAD","HALF_PI","SIXTH","RA4","RA6","EPSLN","D2R","R2D","FORTPI","TWO_PI","SPI","to_meter","ignoredChar","match","testkey","lkey","toLowerCase","paramName","paramVal","paramOutname","self","paramObj","defData","v","reduce","params","proj","datum","rf","lat_0","lat0","lat_1","lat1","lat_2","lat2","lat_ts","lon_0","long0","lon_1","long1","lon_2","long2","lonc","longc","x_0","y_0","k_0","k0","r_a","R_A","zone","south","utmSouth","towgs84","datum_params","unit","from_greenwich","pm","nadgrids","datumCode","axis","substr","txt","Parser","NEUTRAL","whitespace","latin","keyword","endThings","digets","level","place","root","stack","currentObject","mapit","unshift","thing","newObj","sExpr","convert","readCharicter","char","neutral","quoted","afterquote","number","word","afterItem","newObjects","d2r","lisp","wkt","projName","local","PROJECTION","UNIT","DATUM","SPHEROID","geogcs","GEOGCS","toMeter","sphere","ellps","TOWGS84","isFinite","outName","inName","cleanWKT","defs","that","def","EPSG","ESRI","IAU2000","console","WGS84","GOOGLE","codeWords","codes","testObj","testDef","some","testWKT","auth","checkMercator","maybeProjStr","ext","checkProjStr","testProj","con","eccent","sinphi","cosphi","com","phi","dphi","eccnth","ts","identity","pt","projs","init","es","msfnz","lat","adjust_lon","tsfnz","phi2z","names","projStore","ellipseName","wgs84","ellipse","datumName","ch1903","ggrs87","nad83","nad27","potsdam","carthage","hermannskogel","osni52","ire65","rassadiran","nzgd49","osgb36","s_jtsk","beduaram","gunung_segara","rnb72","ep2","datum_type","Projection","srsCode","error","json","parseCode","ourProj","datumDef","sphere_","ecc","datumObj","Proj","checkParams","compareDatums","Rn","Sin_Lat","Sin2_Lat","Cos_Lat","Longitude","Latitude","Height","geodeticToGeocentric","Dx_BF","Dy_BF","Dz_BF","Rx_BF","Ry_BF","Rz_BF","M_BF","geocentricToWgs84","x_tmp","y_tmp","z_tmp","geocentricFromWgs84","P","RR","CT","ST","RX","RK","RN","CPHI0","SPHI0","CPHI","SPHI","SDPHI","iter","X","Y","Z","geocentricToGeodetic","xin","yin","zin","denorm","checkCoord","toPoint","checkSanity","checkNotWGS","adjust_axis","datum_transform","transformer","from","to","transformedArray","checkProj","oProj","fromProj","toProj","coord","single","NUM_100K_SETS","SET_ORIGIN_COLUMN_LETTERS","SET_ORIGIN_ROW_LETTERS","I","O","mgrs","UTMtoLL","decode","toUpperCase","bottom","ll","accuracy","utm","seasting","easting","snorthing","northing","zoneNumber","zoneLetter","setParm","get100kSetForZone","setColumn","setRow","column","row","parm","colOrigin","rowOrigin","colInt","rowInt","rollover","encode","N","T","C","A","M","LongOriginRad","ZoneNumber","Lat","Long","LatRad","degToRad","LongRad","UTMEasting","UTMNorthing","getLetterDesignator","LLtoUTM","radToDeg","rad","N1","T1","C1","R1","D","LongOrigin","mu","phi1Rad","topRight","LetterDesignator","mgrsString","testChar","hunK","sb","substring","east100k","curCol","eastingValue","rewindMarker","getEastingFromChar","north100k","curRow","northingValue","getNorthingFromChar","getMinNorthing","remainder","accuracyBonus","sepEastingString","sepNorthingString","sep","sepEasting","sepNorthing","warn","fromMGRS","mgrsStr","toMGRS","C08","en","cphi","sphi","arg","pj_mlfn","pj_enfn","ml0","delta_lon","sin_phi","cos_phi","al","als","cs","tq","ml","acos","pj_inv_mlfn","tan_phi","ds","g","temp","asin","log1py","hypot","cos_2B","B","pp","h1","h2","hr","arg_r","hr1","hr2","hi2","sin_arg_r","cos_arg_r","sinh_arg_i","sinh","arg_i","cosh_arg_i","hi1","hi","cgb","cbg","utg","gtu","np","Qn","gatg","Zb","clens","Ce","Cn","sin_Cn","cos_Cn","sin_Ce","cos_Ce","asinhy","clens_cmplx","adjust_zone","etmerc","dependsOn","esinp","rc","phic0","ratexp","K","srat","gauss","sinc0","cosc0","R2","sinc","cosc","cosl","rho","coslat0","sinlat0","cons","ms1","X0","ssfn_","cosX0","sinX0","sinX","cosX","rh","sinlat","coslat","dlon","ce","Chi","phit","eccen","phy0","lambda0","sinPhy0","semiMajorAxis","flattening","R","b0","k1","k2","k3","Sa1","Sa2","S","rotI","rotB","lambda","phy","prevPhy","iteration","no_off","no_rot","bl","fl","gl","t0","dl","t1","t2","hl","jl","pl","dlon12","dlon10","gamma0","uc","us","vs","ql","sl","tl","vl","ul","POSITIVE_INFINITY","qp","sp","tp","vp","up","sin1","cos1","ts1","sin2","cos2","ms2","ts2","ts0","f0","rh1","s45","s90","fi0","alfa","uq","u0","n0","s0","ro0","ad","gfi","u","deltav","eps","ro","czech","fi1","ok","e0","e3","e0fn","e1fn","e2fn","e3fn","mlfn","lam","nl","gN","asq","cl","dd","ml1","phi1","imlfn","nl1","rl1","tl1","dsq","adjust_lat","P00","P01","P02","P10","P11","P20","S_POLE","N_POLE","EQUIT","OBLIQ","qsfnz","mmf","apa","APA","authset","rq","xmf","ymf","sinb1","cosb1","sinph0","cosph0","coslam","sinlam","q","sinb","cosb","phi0","cCe","sCe","ab","beta","cosz","sinz","sin_po","cos_po","qs1","qs2","t3","qs0","ns0","qs","phi1z","asinz","eccnts","sin_p14","cos_p14","infinity_dist","coslon","iqsfnz","dlat","tanphi","mln","mlnp","ma","B_re","B_im","C_re","C_im","delta_lat","d_phi","d_lambda","d_phi_n","d_psi","th_n_im1","th_re","th_im","th_n_re","th_n_im","z_re","z_im","z_n_im1","delta_x","z_n_re","z_n_im","iterations","num_re","num_im","den_re","den_im","den2","d_psi_n","C_y","C_x","V","delta_theta","ml2","sinth","costh","gsq","msq","xx","yy","xys","c3","m1","th1","sin_p12","cos_p12","Mlp","Ml","Nl1","Nl","psi","Az","G","H","GH","Hs","kp","cos_c","s2","s3","s4","cosAz","Ee","F","FACE_ENUM","FRONT","BACK","TOP","BOTTOM","AREA_ENUM","AREA_0","AREA_1","AREA_2","AREA_3","qsc_fwd_equat_face_theta","qsc_shift_lon_origin","slon","face","one_minus_f","one_minus_f_squared","xy","sinlon","nu","cosmu","tannu","tantheta","invert_sign","xa","lp","COEFS_X","COEFS_Y","FXC","FYC","RC1","NODES","poly3_val","coefs","poly3_der","f_df","max_err","iters","upd","newton_rapshon","defaultDatum","version","tmerc","proj4","sterea","stere","somerc","omerc","lcc","krovak","cass","laea","aea","gnom","cea","eqc","poly","nzmg","mill","sinu","moll","eqdc","vandg","aeqd","ortho","qsc","robin","TileWMS","transparent","tileClass","gutter_","gutter","params_","v13_","serverType_","tmpExtent_","updateV13_","setKey","getKeyForParams_","getFeatureInfoUrl","projectionObj","sourceProjectionObj","getTileGridForProjection","tileResolution","tileExtent","getTileCoordExtent","getTileSize","tmpSize","baseParams","getRequestUrl_","getLegendUrl","layers","LAYERS","mpu","getGutter","getParams","GEOSERVER","dpi","MAPSERVER","CARMENTA_SERVER","QGIS","getAxisOrientation","getTilePixelRatio","updateParams","BaseImage","code_","units_","worldExtent_","axisOrientation_","global_","canWrapX_","getPointResolutionFunc_","defaultTileGrid_","metersPerUnit_","canWrapX","getWorldExtent","setGlobal","setExtent","setGetPointResolution","MultiLineString","appendLineString","opt_interpolate","interpolate","getLineString","getLineStrings","midpoints","midpoint","MultiPoint","appendPoint","getPoint","getPoints","Control","target_","map_","listenerKeys","setTarget","disposeInternal","getOverlayContainerStopEvent","POSTRENDER","getElementById","ua","navigator","userAgent","FIREFOX","WEBKIT","MAC","DEVICE_PIXEL_RATIO","devicePixelRatio","IMAGE_DECODE","Image","Text","font_","rotateWithView_","rotateWithView","scale_","textAlign_","textBaseline_","maxAngle_","maxAngle","placement_","placement","overflow_","overflow","offsetX_","offsetY_","backgroundFill_","backgroundFill","backgroundStroke_","backgroundStroke","padding_","getPlacement","getMaxAngle","getOverflow","getBackgroundFill","getBackgroundStroke","getPadding","setOverflow","setFont","setMaxAngle","setOffsetX","setOffsetY","setPlacement","setRotateWithView","setTextAlign","setTextBaseline","setBackgroundFill","setBackgroundStroke","setPadding","SimpleGeometry","getFirstCoordinate","getLastCoordinate","simplifiedGeometryRevision","simplifiedGeometryMaxMinSquaredTolerance","simplifiedGeometry","getStrideForLayout","nesting","getLayoutForStride","opt_sy","transformGeom2D","simpleGeometry","Interaction","setActive","pan","zoomByDelta","ELEMENT","MAP","OFFSET","POSITION","POSITIONING","Overlay","insertFirst","autoPan","autoPanAnimation","autoPanMargin","rendered","bottom_","left_","right_","top_","visible","mapPostrenderListenerKey","handleElementChanged","handleMapChanged","handleOffsetChanged","handlePositionChanged","handlePositioningChanged","setElement","setOffset","setPositioning","positioning","setPosition","getElement","getOffset","getPosition","getPositioning","updatePixelPosition","container","getOverlayContainer","panIntoView","mapRect","getRect","overlayRect","offsetLeft","offsetRight","offsetTop","offsetBottom","centerPx","newCenterPx","box","pageXOffset","pageYOffset","setVisible","display","isRendered","mapSize","updateRenderedPosition","CENTER_RIGHT","BOTTOM_CENTER","CENTER_CENTER","TOP_CENTER","CENTER_LEFT","getOptions","transform2D","anchorX","anchorY","MultiPolygon","opt_endss","endss_","flatInteriorPointsRevision_","flatInteriorPoints_","appendPolygon","newEndss","flatCenters","getInteriorPoints","simplifiedEndss","getPolygon","prevEnds","getPolygons","lastEnds","sourceTileGrid","targetProj","targetTileGrid","wrappedTileCoord","getTileFunction","opt_errorThreshold","opt_renderEdges","TileState","renderEdges_","canvas_","sourceTileGrid_","targetTileGrid_","wrappedTileCoord_","sourceTiles_","sourcesListenerKeys_","sourceZ_","targetExtent","maxTargetExtent","maxSourceExtent","limitedTargetExtent","sourceProjExtent","errorThresholdInPixels","triangulation_","Triangulation","getTriangles","sourceExtent","calculateSourceExtent","sourceRange","srcX","srcY","tile","unlistenSources_","reproject_","sources","leftToLoad","sourceListenKey","defaultTileLoadFunction","ImageTile","tileCacheForProjection","tileGridForProjection","reprojectionErrorThreshold_","renderReprojectionEdges_","tileCache","expireCache","usedTiles","usedTileCache","getTileCacheForProjection","getGutterForProjection","getOpaque","thisProj","projKey","TileCache","highWaterMark","createTile_","urlTileCoord","getTileCoordForTileUrlFunction","tileUrl","tileOptions","handleTileChange","getTile","tileCoordKey","containsKey","newTile","getTileInternal","interimTile","refreshInterimChain","setRenderReprojectionEdges","setTileGridForProjection","tilegrid","imageTile","src","createFromTemplate","zRegEx","xRegEx","yRegEx","dashYRegEx","range","createFromTemplates","templates","tileUrlFunctions","createFromTileUrlFunctions","nullTileUrlFunction","expandUrl","startCharCode","stopCharCode","stop","deflateCoordinate","deflateCoordinates","deflateCoordinatesArray","coordinatess","deflateMultiCoordinatesArray","coordinatesss","Layer","mapPrecomposeKey_","mapRenderKey_","sourceChangeKey_","handleSourcePropertyChange_","setSource","getLayersArray","getLayerStatesArray","opt_states","states","getLayerState","getSourceState","handleSourceChange_","layerRenderer","prepareFrame","renderFrame","PRECOMPOSE","layerStatesArray","hasRenderer","inView","layerState","inflateCoordinates","opt_coordinates","inflateCoordinatesArray","opt_coordinatess","inflateMultiCoordinatesArray","opt_coordinatesss","tmpTileCoord","TileGrid","origins","origin_","origins_","tileSizes_","tileSizes","fullTileRanges_","tmpSize_","sizes","calculateTileRanges_","forEachTileCoord","forEachTileCoordParentTileRange","opt_tileRange","tileCoordExtent","getTileCoordChildTileRange","getTileRangeExtent","getTileCoordForXYAndZ_","getTileCoordForCoordAndResolution","getTileCoordForXYAndResolution_","reverseIntersectionPolicy","adjustX","adjustY","xFromOrigin","yFromOrigin","tileCoordX","tileCoordY","getTileCoordResolution","fullTileRanges","ERROR_THRESHOLD","ENABLE_RASTER_REPROJECTION","formatNumber","formatColor","colorArray","getSymbolVertexShader","parameters","offsetMatrix","uniforms","varyings","uniform","attribute","varying","expression","getSymbolFragmentShader","attributePrefix","stringify","parseSymbolStyle","texCoord","textureCoord","pA","pV","opacityFilter","visibleSize","symbolType","st","colorExpression","sizeExpression","offsetExpression","texCoordExpression","attrName","attributeName","texture","LAYERGROUP","SIZE","TARGET","VIEW","FRACTION","imageState","hitDetectionImage_","unlisten_","imageState_","size_","src_","tainted_","isTainted_","ImageState","getImageData","dispatchChangeEvent_","handleImageError_","unlistenImage_","handleImageLoad_","replaceColor_","getImageState","getHitDetectionImage","fillRect","getSrc","ctx","imgData","putImageData","normalizedAnchor_","anchorOrigin_","anchorOrigin","IconOrigin","anchorXUnits_","anchorXUnits","IconAnchorUnits","anchorYUnits_","anchorYUnits","crossOrigin_","img","imgSize","iconImage_","iconImage","offset_","offsetOrigin_","offsetOrigin","Icon","setAnchor","getImageSize","getHitDetectionImageSize","iconImageSize","listenImageChange","unlistenImageChange","getSourceTiles","removeSourceTiles","executorGroups","loadingSourceTiles","errorSourceTileKeys","replayState_","wantedResolution","getSourceTiles_","removeSourceTiles_","sourceZ","hifi","hasContext","getReplayState","dirty","renderedRenderOrder","renderedResolution","renderedRevision","renderedTileResolution","renderedTileRevision","renderedZ","renderedTileZ","tileLoadFunction_","onLoad","setFeatures","onError","defaultLoadFunction","loadingTiles_","sourceTileByCoordKey_","sourceTilesByTileKey_","tileGrids_","sourceTiles","covered","loadedZ","previousSourceTiles","sourceTileCoord","sourceTile","coordKey","onSourceTileChange","sourceTileKey","onTileChange","addSourceTiles","tileKey","dispose","empty","getTilePixelSize","appendParams","keyParams","encodeURIComponent","KVP","REST","requestEncoding","WMTSRequestEncoding","version_","dimensions_","dimensions","layer_","matrixSet_","matrixSet","requestEncoding_","getKeyForDimensions_","createFromWMTSTemplate","setUrls","setTileUrlFunction","getDimensions","getLayer","getMatrixSet","getRequestEncoding","getVersion","updateDimensions","optionsFromCapabilities","wmtsCap","config","elt","tileMatrixSets","supportedCRS","proj1","proj2","matrixLimits","matrixSets","matrixSetObj","projConfig","wgs84BoundingBox","wgs84ProjectionExtent","gets","encodings","localContext","getMatrixId","assignClosest","offset1","offset2","maxSquaredDelta","squaredDelta","arrayMaxSquaredDelta","multiArrayMaxSquaredDelta","assignClosestPoint","isRing","opt_tmpPoint","tmpPoint","assignClosestArrayPoint","assignClosestMultiArrayPoint","getImageFunction","triangulation","sourceImage","sourcePixelRatio","getPixelRatio","targetProj_","maxSourceExtent_","targetExtent_","sourceImage_","sourcePixelRatio_","sourceListenerKey_","unlistenSource_","sourceState","ImageSourceEventType","ImageSourceEvent","Event","reprojectedImage_","reprojectedRevision_","findNearestResolution","getImageInternal","handleImageChange","defaultImageLoadFunction","DEFAULT_COLOR","DEFAULT_IMAGE_STYLE_ANCHOR","DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS","DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS","DEFAULT_IMAGE_STYLE_SIZE","DEFAULT_IMAGE_STYLE_SRC","DEFAULT_IMAGE_SCALE_MULTIPLIER","GX_NAMESPACE_URIS","NAMESPACE_URIS","ICON_ANCHOR_UNITS_MAP","PLACEMARK_PARSERS","extendedDataParser","regionParser","readMultiGeometry","readStyle","styleMapValue","readStyleMapValue","placemarkObject","readURI","GX_MULTITRACK_GEOMETRY_PARSERS","readGxTrack","NETWORK_LINK_PARSERS","LINK_PARSERS","REGION_PARSERS","LAT_LON_ALT_BOX_PARSERS","regionObject","LOD_PARSERS","lodObject","KML_SEQUENCE","KML_SERIALIZERS","DOCUMENT_SERIALIZERS","DOCUMENT_NODE_FACTORY","writePlacemark","DEFAULT_FILL_STYLE","DEFAULT_NO_IMAGE_STYLE","DEFAULT_IMAGE_STYLE","DEFAULT_TEXT_STROKE_STYLE","DEFAULT_STROKE_STYLE","DEFAULT_TEXT_STYLE","DEFAULT_STYLE","DEFAULT_STYLE_ARRAY","KML","defaultStyle_","defaultStyle","extractStyles_","extractStyles","writeStyles_","writeStyles","sharedStyles_","showPointNames_","showPointNames","readDocumentOrFolder_","readPlacemark_","readSharedStyle_","readSharedStyleMap_","styleUrl","sharedStyles","nameStyle","drawName","createNameStyleFunction","foundStyle","findStyle","styleValue","createFeatureStyleFunction","styleUri","baseURI","location","href","URL","readFeatureFromNode","fs","readName","doc","readNameFromDocument","readNameFromNode","ELEMENT_NODE","readNetworkLinks","networkLinks","readNetworkLinksFromDocument","readNetworkLinksFromNode","readRegion","regions","readRegionFromDocument","readRegionFromNode","writeFeaturesNode","kml","xmlnsUri","setAttributeNS","textOffset","imageScale","foundText","readColor","hexColor","readFlatCoordinates","re","readScale","STYLE_MAP_PARSERS","pairObject","PAIR_PARSERS","ICON_STYLE_PARSERS","iconObject","ICON_PARSERS","xunits","yunits","LABEL_STYLE_PARSERS","LINE_STYLE_PARSERS","POLY_STYLE_PARSERS","FLAT_LINEAR_RING_PARSERS","readFlatLinearRing","GX_TRACK_PARSERS","whens","when","gxTrackObject","readFlatCoordinatesFromNode","EXTRUDE_AND_ALTITUDE_MODE_PARSERS","MULTI_GEOMETRY_PARSERS","multiGeometry","homogeneous","setCommonGeometryProperties","flatLinearRing","INNER_BOUNDARY_IS_PARSERS","OUTER_BOUNDARY_IS_PARSERS","STYLE_PARSERS","styleObject","IconObject","drawIcon","hotSpot","heading","outline","hasExtrude","hasTessellate","hasAltitudeMode","extrudes","tessellates","altitudeModes","DATA_PARSERS","EXTENDED_DATA_PARSERS","featureObject","displayName","SCHEMA_DATA_PARSERS","writeColorTextNode","rgba","abgr","hex","EXTENDEDDATA_NODE_SERIALIZERS","pair","DATA_NODE_FACTORY","ICON_SEQUENCE","ICON_SERIALIZERS","GX_NODE_FACTORY","ICON_STYLE_SEQUENCE","ICON_STYLE_SERIALIZERS","icon","vec2","writeScaleTextNode","LABEL_STYLE_SEQUENCE","LABEL_STYLE_SERIALIZERS","LINE_STYLE_SEQUENCE","LINE_STYLE_SERIALIZERS","GEOMETRY_TYPE_TO_NODENAME","GEOMETRY_NODE_FACTORY","POINT_NODE_FACTORY","LINE_STRING_NODE_FACTORY","LINEAR_RING_NODE_FACTORY","POLYGON_NODE_FACTORY","MULTI_GEOMETRY_SERIALIZERS","writePrimitiveGeometry","writePolygon","writeMultiGeometry","factory","getGeometries","BOUNDARY_IS_SERIALIZERS","writeBoundaryIs","PLACEMARK_SERIALIZERS","namesAndValues","STYLE_SEQUENCE","STYLE_SERIALIZERS","PLACEMARK_SEQUENCE","EXTENDEDDATA_NODE_FACTORY","sort","PRIMITIVE_GEOMETRY_SEQUENCE","PRIMITIVE_GEOMETRY_SERIALIZERS","POLYGON_SERIALIZERS","INNER_BOUNDARY_NODE_FACTORY","OUTER_BOUNDARY_NODE_FACTORY","outerRing","POLY_STYLE_SERIALIZERS","COLOR_NODE_FACTORY","iconProperties","HYBRID","IMAGE_REPLAYS","VECTOR_REPLAYS","boundHandleStyleImageChange_","handleStyleImageChange_","overlayContext_","overlayContextUid_","overlayPixelTransform_","inverseOverlayPixelTransform_","dirty_","renderedLayerRevision_","renderTileImageQueue_","tileListenerKeys_","tmpTransform_","useContainer","overlayContext","childElementCount","lastElementChild","containerReused","transformOrigin","prepareTile","queue","tileUid","updateExecutorGroup_","tileImageNeedsRender_","listenerKey","viewHints","renderTileImage_","isDrawableTile","getTileImage","layerIndex","hasOverlay","layerRevision","renderedTiles","revision","renderOrder","getRenderOrder","builderState","layerUid","sourceTileExtent","sharedExtent","bufferedExtent","getRenderBuffer","tmpExtent","builderGroup","getDeclutter","renderFeature","executorGroupInstructions","finish","replayExtent","renderingReplayGroup","tt","forEachFeatureAtCoordinate","hitTolerance","declutteredFeatures","declutter","tileContainsCoordinate","executorGroup","handleFontsChanged","getVisible","renderIfReadyAndVisible","renderQueuedTileImages_","renderMode","getRenderMode","VectorTileRenderType","declutterReplays","replayTypes","canvasTransform","clearRect","tiles","clips","clipZs","worldOffset","getRenderTransform","clipped","hasExecutors","currentZ","currentClip","getClipCoords","save","clip","execute","restore","time","replayState","renderPixelRatio","renderScale","pixelScale","getDataAtPixel","renderPixel","Uint8Array","renderMode_","BaseVector","ARRAY_BUFFER","XML","asColorLike","GETFEATUREINFO_IMAGE_SIZE","ImageWMS","imageLoadFunction_","imageLoadFunction","imageSize_","renderedRevision_","ratio_","imageResolution","viewExtent","requestWidth","requestHeight","requestExtent","getImageLoadFunction","setImageLoadFunction","Observable","revision_","on","once","un","unByKey","padNumber","opt_precision","numberString","compareVersions","v1","v2","s1","n1","n2","Target","opt_target","pendingRemovals_","dispatching_","listeners_","listeners","propagate","pendingRemovals","getListeners","hasListener","opt_type","Disposable","disposed_","douglasPeucker","simplifiedOffset","markers","first","maxSquaredDistance","douglasPeuckerArray","snap","tolerance","quantize","quantizeArray","quantizeMultiArray","HEX_COLOR_RE_","NAMED_COLOR_RE_","asString","fromString","rgb","fromNamed","hasAlpha","normalize","fromStringInternal_","asArray","ImageWrapper","listenImage","loadHandler","errorHandler","promise","listening","then","catch","message","Tile","transition_","transitionStarts_","getInterimTile","getTileCoord","getAlpha","inTransition","endTransition","all","XMLFeature","xmlSerializer_","XMLSerializer","readFeatureFromDocument","readFeaturesFromDocument","readGeometryFromDocument","readProjectionFromDocument","writeFeatureNode","serializeToString","writeGeometryNode","register","projCodes","code1","code2","DEFAULT_MAX_ZOOM","DEFAULT_TILE_SIZE","linearRingContainsExtent","linearRingContainsXY","wn","linearRingsContainsXY","linearRingssContainsXY","linearRingIsClockwise","edge","linearRingsAreOriented","isClockwise","linearRingssAreOriented","orientLinearRings","orientLinearRingsArray","SIMPLIFY_TOLERANCE","GEOMETRY_RENDERERS","imageReplay","getBuilder","addDeclutter","textReplay","drawText","lineStringReplay","polygonReplay","replayGroup","geometryRenderer","circleReplay","defaultOrder","feature1","feature2","getSquaredTolerance","getTolerance","opt_transform","renderGeometry","replay","drawCustom","renderFeatureInternal","SelectEventType","SELECT","SelectEvent","selected","deselected","Select","layerFilter","addCondition_","addCondition","removeCondition_","removeCondition","toggleCondition_","toggleCondition","multi_","multi","filter_","hitTolerance_","featureStyleAssociation_","layerFilter_","featureLayerAssociation_","addFeature_","removeFeature_","addFeatureLayerAssociation_","getHitTolerance","setHitTolerance","removeSelectedStyle_","giveSelectedStyle_","removeFeatureLayerAssociation_","toggle","forEachFeatureAtPixel","PRERENDER","POSTCOMPOSE","RENDERCOMPLETE","transforms","RegularShape","hitDetectionCanvas_","radius1","radius2_","radius2","hitDetectionImageSize_","getRadius2","strokeWidth","renderOptions","draw_","createHitDetectionCanvas_","angle0","radiusC","drawHitDetectionCanvas_","CanvasBuilder","maxLineWidth","beginGeometryInstruction1_","beginGeometryInstruction2_","bufferedMaxExtent_","instructions","tmpCoordinate_","hitDetectionInstructions","applyPixelRatio","dashArray","dash","appendFlatCoordinates","closed","skipFirst","myEnd","getBufferedMaxExtent","lastRel","nextRel","lastXCoord","lastYCoord","nextCoord","skipped","drawCustomCoordinates_","builderEnds","builderEnd","beginGeometry","builderEndss","builderBegin","myEnds","endGeometry","reverseHitDetectionInstructions","reverse","instruction","createFill","applyStroke","createStroke","updateFillStyle","currentFillStyle","updateStrokeStyle","currentStrokeStyle","currentLineCap","currentLineDash","currentLineDashOffset","currentLineJoin","currentLineWidth","currentMiterLimit","endGeometryInstruction","MVT","featureClass_","featureClass","layerName_","layerName","layers_","idProperty_","idProperty","readRawGeometry_","pbf","pos","readVarint","cmd","coordsLen","currentEnd","cmdLen","readSVarint","createFeature_","rawFeature","geometryType","numEnds","getGeometryType","geom","prevEndIndex","ctor","pbfLayers","readFields","layersPBFReader","pbfLayer","readRawFeature","setLayers","tag","layerPBFReader","readFloat","readDouble","readVarint64","featurePBFReader","MOVESTART","MOVEEND","LinearRing","calculateSourceResolution","targetMetersPerUnit","sourceMetersPerUnit","compensationFactor","enlargeClipPoint","centroidX","centroidY","dX","dY","sourceDataExtent","canvasWidthInUnits","canvasHeightInUnits","stitchContext","stitchScale","xPos","yPos","srcWidth","srcHeight","targetTopLeft","triangle","v0","u1","u2","sourceNumericalShiftX","sourceNumericalShiftY","augmentedMatrix","affineCoefs","p0","p1","p2","disable","createSnapToN","createSnapToZero","opt_tolerance","MapBrowserPointerEvent","opt_dragging","opt_frameState","DEFAULT_WMS_VERSION","Source","attributions_","adaptAttributions","attributionsCollapsible_","state_","wrapX_","getAttributionsCollapsible","getWrapX","attributionLike","GeometryCollection","opt_geometries","geometries_","changeEventsKeys_","listenGeometriesChange_","unlistenGeometriesChange_","geometryCollection","setGeometries","cloneGeometries","simplifiedGeometries","simplified","simplifiedGeometryCollection","setGeometriesArray","clonedGeometries","interpolatePoint","pointX","pointY","cumulativeLengths","lineStringCoordinateAtM","lo","m0","lineStringsCoordinateAtM","NAMESPACE_URI","readHref","counter","WOFF","mimes","woff","woff2","ttf","eot","png","jpg","jpeg","gif","tiff","svg","parseExtension","getMimeType","createImage","Promise","resolve","reject","onload","onerror","getDataURLContent","dataURL","px","styleProperty","getPropertyValue","uuid","random","ms","isDataUrl","search","toDataURL","content","mimeType","canvasToBlob","toBlob","binaryString","atob","binaryArray","Blob","toArray","arrayLike","getNodeWidth","leftBorder","rightBorder","scrollWidth","getNodeHeight","topBorder","bottomBorder","scrollHeight","svgToDataURL","html","getBlobFromImageURL","intersectsLineString","coordinatesExtent","point1","point2","intersectsLineStringArray","intersectsLinearRingArray","intersectsLinearRing","intersectsLinearRingMultiArray","WMTSTileGrid","matrixIds_","matrixIds","getMatrixIds","createFromCapabilitiesMatrixSet","opt_matrixLimits","switchOriginXY","elt_ml","tileWidth","tileHeight","supportedExtensions","ELEMENT_ARRAY_BUFFER","DYNAMIC_DRAW","CONTEXT_IDS","opt_attributes","BufferUsage","opt_usage","usage","getArrayClassForType","Float32Array","Uint32Array","ofSize","fromArray","fromArrayBuffer","getUsage","LOST","RESTORED","fromTransform","mat4","WebGLPostProcessingPass","gl_","webGlContext","scaleRatio_","scaleRatio","renderTargetTexture_","createTexture","renderTargetTextureSize_","frameBuffer_","createFramebuffer","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","fragmentShader","FRAGMENT_SHADER","renderTargetProgram_","createProgram","attachShader","linkProgram","renderTargetVerticesBuffer_","createBuffer","bindBuffer","bufferData","STATIC_DRAW","renderTargetAttribLocation_","getAttribLocation","renderTargetUniformLocation_","getUniformLocation","renderTargetTextureLocation_","uniforms_","getGL","bindFramebuffer","FRAMEBUFFER","getFrameBuffer","viewport","internalFormat","RGBA","UNSIGNED_BYTE","bindTexture","TEXTURE_2D","texImage2D","texParameteri","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","framebufferTexture2D","COLOR_ATTACHMENT0","nextPass","activeTexture","TEXTURE0","clearColor","COLOR_BUFFER_BIT","enable","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","useProgram","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform2f","uniform1i","applyUniforms","drawArrays","TRIANGLES","textureSlot","HTMLCanvasElement","ImageData","uniform3f","uniform4f","uniform1f","DefaultUniform","PROJECTION_MATRIX","OFFSET_SCALE_MATRIX","OFFSET_ROTATION_MATRIX","AttributeType","UNSIGNED_SHORT","UNSIGNED_INT","getByteSizeFromType","BYTES_PER_ELEMENT","Uint16Array","boundHandleWebGLContextLost_","handleWebGLContextLost","boundHandleWebGLContextRestored_","handleWebGLContextRestored","bufferCache_","shaderCache_","programCache_","currentProgram_","getSupportedExtensions","getExtension","ContextEventType","offsetRotateMatrix_","offsetScaleMatrix_","tmpMat4_","uniformLocations_","attribLocations_","postProcessPasses_","postProcesses","shaderCompileErrors_","bufferKey","bufferCache","webGlBuffer","flushBufferData","deleteBuffer","buf","bufferCacheEntry","isContextLost","deleteProgram","deleteShader","prepareDraw","getCanvas","applyFrameState","prepareDrawToRenderTarget","renderTarget","opt_disableAlphaBlend","getFramebuffer","getTexture","ZERO","drawElements","elementType","numItems","offsetInBytes","finalizeDraw","offsetScaleMatrix","offsetRotateMatrix","setUniformMatrixValue","HTMLImageElement","program","shader","getProgram","fragmentShaderSource","vertexShaderSource","getShaderInfoLog","getShaderCompileErrors","getAttributeLocation","makeProjectionTransform","setUniformFloatValue","uniformMatrix4fv","enableAttributeArray_","attribName","enableAttributes","attr","computeAttributesStride","opt_data","opt_texture","WebGLWorkerMessageType","GENERATE_BUFFERS","helper","colorEncodeId","radix","blob","createObjectURL","tmpArray4","WebGLRenderTarget","helper_","texture_","framebuffer_","data_","dataCacheDirty_","updateSize_","setSize","clearCachedData","readAll","readPixels","readPixel","projectionMatrixTransform","sourceRevision_","verticesBuffer_","hitVerticesBuffer_","indicesBuffer_","program_","hitDetectionEnabled_","hitFragmentShader","hitVertexShader","hitProgram_","customAttributes","hitDetectionAttributes","previousExtent_","currentTransform_","renderTransform_","invertRenderTransform_","renderInstructions_","hitRenderInstructions_","hitRenderTarget_","worker_","Worker","received","projectionTransform","hitDetection","vertexBuffer","indexBuffer","renderInstructions","renderCount","renderHitDetection","vectorSource","sourceChanged","viewNotMoving","extentChanged","rebuildBuffers_","totalInstructionsCount","totalHitInstructionsCount","hitColor","tmpCoords","tmpColor","renderIndex","hitIndex","customAttributesCount","postMessage","hitMessage","colorDecodeId","terminate","PARSERS","SERVICE_IDENTIFICATION_PARSERS","SERVICE_PROVIDER_PARSERS","OPERATIONS_METADATA_PARSERS","readFromDocument","readFromNode","owsObject","ADDRESS_PARSERS","ALLOWED_VALUES_PARSERS","CONSTRAINT_PARSERS","CONTACT_INFO_PARSERS","PHONE_PARSERS","DCP_PARSERS","HTTP_PARSERS","REQUEST_METHOD_PARSERS","OPERATION_PARSERS","SERVICE_CONTACT_PARSERS","OWS_NAMESPACE_URIS","CONTENTS_PARSERS","owsParser_","WMTSCapabilityObject","LAYER_PARSERS","TMS_PARSERS","isDefault","TMS_LINKS_PARSERS","DIMENSION_PARSERS","resourceType","WGS84_BBOX_READERS","legend","TMS_LIMITS_LIST_PARSERS","TMS_LIMITS_PARSERS","readCoordinates","TM_PARSERS","DEFAULT_RADIUS","opt_radius","deltaLatBy2","deltaLonBy2","getLengthInternal","getAreaInternal","bearing","lon1","dByR","CIRCLE_CIRCUMFERENCE_INDEX","tempExtent","tempSegment","ModifyEventType","ModifyEvent","mapBrowserPointerEvent","Modify","boundHandleFeatureChange_","defaultDeleteCondition_","deleteCondition_","deleteCondition","insertVertexCondition_","insertVertexCondition","vertexFeature_","vertexSegments_","lastPixel_","ignoreNextSingleClick_","modified_","rBush_","pixelTolerance_","pixelTolerance","snappedToVertex_","changingFeature_","dragSegments_","updateWhileAnimating","SEGMENT_WRITERS_","writePointGeometry_","writeLineStringGeometry_","writePolygonGeometry_","writeMultiPointGeometry_","writeMultiLineStringGeometry_","writeMultiPolygonGeometry_","writeCircleGeometry_","writeGeometryCollectionGeometry_","handleSourceAdd_","handleSourceRemove_","handleFeatureAdd_","handleFeatureRemove_","lastPointerEvent_","writer","handlePointerAtPixel_","willModifyFeatures_","removeFeatureSegmentData_","rBush","nodesToRemove","nodeToRemove","segmentData","depth","rings","kk","centerSegmentData","circumferenceSegmentData","featureSegments","createOrUpdateVertexFeature_","vertexFeature","removePoint","vertex","dragSegment","setGeometryCoordinates_","pixelCoordinate","insertVertices","vertexExtent","segmentDataMatches","componentSegments","compareIndexes","segmentDataMatch","closestVertex","closestOnSegmentData","insertVertex_","getCoordinateFromPixel","nodes","projectedDistanceToSegmentDataSquared","closestSegment","vertexPixel","dist","vertexSegments","pixel1","pixel2","squaredDist1","squaredDist2","rTree","updateSegmentIndices_","newSegmentData","newSegmentData2","removeVertex_","component","newIndex","dragSegments","segmentsByFeature","deleted","segments","pointCoordinates","circleGeometry","distanceToCenterSquared","distanceToCircumference","getClosestPoint","UNITS_PROP","IMPERIAL","NAUTICAL","METRIC","US","LEADING_DIGITS","ScaleLine","bar","innerElement_","viewState_","minWidth_","minWidth","renderedVisible_","renderedWidth_","renderedHTML_","handleUnitsChanged_","setUnits","scaleBar_","scaleBarSteps_","steps","scaleBarText_","updateElement_","pointResolutionUnits","nominalCount","suffix","metersPerDegree","decimalCount","createScaleBar","mapScale","getScaleForResolution","toLocaleString","scaleSteps","stepWidth","backgroundColor","createMarker","createStepText","isLast","lengthString","getInteriorPointOfArray","flatCentersOffset","intersections","rr","maxSegmentLength","segmentLength","getInteriorPointsOfMultiArray","interiorPoints","TileSource","opaque_","tilePixelRatio_","canUseScreen","screen","availWidth","availHeight","key_","forEachLoadedTile","loaded","useTile","TileSourceEvent","opt_errback","opt_callbackParam","script","cleanup","async","timer","getElementsByTagName","RBush","opt_maxEntries","rbush_","items_","forEach_","toJSON","rbush","TileRange","containsTileRange","RasterEventType","RasterOperationType","PIXEL","RasterSourceEvent","RasterSource","operationType_","operationType","threads_","threads","createLayer","createLayers","tileQueue_","requestedFrameState_","renderedImageCanvas_","frameState_","pixelToCoordinateTransform","postRenderFunctions","tileQueue","wantedTiles","iMax","sourceOrLayer","attributionGetter","sourceAttribution","operation","setOperation","lib","opt_lib","imageOps","updateFrameState_","allSourcesReady_","ready","renderedExtent","processSources_","loadMoreTiles","imageDatas","imageData","process","onWorkerComplete_","sharedContext","layerOrSource","TierSizeCalculation","TRUNCATED","CustomTile","zoomifyImage_","Zoomify","tierSizeCalculation","tierSizeInTiles","tileSizeForTierSizeCalculation","tileCountUpToTier","tileCoordZ","tileIndex","ZoomifyTileClass","matchingChunk","m12","m23","x12","y12","x23","y23","chunkStart","chunkEnd","chunkM","TEXT_ALIGN","declutterGroups_","labels_","fillStates","strokeStates","textStates","textKey_","fillKey_","strokeKey_","TextPlacement","LINE","flatEnd","flatOffset","oo","declutterGroup","drawChars_","geometryWidths","saveTextStates_","strokeKey","textKey","fillKey","baseline","declutterGroups","MousePosition","handleProjectionChanged_","coordinateFormat","setCoordinateFormat","setProjection","undefinedHTML_","undefinedHTML","renderOnMouseOut_","mapProjection_","getCoordinateFormat","handleMouseMove","updateHTML_","getEventPixel","handleMouseOut","twiceArea","linearRingss","CanvasLayerRenderer","tempTransform_","pixelTransform","layerClassName","getClassName","halfWidth","halfHeight","topLeft","bottomRight","bottomLeft","clipUnrotated","inverted","dispatchRenderEvent_","preRender","postRender","ImageBase","JSONFeature","getObject","BaseVectorLayer","renderBuffer","declutter_","renderBuffer_","updateWhileAnimating_","updateWhileInteracting_","getUpdateWhileAnimating","getUpdateWhileInteracting","setRenderOrder","TextFeature","readFeatureFromText","readFeaturesFromText","readGeometryFromText","readProjectionFromText","writeFeatureText","writeFeaturesText","writeGeometryText","ACCURACY","ACCURACY_GEOMETRY","ALTITUDE","ALTITUDE_ACCURACY","HEADING","SPEED","TRACKING","TRACKING_OPTIONS","GeolocationError","Geolocation","position_","watchId_","handleTrackingChanged_","trackingOptions","setTrackingOptions","setTracking","tracking","getTracking","geolocation","watchPosition","positionChange_","positionError_","getTrackingOptions","clearWatch","altitude","altitudeAccuracy","longitude","latitude","projectedPosition","speed","getAccuracy","getAccuracyGeometry","getAltitude","getAltitudeAccuracy","getHeading","getSpeed","read","IconImageCache","cache_","cacheSize_","maxCacheSize_","expire","maxCacheSize","shared","MapEvent","TopoJSON","topoJSONTopology","arcs","transformArc","transformArcs","topoJSONFeatures","objectName","readFeaturesFromGeometryCollection","readFeatureFromGeometry","GEOMETRY_READERS","transformVertex","concatenateArcs","polyArray","ringCoords","indices","geometryReader","getFeatureFromEvent","Snap","vertex_","edge_","featuresListenerKeys_","featureChangeListenerKeys_","indexedFeaturesExtents_","pendingFeatures_","opt_listen","feature_uid","segmentWriter","forEachFeatureAdd_","forEachFeatureRemove_","getFeatures_","snapTo","snapped","updateFeature_","featuresToUpdate","opt_unlisten","unregister","currentMap","lowerLeft","upperRight","closestSegmentData","projectedCoordinate","isCircle","drawTextOnPath","startM","previousAngle","numChars","segmentM","angleChanged","charLength","charM","segmentPos","tmpTransform","p3","p4","alignFill_","coordinateCache_","renderedTransform_","widths_","getTextImage","align","lineHeight","renderWidth","leftRight","replayTextBackground_","setStrokeStyle_","replayImage_","snapToPixel","fillStroke","boxW","boxH","boxX","boxY","strokePadding","declutterArgs","repeatSize","groupCount","collides","declutterData","currentAlpha","drawTextImageWithPointPlacement_","execute_","featureCallback","opt_hitExtent","prevX","prevY","roundX","roundY","pendingFill","pendingStroke","lastFillInstruction","lastStrokeInstruction","coordinateCache","batchSize","labelWithAnchor","widthIndex","declutterGroupIndex","measurePixelRatio","pixelRatioScale","cachedWidths","pathLength","textLength","parts","cc","chars","part","executeHitDetection","opt_featureCallback","ORDER","BuilderType","allInstructions","opt_renderBuffer","maxExtent_","resolution_","executorsByZIndex_","hitDetectionContext_","hitDetectionTransform_","createExecutors_","flatClipCoords","executors","instructionByZindex","builderType","candidates","contextSize","hitExtent","circleArrayCache","arraySize","fillCircleArrayRowToMiddle","getCircleArray","executor","zs","zIndexKey","opt_builderTypes","opt_declutterReplays","replays","builderTypes","replayDeclutter","zz","executorData","currentExecutor","ulElement_","collapsed_","collapsed","overrideCollapsible_","collapsible","collapsible_","collapseLabel","collapseLabel_","activeLabel","renderedAttributions_","collectSourceAttributions_","lookup","visibleAttributions","setCollapsible","handleToggle_","getCollapsible","setCollapsed","getCollapsed","lastDistance_","lastScaleDelta_","scaleDelta","Direction","VERTICAL","HORIZONTAL","ZoomSlider","dragListenerKeys_","currentResolution_","direction_","dragging_","heightLimit_","widthLimit_","startX_","startY_","thumbSize_","sliderInitialized_","thumbElement","containerElement","handleDraggerStart_","handleDraggerDrag_","handleDraggerEnd_","handleContainerClick_","initSlider_","containerSize","thumb","computedStyle","thumbWidth","thumbHeight","relativePosition","getRelativePosition_","getResolutionForPosition_","drag","setThumbPosition_","getPositionForResolution_","amount","element_","startPixel_","endPixel_","render_","startPixel","endPixel","setPixels","createOrUpdateGeometry","DragBoxEventType","DragBoxEvent","box_","minArea_","onBoxEnd_","boxEndCondition_","boxEndCondition","defaultBoxEndCondition","PriorityQueue","priorityFunction","keyFunction","priorityFunction_","keyFunction_","elements_","priorities_","queuedElements_","dequeue","elements","priorities","siftUp_","elementKey","enqueue","priority","siftDown_","getLeftChildIndex_","getRightChildIndex_","getParentIndex_","heapify_","isKeyQueued","isQueued","startIndex","lIndex","rIndex","smallerChildIndex","parentIndex","reprioritize","withCredentials","loadFeaturesXhr","success","failure","xhr","responseType","responseXML","Circle","getRadiusSquared_","circleExtent","DragRotateAndZoom","lastMagnitude_","magnitude","angleDelta","events","FullScreen","cssClassName_","labelNode_","labelActive","labelActiveNode_","button_","setClassName_","isFullScreen","isFullScreenSupported","keys_","handleFullScreen_","exitFullscreen","msExitFullscreen","webkitExitFullscreen","webkitRequestFullscreen","requestFullScreen","requestFullScreenWithKeys","handleFullScreenChange_","updateSize","fullscreen","activeClassName","inactiveClassName","nextClassName","msRequestFullscreen","msFullscreenEnabled","requestFullscreen","fullscreenEnabled","webkitIsFullScreen","msFullscreenElement","fullscreenElement","MULTIGEOMETRY_TO_MEMBER_NODENAME","GML2","readFlatCoordinates_","containerSrs","coordsGroups","readBox_","BOX_PARSERS_","innerBoundaryIsParser_","outerBoundaryIsParser_","GEOMETRY_NODE_FACTORY_","multiSurface","surface","multiCurve","writeFeatureElement","writeGeometryElement","writeCurveOrLineString_","createCoordinatesNode_","writeCoordinates_","writeCurveSegments_","writeLineStringOrCurveMember_","line","writeMultiCurveOrLineString_","hasZ","curve","LINESTRINGORCURVEMEMBER_SERIALIZERS_","MULTIGEOMETRY_MEMBER_NODE_FACTORY_","GEOMETRY_SERIALIZERS_","getCoords_","writeSurfaceOrPolygon_","RING_SERIALIZERS_","RING_NODE_FACTORY_","patches","writeSurfacePatches_","exteriorWritten","writeRing_","writeLinearRing_","opt_srsName","opt_hasZ","writePoint_","writeMultiPoint_","POINTMEMBER_SERIALIZERS_","writePointMember_","writeMultiSurfaceOrPolygon_","SURFACEORPOLYGONMEMBER_SERIALIZERS_","writeSurfaceOrPolygonMember_","writeEnvelope","ENVELOPE_SERIALIZERS_","RenderFeature","flatCoordinates_","flatMidpoints_","properties_","pixelExtent","projectedExtent","AssertionError","BaseLayer","className_","opt_managed","managed","setMaxResolution","setMinResolution","zindex","Geometry","extentRevision_","simplifyTransformedInternal","opt_closestPoint","simplify","inCoordinates","outCoordinates","ret","LRUCache","count_","entries_","oldest_","newest_","entry","value_","newer","older","peekLast","peekFirstKey","RenderEvent","opt_inversePixelTransform","opt_context","VectorContext","geometryCollectionGeometry","lineStringGeometry","multiLineStringGeometry","multiPointGeometry","multiPolygonGeometry","pointGeometry","polygonGeometry","opt_declutterGroup","opt_declutterGroups","MapBrowserEvent","pixel_","coordinate_","dragging","TileQueue","tilePriorityFunction","tileChangeCallback","boundHandleTileChange_","tileChangeCallback_","tilesLoading_","tilesLoadingKeys_","added","getTilesLoading","maxTotalLoading","maxNewLoads","newLoads","abortedTiles","CanvasTileLayerRenderer","tileLayer","renderedExtent_","newTiles_","tmpTileRange_","tileState","loadedTileCallback","viewResolution","viewCenter","tileSource","sourceRevision","layerExtent","canvasExtent","tilesToDrawByZ","findLoadedTiles","createLoadedTileFinder","tmpTileRange","childTileRange","canvasScale","currentTilePixelSize","currentScale","originTileCoord","originTileExtent","tileGutter","tilesToDraw","floatX","nextX","floatY","nextY","drawTileImage","updateUsedTiles","manageTilePyramid","updateCacheSize_","scheduleExpireCache","tileAlpha","alphaChanged","postRenderFunction","tileSourceKey","opt_tileCallback","LayerRenderer","boundHandleImageChange_","handleImageChange_","loadImage","getBlankImage","naturalWidth","naturalHeight","pruneExceptNewestZ","errorThreshold","sourceProj_","transformInvCache","transformInv","transformInv_","errorThresholdSquared_","triangles_","wrapsXInSource_","canWrapXInSource_","sourceWorldWidth_","targetWorldWidth_","destinationTopLeft","destinationTopRight","destinationBottomRight","destinationBottomLeft","sourceTopLeft","sourceTopRight","sourceBottomRight","sourceBottomLeft","addQuad_","leftBound","newTriangle","addTriangle_","aSrc","bSrc","cSrc","dSrc","maxSubdivision","sourceQuadExtent","sourceCoverageX","sourceWorldWidth","wrapsX","needsSubdivision","targetQuadExtent","centerSrc","bc","bcSrc","da","daSrc","abSrc","cd","cdSrc","CanvasImageLayerRenderer","imageLayer","imageSource","hints","imageExtent","imagePixelRatio","dw","dh","previousAlpha","_maxEntries","_minEntries","leaf","_all","toBBox","_build","_splitRoot","_insert","_condense","compareMinX","compareMinY","fromJSON","_chooseSubtree","_split","_adjustParentBBoxes","_chooseSplitAxis","_chooseSplitIndex","_allDistMargin","lineStringLength","CanvasVectorLayerRenderer","vectorLayer","renderedResolution_","renderedRenderOrder_","replayGroup_","replayGroupChanged","world","animating","interacting","frameStateExtent","vectorLayerRevision","vectorLayerRenderBuffer","vectorLayerRenderOrder","userExtent","replayGroupInstructions","ImageStyle","opacity_","ImageCanvas","opt_loader","error_","getError","handleLoad_","DragAndDropEventType","DragAndDropEvent","file","opt_features","DragAndDrop","formatConstructors_","formatConstructors","dropListenKeys_","handleResult_","tryReadFeatures_","registerListeners_","dropArea","handleDrop","handleStop","unregisterListeners_","files","dataTransfer","reader","FileReader","readAsText","dropEffect","__importDefault","mod","cloneNode_1","embedWebFonts_1","embedImages_1","createSvgDataURL_1","applyStyleWithOptions_1","utils_1","domNode","toSvgDataURL","_a","default","clonedNode","toCanvas","toPixelData","toPng","toJpeg","quality","GeometryConstructor","TokenType","WKTGeometryType","Lexer","index_","isAlpha_","isNumeric_","opt_decimal","isWhiteSpace_","nextChar_","nextToken","readNumber_","readText_","scientificNotation","lexer","lexer_","token_","layout_","consume_","isTokenType","isMatch","parseGeometry_","parseGeometryLayout_","dimToken","dimInfo","parseGeometryCollectionText_","isEmptyGeometry_","formatErrorMessage_","parsePointText_","parsePoint_","parseLineStringText_","parsePointList_","parsePolygonText_","parseLineStringTextList_","parseMultiPointText_","parsePointTextList_","parseMultiLineStringText_","parseMultiPolygonText_","parsePolygonTextList_","token","geomType","WKT","splitCollection_","splitCollection","parse_","encodePointGeometry","encodeLineStringGeometry","encodePolygonGeometry","GeometryEncoder","components","geoms","enc","geometryEncoder","encodeGeometryLayout","ControlledMap","OverviewMap","boundHandleRotationChanged_","handleRotationChanged_","viewExtent_","ovmapDiv_","ovmap_","ovmap","addLayer","boxSizing","boxOverlay_","addOverlay","scope","overlay","overlayBox","mousePosition","getEventCoordinateInternal","endMoving","oldMap","oldView","unbindView_","handleMapPropertyChange_","bindView_","resetExtent_","newView","validateExtent_","ovmapSize","ovextent","topLeftPixel","bottomRightPixel","boxWidth","boxHeight","ovmapWidth","ovmapHeight","recenter_","ovview","MAX_RATIO","LN2","updateBox_","ovresolution","getOverviewMap","Static","imageExtent_","getImageExtent","targetWidth","getGeometryLayout","paths","GEOMETRY_WRITERS","esriJSON","hasZM","getHasZM","hasM","multiPoint","multiLineString","EsriJSON","esriJSONFeature","idField","esriJSONFeatures","objectIdFieldName","wkid","esriJSONPolygon","flatRing","outerRings","holes","hole","matched","convertRings","geometryWriter","anchorX_","anchorY_","height_","originX_","originY_","drawCoordinates_","myBegin","hitDetectionImage","drawFlatCoordinates_","moveToLineToInstruction","lastStroke","drawFlatCoordinatess_","setFillStrokeStyles_","circleInstruction","BATCH_CONSTRUCTORS","PolygonBuilder","Builder","ImageBuilder","LineStringBuilder","TextBuilder","BuilderGroup","tolerance_","buildersByZIndex_","group","builderInstructions","zKey","builders","builderKey","builderInstruction","geoM","fracA","fracB","fracM","geoA","geoB","geoStack","fractionStack","fractions","maxIterations","INTERVALS","maxLines","targetSize","showLabels","lonLabelFormatter","latLabelFormatter","lonLabelPosition","latLabelPosition","lonLabelStyle","latLabelStyle","intervals","maxLat_","maxLon_","minLat_","minLon_","maxLatP_","maxLonP_","minLatP_","minLonP_","targetSize_","maxLines_","meridians_","parallels_","strokeStyle_","fromLonLatTransform_","toLonLatTransform_","projectionCenterLonLat_","meridiansLabels_","parallelsLabels_","lonLabelFormatter_","latLabelFormatter_","lonLabelPosition_","latLabelPosition_","lonLabelStyleCache_","lonLabelStyle_","latLabelStyleCache_","latLabelStyle_","intervals_","loaderFunction","featurePool_","lineStyle_","renderExtent","updateProjectionInfo_","createGraticule_","featureCount","featuresColl","labelData","poolIndex","addMeridian_","minLat","maxLat","getMeridian_","textPoint","getMeridianPoint_","addParallel_","minLon","maxLon","getParallel_","getParallelPoint_","getInterval_","cnt","centerLonLat","centerLon","centerLat","validExtent","frac","meridian","GeometryLayout","clampedBottom","clampedTop","getMeridians","lon2","parallel","clampedLeft","clampedRight","getParallels","worldExtentP","Vector","moveTolerance","clickTimeoutId_","moveTolerance_","down_","activePointers_","trackedTouches_","pointerdownListenerKey_","handlePointerDown_","relayedListenerKey_","relayEvent_","emulateClick_","newEvent","updateActivePointers_","handlePointerUp_","isMouseActionButton_","isMoving_","optionsInternal","keyboardEventTarget","overlays","layerGroup","getLayers","MapProperty","View","createOptionsInternal","boundHandleBrowserEvent_","handleBrowserEvent","maxTilesLoading_","maxTilesLoading","postRenderTimeoutHandle_","animationDelayKey_","animationDelay_","renderFrame_","coordinateToPixelTransform_","pixelToCoordinateTransform_","frameIndex_","viewPropertyListenerKey_","viewChangeListenerKey_","layerGroupPropertyListenerKeys_","viewport_","msTouchAction","touchAction","overlayContainer_","overlayContainerStopEvent_","mapBrowserEventHandler_","handleMapBrowserEvent","keyboardEventTarget_","keyHandlerKeys_","labelCache_","labelCacheListenerKey_","overlays_","overlayIdIndex_","handleResize_","postRenderFunctions_","getTilePriority","handleTileChange_","handleLayerGroupChanged_","handleViewChanged_","handleSizeChanged_","handleTargetChanged_","control","CollectionEventType","interaction","addOverlayInternal_","addControl","getControls","addInteraction","getInteractions","getLayerGroup","getOverlays","checkWrapped","getFeaturesAtPixel","forEachLayerAtPixel","hasFeatureAtPixel","hasFeatureAtCoordinate","getEventCoordinate","eventPosition","changedTouches","getTarget","getOverlayById","getLoading","viewCoordinate","tileCenter","HTMLElement","parentElement","interactionsArray","handlePostRender","lowOnFrameBudget","dispatchRenderEvent","targetElement","handleViewPropertyChanged_","ObjectEventType","renderSync","redrawText","layerStates","removeControl","removeInteraction","removeLayer","removeOverlay","previousFrameState","MapEventType","setLayerGroup","setView","expireIconCache","declutterTree_","calculateMatrices2D","thisArg","thisArg2","translatedCoordinate","offsets","numLayers","tmpCoord","scheduleExpireIconCache","labelCacheKey_","children_","previousElement","generateTileUrlFunction_","tileLoadingKeys_","getTileLoadFunction","getTileUrlFunction","getUrls","TileEventType","setTileLoadFunction","LayerGroup","layersListenerKeys_","listenerKeys_","handleLayersChanged_","handleLayerChange_","handleLayersAdd_","handleLayersRemove_","layersArray","collectionEvent","ownLayerState","FEATURE_READER","readRte","readTrk","readWpt","GPX_PARSERS","GPX_SERIALIZERS","RTE_SEQUENCE","RTE_SERIALIZERS","TRK_SEQUENCE","TRK_SERIALIZERS","writeWptType","GPX","readExtensions_","readExtensions","handleReadExtensions_","extensionsNode","featureReader","gpx","GPX_NODE_FACTORY","RTE_PARSERS","parseLink","parseExtensions","RTEPT_PARSERS","rteValues","layoutOptions","TRK_PARSERS","TRKSEG_PARSERS","TRKPT_PARSERS","trkValues","WPT_PARSERS","LINK_SEQUENCE","LINK_SERIALIZERS","writeLink","RTEPT_TYPE_SEQUENCE","TRKSEG_SERIALIZERS","TRKSEG_NODE_FACTORY","WPT_TYPE_SEQUENCE","WPT_TYPE_SERIALIZERS","applyLayoutOptions","link","IGCZ","BAROMETRIC","GPS","NONE","B_RECORD_RE","H_RECORD_RE","HFDTE_RECORD_RE","NEWLINE_RE","IGC","altitudeMode_","altitudeMode","year","month","day","lastDateTime","hour","minute","second","UTC","MOUSE_PROPS","MOUSE_DEFAULTS","PointerEvent","inType","inDict","createEvent","initEvent","bubbles","cancelable","buttons","pressure","tiltX","tiltY","twist","tangentialPressure","hwTimestamp","detail","PointerMap","SparseArrayMap","delete","has","CLONE_PROPS","CLONE_DEFAULTS","BOUNDARY_EVENTS","HAS_SVG_INSTANCE","SVGElementInstance","dispatcher","pointermap","eventMap","captureInfo","eventSources","eventSourceList","registerSource","newEvents","contained","ex","down","inEvent","fireEvent","enter","leave","over","cancel","leaveOut","enterOver","eventHandler","_handledByPE","addEvent","unlisten","removeEvent","eventName","boundHandler","makeEvent","relatedTarget","_target","cloneEvent","eventCopy","correspondingUseElement","capture","propagateDown","targets","setCapture","inPointerId","inTarget","skipDispatch","releaseCapture","implicitRelease","asyncDispatchEvent","targeting","shadow","inEl","shadowRoot","webkitShadowRoot","canTarget","elementFromPoint","targetingShadow","olderShadow","os","olderShadowRoot","se","allShadows","shadows","searchRoot","inRoot","sr","ssr","owner","DOCUMENT_NODE","DOCUMENT_FRAGMENT_NODE","findTarget","MO","MutationObserver","WebKitMutationObserver","OBSERVER_INIT","subtree","childList","attributeOldValue","attributeFilter","Installer","binder","addCallback","removeCallback","changedCallback","observer","mutationWatcher","rule","watchSubtree","observe","enableOnSubtree","readyState","installOnLoad","installNewSubtree","findElements","addElement","querySelectorAll","removeElement","elementChanged","concatLists","accum","list","isElement","flattenMutationTree","inNodes","tree","mutations","mutationHandler","addedNodes","removedNodes","attrib2css","hasNativePE","MSPointerEvent","hasShadowRoot","ShadowDOMPolyfill","head","createShadowRoot","BUTTON_TO_BUTTONS","HAS_BUTTONS","MouseEvent","INSTALLER","mouseEvents","POINTER_ID","POINTER_TYPE","lastTouches","isEventSimulatedFromTouch","lts","prepareEvent","pd","webkitForce","WEBKIT_FORCE_AT_MOUSE_DOWN","prepareButtonsForMove","which","mousedown","webkitmouseforcechanged","mousemove","mouseup","mouseover","mouseout","deactivateMouse","pointermap$1","touchEvents","elementAdded","touchActionToScrollType","_scrollType","elementRemoved","evts","oldSt","scrollTypes","firstTouch","isPrimaryTouch","inTouch","identifier","setPrimaryTouch","firstXY","scrolling","removePrimaryPointer","inPointer","typeToButtons","touchToPointer","cte","currentTouchEvent","radiusX","webkitRadiusX","radiusY","webkitRadiusY","force","altitudeAngle","azimuthAngle","touchType","processTouches","inFunction","shouldScroll","currentTarget","dya","dxa","findTouch","inTL","inId","vacuumTouches","touches","cancelOut","touchstart","dedupSynthMouse","overDown","outTarget","touchforcechange","touchmove","touchcancel","moveOverOut","pointer","outEvent","touchend","upOut","cleanUpPointer","lt","pointermap$2","HAS_BITMAP_TYPE","MSPOINTER_TYPE_MOUSE","msEvents","POINTER_TYPES","MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut","MSPointerOver","MSPointerCancel","MSLostPointerCapture","MSGotPointerCapture","assertActive","assertConnected","ownerDocument","inActiveButtonState","msPointerEnabled","msSetPointerCapture","msReleasePointerCapture","shadowSelector","applyAttributeStyles","msMaxTouchPoints","ontouchstart","applyPolyfill","Element","setPointerCapture","defineProperties","targetFinding","vectorRenderer_","layerImageRatio_","getImageRatio","vectorRenderer","imageFrameState","imageRatio","imageRatio_","getBlobFromURL_1","URL_REGEX","parseURLs","str","raw","quotation","embed","cssString","resourceURL","baseURL","resolvedURL","baseUrl","protocol","createHTMLDocument","base","resolveUrl","RegExp","escape","shouldEmbed","TIMEOUT","cacheBust","getTime","fetch","onloadend","readAsDataURL","req","onreadystatechange","encoder","ontimeout","reason","placeholder","imagePlaceholder","msg","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","rt","Processor","Pbf","ieee754","ArrayBuffer","isView","Varint","Fixed64","Bytes","Fixed32","readPackedEnd","toNum","isSigned","makeRoomForExtraLength","startPos","extraLen","realloc","writePackedVarint","writeVarint","writePackedSVarint","writeSVarint","writePackedFloat","writeFloat","writePackedDouble","writeDouble","writePackedBoolean","writeBoolean","writePackedFixed32","writeFixed32","writePackedSFixed32","writeSFixed32","writePackedFixed64","writeFixed64","writePackedSFixed64","writeSFixed64","readUInt32","writeInt32","readInt32","destroy","readField","skip","readMessage","readFixed32","readSFixed32","readFixed64","readSFixed64","readVarintRemainder","b3","bytesPerSequence","readUtf8","readBytes","subarray","readPackedVarint","readPackedSVarint","readPackedBoolean","readPackedFloat","readPackedDouble","readPackedFixed32","readPackedSFixed32","readPackedFixed64","readPackedSFixed64","writeTag","writeBigVarintLow","lsb","writeBigVarintHigh","writeBigVarint","writeString","lead","writeUtf8","writeBytes","writeRawMessage","writeMessage","writeBytesField","writeFixed32Field","writeSFixed32Field","writeFixed64Field","writeSFixed64Field","writeVarintField","writeSVarintField","writeStringField","writeFloatField","writeDoubleField","writeBooleanField","Cluster","cluster","setDistance","mapDistance","clustered","neighbors","neighbor","createCluster","newImageData","createMinion","workerHasImageData","_","newWorkerImageData","buffers","meta","numBuffers","numBytes","byteLength","images","Uint8ClampedArray","arrays","pixels","createWorker","onMessage","worker","_imageOps","workers","_onWorkerMessage","minion","createFauxWorker","_workers","_queue","_maxQueueLength","_running","_dataLookup","_job","inputs","_enqueue","_dispatch","_destroyed","job","slices","_resolveJob","hasImageData","createImageData","clonePseudoElements_1","cloneSingleNode","nativeNode","cloneNode","decorate","cssText","setProperty","getPropertyPriority","cloneCssStyle","HTMLTextAreaElement","HTMLInputElement","cloneInputValue","isRoot","clonedChild","cloneChildren","getPseudoElementStyle","pseudo","formatCssText","formatCssProperties","styleElement","clonePseudoElement","__importStar","embedResources_1","getCssRules","styleSheets","sheet","cssRules","getWebFontRules","CSSRule","FONT_FACE_RULE","parseWebFontRules","rules","parentStyleSheet","cssStrings","styleNode","sytleContent","embedImages","background","embedBackground","embedImageNode","deferreds","embedChildren","xmlns","foreignObject"],"mappings":"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","file":"common.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// run deferred modules from other chunks\n \tcheckDeferredModules();\n","/**\n * @module ol/xml\n */\nimport {extend} from './array.js';\n\n\n/**\n * When using {@link module:ol/xml~makeChildAppender} or\n * {@link module:ol/xml~makeSimpleNodeFactory}, the top `objectStack` item needs\n * to have this structure.\n * @typedef {Object} NodeStackItem\n * @property {Node} node\n */\n\n\n/**\n * @typedef {function(Element, Array<*>): void} Parser\n */\n\n\n/**\n * @typedef {function(Element, *, Array<*>): void} Serializer\n */\n\n\n/**\n * This document should be used when creating nodes for XML serializations. This\n * document is also used by {@link module:ol/xml~createElementNS}\n * @const\n * @type {Document}\n */\nexport const DOCUMENT = document.implementation.createDocument('', '', null);\n\n\n/**\n * @type {string}\n */\nexport const XML_SCHEMA_INSTANCE_URI = 'http://www.w3.org/2001/XMLSchema-instance';\n\n\n/**\n * @param {string} namespaceURI Namespace URI.\n * @param {string} qualifiedName Qualified name.\n * @return {Element} Node.\n */\nexport function createElementNS(namespaceURI, qualifiedName) {\n  return DOCUMENT.createElementNS(namespaceURI, qualifiedName);\n}\n\n\n/**\n * Recursively grab all text content of child nodes into a single string.\n * @param {Node} node Node.\n * @param {boolean} normalizeWhitespace Normalize whitespace: remove all line\n * breaks.\n * @return {string} All text content.\n * @api\n */\nexport function getAllTextContent(node, normalizeWhitespace) {\n  return getAllTextContent_(node, normalizeWhitespace, []).join('');\n}\n\n\n/**\n * Recursively grab all text content of child nodes into a single string.\n * @param {Node} node Node.\n * @param {boolean} normalizeWhitespace Normalize whitespace: remove all line\n * breaks.\n * @param {Array<string>} accumulator Accumulator.\n * @private\n * @return {Array<string>} Accumulator.\n */\nexport function getAllTextContent_(node, normalizeWhitespace, accumulator) {\n  if (node.nodeType == Node.CDATA_SECTION_NODE ||\n      node.nodeType == Node.TEXT_NODE) {\n    if (normalizeWhitespace) {\n      accumulator.push(String(node.nodeValue).replace(/(\\r\\n|\\r|\\n)/g, ''));\n    } else {\n      accumulator.push(node.nodeValue);\n    }\n  } else {\n    let n;\n    for (n = node.firstChild; n; n = n.nextSibling) {\n      getAllTextContent_(n, normalizeWhitespace, accumulator);\n    }\n  }\n  return accumulator;\n}\n\n\n/**\n * @param {Object} object Object.\n * @return {boolean} Is a document.\n */\nexport function isDocument(object) {\n  return 'documentElement' in object;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {?string} namespaceURI Namespace URI.\n * @param {string} name Attribute name.\n * @return {string} Value\n */\nexport function getAttributeNS(node, namespaceURI, name) {\n  return node.getAttributeNS(namespaceURI, name) || '';\n}\n\n\n/**\n * Parse an XML string to an XML Document.\n * @param {string} xml XML.\n * @return {Document} Document.\n * @api\n */\nexport function parse(xml) {\n  return new DOMParser().parseFromString(xml, 'application/xml');\n}\n\n\n/**\n * Make an array extender function for extending the array at the top of the\n * object stack.\n * @param {function(this: T, Node, Array<*>): (Array<*>|undefined)} valueReader Value reader.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeArrayExtender(valueReader, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const array = /** @type {Array<*>} */ (objectStack[objectStack.length - 1]);\n        extend(array, value);\n      }\n    }\n  );\n}\n\n\n/**\n * Make an array pusher function for pushing to the array at the top of the\n * object stack.\n * @param {function(this: T, Element, Array<*>): *} valueReader Value reader.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeArrayPusher(valueReader, opt_this) {\n  return (\n    /**\n     * @param {Element} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const array = /** @type {Array<*>} */ (objectStack[objectStack.length - 1]);\n        array.push(value);\n      }\n    });\n}\n\n\n/**\n * Make an object stack replacer function for replacing the object at the\n * top of the stack.\n * @param {function(this: T, Node, Array<*>): *} valueReader Value reader.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeReplacer(valueReader, opt_this) {\n  return (\n    /**\n     * @param {Node} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        objectStack[objectStack.length - 1] = value;\n      }\n    });\n}\n\n\n/**\n * Make an object property pusher function for adding a property to the\n * object at the top of the stack.\n * @param {function(this: T, Element, Array<*>): *} valueReader Value reader.\n * @param {string=} opt_property Property.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeObjectPropertyPusher(valueReader, opt_property, opt_this) {\n  return (\n    /**\n     * @param {Element} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const object = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n        const property = opt_property !== undefined ? opt_property : node.localName;\n        let array;\n        if (property in object) {\n          array = object[property];\n        } else {\n          array = object[property] = [];\n        }\n        array.push(value);\n      }\n    });\n}\n\n\n/**\n * Make an object property setter function.\n * @param {function(this: T, Element, Array<*>): *} valueReader Value reader.\n * @param {string=} opt_property Property.\n * @param {T=} opt_this The object to use as `this` in `valueReader`.\n * @return {Parser} Parser.\n * @template T\n */\nexport function makeObjectPropertySetter(valueReader, opt_property, opt_this) {\n  return (\n    /**\n     * @param {Element} node Node.\n     * @param {Array<*>} objectStack Object stack.\n     */\n    function(node, objectStack) {\n      const value = valueReader.call(opt_this !== undefined ? opt_this : this, node, objectStack);\n      if (value !== undefined) {\n        const object = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n        const property = opt_property !== undefined ? opt_property : node.localName;\n        object[property] = value;\n      }\n    });\n}\n\n\n/**\n * Create a serializer that appends nodes written by its `nodeWriter` to its\n * designated parent. The parent is the `node` of the\n * {@link module:ol/xml~NodeStackItem} at the top of the `objectStack`.\n * @param {function(this: T, Node, V, Array<*>): void} nodeWriter Node writer.\n * @param {T=} opt_this The object to use as `this` in `nodeWriter`.\n * @return {Serializer} Serializer.\n * @template T, V\n */\nexport function makeChildAppender(nodeWriter, opt_this) {\n  return function(node, value, objectStack) {\n    nodeWriter.call(opt_this !== undefined ? opt_this : this, node, value, objectStack);\n    const parent = /** @type {NodeStackItem} */ (objectStack[objectStack.length - 1]);\n    const parentNode = parent.node;\n    parentNode.appendChild(node);\n  };\n}\n\n\n/**\n * Create a serializer that calls the provided `nodeWriter` from\n * {@link module:ol/xml~serialize}. This can be used by the parent writer to have the\n * 'nodeWriter' called with an array of values when the `nodeWriter` was\n * designed to serialize a single item. An example would be a LineString\n * geometry writer, which could be reused for writing MultiLineString\n * geometries.\n * @param {function(this: T, Element, V, Array<*>): void} nodeWriter Node writer.\n * @param {T=} opt_this The object to use as `this` in `nodeWriter`.\n * @return {Serializer} Serializer.\n * @template T, V\n */\nexport function makeArraySerializer(nodeWriter, opt_this) {\n  let serializersNS, nodeFactory;\n  return function(node, value, objectStack) {\n    if (serializersNS === undefined) {\n      serializersNS = {};\n      const serializers = {};\n      serializers[node.localName] = nodeWriter;\n      serializersNS[node.namespaceURI] = serializers;\n      nodeFactory = makeSimpleNodeFactory(node.localName);\n    }\n    serialize(serializersNS, nodeFactory, value, objectStack);\n  };\n}\n\n\n/**\n * Create a node factory which can use the `opt_keys` passed to\n * {@link module:ol/xml~serialize} or {@link module:ol/xml~pushSerializeAndPop} as node names,\n * or a fixed node name. The namespace of the created nodes can either be fixed,\n * or the parent namespace will be used.\n * @param {string=} opt_nodeName Fixed node name which will be used for all\n *     created nodes. If not provided, the 3rd argument to the resulting node\n *     factory needs to be provided and will be the nodeName.\n * @param {string=} opt_namespaceURI Fixed namespace URI which will be used for\n *     all created nodes. If not provided, the namespace of the parent node will\n *     be used.\n * @return {function(*, Array<*>, string=): (Node|undefined)} Node factory.\n */\nexport function makeSimpleNodeFactory(opt_nodeName, opt_namespaceURI) {\n  const fixedNodeName = opt_nodeName;\n  return (\n    /**\n     * @param {*} value Value.\n     * @param {Array<*>} objectStack Object stack.\n     * @param {string=} opt_nodeName Node name.\n     * @return {Node} Node.\n     */\n    function(value, objectStack, opt_nodeName) {\n      const context = /** @type {NodeStackItem} */ (objectStack[objectStack.length - 1]);\n      const node = context.node;\n      let nodeName = fixedNodeName;\n      if (nodeName === undefined) {\n        nodeName = opt_nodeName;\n      }\n\n      const namespaceURI = opt_namespaceURI !== undefined ? opt_namespaceURI : node.namespaceURI;\n      return createElementNS(namespaceURI, /** @type {string} */ (nodeName));\n    }\n  );\n}\n\n\n/**\n * A node factory that creates a node using the parent's `namespaceURI` and the\n * `nodeName` passed by {@link module:ol/xml~serialize} or\n * {@link module:ol/xml~pushSerializeAndPop} to the node factory.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nexport const OBJECT_PROPERTY_NODE_FACTORY = makeSimpleNodeFactory();\n\n\n/**\n * Create an array of `values` to be used with {@link module:ol/xml~serialize} or\n * {@link module:ol/xml~pushSerializeAndPop}, where `orderedKeys` has to be provided as\n * `opt_key` argument.\n * @param {Object<string, *>} object Key-value pairs for the sequence. Keys can\n *     be a subset of the `orderedKeys`.\n * @param {Array<string>} orderedKeys Keys in the order of the sequence.\n * @return {Array<*>} Values in the order of the sequence. The resulting array\n *     has the same length as the `orderedKeys` array. Values that are not\n *     present in `object` will be `undefined` in the resulting array.\n */\nexport function makeSequence(object, orderedKeys) {\n  const length = orderedKeys.length;\n  const sequence = new Array(length);\n  for (let i = 0; i < length; ++i) {\n    sequence[i] = object[orderedKeys[i]];\n  }\n  return sequence;\n}\n\n\n/**\n * Create a namespaced structure, using the same values for each namespace.\n * This can be used as a starting point for versioned parsers, when only a few\n * values are version specific.\n * @param {Array<string>} namespaceURIs Namespace URIs.\n * @param {T} structure Structure.\n * @param {Object<string, T>=} opt_structureNS Namespaced structure to add to.\n * @return {Object<string, T>} Namespaced structure.\n * @template T\n */\nexport function makeStructureNS(namespaceURIs, structure, opt_structureNS) {\n  /**\n   * @type {Object<string, T>}\n   */\n  const structureNS = opt_structureNS !== undefined ? opt_structureNS : {};\n  let i, ii;\n  for (i = 0, ii = namespaceURIs.length; i < ii; ++i) {\n    structureNS[namespaceURIs[i]] = structure;\n  }\n  return structureNS;\n}\n\n\n/**\n * Parse a node using the parsers and object stack.\n * @param {Object<string, Object<string, Parser>>} parsersNS\n *     Parsers by namespace.\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @param {*=} opt_this The object to use as `this`.\n */\nexport function parseNode(parsersNS, node, objectStack, opt_this) {\n  let n;\n  for (n = node.firstElementChild; n; n = n.nextElementSibling) {\n    const parsers = parsersNS[n.namespaceURI];\n    if (parsers !== undefined) {\n      const parser = parsers[n.localName];\n      if (parser !== undefined) {\n        parser.call(opt_this, n, objectStack);\n      }\n    }\n  }\n}\n\n\n/**\n * Push an object on top of the stack, parse and return the popped object.\n * @param {T} object Object.\n * @param {Object<string, Object<string, Parser>>} parsersNS\n *     Parsers by namespace.\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @param {*=} opt_this The object to use as `this`.\n * @return {T} Object.\n * @template T\n */\nexport function pushParseAndPop(object, parsersNS, node, objectStack, opt_this) {\n  objectStack.push(object);\n  parseNode(parsersNS, node, objectStack, opt_this);\n  return /** @type {T} */ (objectStack.pop());\n}\n\n\n/**\n * Walk through an array of `values` and call a serializer for each value.\n * @param {Object<string, Object<string, Serializer>>} serializersNS\n *     Namespaced serializers.\n * @param {function(this: T, *, Array<*>, (string|undefined)): (Node|undefined)} nodeFactory\n *     Node factory. The `nodeFactory` creates the node whose namespace and name\n *     will be used to choose a node writer from `serializersNS`. This\n *     separation allows us to decide what kind of node to create, depending on\n *     the value we want to serialize. An example for this would be different\n *     geometry writers based on the geometry type.\n * @param {Array<*>} values Values to serialize. An example would be an array\n *     of {@link module:ol/Feature~Feature} instances.\n * @param {Array<*>} objectStack Node stack.\n * @param {Array<string>=} opt_keys Keys of the `values`. Will be passed to the\n *     `nodeFactory`. This is used for serializing object literals where the\n *     node name relates to the property key. The array length of `opt_keys` has\n *     to match the length of `values`. For serializing a sequence, `opt_keys`\n *     determines the order of the sequence.\n * @param {T=} opt_this The object to use as `this` for the node factory and\n *     serializers.\n * @template T\n */\nexport function serialize(\n  serializersNS, nodeFactory, values, objectStack, opt_keys, opt_this) {\n  const length = (opt_keys !== undefined ? opt_keys : values).length;\n  let value, node;\n  for (let i = 0; i < length; ++i) {\n    value = values[i];\n    if (value !== undefined) {\n      node = nodeFactory.call(opt_this !== undefined ? opt_this : this, value, objectStack,\n        opt_keys !== undefined ? opt_keys[i] : undefined);\n      if (node !== undefined) {\n        serializersNS[node.namespaceURI][node.localName]\n          .call(opt_this, node, value, objectStack);\n      }\n    }\n  }\n}\n\n\n/**\n * @param {O} object Object.\n * @param {Object<string, Object<string, Serializer>>} serializersNS\n *     Namespaced serializers.\n * @param {function(this: T, *, Array<*>, (string|undefined)): (Node|undefined)} nodeFactory\n *     Node factory. The `nodeFactory` creates the node whose namespace and name\n *     will be used to choose a node writer from `serializersNS`. This\n *     separation allows us to decide what kind of node to create, depending on\n *     the value we want to serialize. An example for this would be different\n *     geometry writers based on the geometry type.\n * @param {Array<*>} values Values to serialize. An example would be an array\n *     of {@link module:ol/Feature~Feature} instances.\n * @param {Array<*>} objectStack Node stack.\n * @param {Array<string>=} opt_keys Keys of the `values`. Will be passed to the\n *     `nodeFactory`. This is used for serializing object literals where the\n *     node name relates to the property key. The array length of `opt_keys` has\n *     to match the length of `values`. For serializing a sequence, `opt_keys`\n *     determines the order of the sequence.\n * @param {T=} opt_this The object to use as `this` for the node factory and\n *     serializers.\n * @return {O|undefined} Object.\n * @template O, T\n */\nexport function pushSerializeAndPop(object, serializersNS, nodeFactory, values, objectStack, opt_keys, opt_this) {\n  objectStack.push(object);\n  serialize(serializersNS, nodeFactory, values, objectStack, opt_keys, opt_this);\n  return /** @type {O|undefined} */ (objectStack.pop());\n}\n","/**\n * @module ol/extent\n */\nimport {assert} from './asserts.js';\nimport Corner from './extent/Corner.js';\nimport Relationship from './extent/Relationship.js';\n\n\n/**\n * An array of numbers representing an extent: `[minx, miny, maxx, maxy]`.\n * @typedef {Array<number>} Extent\n * @api\n */\n\n/**\n * Build an extent that includes all given coordinates.\n *\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates Coordinates.\n * @return {Extent} Bounding extent.\n * @api\n */\nexport function boundingExtent(coordinates) {\n  const extent = createEmpty();\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Array<number>} xs Xs.\n * @param {Array<number>} ys Ys.\n * @param {Extent=} opt_extent Destination extent.\n * @private\n * @return {Extent} Extent.\n */\nfunction _boundingExtentXYs(xs, ys, opt_extent) {\n  const minX = Math.min.apply(null, xs);\n  const minY = Math.min.apply(null, ys);\n  const maxX = Math.max.apply(null, xs);\n  const maxY = Math.max.apply(null, ys);\n  return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n}\n\n\n/**\n * Return extent increased by the provided value.\n * @param {Extent} extent Extent.\n * @param {number} value The amount by which the extent should be buffered.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n * @api\n */\nexport function buffer(extent, value, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0] - value;\n    opt_extent[1] = extent[1] - value;\n    opt_extent[2] = extent[2] + value;\n    opt_extent[3] = extent[3] + value;\n    return opt_extent;\n  } else {\n    return [\n      extent[0] - value,\n      extent[1] - value,\n      extent[2] + value,\n      extent[3] + value\n    ];\n  }\n}\n\n\n/**\n * Creates a clone of an extent.\n *\n * @param {Extent} extent Extent to clone.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} The clone.\n */\nexport function clone(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent.slice();\n  }\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {number} Closest squared distance.\n */\nexport function closestSquaredDistanceXY(extent, x, y) {\n  let dx, dy;\n  if (x < extent[0]) {\n    dx = extent[0] - x;\n  } else if (extent[2] < x) {\n    dx = x - extent[2];\n  } else {\n    dx = 0;\n  }\n  if (y < extent[1]) {\n    dy = extent[1] - y;\n  } else if (extent[3] < y) {\n    dy = y - extent[3];\n  } else {\n    dy = 0;\n  }\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {Extent} extent Extent.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @return {boolean} The coordinate is contained in the extent.\n * @api\n */\nexport function containsCoordinate(extent, coordinate) {\n  return containsXY(extent, coordinate[0], coordinate[1]);\n}\n\n\n/**\n * Check if one extent contains another.\n *\n * An extent is deemed contained if it lies completely within the other extent,\n * including if they share one or more edges.\n *\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {boolean} The second extent is contained by or on the edge of the\n *     first.\n * @api\n */\nexport function containsExtent(extent1, extent2) {\n  return extent1[0] <= extent2[0] && extent2[2] <= extent1[2] &&\n      extent1[1] <= extent2[1] && extent2[3] <= extent1[3];\n}\n\n\n/**\n * Check if the passed coordinate is contained or on the edge of the extent.\n *\n * @param {Extent} extent Extent.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n * @return {boolean} The x, y values are contained in the extent.\n * @api\n */\nexport function containsXY(extent, x, y) {\n  return extent[0] <= x && x <= extent[2] && extent[1] <= y && y <= extent[3];\n}\n\n\n/**\n * Get the relationship between a coordinate and extent.\n * @param {Extent} extent The extent.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate The coordinate.\n * @return {Relationship} The relationship (bitwise compare with\n *     import(\"./extent/Relationship.js\").Relationship).\n */\nexport function coordinateRelationship(extent, coordinate) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const x = coordinate[0];\n  const y = coordinate[1];\n  let relationship = Relationship.UNKNOWN;\n  if (x < minX) {\n    relationship = relationship | Relationship.LEFT;\n  } else if (x > maxX) {\n    relationship = relationship | Relationship.RIGHT;\n  }\n  if (y < minY) {\n    relationship = relationship | Relationship.BELOW;\n  } else if (y > maxY) {\n    relationship = relationship | Relationship.ABOVE;\n  }\n  if (relationship === Relationship.UNKNOWN) {\n    relationship = Relationship.INTERSECTING;\n  }\n  return relationship;\n}\n\n\n/**\n * Create an empty extent.\n * @return {Extent} Empty extent.\n * @api\n */\nexport function createEmpty() {\n  return [Infinity, Infinity, -Infinity, -Infinity];\n}\n\n\n/**\n * Create a new extent or update the provided extent.\n * @param {number} minX Minimum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxX Maximum X.\n * @param {number} maxY Maximum Y.\n * @param {Extent=} opt_extent Destination extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdate(minX, minY, maxX, maxY, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = minX;\n    opt_extent[1] = minY;\n    opt_extent[2] = maxX;\n    opt_extent[3] = maxY;\n    return opt_extent;\n  } else {\n    return [minX, minY, maxX, maxY];\n  }\n}\n\n\n/**\n * Create a new empty extent or make the provided one empty.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateEmpty(opt_extent) {\n  return createOrUpdate(\n    Infinity, Infinity, -Infinity, -Infinity, opt_extent);\n}\n\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromCoordinate(coordinate, opt_extent) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  return createOrUpdate(x, y, x, y, opt_extent);\n}\n\n\n/**\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates Coordinates.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromCoordinates(coordinates, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendCoordinates(extent, coordinates);\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromFlatCoordinates(flatCoordinates, offset, end, stride, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendFlatCoordinates(extent, flatCoordinates, offset, end, stride);\n}\n\n/**\n * @param {Array<Array<import(\"./coordinate.js\").Coordinate>>} rings Rings.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n */\nexport function createOrUpdateFromRings(rings, opt_extent) {\n  const extent = createOrUpdateEmpty(opt_extent);\n  return extendRings(extent, rings);\n}\n\n\n/**\n * Determine if two extents are equivalent.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {boolean} The two extents are equivalent.\n * @api\n */\nexport function equals(extent1, extent2) {\n  return extent1[0] == extent2[0] && extent1[2] == extent2[2] &&\n      extent1[1] == extent2[1] && extent1[3] == extent2[3];\n}\n\n\n/**\n * Modify an extent to include another extent.\n * @param {Extent} extent1 The extent to be modified.\n * @param {Extent} extent2 The extent that will be included in the first.\n * @return {Extent} A reference to the first (extended) extent.\n * @api\n */\nexport function extend(extent1, extent2) {\n  if (extent2[0] < extent1[0]) {\n    extent1[0] = extent2[0];\n  }\n  if (extent2[2] > extent1[2]) {\n    extent1[2] = extent2[2];\n  }\n  if (extent2[1] < extent1[1]) {\n    extent1[1] = extent2[1];\n  }\n  if (extent2[3] > extent1[3]) {\n    extent1[3] = extent2[3];\n  }\n  return extent1;\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n */\nexport function extendCoordinate(extent, coordinate) {\n  if (coordinate[0] < extent[0]) {\n    extent[0] = coordinate[0];\n  }\n  if (coordinate[0] > extent[2]) {\n    extent[2] = coordinate[0];\n  }\n  if (coordinate[1] < extent[1]) {\n    extent[1] = coordinate[1];\n  }\n  if (coordinate[1] > extent[3]) {\n    extent[3] = coordinate[1];\n  }\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates Coordinates.\n * @return {Extent} Extent.\n */\nexport function extendCoordinates(extent, coordinates) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    extendCoordinate(extent, coordinates[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {Extent} Extent.\n */\nexport function extendFlatCoordinates(extent, flatCoordinates, offset, end, stride) {\n  for (; offset < end; offset += stride) {\n    extendXY(extent, flatCoordinates[offset], flatCoordinates[offset + 1]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {Array<Array<import(\"./coordinate.js\").Coordinate>>} rings Rings.\n * @return {Extent} Extent.\n */\nexport function extendRings(extent, rings) {\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    extendCoordinates(extent, rings[i]);\n  }\n  return extent;\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {number} x X.\n * @param {number} y Y.\n */\nexport function extendXY(extent, x, y) {\n  extent[0] = Math.min(extent[0], x);\n  extent[1] = Math.min(extent[1], y);\n  extent[2] = Math.max(extent[2], x);\n  extent[3] = Math.max(extent[3], y);\n}\n\n\n/**\n * This function calls `callback` for each corner of the extent. If the\n * callback returns a truthy value the function returns that value\n * immediately. Otherwise the function returns `false`.\n * @param {Extent} extent Extent.\n * @param {function(import(\"./coordinate.js\").Coordinate): S} callback Callback.\n * @return {S|boolean} Value.\n * @template S\n */\nexport function forEachCorner(extent, callback) {\n  let val;\n  val = callback(getBottomLeft(extent));\n  if (val) {\n    return val;\n  }\n  val = callback(getBottomRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback(getTopRight(extent));\n  if (val) {\n    return val;\n  }\n  val = callback(getTopLeft(extent));\n  if (val) {\n    return val;\n  }\n  return false;\n}\n\n\n/**\n * Get the size of an extent.\n * @param {Extent} extent Extent.\n * @return {number} Area.\n * @api\n */\nexport function getArea(extent) {\n  let area = 0;\n  if (!isEmpty(extent)) {\n    area = getWidth(extent) * getHeight(extent);\n  }\n  return area;\n}\n\n\n/**\n * Get the bottom left coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Bottom left coordinate.\n * @api\n */\nexport function getBottomLeft(extent) {\n  return [extent[0], extent[1]];\n}\n\n\n/**\n * Get the bottom right coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Bottom right coordinate.\n * @api\n */\nexport function getBottomRight(extent) {\n  return [extent[2], extent[1]];\n}\n\n\n/**\n * Get the center coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Center.\n * @api\n */\nexport function getCenter(extent) {\n  return [(extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2];\n}\n\n\n/**\n * Get a corner coordinate of an extent.\n * @param {Extent} extent Extent.\n * @param {Corner} corner Corner.\n * @return {import(\"./coordinate.js\").Coordinate} Corner coordinate.\n */\nexport function getCorner(extent, corner) {\n  let coordinate;\n  if (corner === Corner.BOTTOM_LEFT) {\n    coordinate = getBottomLeft(extent);\n  } else if (corner === Corner.BOTTOM_RIGHT) {\n    coordinate = getBottomRight(extent);\n  } else if (corner === Corner.TOP_LEFT) {\n    coordinate = getTopLeft(extent);\n  } else if (corner === Corner.TOP_RIGHT) {\n    coordinate = getTopRight(extent);\n  } else {\n    assert(false, 13); // Invalid corner\n  }\n  return coordinate;\n}\n\n\n/**\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {number} Enlarged area.\n */\nexport function getEnlargedArea(extent1, extent2) {\n  const minX = Math.min(extent1[0], extent2[0]);\n  const minY = Math.min(extent1[1], extent2[1]);\n  const maxX = Math.max(extent1[2], extent2[2]);\n  const maxY = Math.max(extent1[3], extent2[3]);\n  return (maxX - minX) * (maxY - minY);\n}\n\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate} center Center.\n * @param {number} resolution Resolution.\n * @param {number} rotation Rotation.\n * @param {import(\"./size.js\").Size} size Size.\n * @param {Extent=} opt_extent Destination extent.\n * @return {Extent} Extent.\n */\nexport function getForViewAndSize(center, resolution, rotation, size, opt_extent) {\n  const dx = resolution * size[0] / 2;\n  const dy = resolution * size[1] / 2;\n  const cosRotation = Math.cos(rotation);\n  const sinRotation = Math.sin(rotation);\n  const xCos = dx * cosRotation;\n  const xSin = dx * sinRotation;\n  const yCos = dy * cosRotation;\n  const ySin = dy * sinRotation;\n  const x = center[0];\n  const y = center[1];\n  const x0 = x - xCos + ySin;\n  const x1 = x - xCos - ySin;\n  const x2 = x + xCos - ySin;\n  const x3 = x + xCos + ySin;\n  const y0 = y - xSin - yCos;\n  const y1 = y - xSin + yCos;\n  const y2 = y + xSin + yCos;\n  const y3 = y + xSin - yCos;\n  return createOrUpdate(\n    Math.min(x0, x1, x2, x3), Math.min(y0, y1, y2, y3),\n    Math.max(x0, x1, x2, x3), Math.max(y0, y1, y2, y3),\n    opt_extent);\n}\n\n\n/**\n * Get the height of an extent.\n * @param {Extent} extent Extent.\n * @return {number} Height.\n * @api\n */\nexport function getHeight(extent) {\n  return extent[3] - extent[1];\n}\n\n\n/**\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @return {number} Intersection area.\n */\nexport function getIntersectionArea(extent1, extent2) {\n  const intersection = getIntersection(extent1, extent2);\n  return getArea(intersection);\n}\n\n\n/**\n * Get the intersection of two extents.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent 2.\n * @param {Extent=} opt_extent Optional extent to populate with intersection.\n * @return {Extent} Intersecting extent.\n * @api\n */\nexport function getIntersection(extent1, extent2, opt_extent) {\n  const intersection = opt_extent ? opt_extent : createEmpty();\n  if (intersects(extent1, extent2)) {\n    if (extent1[0] > extent2[0]) {\n      intersection[0] = extent1[0];\n    } else {\n      intersection[0] = extent2[0];\n    }\n    if (extent1[1] > extent2[1]) {\n      intersection[1] = extent1[1];\n    } else {\n      intersection[1] = extent2[1];\n    }\n    if (extent1[2] < extent2[2]) {\n      intersection[2] = extent1[2];\n    } else {\n      intersection[2] = extent2[2];\n    }\n    if (extent1[3] < extent2[3]) {\n      intersection[3] = extent1[3];\n    } else {\n      intersection[3] = extent2[3];\n    }\n  } else {\n    createOrUpdateEmpty(intersection);\n  }\n  return intersection;\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @return {number} Margin.\n */\nexport function getMargin(extent) {\n  return getWidth(extent) + getHeight(extent);\n}\n\n\n/**\n * Get the size (width, height) of an extent.\n * @param {Extent} extent The extent.\n * @return {import(\"./size.js\").Size} The extent size.\n * @api\n */\nexport function getSize(extent) {\n  return [extent[2] - extent[0], extent[3] - extent[1]];\n}\n\n\n/**\n * Get the top left coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Top left coordinate.\n * @api\n */\nexport function getTopLeft(extent) {\n  return [extent[0], extent[3]];\n}\n\n\n/**\n * Get the top right coordinate of an extent.\n * @param {Extent} extent Extent.\n * @return {import(\"./coordinate.js\").Coordinate} Top right coordinate.\n * @api\n */\nexport function getTopRight(extent) {\n  return [extent[2], extent[3]];\n}\n\n\n/**\n * Get the width of an extent.\n * @param {Extent} extent Extent.\n * @return {number} Width.\n * @api\n */\nexport function getWidth(extent) {\n  return extent[2] - extent[0];\n}\n\n\n/**\n * Determine if one extent intersects another.\n * @param {Extent} extent1 Extent 1.\n * @param {Extent} extent2 Extent.\n * @return {boolean} The two extents intersect.\n * @api\n */\nexport function intersects(extent1, extent2) {\n  return extent1[0] <= extent2[2] &&\n      extent1[2] >= extent2[0] &&\n      extent1[1] <= extent2[3] &&\n      extent1[3] >= extent2[1];\n}\n\n\n/**\n * Determine if an extent is empty.\n * @param {Extent} extent Extent.\n * @return {boolean} Is empty.\n * @api\n */\nexport function isEmpty(extent) {\n  return extent[2] < extent[0] || extent[3] < extent[1];\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {Extent=} opt_extent Extent.\n * @return {Extent} Extent.\n */\nexport function returnOrUpdate(extent, opt_extent) {\n  if (opt_extent) {\n    opt_extent[0] = extent[0];\n    opt_extent[1] = extent[1];\n    opt_extent[2] = extent[2];\n    opt_extent[3] = extent[3];\n    return opt_extent;\n  } else {\n    return extent;\n  }\n}\n\n\n/**\n * @param {Extent} extent Extent.\n * @param {number} value Value.\n */\nexport function scaleFromCenter(extent, value) {\n  const deltaX = ((extent[2] - extent[0]) / 2) * (value - 1);\n  const deltaY = ((extent[3] - extent[1]) / 2) * (value - 1);\n  extent[0] -= deltaX;\n  extent[2] += deltaX;\n  extent[1] -= deltaY;\n  extent[3] += deltaY;\n}\n\n\n/**\n * Determine if the segment between two coordinates intersects (crosses,\n * touches, or is contained by) the provided extent.\n * @param {Extent} extent The extent.\n * @param {import(\"./coordinate.js\").Coordinate} start Segment start coordinate.\n * @param {import(\"./coordinate.js\").Coordinate} end Segment end coordinate.\n * @return {boolean} The segment intersects the extent.\n */\nexport function intersectsSegment(extent, start, end) {\n  let intersects = false;\n  const startRel = coordinateRelationship(extent, start);\n  const endRel = coordinateRelationship(extent, end);\n  if (startRel === Relationship.INTERSECTING ||\n      endRel === Relationship.INTERSECTING) {\n    intersects = true;\n  } else {\n    const minX = extent[0];\n    const minY = extent[1];\n    const maxX = extent[2];\n    const maxY = extent[3];\n    const startX = start[0];\n    const startY = start[1];\n    const endX = end[0];\n    const endY = end[1];\n    const slope = (endY - startY) / (endX - startX);\n    let x, y;\n    if (!!(endRel & Relationship.ABOVE) &&\n        !(startRel & Relationship.ABOVE)) {\n      // potentially intersects top\n      x = endX - ((endY - maxY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.RIGHT) &&\n        !(startRel & Relationship.RIGHT)) {\n      // potentially intersects right\n      y = endY - ((endX - maxX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n    if (!intersects && !!(endRel & Relationship.BELOW) &&\n        !(startRel & Relationship.BELOW)) {\n      // potentially intersects bottom\n      x = endX - ((endY - minY) / slope);\n      intersects = x >= minX && x <= maxX;\n    }\n    if (!intersects && !!(endRel & Relationship.LEFT) &&\n        !(startRel & Relationship.LEFT)) {\n      // potentially intersects left\n      y = endY - ((endX - minX) * slope);\n      intersects = y >= minY && y <= maxY;\n    }\n\n  }\n  return intersects;\n}\n\n\n/**\n * Apply a transform function to the extent.\n * @param {Extent} extent Extent.\n * @param {import(\"./proj.js\").TransformFunction} transformFn Transform function.\n * Called with `[minX, minY, maxX, maxY]` extent coordinates.\n * @param {Extent=} opt_extent Destination extent.\n * @return {Extent} Extent.\n * @api\n */\nexport function applyTransform(extent, transformFn, opt_extent) {\n  const coordinates = [\n    extent[0], extent[1],\n    extent[0], extent[3],\n    extent[2], extent[1],\n    extent[2], extent[3]\n  ];\n  transformFn(coordinates, coordinates, 2);\n  const xs = [coordinates[0], coordinates[2], coordinates[4], coordinates[6]];\n  const ys = [coordinates[1], coordinates[3], coordinates[5], coordinates[7]];\n  return _boundingExtentXYs(xs, ys, opt_extent);\n}\n","/**\n * @module ol/centerconstraint\n */\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((import(\"./coordinate.js\").Coordinate|undefined), number, import(\"./size.js\").Size, boolean=): (import(\"./coordinate.js\").Coordinate|undefined)} Type\n */\n\n\n/**\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {boolean} onlyCenter If true, the constraint will only apply to the view center.\n * @param {boolean} smooth If true, the view will be able to go slightly out of the given extent\n * (only during interaction and animation).\n * @return {Type} The constraint.\n */\nexport function createExtent(extent, onlyCenter, smooth) {\n  return (\n    /**\n     * @param {import(\"./coordinate.js\").Coordinate|undefined} center Center.\n     * @param {number} resolution Resolution.\n     * @param {import(\"./size.js\").Size} size Viewport size; unused if `onlyCenter` was specified.\n     * @param {boolean=} opt_isMoving True if an interaction or animation is in progress.\n     * @return {import(\"./coordinate.js\").Coordinate|undefined} Center.\n     */\n    function(center, resolution, size, opt_isMoving) {\n      if (center) {\n        const viewWidth = onlyCenter ? 0 : size[0] * resolution;\n        const viewHeight = onlyCenter ? 0 : size[1] * resolution;\n        let minX = extent[0] + viewWidth / 2;\n        let maxX = extent[2] - viewWidth / 2;\n        let minY = extent[1] + viewHeight / 2;\n        let maxY = extent[3] - viewHeight / 2;\n\n        // note: when zooming out of bounds, min and max values for x and y may\n        // end up inverted (min > max); this has to be accounted for\n        if (minX > maxX) {\n          minX = maxX = (maxX + minX) / 2;\n        }\n        if (minY > maxY) {\n          minY = maxY = (maxY + minY) / 2;\n        }\n\n        let x = clamp(center[0], minX, maxX);\n        let y = clamp(center[1], minY, maxY);\n        const ratio = 30 * resolution;\n\n        // during an interaction, allow some overscroll\n        if (opt_isMoving && smooth) {\n          x += -ratio * Math.log(1 + Math.max(0, minX - center[0]) / ratio) +\n            ratio * Math.log(1 + Math.max(0, center[0] - maxX) / ratio);\n          y += -ratio * Math.log(1 + Math.max(0, minY - center[1]) / ratio) +\n            ratio * Math.log(1 + Math.max(0, center[1] - maxY) / ratio);\n        }\n\n        return [x, y];\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {import(\"./coordinate.js\").Coordinate=} center Center.\n * @return {import(\"./coordinate.js\").Coordinate|undefined} Center.\n */\nexport function none(center) {\n  return center;\n}\n","/**\n * @module ol/resolutionconstraint\n */\nimport {linearFindNearest} from './array.js';\nimport {getHeight, getWidth} from './extent.js';\nimport {clamp} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), number, import(\"./size.js\").Size, boolean=): (number|undefined)} Type\n */\n\n/**\n * Returns a modified resolution taking into acocunt the viewport size and maximum\n * allowed extent.\n * @param {number} resolution Resolution\n * @param {import(\"./extent.js\").Extent=} maxExtent Maximum allowed extent.\n * @param {import(\"./size.js\").Size} viewportSize Viewport size.\n * @return {number} Capped resolution.\n */\nfunction getViewportClampedResolution(resolution, maxExtent, viewportSize) {\n  const xResolution = getWidth(maxExtent) / viewportSize[0];\n  const yResolution = getHeight(maxExtent) / viewportSize[1];\n  return Math.min(resolution, Math.min(xResolution, yResolution));\n}\n\n/**\n * Returns a modified resolution to be between maxResolution and minResolution while\n * still allowing the value to be slightly out of bounds.\n * Note: the computation is based on the logarithm function (ln):\n *  - at 1, ln(x) is 0\n *  - above 1, ln(x) keeps increasing but at a much slower pace than x\n * The final result is clamped to prevent getting too far away from bounds.\n * @param {number} resolution Resolution.\n * @param {number} maxResolution Max resolution.\n * @param {number} minResolution Min resolution.\n * @return {number} Smoothed resolution.\n */\nfunction getSmoothClampedResolution(resolution, maxResolution, minResolution) {\n  let result = Math.min(resolution, maxResolution);\n  const ratio = 50;\n\n  result *= Math.log(1 + ratio * Math.max(0, resolution / maxResolution - 1)) / ratio + 1;\n  if (minResolution) {\n    result = Math.max(result, minResolution);\n    result /= Math.log(1 + ratio * Math.max(0, minResolution / resolution - 1)) / ratio + 1;\n  }\n  return clamp(result, minResolution / 2, maxResolution * 2);\n}\n\n/**\n * @param {Array<number>} resolutions Resolutions.\n * @param {boolean=} opt_smooth If true, the view will be able to slightly exceed resolution limits. Default: true.\n * @param {import(\"./extent.js\").Extent=} opt_maxExtent Maximum allowed extent.\n * @return {Type} Zoom function.\n */\nexport function createSnapToResolutions(resolutions, opt_smooth, opt_maxExtent) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} direction Direction.\n     * @param {import(\"./size.js\").Size} size Viewport size.\n     * @param {boolean=} opt_isMoving True if an interaction or animation is in progress.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, direction, size, opt_isMoving) {\n      if (resolution !== undefined) {\n        const maxResolution = resolutions[0];\n        const minResolution = resolutions[resolutions.length - 1];\n        const cappedMaxRes = opt_maxExtent ?\n          getViewportClampedResolution(maxResolution, opt_maxExtent, size) :\n          maxResolution;\n\n        // during interacting or animating, allow intermediary values\n        if (opt_isMoving) {\n          const smooth = opt_smooth !== undefined ? opt_smooth : true;\n          if (!smooth) {\n            return clamp(resolution, minResolution, cappedMaxRes);\n          }\n          return getSmoothClampedResolution(resolution, cappedMaxRes, minResolution);\n        }\n\n        const capped = Math.min(cappedMaxRes, resolution);\n        const z = Math.floor(linearFindNearest(resolutions, capped, direction));\n        if (resolutions[z] > cappedMaxRes && z < resolutions.length - 1) {\n          return resolutions[z + 1];\n        }\n        return resolutions[z];\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n\n\n/**\n * @param {number} power Power.\n * @param {number} maxResolution Maximum resolution.\n * @param {number=} opt_minResolution Minimum resolution.\n * @param {boolean=} opt_smooth If true, the view will be able to slightly exceed resolution limits. Default: true.\n * @param {import(\"./extent.js\").Extent=} opt_maxExtent Maximum allowed extent.\n * @return {Type} Zoom function.\n */\nexport function createSnapToPower(power, maxResolution, opt_minResolution, opt_smooth, opt_maxExtent) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} direction Direction.\n     * @param {import(\"./size.js\").Size} size Viewport size.\n     * @param {boolean=} opt_isMoving True if an interaction or animation is in progress.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, direction, size, opt_isMoving) {\n      if (resolution !== undefined) {\n        const cappedMaxRes = opt_maxExtent ?\n          getViewportClampedResolution(maxResolution, opt_maxExtent, size) :\n          maxResolution;\n        const minResolution = opt_minResolution !== undefined ? opt_minResolution : 0;\n\n        // during interacting or animating, allow intermediary values\n        if (opt_isMoving) {\n          const smooth = opt_smooth !== undefined ? opt_smooth : true;\n          if (!smooth) {\n            return clamp(resolution, minResolution, cappedMaxRes);\n          }\n          return getSmoothClampedResolution(resolution, cappedMaxRes, minResolution);\n        }\n\n        const tolerance = 1e-9;\n        const minZoomLevel = Math.ceil(\n          Math.log(maxResolution / cappedMaxRes) / Math.log(power) - tolerance);\n        const offset = -direction * (0.5 - tolerance) + 0.5;\n        const capped = Math.min(cappedMaxRes, resolution);\n        const cappedZoomLevel = Math.floor(\n          Math.log(maxResolution / capped) / Math.log(power) + offset);\n        const zoomLevel = Math.max(minZoomLevel, cappedZoomLevel);\n        const newResolution = maxResolution / Math.pow(power, zoomLevel);\n        return clamp(newResolution, minResolution, cappedMaxRes);\n      } else {\n        return undefined;\n      }\n    });\n}\n\n/**\n * @param {number} maxResolution Max resolution.\n * @param {number} minResolution Min resolution.\n * @param {boolean=} opt_smooth If true, the view will be able to slightly exceed resolution limits. Default: true.\n * @param {import(\"./extent.js\").Extent=} opt_maxExtent Maximum allowed extent.\n * @return {Type} Zoom function.\n */\nexport function createMinMaxResolution(maxResolution, minResolution, opt_smooth, opt_maxExtent) {\n  return (\n    /**\n     * @param {number|undefined} resolution Resolution.\n     * @param {number} direction Direction.\n     * @param {import(\"./size.js\").Size} size Viewport size.\n     * @param {boolean=} opt_isMoving True if an interaction or animation is in progress.\n     * @return {number|undefined} Resolution.\n     */\n    function(resolution, direction, size, opt_isMoving) {\n      if (resolution !== undefined) {\n        const cappedMaxRes = opt_maxExtent ?\n          getViewportClampedResolution(maxResolution, opt_maxExtent, size) :\n          maxResolution;\n        const smooth = opt_smooth !== undefined ? opt_smooth : true;\n\n        if (!smooth || !opt_isMoving) {\n          return clamp(resolution, minResolution, cappedMaxRes);\n        }\n        return getSmoothClampedResolution(resolution, cappedMaxRes, minResolution);\n      } else {\n        return undefined;\n      }\n    }\n  );\n}\n","/**\n * @module ol/View\n */\nimport {DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {getUid} from './util.js';\nimport {VOID} from './functions.js';\nimport {createExtent, none as centerNone} from './centerconstraint.js';\nimport BaseObject from './Object.js';\nimport {createSnapToResolutions, createSnapToPower} from './resolutionconstraint.js';\nimport {createSnapToZero, createSnapToN, none as rotationNone, disable} from './rotationconstraint.js';\nimport ViewHint from './ViewHint.js';\nimport ViewProperty from './ViewProperty.js';\nimport {linearFindNearest} from './array.js';\nimport {assert} from './asserts.js';\nimport {add as addCoordinate, rotate as rotateCoordinate, equals as coordinatesEqual} from './coordinate.js';\nimport {inAndOut} from './easing.js';\nimport {getForViewAndSize, getCenter, getHeight, getWidth, isEmpty} from './extent.js';\nimport GeometryType from './geom/GeometryType.js';\nimport {fromExtent as polygonFromExtent} from './geom/Polygon.js';\nimport {clamp, modulo} from './math.js';\nimport {assign} from './obj.js';\nimport {createProjection, METERS_PER_UNIT, toUserCoordinate, toUserExtent, fromUserCoordinate, fromUserExtent, getUserProjection} from './proj.js';\nimport Units from './proj/Units.js';\nimport {equals} from './coordinate.js';\nimport {easeOut} from './easing.js';\nimport {createMinMaxResolution} from './resolutionconstraint.js';\n\n\n/**\n * An animation configuration\n *\n * @typedef {Object} Animation\n * @property {import(\"./coordinate.js\").Coordinate} [sourceCenter]\n * @property {import(\"./coordinate.js\").Coordinate} [targetCenter]\n * @property {number} [sourceResolution]\n * @property {number} [targetResolution]\n * @property {number} [sourceRotation]\n * @property {number} [targetRotation]\n * @property {import(\"./coordinate.js\").Coordinate} [anchor]\n * @property {number} start\n * @property {number} duration\n * @property {boolean} complete\n * @property {function(number):number} easing\n * @property {function(boolean)} callback\n */\n\n\n/**\n * @typedef {Object} Constraints\n * @property {import(\"./centerconstraint.js\").Type} center\n * @property {import(\"./resolutionconstraint.js\").Type} resolution\n * @property {import(\"./rotationconstraint.js\").Type} rotation\n */\n\n\n/**\n * @typedef {Object} FitOptions\n * @property {import(\"./size.js\").Size} [size] The size in pixels of the box to fit\n * the extent into. Default is the current size of the first map in the DOM that\n * uses this view, or `[100, 100]` if no such map is found.\n * @property {!Array<number>} [padding=[0, 0, 0, 0]] Padding (in pixels) to be\n * cleared inside the view. Values in the array are top, right, bottom and left\n * padding.\n * @property {boolean} [nearest=false] If the view `constrainResolution` option is `true`,\n * get the nearest extent instead of the closest that actually fits the view.\n * @property {number} [minResolution=0] Minimum resolution that we zoom to.\n * @property {number} [maxZoom] Maximum zoom level that we zoom to. If\n * `minResolution` is given, this property is ignored.\n * @property {number} [duration] The duration of the animation in milliseconds.\n * By default, there is no animation to the target extent.\n * @property {function(number):number} [easing] The easing function used during\n * the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n * @property {function(boolean)} [callback] Function called when the view is in\n * its final position. The callback will be called with `true` if the animation\n * series completed on its own or `false` if it was cancelled.\n */\n\n\n/**\n * @typedef {Object} ViewOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The initial center for\n * the view. If a user projection is not set, the coordinate system for the center is\n * specified with the `projection` option. Layer sources will not be fetched if this\n * is not set, but the center can be set later with {@link #setCenter}.\n * @property {boolean|number} [constrainRotation=true] Rotation constraint.\n * `false` means no constraint. `true` means no constraint, but snap to zero\n * near zero. A number constrains the rotation to that number of values. For\n * example, `4` will constrain the rotation to 0, 90, 180, and 270 degrees.\n * @property {boolean} [enableRotation=true] Enable rotation.\n * If `false`, a rotation constraint that always sets the rotation to zero is\n * used. The `constrainRotation` option has no effect if `enableRotation` is\n * `false`.\n * @property {import(\"./extent.js\").Extent} [extent] The extent that constrains the\n * view, in other words, nothing outside of this extent can be visible on the map.\n * @property {boolean} [constrainOnlyCenter=false] If true, the extent\n * constraint will only apply to the view center and not the whole extent.\n * @property {boolean} [smoothExtentConstraint=true] If true, the extent\n * constraint will be applied smoothly, i.e. allow the view to go slightly outside\n * of the given `extent`.\n * @property {number} [maxResolution] The maximum resolution used to determine\n * the resolution constraint. It is used together with `minResolution` (or\n * `maxZoom`) and `zoomFactor`. If unspecified it is calculated in such a way\n * that the projection's validity extent fits in a 256x256 px tile. If the\n * projection is Spherical Mercator (the default) then `maxResolution` defaults\n * to `40075016.68557849 / 256 = 156543.03392804097`.\n * @property {number} [minResolution] The minimum resolution used to determine\n * the resolution constraint.  It is used together with `maxResolution` (or\n * `minZoom`) and `zoomFactor`.  If unspecified it is calculated assuming 29\n * zoom levels (with a factor of 2). If the projection is Spherical Mercator\n * (the default) then `minResolution` defaults to\n * `40075016.68557849 / 256 / Math.pow(2, 28) = 0.0005831682455839253`.\n * @property {number} [maxZoom=28] The maximum zoom level used to determine the\n * resolution constraint. It is used together with `minZoom` (or\n * `maxResolution`) and `zoomFactor`.  Note that if `minResolution` is also\n * provided, it is given precedence over `maxZoom`.\n * @property {number} [minZoom=0] The minimum zoom level used to determine the\n * resolution constraint. It is used together with `maxZoom` (or\n * `minResolution`) and `zoomFactor`.  Note that if `maxResolution` is also\n * provided, it is given precedence over `minZoom`.\n * @property {boolean} [multiWorld=false] If `false` the view is constrained so\n * only one world is visible, and you cannot pan off the edge.  If `true` the map\n * may show multiple worlds at low zoom levels.  Only used if the `projection` is\n * global.  Note that if `extent` is also provided it is given precedence.\n * @property {boolean} [constrainResolution=false] If true, the view will always\n * animate to the closest zoom level after an interaction; false means\n * intermediary zoom levels are allowed.\n * @property {boolean} [smoothResolutionConstraint=true] If true, the resolution\n * min/max values will be applied smoothly, i. e. allow the view to exceed slightly\n * the given resolution or zoom bounds.\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857'] The\n * projection. The default is Spherical Mercator.\n * @property {number} [resolution] The initial resolution for the view. The\n * units are `projection` units per pixel (e.g. meters per pixel). An\n * alternative to setting this is to set `zoom`. Layer sources will not be\n * fetched if neither this nor `zoom` are defined, but they can be set later\n * with {@link #setZoom} or {@link #setResolution}.\n * @property {Array<number>} [resolutions] Resolutions to determine the\n * resolution constraint. If set the `maxResolution`, `minResolution`,\n * `minZoom`, `maxZoom`, and `zoomFactor` options are ignored.\n * @property {number} [rotation=0] The initial rotation for the view in radians\n * (positive rotation clockwise, 0 means North).\n * @property {number} [zoom] Only used if `resolution` is not defined. Zoom\n * level used to calculate the initial resolution for the view.\n * @property {number} [zoomFactor=2] The zoom factor used to compute the\n * corresponding resolution.\n */\n\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {import(\"./coordinate.js\").Coordinate} [center] The center of the view at the end of\n * the animation.\n * @property {number} [zoom] The zoom level of the view at the end of the\n * animation. This takes precedence over `resolution`.\n * @property {number} [resolution] The resolution of the view at the end\n * of the animation.  If `zoom` is also provided, this option will be ignored.\n * @property {number} [rotation] The rotation of the view at the end of\n * the animation.\n * @property {import(\"./coordinate.js\").Coordinate} [anchor] Optional anchor to remain fixed\n * during a rotation or resolution animation.\n * @property {number} [duration=1000] The duration of the animation in milliseconds.\n * @property {function(number):number} [easing] The easing function used\n * during the animation (defaults to {@link module:ol/easing~inAndOut}).\n * The function will be called for each frame with a number representing a\n * fraction of the animation's duration.  The function should return a number\n * between 0 and 1 representing the progress toward the destination state.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {import(\"./coordinate.js\").Coordinate} center\n * @property {import(\"./proj/Projection.js\").default} projection\n * @property {number} resolution\n * @property {number} rotation\n * @property {number} zoom\n */\n\n\n/**\n * Default min zoom level for the map view.\n * @type {number}\n */\nconst DEFAULT_MIN_ZOOM = 0;\n\n\n/**\n * @classdesc\n * A View object represents a simple 2D view of the map.\n *\n * This is the object to act upon to change the center, resolution,\n * and rotation of the map.\n *\n * A View has a `projection`. The projection determines the\n * coordinate system of the center, and its units determine the units of the\n * resolution (projection units per pixel). The default projection is\n * Spherical Mercator (EPSG:3857).\n *\n * ### The view states\n *\n * A View is determined by three states: `center`, `resolution`,\n * and `rotation`. Each state has a corresponding getter and setter, e.g.\n * `getCenter` and `setCenter` for the `center` state.\n *\n * The `zoom` state is actually not saved on the view: all computations\n * internally use the `resolution` state. Still, the `setZoom` and `getZoom`\n * methods are available, as well as `getResolutionForZoom` and\n * `getZoomForResolution` to switch from one system to the other.\n *\n * ### The constraints\n *\n * `setCenter`, `setResolution` and `setRotation` can be used to change the\n * states of the view, but any constraint defined in the constructor will\n * be applied along the way.\n *\n * A View object can have a *resolution constraint*, a *rotation constraint*\n * and a *center constraint*.\n *\n * The *resolution constraint* typically restricts min/max values and\n * snaps to specific resolutions. It is determined by the following\n * options: `resolutions`, `maxResolution`, `maxZoom` and `zoomFactor`.\n * If `resolutions` is set, the other three options are ignored. See\n * documentation for each option for more information. By default, the view\n * only has a min/max restriction and allow intermediary zoom levels when\n * pinch-zooming for example.\n *\n * The *rotation constraint* snaps to specific angles. It is determined\n * by the following options: `enableRotation` and `constrainRotation`.\n * By default rotation is allowed and its value is snapped to zero when approaching the\n * horizontal.\n *\n * The *center constraint* is determined by the `extent` option. By\n * default the view center is not constrained at all.\n *\n * ### Changing the view state\n *\n * It is important to note that `setZoom`, `setResolution`, `setCenter` and\n * `setRotation` are subject to the above mentioned constraints. As such, it\n * may sometimes not be possible to know in advance the resulting state of the\n * View. For example, calling `setResolution(10)` does not guarantee that\n * `getResolution()` will return `10`.\n *\n * A consequence of this is that, when applying a delta on the view state, one\n * should use `adjustCenter`, `adjustRotation`, `adjustZoom` and `adjustResolution`\n * rather than the corresponding setters. This will let view do its internal\n * computations. Besides, the `adjust*` methods also take an `opt_anchor`\n * argument which allows specifying an origin for the transformation.\n *\n * ### Interacting with the view\n *\n * View constraints are usually only applied when the view is *at rest*, meaning that\n * no interaction or animation is ongoing. As such, if the user puts the view in a\n * state that is not equivalent to a constrained one (e.g. rotating the view when\n * the snap angle is 0), an animation will be triggered at the interaction end to\n * put back the view to a stable state;\n *\n * @api\n */\nclass View extends BaseObject {\n\n  /**\n   * @param {ViewOptions=} opt_options View options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = assign({}, opt_options);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.hints_ = [0, 0];\n\n    /**\n     * @private\n     * @type {Array<Array<Animation>>}\n     */\n    this.animations_ = [];\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.updateAnimationKey_;\n\n    /**\n     * @private\n     * @const\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection_ = createProjection(options.projection, 'EPSG:3857');\n\n    /**\n     * @private\n     * @type {import(\"./coordinate.js\").Coordinate|undefined}\n     */\n    this.targetCenter_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.targetResolution_;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.targetRotation_;\n\n    if (options.center) {\n      options.center = fromUserCoordinate(options.center, this.projection_);\n    }\n    if (options.extent) {\n      options.extent = fromUserExtent(options.extent, this.projection_);\n    }\n\n    this.applyOptions_(options);\n  }\n\n  /**\n   * Set up the view with the given options.\n   * @param {ViewOptions} options View options.\n   */\n  applyOptions_(options) {\n\n    /**\n     * @type {Object<string, *>}\n     */\n    const properties = {};\n\n    const resolutionConstraintInfo = createResolutionConstraint(options);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxResolution_ = resolutionConstraintInfo.maxResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minResolution_ = resolutionConstraintInfo.minResolution;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.zoomFactor_ = resolutionConstraintInfo.zoomFactor;\n\n    /**\n     * @private\n     * @type {Array<number>|undefined}\n     */\n    this.resolutions_ = options.resolutions;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minZoom_ = resolutionConstraintInfo.minZoom;\n\n    const centerConstraint = createCenterConstraint(options);\n    const resolutionConstraint = resolutionConstraintInfo.constraint;\n    const rotationConstraint = createRotationConstraint(options);\n\n    /**\n     * @private\n     * @type {Constraints}\n     */\n    this.constraints_ = {\n      center: centerConstraint,\n      resolution: resolutionConstraint,\n      rotation: rotationConstraint\n    };\n\n    this.setRotation(options.rotation !== undefined ? options.rotation : 0);\n    this.setCenterInternal(options.center !== undefined ? options.center : null);\n    if (options.resolution !== undefined) {\n      this.setResolution(options.resolution);\n    } else if (options.zoom !== undefined) {\n      this.setZoom(options.zoom);\n    }\n    this.resolveConstraints(0);\n\n    this.setProperties(properties);\n\n\n    /**\n     * @private\n     * @type {ViewOptions}\n     */\n    this.options_ = options;\n\n  }\n\n  /**\n   * Get an updated version of the view options used to construct the view.  The\n   * current resolution (or zoom), center, and rotation are applied to any stored\n   * options.  The provided options can be used to apply new min/max zoom or\n   * resolution limits.\n   * @param {ViewOptions} newOptions New options to be applied.\n   * @return {ViewOptions} New options updated with the current view state.\n   */\n  getUpdatedOptions_(newOptions) {\n    const options = assign({}, this.options_);\n\n    // preserve resolution (or zoom)\n    if (options.resolution !== undefined) {\n      options.resolution = this.getResolution();\n    } else {\n      options.zoom = this.getZoom();\n    }\n\n    // preserve center\n    options.center = this.getCenterInternal();\n\n    // preserve rotation\n    options.rotation = this.getRotation();\n\n    return assign({}, options, newOptions);\n  }\n\n  /**\n   * Animate the view.  The view's center, zoom (or resolution), and rotation\n   * can be animated for smooth transitions between view states.  For example,\n   * to animate the view to a new zoom level:\n   *\n   *     view.animate({zoom: view.getZoom() + 1});\n   *\n   * By default, the animation lasts one second and uses in-and-out easing.  You\n   * can customize this behavior by including `duration` (in milliseconds) and\n   * `easing` options (see {@link module:ol/easing}).\n   *\n   * To chain together multiple animations, call the method with multiple\n   * animation objects.  For example, to first zoom and then pan:\n   *\n   *     view.animate({zoom: 10}, {center: [0, 0]});\n   *\n   * If you provide a function as the last argument to the animate method, it\n   * will get called at the end of an animation series.  The callback will be\n   * called with `true` if the animation series completed on its own or `false`\n   * if it was cancelled.\n   *\n   * Animations are cancelled by user interactions (e.g. dragging the map) or by\n   * calling `view.setCenter()`, `view.setResolution()`, or `view.setRotation()`\n   * (or another method that calls one of these).\n   *\n   * @param {...(AnimationOptions|function(boolean): void)} var_args Animation\n   *     options.  Multiple animations can be run in series by passing multiple\n   *     options objects.  To run multiple animations in parallel, call the method\n   *     multiple times.  An optional callback can be provided as a final\n   *     argument.  The callback will be called with a boolean indicating whether\n   *     the animation completed without being cancelled.\n   * @api\n   */\n  animate(var_args) {\n    if (this.isDef() && !this.getAnimating()) {\n      this.resolveConstraints(0);\n    }\n    const args = new Array(arguments.length);\n    for (let i = 0; i < args.length; ++i) {\n      let options = arguments[i];\n      if (options.center) {\n        options = assign({}, options);\n        options.center = fromUserCoordinate(options.center, this.getProjection());\n      }\n      if (options.anchor) {\n        options = assign({}, options);\n        options.anchor = fromUserCoordinate(options.anchor, this.getProjection());\n      }\n      args[i] = options;\n    }\n    this.animateInternal.apply(this, args);\n  }\n\n  /**\n   * @param {...(AnimationOptions|function(boolean): void)} var_args Animation options.\n   */\n  animateInternal(var_args) {\n    let animationCount = arguments.length;\n    let callback;\n    if (animationCount > 1 && typeof arguments[animationCount - 1] === 'function') {\n      callback = arguments[animationCount - 1];\n      --animationCount;\n    }\n    if (!this.isDef()) {\n      // if view properties are not yet set, shortcut to the final state\n      const state = arguments[animationCount - 1];\n      if (state.center) {\n        this.setCenterInternal(state.center);\n      }\n      if (state.zoom !== undefined) {\n        this.setZoom(state.zoom);\n      }\n      if (state.rotation !== undefined) {\n        this.setRotation(state.rotation);\n      }\n      if (callback) {\n        animationCallback(callback, true);\n      }\n      return;\n    }\n    let start = Date.now();\n    let center = this.targetCenter_.slice();\n    let resolution = this.targetResolution_;\n    let rotation = this.targetRotation_;\n    const series = [];\n    for (let i = 0; i < animationCount; ++i) {\n      const options = /** @type {AnimationOptions} */ (arguments[i]);\n\n      const animation = {\n        start: start,\n        complete: false,\n        anchor: options.anchor,\n        duration: options.duration !== undefined ? options.duration : 1000,\n        easing: options.easing || inAndOut,\n        callback: callback\n      };\n\n      if (options.center) {\n        animation.sourceCenter = center;\n        animation.targetCenter = options.center.slice();\n        center = animation.targetCenter;\n      }\n\n      if (options.zoom !== undefined) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = this.getResolutionForZoom(options.zoom);\n        resolution = animation.targetResolution;\n      } else if (options.resolution) {\n        animation.sourceResolution = resolution;\n        animation.targetResolution = options.resolution;\n        resolution = animation.targetResolution;\n      }\n\n      if (options.rotation !== undefined) {\n        animation.sourceRotation = rotation;\n        const delta = modulo(options.rotation - rotation + Math.PI, 2 * Math.PI) - Math.PI;\n        animation.targetRotation = rotation + delta;\n        rotation = animation.targetRotation;\n      }\n\n      // check if animation is a no-op\n      if (isNoopAnimation(animation)) {\n        animation.complete = true;\n        // we still push it onto the series for callback handling\n      } else {\n        start += animation.duration;\n      }\n      series.push(animation);\n    }\n    this.animations_.push(series);\n    this.setHint(ViewHint.ANIMATING, 1);\n    this.updateAnimations_();\n  }\n\n  /**\n   * Determine if the view is being animated.\n   * @return {boolean} The view is being animated.\n   * @api\n   */\n  getAnimating() {\n    return this.hints_[ViewHint.ANIMATING] > 0;\n  }\n\n  /**\n   * Determine if the user is interacting with the view, such as panning or zooming.\n   * @return {boolean} The view is being interacted with.\n   * @api\n   */\n  getInteracting() {\n    return this.hints_[ViewHint.INTERACTING] > 0;\n  }\n\n  /**\n   * Cancel any ongoing animations.\n   * @api\n   */\n  cancelAnimations() {\n    this.setHint(ViewHint.ANIMATING, -this.hints_[ViewHint.ANIMATING]);\n    for (let i = 0, ii = this.animations_.length; i < ii; ++i) {\n      const series = this.animations_[i];\n      if (series[0].callback) {\n        animationCallback(series[0].callback, false);\n      }\n    }\n    this.animations_.length = 0;\n  }\n\n  /**\n   * Update all animations.\n   */\n  updateAnimations_() {\n    if (this.updateAnimationKey_ !== undefined) {\n      cancelAnimationFrame(this.updateAnimationKey_);\n      this.updateAnimationKey_ = undefined;\n    }\n    if (!this.getAnimating()) {\n      return;\n    }\n    const now = Date.now();\n    let more = false;\n    for (let i = this.animations_.length - 1; i >= 0; --i) {\n      const series = this.animations_[i];\n      let seriesComplete = true;\n      for (let j = 0, jj = series.length; j < jj; ++j) {\n        const animation = series[j];\n        if (animation.complete) {\n          continue;\n        }\n        const elapsed = now - animation.start;\n        let fraction = animation.duration > 0 ? elapsed / animation.duration : 1;\n        if (fraction >= 1) {\n          animation.complete = true;\n          fraction = 1;\n        } else {\n          seriesComplete = false;\n        }\n        const progress = animation.easing(fraction);\n        if (animation.sourceCenter) {\n          const x0 = animation.sourceCenter[0];\n          const y0 = animation.sourceCenter[1];\n          const x1 = animation.targetCenter[0];\n          const y1 = animation.targetCenter[1];\n          const x = x0 + progress * (x1 - x0);\n          const y = y0 + progress * (y1 - y0);\n          this.targetCenter_ = [x, y];\n        }\n        if (animation.sourceResolution && animation.targetResolution) {\n          const resolution = progress === 1 ?\n            animation.targetResolution :\n            animation.sourceResolution + progress * (animation.targetResolution - animation.sourceResolution);\n          if (animation.anchor) {\n            const size = this.getSizeFromViewport_(this.getRotation());\n            const constrainedResolution = this.constraints_.resolution(resolution, 0, size, true);\n            this.targetCenter_ = this.calculateCenterZoom(constrainedResolution, animation.anchor);\n          }\n          this.targetResolution_ = resolution;\n          this.applyTargetState_(true);\n        }\n        if (animation.sourceRotation !== undefined && animation.targetRotation !== undefined) {\n          const rotation = progress === 1 ?\n            modulo(animation.targetRotation + Math.PI, 2 * Math.PI) - Math.PI :\n            animation.sourceRotation + progress * (animation.targetRotation - animation.sourceRotation);\n          if (animation.anchor) {\n            const constrainedRotation = this.constraints_.rotation(rotation, true);\n            this.targetCenter_ = this.calculateCenterRotate(constrainedRotation, animation.anchor);\n          }\n          this.targetRotation_ = rotation;\n        }\n        this.applyTargetState_(true);\n        more = true;\n        if (!animation.complete) {\n          break;\n        }\n      }\n      if (seriesComplete) {\n        this.animations_[i] = null;\n        this.setHint(ViewHint.ANIMATING, -1);\n        const callback = series[0].callback;\n        if (callback) {\n          animationCallback(callback, true);\n        }\n      }\n    }\n    // prune completed series\n    this.animations_ = this.animations_.filter(Boolean);\n    if (more && this.updateAnimationKey_ === undefined) {\n      this.updateAnimationKey_ = requestAnimationFrame(this.updateAnimations_.bind(this));\n    }\n  }\n\n  /**\n   * @param {number} rotation Target rotation.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Rotation anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for rotation and anchor.\n   */\n  calculateCenterRotate(rotation, anchor) {\n    let center;\n    const currentCenter = this.getCenterInternal();\n    if (currentCenter !== undefined) {\n      center = [currentCenter[0] - anchor[0], currentCenter[1] - anchor[1]];\n      rotateCoordinate(center, rotation - this.getRotation());\n      addCoordinate(center, anchor);\n    }\n    return center;\n  }\n\n  /**\n   * @param {number} resolution Target resolution.\n   * @param {import(\"./coordinate.js\").Coordinate} anchor Zoom anchor.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Center for resolution and anchor.\n   */\n  calculateCenterZoom(resolution, anchor) {\n    let center;\n    const currentCenter = this.getCenterInternal();\n    const currentResolution = this.getResolution();\n    if (currentCenter !== undefined && currentResolution !== undefined) {\n      const x = anchor[0] - resolution * (anchor[0] - currentCenter[0]) / currentResolution;\n      const y = anchor[1] - resolution * (anchor[1] - currentCenter[1]) / currentResolution;\n      center = [x, y];\n    }\n    return center;\n  }\n\n  /**\n   * @private\n   * @param {number=} opt_rotation Take into account the rotation of the viewport when giving the size\n   * @return {import(\"./size.js\").Size} Viewport size or `[100, 100]` when no viewport is found.\n   */\n  getSizeFromViewport_(opt_rotation) {\n    const size = [100, 100];\n    const selector = '.ol-viewport[data-view=\"' + getUid(this) + '\"]';\n    const element = document.querySelector(selector);\n    if (element) {\n      const metrics = getComputedStyle(element);\n      size[0] = parseInt(metrics.width, 10);\n      size[1] = parseInt(metrics.height, 10);\n    }\n    if (opt_rotation) {\n      const w = size[0];\n      const h = size[1];\n      size[0] = Math.abs(w * Math.cos(opt_rotation)) + Math.abs(h * Math.sin(opt_rotation));\n      size[1] = Math.abs(w * Math.sin(opt_rotation)) + Math.abs(h * Math.cos(opt_rotation));\n    }\n    return size;\n  }\n\n  /**\n   * Get the view center.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   * @observable\n   * @api\n   */\n  getCenter() {\n    const center = this.getCenterInternal();\n    if (!center) {\n      return center;\n    }\n    return toUserCoordinate(center, this.getProjection());\n  }\n\n  /**\n   * Get the view center without transforming to user projection.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The center of the view.\n   */\n  getCenterInternal() {\n    return /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (this.get(ViewProperty.CENTER));\n  }\n\n  /**\n   * @return {Constraints} Constraints.\n   */\n  getConstraints() {\n    return this.constraints_;\n  }\n\n  /**\n   * @param {Array<number>=} opt_hints Destination array.\n   * @return {Array<number>} Hint.\n   */\n  getHints(opt_hints) {\n    if (opt_hints !== undefined) {\n      opt_hints[0] = this.hints_[0];\n      opt_hints[1] = this.hints_[1];\n      return opt_hints;\n    } else {\n      return this.hints_.slice();\n    }\n  }\n\n  /**\n   * Calculate the extent for the current view state and the passed size.\n   * The size is the pixel dimensions of the box into which the calculated extent\n   * should fit. In most cases you want to get the extent of the entire map,\n   * that is `map.getSize()`.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size. If not provided, the size of the\n   * first map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   * @api\n   */\n  calculateExtent(opt_size) {\n    const extent = this.calculateExtentInternal(opt_size);\n    return toUserExtent(extent, this.getProjection());\n  }\n\n  /**\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size. If not provided, the size of the\n   * first map that uses this view will be used.\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  calculateExtentInternal(opt_size) {\n    const size = opt_size || this.getSizeFromViewport_();\n    const center = /** @type {!import(\"./coordinate.js\").Coordinate} */ (this.getCenterInternal());\n    assert(center, 1); // The view center is not defined\n    const resolution = /** @type {!number} */ (this.getResolution());\n    assert(resolution !== undefined, 2); // The view resolution is not defined\n    const rotation = /** @type {!number} */ (this.getRotation());\n    assert(rotation !== undefined, 3); // The view rotation is not defined\n\n    return getForViewAndSize(center, resolution, rotation, size);\n  }\n\n  /**\n   * Get the maximum resolution of the view.\n   * @return {number} The maximum resolution of the view.\n   * @api\n   */\n  getMaxResolution() {\n    return this.maxResolution_;\n  }\n\n  /**\n   * Get the minimum resolution of the view.\n   * @return {number} The minimum resolution of the view.\n   * @api\n   */\n  getMinResolution() {\n    return this.minResolution_;\n  }\n\n  /**\n   * Get the maximum zoom level for the view.\n   * @return {number} The maximum zoom level.\n   * @api\n   */\n  getMaxZoom() {\n    return /** @type {number} */ (this.getZoomForResolution(this.minResolution_));\n  }\n\n  /**\n   * Set a new maximum zoom level for the view.\n   * @param {number} zoom The maximum zoom level.\n   * @api\n   */\n  setMaxZoom(zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({maxZoom: zoom}));\n  }\n\n  /**\n   * Get the minimum zoom level for the view.\n   * @return {number} The minimum zoom level.\n   * @api\n   */\n  getMinZoom() {\n    return /** @type {number} */ (this.getZoomForResolution(this.maxResolution_));\n  }\n\n  /**\n   * Set a new minimum zoom level for the view.\n   * @param {number} zoom The minimum zoom level.\n   * @api\n   */\n  setMinZoom(zoom) {\n    this.applyOptions_(this.getUpdatedOptions_({minZoom: zoom}));\n  }\n\n  /**\n   * Set whether the view shoud allow intermediary zoom levels.\n   * @param {boolean} enabled Whether the resolution is constrained.\n   * @api\n   */\n  setConstrainResolution(enabled) {\n    this.applyOptions_(this.getUpdatedOptions_({constrainResolution: enabled}));\n  }\n\n  /**\n   * Get the view projection.\n   * @return {import(\"./proj/Projection.js\").default} The projection of the view.\n   * @api\n   */\n  getProjection() {\n    return this.projection_;\n  }\n\n  /**\n   * Get the view resolution.\n   * @return {number|undefined} The resolution of the view.\n   * @observable\n   * @api\n   */\n  getResolution() {\n    return /** @type {number|undefined} */ (this.get(ViewProperty.RESOLUTION));\n  }\n\n  /**\n   * Get the resolutions for the view. This returns the array of resolutions\n   * passed to the constructor of the View, or undefined if none were given.\n   * @return {Array<number>|undefined} The resolutions of the view.\n   * @api\n   */\n  getResolutions() {\n    return this.resolutions_;\n  }\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   * @api\n   */\n  getResolutionForExtent(extent, opt_size) {\n    return this.getResolutionForExtentInternal(fromUserExtent(extent, this.getProjection()), opt_size);\n  }\n\n  /**\n   * Get the resolution for a provided extent (in map units) and size (in pixels).\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {import(\"./size.js\").Size=} opt_size Box pixel size.\n   * @return {number} The resolution at which the provided extent will render at\n   *     the given size.\n   */\n  getResolutionForExtentInternal(extent, opt_size) {\n    const size = opt_size || this.getSizeFromViewport_();\n    const xResolution = getWidth(extent) / size[0];\n    const yResolution = getHeight(extent) / size[1];\n    return Math.max(xResolution, yResolution);\n  }\n\n  /**\n   * Return a function that returns a value between 0 and 1 for a\n   * resolution. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Resolution for value function.\n   */\n  getResolutionForValueFunction(opt_power) {\n    const power = opt_power || 2;\n    const maxResolution = this.maxResolution_;\n    const minResolution = this.minResolution_;\n    const max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} value Value.\n       * @return {number} Resolution.\n       */\n      function(value) {\n        const resolution = maxResolution / Math.pow(power, value * max);\n        return resolution;\n      });\n  }\n\n  /**\n   * Get the view rotation.\n   * @return {number} The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  getRotation() {\n    return /** @type {number} */ (this.get(ViewProperty.ROTATION));\n  }\n\n  /**\n   * Return a function that returns a resolution for a value between\n   * 0 and 1. Exponential scaling is assumed.\n   * @param {number=} opt_power Power.\n   * @return {function(number): number} Value for resolution function.\n   */\n  getValueForResolutionFunction(opt_power) {\n    const power = opt_power || 2;\n    const maxResolution = this.maxResolution_;\n    const minResolution = this.minResolution_;\n    const max = Math.log(maxResolution / minResolution) / Math.log(power);\n    return (\n      /**\n       * @param {number} resolution Resolution.\n       * @return {number} Value.\n       */\n      function(resolution) {\n        const value = (Math.log(maxResolution / resolution) / Math.log(power)) / max;\n        return value;\n      });\n  }\n\n  /**\n   * @return {State} View state.\n   */\n  getState() {\n    const center = /** @type {import(\"./coordinate.js\").Coordinate} */ (this.getCenterInternal());\n    const projection = this.getProjection();\n    const resolution = /** @type {number} */ (this.getResolution());\n    const rotation = this.getRotation();\n    return {\n      center: center.slice(0),\n      projection: projection !== undefined ? projection : null,\n      resolution: resolution,\n      rotation: rotation,\n      zoom: this.getZoom()\n    };\n  }\n\n  /**\n   * Get the current zoom level. This method may return non-integer zoom levels\n   * if the view does not constrain the resolution, or if an interaction or\n   * animation is underway.\n   * @return {number|undefined} Zoom.\n   * @api\n   */\n  getZoom() {\n    let zoom;\n    const resolution = this.getResolution();\n    if (resolution !== undefined) {\n      zoom = this.getZoomForResolution(resolution);\n    }\n    return zoom;\n  }\n\n  /**\n   * Get the zoom level for a resolution.\n   * @param {number} resolution The resolution.\n   * @return {number|undefined} The zoom level for the provided resolution.\n   * @api\n   */\n  getZoomForResolution(resolution) {\n    let offset = this.minZoom_ || 0;\n    let max, zoomFactor;\n    if (this.resolutions_) {\n      const nearest = linearFindNearest(this.resolutions_, resolution, 1);\n      offset = nearest;\n      max = this.resolutions_[nearest];\n      if (nearest == this.resolutions_.length - 1) {\n        zoomFactor = 2;\n      } else {\n        zoomFactor = max / this.resolutions_[nearest + 1];\n      }\n    } else {\n      max = this.maxResolution_;\n      zoomFactor = this.zoomFactor_;\n    }\n    return offset + Math.log(max / resolution) / Math.log(zoomFactor);\n  }\n\n  /**\n   * Get the resolution for a zoom level.\n   * @param {number} zoom Zoom level.\n   * @return {number} The view resolution for the provided zoom level.\n   * @api\n   */\n  getResolutionForZoom(zoom) {\n    if (this.resolutions_) {\n      if (this.resolutions_.length <= 1) {\n        return 0;\n      }\n      const baseLevel = clamp(Math.floor(zoom), 0, this.resolutions_.length - 2);\n      const zoomFactor = this.resolutions_[baseLevel] / this.resolutions_[baseLevel + 1];\n      return this.resolutions_[baseLevel] / Math.pow(zoomFactor, clamp(zoom - baseLevel, 0, 1));\n    } else {\n      return this.maxResolution_ / Math.pow(this.zoomFactor_, zoom - this.minZoom_);\n    }\n  }\n\n  /**\n   * Fit the given geometry or extent based on the given map size and border.\n   * The size is pixel dimensions of the box to fit the extent into.\n   * In most cases you will want to use the map size, that is `map.getSize()`.\n   * Takes care of the map angle.\n   * @param {import(\"./geom/SimpleGeometry.js\").default|import(\"./extent.js\").Extent} geometryOrExtent The geometry or\n   *     extent to fit the view to.\n   * @param {FitOptions=} opt_options Options.\n   * @api\n   */\n  fit(geometryOrExtent, opt_options) {\n    const options = assign({size: this.getSizeFromViewport_()}, opt_options || {});\n\n    /** @type {import(\"./geom/SimpleGeometry.js\").default} */\n    let geometry;\n    assert(Array.isArray(geometryOrExtent) || typeof /** @type {?} */ (geometryOrExtent).getSimplifiedGeometry === 'function',\n      24); // Invalid extent or geometry provided as `geometry`\n    if (Array.isArray(geometryOrExtent)) {\n      assert(!isEmpty(geometryOrExtent),\n        25); // Cannot fit empty extent provided as `geometry`\n      const extent = fromUserExtent(geometryOrExtent, this.getProjection());\n      geometry = polygonFromExtent(extent);\n    } else if (geometryOrExtent.getType() === GeometryType.CIRCLE) {\n      const extent = fromUserExtent(geometryOrExtent.getExtent(), this.getProjection());\n      geometry = polygonFromExtent(extent);\n      geometry.rotate(this.getRotation(), getCenter(extent));\n    } else {\n      const userProjection = getUserProjection();\n      if (userProjection) {\n        geometry = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (geometry.clone().transform(userProjection, this.getProjection()));\n      } else {\n        geometry = geometryOrExtent;\n      }\n    }\n\n    this.fitInternal(geometry, options);\n  }\n\n  /**\n   * @param {import(\"./geom/SimpleGeometry.js\").default} geometry The geometry.\n   * @param {FitOptions=} opt_options Options.\n   */\n  fitInternal(geometry, opt_options) {\n    const options = opt_options || {};\n    let size = options.size;\n    if (!size) {\n      size = this.getSizeFromViewport_();\n    }\n    const padding = options.padding !== undefined ? options.padding : [0, 0, 0, 0];\n    const nearest = options.nearest !== undefined ? options.nearest : false;\n    let minResolution;\n    if (options.minResolution !== undefined) {\n      minResolution = options.minResolution;\n    } else if (options.maxZoom !== undefined) {\n      minResolution = this.getResolutionForZoom(options.maxZoom);\n    } else {\n      minResolution = 0;\n    }\n    const coords = geometry.getFlatCoordinates();\n\n    // calculate rotated extent\n    const rotation = this.getRotation();\n    const cosAngle = Math.cos(-rotation);\n    let sinAngle = Math.sin(-rotation);\n    let minRotX = +Infinity;\n    let minRotY = +Infinity;\n    let maxRotX = -Infinity;\n    let maxRotY = -Infinity;\n    const stride = geometry.getStride();\n    for (let i = 0, ii = coords.length; i < ii; i += stride) {\n      const rotX = coords[i] * cosAngle - coords[i + 1] * sinAngle;\n      const rotY = coords[i] * sinAngle + coords[i + 1] * cosAngle;\n      minRotX = Math.min(minRotX, rotX);\n      minRotY = Math.min(minRotY, rotY);\n      maxRotX = Math.max(maxRotX, rotX);\n      maxRotY = Math.max(maxRotY, rotY);\n    }\n\n    // calculate resolution\n    let resolution = this.getResolutionForExtentInternal(\n      [minRotX, minRotY, maxRotX, maxRotY],\n      [size[0] - padding[1] - padding[3], size[1] - padding[0] - padding[2]]);\n    resolution = isNaN(resolution) ? minResolution :\n      Math.max(resolution, minResolution);\n    resolution = this.getConstrainedResolution(resolution, nearest ? 0 : 1);\n\n    // calculate center\n    sinAngle = -sinAngle; // go back to original rotation\n    let centerRotX = (minRotX + maxRotX) / 2;\n    let centerRotY = (minRotY + maxRotY) / 2;\n    centerRotX += (padding[1] - padding[3]) / 2 * resolution;\n    centerRotY += (padding[0] - padding[2]) / 2 * resolution;\n    const centerX = centerRotX * cosAngle - centerRotY * sinAngle;\n    const centerY = centerRotY * cosAngle + centerRotX * sinAngle;\n    const center = [centerX, centerY];\n    const callback = options.callback ? options.callback : VOID;\n\n    if (options.duration !== undefined) {\n      this.animateInternal({\n        resolution: resolution,\n        center: this.getConstrainedCenter(center, resolution),\n        duration: options.duration,\n        easing: options.easing\n      }, callback);\n    } else {\n      this.targetResolution_ = resolution;\n      this.targetCenter_ = center;\n      this.applyTargetState_(false, true);\n      animationCallback(callback, true);\n    }\n  }\n\n  /**\n   * Center on coordinate and view position.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   * @api\n   */\n  centerOn(coordinate, size, position) {\n    this.centerOnInternal(fromUserCoordinate(coordinate, this.getProjection()), size, position);\n  }\n\n  /**\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"./size.js\").Size} size Box pixel size.\n   * @param {import(\"./pixel.js\").Pixel} position Position on the view to center on.\n   */\n  centerOnInternal(coordinate, size, position) {\n    // calculate rotated position\n    const rotation = this.getRotation();\n    const cosAngle = Math.cos(-rotation);\n    let sinAngle = Math.sin(-rotation);\n    let rotX = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n    let rotY = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n    const resolution = this.getResolution();\n    rotX += (size[0] / 2 - position[0]) * resolution;\n    rotY += (position[1] - size[1] / 2) * resolution;\n\n    // go back to original angle\n    sinAngle = -sinAngle; // go back to original rotation\n    const centerX = rotX * cosAngle - rotY * sinAngle;\n    const centerY = rotY * cosAngle + rotX * sinAngle;\n\n    this.setCenterInternal([centerX, centerY]);\n  }\n\n  /**\n   * @return {boolean} Is defined.\n   */\n  isDef() {\n    return !!this.getCenterInternal() && this.getResolution() !== undefined;\n  }\n\n  /**\n   * Adds relative coordinates to the center of the view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate} deltaCoordinates Relative value to add.\n   * @api\n   */\n  adjustCenter(deltaCoordinates) {\n    const center = toUserCoordinate(this.targetCenter_, this.getProjection());\n    this.setCenter([center[0] + deltaCoordinates[0], center[1] + deltaCoordinates[1]]);\n  }\n\n  /**\n   * Adds relative coordinates to the center of the view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate} deltaCoordinates Relative value to add.\n   */\n  adjustCenterInternal(deltaCoordinates) {\n    const center = this.targetCenter_;\n    this.setCenterInternal([center[0] + deltaCoordinates[0], center[1] + deltaCoordinates[1]]);\n  }\n\n  /**\n   * Multiply the view resolution by a ratio, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} ratio The ratio to apply on the view resolution.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The origin of the transformation.\n   * @api\n   */\n  adjustResolution(ratio, opt_anchor) {\n    const anchor = opt_anchor && fromUserCoordinate(opt_anchor, this.getProjection());\n    this.adjustResolutionInternal(ratio, anchor);\n  }\n\n  /**\n   * Multiply the view resolution by a ratio, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} ratio The ratio to apply on the view resolution.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The origin of the transformation.\n   */\n  adjustResolutionInternal(ratio, opt_anchor) {\n    const isMoving = this.getAnimating() || this.getInteracting();\n    const size = this.getSizeFromViewport_(this.getRotation());\n    const newResolution = this.constraints_.resolution(this.targetResolution_ * ratio, 0, size, isMoving);\n\n    if (opt_anchor !== undefined) {\n      this.targetCenter_ = this.calculateCenterZoom(newResolution, opt_anchor);\n    }\n\n    this.targetResolution_ *= ratio;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Adds a value to the view zoom level, optionally using an anchor. Any resolution\n   * constraint will apply.\n   * @param {number} delta Relative value to add to the zoom level.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The origin of the transformation.\n   * @api\n   */\n  adjustZoom(delta, opt_anchor) {\n    this.adjustResolution(Math.pow(this.zoomFactor_, -delta), opt_anchor);\n  }\n\n  /**\n   * Adds a value to the view rotation, optionally using an anchor. Any rotation\n   * constraint will apply.\n   * @param {number} delta Relative value to add to the zoom rotation, in radians.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The rotation center.\n   * @api\n   */\n  adjustRotation(delta, opt_anchor) {\n    if (opt_anchor) {\n      opt_anchor = fromUserCoordinate(opt_anchor, this.getProjection());\n    }\n    this.adjustRotationInternal(delta, opt_anchor);\n  }\n\n  /**\n   * @param {number} delta Relative value to add to the zoom rotation, in radians.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The rotation center.\n   */\n  adjustRotationInternal(delta, opt_anchor) {\n    const isMoving = this.getAnimating() || this.getInteracting();\n    const newRotation = this.constraints_.rotation(this.targetRotation_ + delta, isMoving);\n    if (opt_anchor !== undefined) {\n      this.targetCenter_ = this.calculateCenterRotate(newRotation, opt_anchor);\n    }\n    this.targetRotation_ += delta;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Set the center of the current view. Any extent constraint will apply.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   * @observable\n   * @api\n   */\n  setCenter(center) {\n    this.setCenterInternal(fromUserCoordinate(center, this.getProjection()));\n  }\n\n  /**\n   * Set the center using the view projection (not the user projection).\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} center The center of the view.\n   */\n  setCenterInternal(center) {\n    this.targetCenter_ = center;\n    this.applyTargetState_();\n  }\n\n  /**\n   * @param {ViewHint} hint Hint.\n   * @param {number} delta Delta.\n   * @return {number} New value.\n   */\n  setHint(hint, delta) {\n    this.hints_[hint] += delta;\n    this.changed();\n    return this.hints_[hint];\n  }\n\n  /**\n   * Set the resolution for this view. Any resolution constraint will apply.\n   * @param {number|undefined} resolution The resolution of the view.\n   * @observable\n   * @api\n   */\n  setResolution(resolution) {\n    this.targetResolution_ = resolution;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Set the rotation for this view. Any rotation constraint will apply.\n   * @param {number} rotation The rotation of the view in radians.\n   * @observable\n   * @api\n   */\n  setRotation(rotation) {\n    this.targetRotation_ = rotation;\n    this.applyTargetState_();\n  }\n\n  /**\n   * Zoom to a specific zoom level. Any resolution constrain will apply.\n   * @param {number} zoom Zoom level.\n   * @api\n   */\n  setZoom(zoom) {\n    this.setResolution(this.getResolutionForZoom(zoom));\n  }\n\n  /**\n   * Recompute rotation/resolution/center based on target values.\n   * Note: we have to compute rotation first, then resolution and center considering that\n   * parameters can influence one another in case a view extent constraint is present.\n   * @param {boolean=} opt_doNotCancelAnims Do not cancel animations.\n   * @param {boolean=} opt_forceMoving Apply constraints as if the view is moving.\n   * @private\n   */\n  applyTargetState_(opt_doNotCancelAnims, opt_forceMoving) {\n    const isMoving = this.getAnimating() || this.getInteracting() || opt_forceMoving;\n\n    // compute rotation\n    const newRotation = this.constraints_.rotation(this.targetRotation_, isMoving);\n    const size = this.getSizeFromViewport_(newRotation);\n    const newResolution = this.constraints_.resolution(this.targetResolution_, 0, size, isMoving);\n    const newCenter = this.constraints_.center(this.targetCenter_, newResolution, size, isMoving);\n\n    if (this.get(ViewProperty.ROTATION) !== newRotation) {\n      this.set(ViewProperty.ROTATION, newRotation);\n    }\n    if (this.get(ViewProperty.RESOLUTION) !== newResolution) {\n      this.set(ViewProperty.RESOLUTION, newResolution);\n    }\n    if (!this.get(ViewProperty.CENTER) || !equals(this.get(ViewProperty.CENTER), newCenter)) {\n      this.set(ViewProperty.CENTER, newCenter);\n    }\n\n    if (this.getAnimating() && !opt_doNotCancelAnims) {\n      this.cancelAnimations();\n    }\n  }\n\n  /**\n   * If any constraints need to be applied, an animation will be triggered.\n   * This is typically done on interaction end.\n   * Note: calling this with a duration of 0 will apply the constrained values straight away,\n   * without animation.\n   * @param {number=} opt_duration The animation duration in ms.\n   * @param {number=} opt_resolutionDirection Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The origin of the transformation.\n   */\n  resolveConstraints(opt_duration, opt_resolutionDirection, opt_anchor) {\n    const duration = opt_duration !== undefined ? opt_duration : 200;\n    const direction = opt_resolutionDirection || 0;\n\n    const newRotation = this.constraints_.rotation(this.targetRotation_);\n    const size = this.getSizeFromViewport_(newRotation);\n    const newResolution = this.constraints_.resolution(this.targetResolution_, direction, size);\n    const newCenter = this.constraints_.center(this.targetCenter_, newResolution, size);\n\n    if (duration === 0) {\n      this.targetResolution_ = newResolution;\n      this.targetRotation_ = newRotation;\n      this.targetCenter_ = newCenter;\n      this.applyTargetState_();\n      return;\n    }\n\n    if (this.getResolution() !== newResolution ||\n      this.getRotation() !== newRotation ||\n      !this.getCenterInternal() ||\n      !equals(this.getCenterInternal(), newCenter)) {\n\n      if (this.getAnimating()) {\n        this.cancelAnimations();\n      }\n\n      this.animateInternal({\n        rotation: newRotation,\n        center: newCenter,\n        resolution: newResolution,\n        duration: duration,\n        easing: easeOut,\n        anchor: opt_anchor\n      });\n    }\n  }\n\n  /**\n   * Notify the View that an interaction has started.\n   * The view state will be resolved to a stable one if needed\n   * (depending on its constraints).\n   * @api\n   */\n  beginInteraction() {\n    this.resolveConstraints(0);\n\n    this.setHint(ViewHint.INTERACTING, 1);\n  }\n\n  /**\n   * Notify the View that an interaction has ended. The view state will be resolved\n   * to a stable one if needed (depending on its constraints).\n   * @param {number=} opt_duration Animation duration in ms.\n   * @param {number=} opt_resolutionDirection Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The origin of the transformation.\n   * @api\n   */\n  endInteraction(opt_duration, opt_resolutionDirection, opt_anchor) {\n    const anchor = opt_anchor && fromUserCoordinate(opt_anchor, this.getProjection());\n    this.endInteractionInternal(opt_duration, opt_resolutionDirection, anchor);\n  }\n\n  /**\n   * Notify the View that an interaction has ended. The view state will be resolved\n   * to a stable one if needed (depending on its constraints).\n   * @param {number=} opt_duration Animation duration in ms.\n   * @param {number=} opt_resolutionDirection Which direction to zoom.\n   * @param {import(\"./coordinate.js\").Coordinate=} opt_anchor The origin of the transformation.\n   */\n  endInteractionInternal(opt_duration, opt_resolutionDirection, opt_anchor) {\n    this.setHint(ViewHint.INTERACTING, -1);\n\n    this.resolveConstraints(opt_duration, opt_resolutionDirection, opt_anchor);\n  }\n\n  /**\n   * Get a valid position for the view center according to the current constraints.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} targetCenter Target center position.\n   * @param {number=} opt_targetResolution Target resolution. If not supplied, the current one will be used.\n   * This is useful to guess a valid center position at a different zoom level.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} Valid center position.\n   */\n  getConstrainedCenter(targetCenter, opt_targetResolution) {\n    const size = this.getSizeFromViewport_(this.getRotation());\n    return this.constraints_.center(targetCenter, opt_targetResolution || this.getResolution(), size);\n  }\n\n  /**\n   * Get a valid zoom level according to the current view constraints.\n   * @param {number|undefined} targetZoom Target zoom.\n   * @param {number=} [opt_direction=0] Indicate which resolution should be used\n   * by a renderer if the view resolution does not match any resolution of the tile source.\n   * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n   * will be used. If -1, the nearest higher resolution will be used.\n   * @return {number|undefined} Valid zoom level.\n   */\n  getConstrainedZoom(targetZoom, opt_direction) {\n    const targetRes = this.getResolutionForZoom(targetZoom);\n    return this.getZoomForResolution(this.getConstrainedResolution(targetRes, opt_direction));\n  }\n\n  /**\n   * Get a valid resolution according to the current view constraints.\n   * @param {number|undefined} targetResolution Target resolution.\n   * @param {number=} [opt_direction=0] Indicate which resolution should be used\n   * by a renderer if the view resolution does not match any resolution of the tile source.\n   * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n   * will be used. If -1, the nearest higher resolution will be used.\n   * @return {number|undefined} Valid resolution.\n   */\n  getConstrainedResolution(targetResolution, opt_direction) {\n    const direction = opt_direction || 0;\n    const size = this.getSizeFromViewport_(this.getRotation());\n\n    return this.constraints_.resolution(targetResolution, direction, size);\n  }\n}\n\n\n/**\n * @param {Function} callback Callback.\n * @param {*} returnValue Return value.\n */\nfunction animationCallback(callback, returnValue) {\n  setTimeout(function() {\n    callback(returnValue);\n  }, 0);\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./centerconstraint.js\").Type} The constraint.\n */\nexport function createCenterConstraint(options) {\n  if (options.extent !== undefined) {\n    const smooth = options.smoothExtentConstraint !== undefined ? options.smoothExtentConstraint : true;\n    return createExtent(options.extent, options.constrainOnlyCenter, smooth);\n  }\n\n  const projection = createProjection(options.projection, 'EPSG:3857');\n  if (options.multiWorld !== true && projection.isGlobal()) {\n    const extent = projection.getExtent().slice();\n    extent[0] = -Infinity;\n    extent[2] = Infinity;\n    return createExtent(extent, false, false);\n  }\n\n  return centerNone;\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {{constraint: import(\"./resolutionconstraint.js\").Type, maxResolution: number,\n *     minResolution: number, minZoom: number, zoomFactor: number}} The constraint.\n */\nexport function createResolutionConstraint(options) {\n  let resolutionConstraint;\n  let maxResolution;\n  let minResolution;\n\n  // TODO: move these to be ol constants\n  // see https://github.com/openlayers/openlayers/issues/2076\n  const defaultMaxZoom = 28;\n  const defaultZoomFactor = 2;\n\n  let minZoom = options.minZoom !== undefined ?\n    options.minZoom : DEFAULT_MIN_ZOOM;\n\n  let maxZoom = options.maxZoom !== undefined ?\n    options.maxZoom : defaultMaxZoom;\n\n  const zoomFactor = options.zoomFactor !== undefined ?\n    options.zoomFactor : defaultZoomFactor;\n\n  const multiWorld = options.multiWorld !== undefined ?\n    options.multiWorld : false;\n\n  const smooth =\n      options.smoothResolutionConstraint !== undefined ? options.smoothResolutionConstraint : true;\n\n  const projection = createProjection(options.projection, 'EPSG:3857');\n  const projExtent = projection.getExtent();\n  let constrainOnlyCenter = options.constrainOnlyCenter;\n  let extent = options.extent;\n  if (!multiWorld && !extent && projection.isGlobal()) {\n    constrainOnlyCenter = false;\n    extent = projExtent;\n  }\n\n  if (options.resolutions !== undefined) {\n    const resolutions = options.resolutions;\n    maxResolution = resolutions[minZoom];\n    minResolution = resolutions[maxZoom] !== undefined ?\n      resolutions[maxZoom] : resolutions[resolutions.length - 1];\n\n    if (options.constrainResolution) {\n      resolutionConstraint = createSnapToResolutions(resolutions, smooth,\n        !constrainOnlyCenter && extent);\n    } else {\n      resolutionConstraint = createMinMaxResolution(maxResolution, minResolution, smooth,\n        !constrainOnlyCenter && extent);\n    }\n  } else {\n    // calculate the default min and max resolution\n    const size = !projExtent ?\n      // use an extent that can fit the whole world if need be\n      360 * METERS_PER_UNIT[Units.DEGREES] /\n            projection.getMetersPerUnit() :\n      Math.max(getWidth(projExtent), getHeight(projExtent));\n\n    const defaultMaxResolution = size / DEFAULT_TILE_SIZE / Math.pow(\n      defaultZoomFactor, DEFAULT_MIN_ZOOM);\n\n    const defaultMinResolution = defaultMaxResolution / Math.pow(\n      defaultZoomFactor, defaultMaxZoom - DEFAULT_MIN_ZOOM);\n\n    // user provided maxResolution takes precedence\n    maxResolution = options.maxResolution;\n    if (maxResolution !== undefined) {\n      minZoom = 0;\n    } else {\n      maxResolution = defaultMaxResolution / Math.pow(zoomFactor, minZoom);\n    }\n\n    // user provided minResolution takes precedence\n    minResolution = options.minResolution;\n    if (minResolution === undefined) {\n      if (options.maxZoom !== undefined) {\n        if (options.maxResolution !== undefined) {\n          minResolution = maxResolution / Math.pow(zoomFactor, maxZoom);\n        } else {\n          minResolution = defaultMaxResolution / Math.pow(zoomFactor, maxZoom);\n        }\n      } else {\n        minResolution = defaultMinResolution;\n      }\n    }\n\n    // given discrete zoom levels, minResolution may be different than provided\n    maxZoom = minZoom + Math.floor(\n      Math.log(maxResolution / minResolution) / Math.log(zoomFactor));\n    minResolution = maxResolution / Math.pow(zoomFactor, maxZoom - minZoom);\n\n    if (options.constrainResolution) {\n      resolutionConstraint = createSnapToPower(\n        zoomFactor, maxResolution, minResolution, smooth,\n        !constrainOnlyCenter && extent);\n    } else {\n      resolutionConstraint = createMinMaxResolution(maxResolution, minResolution, smooth,\n        !constrainOnlyCenter && extent);\n    }\n  }\n  return {constraint: resolutionConstraint, maxResolution: maxResolution,\n    minResolution: minResolution, minZoom: minZoom, zoomFactor: zoomFactor};\n}\n\n\n/**\n * @param {ViewOptions} options View options.\n * @return {import(\"./rotationconstraint.js\").Type} Rotation constraint.\n */\nexport function createRotationConstraint(options) {\n  const enableRotation = options.enableRotation !== undefined ?\n    options.enableRotation : true;\n  if (enableRotation) {\n    const constrainRotation = options.constrainRotation;\n    if (constrainRotation === undefined || constrainRotation === true) {\n      return createSnapToZero();\n    } else if (constrainRotation === false) {\n      return rotationNone;\n    } else if (typeof constrainRotation === 'number') {\n      return createSnapToN(constrainRotation);\n    } else {\n      return rotationNone;\n    }\n  } else {\n    return disable;\n  }\n}\n\n\n/**\n * Determine if an animation involves no view change.\n * @param {Animation} animation The animation.\n * @return {boolean} The animation involves no view change.\n */\nexport function isNoopAnimation(animation) {\n  if (animation.sourceCenter && animation.targetCenter) {\n    if (!coordinatesEqual(animation.sourceCenter, animation.targetCenter)) {\n      return false;\n    }\n  }\n  if (animation.sourceResolution !== animation.targetResolution) {\n    return false;\n  }\n  if (animation.sourceRotation !== animation.targetRotation) {\n    return false;\n  }\n  return true;\n}\n\nexport default View;\n","/**\n * @module ol/Map\n */\nimport PluggableMap from './PluggableMap.js';\nimport {defaults as defaultControls} from './control.js';\nimport {defaults as defaultInteractions} from './interaction.js';\nimport {assign} from './obj.js';\nimport CompositeMapRenderer from './renderer/Composite.js';\n\n/**\n * @classdesc\n * The map is the core component of OpenLayers. For a map to render, a view,\n * one or more layers, and a target container are needed:\n *\n *     import Map from 'ol/Map';\n *     import View from 'ol/View';\n *     import TileLayer from 'ol/layer/Tile';\n *     import OSM from 'ol/source/OSM';\n *\n *     var map = new Map({\n *       view: new View({\n *         center: [0, 0],\n *         zoom: 1\n *       }),\n *       layers: [\n *         new TileLayer({\n *           source: new OSM()\n *         })\n *       ],\n *       target: 'map'\n *     });\n *\n * The above snippet creates a map using a {@link module:ol/layer/Tile} to\n * display {@link module:ol/source/OSM~OSM} OSM data and render it to a DOM\n * element with the id `map`.\n *\n * The constructor places a viewport container (with CSS class name\n * `ol-viewport`) in the target element (see `getViewport()`), and then two\n * further elements within the viewport: one with CSS class name\n * `ol-overlaycontainer-stopevent` for controls and some overlays, and one with\n * CSS class name `ol-overlaycontainer` for other overlays (see the `stopEvent`\n * option of {@link module:ol/Overlay~Overlay} for the difference). The map\n * itself is placed in a further element within the viewport.\n *\n * Layers are stored as a {@link module:ol/Collection~Collection} in\n * layerGroups. A top-level group is provided by the library. This is what is\n * accessed by `getLayerGroup` and `setLayerGroup`. Layers entered in the\n * options are added to this group, and `addLayer` and `removeLayer` change the\n * layer collection in the group. `getLayers` is a convenience function for\n * `getLayerGroup().getLayers()`. Note that {@link module:ol/layer/Group~Group}\n * is a subclass of {@link module:ol/layer/Base}, so layers entered in the\n * options or added with `addLayer` can be groups, which can contain further\n * groups, and so on.\n *\n * @api\n */\nclass Map extends PluggableMap {\n\n  /**\n   * @param {import(\"./PluggableMap.js\").MapOptions} options Map options.\n   */\n  constructor(options) {\n    options = assign({}, options);\n    if (!options.controls) {\n      options.controls = defaultControls();\n    }\n    if (!options.interactions) {\n      options.interactions = defaultInteractions();\n    }\n\n    super(options);\n  }\n\n  createRenderer() {\n    return new CompositeMapRenderer(this);\n  }\n}\n\n\nexport default Map;\n","/**\n * @module ol/proj/epsg3857\n */\nimport {cosh} from '../math.js';\nimport Projection from './Projection.js';\nimport Units from './Units.js';\n\n\n/**\n * Radius of WGS84 sphere\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const HALF_SIZE = Math.PI * RADIUS;\n\n\n/**\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport const EXTENT = [\n  -HALF_SIZE, -HALF_SIZE,\n  HALF_SIZE, HALF_SIZE\n];\n\n\n/**\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport const WORLD_EXTENT = [-180, -85, 180, 85];\n\n\n/**\n * @classdesc\n * Projection object for web/spherical Mercator (EPSG:3857).\n */\nclass EPSG3857Projection extends Projection {\n\n  /**\n   * @param {string} code Code.\n   */\n  constructor(code) {\n    super({\n      code: code,\n      units: Units.METERS,\n      extent: EXTENT,\n      global: true,\n      worldExtent: WORLD_EXTENT,\n      getPointResolution: function(resolution, point) {\n        return resolution / cosh(point[1] / RADIUS);\n      }\n    });\n\n  }\n\n}\n\n\n/**\n * Projections equal to EPSG:3857.\n *\n * @const\n * @type {Array<import(\"./Projection.js\").default>}\n */\nexport const PROJECTIONS = [\n  new EPSG3857Projection('EPSG:3857'),\n  new EPSG3857Projection('EPSG:102100'),\n  new EPSG3857Projection('EPSG:102113'),\n  new EPSG3857Projection('EPSG:900913'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG:6.18:3:3857'),\n  new EPSG3857Projection('urn:ogc:def:crs:EPSG::3857'),\n  new EPSG3857Projection('http://www.opengis.net/gml/srs/epsg.xml#3857')\n];\n\n\n/**\n * Transformation from EPSG:4326 to EPSG:3857.\n *\n * @param {Array<number>} input Input array of coordinate values.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array<number>} Output array of coordinate values.\n */\nexport function fromEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  const halfSize = HALF_SIZE;\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = halfSize * input[i] / 180;\n    let y = RADIUS *\n        Math.log(Math.tan(Math.PI * (+input[i + 1] + 90) / 360));\n    if (y > halfSize) {\n      y = halfSize;\n    } else if (y < -halfSize) {\n      y = -halfSize;\n    }\n    output[i + 1] = y;\n  }\n  return output;\n}\n\n\n/**\n * Transformation from EPSG:3857 to EPSG:4326.\n *\n * @param {Array<number>} input Input array of coordinate values.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension (default is `2`).\n * @return {Array<number>} Output array of coordinate values.\n */\nexport function toEPSG4326(input, opt_output, opt_dimension) {\n  const length = input.length;\n  const dimension = opt_dimension > 1 ? opt_dimension : 2;\n  let output = opt_output;\n  if (output === undefined) {\n    if (dimension > 2) {\n      // preserve values beyond second dimension\n      output = input.slice();\n    } else {\n      output = new Array(length);\n    }\n  }\n  for (let i = 0; i < length; i += dimension) {\n    output[i] = 180 * input[i] / HALF_SIZE;\n    output[i + 1] = 360 * Math.atan(\n      Math.exp(input[i + 1] / RADIUS)) / Math.PI - 90;\n  }\n  return output;\n}\n","/**\n * @module ol/proj/epsg4326\n */\nimport Projection from './Projection.js';\nimport Units from './Units.js';\n\n\n/**\n * Semi-major radius of the WGS84 ellipsoid.\n *\n * @const\n * @type {number}\n */\nexport const RADIUS = 6378137;\n\n\n/**\n * Extent of the EPSG:4326 projection which is the whole world.\n *\n * @const\n * @type {import(\"../extent.js\").Extent}\n */\nexport const EXTENT = [-180, -90, 180, 90];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const METERS_PER_UNIT = Math.PI * RADIUS / 180;\n\n\n/**\n * @classdesc\n * Projection object for WGS84 geographic coordinates (EPSG:4326).\n *\n * Note that OpenLayers does not strictly comply with the EPSG definition.\n * The EPSG registry defines 4326 as a CRS for Latitude,Longitude (y,x).\n * OpenLayers treats EPSG:4326 as a pseudo-projection, with x,y coordinates.\n */\nclass EPSG4326Projection extends Projection {\n\n  /**\n   * @param {string} code Code.\n   * @param {string=} opt_axisOrientation Axis orientation.\n   */\n  constructor(code, opt_axisOrientation) {\n    super({\n      code: code,\n      units: Units.DEGREES,\n      extent: EXTENT,\n      axisOrientation: opt_axisOrientation,\n      global: true,\n      metersPerUnit: METERS_PER_UNIT,\n      worldExtent: EXTENT\n    });\n\n  }\n\n}\n\n\n/**\n * Projections equal to EPSG:4326.\n *\n * @const\n * @type {Array<import(\"./Projection.js\").default>}\n */\nexport const PROJECTIONS = [\n  new EPSG4326Projection('CRS:84'),\n  new EPSG4326Projection('EPSG:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG::4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:EPSG:6.6:4326', 'neu'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:1.3:CRS84'),\n  new EPSG4326Projection('urn:ogc:def:crs:OGC:2:84'),\n  new EPSG4326Projection('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),\n  new EPSG4326Projection('urn:x-ogc:def:crs:EPSG:4326', 'neu')\n];\n","/**\n * @module ol/proj/projections\n */\n\n\n/**\n * @type {Object<string, import(\"./Projection.js\").default>}\n */\nlet cache = {};\n\n\n/**\n * Clear the projections cache.\n */\nexport function clear() {\n  cache = {};\n}\n\n\n/**\n * Get a cached projection by code.\n * @param {string} code The code for the projection.\n * @return {import(\"./Projection.js\").default} The projection (if cached).\n */\nexport function get(code) {\n  return cache[code] || null;\n}\n\n\n/**\n * Add a projection to the cache.\n * @param {string} code The projection code.\n * @param {import(\"./Projection.js\").default} projection The projection to cache.\n */\nexport function add(code, projection) {\n  cache[code] = projection;\n}\n","/**\n * @module ol/proj\n */\n\n/**\n * The ol/proj module stores:\n * * a list of {@link module:ol/proj/Projection}\n * objects, one for each projection supported by the application\n * * a list of transform functions needed to convert coordinates in one projection\n * into another.\n *\n * The static functions are the methods used to maintain these.\n * Each transform function can handle not only simple coordinate pairs, but also\n * large arrays of coordinates such as vector geometries.\n *\n * When loaded, the library adds projection objects for EPSG:4326 (WGS84\n * geographic coordinates) and EPSG:3857 (Web or Spherical Mercator, as used\n * for example by Bing Maps or OpenStreetMap), together with the relevant\n * transform functions.\n *\n * Additional transforms may be added by using the http://proj4js.org/\n * library (version 2.2 or later). You can use the full build supplied by\n * Proj4js, or create a custom build to support those projections you need; see\n * the Proj4js website for how to do this. You also need the Proj4js definitions\n * for the required projections. These definitions can be obtained from\n * https://epsg.io/, and are a JS function, so can be loaded in a script\n * tag (as in the examples) or pasted into your application.\n *\n * After all required projection definitions are added to proj4's registry (by\n * using `proj4.defs()`), simply call `register(proj4)` from the `ol/proj/proj4`\n * package. Existing transforms are not changed by this function. See\n * examples/wms-image-custom-proj for an example of this.\n *\n * Additional projection definitions can be registered with `proj4.defs()` any\n * time. Just make sure to call `register(proj4)` again; for example, with user-supplied data where you don't\n * know in advance what projections are needed, you can initially load minimal\n * support and then load whichever are requested.\n *\n * Note that Proj4js does not support projection extents. If you want to add\n * one for creating default tile grids, you can add it after the Projection\n * object has been created with `setExtent`, for example,\n * `get('EPSG:1234').setExtent(extent)`.\n *\n * In addition to Proj4js support, any transform functions can be added with\n * {@link module:ol/proj~addCoordinateTransforms}. To use this, you must first create\n * a {@link module:ol/proj/Projection} object for the new projection and add it with\n * {@link module:ol/proj~addProjection}. You can then add the forward and inverse\n * functions with {@link module:ol/proj~addCoordinateTransforms}. See\n * examples/wms-custom-proj for an example of this.\n *\n * Note that if no transforms are needed and you only need to define the\n * projection, just add a {@link module:ol/proj/Projection} with\n * {@link module:ol/proj~addProjection}. See examples/wms-no-proj for an example of\n * this.\n */\nimport {getDistance} from './sphere.js';\nimport {applyTransform} from './extent.js';\nimport {modulo} from './math.js';\nimport {toEPSG4326, fromEPSG4326, PROJECTIONS as EPSG3857_PROJECTIONS} from './proj/epsg3857.js';\nimport {PROJECTIONS as EPSG4326_PROJECTIONS} from './proj/epsg4326.js';\nimport Projection from './proj/Projection.js';\nimport Units, {METERS_PER_UNIT} from './proj/Units.js';\nimport {add as addTransformFunc, clear as clearTransformFuncs, get as getTransformFunc} from './proj/transforms.js';\nimport {add as addProj, clear as clearProj, get as getProj} from './proj/projections.js';\n\n\n/**\n * A projection as {@link module:ol/proj/Projection}, SRS identifier\n * string or undefined.\n * @typedef {Projection|string|undefined} ProjectionLike\n * @api\n */\n\n\n/**\n * A transform function accepts an array of input coordinate values, an optional\n * output array, and an optional dimension (default should be 2).  The function\n * transforms the input coordinate values, populates the output array, and\n * returns the output array.\n *\n * @typedef {function(Array<number>, Array<number>=, number=): Array<number>} TransformFunction\n * @api\n */\n\n\nexport {METERS_PER_UNIT};\n\nexport {Projection};\n\n/**\n * @param {Array<number>} input Input coordinate array.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array<number>} Output coordinate array (new array, same coordinate\n *     values).\n */\nexport function cloneTransform(input, opt_output, opt_dimension) {\n  let output;\n  if (opt_output !== undefined) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    output = opt_output;\n  } else {\n    output = input.slice();\n  }\n  return output;\n}\n\n\n/**\n * @param {Array<number>} input Input coordinate array.\n * @param {Array<number>=} opt_output Output array of coordinate values.\n * @param {number=} opt_dimension Dimension.\n * @return {Array<number>} Input coordinate array (same array as input).\n */\nexport function identityTransform(input, opt_output, opt_dimension) {\n  if (opt_output !== undefined && input !== opt_output) {\n    for (let i = 0, ii = input.length; i < ii; ++i) {\n      opt_output[i] = input[i];\n    }\n    input = opt_output;\n  }\n  return input;\n}\n\n\n/**\n * Add a Projection object to the list of supported projections that can be\n * looked up by their code.\n *\n * @param {Projection} projection Projection instance.\n * @api\n */\nexport function addProjection(projection) {\n  addProj(projection.getCode(), projection);\n  addTransformFunc(projection, projection, cloneTransform);\n}\n\n\n/**\n * @param {Array<Projection>} projections Projections.\n */\nexport function addProjections(projections) {\n  projections.forEach(addProjection);\n}\n\n\n/**\n * Fetches a Projection object for the code specified.\n *\n * @param {ProjectionLike} projectionLike Either a code string which is\n *     a combination of authority and identifier such as \"EPSG:4326\", or an\n *     existing projection object, or undefined.\n * @return {Projection} Projection object, or null if not in list.\n * @api\n */\nexport function get(projectionLike) {\n  return typeof projectionLike === 'string' ?\n    getProj(/** @type {string} */ (projectionLike)) :\n    (/** @type {Projection} */ (projectionLike) || null);\n}\n\n\n/**\n * Get the resolution of the point in degrees or distance units.\n * For projections with degrees as the unit this will simply return the\n * provided resolution. For other projections the point resolution is\n * by default estimated by transforming the 'point' pixel to EPSG:4326,\n * measuring its width and height on the normal sphere,\n * and taking the average of the width and height.\n * A custom function can be provided for a specific projection, either\n * by setting the `getPointResolution` option in the\n * {@link module:ol/proj/Projection~Projection} constructor or by using\n * {@link module:ol/proj/Projection~Projection#setGetPointResolution} to change an existing\n * projection object.\n * @param {ProjectionLike} projection The projection.\n * @param {number} resolution Nominal resolution in projection units.\n * @param {import(\"./coordinate.js\").Coordinate} point Point to find adjusted resolution at.\n * @param {Units=} opt_units Units to get the point resolution in.\n * Default is the projection's units.\n * @return {number} Point resolution.\n * @api\n */\nexport function getPointResolution(projection, resolution, point, opt_units) {\n  projection = get(projection);\n  let pointResolution;\n  const getter = projection.getPointResolutionFunc();\n  if (getter) {\n    pointResolution = getter(resolution, point);\n    if (opt_units && opt_units !== projection.getUnits()) {\n      const metersPerUnit = projection.getMetersPerUnit();\n      if (metersPerUnit) {\n        pointResolution = pointResolution * metersPerUnit / METERS_PER_UNIT[opt_units];\n      }\n    }\n  } else {\n    const units = projection.getUnits();\n    if (units == Units.DEGREES && !opt_units || opt_units == Units.DEGREES) {\n      pointResolution = resolution;\n    } else {\n      // Estimate point resolution by transforming the center pixel to EPSG:4326,\n      // measuring its width and height on the normal sphere, and taking the\n      // average of the width and height.\n      const toEPSG4326 = getTransformFromProjections(projection, get('EPSG:4326'));\n      let vertices = [\n        point[0] - resolution / 2, point[1],\n        point[0] + resolution / 2, point[1],\n        point[0], point[1] - resolution / 2,\n        point[0], point[1] + resolution / 2\n      ];\n      vertices = toEPSG4326(vertices, vertices, 2);\n      const width = getDistance(vertices.slice(0, 2), vertices.slice(2, 4));\n      const height = getDistance(vertices.slice(4, 6), vertices.slice(6, 8));\n      pointResolution = (width + height) / 2;\n      const metersPerUnit = opt_units ?\n        METERS_PER_UNIT[opt_units] :\n        projection.getMetersPerUnit();\n      if (metersPerUnit !== undefined) {\n        pointResolution /= metersPerUnit;\n      }\n    }\n  }\n  return pointResolution;\n}\n\n\n/**\n * Registers transformation functions that don't alter coordinates. Those allow\n * to transform between projections with equal meaning.\n *\n * @param {Array<Projection>} projections Projections.\n * @api\n */\nexport function addEquivalentProjections(projections) {\n  addProjections(projections);\n  projections.forEach(function(source) {\n    projections.forEach(function(destination) {\n      if (source !== destination) {\n        addTransformFunc(source, destination, cloneTransform);\n      }\n    });\n  });\n}\n\n\n/**\n * Registers transformation functions to convert coordinates in any projection\n * in projection1 to any projection in projection2.\n *\n * @param {Array<Projection>} projections1 Projections with equal\n *     meaning.\n * @param {Array<Projection>} projections2 Projections with equal\n *     meaning.\n * @param {TransformFunction} forwardTransform Transformation from any\n *   projection in projection1 to any projection in projection2.\n * @param {TransformFunction} inverseTransform Transform from any projection\n *   in projection2 to any projection in projection1..\n */\nexport function addEquivalentTransforms(projections1, projections2, forwardTransform, inverseTransform) {\n  projections1.forEach(function(projection1) {\n    projections2.forEach(function(projection2) {\n      addTransformFunc(projection1, projection2, forwardTransform);\n      addTransformFunc(projection2, projection1, inverseTransform);\n    });\n  });\n}\n\n\n/**\n * Clear all cached projections and transforms.\n */\nexport function clearAllProjections() {\n  clearProj();\n  clearTransformFuncs();\n}\n\n\n/**\n * @param {Projection|string|undefined} projection Projection.\n * @param {string} defaultCode Default code.\n * @return {Projection} Projection.\n */\nexport function createProjection(projection, defaultCode) {\n  if (!projection) {\n    return get(defaultCode);\n  } else if (typeof projection === 'string') {\n    return get(projection);\n  } else {\n    return (\n      /** @type {Projection} */ (projection)\n    );\n  }\n}\n\n\n/**\n * Creates a {@link module:ol/proj~TransformFunction} from a simple 2D coordinate transform\n * function.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} coordTransform Coordinate\n *     transform.\n * @return {TransformFunction} Transform function.\n */\nexport function createTransformFromCoordinateTransform(coordTransform) {\n  return (\n    /**\n     * @param {Array<number>} input Input.\n     * @param {Array<number>=} opt_output Output.\n     * @param {number=} opt_dimension Dimension.\n     * @return {Array<number>} Output.\n     */\n    function(input, opt_output, opt_dimension) {\n      const length = input.length;\n      const dimension = opt_dimension !== undefined ? opt_dimension : 2;\n      const output = opt_output !== undefined ? opt_output : new Array(length);\n      for (let i = 0; i < length; i += dimension) {\n        const point = coordTransform([input[i], input[i + 1]]);\n        output[i] = point[0];\n        output[i + 1] = point[1];\n        for (let j = dimension - 1; j >= 2; --j) {\n          output[i + j] = input[i + j];\n        }\n      }\n      return output;\n    });\n}\n\n\n/**\n * Registers coordinate transform functions to convert coordinates between the\n * source projection and the destination projection.\n * The forward and inverse functions convert coordinate pairs; this function\n * converts these into the functions used internally which also handle\n * extents and coordinate arrays.\n *\n * @param {ProjectionLike} source Source projection.\n * @param {ProjectionLike} destination Destination projection.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} forward The forward transform\n *     function (that is, from the source projection to the destination\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @param {function(import(\"./coordinate.js\").Coordinate): import(\"./coordinate.js\").Coordinate} inverse The inverse transform\n *     function (that is, from the destination projection to the source\n *     projection) that takes a {@link module:ol/coordinate~Coordinate} as argument and returns\n *     the transformed {@link module:ol/coordinate~Coordinate}.\n * @api\n */\nexport function addCoordinateTransforms(source, destination, forward, inverse) {\n  const sourceProj = get(source);\n  const destProj = get(destination);\n  addTransformFunc(sourceProj, destProj, createTransformFromCoordinateTransform(forward));\n  addTransformFunc(destProj, sourceProj, createTransformFromCoordinateTransform(inverse));\n}\n\n\n/**\n * Transforms a coordinate from longitude/latitude to a different projection.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate as longitude and latitude, i.e.\n *     an array with longitude as 1st and latitude as 2nd element.\n * @param {ProjectionLike=} opt_projection Target projection. The\n *     default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate projected to the target projection.\n * @api\n */\nexport function fromLonLat(coordinate, opt_projection) {\n  return transform(coordinate, 'EPSG:4326',\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857');\n}\n\n\n/**\n * Transforms a coordinate to longitude/latitude.\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Projected coordinate.\n * @param {ProjectionLike=} opt_projection Projection of the coordinate.\n *     The default is Web Mercator, i.e. 'EPSG:3857'.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate as longitude and latitude, i.e. an array\n *     with longitude as 1st and latitude as 2nd element.\n * @api\n */\nexport function toLonLat(coordinate, opt_projection) {\n  const lonLat = transform(coordinate,\n    opt_projection !== undefined ? opt_projection : 'EPSG:3857', 'EPSG:4326');\n  const lon = lonLat[0];\n  if (lon < -180 || lon > 180) {\n    lonLat[0] = modulo(lon + 180, 360) - 180;\n  }\n  return lonLat;\n}\n\n\n/**\n * Checks if two projections are the same, that is every coordinate in one\n * projection does represent the same geographic point as the same coordinate in\n * the other projection.\n *\n * @param {Projection} projection1 Projection 1.\n * @param {Projection} projection2 Projection 2.\n * @return {boolean} Equivalent.\n * @api\n */\nexport function equivalent(projection1, projection2) {\n  if (projection1 === projection2) {\n    return true;\n  }\n  const equalUnits = projection1.getUnits() === projection2.getUnits();\n  if (projection1.getCode() === projection2.getCode()) {\n    return equalUnits;\n  } else {\n    const transformFunc = getTransformFromProjections(projection1, projection2);\n    return transformFunc === cloneTransform && equalUnits;\n  }\n}\n\n\n/**\n * Searches in the list of transform functions for the function for converting\n * coordinates from the source projection to the destination projection.\n *\n * @param {Projection} sourceProjection Source Projection object.\n * @param {Projection} destinationProjection Destination Projection\n *     object.\n * @return {TransformFunction} Transform function.\n */\nexport function getTransformFromProjections(sourceProjection, destinationProjection) {\n  const sourceCode = sourceProjection.getCode();\n  const destinationCode = destinationProjection.getCode();\n  let transformFunc = getTransformFunc(sourceCode, destinationCode);\n  if (!transformFunc) {\n    transformFunc = identityTransform;\n  }\n  return transformFunc;\n}\n\n\n/**\n * Given the projection-like objects, searches for a transformation\n * function to convert a coordinates array from the source projection to the\n * destination projection.\n *\n * @param {ProjectionLike} source Source.\n * @param {ProjectionLike} destination Destination.\n * @return {TransformFunction} Transform function.\n * @api\n */\nexport function getTransform(source, destination) {\n  const sourceProjection = get(source);\n  const destinationProjection = get(destination);\n  return getTransformFromProjections(sourceProjection, destinationProjection);\n}\n\n\n/**\n * Transforms a coordinate from source projection to destination projection.\n * This returns a new coordinate (and does not modify the original).\n *\n * See {@link module:ol/proj~transformExtent} for extent transformation.\n * See the transform method of {@link module:ol/geom/Geometry~Geometry} and its\n * subclasses for geometry transforms.\n *\n * @param {import(\"./coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {ProjectionLike} source Source projection-like.\n * @param {ProjectionLike} destination Destination projection-like.\n * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n * @api\n */\nexport function transform(coordinate, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return transformFunc(coordinate, undefined, coordinate.length);\n}\n\n\n/**\n * Transforms an extent from source projection to destination projection.  This\n * returns a new extent (and does not modify the original).\n *\n * @param {import(\"./extent.js\").Extent} extent The extent to transform.\n * @param {ProjectionLike} source Source projection-like.\n * @param {ProjectionLike} destination Destination projection-like.\n * @return {import(\"./extent.js\").Extent} The transformed extent.\n * @api\n */\nexport function transformExtent(extent, source, destination) {\n  const transformFunc = getTransform(source, destination);\n  return applyTransform(extent, transformFunc);\n}\n\n\n/**\n * Transforms the given point to the destination projection.\n *\n * @param {import(\"./coordinate.js\").Coordinate} point Point.\n * @param {Projection} sourceProjection Source projection.\n * @param {Projection} destinationProjection Destination projection.\n * @return {import(\"./coordinate.js\").Coordinate} Point.\n */\nexport function transformWithProjections(point, sourceProjection, destinationProjection) {\n  const transformFunc = getTransformFromProjections(sourceProjection, destinationProjection);\n  return transformFunc(point);\n}\n\n/**\n * @type {Projection}\n */\nlet userProjection = null;\n\n/**\n * Set the projection for coordinates supplied from and returned by API methods.\n * Note that this method is not yet a part of the stable API.  Support for user\n * projections is not yet complete and should be considered experimental.\n * @param {ProjectionLike} projection The user projection.\n */\nexport function setUserProjection(projection) {\n  userProjection = get(projection);\n}\n\n/**\n * Clear the user projection if set.  Note that this method is not yet a part of\n * the stable API.  Support for user projections is not yet complete and should\n * be considered experimental.\n */\nexport function clearUserProjection() {\n  userProjection = null;\n}\n\n/**\n * Get the projection for coordinates supplied from and returned by API methods.\n * Note that this method is not yet a part of the stable API.  Support for user\n * projections is not yet complete and should be considered experimental.\n * @returns {Projection} The user projection (or null if not set).\n */\nexport function getUserProjection() {\n  return userProjection;\n}\n\n/**\n * Use geographic coordinates (WGS-84 datum) in API methods.  Note that this\n * method is not yet a part of the stable API.  Support for user projections is\n * not yet complete and should be considered experimental.\n */\nexport function useGeographic() {\n  setUserProjection('EPSG:4326');\n}\n\n/**\n * Return a coordinate transformed into the user projection.  If no user projection\n * is set, the original coordinate is returned.\n * @param {Array<number>} coordinate Input coordinate.\n * @param {ProjectionLike} sourceProjection The input coordinate projection.\n * @returns {Array<number>} The input coordinate in the user projection.\n */\nexport function toUserCoordinate(coordinate, sourceProjection) {\n  if (!userProjection) {\n    return coordinate;\n  }\n  return transform(coordinate, sourceProjection, userProjection);\n}\n\n/**\n * Return a coordinate transformed from the user projection.  If no user projection\n * is set, the original coordinate is returned.\n * @param {Array<number>} coordinate Input coordinate.\n * @param {ProjectionLike} destProjection The destination projection.\n * @returns {Array<number>} The input coordinate transformed.\n */\nexport function fromUserCoordinate(coordinate, destProjection) {\n  if (!userProjection) {\n    return coordinate;\n  }\n  return transform(coordinate, userProjection, destProjection);\n}\n\n/**\n * Return an extent transformed into the user projection.  If no user projection\n * is set, the original extent is returned.\n * @param {import(\"./extent.js\").Extent} extent Input extent.\n * @param {ProjectionLike} sourceProjection The input extent projection.\n * @returns {import(\"./extent.js\").Extent} The input extent in the user projection.\n */\nexport function toUserExtent(extent, sourceProjection) {\n  if (!userProjection) {\n    return extent;\n  }\n  return transformExtent(extent, sourceProjection, userProjection);\n}\n\n/**\n * Return an extent transformed from the user projection.  If no user projection\n * is set, the original extent is returned.\n * @param {import(\"./extent.js\").Extent} extent Input extent.\n * @param {ProjectionLike} destProjection The destination projection.\n * @returns {import(\"./extent.js\").Extent} The input extent transformed.\n */\nexport function fromUserExtent(extent, destProjection) {\n  if (!userProjection) {\n    return extent;\n  }\n  return transformExtent(extent, userProjection, destProjection);\n}\n\n/**\n * Add transforms to and from EPSG:4326 and EPSG:3857.  This function is called\n * by when this module is executed and should only need to be called again after\n * `clearAllProjections()` is called (e.g. in tests).\n */\nexport function addCommon() {\n  // Add transformations that don't alter coordinates to convert within set of\n  // projections with equal meaning.\n  addEquivalentProjections(EPSG3857_PROJECTIONS);\n  addEquivalentProjections(EPSG4326_PROJECTIONS);\n  // Add transformations to convert EPSG:4326 like coordinates to EPSG:3857 like\n  // coordinates and back.\n  addEquivalentTransforms(EPSG4326_PROJECTIONS, EPSG3857_PROJECTIONS, fromEPSG4326, toEPSG4326);\n}\n\naddCommon();\n","/**\n * @module ol/layer/BaseTile\n */\nimport Layer from './Layer.js';\nimport TileProperty from './TileProperty.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [preload=0] Preload. Load low-resolution tiles up to `preload` levels. `0`\n * means no preloading.\n * @property {import(\"../source/Tile.js\").default} [source] Source for this layer.\n * @property {import(\"../PluggableMap.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [useInterimTilesOnError=true] Use interim tiles on error.\n */\n\n\n/**\n * @classdesc\n * For layer sources that provide pre-rendered, tiled images in grids that are\n * organized by zoom levels for specific resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @extends {Layer<import(\"../source/Tile.js\").default>}\n * @api\n */\nclass BaseTileLayer extends Layer {\n  /**\n   * @param {Options=} opt_options Tile layer options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const baseOptions = assign({}, options);\n\n    delete baseOptions.preload;\n    delete baseOptions.useInterimTilesOnError;\n    super(baseOptions);\n\n    this.setPreload(options.preload !== undefined ? options.preload : 0);\n    this.setUseInterimTilesOnError(options.useInterimTilesOnError !== undefined ?\n      options.useInterimTilesOnError : true);\n\n  }\n\n  /**\n  * Return the level as number to which we will preload tiles up to.\n  * @return {number} The level to preload tiles up to.\n  * @observable\n  * @api\n  */\n  getPreload() {\n    return /** @type {number} */ (this.get(TileProperty.PRELOAD));\n  }\n\n  /**\n  * Set the level as number to which we will preload tiles up to.\n  * @param {number} preload The level to preload tiles up to.\n  * @observable\n  * @api\n  */\n  setPreload(preload) {\n    this.set(TileProperty.PRELOAD, preload);\n  }\n\n  /**\n  * Whether we use interim tiles on error.\n  * @return {boolean} Use interim tiles on error.\n  * @observable\n  * @api\n  */\n  getUseInterimTilesOnError() {\n    return /** @type {boolean} */ (this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR));\n  }\n\n  /**\n  * Set whether we use interim tiles on error.\n  * @param {boolean} useInterimTilesOnError Use interim tiles on error.\n  * @observable\n  * @api\n  */\n  setUseInterimTilesOnError(useInterimTilesOnError) {\n    this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR, useInterimTilesOnError);\n  }\n}\n\n\nexport default BaseTileLayer;\n","/**\n * @module ol/layer/Tile\n */\nimport BaseTileLayer from './BaseTile.js';\nimport CanvasTileLayerRenderer from '../renderer/canvas/TileLayer.js';\n\n\n/**\n * @classdesc\n * For layer sources that provide pre-rendered, tiled images in grids that are\n * organized by zoom levels for specific resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @api\n */\nclass TileLayer extends BaseTileLayer {\n\n  /**\n   * @param {import(\"./BaseTile.js\").Options=} opt_options Tile layer options.\n   */\n  constructor(opt_options) {\n    super(opt_options);\n  }\n\n  /**\n   * Create a renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n   * @protected\n   */\n  createRenderer() {\n    return new CanvasTileLayerRenderer(this);\n  }\n\n}\n\nexport default TileLayer;\n","/**\n * @module ol/format/xsd\n */\nimport {getAllTextContent, DOCUMENT} from '../xml.js';\nimport {padNumber} from '../string.js';\n\n\n/**\n * @param {Node} node Node.\n * @return {boolean|undefined} Boolean.\n */\nexport function readBoolean(node) {\n  const s = getAllTextContent(node, false);\n  return readBooleanString(s);\n}\n\n\n/**\n * @param {string} string String.\n * @return {boolean|undefined} Boolean.\n */\nexport function readBooleanString(string) {\n  const m = /^\\s*(true|1)|(false|0)\\s*$/.exec(string);\n  if (m) {\n    return m[1] !== undefined || false;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} DateTime in seconds.\n */\nexport function readDateTime(node) {\n  const s = getAllTextContent(node, false);\n  const dateTime = Date.parse(s);\n  return isNaN(dateTime) ? undefined : dateTime / 1000;\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Decimal.\n */\nexport function readDecimal(node) {\n  const s = getAllTextContent(node, false);\n  return readDecimalString(s);\n}\n\n\n/**\n * @param {string} string String.\n * @return {number|undefined} Decimal.\n */\nexport function readDecimalString(string) {\n  // FIXME check spec\n  const m = /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*$/i.exec(string);\n  if (m) {\n    return parseFloat(m[1]);\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Non negative integer.\n */\nexport function readNonNegativeInteger(node) {\n  const s = getAllTextContent(node, false);\n  return readNonNegativeIntegerString(s);\n}\n\n\n/**\n * @param {string} string String.\n * @return {number|undefined} Non negative integer.\n */\nexport function readNonNegativeIntegerString(string) {\n  const m = /^\\s*(\\d+)\\s*$/.exec(string);\n  if (m) {\n    return parseInt(m[1], 10);\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {string|undefined} String.\n */\nexport function readString(node) {\n  return getAllTextContent(node, false).trim();\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the boolean to.\n * @param {boolean} bool Boolean.\n */\nexport function writeBooleanTextNode(node, bool) {\n  writeStringTextNode(node, (bool) ? '1' : '0');\n}\n\n\n/**\n * @param {Node} node Node to append a CDATA Section with the string to.\n * @param {string} string String.\n */\nexport function writeCDATASection(node, string) {\n  node.appendChild(DOCUMENT.createCDATASection(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the dateTime to.\n * @param {number} dateTime DateTime in seconds.\n */\nexport function writeDateTimeTextNode(node, dateTime) {\n  const date = new Date(dateTime * 1000);\n  const string = date.getUTCFullYear() + '-' +\n      padNumber(date.getUTCMonth() + 1, 2) + '-' +\n      padNumber(date.getUTCDate(), 2) + 'T' +\n      padNumber(date.getUTCHours(), 2) + ':' +\n      padNumber(date.getUTCMinutes(), 2) + ':' +\n      padNumber(date.getUTCSeconds(), 2) + 'Z';\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the decimal to.\n * @param {number} decimal Decimal.\n */\nexport function writeDecimalTextNode(node, decimal) {\n  const string = decimal.toPrecision();\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the decimal to.\n * @param {number} nonNegativeInteger Non negative integer.\n */\nexport function writeNonNegativeIntegerTextNode(node, nonNegativeInteger) {\n  const string = nonNegativeInteger.toString();\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the string to.\n * @param {string} string String.\n */\nexport function writeStringTextNode(node, string) {\n  node.appendChild(DOCUMENT.createTextNode(string));\n}\n","/**\n * @module ol/geom/GeometryType\n */\n\n/**\n * The geometry type. One of `'Point'`, `'LineString'`, `'LinearRing'`,\n * `'Polygon'`, `'MultiPoint'`, `'MultiLineString'`, `'MultiPolygon'`,\n * `'GeometryCollection'`, `'Circle'`.\n * @enum {string}\n */\nexport default {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  LINEAR_RING: 'LinearRing',\n  POLYGON: 'Polygon',\n  MULTI_POINT: 'MultiPoint',\n  MULTI_LINE_STRING: 'MultiLineString',\n  MULTI_POLYGON: 'MultiPolygon',\n  GEOMETRY_COLLECTION: 'GeometryCollection',\n  CIRCLE: 'Circle'\n};\n","/**\n * @module ol/util\n */\n\n/**\n * @return {?} Any return.\n */\nexport function abstract() {\n  return /** @type {?} */ ((function() {\n    throw new Error('Unimplemented abstract method.');\n  })());\n}\n\n/**\n * Counter for getUid.\n * @type {number}\n * @private\n */\nlet uidCounter_ = 0;\n\n/**\n * Gets a unique ID for an object. This mutates the object so that further calls\n * with the same object as a parameter returns the same value. Unique IDs are generated\n * as a strictly increasing sequence. Adapted from goog.getUid.\n *\n * @param {Object} obj The object to get the unique ID for.\n * @return {string} The unique ID for the object.\n * @api\n */\nexport function getUid(obj) {\n  return obj.ol_uid || (obj.ol_uid = String(++uidCounter_));\n}\n\n/**\n * OpenLayers version.\n * @type {string}\n */\nexport const VERSION = 'latest';\n","/**\n * @module ol/source/OSM\n */\n\nimport XYZ from './XYZ.js';\n\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nexport const ATTRIBUTION = '&#169; ' +\n      '<a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> ' +\n      'contributors.';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {number} [maxZoom=19] Max zoom.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {number} [reprojectionErrorThreshold=1.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url='https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png'] URL template.\n * Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n * @api\n */\nclass OSM extends XYZ {\n  /**\n   * @param {Options=} [opt_options] Open Street Map options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    let attributions;\n    if (options.attributions !== undefined) {\n      attributions = options.attributions;\n    } else {\n      attributions = [ATTRIBUTION];\n    }\n\n    const crossOrigin = options.crossOrigin !== undefined ?\n      options.crossOrigin : 'anonymous';\n\n    const url = options.url !== undefined ?\n      options.url : 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n    super({\n      attributions: attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: crossOrigin,\n      opaque: options.opaque !== undefined ? options.opaque : true,\n      maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileLoadFunction: options.tileLoadFunction,\n      url: url,\n      wrapX: options.wrapX,\n      attributionsCollapsible: false\n    });\n\n  }\n\n}\n\nexport default OSM;\n","/**\n * @module ol/source/Vector\n */\n\nimport {getUid} from '../util.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {extend} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, equals} from '../extent.js';\nimport {xhr} from '../featureloader.js';\nimport {TRUE, VOID} from '../functions.js';\nimport {all as allStrategy} from '../loadingstrategy.js';\nimport {isEmpty, getValues} from '../obj.js';\nimport Source from './Source.js';\nimport SourceState from './State.js';\nimport VectorEventType from './VectorEventType.js';\nimport RBush from '../structs/RBush.js';\n\n/**\n * A function that takes an {@link module:ol/extent~Extent} and a resolution as arguments, and\n * returns an array of {@link module:ol/extent~Extent} with the extents to load. Usually this\n * is one of the standard {@link module:ol/loadingstrategy} strategies.\n *\n * @typedef {function(import(\"../extent.js\").Extent, number): Array<import(\"../extent.js\").Extent>} LoadingStrategy\n * @api\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Vector} instances are instances of this\n * type.\n * @template {import(\"../geom/Geometry.js\").default} Geometry\n */\nexport class VectorSourceEvent extends Event {\n\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../Feature.js\").default<Geometry>=} opt_feature Feature.\n   */\n  constructor(type, opt_feature) {\n\n    super(type);\n\n    /**\n     * The feature being added or removed.\n     * @type {import(\"../Feature.js\").default<Geometry>|undefined}\n     * @api\n     */\n    this.feature = opt_feature;\n\n  }\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {Array<import(\"../Feature.js\").default>|Collection<import(\"../Feature.js\").default>} [features]\n * Features. If provided as {@link module:ol/Collection}, the features in the source\n * and the collection will stay in sync.\n * @property {import(\"../format/Feature.js\").default} [format] The feature format used by the XHR\n * feature loader when `url` is set. Required if `url` is set, otherwise ignored.\n * @property {import(\"../featureloader.js\").FeatureLoader} [loader]\n * The loader function used to load features, from a remote source for example.\n * If this is not set and `url` is set, the source will create and use an XHR\n * feature loader.\n *\n * Example:\n *\n * ```js\n * import {Vector} from 'ol/source';\n * import {GeoJSON} from 'ol/format';\n * import {bbox} from 'ol/loadingstrategy';\n *\n * var vectorSource = new Vector({\n *   format: new GeoJSON(),\n *   loader: function(extent, resolution, projection) {\n *      var proj = projection.getCode();\n *      var url = 'https://ahocevar.com/geoserver/wfs?service=WFS&' +\n *          'version=1.1.0&request=GetFeature&typename=osm:water_areas&' +\n *          'outputFormat=application/json&srsname=' + proj + '&' +\n *          'bbox=' + extent.join(',') + ',' + proj;\n *      var xhr = new XMLHttpRequest();\n *      xhr.open('GET', url);\n *      var onError = function() {\n *        vectorSource.removeLoadedExtent(extent);\n *      }\n *      xhr.onerror = onError;\n *      xhr.onload = function() {\n *        if (xhr.status == 200) {\n *          vectorSource.addFeatures(\n *              vectorSource.getFormat().readFeatures(xhr.responseText));\n *        } else {\n *          onError();\n *        }\n *      }\n *      xhr.send();\n *    },\n *    strategy: bbox\n *  });\n * ```\n * @property {boolean} [overlaps=true] This source may have overlapping geometries.\n * Setting this to `false` (e.g. for sources with polygons that represent administrative\n * boundaries or TopoJSON sources) allows the renderer to optimise fill and\n * stroke operations.\n * @property {LoadingStrategy} [strategy] The loading strategy to use.\n * By default an {@link module:ol/loadingstrategy~all}\n * strategy is used, a one-off strategy which loads all features at once.\n * @property {string|import(\"../featureloader.js\").FeatureUrlFunction} [url]\n * Setting this option instructs the source to load features using an XHR loader\n * (see {@link module:ol/featureloader~xhr}). Use a `string` and an\n * {@link module:ol/loadingstrategy~all} for a one-off download of all features from\n * the given URL. Use a {@link module:ol/featureloader~FeatureUrlFunction} to generate the url with\n * other loading strategies.\n * Requires `format` to be set as well.\n * When default XHR feature loader is provided, the features will\n * be transformed from the data projection to the view projection\n * during parsing. If your remote data source does not advertise its projection\n * properly, this transformation will be incorrect. For some formats, the\n * default projection (usually EPSG:4326) can be overridden by setting the\n * dataProjection constructor option on the format.\n * Note that if a source contains non-feature data, such as a GeoJSON geometry\n * or a KML NetworkLink, these will be ignored. Use a custom loader to load these.\n * @property {boolean} [useSpatialIndex=true]\n * By default, an RTree is used as spatial index. When features are removed and\n * added frequently, and the total number of features is low, setting this to\n * `false` may improve performance.\n *\n * Note that\n * {@link module:ol/source/Vector~VectorSource#getFeaturesInExtent},\n * {@link module:ol/source/Vector~VectorSource#getClosestFeatureToCoordinate} and\n * {@link module:ol/source/Vector~VectorSource#getExtent} cannot be used when `useSpatialIndex` is\n * set to `false`, and {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent} will loop\n * through all features.\n *\n * When set to `false`, the features will be maintained in an\n * {@link module:ol/Collection}, which can be retrieved through\n * {@link module:ol/source/Vector~VectorSource#getFeaturesCollection}.\n * @property {boolean} [wrapX=true] Wrap the world horizontally. For vector editing across the\n * -180° and 180° meridians to work properly, this should be set to `false`. The\n * resulting geometry coordinates will then exceed the world bounds.\n */\n\n\n/**\n * @classdesc\n * Provides a source of features for vector layers. Vector features provided\n * by this source are suitable for editing. See {@link module:ol/source/VectorTile~VectorTile} for\n * vector data that is optimized for rendering.\n *\n * @fires VectorSourceEvent\n * @api\n * @template {import(\"../geom/Geometry.js\").default} Geometry\n */\nclass VectorSource extends Source {\n  /**\n   * @param {Options=} opt_options Vector source options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    super({\n      attributions: options.attributions,\n      projection: undefined,\n      state: SourceState.READY,\n      wrapX: options.wrapX !== undefined ? options.wrapX : true\n    });\n\n    /**\n     * @private\n     * @type {import(\"../featureloader.js\").FeatureLoader}\n     */\n    this.loader_ = VOID;\n\n    /**\n     * @private\n     * @type {import(\"../format/Feature.js\").default|undefined}\n     */\n    this.format_ = options.format;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.overlaps_ = options.overlaps == undefined ? true : options.overlaps;\n\n    /**\n     * @private\n     * @type {string|import(\"../featureloader.js\").FeatureUrlFunction|undefined}\n     */\n    this.url_ = options.url;\n\n    if (options.loader !== undefined) {\n      this.loader_ = options.loader;\n    } else if (this.url_ !== undefined) {\n      assert(this.format_, 7); // `format` must be set when `url` is set\n      // create a XHR feature loader for \"url\" and \"format\"\n      this.loader_ = xhr(this.url_, /** @type {import(\"../format/Feature.js\").default} */ (this.format_));\n    }\n\n    /**\n     * @private\n     * @type {LoadingStrategy}\n     */\n    this.strategy_ = options.strategy !== undefined ? options.strategy : allStrategy;\n\n    const useSpatialIndex =\n        options.useSpatialIndex !== undefined ? options.useSpatialIndex : true;\n\n    /**\n     * @private\n     * @type {RBush<import(\"../Feature.js\").default<Geometry>>}\n     */\n    this.featuresRtree_ = useSpatialIndex ? new RBush() : null;\n\n    /**\n     * @private\n     * @type {RBush<{extent: import(\"../extent.js\").Extent}>}\n     */\n    this.loadedExtentsRtree_ = new RBush();\n\n    /**\n     * @private\n     * @type {!Object<string, import(\"../Feature.js\").default<Geometry>>}\n     */\n    this.nullGeometryFeatures_ = {};\n\n    /**\n     * A lookup of features by id (the return from feature.getId()).\n     * @private\n     * @type {!Object<string, import(\"../Feature.js\").default<Geometry>>}\n     */\n    this.idIndex_ = {};\n\n    /**\n     * A lookup of features by uid (using getUid(feature)).\n     * @private\n     * @type {!Object<string, import(\"../Feature.js\").default<Geometry>>}\n     */\n    this.uidIndex_ = {};\n\n    /**\n     * @private\n     * @type {Object<string, Array<import(\"../events.js\").EventsKey>>}\n     */\n    this.featureChangeKeys_ = {};\n\n    /**\n     * @private\n     * @type {Collection<import(\"../Feature.js\").default<Geometry>>}\n     */\n    this.featuresCollection_ = null;\n\n    let collection, features;\n    if (Array.isArray(options.features)) {\n      features = options.features;\n    } else if (options.features) {\n      collection = options.features;\n      features = collection.getArray();\n    }\n    if (!useSpatialIndex && collection === undefined) {\n      collection = new Collection(features);\n    }\n    if (features !== undefined) {\n      this.addFeaturesInternal(features);\n    }\n    if (collection !== undefined) {\n      this.bindFeaturesCollection_(collection);\n    }\n\n  }\n\n  /**\n   * Add a single feature to the source.  If you want to add a batch of features\n   * at once, call {@link module:ol/source/Vector~VectorSource#addFeatures #addFeatures()}\n   * instead. A feature will not be added to the source if feature with\n   * the same id is already there. The reason for this behavior is to avoid\n   * feature duplication when using bbox or tile loading strategies.\n   * Note: this also applies if an {@link module:ol/Collection} is used for features,\n   * meaning that if a feature with a duplicate id is added in the collection, it will\n   * be removed from it right away.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature Feature to add.\n   * @api\n   */\n  addFeature(feature) {\n    this.addFeatureInternal(feature);\n    this.changed();\n  }\n\n\n  /**\n   * Add a feature without firing a `change` event.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature Feature.\n   * @protected\n   */\n  addFeatureInternal(feature) {\n    const featureKey = getUid(feature);\n\n    if (!this.addToIndex_(featureKey, feature)) {\n      if (this.featuresCollection_) {\n        this.featuresCollection_.remove(feature);\n      }\n      return;\n    }\n\n    this.setupChangeEvents_(featureKey, feature);\n\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      const extent = geometry.getExtent();\n      if (this.featuresRtree_) {\n        this.featuresRtree_.insert(extent, feature);\n      }\n    } else {\n      this.nullGeometryFeatures_[featureKey] = feature;\n    }\n\n    this.dispatchEvent(\n      new VectorSourceEvent(VectorEventType.ADDFEATURE, feature));\n  }\n\n\n  /**\n   * @param {string} featureKey Unique identifier for the feature.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature The feature.\n   * @private\n   */\n  setupChangeEvents_(featureKey, feature) {\n    this.featureChangeKeys_[featureKey] = [\n      listen(feature, EventType.CHANGE,\n        this.handleFeatureChange_, this),\n      listen(feature, ObjectEventType.PROPERTYCHANGE,\n        this.handleFeatureChange_, this)\n    ];\n  }\n\n\n  /**\n   * @param {string} featureKey Unique identifier for the feature.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature The feature.\n   * @return {boolean} The feature is \"valid\", in the sense that it is also a\n   *     candidate for insertion into the Rtree.\n   * @private\n   */\n  addToIndex_(featureKey, feature) {\n    let valid = true;\n    const id = feature.getId();\n    if (id !== undefined) {\n      if (!(id.toString() in this.idIndex_)) {\n        this.idIndex_[id.toString()] = feature;\n      } else {\n        valid = false;\n      }\n    }\n    if (valid) {\n      assert(!(featureKey in this.uidIndex_),\n        30); // The passed `feature` was already added to the source\n      this.uidIndex_[featureKey] = feature;\n    }\n    return valid;\n  }\n\n\n  /**\n   * Add a batch of features to the source.\n   * @param {Array<import(\"../Feature.js\").default<Geometry>>} features Features to add.\n   * @api\n   */\n  addFeatures(features) {\n    this.addFeaturesInternal(features);\n    this.changed();\n  }\n\n\n  /**\n   * Add features without firing a `change` event.\n   * @param {Array<import(\"../Feature.js\").default<Geometry>>} features Features.\n   * @protected\n   */\n  addFeaturesInternal(features) {\n    const extents = [];\n    const newFeatures = [];\n    const geometryFeatures = [];\n\n    for (let i = 0, length = features.length; i < length; i++) {\n      const feature = features[i];\n      const featureKey = getUid(feature);\n      if (this.addToIndex_(featureKey, feature)) {\n        newFeatures.push(feature);\n      }\n    }\n\n    for (let i = 0, length = newFeatures.length; i < length; i++) {\n      const feature = newFeatures[i];\n      const featureKey = getUid(feature);\n      this.setupChangeEvents_(featureKey, feature);\n\n      const geometry = feature.getGeometry();\n      if (geometry) {\n        const extent = geometry.getExtent();\n        extents.push(extent);\n        geometryFeatures.push(feature);\n      } else {\n        this.nullGeometryFeatures_[featureKey] = feature;\n      }\n    }\n    if (this.featuresRtree_) {\n      this.featuresRtree_.load(extents, geometryFeatures);\n    }\n\n    for (let i = 0, length = newFeatures.length; i < length; i++) {\n      this.dispatchEvent(new VectorSourceEvent(VectorEventType.ADDFEATURE, newFeatures[i]));\n    }\n  }\n\n\n  /**\n   * @param {!Collection<import(\"../Feature.js\").default<Geometry>>} collection Collection.\n   * @private\n   */\n  bindFeaturesCollection_(collection) {\n    let modifyingCollection = false;\n    this.addEventListener(VectorEventType.ADDFEATURE,\n      /**\n       * @param {VectorSourceEvent<Geometry>} evt The vector source event\n       */\n      function(evt) {\n        if (!modifyingCollection) {\n          modifyingCollection = true;\n          collection.push(evt.feature);\n          modifyingCollection = false;\n        }\n      });\n    this.addEventListener(VectorEventType.REMOVEFEATURE,\n      /**\n       * @param {VectorSourceEvent<Geometry>} evt The vector source event\n       */\n      function(evt) {\n        if (!modifyingCollection) {\n          modifyingCollection = true;\n          collection.remove(evt.feature);\n          modifyingCollection = false;\n        }\n      });\n    collection.addEventListener(CollectionEventType.ADD,\n      /**\n       * @param {import(\"../Collection.js\").CollectionEvent} evt The collection event\n       */\n      function(evt) {\n        if (!modifyingCollection) {\n          modifyingCollection = true;\n          this.addFeature(/** @type {import(\"../Feature.js\").default<Geometry>} */ (evt.element));\n          modifyingCollection = false;\n        }\n      }.bind(this));\n    collection.addEventListener(CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"../Collection.js\").CollectionEvent} evt The collection event\n       */\n      function(evt) {\n        if (!modifyingCollection) {\n          modifyingCollection = true;\n          this.removeFeature(/** @type {import(\"../Feature.js\").default<Geometry>} */ (evt.element));\n          modifyingCollection = false;\n        }\n      }.bind(this));\n    this.featuresCollection_ = collection;\n  }\n\n\n  /**\n   * Remove all features from the source.\n   * @param {boolean=} opt_fast Skip dispatching of {@link module:ol/source/Vector.VectorSourceEvent#removefeature} events.\n   * @api\n   */\n  clear(opt_fast) {\n    if (opt_fast) {\n      for (const featureId in this.featureChangeKeys_) {\n        const keys = this.featureChangeKeys_[featureId];\n        keys.forEach(unlistenByKey);\n      }\n      if (!this.featuresCollection_) {\n        this.featureChangeKeys_ = {};\n        this.idIndex_ = {};\n        this.uidIndex_ = {};\n      }\n    } else {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this));\n        for (const id in this.nullGeometryFeatures_) {\n          this.removeFeatureInternal(this.nullGeometryFeatures_[id]);\n        }\n      }\n    }\n    if (this.featuresCollection_) {\n      this.featuresCollection_.clear();\n    }\n\n    if (this.featuresRtree_) {\n      this.featuresRtree_.clear();\n    }\n    this.nullGeometryFeatures_ = {};\n\n    const clearEvent = new VectorSourceEvent(VectorEventType.CLEAR);\n    this.dispatchEvent(clearEvent);\n    this.changed();\n  }\n\n\n  /**\n   * Iterate through all features on the source, calling the provided callback\n   * with each one.  If the callback returns any \"truthy\" value, iteration will\n   * stop and the function will return the same value.\n   * Note: this function only iterate through the feature that have a defined geometry.\n   *\n   * @param {function(import(\"../Feature.js\").default<Geometry>): T} callback Called with each feature\n   *     on the source.  Return a truthy value to stop iteration.\n   * @return {T|undefined} The return value from the last call to the callback.\n   * @template T\n   * @api\n   */\n  forEachFeature(callback) {\n    if (this.featuresRtree_) {\n      return this.featuresRtree_.forEach(callback);\n    } else if (this.featuresCollection_) {\n      this.featuresCollection_.forEach(callback);\n    }\n  }\n\n\n  /**\n   * Iterate through all features whose geometries contain the provided\n   * coordinate, calling the callback with each feature.  If the callback returns\n   * a \"truthy\" value, iteration will stop and the function will return the same\n   * value.\n   *\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {function(import(\"../Feature.js\").default<Geometry>): T} callback Called with each feature\n   *     whose goemetry contains the provided coordinate.\n   * @return {T|undefined} The return value from the last call to the callback.\n   * @template T\n   */\n  forEachFeatureAtCoordinateDirect(coordinate, callback) {\n    const extent = [coordinate[0], coordinate[1], coordinate[0], coordinate[1]];\n    return this.forEachFeatureInExtent(extent, function(feature) {\n      const geometry = feature.getGeometry();\n      if (geometry.intersectsCoordinate(coordinate)) {\n        return callback(feature);\n      } else {\n        return undefined;\n      }\n    });\n  }\n\n\n  /**\n   * Iterate through all features whose bounding box intersects the provided\n   * extent (note that the feature's geometry may not intersect the extent),\n   * calling the callback with each feature.  If the callback returns a \"truthy\"\n   * value, iteration will stop and the function will return the same value.\n   *\n   * If you are interested in features whose geometry intersects an extent, call\n   * the {@link module:ol/source/Vector~VectorSource#forEachFeatureIntersectingExtent #forEachFeatureIntersectingExtent()} method instead.\n   *\n   * When `useSpatialIndex` is set to false, this method will loop through all\n   * features, equivalent to {@link module:ol/source/Vector~VectorSource#forEachFeature #forEachFeature()}.\n   *\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {function(import(\"../Feature.js\").default<Geometry>): T} callback Called with each feature\n   *     whose bounding box intersects the provided extent.\n   * @return {T|undefined} The return value from the last call to the callback.\n   * @template T\n   * @api\n   */\n  forEachFeatureInExtent(extent, callback) {\n    if (this.featuresRtree_) {\n      return this.featuresRtree_.forEachInExtent(extent, callback);\n    } else if (this.featuresCollection_) {\n      this.featuresCollection_.forEach(callback);\n    }\n  }\n\n\n  /**\n   * Iterate through all features whose geometry intersects the provided extent,\n   * calling the callback with each feature.  If the callback returns a \"truthy\"\n   * value, iteration will stop and the function will return the same value.\n   *\n   * If you only want to test for bounding box intersection, call the\n   * {@link module:ol/source/Vector~VectorSource#forEachFeatureInExtent #forEachFeatureInExtent()} method instead.\n   *\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {function(import(\"../Feature.js\").default<Geometry>): T} callback Called with each feature\n   *     whose geometry intersects the provided extent.\n   * @return {T|undefined} The return value from the last call to the callback.\n   * @template T\n   * @api\n   */\n  forEachFeatureIntersectingExtent(extent, callback) {\n    return this.forEachFeatureInExtent(extent,\n      /**\n       * @param {import(\"../Feature.js\").default<Geometry>} feature Feature.\n       * @return {T|undefined} The return value from the last call to the callback.\n       */\n      function(feature) {\n        const geometry = feature.getGeometry();\n        if (geometry.intersectsExtent(extent)) {\n          const result = callback(feature);\n          if (result) {\n            return result;\n          }\n        }\n      });\n  }\n\n\n  /**\n   * Get the features collection associated with this source. Will be `null`\n   * unless the source was configured with `useSpatialIndex` set to `false`, or\n   * with an {@link module:ol/Collection} as `features`.\n   * @return {Collection<import(\"../Feature.js\").default<Geometry>>} The collection of features.\n   * @api\n   */\n  getFeaturesCollection() {\n    return this.featuresCollection_;\n  }\n\n\n  /**\n   * Get all features on the source in random order.\n   * @return {Array<import(\"../Feature.js\").default<Geometry>>} Features.\n   * @api\n   */\n  getFeatures() {\n    let features;\n    if (this.featuresCollection_) {\n      features = this.featuresCollection_.getArray();\n    } else if (this.featuresRtree_) {\n      features = this.featuresRtree_.getAll();\n      if (!isEmpty(this.nullGeometryFeatures_)) {\n        extend(features, getValues(this.nullGeometryFeatures_));\n      }\n    }\n    return (\n      /** @type {Array<import(\"../Feature.js\").default<Geometry>>} */ (features)\n    );\n  }\n\n\n  /**\n   * Get all features whose geometry intersects the provided coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @return {Array<import(\"../Feature.js\").default<Geometry>>} Features.\n   * @api\n   */\n  getFeaturesAtCoordinate(coordinate) {\n    const features = [];\n    this.forEachFeatureAtCoordinateDirect(coordinate, function(feature) {\n      features.push(feature);\n    });\n    return features;\n  }\n\n\n  /**\n   * Get all features whose bounding box intersects the provided extent.  Note that this returns an array of\n   * all features intersecting the given extent in random order (so it may include\n   * features whose geometries do not intersect the extent).\n   *\n   * This method is not available when the source is configured with\n   * `useSpatialIndex` set to `false`.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @return {Array<import(\"../Feature.js\").default<Geometry>>} Features.\n   * @api\n   */\n  getFeaturesInExtent(extent) {\n    return this.featuresRtree_.getInExtent(extent);\n  }\n\n\n  /**\n   * Get the closest feature to the provided coordinate.\n   *\n   * This method is not available when the source is configured with\n   * `useSpatialIndex` set to `false`.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {function(import(\"../Feature.js\").default<Geometry>):boolean=} opt_filter Feature filter function.\n   *     The filter function will receive one argument, the {@link module:ol/Feature feature}\n   *     and it should return a boolean value. By default, no filtering is made.\n   * @return {import(\"../Feature.js\").default<Geometry>} Closest feature.\n   * @api\n   */\n  getClosestFeatureToCoordinate(coordinate, opt_filter) {\n    // Find the closest feature using branch and bound.  We start searching an\n    // infinite extent, and find the distance from the first feature found.  This\n    // becomes the closest feature.  We then compute a smaller extent which any\n    // closer feature must intersect.  We continue searching with this smaller\n    // extent, trying to find a closer feature.  Every time we find a closer\n    // feature, we update the extent being searched so that any even closer\n    // feature must intersect it.  We continue until we run out of features.\n    const x = coordinate[0];\n    const y = coordinate[1];\n    let closestFeature = null;\n    const closestPoint = [NaN, NaN];\n    let minSquaredDistance = Infinity;\n    const extent = [-Infinity, -Infinity, Infinity, Infinity];\n    const filter = opt_filter ? opt_filter : TRUE;\n    this.featuresRtree_.forEachInExtent(extent,\n      /**\n       * @param {import(\"../Feature.js\").default<Geometry>} feature Feature.\n       */\n      function(feature) {\n        if (filter(feature)) {\n          const geometry = feature.getGeometry();\n          const previousMinSquaredDistance = minSquaredDistance;\n          minSquaredDistance = geometry.closestPointXY(\n            x, y, closestPoint, minSquaredDistance);\n          if (minSquaredDistance < previousMinSquaredDistance) {\n            closestFeature = feature;\n            // This is sneaky.  Reduce the extent that it is currently being\n            // searched while the R-Tree traversal using this same extent object\n            // is still in progress.  This is safe because the new extent is\n            // strictly contained by the old extent.\n            const minDistance = Math.sqrt(minSquaredDistance);\n            extent[0] = x - minDistance;\n            extent[1] = y - minDistance;\n            extent[2] = x + minDistance;\n            extent[3] = y + minDistance;\n          }\n        }\n      });\n    return closestFeature;\n  }\n\n\n  /**\n   * Get the extent of the features currently in the source.\n   *\n   * This method is not available when the source is configured with\n   * `useSpatialIndex` set to `false`.\n   * @param {import(\"../extent.js\").Extent=} opt_extent Destination extent. If provided, no new extent\n   *     will be created. Instead, that extent's coordinates will be overwritten.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getExtent(opt_extent) {\n    return this.featuresRtree_.getExtent(opt_extent);\n  }\n\n\n  /**\n   * Get a feature by its identifier (the value returned by feature.getId()).\n   * Note that the index treats string and numeric identifiers as the same.  So\n   * `source.getFeatureById(2)` will return a feature with id `'2'` or `2`.\n   *\n   * @param {string|number} id Feature identifier.\n   * @return {import(\"../Feature.js\").default<Geometry>} The feature (or `null` if not found).\n   * @api\n   */\n  getFeatureById(id) {\n    const feature = this.idIndex_[id.toString()];\n    return feature !== undefined ? feature : null;\n  }\n\n\n  /**\n   * Get a feature by its internal unique identifier (using `getUid`).\n   *\n   * @param {string} uid Feature identifier.\n   * @return {import(\"../Feature.js\").default<Geometry>} The feature (or `null` if not found).\n   */\n  getFeatureByUid(uid) {\n    const feature = this.uidIndex_[uid];\n    return feature !== undefined ? feature : null;\n  }\n\n\n  /**\n   * Get the format associated with this source.\n   *\n   * @return {import(\"../format/Feature.js\").default|undefined} The feature format.\n   * @api\n   */\n  getFormat() {\n    return this.format_;\n  }\n\n\n  /**\n   * @return {boolean} The source can have overlapping geometries.\n   */\n  getOverlaps() {\n    return this.overlaps_;\n  }\n\n\n  /**\n   * Get the url associated with this source.\n   *\n   * @return {string|import(\"../featureloader.js\").FeatureUrlFunction|undefined} The url.\n   * @api\n   */\n  getUrl() {\n    return this.url_;\n  }\n\n\n  /**\n   * @param {Event} event Event.\n   * @private\n   */\n  handleFeatureChange_(event) {\n    const feature = /** @type {import(\"../Feature.js\").default<Geometry>} */ (event.target);\n    const featureKey = getUid(feature);\n    const geometry = feature.getGeometry();\n    if (!geometry) {\n      if (!(featureKey in this.nullGeometryFeatures_)) {\n        if (this.featuresRtree_) {\n          this.featuresRtree_.remove(feature);\n        }\n        this.nullGeometryFeatures_[featureKey] = feature;\n      }\n    } else {\n      const extent = geometry.getExtent();\n      if (featureKey in this.nullGeometryFeatures_) {\n        delete this.nullGeometryFeatures_[featureKey];\n        if (this.featuresRtree_) {\n          this.featuresRtree_.insert(extent, feature);\n        }\n      } else {\n        if (this.featuresRtree_) {\n          this.featuresRtree_.update(extent, feature);\n        }\n      }\n    }\n    const id = feature.getId();\n    if (id !== undefined) {\n      const sid = id.toString();\n      if (this.idIndex_[sid] !== feature) {\n        this.removeFromIdIndex_(feature);\n        this.idIndex_[sid] = feature;\n      }\n    } else {\n      this.removeFromIdIndex_(feature);\n      this.uidIndex_[featureKey] = feature;\n    }\n    this.changed();\n    this.dispatchEvent(new VectorSourceEvent(\n      VectorEventType.CHANGEFEATURE, feature));\n  }\n\n  /**\n   * Returns true if the feature is contained within the source.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature Feature.\n   * @return {boolean} Has feature.\n   * @api\n   */\n  hasFeature(feature) {\n    const id = feature.getId();\n    if (id !== undefined) {\n      return id in this.idIndex_;\n    } else {\n      return getUid(feature) in this.uidIndex_;\n    }\n  }\n\n  /**\n   * @return {boolean} Is empty.\n   */\n  isEmpty() {\n    return this.featuresRtree_.isEmpty() && isEmpty(this.nullGeometryFeatures_);\n  }\n\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   */\n  loadFeatures(extent, resolution, projection) {\n    const loadedExtentsRtree = this.loadedExtentsRtree_;\n    const extentsToLoad = this.strategy_(extent, resolution);\n    this.loading = false;\n    for (let i = 0, ii = extentsToLoad.length; i < ii; ++i) {\n      const extentToLoad = extentsToLoad[i];\n      const alreadyLoaded = loadedExtentsRtree.forEachInExtent(extentToLoad,\n        /**\n         * @param {{extent: import(\"../extent.js\").Extent}} object Object.\n         * @return {boolean} Contains.\n         */\n        function(object) {\n          return containsExtent(object.extent, extentToLoad);\n        });\n      if (!alreadyLoaded) {\n        this.loader_.call(this, extentToLoad, resolution, projection);\n        loadedExtentsRtree.insert(extentToLoad, {extent: extentToLoad.slice()});\n        this.loading = this.loader_ !== VOID;\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  refresh() {\n    this.clear(true);\n    this.loadedExtentsRtree_.clear();\n    super.refresh();\n  }\n\n\n  /**\n   * Remove an extent from the list of loaded extents.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @api\n   */\n  removeLoadedExtent(extent) {\n    const loadedExtentsRtree = this.loadedExtentsRtree_;\n    let obj;\n    loadedExtentsRtree.forEachInExtent(extent, function(object) {\n      if (equals(object.extent, extent)) {\n        obj = object;\n        return true;\n      }\n    });\n    if (obj) {\n      loadedExtentsRtree.remove(obj);\n    }\n  }\n\n\n  /**\n   * Remove a single feature from the source.  If you want to remove all features\n   * at once, use the {@link module:ol/source/Vector~VectorSource#clear #clear()} method\n   * instead.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature Feature to remove.\n   * @api\n   */\n  removeFeature(feature) {\n    const featureKey = getUid(feature);\n    if (featureKey in this.nullGeometryFeatures_) {\n      delete this.nullGeometryFeatures_[featureKey];\n    } else {\n      if (this.featuresRtree_) {\n        this.featuresRtree_.remove(feature);\n      }\n    }\n    this.removeFeatureInternal(feature);\n    this.changed();\n  }\n\n\n  /**\n   * Remove feature without firing a `change` event.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature Feature.\n   * @protected\n   */\n  removeFeatureInternal(feature) {\n    const featureKey = getUid(feature);\n    this.featureChangeKeys_[featureKey].forEach(unlistenByKey);\n    delete this.featureChangeKeys_[featureKey];\n    const id = feature.getId();\n    if (id !== undefined) {\n      delete this.idIndex_[id.toString()];\n    }\n    delete this.uidIndex_[featureKey];\n    this.dispatchEvent(new VectorSourceEvent(\n      VectorEventType.REMOVEFEATURE, feature));\n  }\n\n\n  /**\n   * Remove a feature from the id index.  Called internally when the feature id\n   * may have changed.\n   * @param {import(\"../Feature.js\").default<Geometry>} feature The feature.\n   * @return {boolean} Removed the feature from the index.\n   * @private\n   */\n  removeFromIdIndex_(feature) {\n    let removed = false;\n    for (const id in this.idIndex_) {\n      if (this.idIndex_[id] === feature) {\n        delete this.idIndex_[id];\n        removed = true;\n        break;\n      }\n    }\n    return removed;\n  }\n\n\n  /**\n   * Set the new loader of the source. The next render cycle will use the\n   * new loader.\n   * @param {import(\"../featureloader.js\").FeatureLoader} loader The loader to set.\n   * @api\n   */\n  setLoader(loader) {\n    this.loader_ = loader;\n  }\n\n  /**\n   * Points the source to a new url. The next render cycle will use the new url.\n   * @param {string|import(\"../featureloader.js\").FeatureUrlFunction} url Url.\n   * @api\n   */\n  setUrl(url) {\n    assert(this.format_, 7); // `format` must be set when `url` is set\n    this.setLoader(xhr(url, this.format_));\n  }\n\n}\n\n\nexport default VectorSource;\n","/**\n * @module ol/style/Style\n */\n\nimport {assert} from '../asserts.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport CircleStyle from './Circle.js';\nimport Fill from './Fill.js';\nimport Stroke from './Stroke.js';\n\n\n/**\n * A function that takes an {@link module:ol/Feature} and a `{number}`\n * representing the view's resolution. The function should return a\n * {@link module:ol/style/Style} or an array of them. This way e.g. a\n * vector layer can be styled.\n *\n * @typedef {function(import(\"../Feature.js\").FeatureLike, number):(Style|Array<Style>)} StyleFunction\n */\n\n/**\n * A {@link Style}, an array of {@link Style}, or a {@link StyleFunction}.\n * @typedef {Style|Array<Style>|StyleFunction} StyleLike\n */\n\n/**\n * A function that takes an {@link module:ol/Feature} as argument and returns an\n * {@link module:ol/geom/Geometry} that will be rendered and styled for the feature.\n *\n * @typedef {function(import(\"../Feature.js\").FeatureLike):\n *     (import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default|undefined)} GeometryFunction\n */\n\n\n/**\n * Custom renderer function. Takes two arguments:\n *\n * 1. The pixel coordinates of the geometry in GeoJSON notation.\n * 2. The {@link module:ol/render~State} of the layer renderer.\n *\n * @typedef {function((import(\"../coordinate.js\").Coordinate|Array<import(\"../coordinate.js\").Coordinate>|Array<Array<import(\"../coordinate.js\").Coordinate>>),import(\"../render.js\").State): void}\n * RenderFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string|import(\"../geom/Geometry.js\").default|GeometryFunction} [geometry] Feature property or geometry\n * or function returning a geometry to render for this style.\n * @property {import(\"./Fill.js\").default} [fill] Fill style.\n * @property {import(\"./Image.js\").default} [image] Image style.\n * @property {RenderFunction} [renderer] Custom renderer. When configured, `fill`, `stroke` and `image` will be\n * ignored, and the provided function will be called with each render frame for each geometry.\n * @property {import(\"./Stroke.js\").default} [stroke] Stroke style.\n * @property {import(\"./Text.js\").default} [text] Text style.\n * @property {number} [zIndex] Z index.\n */\n\n/**\n * @classdesc\n * Container for vector feature rendering styles. Any changes made to the style\n * or its children through `set*()` methods will not take effect until the\n * feature or layer that uses the style is re-rendered.\n *\n * ## Feature styles\n *\n * If no style is defined, the following default style is used:\n * ```js\n *  import {Fill, Stroke, Circle, Style} from 'ol/style';\n *\n *  var fill = new Fill({\n *    color: 'rgba(255,255,255,0.4)'\n *  });\n *  var stroke = new Stroke({\n *    color: '#3399CC',\n *    width: 1.25\n *  });\n *  var styles = [\n *    new Style({\n *      image: new Circle({\n *        fill: fill,\n *        stroke: stroke,\n *        radius: 5\n *      }),\n *      fill: fill,\n *      stroke: stroke\n *    })\n *  ];\n * ```\n *\n * A separate editing style has the following defaults:\n * ```js\n *  import {Fill, Stroke, Circle, Style} from 'ol/style';\n *  import GeometryType from 'ol/geom/GeometryType';\n *\n *  var white = [255, 255, 255, 1];\n *  var blue = [0, 153, 255, 1];\n *  var width = 3;\n *  styles[GeometryType.POLYGON] = [\n *    new Style({\n *      fill: new Fill({\n *        color: [255, 255, 255, 0.5]\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POLYGON] =\n *      styles[GeometryType.POLYGON];\n *  styles[GeometryType.LINE_STRING] = [\n *    new Style({\n *      stroke: new Stroke({\n *        color: white,\n *        width: width + 2\n *      })\n *    }),\n *    new Style({\n *      stroke: new Stroke({\n *        color: blue,\n *        width: width\n *      })\n *    })\n *  ];\n *  styles[GeometryType.MULTI_LINE_STRING] =\n *      styles[GeometryType.LINE_STRING];\n *  styles[GeometryType.POINT] = [\n *    new Style({\n *      image: new Circle({\n *        radius: width * 2,\n *        fill: new Fill({\n *          color: blue\n *        }),\n *        stroke: new Stroke({\n *          color: white,\n *          width: width / 2\n *        })\n *      }),\n *      zIndex: Infinity\n *    })\n *  ];\n *  styles[GeometryType.MULTI_POINT] =\n *      styles[GeometryType.POINT];\n *  styles[GeometryType.GEOMETRY_COLLECTION] =\n *      styles[GeometryType.POLYGON].concat(\n *          styles[GeometryType.LINE_STRING],\n *          styles[GeometryType.POINT]\n *      );\n * ```\n *\n * @api\n */\nclass Style {\n  /**\n   * @param {Options=} opt_options Style options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    /**\n     * @private\n     * @type {string|import(\"../geom/Geometry.js\").default|GeometryFunction}\n     */\n    this.geometry_ = null;\n\n    /**\n     * @private\n     * @type {!GeometryFunction}\n     */\n    this.geometryFunction_ = defaultGeometryFunction;\n\n    if (options.geometry !== undefined) {\n      this.setGeometry(options.geometry);\n    }\n\n    /**\n     * @private\n     * @type {import(\"./Fill.js\").default}\n     */\n    this.fill_ = options.fill !== undefined ? options.fill : null;\n\n    /**\n       * @private\n       * @type {import(\"./Image.js\").default}\n       */\n    this.image_ = options.image !== undefined ? options.image : null;\n\n    /**\n     * @private\n     * @type {RenderFunction|null}\n     */\n    this.renderer_ = options.renderer !== undefined ? options.renderer : null;\n\n    /**\n     * @private\n     * @type {import(\"./Stroke.js\").default}\n     */\n    this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n    /**\n     * @private\n     * @type {import(\"./Text.js\").default}\n     */\n    this.text_ = options.text !== undefined ? options.text : null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.zIndex_ = options.zIndex;\n\n  }\n\n  /**\n   * Clones the style.\n   * @return {Style} The cloned style.\n   * @api\n   */\n  clone() {\n    let geometry = this.getGeometry();\n    if (geometry && typeof geometry === 'object') {\n      geometry = /** @type {import(\"../geom/Geometry.js\").default} */ (geometry).clone();\n    }\n    return new Style({\n      geometry: geometry,\n      fill: this.getFill() ? this.getFill().clone() : undefined,\n      image: this.getImage() ? this.getImage().clone() : undefined,\n      stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n      text: this.getText() ? this.getText().clone() : undefined,\n      zIndex: this.getZIndex()\n    });\n  }\n\n  /**\n   * Get the custom renderer function that was configured with\n   * {@link #setRenderer} or the `renderer` constructor option.\n   * @return {RenderFunction|null} Custom renderer function.\n   * @api\n   */\n  getRenderer() {\n    return this.renderer_;\n  }\n\n  /**\n   * Sets a custom renderer function for this style. When set, `fill`, `stroke`\n   * and `image` options of the style will be ignored.\n   * @param {RenderFunction|null} renderer Custom renderer function.\n   * @api\n   */\n  setRenderer(renderer) {\n    this.renderer_ = renderer;\n  }\n\n  /**\n   * Get the geometry to be rendered.\n   * @return {string|import(\"../geom/Geometry.js\").default|GeometryFunction}\n   * Feature property or geometry or function that returns the geometry that will\n   * be rendered with this style.\n   * @api\n   */\n  getGeometry() {\n    return this.geometry_;\n  }\n\n  /**\n   * Get the function used to generate a geometry for rendering.\n   * @return {!GeometryFunction} Function that is called with a feature\n   * and returns the geometry to render instead of the feature's geometry.\n   * @api\n   */\n  getGeometryFunction() {\n    return this.geometryFunction_;\n  }\n\n  /**\n   * Get the fill style.\n   * @return {import(\"./Fill.js\").default} Fill style.\n   * @api\n   */\n  getFill() {\n    return this.fill_;\n  }\n\n  /**\n   * Set the fill style.\n   * @param {import(\"./Fill.js\").default} fill Fill style.\n   * @api\n   */\n  setFill(fill) {\n    this.fill_ = fill;\n  }\n\n  /**\n   * Get the image style.\n   * @return {import(\"./Image.js\").default} Image style.\n   * @api\n   */\n  getImage() {\n    return this.image_;\n  }\n\n  /**\n   * Set the image style.\n   * @param {import(\"./Image.js\").default} image Image style.\n   * @api\n   */\n  setImage(image) {\n    this.image_ = image;\n  }\n\n  /**\n   * Get the stroke style.\n   * @return {import(\"./Stroke.js\").default} Stroke style.\n   * @api\n   */\n  getStroke() {\n    return this.stroke_;\n  }\n\n  /**\n   * Set the stroke style.\n   * @param {import(\"./Stroke.js\").default} stroke Stroke style.\n   * @api\n   */\n  setStroke(stroke) {\n    this.stroke_ = stroke;\n  }\n\n  /**\n   * Get the text style.\n   * @return {import(\"./Text.js\").default} Text style.\n   * @api\n   */\n  getText() {\n    return this.text_;\n  }\n\n  /**\n   * Set the text style.\n   * @param {import(\"./Text.js\").default} text Text style.\n   * @api\n   */\n  setText(text) {\n    this.text_ = text;\n  }\n\n  /**\n   * Get the z-index for the style.\n   * @return {number|undefined} ZIndex.\n   * @api\n   */\n  getZIndex() {\n    return this.zIndex_;\n  }\n\n  /**\n   * Set a geometry that is rendered instead of the feature's geometry.\n   *\n   * @param {string|import(\"../geom/Geometry.js\").default|GeometryFunction} geometry\n   *     Feature property or geometry or function returning a geometry to render\n   *     for this style.\n   * @api\n   */\n  setGeometry(geometry) {\n    if (typeof geometry === 'function') {\n      this.geometryFunction_ = geometry;\n    } else if (typeof geometry === 'string') {\n      this.geometryFunction_ = function(feature) {\n        return (\n          /** @type {import(\"../geom/Geometry.js\").default} */ (feature.get(geometry))\n        );\n      };\n    } else if (!geometry) {\n      this.geometryFunction_ = defaultGeometryFunction;\n    } else if (geometry !== undefined) {\n      this.geometryFunction_ = function() {\n        return (\n          /** @type {import(\"../geom/Geometry.js\").default} */ (geometry)\n        );\n      };\n    }\n    this.geometry_ = geometry;\n  }\n\n  /**\n   * Set the z-index.\n   *\n   * @param {number|undefined} zIndex ZIndex.\n   * @api\n   */\n  setZIndex(zIndex) {\n    this.zIndex_ = zIndex;\n  }\n}\n\n\n/**\n * Convert the provided object into a style function.  Functions passed through\n * unchanged.  Arrays of Style or single style objects wrapped in a\n * new style function.\n * @param {StyleFunction|Array<Style>|Style} obj\n *     A style function, a single style, or an array of styles.\n * @return {StyleFunction} A style function.\n */\nexport function toFunction(obj) {\n  let styleFunction;\n\n  if (typeof obj === 'function') {\n    styleFunction = obj;\n  } else {\n    /**\n     * @type {Array<Style>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(typeof /** @type {?} */ (obj).getZIndex === 'function',\n        41); // Expected an `Style` or an array of `Style`\n      const style = /** @type {Style} */ (obj);\n      styles = [style];\n    }\n    styleFunction = function() {\n      return styles;\n    };\n  }\n  return styleFunction;\n}\n\n\n/**\n * @type {Array<Style>}\n */\nlet defaultStyles = null;\n\n\n/**\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {number} resolution Resolution.\n * @return {Array<Style>} Style.\n */\nexport function createDefaultStyle(feature, resolution) {\n  // We don't use an immediately-invoked function\n  // and a closure so we don't get an error at script evaluation time in\n  // browsers that do not support Canvas. (import(\"./Circle.js\").CircleStyle does\n  // canvas.getContext('2d') at construction time, which will cause an.error\n  // in such browsers.)\n  if (!defaultStyles) {\n    const fill = new Fill({\n      color: 'rgba(255,255,255,0.4)'\n    });\n    const stroke = new Stroke({\n      color: '#3399CC',\n      width: 1.25\n    });\n    defaultStyles = [\n      new Style({\n        image: new CircleStyle({\n          fill: fill,\n          stroke: stroke,\n          radius: 5\n        }),\n        fill: fill,\n        stroke: stroke\n      })\n    ];\n  }\n  return defaultStyles;\n}\n\n\n/**\n * Default styles for editing features.\n * @return {Object<import(\"../geom/GeometryType.js\").default, Array<Style>>} Styles\n */\nexport function createEditingStyle() {\n  /** @type {Object<import(\"../geom/GeometryType.js\").default, Array<Style>>} */\n  const styles = {};\n  const white = [255, 255, 255, 1];\n  const blue = [0, 153, 255, 1];\n  const width = 3;\n  styles[GeometryType.POLYGON] = [\n    new Style({\n      fill: new Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_POLYGON] =\n      styles[GeometryType.POLYGON];\n\n  styles[GeometryType.LINE_STRING] = [\n    new Style({\n      stroke: new Stroke({\n        color: white,\n        width: width + 2\n      })\n    }),\n    new Style({\n      stroke: new Stroke({\n        color: blue,\n        width: width\n      })\n    })\n  ];\n  styles[GeometryType.MULTI_LINE_STRING] =\n      styles[GeometryType.LINE_STRING];\n\n  styles[GeometryType.CIRCLE] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING]\n      );\n\n\n  styles[GeometryType.POINT] = [\n    new Style({\n      image: new CircleStyle({\n        radius: width * 2,\n        fill: new Fill({\n          color: blue\n        }),\n        stroke: new Stroke({\n          color: white,\n          width: width / 2\n        })\n      }),\n      zIndex: Infinity\n    })\n  ];\n  styles[GeometryType.MULTI_POINT] =\n      styles[GeometryType.POINT];\n\n  styles[GeometryType.GEOMETRY_COLLECTION] =\n      styles[GeometryType.POLYGON].concat(\n        styles[GeometryType.LINE_STRING],\n        styles[GeometryType.POINT]\n      );\n\n  return styles;\n}\n\n\n/**\n * Function that is called with a feature and returns its default geometry.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature to get the geometry for.\n * @return {import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default|undefined} Geometry to render.\n */\nfunction defaultGeometryFunction(feature) {\n  return feature.getGeometry();\n}\n\nexport default Style;\n","/**\n * @module ol/obj\n */\n\n\n/**\n * Polyfill for Object.assign().  Assigns enumerable and own properties from\n * one or more source objects to a target object.\n * See https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Object/assign.\n *\n * @param {!Object} target The target object.\n * @param {...Object} var_sources The source object(s).\n * @return {!Object} The modified target object.\n */\nexport const assign = (typeof Object.assign === 'function') ? Object.assign : function(target, var_sources) {\n  if (target === undefined || target === null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1, ii = arguments.length; i < ii; ++i) {\n    const source = arguments[i];\n    if (source !== undefined && source !== null) {\n      for (const key in source) {\n        if (source.hasOwnProperty(key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n};\n\n\n/**\n * Removes all properties from an object.\n * @param {Object} object The object to clear.\n */\nexport function clear(object) {\n  for (const property in object) {\n    delete object[property];\n  }\n}\n\n\n/**\n * Polyfill for Object.values().  Get an array of property values from an object.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/values\n *\n * @param {!Object<K,V>} object The object from which to get the values.\n * @return {!Array<V>} The property values.\n * @template K,V\n */\nexport const getValues = (typeof Object.values === 'function') ? Object.values : function(object) {\n  const values = [];\n  for (const property in object) {\n    values.push(object[property]);\n  }\n  return values;\n};\n\n\n/**\n * Determine if an object has any properties.\n * @param {Object} object The object to check.\n * @return {boolean} The object is empty.\n */\nexport function isEmpty(object) {\n  let property;\n  for (property in object) {\n    return false;\n  }\n  return !property;\n}\n","/**\n * @module ol/events/EventType\n */\n\n/**\n * @enum {string}\n * @const\n */\nexport default {\n  /**\n   * Generic change event. Triggered when the revision counter is increased.\n   * @event module:ol/events/Event~BaseEvent#change\n   * @api\n   */\n  CHANGE: 'change',\n\n  /**\n   * Generic error event. Triggered when an error occurs.\n   * @event module:ol/events/Event~BaseEvent#error\n   * @api\n   */\n  ERROR: 'error',\n\n  CLEAR: 'clear',\n  CONTEXTMENU: 'contextmenu',\n  CLICK: 'click',\n  DBLCLICK: 'dblclick',\n  DRAGENTER: 'dragenter',\n  DRAGOVER: 'dragover',\n  DROP: 'drop',\n  KEYDOWN: 'keydown',\n  KEYPRESS: 'keypress',\n  LOAD: 'load',\n  RESIZE: 'resize',\n  WHEEL: 'wheel'\n};\n","/**\n * @module ol/array\n */\n\n\n/**\n * Performs a binary search on the provided sorted list and returns the index of the item if found. If it can't be found it'll return -1.\n * https://github.com/darkskyapp/binary-search\n *\n * @param {Array<*>} haystack Items to search through.\n * @param {*} needle The item to look for.\n * @param {Function=} opt_comparator Comparator function.\n * @return {number} The index of the item if found, -1 if not.\n */\nexport function binarySearch(haystack, needle, opt_comparator) {\n  let mid, cmp;\n  const comparator = opt_comparator || numberSafeCompareFunction;\n  let low = 0;\n  let high = haystack.length;\n  let found = false;\n\n  while (low < high) {\n    /* Note that \"(low + high) >>> 1\" may overflow, and results in a typecast\n     * to double (which gives the wrong results). */\n    mid = low + (high - low >> 1);\n    cmp = +comparator(haystack[mid], needle);\n\n    if (cmp < 0.0) { /* Too low. */\n      low = mid + 1;\n\n    } else { /* Key found or too high */\n      high = mid;\n      found = !cmp;\n    }\n  }\n\n  /* Key not found. */\n  return found ? low : ~low;\n}\n\n\n/**\n * Compare function for array sort that is safe for numbers.\n * @param {*} a The first object to be compared.\n * @param {*} b The second object to be compared.\n * @return {number} A negative number, zero, or a positive number as the first\n *     argument is less than, equal to, or greater than the second.\n */\nexport function numberSafeCompareFunction(a, b) {\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\n\n/**\n * Whether the array contains the given object.\n * @param {Array<*>} arr The array to test for the presence of the element.\n * @param {*} obj The object for which to test.\n * @return {boolean} The object is in the array.\n */\nexport function includes(arr, obj) {\n  return arr.indexOf(obj) >= 0;\n}\n\n\n/**\n * @param {Array<number>} arr Array.\n * @param {number} target Target.\n * @param {number} direction 0 means return the nearest, > 0\n *    means return the largest nearest, < 0 means return the\n *    smallest nearest.\n * @return {number} Index.\n */\nexport function linearFindNearest(arr, target, direction) {\n  const n = arr.length;\n  if (arr[0] <= target) {\n    return 0;\n  } else if (target <= arr[n - 1]) {\n    return n - 1;\n  } else {\n    let i;\n    if (direction > 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] < target) {\n          return i - 1;\n        }\n      }\n    } else if (direction < 0) {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] <= target) {\n          return i;\n        }\n      }\n    } else {\n      for (i = 1; i < n; ++i) {\n        if (arr[i] == target) {\n          return i;\n        } else if (arr[i] < target) {\n          if (arr[i - 1] - target < target - arr[i]) {\n            return i - 1;\n          } else {\n            return i;\n          }\n        }\n      }\n    }\n    return n - 1;\n  }\n}\n\n\n/**\n * @param {Array<*>} arr Array.\n * @param {number} begin Begin index.\n * @param {number} end End index.\n */\nexport function reverseSubArray(arr, begin, end) {\n  while (begin < end) {\n    const tmp = arr[begin];\n    arr[begin] = arr[end];\n    arr[end] = tmp;\n    ++begin;\n    --end;\n  }\n}\n\n\n/**\n * @param {Array<VALUE>} arr The array to modify.\n * @param {!Array<VALUE>|VALUE} data The elements or arrays of elements to add to arr.\n * @template VALUE\n */\nexport function extend(arr, data) {\n  const extension = Array.isArray(data) ? data : [data];\n  const length = extension.length;\n  for (let i = 0; i < length; i++) {\n    arr[arr.length] = extension[i];\n  }\n}\n\n\n/**\n * @param {Array<VALUE>} arr The array to modify.\n * @param {VALUE} obj The element to remove.\n * @template VALUE\n * @return {boolean} If the element was removed.\n */\nexport function remove(arr, obj) {\n  const i = arr.indexOf(obj);\n  const found = i > -1;\n  if (found) {\n    arr.splice(i, 1);\n  }\n  return found;\n}\n\n\n/**\n * @param {Array<VALUE>} arr The array to search in.\n * @param {function(VALUE, number, ?) : boolean} func The function to compare.\n * @template VALUE\n * @return {VALUE|null} The element found or null.\n */\nexport function find(arr, func) {\n  const length = arr.length >>> 0;\n  let value;\n\n  for (let i = 0; i < length; i++) {\n    value = arr[i];\n    if (func(value, i, arr)) {\n      return value;\n    }\n  }\n  return null;\n}\n\n\n/**\n * @param {Array|Uint8ClampedArray} arr1 The first array to compare.\n * @param {Array|Uint8ClampedArray} arr2 The second array to compare.\n * @return {boolean} Whether the two arrays are equal.\n */\nexport function equals(arr1, arr2) {\n  const len1 = arr1.length;\n  if (len1 !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < len1; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * Sort the passed array such that the relative order of equal elements is preverved.\n * See https://en.wikipedia.org/wiki/Sorting_algorithm#Stability for details.\n * @param {Array<*>} arr The array to sort (modifies original).\n * @param {!function(*, *): number} compareFnc Comparison function.\n * @api\n */\nexport function stableSort(arr, compareFnc) {\n  const length = arr.length;\n  const tmp = Array(arr.length);\n  let i;\n  for (i = 0; i < length; i++) {\n    tmp[i] = {index: i, value: arr[i]};\n  }\n  tmp.sort(function(a, b) {\n    return compareFnc(a.value, b.value) || a.index - b.index;\n  });\n  for (i = 0; i < arr.length; i++) {\n    arr[i] = tmp[i].value;\n  }\n}\n\n\n/**\n * @param {Array<*>} arr The array to search in.\n * @param {Function} func Comparison function.\n * @return {number} Return index.\n */\nexport function findIndex(arr, func) {\n  let index;\n  const found = !arr.every(function(el, idx) {\n    index = idx;\n    return !func(el, idx, arr);\n  });\n  return found ? index : -1;\n}\n\n\n/**\n * @param {Array<*>} arr The array to test.\n * @param {Function=} opt_func Comparison function.\n * @param {boolean=} opt_strict Strictly sorted (default false).\n * @return {boolean} Return index.\n */\nexport function isSorted(arr, opt_func, opt_strict) {\n  const compare = opt_func || numberSafeCompareFunction;\n  return arr.every(function(currentVal, index) {\n    if (index === 0) {\n      return true;\n    }\n    const res = compare(arr[index - 1], currentVal);\n    return !(res > 0 || opt_strict && res === 0);\n  });\n}\n","/**\n * @module ol/math\n */\n\n/**\n * Takes a number and clamps it to within the provided bounds.\n * @param {number} value The input number.\n * @param {number} min The minimum value to return.\n * @param {number} max The maximum value to return.\n * @return {number} The input number if it is within bounds, or the nearest\n *     number within the bounds.\n */\nexport function clamp(value, min, max) {\n  return Math.min(Math.max(value, min), max);\n}\n\n\n/**\n * Return the hyperbolic cosine of a given number. The method will use the\n * native `Math.cosh` function if it is available, otherwise the hyperbolic\n * cosine will be calculated via the reference implementation of the Mozilla\n * developer network.\n *\n * @param {number} x X.\n * @return {number} Hyperbolic cosine of x.\n */\nexport const cosh = (function() {\n  // Wrapped in a iife, to save the overhead of checking for the native\n  // implementation on every invocation.\n  let cosh;\n  if ('cosh' in Math) {\n    // The environment supports the native Math.cosh function, use it…\n    cosh = Math.cosh;\n  } else {\n    // … else, use the reference implementation of MDN:\n    cosh = function(x) {\n      const y = /** @type {Math} */ (Math).exp(x);\n      return (y + 1 / y) / 2;\n    };\n  }\n  return cosh;\n}());\n\n\n/**\n * Returns the square of the closest distance between the point (x, y) and the\n * line segment (x1, y1) to (x2, y2).\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredSegmentDistance(x, y, x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  if (dx !== 0 || dy !== 0) {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      x1 = x2;\n      y1 = y2;\n    } else if (t > 0) {\n      x1 += dx * t;\n      y1 += dy * t;\n    }\n  }\n  return squaredDistance(x, y, x1, y1);\n}\n\n\n/**\n * Returns the square of the distance between the points (x1, y1) and (x2, y2).\n * @param {number} x1 X1.\n * @param {number} y1 Y1.\n * @param {number} x2 X2.\n * @param {number} y2 Y2.\n * @return {number} Squared distance.\n */\nexport function squaredDistance(x1, y1, x2, y2) {\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * Solves system of linear equations using Gaussian elimination method.\n *\n * @param {Array<Array<number>>} mat Augmented matrix (n x n + 1 column)\n *                                     in row-major order.\n * @return {Array<number>} The resulting vector.\n */\nexport function solveLinearSystem(mat) {\n  const n = mat.length;\n\n  for (let i = 0; i < n; i++) {\n    // Find max in the i-th column (ignoring i - 1 first rows)\n    let maxRow = i;\n    let maxEl = Math.abs(mat[i][i]);\n    for (let r = i + 1; r < n; r++) {\n      const absValue = Math.abs(mat[r][i]);\n      if (absValue > maxEl) {\n        maxEl = absValue;\n        maxRow = r;\n      }\n    }\n\n    if (maxEl === 0) {\n      return null; // matrix is singular\n    }\n\n    // Swap max row with i-th (current) row\n    const tmp = mat[maxRow];\n    mat[maxRow] = mat[i];\n    mat[i] = tmp;\n\n    // Subtract the i-th row to make all the remaining rows 0 in the i-th column\n    for (let j = i + 1; j < n; j++) {\n      const coef = -mat[j][i] / mat[i][i];\n      for (let k = i; k < n + 1; k++) {\n        if (i == k) {\n          mat[j][k] = 0;\n        } else {\n          mat[j][k] += coef * mat[i][k];\n        }\n      }\n    }\n  }\n\n  // Solve Ax=b for upper triangular matrix A (mat)\n  const x = new Array(n);\n  for (let l = n - 1; l >= 0; l--) {\n    x[l] = mat[l][n] / mat[l][l];\n    for (let m = l - 1; m >= 0; m--) {\n      mat[m][n] -= mat[m][l] * x[l];\n    }\n  }\n  return x;\n}\n\n\n/**\n * Converts radians to to degrees.\n *\n * @param {number} angleInRadians Angle in radians.\n * @return {number} Angle in degrees.\n */\nexport function toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\n\n/**\n * Converts degrees to radians.\n *\n * @param {number} angleInDegrees Angle in degrees.\n * @return {number} Angle in radians.\n */\nexport function toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n\n/**\n * Returns the modulo of a / b, depending on the sign of b.\n *\n * @param {number} a Dividend.\n * @param {number} b Divisor.\n * @return {number} Modulo.\n */\nexport function modulo(a, b) {\n  const r = a % b;\n  return r * b < 0 ? r + b : r;\n}\n\n/**\n * Calculates the linearly interpolated value of x between a and b.\n *\n * @param {number} a Number\n * @param {number} b Number\n * @param {number} x Value to be interpolated.\n * @return {number} Interpolated value.\n */\nexport function lerp(a, b, x) {\n  return a + x * (b - a);\n}\n","/**\n * @module ol/TileState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  /**\n   * Indicates that tile loading failed\n   * @type {number}\n   */\n  ERROR: 3,\n  EMPTY: 4,\n  ABORT: 5\n};\n","/**\n * @module ol/events\n */\nimport {clear} from './obj.js';\n\n\n/**\n * Key to use with {@link module:ol/Observable~Observable#unByKey}.\n * @typedef {Object} EventsKey\n * @property {ListenerFunction} listener\n * @property {import(\"./events/Target.js\").EventTargetLike} target\n * @property {string} type\n * @api\n */\n\n\n/**\n * Listener function. This function is called with an event object as argument.\n * When the function returns `false`, event propagation will stop.\n *\n * @typedef {function((Event|import(\"./events/Event.js\").default)): (void|boolean)} ListenerFunction\n * @api\n */\n\n\n/**\n * Registers an event listener on an event target. Inspired by\n * https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html\n *\n * This function efficiently binds a `listener` to a `this` object, and returns\n * a key for use with {@link module:ol/events~unlistenByKey}.\n *\n * @param {import(\"./events/Target.js\").EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @param {boolean=} opt_once If true, add the listener as one-off listener.\n * @return {EventsKey} Unique key for the listener.\n */\nexport function listen(target, type, listener, opt_this, opt_once) {\n  if (opt_this && opt_this !== target) {\n    listener = listener.bind(opt_this);\n  }\n  if (opt_once) {\n    const originalListener = listener;\n    listener = function() {\n      target.removeEventListener(type, listener);\n      originalListener.apply(this, arguments);\n    };\n  }\n  const eventsKey = {\n    target: target,\n    type: type,\n    listener: listener\n  };\n  target.addEventListener(type, listener);\n  return eventsKey;\n}\n\n\n/**\n * Registers a one-off event listener on an event target. Inspired by\n * https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html\n *\n * This function efficiently binds a `listener` as self-unregistering listener\n * to a `this` object, and returns a key for use with\n * {@link module:ol/events~unlistenByKey} in case the listener needs to be\n * unregistered before it is called.\n *\n * When {@link module:ol/events~listen} is called with the same arguments after this\n * function, the self-unregistering listener will be turned into a permanent\n * listener.\n *\n * @param {import(\"./events/Target.js\").EventTargetLike} target Event target.\n * @param {string} type Event type.\n * @param {ListenerFunction} listener Listener.\n * @param {Object=} opt_this Object referenced by the `this` keyword in the\n *     listener. Default is the `target`.\n * @return {EventsKey} Key for unlistenByKey.\n */\nexport function listenOnce(target, type, listener, opt_this) {\n  return listen(target, type, listener, opt_this, true);\n}\n\n\n/**\n * Unregisters event listeners on an event target. Inspired by\n * https://google.github.io/closure-library/api/source/closure/goog/events/events.js.src.html\n *\n * The argument passed to this function is the key returned from\n * {@link module:ol/events~listen} or {@link module:ol/events~listenOnce}.\n *\n * @param {EventsKey} key The key.\n */\nexport function unlistenByKey(key) {\n  if (key && key.target) {\n    key.target.removeEventListener(key.type, key.listener);\n    clear(key);\n  }\n}\n","/**\n * @module ol/transform\n */\nimport {assert} from './asserts.js';\n\n\n/**\n * An array representing an affine 2d transformation for use with\n * {@link module:ol/transform} functions. The array has 6 elements.\n * @typedef {!Array<number>} Transform\n */\n\n\n/**\n * Collection of affine 2d transformation functions. The functions work on an\n * array of 6 elements. The element order is compatible with the [SVGMatrix\n * interface](https://developer.mozilla.org/en-US/docs/Web/API/SVGMatrix) and is\n * a subset (elements a to f) of a 3×3 matrix:\n * ```\n * [ a c e ]\n * [ b d f ]\n * [ 0 0 1 ]\n * ```\n */\n\n\n/**\n * @private\n * @type {Transform}\n */\nconst tmp_ = new Array(6);\n\n\n/**\n * Create an identity transform.\n * @return {!Transform} Identity transform.\n */\nexport function create() {\n  return [1, 0, 0, 1, 0, 0];\n}\n\n\n/**\n * Resets the given transform to an identity transform.\n * @param {!Transform} transform Transform.\n * @return {!Transform} Transform.\n */\nexport function reset(transform) {\n  return set(transform, 1, 0, 0, 1, 0, 0);\n}\n\n\n/**\n * Multiply the underlying matrices of two transforms and return the result in\n * the first transform.\n * @param {!Transform} transform1 Transform parameters of matrix 1.\n * @param {!Transform} transform2 Transform parameters of matrix 2.\n * @return {!Transform} transform1 multiplied with transform2.\n */\nexport function multiply(transform1, transform2) {\n  const a1 = transform1[0];\n  const b1 = transform1[1];\n  const c1 = transform1[2];\n  const d1 = transform1[3];\n  const e1 = transform1[4];\n  const f1 = transform1[5];\n  const a2 = transform2[0];\n  const b2 = transform2[1];\n  const c2 = transform2[2];\n  const d2 = transform2[3];\n  const e2 = transform2[4];\n  const f2 = transform2[5];\n\n  transform1[0] = a1 * a2 + c1 * b2;\n  transform1[1] = b1 * a2 + d1 * b2;\n  transform1[2] = a1 * c2 + c1 * d2;\n  transform1[3] = b1 * c2 + d1 * d2;\n  transform1[4] = a1 * e2 + c1 * f2 + e1;\n  transform1[5] = b1 * e2 + d1 * f2 + f1;\n\n  return transform1;\n}\n\n/**\n * Set the transform components a-f on a given transform.\n * @param {!Transform} transform Transform.\n * @param {number} a The a component of the transform.\n * @param {number} b The b component of the transform.\n * @param {number} c The c component of the transform.\n * @param {number} d The d component of the transform.\n * @param {number} e The e component of the transform.\n * @param {number} f The f component of the transform.\n * @return {!Transform} Matrix with transform applied.\n */\nexport function set(transform, a, b, c, d, e, f) {\n  transform[0] = a;\n  transform[1] = b;\n  transform[2] = c;\n  transform[3] = d;\n  transform[4] = e;\n  transform[5] = f;\n  return transform;\n}\n\n\n/**\n * Set transform on one matrix from another matrix.\n * @param {!Transform} transform1 Matrix to set transform to.\n * @param {!Transform} transform2 Matrix to set transform from.\n * @return {!Transform} transform1 with transform from transform2 applied.\n */\nexport function setFromArray(transform1, transform2) {\n  transform1[0] = transform2[0];\n  transform1[1] = transform2[1];\n  transform1[2] = transform2[2];\n  transform1[3] = transform2[3];\n  transform1[4] = transform2[4];\n  transform1[5] = transform2[5];\n  return transform1;\n}\n\n\n/**\n * Transforms the given coordinate with the given transform returning the\n * resulting, transformed coordinate. The coordinate will be modified in-place.\n *\n * @param {Transform} transform The transformation.\n * @param {import(\"./coordinate.js\").Coordinate|import(\"./pixel.js\").Pixel} coordinate The coordinate to transform.\n * @return {import(\"./coordinate.js\").Coordinate|import(\"./pixel.js\").Pixel} return coordinate so that operations can be\n *     chained together.\n */\nexport function apply(transform, coordinate) {\n  const x = coordinate[0];\n  const y = coordinate[1];\n  coordinate[0] = transform[0] * x + transform[2] * y + transform[4];\n  coordinate[1] = transform[1] * x + transform[3] * y + transform[5];\n  return coordinate;\n}\n\n\n/**\n * Applies rotation to the given transform.\n * @param {!Transform} transform Transform.\n * @param {number} angle Angle in radians.\n * @return {!Transform} The rotated transform.\n */\nexport function rotate(transform, angle) {\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  return multiply(transform, set(tmp_, cos, sin, -sin, cos, 0, 0));\n}\n\n\n/**\n * Applies scale to a given transform.\n * @param {!Transform} transform Transform.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!Transform} The scaled transform.\n */\nexport function scale(transform, x, y) {\n  return multiply(transform, set(tmp_, x, 0, 0, y, 0, 0));\n}\n\n/**\n * Creates a scale transform.\n * @param {!Transform} target Transform to overwrite.\n * @param {number} x Scale factor x.\n * @param {number} y Scale factor y.\n * @return {!Transform} The scale transform.\n */\nexport function makeScale(target, x, y) {\n  return set(target, x, 0, 0, y, 0, 0);\n}\n\n/**\n * Applies translation to the given transform.\n * @param {!Transform} transform Transform.\n * @param {number} dx Translation x.\n * @param {number} dy Translation y.\n * @return {!Transform} The translated transform.\n */\nexport function translate(transform, dx, dy) {\n  return multiply(transform, set(tmp_, 1, 0, 0, 1, dx, dy));\n}\n\n\n/**\n * Creates a composite transform given an initial translation, scale, rotation, and\n * final translation (in that order only, not commutative).\n * @param {!Transform} transform The transform (will be modified in place).\n * @param {number} dx1 Initial translation x.\n * @param {number} dy1 Initial translation y.\n * @param {number} sx Scale factor x.\n * @param {number} sy Scale factor y.\n * @param {number} angle Rotation (in counter-clockwise radians).\n * @param {number} dx2 Final translation x.\n * @param {number} dy2 Final translation y.\n * @return {!Transform} The composite transform.\n */\nexport function compose(transform, dx1, dy1, sx, sy, angle, dx2, dy2) {\n  const sin = Math.sin(angle);\n  const cos = Math.cos(angle);\n  transform[0] = sx * cos;\n  transform[1] = sy * sin;\n  transform[2] = -sx * sin;\n  transform[3] = sy * cos;\n  transform[4] = dx2 * sx * cos - dy2 * sx * sin + dx1;\n  transform[5] = dx2 * sy * sin + dy2 * sy * cos + dy1;\n  return transform;\n}\n\n\n/**\n * Invert the given transform.\n * @param {!Transform} source The source transform to invert.\n * @return {!Transform} The inverted (source) transform.\n */\nexport function invert(source) {\n  return makeInverse(source, source);\n}\n\n/**\n * Invert the given transform.\n * @param {!Transform} target Transform to be set as the inverse of\n *     the source transform.\n * @param {!Transform} source The source transform to invert.\n * @return {!Transform} The inverted (target) transform.\n */\nexport function makeInverse(target, source) {\n  const det = determinant(source);\n  assert(det !== 0, 32); // Transformation matrix cannot be inverted\n\n  const a = source[0];\n  const b = source[1];\n  const c = source[2];\n  const d = source[3];\n  const e = source[4];\n  const f = source[5];\n\n  target[0] = d / det;\n  target[1] = -b / det;\n  target[2] = -c / det;\n  target[3] = a / det;\n  target[4] = (c * f - d * e) / det;\n  target[5] = -(a * f - b * e) / det;\n\n  return target;\n}\n\n/**\n * Returns the determinant of the given matrix.\n * @param {!Transform} mat Matrix.\n * @return {number} Determinant.\n */\nexport function determinant(mat) {\n  return mat[0] * mat[3] - mat[1] * mat[2];\n}\n\n/**\n * A string version of the transform.  This can be used\n * for CSS transforms.\n * @param {!Transform} mat Matrix.\n * @return {string} The transform as a string.\n */\nexport function toString(mat) {\n  return 'matrix(' + mat.join(', ') + ')';\n}\n","/**\n * @module ol/style/Stroke\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike} [color] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n * @property {CanvasLineCap} [lineCap='round'] Line cap style: `butt`, `round`, or `square`.\n * @property {CanvasLineJoin} [lineJoin='round'] Line join style: `bevel`, `round`, or `miter`.\n * @property {Array<number>} [lineDash] Line dash pattern. Default is `undefined` (no dash).\n * Please note that Internet Explorer 10 and lower do not support the `setLineDash` method on\n * the `CanvasRenderingContext2D` and therefore this option will have no visual effect in these browsers.\n * @property {number} [lineDashOffset=0] Line dash offset.\n * @property {number} [miterLimit=10] Miter limit.\n * @property {number} [width] Width.\n */\n\n\n/**\n * @classdesc\n * Set stroke style for vector features.\n * Note that the defaults given are the Canvas defaults, which will be used if\n * option is not defined. The `get` functions return whatever was entered in\n * the options; they will not return the default.\n * @api\n */\nclass Stroke {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    /**\n     * @private\n     * @type {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike}\n     */\n    this.color_ = options.color !== undefined ? options.color : null;\n\n    /**\n     * @private\n     * @type {CanvasLineCap|undefined}\n     */\n    this.lineCap_ = options.lineCap;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.lineDash_ = options.lineDash !== undefined ? options.lineDash : null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lineDashOffset_ = options.lineDashOffset;\n\n    /**\n     * @private\n     * @type {CanvasLineJoin|undefined}\n     */\n    this.lineJoin_ = options.lineJoin;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.miterLimit_ = options.miterLimit;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.width_ = options.width;\n  }\n\n  /**\n   * Clones the style.\n   * @return {Stroke} The cloned style.\n   * @api\n   */\n  clone() {\n    const color = this.getColor();\n    return new Stroke({\n      color: Array.isArray(color) ? color.slice() : color || undefined,\n      lineCap: this.getLineCap(),\n      lineDash: this.getLineDash() ? this.getLineDash().slice() : undefined,\n      lineDashOffset: this.getLineDashOffset(),\n      lineJoin: this.getLineJoin(),\n      miterLimit: this.getMiterLimit(),\n      width: this.getWidth()\n    });\n  }\n\n  /**\n   * Get the stroke color.\n   * @return {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike} Color.\n   * @api\n   */\n  getColor() {\n    return this.color_;\n  }\n\n  /**\n   * Get the line cap type for the stroke.\n   * @return {CanvasLineCap|undefined} Line cap.\n   * @api\n   */\n  getLineCap() {\n    return this.lineCap_;\n  }\n\n  /**\n   * Get the line dash style for the stroke.\n   * @return {Array<number>} Line dash.\n   * @api\n   */\n  getLineDash() {\n    return this.lineDash_;\n  }\n\n  /**\n   * Get the line dash offset for the stroke.\n   * @return {number|undefined} Line dash offset.\n   * @api\n   */\n  getLineDashOffset() {\n    return this.lineDashOffset_;\n  }\n\n  /**\n   * Get the line join type for the stroke.\n   * @return {CanvasLineJoin|undefined} Line join.\n   * @api\n   */\n  getLineJoin() {\n    return this.lineJoin_;\n  }\n\n  /**\n   * Get the miter limit for the stroke.\n   * @return {number|undefined} Miter limit.\n   * @api\n   */\n  getMiterLimit() {\n    return this.miterLimit_;\n  }\n\n  /**\n   * Get the stroke width.\n   * @return {number|undefined} Width.\n   * @api\n   */\n  getWidth() {\n    return this.width_;\n  }\n\n  /**\n   * Set the color.\n   *\n   * @param {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike} color Color.\n   * @api\n   */\n  setColor(color) {\n    this.color_ = color;\n  }\n\n  /**\n   * Set the line cap.\n   *\n   * @param {CanvasLineCap|undefined} lineCap Line cap.\n   * @api\n   */\n  setLineCap(lineCap) {\n    this.lineCap_ = lineCap;\n  }\n\n  /**\n   * Set the line dash.\n   *\n   * Please note that Internet Explorer 10 and lower [do not support][mdn] the\n   * `setLineDash` method on the `CanvasRenderingContext2D` and therefore this\n   * property will have no visual effect in these browsers.\n   *\n   * [mdn]: https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Browser_compatibility\n   *\n   * @param {Array<number>} lineDash Line dash.\n   * @api\n   */\n  setLineDash(lineDash) {\n    this.lineDash_ = lineDash;\n  }\n\n  /**\n   * Set the line dash offset.\n   *\n   * @param {number|undefined} lineDashOffset Line dash offset.\n   * @api\n   */\n  setLineDashOffset(lineDashOffset) {\n    this.lineDashOffset_ = lineDashOffset;\n  }\n\n  /**\n   * Set the line join.\n   *\n   * @param {CanvasLineJoin|undefined} lineJoin Line join.\n   * @api\n   */\n  setLineJoin(lineJoin) {\n    this.lineJoin_ = lineJoin;\n  }\n\n  /**\n   * Set the miter limit.\n   *\n   * @param {number|undefined} miterLimit Miter limit.\n   * @api\n   */\n  setMiterLimit(miterLimit) {\n    this.miterLimit_ = miterLimit;\n  }\n\n  /**\n   * Set the width.\n   *\n   * @param {number|undefined} width Width.\n   * @api\n   */\n  setWidth(width) {\n    this.width_ = width;\n  }\n\n}\n\nexport default Stroke;\n","/**\n * @module ol/asserts\n */\nimport AssertionError from './AssertionError.js';\n\n/**\n * @param {*} assertion Assertion we expected to be truthy.\n * @param {number} errorCode Error code.\n */\nexport function assert(assertion, errorCode) {\n  if (!assertion) {\n    throw new AssertionError(errorCode);\n  }\n}\n","/**\n * @module ol/geom/GeometryLayout\n */\n\n/**\n * The coordinate layout for geometries, indicating whether a 3rd or 4th z ('Z')\n * or measure ('M') coordinate is available. Supported values are `'XY'`,\n * `'XYZ'`, `'XYM'`, `'XYZM'`.\n * @enum {string}\n */\nexport default {\n  XY: 'XY',\n  XYZ: 'XYZ',\n  XYM: 'XYM',\n  XYZM: 'XYZM'\n};\n","/**\n * @module ol/layer/Vector\n */\nimport BaseVectorLayer from './BaseVector.js';\nimport CanvasVectorLayerRenderer from '../renderer/canvas/VectorLayer.js';\n\n\n/**\n * @classdesc\n * Vector data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @extends {BaseVectorLayer<import(\"../source/Vector.js\").default>}\n * @api\n */\nclass VectorLayer extends BaseVectorLayer {\n  /**\n   * @param {import(\"./BaseVector.js\").Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super(opt_options);\n  }\n\n  /**\n   * Create a renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n   * @protected\n   */\n  createRenderer() {\n    return new CanvasVectorLayerRenderer(this);\n  }\n}\n\n\nexport default VectorLayer;\n","/**\n * @module ol/style/Fill\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike} [color=null] A color, gradient or pattern.\n * See {@link module:ol/color~Color} and {@link module:ol/colorlike~ColorLike} for possible formats.\n * Default null; if null, the Canvas/renderer default black will be used.\n */\n\n\n/**\n * @classdesc\n * Set fill style for vector features.\n * @api\n */\nclass Fill {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    /**\n     * @private\n     * @type {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike}\n     */\n    this.color_ = options.color !== undefined ? options.color : null;\n  }\n\n  /**\n   * Clones the style. The color is not cloned if it is an {@link module:ol/colorlike~ColorLike}.\n   * @return {Fill} The cloned style.\n   * @api\n   */\n  clone() {\n    const color = this.getColor();\n    return new Fill({\n      color: Array.isArray(color) ? color.slice() : color || undefined\n    });\n  }\n\n  /**\n   * Get the fill color.\n   * @return {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike} Color.\n   * @api\n   */\n  getColor() {\n    return this.color_;\n  }\n\n  /**\n   * Set the color.\n   *\n   * @param {import(\"../color.js\").Color|import(\"../colorlike.js\").ColorLike} color Color.\n   * @api\n   */\n  setColor(color) {\n    this.color_ = color;\n  }\n\n}\n\nexport default Fill;\n","/**\n * @module ol/Feature\n */\nimport {assert} from './asserts.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\n\n/**\n * @typedef {typeof Feature|typeof import(\"./render/Feature.js\").default} FeatureClass\n */\n\n/**\n * @typedef {Feature|import(\"./render/Feature.js\").default} FeatureLike\n */\n\n/**\n * @classdesc\n * A vector object for geographic features with a geometry and other\n * attribute properties, similar to the features in vector file formats like\n * GeoJSON.\n *\n * Features can be styled individually with `setStyle`; otherwise they use the\n * style of their vector layer.\n *\n * Note that attribute properties are set as {@link module:ol/Object} properties on\n * the feature object, so they are observable, and have get/set accessors.\n *\n * Typically, a feature has a single geometry property. You can set the\n * geometry using the `setGeometry` method and get it with `getGeometry`.\n * It is possible to store more than one geometry on a feature using attribute\n * properties. By default, the geometry used for rendering is identified by\n * the property name `geometry`. If you want to use another geometry property\n * for rendering, use the `setGeometryName` method to change the attribute\n * property associated with the geometry for the feature.  For example:\n *\n * ```js\n *\n * import Feature from 'ol/Feature';\n * import Polygon from 'ol/geom/Polygon';\n * import Point from 'ol/geom/Point';\n *\n * var feature = new Feature({\n *   geometry: new Polygon(polyCoords),\n *   labelPoint: new Point(labelCoords),\n *   name: 'My Polygon'\n * });\n *\n * // get the polygon geometry\n * var poly = feature.getGeometry();\n *\n * // Render the feature as a point using the coordinates from labelPoint\n * feature.setGeometryName('labelPoint');\n *\n * // get the point geometry\n * var point = feature.getGeometry();\n * ```\n *\n * @api\n * @template {import(\"./geom/Geometry.js\").default} Geometry\n */\nclass Feature extends BaseObject {\n  /**\n   * @param {Geometry|Object<string, *>=} opt_geometryOrProperties\n   *     You may pass a Geometry object directly, or an object literal containing\n   *     properties. If you pass an object literal, you may include a Geometry\n   *     associated with a `geometry` key.\n   */\n  constructor(opt_geometryOrProperties) {\n\n    super();\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = undefined;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.geometryName_ = 'geometry';\n\n    /**\n     * User provided style.\n     * @private\n     * @type {import(\"./style/Style.js\").StyleLike}\n     */\n    this.style_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./style/Style.js\").StyleFunction|undefined}\n     */\n    this.styleFunction_ = undefined;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.geometryChangeKey_ = null;\n\n    this.addEventListener(getChangeEventType(this.geometryName_), this.handleGeometryChanged_);\n\n    if (opt_geometryOrProperties) {\n      if (typeof /** @type {?} */ (opt_geometryOrProperties).getSimplifiedGeometry === 'function') {\n        const geometry = /** @type {Geometry} */ (opt_geometryOrProperties);\n        this.setGeometry(geometry);\n      } else {\n        /** @type {Object<string, *>} */\n        const properties = opt_geometryOrProperties;\n        this.setProperties(properties);\n      }\n    }\n  }\n\n  /**\n   * Clone this feature. If the original feature has a geometry it\n   * is also cloned. The feature id is not set in the clone.\n   * @return {Feature} The clone.\n   * @api\n   */\n  clone() {\n    const clone = new Feature(this.getProperties());\n    clone.setGeometryName(this.getGeometryName());\n    const geometry = this.getGeometry();\n    if (geometry) {\n      clone.setGeometry(geometry.clone());\n    }\n    const style = this.getStyle();\n    if (style) {\n      clone.setStyle(style);\n    }\n    return clone;\n  }\n\n  /**\n   * Get the feature's default geometry.  A feature may have any number of named\n   * geometries.  The \"default\" geometry (the one that is rendered by default) is\n   * set when calling {@link module:ol/Feature~Feature#setGeometry}.\n   * @return {Geometry|undefined} The default geometry for the feature.\n   * @api\n   * @observable\n   */\n  getGeometry() {\n    return (\n      /** @type {Geometry|undefined} */ (this.get(this.geometryName_))\n    );\n  }\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is either set when reading data from a remote source or set explicitly by\n   * calling {@link module:ol/Feature~Feature#setId}.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id_;\n  }\n\n  /**\n   * Get the name of the feature's default geometry.  By default, the default\n   * geometry is named `geometry`.\n   * @return {string} Get the property name associated with the default geometry\n   *     for this feature.\n   * @api\n   */\n  getGeometryName() {\n    return this.geometryName_;\n  }\n\n  /**\n   * Get the feature's style. Will return what was provided to the\n   * {@link module:ol/Feature~Feature#setStyle} method.\n   * @return {import(\"./style/Style.js\").StyleLike} The feature style.\n   * @api\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n  /**\n   * Get the feature's style function.\n   * @return {import(\"./style/Style.js\").StyleFunction|undefined} Return a function\n   * representing the current style of this feature.\n   * @api\n   */\n  getStyleFunction() {\n    return this.styleFunction_;\n  }\n\n  /**\n   * @private\n   */\n  handleGeometryChange_() {\n    this.changed();\n  }\n\n  /**\n   * @private\n   */\n  handleGeometryChanged_() {\n    if (this.geometryChangeKey_) {\n      unlistenByKey(this.geometryChangeKey_);\n      this.geometryChangeKey_ = null;\n    }\n    const geometry = this.getGeometry();\n    if (geometry) {\n      this.geometryChangeKey_ = listen(geometry,\n        EventType.CHANGE, this.handleGeometryChange_, this);\n    }\n    this.changed();\n  }\n\n  /**\n   * Set the default geometry for the feature.  This will update the property\n   * with the name returned by {@link module:ol/Feature~Feature#getGeometryName}.\n   * @param {Geometry|undefined} geometry The new geometry.\n   * @api\n   * @observable\n   */\n  setGeometry(geometry) {\n    this.set(this.geometryName_, geometry);\n  }\n\n  /**\n   * Set the style for the feature.  This can be a single style object, an array\n   * of styles, or a function that takes a resolution and returns an array of\n   * styles. If it is `null` the feature has no style (a `null` style).\n   * @param {import(\"./style/Style.js\").StyleLike} style Style for this feature.\n   * @api\n   * @fires module:ol/events/Event~BaseEvent#event:change\n   */\n  setStyle(style) {\n    this.style_ = style;\n    this.styleFunction_ = !style ? undefined : createStyleFunction(style);\n    this.changed();\n  }\n\n  /**\n   * Set the feature id.  The feature id is considered stable and may be used when\n   * requesting features or comparing identifiers returned from a remote source.\n   * The feature id can be used with the\n   * {@link module:ol/source/Vector~VectorSource#getFeatureById} method.\n   * @param {number|string|undefined} id The feature id.\n   * @api\n   * @fires module:ol/events/Event~BaseEvent#event:change\n   */\n  setId(id) {\n    this.id_ = id;\n    this.changed();\n  }\n\n  /**\n   * Set the property name to be used when getting the feature's default geometry.\n   * When calling {@link module:ol/Feature~Feature#getGeometry}, the value of the property with\n   * this name will be returned.\n   * @param {string} name The property name of the default geometry.\n   * @api\n   */\n  setGeometryName(name) {\n    this.removeEventListener(getChangeEventType(this.geometryName_), this.handleGeometryChanged_);\n    this.geometryName_ = name;\n    this.addEventListener(getChangeEventType(this.geometryName_), this.handleGeometryChanged_);\n    this.handleGeometryChanged_();\n  }\n}\n\n\n/**\n * Convert the provided object into a feature style function.  Functions passed\n * through unchanged.  Arrays of Style or single style objects wrapped\n * in a new feature style function.\n * @param {!import(\"./style/Style.js\").StyleFunction|!Array<import(\"./style/Style.js\").default>|!import(\"./style/Style.js\").default} obj\n *     A feature style function, a single style, or an array of styles.\n * @return {import(\"./style/Style.js\").StyleFunction} A style function.\n */\nexport function createStyleFunction(obj) {\n  if (typeof obj === 'function') {\n    return obj;\n  } else {\n    /**\n     * @type {Array<import(\"./style/Style.js\").default>}\n     */\n    let styles;\n    if (Array.isArray(obj)) {\n      styles = obj;\n    } else {\n      assert(typeof /** @type {?} */ (obj).getZIndex === 'function',\n        41); // Expected an `import(\"./style/Style.js\").Style` or an array of `import(\"./style/Style.js\").Style`\n      const style = /** @type {import(\"./style/Style.js\").default} */ (obj);\n      styles = [style];\n    }\n    return function() {\n      return styles;\n    };\n  }\n}\nexport default Feature;\n","import {getUid} from '../../util.js';\nimport LRUCache from '../../structs/LRUCache.js';\n\n/**\n * @module ol/render/canvas/LabelCache\n */\n\n/**\n * @classdesc\n * Cache of pre-rendered labels.\n */\nclass LabelCache extends LRUCache {\n\n  /**\n   * @inheritDoc\n   */\n  constructor(opt_highWaterMark) {\n    super(opt_highWaterMark);\n    this.consumers = {};\n  }\n\n  clear() {\n    this.consumers = {};\n    super.clear();\n  }\n\n  /**\n   * @override\n   * @param {string} key Label key.\n   * @param {import(\"./Executor.js\").default} consumer Label consumer.\n   * @return {HTMLCanvasElement} Label.\n   */\n  get(key, consumer) {\n    const canvas = super.get(key);\n    const consumerId = getUid(consumer);\n    if (!(consumerId in this.consumers)) {\n      this.consumers[consumerId] = {};\n    }\n    this.consumers[consumerId][key] = true;\n    return canvas;\n  }\n\n  prune() {\n    outer:\n    while (this.canExpireCache()) {\n      const key = this.peekLastKey();\n      for (const consumerId in this.consumers) {\n        if (key in this.consumers[consumerId]) {\n          break outer;\n        }\n      }\n      const canvas = this.pop();\n      canvas.width = canvas.height = 0;\n      for (const consumerId in this.consumers) {\n        delete this.consumers[consumerId][key];\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"./Executor.js\").default} consumer Label consumer.\n   */\n  release(consumer) {\n    delete this.consumers[getUid(consumer)];\n  }\n}\n\nexport default LabelCache;\n","/**\n * @module ol/render/canvas\n */\nimport {getFontParameters} from '../css.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {clear} from '../obj.js';\nimport {create as createTransform} from '../transform.js';\nimport LabelCache from './canvas/LabelCache.js';\n\n\n/**\n * @typedef {Object} FillState\n * @property {import(\"../colorlike.js\").ColorLike} fillStyle\n */\n\n\n/**\n * @typedef {Object} FillStrokeState\n * @property {import(\"../colorlike.js\").ColorLike} [currentFillStyle]\n * @property {import(\"../colorlike.js\").ColorLike} [currentStrokeStyle]\n * @property {CanvasLineCap} [currentLineCap]\n * @property {Array<number>} currentLineDash\n * @property {number} [currentLineDashOffset]\n * @property {CanvasLineJoin} [currentLineJoin]\n * @property {number} [currentLineWidth]\n * @property {number} [currentMiterLimit]\n * @property {number} [lastStroke]\n * @property {import(\"../colorlike.js\").ColorLike} [fillStyle]\n * @property {import(\"../colorlike.js\").ColorLike} [strokeStyle]\n * @property {CanvasLineCap} [lineCap]\n * @property {Array<number>} lineDash\n * @property {number} [lineDashOffset]\n * @property {CanvasLineJoin} [lineJoin]\n * @property {number} [lineWidth]\n * @property {number} [miterLimit]\n */\n\n\n/**\n * @typedef {Object} StrokeState\n * @property {CanvasLineCap} lineCap\n * @property {Array<number>} lineDash\n * @property {number} lineDashOffset\n * @property {CanvasLineJoin} lineJoin\n * @property {number} lineWidth\n * @property {number} miterLimit\n * @property {import(\"../colorlike.js\").ColorLike} strokeStyle\n */\n\n\n/**\n * @typedef {Object} TextState\n * @property {string} font\n * @property {string} [textAlign]\n * @property {string} textBaseline\n * @property {string} [placement]\n * @property {number} [maxAngle]\n * @property {boolean} [overflow]\n * @property {import(\"../style/Fill.js\").default} [backgroundFill]\n * @property {import(\"../style/Stroke.js\").default} [backgroundStroke]\n * @property {number} [scale]\n * @property {Array<number>} [padding]\n */\n\n/**\n * Container for decluttered replay instructions that need to be rendered or\n * omitted together, i.e. when styles render both an image and text, or for the\n * characters that form text along lines. The basic elements of this array are\n * `[minX, minY, maxX, maxY, count]`, where the first four entries are the\n * rendered extent of the group in pixel space. `count` is the number of styles\n * in the group, i.e. 2 when an image and a text are grouped, or 1 otherwise.\n * In addition to these four elements, declutter instruction arrays (i.e. the\n * arguments to {@link module:ol/render/canvas~drawImage} are appended to the array.\n * @typedef {Array<*>} DeclutterGroup\n */\n\n\n/**\n * Declutter groups for support of multi geometries.\n * @typedef {Array<DeclutterGroup>} DeclutterGroups\n */\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultFont = '10px sans-serif';\n\n\n/**\n * @const\n * @type {import(\"../colorlike.js\").ColorLike}\n */\nexport const defaultFillStyle = '#000';\n\n\n/**\n * @const\n * @type {CanvasLineCap}\n */\nexport const defaultLineCap = 'round';\n\n\n/**\n * @const\n * @type {Array<number>}\n */\nexport const defaultLineDash = [];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineDashOffset = 0;\n\n\n/**\n * @const\n * @type {CanvasLineJoin}\n */\nexport const defaultLineJoin = 'round';\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultMiterLimit = 10;\n\n\n/**\n * @const\n * @type {import(\"../colorlike.js\").ColorLike}\n */\nexport const defaultStrokeStyle = '#000';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextAlign = 'center';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const defaultTextBaseline = 'middle';\n\n\n/**\n * @const\n * @type {Array<number>}\n */\nexport const defaultPadding = [0, 0, 0, 0];\n\n\n/**\n * @const\n * @type {number}\n */\nexport const defaultLineWidth = 1;\n\n\n/**\n * The label cache for text rendering. To change the default cache size of 2048\n * entries, use {@link module:ol/structs/LRUCache#setSize}.\n * @type {LabelCache}\n * @api\n */\nexport const labelCache = new LabelCache();\n\n\n/**\n * @type {!Object<string, number>}\n */\nexport const checkedFonts = {};\n\n\n/**\n * @type {CanvasRenderingContext2D}\n */\nlet measureContext = null;\n\n/**\n * @type {string}\n */\nlet measureFont;\n\n/**\n * @type {!Object<string, number>}\n */\nexport const textHeights = {};\n\n\n/**\n * Clears the label cache when a font becomes available.\n * @param {string} fontSpec CSS font spec.\n */\nexport const checkFont = (function() {\n  const retries = 100;\n  const checked = checkedFonts;\n  const size = '32px ';\n  const referenceFonts = ['monospace', 'serif'];\n  const len = referenceFonts.length;\n  const text = 'wmytzilWMYTZIL@#/&?$%10\\uF013';\n  let interval, referenceWidth;\n\n  /**\n   * @param {string} fontStyle Css font-style\n   * @param {string} fontWeight Css font-weight\n   * @param {*} fontFamily Css font-family\n   * @return {boolean} Font with style and weight is available\n   */\n  function isAvailable(fontStyle, fontWeight, fontFamily) {\n    const context = getMeasureContext();\n    let available = true;\n    for (let i = 0; i < len; ++i) {\n      const referenceFont = referenceFonts[i];\n      context.font = fontStyle + ' ' + fontWeight + ' ' + size + referenceFont;\n      referenceWidth = context.measureText(text).width;\n      if (fontFamily != referenceFont) {\n        context.font = fontStyle + ' ' + fontWeight + ' ' + size + fontFamily + ',' + referenceFont;\n        const width = context.measureText(text).width;\n        // If width and referenceWidth are the same, then the fallback was used\n        // instead of the font we wanted, so the font is not available.\n        available = available && width != referenceWidth;\n      }\n    }\n    if (available) {\n      return true;\n    }\n    return false;\n  }\n\n  function check() {\n    let done = true;\n    for (const font in checked) {\n      if (checked[font] < retries) {\n        if (isAvailable.apply(this, font.split('\\n'))) {\n          checked[font] = retries;\n          clear(textHeights);\n          // Make sure that loaded fonts are picked up by Safari\n          measureContext = null;\n          measureFont = undefined;\n          if (labelCache.getCount()) {\n            labelCache.clear();\n          }\n        } else {\n          ++checked[font];\n          done = false;\n        }\n      }\n    }\n    if (done) {\n      clearInterval(interval);\n      interval = undefined;\n    }\n  }\n\n  return function(fontSpec) {\n    const font = getFontParameters(fontSpec);\n    if (!font) {\n      return;\n    }\n    const families = font.families;\n    for (let i = 0, ii = families.length; i < ii; ++i) {\n      const family = families[i];\n      const key = font.style + '\\n' + font.weight + '\\n' + family;\n      if (!(key in checked)) {\n        checked[key] = retries;\n        if (!isAvailable(font.style, font.weight, family)) {\n          checked[key] = 0;\n          if (interval === undefined) {\n            interval = setInterval(check, 32);\n          }\n        }\n      }\n    }\n  };\n})();\n\n\n/**\n * @return {CanvasRenderingContext2D} Measure context.\n */\nfunction getMeasureContext() {\n  if (!measureContext) {\n    measureContext = createCanvasContext2D(1, 1);\n  }\n  return measureContext;\n}\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @return {import(\"../size.js\").Size} Measurement.\n */\nexport const measureTextHeight = (function() {\n  /**\n   * @type {HTMLDivElement}\n   */\n  let div;\n  const heights = textHeights;\n  return function(font) {\n    let height = heights[font];\n    if (height == undefined) {\n      if (!div) {\n        div = document.createElement('div');\n        div.innerHTML = 'M';\n        div.style.margin = div.style.padding = '0 !important';\n        div.style.position = 'absolute !important';\n        div.style.left = '-99999px !important';\n      }\n      div.style.font = font;\n      document.body.appendChild(div);\n      height = heights[font] = div.offsetHeight;\n      document.body.removeChild(div);\n    }\n    return height;\n  };\n})();\n\n\n/**\n * @param {string} font Font.\n * @param {string} text Text.\n * @return {number} Width.\n */\nexport function measureTextWidth(font, text) {\n  const measureContext = getMeasureContext();\n  if (font != measureFont) {\n    measureContext.font = measureFont = font;\n  }\n  return measureContext.measureText(text).width;\n}\n\n\n/**\n * Measure text width using a cache.\n * @param {string} font The font.\n * @param {string} text The text to measure.\n * @param {Object<string, number>} cache A lookup of cached widths by text.\n * @returns {number} The text width.\n */\nexport function measureAndCacheTextWidth(font, text, cache) {\n  if (text in cache) {\n    return cache[text];\n  }\n  const width = cache[text] = measureTextWidth(font, text);\n  return width;\n}\n\n\n/**\n * @param {string} font Font to use for measuring.\n * @param {Array<string>} lines Lines to measure.\n * @param {Array<number>} widths Array will be populated with the widths of\n * each line.\n * @return {number} Width of the whole text.\n */\nexport function measureTextWidths(font, lines, widths) {\n  const numLines = lines.length;\n  let width = 0;\n  for (let i = 0; i < numLines; ++i) {\n    const currentWidth = measureTextWidth(font, lines[i]);\n    width = Math.max(width, currentWidth);\n    widths.push(currentWidth);\n  }\n  return width;\n}\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {number} offsetX X offset.\n * @param {number} offsetY Y offset.\n */\nexport function rotateAtOffset(context, rotation, offsetX, offsetY) {\n  if (rotation !== 0) {\n    context.translate(offsetX, offsetY);\n    context.rotate(rotation);\n    context.translate(-offsetX, -offsetY);\n  }\n}\n\n\nexport const resetTransform = createTransform();\n\n\n/**\n * @param {CanvasRenderingContext2D} context Context.\n * @param {import(\"../transform.js\").Transform|null} transform Transform.\n * @param {number} opacity Opacity.\n * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n * @param {number} originX Origin X.\n * @param {number} originY Origin Y.\n * @param {number} w Width.\n * @param {number} h Height.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {number} scale Scale.\n */\nexport function drawImage(context,\n  transform, opacity, image, originX, originY, w, h, x, y, scale) {\n  let alpha;\n  if (opacity != 1) {\n    alpha = context.globalAlpha;\n    context.globalAlpha = alpha * opacity;\n  }\n  if (transform) {\n    context.setTransform.apply(context, transform);\n  }\n\n  context.drawImage(image, originX, originY, w, h, x, y, w * scale, h * scale);\n\n  if (opacity != 1) {\n    context.globalAlpha = alpha;\n  }\n  if (transform) {\n    context.setTransform.apply(context, resetTransform);\n  }\n}\n","/**\n * @module ol/geom/Point\n */\nimport {createOrUpdateFromCoordinate, containsXY} from '../extent.js';\nimport GeometryType from './GeometryType.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {deflateCoordinate} from './flat/deflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Point geometry.\n *\n * @api\n */\nclass Point extends SimpleGeometry {\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinates Coordinates.\n   * @param {import(\"./GeometryLayout.js\").default=} opt_layout Layout.\n   */\n  constructor(coordinates, opt_layout) {\n    super();\n    this.setCoordinates(coordinates, opt_layout);\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!Point} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    const point = new Point(this.flatCoordinates.slice(), this.layout);\n    return point;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    const flatCoordinates = this.flatCoordinates;\n    const squaredDistance = squaredDx(x, y, flatCoordinates[0], flatCoordinates[1]);\n    if (squaredDistance < minSquaredDistance) {\n      const stride = this.stride;\n      for (let i = 0; i < stride; ++i) {\n        closestPoint[i] = flatCoordinates[i];\n      }\n      closestPoint.length = stride;\n      return squaredDistance;\n    } else {\n      return minSquaredDistance;\n    }\n  }\n\n  /**\n   * Return the coordinate of the point.\n   * @return {import(\"../coordinate.js\").Coordinate} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates() {\n    return !this.flatCoordinates ? [] : this.flatCoordinates.slice();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  computeExtent(extent) {\n    return createOrUpdateFromCoordinate(this.flatCoordinates, extent);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.POINT;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    return containsXY(extent, this.flatCoordinates[0], this.flatCoordinates[1]);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinate(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n}\n\n\nexport default Point;\n","/**\n * @module ol/render/canvas/Instruction\n */\n\n/**\n * @enum {number}\n */\nconst Instruction = {\n  BEGIN_GEOMETRY: 0,\n  BEGIN_PATH: 1,\n  CIRCLE: 2,\n  CLOSE_PATH: 3,\n  CUSTOM: 4,\n  DRAW_CHARS: 5,\n  DRAW_IMAGE: 6,\n  END_GEOMETRY: 7,\n  FILL: 8,\n  MOVE_TO_LINE_TO: 9,\n  SET_FILL_STYLE: 10,\n  SET_STROKE_STYLE: 11,\n  STROKE: 12\n};\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport const fillInstruction = [Instruction.FILL];\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport const strokeInstruction = [Instruction.STROKE];\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport const beginPathInstruction = [Instruction.BEGIN_PATH];\n\n\n/**\n * @type {Array<Instruction>}\n */\nexport const closePathInstruction = [Instruction.CLOSE_PATH];\n\n\nexport default Instruction;\n","/**\n * @module ol/coordinate\n */\nimport {modulo} from './math.js';\nimport {padNumber} from './string.js';\n\n\n/**\n * An array of numbers representing an xy coordinate. Example: `[16, 48]`.\n * @typedef {Array<number>} Coordinate\n * @api\n */\n\n\n/**\n * A function that takes a {@link module:ol/coordinate~Coordinate} and\n * transforms it into a `{string}`.\n *\n * @typedef {function((Coordinate|undefined)): string} CoordinateFormat\n * @api\n */\n\n\n/**\n * Add `delta` to `coordinate`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {add} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     add(coord, [-2, 4]);\n *     // coord is now [5.85, 51.983333]\n *\n * @param {Coordinate} coordinate Coordinate.\n * @param {Coordinate} delta Delta.\n * @return {Coordinate} The input coordinate adjusted by\n * the given delta.\n * @api\n */\nexport function add(coordinate, delta) {\n  coordinate[0] += +delta[0];\n  coordinate[1] += +delta[1];\n  return coordinate;\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed circle.\n *\n * @param {Coordinate} coordinate The coordinate.\n * @param {import(\"./geom/Circle.js\").default} circle The circle.\n * @return {Coordinate} Closest point on the circumference.\n */\nexport function closestOnCircle(coordinate, circle) {\n  const r = circle.getRadius();\n  const center = circle.getCenter();\n  const x0 = center[0];\n  const y0 = center[1];\n  const x1 = coordinate[0];\n  const y1 = coordinate[1];\n\n  let dx = x1 - x0;\n  const dy = y1 - y0;\n  if (dx === 0 && dy === 0) {\n    dx = 1;\n  }\n  const d = Math.sqrt(dx * dx + dy * dy);\n\n  const x = x0 + r * dx / d;\n  const y = y0 + r * dy / d;\n\n  return [x, y];\n}\n\n\n/**\n * Calculates the point closest to the passed coordinate on the passed segment.\n * This is the foot of the perpendicular of the coordinate to the segment when\n * the foot is on the segment, or the closest segment coordinate when the foot\n * is outside the segment.\n *\n * @param {Coordinate} coordinate The coordinate.\n * @param {Array<Coordinate>} segment The two coordinates\n * of the segment.\n * @return {Coordinate} The foot of the perpendicular of\n * the coordinate to the segment.\n */\nexport function closestOnSegment(coordinate, segment) {\n  const x0 = coordinate[0];\n  const y0 = coordinate[1];\n  const start = segment[0];\n  const end = segment[1];\n  const x1 = start[0];\n  const y1 = start[1];\n  const x2 = end[0];\n  const y2 = end[1];\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n  const along = (dx === 0 && dy === 0) ? 0 :\n    ((dx * (x0 - x1)) + (dy * (y0 - y1))) / ((dx * dx + dy * dy) || 0);\n  let x, y;\n  if (along <= 0) {\n    x = x1;\n    y = y1;\n  } else if (along >= 1) {\n    x = x2;\n    y = y2;\n  } else {\n    x = x1 + along * dx;\n    y = y1 + along * dy;\n  }\n  return [x, y];\n}\n\n\n/**\n * Returns a {@link module:ol/coordinate~CoordinateFormat} function that can be\n * used to format\n * a {Coordinate} to a string.\n *\n * Example without specifying the fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY();\n *     var out = stringifyFunc(coord);\n *     // out is now '8, 48'\n *\n * Example with explicitly specifying 2 fractional digits:\n *\n *     import {createStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var stringifyFunc = createStringXY(2);\n *     var out = stringifyFunc(coord);\n *     // out is now '7.85, 47.98'\n *\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {CoordinateFormat} Coordinate format.\n * @api\n */\nexport function createStringXY(opt_fractionDigits) {\n  return (\n    /**\n     * @param {Coordinate} coordinate Coordinate.\n     * @return {string} String XY.\n     */\n    function(coordinate) {\n      return toStringXY(coordinate, opt_fractionDigits);\n    }\n  );\n}\n\n\n/**\n * @param {string} hemispheres Hemispheres.\n * @param {number} degrees Degrees.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} String.\n */\nexport function degreesToStringHDMS(hemispheres, degrees, opt_fractionDigits) {\n  const normalizedDegrees = modulo(degrees + 180, 360) - 180;\n  const x = Math.abs(3600 * normalizedDegrees);\n  const dflPrecision = opt_fractionDigits || 0;\n  const precision = Math.pow(10, dflPrecision);\n\n  let deg = Math.floor(x / 3600);\n  let min = Math.floor((x - deg * 3600) / 60);\n  let sec = x - (deg * 3600) - (min * 60);\n  sec = Math.ceil(sec * precision) / precision;\n\n  if (sec >= 60) {\n    sec = 0;\n    min += 1;\n  }\n\n  if (min >= 60) {\n    min = 0;\n    deg += 1;\n  }\n\n  return deg + '\\u00b0 ' + padNumber(min, 2) + '\\u2032 ' +\n    padNumber(sec, 2, dflPrecision) + '\\u2033' +\n    (normalizedDegrees == 0 ? '' : ' ' + hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0));\n}\n\n\n/**\n * Transforms the given {@link module:ol/coordinate~Coordinate} to a string\n * using the given string template. The strings `{x}` and `{y}` in the template\n * will be replaced with the first and second coordinate values respectively.\n *\n * Example without specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template);\n *     // out is now 'Coordinate is (8|48).'\n *\n * Example explicitly specifying the fractional digits:\n *\n *     import {format} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var template = 'Coordinate is ({x}|{y}).';\n *     var out = format(coord, template, 2);\n *     // out is now 'Coordinate is (7.85|47.98).'\n *\n * @param {Coordinate} coordinate Coordinate.\n * @param {string} template A template string with `{x}` and `{y}` placeholders\n *     that will be replaced by first and second coordinate values.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Formatted coordinate.\n * @api\n */\nexport function format(coordinate, template, opt_fractionDigits) {\n  if (coordinate) {\n    return template\n      .replace('{x}', coordinate[0].toFixed(opt_fractionDigits))\n      .replace('{y}', coordinate[1].toFixed(opt_fractionDigits));\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {Coordinate} coordinate1 First coordinate.\n * @param {Coordinate} coordinate2 Second coordinate.\n * @return {boolean} The two coordinates are equal.\n */\nexport function equals(coordinate1, coordinate2) {\n  let equals = true;\n  for (let i = coordinate1.length - 1; i >= 0; --i) {\n    if (coordinate1[i] != coordinate2[i]) {\n      equals = false;\n      break;\n    }\n  }\n  return equals;\n}\n\n\n/**\n * Rotate `coordinate` by `angle`. `coordinate` is modified in place and\n * returned by the function.\n *\n * Example:\n *\n *     import {rotate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var rotateRadians = Math.PI / 2; // 90 degrees\n *     rotate(coord, rotateRadians);\n *     // coord is now [-47.983333, 7.85]\n *\n * @param {Coordinate} coordinate Coordinate.\n * @param {number} angle Angle in radian.\n * @return {Coordinate} Coordinate.\n * @api\n */\nexport function rotate(coordinate, angle) {\n  const cosAngle = Math.cos(angle);\n  const sinAngle = Math.sin(angle);\n  const x = coordinate[0] * cosAngle - coordinate[1] * sinAngle;\n  const y = coordinate[1] * cosAngle + coordinate[0] * sinAngle;\n  coordinate[0] = x;\n  coordinate[1] = y;\n  return coordinate;\n}\n\n\n/**\n * Scale `coordinate` by `scale`. `coordinate` is modified in place and returned\n * by the function.\n *\n * Example:\n *\n *     import {scale as scaleCoordinate} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var scale = 1.2;\n *     scaleCoordinate(coord, scale);\n *     // coord is now [9.42, 57.5799996]\n *\n * @param {Coordinate} coordinate Coordinate.\n * @param {number} scale Scale factor.\n * @return {Coordinate} Coordinate.\n */\nexport function scale(coordinate, scale) {\n  coordinate[0] *= scale;\n  coordinate[1] *= scale;\n  return coordinate;\n}\n\n\n/**\n * @param {Coordinate} coord1 First coordinate.\n * @param {Coordinate} coord2 Second coordinate.\n * @return {number} Squared distance between coord1 and coord2.\n */\nexport function squaredDistance(coord1, coord2) {\n  const dx = coord1[0] - coord2[0];\n  const dy = coord1[1] - coord2[1];\n  return dx * dx + dy * dy;\n}\n\n\n/**\n * @param {Coordinate} coord1 First coordinate.\n * @param {Coordinate} coord2 Second coordinate.\n * @return {number} Distance between coord1 and coord2.\n */\nexport function distance(coord1, coord2) {\n  return Math.sqrt(squaredDistance(coord1, coord2));\n}\n\n\n/**\n * Calculate the squared distance from a coordinate to a line segment.\n *\n * @param {Coordinate} coordinate Coordinate of the point.\n * @param {Array<Coordinate>} segment Line segment (2\n * coordinates).\n * @return {number} Squared distance from the point to the line segment.\n */\nexport function squaredDistanceToSegment(coordinate, segment) {\n  return squaredDistance(coordinate,\n    closestOnSegment(coordinate, segment));\n}\n\n\n/**\n * Format a geographic coordinate with the hemisphere, degrees, minutes, and\n * seconds.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord);\n *     // out is now '47° 58′ 60″ N 7° 50′ 60″ E'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringHDMS} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringHDMS(coord, 1);\n *     // out is now '47° 58′ 60.0″ N 7° 50′ 60.0″ E'\n *\n * @param {Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} Hemisphere, degrees, minutes and seconds.\n * @api\n */\nexport function toStringHDMS(coordinate, opt_fractionDigits) {\n  if (coordinate) {\n    return degreesToStringHDMS('NS', coordinate[1], opt_fractionDigits) + ' ' +\n        degreesToStringHDMS('EW', coordinate[0], opt_fractionDigits);\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * Format a coordinate as a comma delimited string.\n *\n * Example without specifying fractional digits:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord);\n *     // out is now '8, 48'\n *\n * Example explicitly specifying 1 fractional digit:\n *\n *     import {toStringXY} from 'ol/coordinate';\n *\n *     var coord = [7.85, 47.983333];\n *     var out = toStringXY(coord, 1);\n *     // out is now '7.8, 48.0'\n *\n * @param {Coordinate} coordinate Coordinate.\n * @param {number=} opt_fractionDigits The number of digits to include\n *    after the decimal point. Default is `0`.\n * @return {string} XY.\n * @api\n */\nexport function toStringXY(coordinate, opt_fractionDigits) {\n  return format(coordinate, '{x}, {y}', opt_fractionDigits);\n}\n","/**\n * @module ol/dom\n */\n\n\n/**\n * Create an html canvas element and returns its 2d context.\n * @param {number=} opt_width Canvas width.\n * @param {number=} opt_height Canvas height.\n * @return {CanvasRenderingContext2D} The context.\n */\nexport function createCanvasContext2D(opt_width, opt_height) {\n  const canvas = document.createElement('canvas');\n  if (opt_width) {\n    canvas.width = opt_width;\n  }\n  if (opt_height) {\n    canvas.height = opt_height;\n  }\n  return canvas.getContext('2d');\n}\n\n\n/**\n * Get the current computed width for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerWidth(true)`.\n * @param {!HTMLElement} element Element.\n * @return {number} The width.\n */\nexport function outerWidth(element) {\n  let width = element.offsetWidth;\n  const style = getComputedStyle(element);\n  width += parseInt(style.marginLeft, 10) + parseInt(style.marginRight, 10);\n\n  return width;\n}\n\n\n/**\n * Get the current computed height for the given element including margin,\n * padding and border.\n * Equivalent to jQuery's `$(el).outerHeight(true)`.\n * @param {!HTMLElement} element Element.\n * @return {number} The height.\n */\nexport function outerHeight(element) {\n  let height = element.offsetHeight;\n  const style = getComputedStyle(element);\n  height += parseInt(style.marginTop, 10) + parseInt(style.marginBottom, 10);\n\n  return height;\n}\n\n/**\n * @param {Node} newNode Node to replace old node\n * @param {Node} oldNode The node to be replaced\n */\nexport function replaceNode(newNode, oldNode) {\n  const parent = oldNode.parentNode;\n  if (parent) {\n    parent.replaceChild(newNode, oldNode);\n  }\n}\n\n/**\n * @param {Node} node The node to remove.\n * @returns {Node} The node that was removed or null.\n */\nexport function removeNode(node) {\n  return node && node.parentNode ? node.parentNode.removeChild(node) : null;\n}\n\n/**\n * @param {Node} node The node to remove the children from.\n */\nexport function removeChildren(node) {\n  while (node.lastChild) {\n    node.removeChild(node.lastChild);\n  }\n}\n\n/**\n * Transform the children of a parent node so they match the\n * provided list of children.  This function aims to efficiently\n * remove, add, and reorder child nodes while maintaining a simple\n * implementation (it is not guaranteed to minimize DOM operations).\n * @param {Node} node The parent node whose children need reworking.\n * @param {Array<Node>} children The desired children.\n */\nexport function replaceChildren(node, children) {\n  const oldChildren = node.childNodes;\n\n  for (let i = 0; true; ++i) {\n    const oldChild = oldChildren[i];\n    const newChild = children[i];\n\n    // check if our work is done\n    if (!oldChild && !newChild) {\n      break;\n    }\n\n    // check if children match\n    if (oldChild === newChild) {\n      continue;\n    }\n\n    // check if a new child needs to be added\n    if (!oldChild) {\n      node.appendChild(newChild);\n      continue;\n    }\n\n    // check if an old child needs to be removed\n    if (!newChild) {\n      node.removeChild(oldChild);\n      --i;\n      continue;\n    }\n\n    // reorder\n    node.insertBefore(newChild, oldChild);\n  }\n}\n","/**\n * @module ol/ImageState\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  IDLE: 0,\n  LOADING: 1,\n  LOADED: 2,\n  ERROR: 3,\n  EMPTY: 4\n};\n","/**\n * @module ol/format/GeoJSON\n */\n\nimport {assert} from '../asserts.js';\nimport Feature from '../Feature.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport JSONFeature from './JSONFeature.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assign, isEmpty} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport GeometryType from '../geom/GeometryType.js';\n\n/**\n * @typedef {import(\"geojson\").GeoJSON} GeoJSONObject\n * @typedef {import(\"geojson\").Feature} GeoJSONFeature\n * @typedef {import(\"geojson\").FeatureCollection} GeoJSONFeatureCollection\n * @typedef {import(\"geojson\").Geometry} GeoJSONGeometry\n * @typedef {import(\"geojson\").Point} GeoJSONPoint\n * @typedef {import(\"geojson\").LineString} GeoJSONLineString\n * @typedef {import(\"geojson\").Polygon} GeoJSONPolygon\n * @typedef {import(\"geojson\").MultiPoint} GeoJSONMultiPoint\n * @typedef {import(\"geojson\").MultiLineString} GeoJSONMultiLineString\n * @typedef {import(\"geojson\").MultiPolygon} GeoJSONMultiPolygon\n * @typedef {import(\"geojson\").GeometryCollection} GeoJSONGeometryCollection\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../proj.js\").ProjectionLike} [dataProjection='EPSG:4326'] Default data projection.\n * @property {import(\"../proj.js\").ProjectionLike} [featureProjection] Projection for features read or\n * written by the format.  Options passed to read or write methods will take precedence.\n * @property {string} [geometryName] Geometry name to use when creating features.\n * @property {boolean} [extractGeometryName=false] Certain GeoJSON providers include\n * the geometry_name field in the feature GeoJSON. If set to `true` the GeoJSON reader\n * will look for that field to set the geometry name. If both this field is set to `true`\n * and a `geometryName` is provided, the `geometryName` will take precedence.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GeoJSON format.\n *\n  * @api\n */\nclass GeoJSON extends JSONFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super();\n\n    /**\n     * @inheritDoc\n     */\n    this.dataProjection = getProjection(\n      options.dataProjection ?\n        options.dataProjection : 'EPSG:4326');\n\n    if (options.featureProjection) {\n      this.defaultFeatureProjection = getProjection(options.featureProjection);\n    }\n\n    /**\n     * Name of the geometry attribute for features.\n     * @type {string|undefined}\n     * @private\n     */\n    this.geometryName_ = options.geometryName;\n\n    /**\n     * Look for the geometry name in the feature GeoJSON\n     * @type {boolean|undefined}\n     * @private\n     */\n    this.extractGeometryName_ = options.extractGeometryName;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromObject(object, opt_options) {\n    /**\n     * @type {GeoJSONFeature}\n     */\n    let geoJSONFeature = null;\n    if (object['type'] === 'Feature') {\n      geoJSONFeature = /** @type {GeoJSONFeature} */ (object);\n    } else {\n      geoJSONFeature = {\n        'type': 'Feature',\n        'geometry': /** @type {GeoJSONGeometry} */ (object),\n        'properties': null\n      };\n    }\n\n    const geometry = readGeometry(geoJSONFeature['geometry'], opt_options);\n    const feature = new Feature();\n    if (this.geometryName_) {\n      feature.setGeometryName(this.geometryName_);\n    } else if (this.extractGeometryName_ && 'geometry_name' in geoJSONFeature !== undefined) {\n      feature.setGeometryName(geoJSONFeature['geometry_name']);\n    }\n    feature.setGeometry(geometry);\n\n    if ('id' in geoJSONFeature) {\n      feature.setId(geoJSONFeature['id']);\n    }\n\n    if (geoJSONFeature['properties']) {\n      feature.setProperties(geoJSONFeature['properties'], true);\n    }\n    return feature;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromObject(object, opt_options) {\n    const geoJSONObject = /** @type {GeoJSONObject} */ (object);\n    /** @type {Array<import(\"../Feature.js\").default>} */\n    let features = null;\n    if (geoJSONObject['type'] === 'FeatureCollection') {\n      const geoJSONFeatureCollection = /** @type {GeoJSONFeatureCollection} */ (object);\n      features = [];\n      const geoJSONFeatures = geoJSONFeatureCollection['features'];\n      for (let i = 0, ii = geoJSONFeatures.length; i < ii; ++i) {\n        features.push(this.readFeatureFromObject(geoJSONFeatures[i], opt_options));\n      }\n    } else {\n      features = [this.readFeatureFromObject(object, opt_options)];\n    }\n    return features;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readGeometryFromObject(object, opt_options) {\n    return readGeometry(/** @type {GeoJSONGeometry} */ (object), opt_options);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readProjectionFromObject(object) {\n    const crs = object['crs'];\n    let projection;\n    if (crs) {\n      if (crs['type'] == 'name') {\n        projection = getProjection(crs['properties']['name']);\n      } else {\n        assert(false, 36); // Unknown SRS type\n      }\n    } else {\n      projection = this.dataProjection;\n    }\n    return (\n      /** @type {import(\"../proj/Projection.js\").default} */ (projection)\n    );\n  }\n\n  /**\n   * Encode a feature as a GeoJSON Feature object.\n   *\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {GeoJSONFeature} Object.\n   * @override\n   * @api\n   */\n  writeFeatureObject(feature, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n\n    /** @type {GeoJSONFeature} */\n    const object = {\n      'type': 'Feature',\n      geometry: null,\n      properties: null\n    };\n\n    const id = feature.getId();\n    if (id !== undefined) {\n      object.id = id;\n    }\n\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      object.geometry = writeGeometry(geometry, opt_options);\n    }\n\n    const properties = feature.getProperties();\n    delete properties[feature.getGeometryName()];\n    if (!isEmpty(properties)) {\n      object.properties = properties;\n    }\n    return object;\n  }\n\n  /**\n   * Encode an array of features as a GeoJSON object.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {GeoJSONFeatureCollection} GeoJSON Object.\n   * @override\n   * @api\n   */\n  writeFeaturesObject(features, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n    const objects = [];\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      objects.push(this.writeFeatureObject(features[i], opt_options));\n    }\n    return {\n      type: 'FeatureCollection',\n      features: objects\n    };\n  }\n\n  /**\n   * Encode a geometry as a GeoJSON object.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {GeoJSONGeometry|GeoJSONGeometryCollection} Object.\n   * @override\n   * @api\n   */\n  writeGeometryObject(geometry, opt_options) {\n    return writeGeometry(geometry, this.adaptOptions(opt_options));\n  }\n}\n\n\n/**\n * @param {GeoJSONGeometry|GeoJSONGeometryCollection} object Object.\n * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n * @return {import(\"../geom/Geometry.js\").default} Geometry.\n */\nfunction readGeometry(object, opt_options) {\n  if (!object) {\n    return null;\n  }\n\n  /**\n   * @type {import(\"../geom/Geometry.js\").default}\n   */\n  let geometry;\n  switch (object['type']) {\n    case GeometryType.POINT: {\n      geometry = readPointGeometry(/** @type {GeoJSONPoint} */ (object));\n      break;\n    }\n    case GeometryType.LINE_STRING: {\n      geometry = readLineStringGeometry(/** @type {GeoJSONLineString} */ (object));\n      break;\n    }\n    case GeometryType.POLYGON: {\n      geometry = readPolygonGeometry(/** @type {GeoJSONPolygon} */ (object));\n      break;\n    }\n    case GeometryType.MULTI_POINT: {\n      geometry = readMultiPointGeometry(/** @type {GeoJSONMultiPoint} */ (object));\n      break;\n    }\n    case GeometryType.MULTI_LINE_STRING: {\n      geometry = readMultiLineStringGeometry(/** @type {GeoJSONMultiLineString} */ (object));\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      geometry = readMultiPolygonGeometry(/** @type {GeoJSONMultiPolygon} */ (object));\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      geometry = readGeometryCollectionGeometry(/** @type {GeoJSONGeometryCollection} */ (object));\n      break;\n    }\n    default: {\n      throw new Error('Unsupported GeoJSON type: ' + object.type);\n    }\n  }\n  return transformGeometryWithOptions(geometry, false, opt_options);\n}\n\n\n/**\n * @param {GeoJSONGeometryCollection} object Object.\n * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n * @return {GeometryCollection} Geometry collection.\n */\nfunction readGeometryCollectionGeometry(object, opt_options) {\n  const geometries = object['geometries'].map(\n    /**\n     * @param {GeoJSONGeometry} geometry Geometry.\n     * @return {import(\"../geom/Geometry.js\").default} geometry Geometry.\n     */\n    function(geometry) {\n      return readGeometry(geometry, opt_options);\n    });\n  return new GeometryCollection(geometries);\n}\n\n\n/**\n * @param {GeoJSONPoint} object Object.\n * @return {Point} Point.\n */\nfunction readPointGeometry(object) {\n  return new Point(object['coordinates']);\n}\n\n\n/**\n * @param {GeoJSONLineString} object Object.\n * @return {LineString} LineString.\n */\nfunction readLineStringGeometry(object) {\n  return new LineString(object['coordinates']);\n}\n\n\n/**\n * @param {GeoJSONMultiLineString} object Object.\n * @return {MultiLineString} MultiLineString.\n */\nfunction readMultiLineStringGeometry(object) {\n  return new MultiLineString(object['coordinates']);\n}\n\n\n/**\n * @param {GeoJSONMultiPoint} object Object.\n * @return {MultiPoint} MultiPoint.\n */\nfunction readMultiPointGeometry(object) {\n  return new MultiPoint(object['coordinates']);\n}\n\n\n/**\n * @param {GeoJSONMultiPolygon} object Object.\n * @return {MultiPolygon} MultiPolygon.\n */\nfunction readMultiPolygonGeometry(object) {\n  return new MultiPolygon(object['coordinates']);\n}\n\n\n/**\n * @param {GeoJSONPolygon} object Object.\n * @return {Polygon} Polygon.\n */\nfunction readPolygonGeometry(object) {\n  return new Polygon(object['coordinates']);\n}\n\n\n/**\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeGeometry(geometry, opt_options) {\n  geometry = transformGeometryWithOptions(geometry, true, opt_options);\n  const type = geometry.getType();\n\n  /** @type {GeoJSONGeometry} */\n  let geoJSON;\n  switch (type) {\n    case GeometryType.POINT: {\n      geoJSON = writePointGeometry(/** @type {Point} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.LINE_STRING: {\n      geoJSON = writeLineStringGeometry(/** @type {LineString} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.POLYGON: {\n      geoJSON = writePolygonGeometry(/** @type {Polygon} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.MULTI_POINT: {\n      geoJSON = writeMultiPointGeometry(/** @type {MultiPoint} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.MULTI_LINE_STRING: {\n      geoJSON = writeMultiLineStringGeometry(/** @type {MultiLineString} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      geoJSON = writeMultiPolygonGeometry(/** @type {MultiPolygon} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      geoJSON = writeGeometryCollectionGeometry(/** @type {GeometryCollection} */ (geometry), opt_options);\n      break;\n    }\n    case GeometryType.CIRCLE: {\n      geoJSON = {\n        type: 'GeometryCollection',\n        geometries: []\n      };\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return geoJSON;\n}\n\n\n/**\n * @param {GeometryCollection} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometryCollection} GeoJSON geometry collection.\n */\nfunction writeGeometryCollectionGeometry(geometry, opt_options) {\n  const geometries = geometry.getGeometriesArray().map(function(geometry) {\n    const options = assign({}, opt_options);\n    delete options.featureProjection;\n    return writeGeometry(geometry, options);\n  });\n  return {\n    type: 'GeometryCollection',\n    geometries: geometries\n  };\n}\n\n\n/**\n * @param {LineString} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeLineStringGeometry(geometry, opt_options) {\n  return {\n    type: 'LineString',\n    coordinates: geometry.getCoordinates()\n  };\n}\n\n\n/**\n * @param {MultiLineString} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiLineStringGeometry(geometry, opt_options) {\n  return {\n    type: 'MultiLineString',\n    coordinates: geometry.getCoordinates()\n  };\n}\n\n\n/**\n * @param {MultiPoint} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiPointGeometry(geometry, opt_options) {\n  return {\n    type: 'MultiPoint',\n    coordinates: geometry.getCoordinates()\n  };\n}\n\n\n/**\n * @param {MultiPolygon} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writeMultiPolygonGeometry(geometry, opt_options) {\n  let right;\n  if (opt_options) {\n    right = opt_options.rightHanded;\n  }\n  return {\n    type: 'MultiPolygon',\n    coordinates: geometry.getCoordinates(right)\n  };\n}\n\n\n/**\n * @param {Point} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writePointGeometry(geometry, opt_options) {\n  return {\n    type: 'Point',\n    coordinates: geometry.getCoordinates()\n  };\n}\n\n\n/**\n * @param {Polygon} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {GeoJSONGeometry} GeoJSON geometry.\n */\nfunction writePolygonGeometry(geometry, opt_options) {\n  let right;\n  if (opt_options) {\n    right = opt_options.rightHanded;\n  }\n  return {\n    type: 'Polygon',\n    coordinates: geometry.getCoordinates(right)\n  };\n}\n\n\nexport default GeoJSON;\n","/**\n * @module ol/geom/Polygon\n */\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, getCenter} from '../extent.js';\nimport GeometryLayout from './GeometryLayout.js';\nimport GeometryType from './GeometryType.js';\nimport LinearRing from './LinearRing.js';\nimport Point from './Point.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {offset as sphereOffset} from '../sphere.js';\nimport {linearRings as linearRingsArea} from './flat/area.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from './flat/closest.js';\nimport {linearRingsContainsXY} from './flat/contains.js';\nimport {deflateCoordinatesArray} from './flat/deflate.js';\nimport {inflateCoordinatesArray} from './flat/inflate.js';\nimport {getInteriorPointOfArray} from './flat/interiorpoint.js';\nimport {intersectsLinearRingArray} from './flat/intersectsextent.js';\nimport {linearRingsAreOriented, orientLinearRings} from './flat/orient.js';\nimport {quantizeArray} from './flat/simplify.js';\nimport {modulo} from '../math.js';\n\n/**\n * @classdesc\n * Polygon geometry.\n *\n * @api\n */\nclass Polygon extends SimpleGeometry {\n\n  /**\n   * @param {!Array<Array<import(\"../coordinate.js\").Coordinate>>|!Array<number>} coordinates\n   *     Array of linear rings that define the polygon. The first linear ring of the\n   *     array defines the outer-boundary or surface of the polygon. Each subsequent\n   *     linear ring defines a hole in the surface of the polygon. A linear ring is\n   *     an array of vertices' coordinates where the first coordinate and the last are\n   *     equivalent. (For internal use, flat coordinates in combination with\n   *     `opt_layout` and `opt_ends` are also accepted.)\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @param {Array<number>=} opt_ends Ends (for internal use with flat coordinates).\n   */\n  constructor(coordinates, opt_layout, opt_ends) {\n\n    super();\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.ends_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.flatInteriorPointRevision_ = -1;\n\n    /**\n     * @private\n     * @type {import(\"../coordinate.js\").Coordinate}\n     */\n    this.flatInteriorPoint_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDelta_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDeltaRevision_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.orientedRevision_ = -1;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.orientedFlatCoordinates_ = null;\n\n    if (opt_layout !== undefined && opt_ends) {\n      this.setFlatCoordinates(opt_layout, /** @type {Array<number>} */ (coordinates));\n      this.ends_ = opt_ends;\n    } else {\n      this.setCoordinates(/** @type {Array<Array<import(\"../coordinate.js\").Coordinate>>} */ (coordinates), opt_layout);\n    }\n\n  }\n\n  /**\n   * Append the passed linear ring to this polygon.\n   * @param {LinearRing} linearRing Linear ring.\n   * @api\n   */\n  appendLinearRing(linearRing) {\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = linearRing.getFlatCoordinates().slice();\n    } else {\n      extend(this.flatCoordinates, linearRing.getFlatCoordinates());\n    }\n    this.ends_.push(this.flatCoordinates.length);\n    this.changed();\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!Polygon} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    return new Polygon(this.flatCoordinates.slice(), this.layout, this.ends_.slice());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    if (this.maxDeltaRevision_ != this.getRevision()) {\n      this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n        this.flatCoordinates, 0, this.ends_, this.stride, 0));\n      this.maxDeltaRevision_ = this.getRevision();\n    }\n    return assignClosestArrayPoint(\n      this.flatCoordinates, 0, this.ends_, this.stride,\n      this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  containsXY(x, y) {\n    return linearRingsContainsXY(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, x, y);\n  }\n\n  /**\n   * Return the area of the polygon on projected plane.\n   * @return {number} Area (on projected plane).\n   * @api\n   */\n  getArea() {\n    return linearRingsArea(this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride);\n  }\n\n  /**\n   * Get the coordinate array for this geometry.  This array has the structure\n   * of a GeoJSON coordinate array for polygons.\n   *\n   * @param {boolean=} opt_right Orient coordinates according to the right-hand\n   *     rule (counter-clockwise for exterior and clockwise for interior rings).\n   *     If `false`, coordinates will be oriented according to the left-hand rule\n   *     (clockwise for exterior and counter-clockwise for interior rings).\n   *     By default, coordinate orientation will depend on how the geometry was\n   *     constructed.\n   * @return {Array<Array<import(\"../coordinate.js\").Coordinate>>} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates(opt_right) {\n    let flatCoordinates;\n    if (opt_right !== undefined) {\n      flatCoordinates = this.getOrientedFlatCoordinates().slice();\n      orientLinearRings(\n        flatCoordinates, 0, this.ends_, this.stride, opt_right);\n    } else {\n      flatCoordinates = this.flatCoordinates;\n    }\n\n    return inflateCoordinatesArray(\n      flatCoordinates, 0, this.ends_, this.stride);\n  }\n\n  /**\n   * @return {Array<number>} Ends.\n   */\n  getEnds() {\n    return this.ends_;\n  }\n\n  /**\n   * @return {Array<number>} Interior point.\n   */\n  getFlatInteriorPoint() {\n    if (this.flatInteriorPointRevision_ != this.getRevision()) {\n      const flatCenter = getCenter(this.getExtent());\n      this.flatInteriorPoint_ = getInteriorPointOfArray(\n        this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride,\n        flatCenter, 0);\n      this.flatInteriorPointRevision_ = this.getRevision();\n    }\n    return this.flatInteriorPoint_;\n  }\n\n  /**\n   * Return an interior point of the polygon.\n   * @return {Point} Interior point as XYM coordinate, where M is the\n   * length of the horizontal intersection that the point belongs to.\n   * @api\n   */\n  getInteriorPoint() {\n    return new Point(this.getFlatInteriorPoint(), GeometryLayout.XYM);\n  }\n\n  /**\n   * Return the number of rings of the polygon,  this includes the exterior\n   * ring and any interior rings.\n   *\n   * @return {number} Number of rings.\n   * @api\n   */\n  getLinearRingCount() {\n    return this.ends_.length;\n  }\n\n  /**\n   * Return the Nth linear ring of the polygon geometry. Return `null` if the\n   * given index is out of range.\n   * The exterior linear ring is available at index `0` and the interior rings\n   * at index `1` and beyond.\n   *\n   * @param {number} index Index.\n   * @return {LinearRing} Linear ring.\n   * @api\n   */\n  getLinearRing(index) {\n    if (index < 0 || this.ends_.length <= index) {\n      return null;\n    }\n    return new LinearRing(this.flatCoordinates.slice(\n      index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]), this.layout);\n  }\n\n  /**\n   * Return the linear rings of the polygon.\n   * @return {Array<LinearRing>} Linear rings.\n   * @api\n   */\n  getLinearRings() {\n    const layout = this.layout;\n    const flatCoordinates = this.flatCoordinates;\n    const ends = this.ends_;\n    const linearRings = [];\n    let offset = 0;\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      const end = ends[i];\n      const linearRing = new LinearRing(flatCoordinates.slice(offset, end), layout);\n      linearRings.push(linearRing);\n      offset = end;\n    }\n    return linearRings;\n  }\n\n  /**\n   * @return {Array<number>} Oriented flat coordinates.\n   */\n  getOrientedFlatCoordinates() {\n    if (this.orientedRevision_ != this.getRevision()) {\n      const flatCoordinates = this.flatCoordinates;\n      if (linearRingsAreOriented(\n        flatCoordinates, 0, this.ends_, this.stride)) {\n        this.orientedFlatCoordinates_ = flatCoordinates;\n      } else {\n        this.orientedFlatCoordinates_ = flatCoordinates.slice();\n        this.orientedFlatCoordinates_.length =\n            orientLinearRings(\n              this.orientedFlatCoordinates_, 0, this.ends_, this.stride);\n      }\n      this.orientedRevision_ = this.getRevision();\n    }\n    return this.orientedFlatCoordinates_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometryInternal(squaredTolerance) {\n    const simplifiedFlatCoordinates = [];\n    const simplifiedEnds = [];\n    simplifiedFlatCoordinates.length = quantizeArray(\n      this.flatCoordinates, 0, this.ends_, this.stride,\n      Math.sqrt(squaredTolerance),\n      simplifiedFlatCoordinates, 0, simplifiedEnds);\n    return new Polygon(simplifiedFlatCoordinates, GeometryLayout.XY, simplifiedEnds);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.POLYGON;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    return intersectsLinearRingArray(\n      this.getOrientedFlatCoordinates(), 0, this.ends_, this.stride, extent);\n  }\n\n  /**\n   * Set the coordinates of the polygon.\n   * @param {!Array<Array<import(\"../coordinate.js\").Coordinate>>} coordinates Coordinates.\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @override\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n}\n\n\nexport default Polygon;\n\n\n/**\n * Create an approximation of a circle on the surface of a sphere.\n * @param {import(\"../coordinate.js\").Coordinate} center Center (`[lon, lat]` in degrees).\n * @param {number} radius The great-circle distance from the center to\n *     the polygon vertices.\n * @param {number=} opt_n Optional number of vertices for the resulting\n *     polygon. Default is `32`.\n * @param {number=} opt_sphereRadius Optional radius for the sphere (defaults to\n *     the Earth's mean radius using the WGS84 ellipsoid).\n * @return {Polygon} The \"circular\" polygon.\n * @api\n */\nexport function circular(center, radius, opt_n, opt_sphereRadius) {\n  const n = opt_n ? opt_n : 32;\n  /** @type {Array<number>} */\n  const flatCoordinates = [];\n  for (let i = 0; i < n; ++i) {\n    extend(flatCoordinates, sphereOffset(center, radius, 2 * Math.PI * i / n, opt_sphereRadius));\n  }\n  flatCoordinates.push(flatCoordinates[0], flatCoordinates[1]);\n  return new Polygon(flatCoordinates, GeometryLayout.XY, [flatCoordinates.length]);\n}\n\n\n/**\n * Create a polygon from an extent. The layout used is `XY`.\n * @param {import(\"../extent.js\").Extent} extent The extent.\n * @return {Polygon} The polygon.\n * @api\n */\nexport function fromExtent(extent) {\n  const minX = extent[0];\n  const minY = extent[1];\n  const maxX = extent[2];\n  const maxY = extent[3];\n  const flatCoordinates =\n      [minX, minY, minX, maxY, maxX, maxY, maxX, minY, minX, minY];\n  return new Polygon(flatCoordinates, GeometryLayout.XY, [flatCoordinates.length]);\n}\n\n\n/**\n * Create a regular polygon from a circle.\n * @param {import(\"./Circle.js\").default} circle Circle geometry.\n * @param {number=} opt_sides Number of sides of the polygon. Default is 32.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n * @return {Polygon} Polygon geometry.\n * @api\n */\nexport function fromCircle(circle, opt_sides, opt_angle) {\n  const sides = opt_sides ? opt_sides : 32;\n  const stride = circle.getStride();\n  const layout = circle.getLayout();\n  const center = circle.getCenter();\n  const arrayLength = stride * (sides + 1);\n  const flatCoordinates = new Array(arrayLength);\n  for (let i = 0; i < arrayLength; i += stride) {\n    flatCoordinates[i] = 0;\n    flatCoordinates[i + 1] = 0;\n    for (let j = 2; j < stride; j++) {\n      flatCoordinates[i + j] = center[j];\n    }\n  }\n  const ends = [flatCoordinates.length];\n  const polygon = new Polygon(flatCoordinates, layout, ends);\n  makeRegular(polygon, center, circle.getRadius(), opt_angle);\n  return polygon;\n}\n\n\n/**\n * Modify the coordinates of a polygon to make it a regular polygon.\n * @param {Polygon} polygon Polygon geometry.\n * @param {import(\"../coordinate.js\").Coordinate} center Center of the regular polygon.\n * @param {number} radius Radius of the regular polygon.\n * @param {number=} opt_angle Start angle for the first vertex of the polygon in\n *     radians. Default is 0.\n */\nexport function makeRegular(polygon, center, radius, opt_angle) {\n  const flatCoordinates = polygon.getFlatCoordinates();\n  const stride = polygon.getStride();\n  const sides = flatCoordinates.length / stride - 1;\n  const startAngle = opt_angle ? opt_angle : 0;\n  for (let i = 0; i <= sides; ++i) {\n    const offset = i * stride;\n    const angle = startAngle + (modulo(i, sides) * 2 * Math.PI / sides);\n    flatCoordinates[offset] = center[0] + (radius * Math.cos(angle));\n    flatCoordinates[offset + 1] = center[1] + (radius * Math.sin(angle));\n  }\n  polygon.changed();\n}\n","/**\n * @module ol/geom/LineString\n */\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from './GeometryLayout.js';\nimport GeometryType from './GeometryType.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {assignClosestPoint, maxSquaredDelta} from './flat/closest.js';\nimport {deflateCoordinates} from './flat/deflate.js';\nimport {inflateCoordinates} from './flat/inflate.js';\nimport {interpolatePoint, lineStringCoordinateAtM} from './flat/interpolate.js';\nimport {intersectsLineString} from './flat/intersectsextent.js';\nimport {lineStringLength} from './flat/length.js';\nimport {forEach as forEachSegment} from './flat/segments.js';\nimport {douglasPeucker} from './flat/simplify.js';\n\n/**\n * @classdesc\n * Linestring geometry.\n *\n * @api\n */\nclass LineString extends SimpleGeometry {\n\n  /**\n   * @param {Array<import(\"../coordinate.js\").Coordinate>|Array<number>} coordinates Coordinates.\n   *     For internal use, flat coordinates in combination with `opt_layout` are also accepted.\n   * @param {GeometryLayout=} opt_layout Layout.\n   */\n  constructor(coordinates, opt_layout) {\n\n    super();\n\n    /**\n     * @private\n     * @type {import(\"../coordinate.js\").Coordinate}\n     */\n    this.flatMidpoint_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.flatMidpointRevision_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDelta_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDeltaRevision_ = -1;\n\n    if (opt_layout !== undefined && !Array.isArray(coordinates[0])) {\n      this.setFlatCoordinates(opt_layout, /** @type {Array<number>} */ (coordinates));\n    } else {\n      this.setCoordinates(/** @type {Array<import(\"../coordinate.js\").Coordinate>} */ (coordinates), opt_layout);\n    }\n\n  }\n\n  /**\n   * Append the passed coordinate to the coordinates of the linestring.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @api\n   */\n  appendCoordinate(coordinate) {\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = coordinate.slice();\n    } else {\n      extend(this.flatCoordinates, coordinate);\n    }\n    this.changed();\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!LineString} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    return new LineString(this.flatCoordinates.slice(), this.layout);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    if (this.maxDeltaRevision_ != this.getRevision()) {\n      this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n        this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n      this.maxDeltaRevision_ = this.getRevision();\n    }\n    return assignClosestPoint(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n      this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n  }\n\n  /**\n   * Iterate over each segment, calling the provided callback.\n   * If the callback returns a truthy value the function returns that\n   * value immediately. Otherwise the function returns `false`.\n   *\n   * @param {function(this: S, import(\"../coordinate.js\").Coordinate, import(\"../coordinate.js\").Coordinate): T} callback Function\n   *     called for each segment. The function will receive two arguments, the start and end coordinates of the segment.\n   * @return {T|boolean} Value.\n   * @template T,S\n   * @api\n   */\n  forEachSegment(callback) {\n    return forEachSegment(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, callback);\n  }\n\n  /**\n   * Returns the coordinate at `m` using linear interpolation, or `null` if no\n   * such coordinate exists.\n   *\n   * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n   * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n   * M will return the first coordinate and Ms greater than the last M will\n   * return the last coordinate.\n   *\n   * @param {number} m M.\n   * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n   * @return {import(\"../coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  getCoordinateAtM(m, opt_extrapolate) {\n    if (this.layout != GeometryLayout.XYM &&\n        this.layout != GeometryLayout.XYZM) {\n      return null;\n    }\n    const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n    return lineStringCoordinateAtM(this.flatCoordinates, 0,\n      this.flatCoordinates.length, this.stride, m, extrapolate);\n  }\n\n  /**\n   * Return the coordinates of the linestring.\n   * @return {Array<import(\"../coordinate.js\").Coordinate>} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates() {\n    return inflateCoordinates(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n  }\n\n  /**\n   * Return the coordinate at the provided fraction along the linestring.\n   * The `fraction` is a number between 0 and 1, where 0 is the start of the\n   * linestring and 1 is the end.\n   * @param {number} fraction Fraction.\n   * @param {import(\"../coordinate.js\").Coordinate=} opt_dest Optional coordinate whose values will\n   *     be modified. If not provided, a new coordinate will be returned.\n   * @return {import(\"../coordinate.js\").Coordinate} Coordinate of the interpolated point.\n   * @api\n   */\n  getCoordinateAt(fraction, opt_dest) {\n    return interpolatePoint(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n      fraction, opt_dest);\n  }\n\n  /**\n   * Return the length of the linestring on projected plane.\n   * @return {number} Length (on projected plane).\n   * @api\n   */\n  getLength() {\n    return lineStringLength(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n  }\n\n  /**\n   * @return {Array<number>} Flat midpoint.\n   */\n  getFlatMidpoint() {\n    if (this.flatMidpointRevision_ != this.getRevision()) {\n      this.flatMidpoint_ = this.getCoordinateAt(0.5, this.flatMidpoint_);\n      this.flatMidpointRevision_ = this.getRevision();\n    }\n    return this.flatMidpoint_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometryInternal(squaredTolerance) {\n    const simplifiedFlatCoordinates = [];\n    simplifiedFlatCoordinates.length = douglasPeucker(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n      squaredTolerance, simplifiedFlatCoordinates, 0);\n    return new LineString(simplifiedFlatCoordinates, GeometryLayout.XY);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.LINE_STRING;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    return intersectsLineString(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n      extent);\n  }\n\n  /**\n   * Set the coordinates of the linestring.\n   * @param {!Array<import(\"../coordinate.js\").Coordinate>} coordinates Coordinates.\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @override\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n}\n\n\nexport default LineString;\n","/**\n * @module ol/Object\n */\nimport {getUid} from './util.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport Observable from './Observable.js';\nimport Event from './events/Event.js';\nimport {assign} from './obj.js';\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Object~BaseObject} instances are instances of this type.\n */\nexport class ObjectEvent extends Event {\n\n  /**\n   * @param {string} type The event type.\n   * @param {string} key The property name.\n   * @param {*} oldValue The old value for `key`.\n   */\n  constructor(type, key, oldValue) {\n    super(type);\n\n    /**\n     * The name of the property whose value is changing.\n     * @type {string}\n     * @api\n     */\n    this.key = key;\n\n    /**\n     * The old value. To get the new value use `e.target.get(e.key)` where\n     * `e` is the event object.\n     * @type {*}\n     * @api\n     */\n    this.oldValue = oldValue;\n\n  }\n\n}\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Most non-trivial classes inherit from this.\n *\n * This extends {@link module:ol/Observable} with observable\n * properties, where each property is observable as well as the object as a\n * whole.\n *\n * Classes that inherit from this have pre-defined properties, to which you can\n * add your owns. The pre-defined properties are listed in this documentation as\n * 'Observable Properties', and have their own accessors; for example,\n * {@link module:ol/Map~Map} has a `target` property, accessed with\n * `getTarget()` and changed with `setTarget()`. Not all properties are however\n * settable. There are also general-purpose accessors `get()` and `set()`. For\n * example, `get('target')` is equivalent to `getTarget()`.\n *\n * The `set` accessors trigger a change event, and you can monitor this by\n * registering a listener. For example, {@link module:ol/View~View} has a\n * `center` property, so `view.on('change:center', function(evt) {...});` would\n * call the function whenever the value of the center property changes. Within\n * the function, `evt.target` would be the view, so `evt.target.getCenter()`\n * would return the new center.\n *\n * You can add your own observable properties with\n * `object.set('prop', 'value')`, and retrieve that with `object.get('prop')`.\n * You can listen for changes on that property value with\n * `object.on('change:prop', listener)`. You can get a list of all\n * properties with {@link module:ol/Object~BaseObject#getProperties}.\n *\n * Note that the observable properties are separate from standard JS properties.\n * You can, for example, give your map object a title with\n * `map.title='New title'` and with `map.set('title', 'Another title')`. The\n * first will be a `hasOwnProperty`; the second will appear in\n * `getProperties()`. Only the second is observable.\n *\n * Properties can be deleted by using the unset method. E.g.\n * object.unset('foo').\n *\n * @fires ObjectEvent\n * @api\n */\nclass BaseObject extends Observable {\n\n  /**\n   * @param {Object<string, *>=} opt_values An object with key-value pairs.\n   */\n  constructor(opt_values) {\n    super();\n\n    // Call {@link module:ol/util~getUid} to ensure that the order of objects' ids is\n    // the same as the order in which they were created.  This also helps to\n    // ensure that object properties are always added in the same order, which\n    // helps many JavaScript engines generate faster code.\n    getUid(this);\n\n    /**\n     * @private\n     * @type {!Object<string, *>}\n     */\n    this.values_ = {};\n\n    if (opt_values !== undefined) {\n      this.setProperties(opt_values);\n    }\n  }\n\n  /**\n   * Gets a value.\n   * @param {string} key Key name.\n   * @return {*} Value.\n   * @api\n   */\n  get(key) {\n    let value;\n    if (this.values_.hasOwnProperty(key)) {\n      value = this.values_[key];\n    }\n    return value;\n  }\n\n  /**\n   * Get a list of object property names.\n   * @return {Array<string>} List of property names.\n   * @api\n   */\n  getKeys() {\n    return Object.keys(this.values_);\n  }\n\n  /**\n   * Get an object of all property names and values.\n   * @return {Object<string, *>} Object.\n   * @api\n   */\n  getProperties() {\n    return assign({}, this.values_);\n  }\n\n  /**\n   * @param {string} key Key name.\n   * @param {*} oldValue Old value.\n   */\n  notify(key, oldValue) {\n    let eventType;\n    eventType = getChangeEventType(key);\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n    eventType = ObjectEventType.PROPERTYCHANGE;\n    this.dispatchEvent(new ObjectEvent(eventType, key, oldValue));\n  }\n\n  /**\n   * Sets a value.\n   * @param {string} key Key name.\n   * @param {*} value Value.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  set(key, value, opt_silent) {\n    if (opt_silent) {\n      this.values_[key] = value;\n    } else {\n      const oldValue = this.values_[key];\n      this.values_[key] = value;\n      if (oldValue !== value) {\n        this.notify(key, oldValue);\n      }\n    }\n  }\n\n  /**\n   * Sets a collection of key-value pairs.  Note that this changes any existing\n   * properties and adds new ones (it does not remove any existing properties).\n   * @param {Object<string, *>} values Values.\n   * @param {boolean=} opt_silent Update without triggering an event.\n   * @api\n   */\n  setProperties(values, opt_silent) {\n    for (const key in values) {\n      this.set(key, values[key], opt_silent);\n    }\n  }\n\n  /**\n   * Unsets a property.\n   * @param {string} key Key name.\n   * @param {boolean=} opt_silent Unset without triggering an event.\n   * @api\n   */\n  unset(key, opt_silent) {\n    if (key in this.values_) {\n      const oldValue = this.values_[key];\n      delete this.values_[key];\n      if (!opt_silent) {\n        this.notify(key, oldValue);\n      }\n    }\n  }\n}\n\n\n/**\n * @type {Object<string, string>}\n */\nconst changeEventTypeCache = {};\n\n\n/**\n * @param {string} key Key name.\n * @return {string} Change name.\n */\nexport function getChangeEventType(key) {\n  return changeEventTypeCache.hasOwnProperty(key) ?\n    changeEventTypeCache[key] :\n    (changeEventTypeCache[key] = 'change:' + key);\n}\n\n\nexport default BaseObject;\n","/**\n * @module ol/functions\n */\n\nimport {equals as arrayEquals} from './array.js';\n\n/**\n * Always returns true.\n * @returns {boolean} true.\n */\nexport function TRUE() {\n  return true;\n}\n\n/**\n * Always returns false.\n * @returns {boolean} false.\n */\nexport function FALSE() {\n  return false;\n}\n\n/**\n * A reusable function, used e.g. as a default for callbacks.\n *\n * @return {void} Nothing.\n */\nexport function VOID() {}\n\n/**\n * Wrap a function in another function that remembers the last return.  If the\n * returned function is called twice in a row with the same arguments and the same\n * this object, it will return the value from the first call in the second call.\n *\n * @param {function(...any): ReturnType} fn The function to memoize.\n * @return {function(...any): ReturnType} The memoized function.\n * @template ReturnType\n */\nexport function memoizeOne(fn) {\n  let called = false;\n\n  /** @type ReturnType */\n  let lastResult;\n\n  /** @type Array<any> */\n  let lastArgs;\n\n  let lastThis;\n\n  return function() {\n    const nextArgs = Array.prototype.slice.call(arguments);\n    if (!called || this !== lastThis || !arrayEquals(nextArgs, lastArgs)) {\n      called = true;\n      lastThis = this;\n      lastArgs = nextArgs;\n      lastResult = fn.apply(this, arguments);\n    }\n    return lastResult;\n  };\n}\n","/**\n * @module ol/events/condition\n */\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport {assert} from '../asserts.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport {WEBKIT, MAC} from '../has.js';\n\n\n/**\n * A function that takes an {@link module:ol/MapBrowserEvent} and returns a\n * `{boolean}`. If the condition is met, true should be returned.\n *\n * @typedef {function(this: ?, import(\"../MapBrowserEvent.js\").default): boolean} Condition\n */\n\n\n/**\n * Return `true` if only the alt-key is pressed, `false` otherwise (e.g. when\n * additionally the shift-key is pressed).\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt key is pressed.\n * @api\n */\nexport const altKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = /** @type {KeyboardEvent|MouseEvent|TouchEvent} */ (mapBrowserEvent.originalEvent);\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the alt-key and shift-key is pressed, `false` otherwise\n * (e.g. when additionally the platform-modifier-key is pressed).\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the alt and shift keys are pressed.\n * @api\n */\nexport const altShiftKeysOnly = function(mapBrowserEvent) {\n  const originalEvent = /** @type {KeyboardEvent|MouseEvent|TouchEvent} */ (mapBrowserEvent.originalEvent);\n  return (\n    originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the map has the focus. This condition requires a map target\n * element with a `tabindex` attribute, e.g. `<div id=\"map\" tabindex=\"1\">`.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} event Map browser event.\n * @return {boolean} The map has the focus.\n * @api\n */\nexport const focus = function(event) {\n  return event.target.getTargetElement() === document.activeElement;\n};\n\n\n/**\n * Return always true.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True.\n * @api\n */\nexport const always = TRUE;\n\n\n/**\n * Return `true` if the event is a `click` event, `false` otherwise.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `click` event.\n * @api\n */\nexport const click = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.CLICK;\n};\n\n\n/**\n * Return `true` if the event has an \"action\"-producing mouse button.\n *\n * By definition, this includes left-click on windows/linux, and left-click\n * without the ctrl key on Macs.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} The result.\n */\nexport const mouseActionButton = function(mapBrowserEvent) {\n  const originalEvent = /** @type {MouseEvent} */ (mapBrowserEvent.originalEvent);\n  return originalEvent.button == 0 &&\n      !(WEBKIT && MAC && originalEvent.ctrlKey);\n};\n\n\n/**\n * Return always false.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} False.\n * @api\n */\nexport const never = FALSE;\n\n\n/**\n * Return `true` if the browser event is a `pointermove` event, `false`\n * otherwise.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the browser event is a `pointermove` event.\n * @api\n */\nexport const pointerMove = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == 'pointermove';\n};\n\n\n/**\n * Return `true` if the event is a map `singleclick` event, `false` otherwise.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `singleclick` event.\n * @api\n */\nexport const singleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK;\n};\n\n\n/**\n * Return `true` if the event is a map `dblclick` event, `false` otherwise.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event is a map `dblclick` event.\n * @api\n */\nexport const doubleClick = function(mapBrowserEvent) {\n  return mapBrowserEvent.type == MapBrowserEventType.DBLCLICK;\n};\n\n\n/**\n * Return `true` if no modifier key (alt-, shift- or platform-modifier-key) is\n * pressed.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True only if there no modifier keys are pressed.\n * @api\n */\nexport const noModifierKeys = function(mapBrowserEvent) {\n  const originalEvent = /** @type {KeyboardEvent|MouseEvent|TouchEvent} */ (mapBrowserEvent.originalEvent);\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      !originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if only the platform-modifier-key (the meta-key on Mac,\n * ctrl-key otherwise) is pressed, `false` otherwise (e.g. when additionally\n * the shift-key is pressed).\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the platform modifier key is pressed.\n * @api\n */\nexport const platformModifierKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = /** @type {KeyboardEvent|MouseEvent|TouchEvent} */ (mapBrowserEvent.originalEvent);\n  return !originalEvent.altKey &&\n    (MAC ? originalEvent.metaKey : originalEvent.ctrlKey) &&\n    !originalEvent.shiftKey;\n};\n\n\n/**\n * Return `true` if only the shift-key is pressed, `false` otherwise (e.g. when\n * additionally the alt-key is pressed).\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if only the shift key is pressed.\n * @api\n */\nexport const shiftKeyOnly = function(mapBrowserEvent) {\n  const originalEvent = /** @type {KeyboardEvent|MouseEvent|TouchEvent} */ (mapBrowserEvent.originalEvent);\n  return (\n    !originalEvent.altKey &&\n      !(originalEvent.metaKey || originalEvent.ctrlKey) &&\n      originalEvent.shiftKey);\n};\n\n\n/**\n * Return `true` if the target element is not editable, i.e. not a `<input>`-,\n * `<select>`- or `<textarea>`-element, `false` otherwise.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True only if the target element is not editable.\n * @api\n */\nexport const targetNotEditable = function(mapBrowserEvent) {\n  const target = mapBrowserEvent.target;\n  const tagName = /** @type {Element} */ (target).tagName;\n  return (\n    tagName !== 'INPUT' &&\n      tagName !== 'SELECT' &&\n      tagName !== 'TEXTAREA');\n};\n\n\n/**\n * Return `true` if the event originates from a mouse device.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a mouse device.\n * @api\n */\nexport const mouseOnly = function(mapBrowserEvent) {\n  const pointerEvent = /** @type {import(\"../MapBrowserPointerEvent\").default} */ (mapBrowserEvent).pointerEvent;\n  assert(pointerEvent !== undefined, 56); // mapBrowserEvent must originate from a pointer event\n  // see http://www.w3.org/TR/pointerevents/#widl-PointerEvent-pointerType\n  return pointerEvent.pointerType == 'mouse';\n};\n\n/**\n * Return `true` if the event originates from a touchable device.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a touchable device.\n * @api\n */\nexport const touchOnly = function(mapBrowserEvent) {\n  const pointerEvt = /** @type {import(\"../MapBrowserPointerEvent\").default} */ (mapBrowserEvent).pointerEvent;\n  assert(pointerEvt !== undefined, 56); // mapBrowserEvent must originate from a pointer event\n  // see http://www.w3.org/TR/pointerevents/#widl-PointerEvent-pointerType\n  return pointerEvt.pointerType === 'touch';\n};\n\n/**\n * Return `true` if the event originates from a digital pen.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a digital pen.\n * @api\n */\nexport const penOnly = function(mapBrowserEvent) {\n  const pointerEvt = /** @type {import(\"../MapBrowserPointerEvent\").default} */ (mapBrowserEvent).pointerEvent;\n  assert(pointerEvt !== undefined, 56); // mapBrowserEvent must originate from a pointer event\n  // see http://www.w3.org/TR/pointerevents/#widl-PointerEvent-pointerType\n  return pointerEvt.pointerType === 'pen';\n};\n\n/**\n * Return `true` if the event originates from a primary pointer in\n * contact with the surface or if the left mouse button is pressed.\n * See http://www.w3.org/TR/pointerevents/#button-states.\n *\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} True if the event originates from a primary pointer.\n * @api\n */\nexport const primaryAction = function(mapBrowserEvent) {\n  const pointerEvent = /** @type {import(\"../MapBrowserPointerEvent\").default} */ (mapBrowserEvent).pointerEvent;\n  assert(pointerEvent !== undefined, 56); // mapBrowserEvent must originate from a pointer event\n  return pointerEvent.isPrimary && pointerEvent.button === 0;\n};\n","/**\n * @module ol/MapBrowserEventType\n */\nimport EventType from './events/EventType.js';\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n\n  /**\n   * A true single click with no dragging and no double click. Note that this\n   * event is delayed by 250 ms to ensure that it is not a double click.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#singleclick\n   * @api\n   */\n  SINGLECLICK: 'singleclick',\n\n  /**\n   * A click with no dragging. A double click will fire two of this.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#click\n   * @api\n   */\n  CLICK: EventType.CLICK,\n\n  /**\n   * A true double click, with no dragging.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#dblclick\n   * @api\n   */\n  DBLCLICK: EventType.DBLCLICK,\n\n  /**\n   * Triggered when a pointer is dragged.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointerdrag\n   * @api\n   */\n  POINTERDRAG: 'pointerdrag',\n\n  /**\n   * Triggered when a pointer is moved. Note that on touch devices this is\n   * triggered when the map is panned, so is not the same as mousemove.\n   * @event module:ol/MapBrowserEvent~MapBrowserEvent#pointermove\n   * @api\n   */\n  POINTERMOVE: 'pointermove',\n\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/format/Feature\n */\nimport {assign} from '../obj.js';\nimport {abstract} from '../util.js';\nimport {get as getProjection, equivalent as equivalentProjection, transformExtent} from '../proj.js';\nimport Units from '../proj/Units.js';\n\n\n/**\n * @typedef {Object} ReadOptions\n * @property {import(\"../proj.js\").ProjectionLike} [dataProjection] Projection of the data we are reading.\n * If not provided, the projection will be derived from the data (where possible) or\n * the `dataProjection` of the format is assigned (where set). If the projection\n * can not be derived from the data and if no `dataProjection` is set for a format,\n * the features will not be reprojected.\n * @property {import(\"../extent.js\").Extent} [extent] Tile extent in map units of the tile being read.\n * This is only required when reading data with tile pixels as geometry units. When configured,\n * a `dataProjection` with `TILE_PIXELS` as `units` and the tile's pixel extent as `extent` needs to be\n * provided.\n * @property {import(\"../proj.js\").ProjectionLike} [featureProjection] Projection of the feature geometries\n * created by the format reader. If not provided, features will be returned in the\n * `dataProjection`.\n */\n\n\n/**\n * @typedef {Object} WriteOptions\n * @property {import(\"../proj.js\").ProjectionLike} [dataProjection] Projection of the data we are writing.\n * If not provided, the `dataProjection` of the format is assigned (where set).\n * If no `dataProjection` is set for a format, the features will be returned\n * in the `featureProjection`.\n * @property {import(\"../proj.js\").ProjectionLike} [featureProjection] Projection of the feature geometries\n * that will be serialized by the format writer. If not provided, geometries are assumed\n * to be in the `dataProjection` if that is set; in other words, they are not transformed.\n * @property {boolean} [rightHanded] When writing geometries, follow the right-hand\n * rule for linear ring orientation.  This means that polygons will have counter-clockwise\n * exterior rings and clockwise interior rings.  By default, coordinates are serialized\n * as they are provided at construction.  If `true`, the right-hand rule will\n * be applied.  If `false`, the left-hand rule will be applied (clockwise for\n * exterior and counter-clockwise for interior rings).  Note that not all\n * formats support this.  The GeoJSON format does use this property when writing\n * geometries.\n * @property {number} [decimals] Maximum number of decimal places for coordinates.\n * Coordinates are stored internally as floats, but floating-point arithmetic can create\n * coordinates with a large number of decimal places, not generally wanted on output.\n * Set a number here to round coordinates. Can also be used to ensure that\n * coordinates read in can be written back out with the same number of decimals.\n * Default is no rounding.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for feature formats.\n * {@link module:ol/format/Feature~FeatureFormat} subclasses provide the ability to decode and encode\n * {@link module:ol/Feature~Feature} objects from a variety of commonly used geospatial\n * file formats.  See the documentation for each format for more details.\n *\n * @abstract\n * @api\n */\nclass FeatureFormat {\n  constructor() {\n\n    /**\n     * @protected\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.dataProjection = null;\n\n    /**\n     * @protected\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.defaultFeatureProjection = null;\n\n  }\n\n  /**\n   * Adds the data projection to the read options.\n   * @param {Document|Node|Object|string} source Source.\n   * @param {ReadOptions=} opt_options Options.\n   * @return {ReadOptions|undefined} Options.\n   * @protected\n   */\n  getReadOptions(source, opt_options) {\n    let options;\n    if (opt_options) {\n      let dataProjection = opt_options.dataProjection ?\n        getProjection(opt_options.dataProjection) : this.readProjection(source);\n      if (opt_options.extent &&\n          dataProjection && dataProjection.getUnits() === Units.TILE_PIXELS) {\n        dataProjection = getProjection(dataProjection);\n        dataProjection.setWorldExtent(opt_options.extent);\n      }\n      options = {\n        dataProjection: dataProjection,\n        featureProjection: opt_options.featureProjection\n      };\n    }\n    return this.adaptOptions(options);\n  }\n\n  /**\n   * Sets the `dataProjection` on the options, if no `dataProjection`\n   * is set.\n   * @param {WriteOptions|ReadOptions|undefined} options\n   *     Options.\n   * @protected\n   * @return {WriteOptions|ReadOptions|undefined}\n   *     Updated options.\n   */\n  adaptOptions(options) {\n    return assign({\n      dataProjection: this.dataProjection,\n      featureProjection: this.defaultFeatureProjection\n    }, options);\n  }\n\n  /**\n   * @abstract\n   * @return {import(\"./FormatType.js\").default} Format.\n   */\n  getType() {\n    return abstract();\n  }\n\n  /**\n   * Read a single feature from a source.\n   *\n   * @abstract\n   * @param {Document|Node|Object|string} source Source.\n   * @param {ReadOptions=} opt_options Read options.\n   * @return {import(\"../Feature.js\").FeatureLike} Feature.\n   */\n  readFeature(source, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read all features from a source.\n   *\n   * @abstract\n   * @param {Document|Node|ArrayBuffer|Object|string} source Source.\n   * @param {ReadOptions=} opt_options Read options.\n   * @return {Array<import(\"../Feature.js\").FeatureLike>} Features.\n   */\n  readFeatures(source, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read a single geometry from a source.\n   *\n   * @abstract\n   * @param {Document|Node|Object|string} source Source.\n   * @param {ReadOptions=} opt_options Read options.\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometry(source, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read the projection from a source.\n   *\n   * @abstract\n   * @param {Document|Node|Object|string} source Source.\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjection(source) {\n    return abstract();\n  }\n\n  /**\n   * Encode a feature in this format.\n   *\n   * @abstract\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {WriteOptions=} opt_options Write options.\n   * @return {string} Result.\n   */\n  writeFeature(feature, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Encode an array of features in this format.\n   *\n   * @abstract\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {WriteOptions=} opt_options Write options.\n   * @return {string} Result.\n   */\n  writeFeatures(features, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Write a single geometry in this format.\n   *\n   * @abstract\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {WriteOptions=} opt_options Write options.\n   * @return {string} Result.\n   */\n  writeGeometry(geometry, opt_options) {\n    return abstract();\n  }\n}\n\nexport default FeatureFormat;\n\n/**\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n * @param {boolean} write Set to true for writing, false for reading.\n * @param {(WriteOptions|ReadOptions)=} opt_options Options.\n * @return {import(\"../geom/Geometry.js\").default} Transformed geometry.\n */\nexport function transformGeometryWithOptions(geometry, write, opt_options) {\n  const featureProjection = opt_options ? getProjection(opt_options.featureProjection) : null;\n  const dataProjection = opt_options ? getProjection(opt_options.dataProjection) : null;\n\n  let transformed;\n  if (featureProjection && dataProjection && !equivalentProjection(featureProjection, dataProjection)) {\n    transformed = (write ? geometry.clone() : geometry).transform(\n      write ? featureProjection : dataProjection,\n      write ? dataProjection : featureProjection);\n  } else {\n    transformed = geometry;\n  }\n  if (write && opt_options && /** @type {WriteOptions} */ (opt_options).decimals !== undefined) {\n    const power = Math.pow(10, /** @type {WriteOptions} */ (opt_options).decimals);\n    // if decimals option on write, round each coordinate appropriately\n    /**\n     * @param {Array<number>} coordinates Coordinates.\n     * @return {Array<number>} Transformed coordinates.\n     */\n    const transform = function(coordinates) {\n      for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n        coordinates[i] = Math.round(coordinates[i] * power) / power;\n      }\n      return coordinates;\n    };\n    if (transformed === geometry) {\n      transformed = geometry.clone();\n    }\n    transformed.applyTransform(transform);\n  }\n  return transformed;\n}\n\n\n/**\n * @param {import(\"../extent.js\").Extent} extent Extent.\n * @param {ReadOptions=} opt_options Read options.\n * @return {import(\"../extent.js\").Extent} Transformed extent.\n */\nexport function transformExtentWithOptions(extent, opt_options) {\n  const featureProjection = opt_options ? getProjection(opt_options.featureProjection) : null;\n  const dataProjection = opt_options ? getProjection(opt_options.dataProjection) : null;\n\n  if (featureProjection && dataProjection && !equivalentProjection(featureProjection, dataProjection)) {\n    return transformExtent(extent, dataProjection, featureProjection);\n  } else {\n    return extent;\n  }\n}\n","/**\n * @module ol/source/BingMaps\n */\n\nimport {createFromTileUrlFunctions} from '../tileurlfunction.js';\nimport {applyTransform, intersects} from '../extent.js';\nimport {jsonp as requestJSONP} from '../net.js';\nimport {get as getProjection, getTransformFromProjections} from '../proj.js';\nimport SourceState from './State.js';\nimport TileImage from './TileImage.js';\nimport {createOrUpdate} from '../tilecoord.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n\n/**\n * @param {import('../tilecoord.js').TileCoord} tileCoord Tile coord.\n * @return {string} Quad key.\n */\nexport function quadKey(tileCoord) {\n  const z = tileCoord[0];\n  const digits = new Array(z);\n  let mask = 1 << (z - 1);\n  let i, charCode;\n  for (i = 0; i < z; ++i) {\n    // 48 is charCode for 0 - '0'.charCodeAt(0)\n    charCode = 48;\n    if (tileCoord[1] & mask) {\n      charCode += 1;\n    }\n    if (tileCoord[2] & mask) {\n      charCode += 2;\n    }\n    digits[i] = String.fromCharCode(charCode);\n    mask >>= 1;\n  }\n  return digits.join('');\n}\n\n\n/**\n * The attribution containing a link to the Microsoft® Bing™ Maps Platform APIs’\n * Terms Of Use.\n * @const\n * @type {string}\n */\nconst TOS_ATTRIBUTION = '<a class=\"ol-attribution-bing-tos\" ' +\n      'href=\"https://www.microsoft.com/maps/product/terms.html\">' +\n      'Terms of Use</a>';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {boolean} [hidpi=false] If `true` hidpi tiles will be requested.\n * @property {string} [culture='en-us'] Culture code.\n * @property {string} key Bing Maps API key. Get yours at http://www.bingmapsportal.com/.\n * @property {string} imagerySet Type of imagery.\n * @property {number} [maxZoom=21] Max zoom. Default is what's advertized by the BingMaps service.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @typedef {Object} BingMapsImageryMetadataResponse\n * @property {number} statusCode The response status code\n * @property {string} statusDescription The response status description\n * @property {string} authenticationResultCode The authentication result code\n * @property {Array<ResourceSet>} resourceSets The array of resource sets\n */\n\n\n/**\n * @typedef {Object} ResourceSet\n * @property {Array<Resource>} resources\n */\n\n\n/**\n * @typedef {Object} Resource\n * @property {number} imageHeight The image height\n * @property {number} imageWidth The image width\n * @property {number} zoomMin The minimum zoom level\n * @property {number} zoomMax The maximum zoom level\n * @property {string} imageUrl The image URL\n * @property {Array<string>} imageUrlSubdomains The image URL subdomains for rotation\n * @property {Array<ImageryProvider>} [imageryProviders] The array of ImageryProviders\n */\n\n\n/**\n * @typedef {Object} ImageryProvider\n * @property {Array<CoverageArea>} coverageAreas The coverage areas\n * @property {string} [attribution] The attribution\n */\n\n\n/**\n * @typedef {Object} CoverageArea\n * @property {number} zoomMin The minimum zoom\n * @property {number} zoomMax The maximum zoom\n * @property {Array<number>} bbox The coverage bounding box\n */\n\n\n/**\n * @classdesc\n * Layer source for Bing Maps tile data.\n * @api\n */\nclass BingMaps extends TileImage {\n  /**\n   * @param {Options} options Bing Maps options.\n   */\n  constructor(options) {\n\n    const hidpi = options.hidpi !== undefined ? options.hidpi : false;\n\n    super({\n      cacheSize: options.cacheSize,\n      crossOrigin: 'anonymous',\n      opaque: true,\n      projection: getProjection('EPSG:3857'),\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      state: SourceState.LOADING,\n      tileLoadFunction: options.tileLoadFunction,\n      tilePixelRatio: hidpi ? 2 : 1,\n      wrapX: options.wrapX !== undefined ? options.wrapX : true,\n      transition: options.transition\n    });\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.hidpi_ = hidpi;\n\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.culture_ = options.culture !== undefined ? options.culture : 'en-us';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxZoom_ = options.maxZoom !== undefined ? options.maxZoom : -1;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.apiKey_ = options.key;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.imagerySet_ = options.imagerySet;\n\n    const url = 'https://dev.virtualearth.net/REST/v1/Imagery/Metadata/' +\n        this.imagerySet_ +\n        '?uriScheme=https&include=ImageryProviders&key=' + this.apiKey_ +\n        '&c=' + this.culture_;\n\n    requestJSONP(url, this.handleImageryMetadataResponse.bind(this), undefined,\n      'jsonp');\n\n  }\n\n  /**\n   * Get the api key used for this source.\n   *\n   * @return {string} The api key.\n   * @api\n   */\n  getApiKey() {\n    return this.apiKey_;\n  }\n\n  /**\n   * Get the imagery set associated with this source.\n   *\n   * @return {string} The imagery set.\n   * @api\n   */\n  getImagerySet() {\n    return this.imagerySet_;\n  }\n\n  /**\n   * @param {BingMapsImageryMetadataResponse} response Response.\n   */\n  handleImageryMetadataResponse(response) {\n    if (response.statusCode != 200 ||\n        response.statusDescription != 'OK' ||\n        response.authenticationResultCode != 'ValidCredentials' ||\n        response.resourceSets.length != 1 ||\n        response.resourceSets[0].resources.length != 1) {\n      this.setState(SourceState.ERROR);\n      return;\n    }\n\n    const resource = response.resourceSets[0].resources[0];\n    const maxZoom = this.maxZoom_ == -1 ? resource.zoomMax : this.maxZoom_;\n\n    const sourceProjection = this.getProjection();\n    const extent = extentFromProjection(sourceProjection);\n    const scale = this.hidpi_ ? 2 : 1;\n    const tileSize = resource.imageWidth == resource.imageHeight ?\n      resource.imageWidth / scale :\n      [resource.imageWidth / scale, resource.imageHeight / scale];\n\n    const tileGrid = createXYZ({\n      extent: extent,\n      minZoom: resource.zoomMin,\n      maxZoom: maxZoom,\n      tileSize: tileSize\n    });\n    this.tileGrid = tileGrid;\n\n    const culture = this.culture_;\n    const hidpi = this.hidpi_;\n    this.tileUrlFunction = createFromTileUrlFunctions(\n      resource.imageUrlSubdomains.map(function(subdomain) {\n        /** @type {import('../tilecoord.js').TileCoord} */\n        const quadKeyTileCoord = [0, 0, 0];\n        const imageUrl = resource.imageUrl\n          .replace('{subdomain}', subdomain)\n          .replace('{culture}', culture);\n        return (\n          /**\n           * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n           * @param {number} pixelRatio Pixel ratio.\n           * @param {import(\"../proj/Projection.js\").default} projection Projection.\n           * @return {string|undefined} Tile URL.\n           */\n          function(tileCoord, pixelRatio, projection) {\n            if (!tileCoord) {\n              return undefined;\n            } else {\n              createOrUpdate(tileCoord[0], tileCoord[1], tileCoord[2], quadKeyTileCoord);\n              let url = imageUrl;\n              if (hidpi) {\n                url += '&dpi=d1&device=mobile';\n              }\n              return url.replace('{quadkey}', quadKey(quadKeyTileCoord));\n            }\n          }\n        );\n      }));\n\n    if (resource.imageryProviders) {\n      const transform = getTransformFromProjections(\n        getProjection('EPSG:4326'), this.getProjection());\n\n      this.setAttributions(function(frameState) {\n        const attributions = [];\n        const viewState = frameState.viewState;\n        const tileGrid = this.getTileGrid();\n        const z = tileGrid.getZForResolution(viewState.resolution, this.zDirection);\n        const tileCoord = tileGrid.getTileCoordForCoordAndZ(viewState.center, z);\n        const zoom = tileCoord[0];\n        resource.imageryProviders.map(function(imageryProvider) {\n          let intersecting = false;\n          const coverageAreas = imageryProvider.coverageAreas;\n          for (let i = 0, ii = coverageAreas.length; i < ii; ++i) {\n            const coverageArea = coverageAreas[i];\n            if (zoom >= coverageArea.zoomMin && zoom <= coverageArea.zoomMax) {\n              const bbox = coverageArea.bbox;\n              const epsg4326Extent = [bbox[1], bbox[0], bbox[3], bbox[2]];\n              const extent = applyTransform(epsg4326Extent, transform);\n              if (intersects(extent, frameState.extent)) {\n                intersecting = true;\n                break;\n              }\n            }\n          }\n          if (intersecting) {\n            attributions.push(imageryProvider.attribution);\n          }\n        });\n\n        attributions.push(TOS_ATTRIBUTION);\n        return attributions;\n      }.bind(this));\n    }\n\n    this.setState(SourceState.READY);\n  }\n}\n\nexport default BingMaps;\n","/**\n * @module ol/css\n */\n\n/**\n * @typedef {Object} FontParameters\n * @property {Array<string>} families\n * @property {string} style\n * @property {string} weight\n */\n\n\n/**\n * The CSS class for hidden feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_HIDDEN = 'ol-hidden';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them selectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_SELECTABLE = 'ol-selectable';\n\n\n/**\n * The CSS class that we'll give the DOM elements to have them unselectable.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSELECTABLE = 'ol-unselectable';\n\n\n/**\n * The CSS class for unsupported feature.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_UNSUPPORTED = 'ol-unsupported';\n\n\n/**\n * The CSS class for controls.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_CONTROL = 'ol-control';\n\n\n/**\n * The CSS class that we'll give the DOM elements that are collapsed, i.e.\n * to those elements which usually can be expanded.\n *\n * @const\n * @type {string}\n */\nexport const CLASS_COLLAPSED = 'ol-collapsed';\n\n\n/**\n * Get the list of font families from a font spec.  Note that this doesn't work\n * for font families that have commas in them.\n * @param {string} The CSS font property.\n * @return {FontParameters} The font families (or null if the input spec is invalid).\n */\nexport const getFontParameters = (function() {\n  /**\n   * @type {CSSStyleDeclaration}\n   */\n  let style;\n  /**\n   * @type {Object<string, FontParameters>}\n   */\n  const cache = {};\n  return function(font) {\n    if (!style) {\n      style = document.createElement('div').style;\n    }\n    if (!(font in cache)) {\n      style.font = font;\n      const family = style.fontFamily;\n      const fontWeight = style.fontWeight;\n      const fontStyle = style.fontStyle;\n      style.font = '';\n      if (!family) {\n        return null;\n      }\n      const families = family.split(/,\\s?/);\n      cache[font] = {\n        families: families,\n        weight: fontWeight,\n        style: fontStyle\n      };\n    }\n    return cache[font];\n  };\n})();\n","/**\n * @module ol/render/canvas/BuilderType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CIRCLE: 'Circle',\n  DEFAULT: 'Default',\n  IMAGE: 'Image',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  TEXT: 'Text'\n};\n","/**\n * @module ol/events/Event\n */\n\n/**\n * @classdesc\n * Stripped down implementation of the W3C DOM Level 2 Event interface.\n * See https://www.w3.org/TR/DOM-Level-2-Events/events.html#Events-interface.\n *\n * This implementation only provides `type` and `target` properties, and\n * `stopPropagation` and `preventDefault` methods. It is meant as base class\n * for higher level events defined in the library, and works with\n * {@link module:ol/events/Target~Target}.\n */\nclass BaseEvent {\n\n  /**\n   * @param {string} type Type.\n   */\n  constructor(type) {\n\n    /**\n     * @type {boolean}\n     */\n    this.propagationStopped;\n\n    /**\n     * The event type.\n     * @type {string}\n     * @api\n     */\n    this.type = type;\n\n    /**\n     * The event target.\n     * @type {Object}\n     * @api\n     */\n    this.target = null;\n  }\n\n  /**\n   * Stop event propagation.\n   * @api\n   */\n  preventDefault() {\n    this.propagationStopped = true;\n  }\n\n  /**\n   * Stop event propagation.\n   * @api\n   */\n  stopPropagation() {\n    this.propagationStopped = true;\n  }\n\n}\n\n\n/**\n * @param {Event|import(\"./Event.js\").default} evt Event\n */\nexport function stopPropagation(evt) {\n  evt.stopPropagation();\n}\n\n\n/**\n * @param {Event|import(\"./Event.js\").default} evt Event\n */\nexport function preventDefault(evt) {\n  evt.preventDefault();\n}\n\nexport default BaseEvent;\n","/**\n * @module ol/source/State\n */\n\n/**\n * @enum {string}\n * State of the source, one of 'undefined', 'loading', 'ready' or 'error'.\n */\nexport default {\n  UNDEFINED: 'undefined',\n  LOADING: 'loading',\n  READY: 'ready',\n  ERROR: 'error'\n};\n","/**\n * @module ol/ViewHint\n */\n\n/**\n * @enum {number}\n */\nexport default {\n  ANIMATING: 0,\n  INTERACTING: 1\n};\n","/**\n * @module ol/style/Circle\n */\n\nimport RegularShape from './RegularShape.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Fill.js\").default} [fill] Fill style.\n * @property {number} radius Circle radius.\n * @property {import(\"./Stroke.js\").default} [stroke] Stroke style.\n */\n\n\n/**\n * @classdesc\n * Set circle style for vector features.\n * @api\n */\nclass CircleStyle extends RegularShape {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      points: Infinity,\n      fill: options.fill,\n      radius: options.radius,\n      stroke: options.stroke\n    });\n\n  }\n\n  /**\n  * Clones the style.\n  * @return {CircleStyle} The cloned style.\n  * @override\n  * @api\n  */\n  clone() {\n    const style = new CircleStyle({\n      fill: this.getFill() ? this.getFill().clone() : undefined,\n      stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n      radius: this.getRadius()\n    });\n    style.setOpacity(this.getOpacity());\n    style.setScale(this.getScale());\n    return style;\n  }\n\n  /**\n   * Set the circle radius.\n   *\n   * @param {number} radius Circle radius.\n   * @api\n   */\n  setRadius(radius) {\n    this.radius_ = radius;\n    this.render();\n  }\n}\n\n\nexport default CircleStyle;\n","/**\n * @module ol/source/XYZ\n */\n\nimport TileImage from './TileImage.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {import(\"../proj.js\").ProjectionLike} [projection='EPSG:3857'] Projection.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {number} [maxZoom=18] Optional max zoom level.\n * @property {number} [minZoom=0] Optional min zoom level.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service.\n * For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {number|import(\"../size.js\").Size} [tileSize=[256, 256]] The tile size used by the tile service.\n * @property {import(\"../Tile.js\").UrlFunction} [tileUrlFunction] Optional function to get\n * tile URL given a tile coordinate and the projection.\n * Required if url or urls are not provided.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`,\n * and `{z}` placeholders. A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`,\n * may be used instead of defining each one separately in the `urls` option.\n * @property {Array<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {number} [zDirection=0] Indicate which resolution should be used\n * by a renderer if the view resolution does not match any resolution of the tile source.\n * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n * will be used. If -1, the nearest higher resolution will be used.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data with URLs in a set XYZ format that are\n * defined in a URL template. By default, this follows the widely-used\n * Google grid where `x` 0 and `y` 0 are in the top left. Grids like\n * TMS where `x` 0 and `y` 0 are in the bottom left can be used by\n * using the `{-y}` placeholder in the URL template, so long as the\n * source does not have a custom tile grid. In this case,\n * {@link module:ol/source/TileImage} can be used with a `tileUrlFunction`\n * such as:\n *\n *  tileUrlFunction: function(coordinate) {\n *    return 'http://mapserver.com/' + coordinate[0] + '/' +\n *        coordinate[1] + '/' + coordinate[2] + '.png';\n *    }\n *\n * @api\n */\nclass XYZ extends TileImage {\n  /**\n   * @param {Options=} opt_options XYZ options.\n   */\n  constructor(opt_options) {\n    const options = opt_options || {};\n    const projection = options.projection !== undefined ?\n      options.projection : 'EPSG:3857';\n\n    const tileGrid = options.tileGrid !== undefined ? options.tileGrid :\n      createXYZ({\n        extent: extentFromProjection(projection),\n        maxZoom: options.maxZoom,\n        minZoom: options.minZoom,\n        tileSize: options.tileSize\n      });\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      opaque: options.opaque,\n      projection: projection,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileGrid: tileGrid,\n      tileLoadFunction: options.tileLoadFunction,\n      tilePixelRatio: options.tilePixelRatio,\n      tileUrlFunction: options.tileUrlFunction,\n      url: options.url,\n      urls: options.urls,\n      wrapX: options.wrapX !== undefined ? options.wrapX : true,\n      transition: options.transition,\n      attributionsCollapsible: options.attributionsCollapsible,\n      zDirection: options.zDirection\n    });\n\n  }\n\n}\n\nexport default XYZ;\n","/**\n * @module ol/Kinetic\n */\n\n/**\n * @classdesc\n * Implementation of inertial deceleration for map movement.\n *\n * @api\n */\nclass Kinetic {\n\n  /**\n   * @param {number} decay Rate of decay (must be negative).\n   * @param {number} minVelocity Minimum velocity (pixels/millisecond).\n   * @param {number} delay Delay to consider to calculate the kinetic\n   *     initial values (milliseconds).\n   */\n  constructor(decay, minVelocity, delay) {\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.decay_ = decay;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minVelocity_ = minVelocity;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.delay_ = delay;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.points_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.angle_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.initialVelocity_ = 0;\n  }\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  begin() {\n    this.points_.length = 0;\n    this.angle_ = 0;\n    this.initialVelocity_ = 0;\n  }\n\n  /**\n   * @param {number} x X.\n   * @param {number} y Y.\n   */\n  update(x, y) {\n    this.points_.push(x, y, Date.now());\n  }\n\n  /**\n   * @return {boolean} Whether we should do kinetic animation.\n   */\n  end() {\n    if (this.points_.length < 6) {\n      // at least 2 points are required (i.e. there must be at least 6 elements\n      // in the array)\n      return false;\n    }\n    const delay = Date.now() - this.delay_;\n    const lastIndex = this.points_.length - 3;\n    if (this.points_[lastIndex + 2] < delay) {\n      // the last tracked point is too old, which means that the user stopped\n      // panning before releasing the map\n      return false;\n    }\n\n    // get the first point which still falls into the delay time\n    let firstIndex = lastIndex - 3;\n    while (firstIndex > 0 && this.points_[firstIndex + 2] > delay) {\n      firstIndex -= 3;\n    }\n\n    const duration = this.points_[lastIndex + 2] - this.points_[firstIndex + 2];\n    // we don't want a duration of 0 (divide by zero)\n    // we also make sure the user panned for a duration of at least one frame\n    // (1/60s) to compute sane displacement values\n    if (duration < 1000 / 60) {\n      return false;\n    }\n\n    const dx = this.points_[lastIndex] - this.points_[firstIndex];\n    const dy = this.points_[lastIndex + 1] - this.points_[firstIndex + 1];\n    this.angle_ = Math.atan2(dy, dx);\n    this.initialVelocity_ = Math.sqrt(dx * dx + dy * dy) / duration;\n    return this.initialVelocity_ > this.minVelocity_;\n  }\n\n  /**\n   * @return {number} Total distance travelled (pixels).\n   */\n  getDistance() {\n    return (this.minVelocity_ - this.initialVelocity_) / this.decay_;\n  }\n\n  /**\n   * @return {number} Angle of the kinetic panning animation (radians).\n   */\n  getAngle() {\n    return this.angle_;\n  }\n}\n\nexport default Kinetic;\n","/**\n * @module ol/interaction/DoubleClickZoom\n */\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport Interaction, {zoomByDelta} from './Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [delta=1] The zoom delta applied on each double click.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom by double-clicking on the map.\n * @api\n */\nclass DoubleClickZoom extends Interaction {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super({\n      handleEvent: handleEvent\n    });\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.delta_ = options.delta ? options.delta : 1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  }\n\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a\n * doubleclick) and eventually zooms the map.\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {DoubleClickZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == MapBrowserEventType.DBLCLICK) {\n    const browserEvent = /** @type {MouseEvent} */ (mapBrowserEvent.originalEvent);\n    const map = mapBrowserEvent.map;\n    const anchor = mapBrowserEvent.coordinate;\n    const delta = browserEvent.shiftKey ? -this.delta_ : this.delta_;\n    const view = map.getView();\n    zoomByDelta(view, delta, anchor, this.duration_);\n    mapBrowserEvent.preventDefault();\n    stopEvent = true;\n  }\n  return !stopEvent;\n}\n\nexport default DoubleClickZoom;\n","/**\n * @module ol/interaction/DragPan\n */\nimport {scale as scaleCoordinate, rotate as rotateCoordinate} from '../coordinate.js';\nimport {easeOut} from '../easing.js';\nimport {noModifierKeys, primaryAction} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from './Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~noModifierKeys} and {@link module:ol/events/condition~primaryAction}.\n * @property {import(\"../Kinetic.js\").default} [kinetic] Kinetic inertia to apply to the pan.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map by dragging the map.\n * @api\n */\nclass DragPan extends PointerInteraction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    super({\n      stopDown: FALSE\n    });\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @private\n     * @type {import(\"../Kinetic.js\").default|undefined}\n     */\n    this.kinetic_ = options.kinetic;\n\n    /**\n     * @type {import(\"../pixel.js\").Pixel}\n     */\n    this.lastCentroid = null;\n\n    /**\n     * @type {number}\n     */\n    this.lastPointersCount_;\n\n    /**\n     * @type {boolean}\n     */\n    this.panning_ = false;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : defaultCondition;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.noKinetic_ = false;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(mapBrowserEvent) {\n    if (!this.panning_) {\n      this.panning_ = true;\n      this.getMap().getView().beginInteraction();\n    }\n    const targetPointers = this.targetPointers;\n    const centroid = centroidFromPointers(targetPointers);\n    if (targetPointers.length == this.lastPointersCount_) {\n      if (this.kinetic_) {\n        this.kinetic_.update(centroid[0], centroid[1]);\n      }\n      if (this.lastCentroid) {\n        const delta = [\n          this.lastCentroid[0] - centroid[0],\n          centroid[1] - this.lastCentroid[1]\n        ];\n        const map = mapBrowserEvent.map;\n        const view = map.getView();\n        scaleCoordinate(delta, view.getResolution());\n        rotateCoordinate(delta, view.getRotation());\n        view.adjustCenterInternal(delta);\n      }\n    } else if (this.kinetic_) {\n      // reset so we don't overestimate the kinetic energy after\n      // after one finger down, tiny drag, second finger down\n      this.kinetic_.begin();\n    }\n    this.lastCentroid = centroid;\n    this.lastPointersCount_ = targetPointers.length;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(mapBrowserEvent) {\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    if (this.targetPointers.length === 0) {\n      if (!this.noKinetic_ && this.kinetic_ && this.kinetic_.end()) {\n        const distance = this.kinetic_.getDistance();\n        const angle = this.kinetic_.getAngle();\n        const center = view.getCenterInternal();\n        const centerpx = map.getPixelFromCoordinateInternal(center);\n        const dest = map.getCoordinateFromPixelInternal([\n          centerpx[0] - distance * Math.cos(angle),\n          centerpx[1] - distance * Math.sin(angle)\n        ]);\n        view.animateInternal({\n          center: view.getConstrainedCenter(dest),\n          duration: 500,\n          easing: easeOut\n        });\n      }\n      if (this.panning_) {\n        this.panning_ = false;\n        view.endInteraction();\n      }\n      return false;\n    } else {\n      if (this.kinetic_) {\n        // reset so we don't overestimate the kinetic energy after\n        // after one finger up, tiny drag, second finger up\n        this.kinetic_.begin();\n      }\n      this.lastCentroid = null;\n      return true;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (this.targetPointers.length > 0 && this.condition_(mapBrowserEvent)) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      this.lastCentroid = null;\n      // stop any current animation\n      if (view.getAnimating()) {\n        view.cancelAnimations();\n      }\n      if (this.kinetic_) {\n        this.kinetic_.begin();\n      }\n      // No kinetic as soon as more than one pointer on the screen is\n      // detected. This is to prevent nasty pans after pinch.\n      this.noKinetic_ = this.targetPointers.length > 1;\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\n/**\n * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Browser event.\n * @return {boolean} Combined condition result.\n */\nfunction defaultCondition(mapBrowserEvent) {\n  return noModifierKeys(mapBrowserEvent) && primaryAction(mapBrowserEvent);\n}\n\nexport default DragPan;\n","/**\n * @module ol/interaction/DragRotate\n */\nimport {disable} from '../rotationconstraint.js';\nimport {altShiftKeysOnly, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {FALSE} from '../functions.js';\nimport PointerInteraction from './Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that takes an\n * {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~altShiftKeysOnly}.\n * @property {number} [duration=250] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the alt and shift keys are held down.\n *\n * This interaction is only supported for mouse devices.\n * @api\n */\nclass DragRotate extends PointerInteraction {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      stopDown: FALSE\n    });\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : altShiftKeysOnly;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastAngle_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return;\n    }\n\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    if (view.getConstraints().rotation === disable) {\n      return;\n    }\n    const size = map.getSize();\n    const offset = mapBrowserEvent.pixel;\n    const theta =\n        Math.atan2(size[1] / 2 - offset[1], offset[0] - size[0] / 2);\n    if (this.lastAngle_ !== undefined) {\n      const delta = theta - this.lastAngle_;\n      view.adjustRotationInternal(-delta);\n    }\n    this.lastAngle_ = theta;\n  }\n\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return true;\n    }\n\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    view.endInteraction(this.duration_);\n    return false;\n  }\n\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return false;\n    }\n\n    if (mouseActionButton(mapBrowserEvent) && this.condition_(mapBrowserEvent)) {\n      const map = mapBrowserEvent.map;\n      map.getView().beginInteraction();\n      this.lastAngle_ = undefined;\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nexport default DragRotate;\n","/**\n * @module ol/interaction/DragZoom\n */\nimport {easeOut} from '../easing.js';\nimport {shiftKeyOnly} from '../events/condition.js';\nimport {createOrUpdateFromCoordinates, getBottomLeft, getCenter, getTopRight, scaleFromCenter} from '../extent.js';\nimport DragBox from './DragBox.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragzoom'] CSS class name for styling the\n * box.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {boolean} [out=false] Use interaction for zooming out.\n * @property {number} [minArea=64] The minimum area of the box in pixel, this value is used by the parent default\n * `boxEndCondition` function.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when a key, shift by default, is held down.\n *\n * To change the style of the box, use CSS and the `.ol-dragzoom` selector, or\n * your custom one configured with `className`.\n * @api\n */\nclass DragZoom extends DragBox {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const condition = options.condition ? options.condition : shiftKeyOnly;\n\n    super({\n      condition: condition,\n      className: options.className || 'ol-dragzoom',\n      minArea: options.minArea,\n      onBoxEnd: onBoxEnd\n    });\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.out_ = options.out !== undefined ? options.out : false;\n  }\n}\n\n\n/**\n * @this {DragZoom}\n */\nfunction onBoxEnd() {\n  const map = this.getMap();\n  const view = /** @type {!import(\"../View.js\").default} */ (map.getView());\n  const size = /** @type {!import(\"../size.js\").Size} */ (map.getSize());\n  let extent = this.getGeometry().getExtent();\n\n  if (this.out_) {\n    const mapExtent = view.calculateExtentInternal(size);\n    const boxPixelExtent = createOrUpdateFromCoordinates([\n      map.getPixelFromCoordinateInternal(getBottomLeft(extent)),\n      map.getPixelFromCoordinateInternal(getTopRight(extent))]);\n    const factor = view.getResolutionForExtentInternal(boxPixelExtent, size);\n\n    scaleFromCenter(mapExtent, 1 / factor);\n    extent = mapExtent;\n  }\n\n  const resolution = view.getConstrainedResolution(view.getResolutionForExtentInternal(extent, size));\n  const center = view.getConstrainedCenter(getCenter(extent), resolution);\n\n  view.animateInternal({\n    resolution: resolution,\n    center: center,\n    duration: this.duration_,\n    easing: easeOut\n  });\n}\n\n\nexport default DragZoom;\n","/**\n * @module ol/events/KeyCode\n */\n\n/**\n * @enum {number}\n * @const\n */\nexport default {\n  LEFT: 37,\n  UP: 38,\n  RIGHT: 39,\n  DOWN: 40\n};\n","/**\n * @module ol/interaction/KeyboardPan\n */\nimport {rotate as rotateCoordinate} from '../coordinate.js';\nimport EventType from '../events/EventType.js';\nimport KeyCode from '../events/KeyCode.js';\nimport {noModifierKeys, targetNotEditable} from '../events/condition.js';\nimport Interaction, {pan} from './Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~noModifierKeys} and\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {number} [pixelDelta=128] The amount of pixels to pan on each key\n * press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to pan the map using keyboard arrows.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}.\n * @api\n */\nclass KeyboardPan extends Interaction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    super({\n      handleEvent: handleEvent\n    });\n\n    const options = opt_options || {};\n\n    /**\n     * @private\n     * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Browser event.\n     * @return {boolean} Combined condition result.\n     */\n    this.defaultCondition_ = function(mapBrowserEvent) {\n      return noModifierKeys(mapBrowserEvent) &&\n        targetNotEditable(mapBrowserEvent);\n    };\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition !== undefined ?\n      options.condition : this.defaultCondition_;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelDelta_ = options.pixelDelta !== undefined ?\n      options.pixelDelta : 128;\n\n  }\n\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides the direction to pan to (if an arrow key was\n * pressed).\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {KeyboardPan}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN) {\n    const keyEvent = /** @type {KeyboardEvent} */ (mapBrowserEvent.originalEvent);\n    const keyCode = keyEvent.keyCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (keyCode == KeyCode.DOWN ||\n        keyCode == KeyCode.LEFT ||\n        keyCode == KeyCode.RIGHT ||\n        keyCode == KeyCode.UP)) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      const mapUnitsDelta = view.getResolution() * this.pixelDelta_;\n      let deltaX = 0, deltaY = 0;\n      if (keyCode == KeyCode.DOWN) {\n        deltaY = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.LEFT) {\n        deltaX = -mapUnitsDelta;\n      } else if (keyCode == KeyCode.RIGHT) {\n        deltaX = mapUnitsDelta;\n      } else {\n        deltaY = mapUnitsDelta;\n      }\n      const delta = [deltaX, deltaY];\n      rotateCoordinate(delta, view.getRotation());\n      pan(view, delta, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardPan;\n","/**\n * @module ol/interaction/KeyboardZoom\n */\nimport EventType from '../events/EventType.js';\nimport {targetNotEditable} from '../events/condition.js';\nimport Interaction, {zoomByDelta} from './Interaction.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=100] Animation duration in milliseconds.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~targetNotEditable}.\n * @property {number} [delta=1] The zoom level delta on each key press.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map using keyboard + and -.\n * Note that, although this interaction is by default included in maps,\n * the keys can only be used when browser focus is on the element to which\n * the keyboard events are attached. By default, this is the map div,\n * though you can change this with the `keyboardEventTarget` in\n * {@link module:ol/Map~Map}. `document` never loses focus but, for any other\n * element, focus will have to be on, and returned to, this element if the keys\n * are to function.\n * See also {@link module:ol/interaction/KeyboardPan~KeyboardPan}.\n * @api\n */\nclass KeyboardZoom extends Interaction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    super({\n      handleEvent: handleEvent\n    });\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : targetNotEditable;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.delta_ = options.delta ? options.delta : 1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 100;\n\n  }\n\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} if it was a\n * `KeyEvent`, and decides whether to zoom in or out (depending on whether the\n * key pressed was '+' or '-').\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {KeyboardZoom}\n */\nfunction handleEvent(mapBrowserEvent) {\n  let stopEvent = false;\n  if (mapBrowserEvent.type == EventType.KEYDOWN ||\n      mapBrowserEvent.type == EventType.KEYPRESS) {\n    const keyEvent = /** @type {KeyboardEvent} */ (mapBrowserEvent.originalEvent);\n    const charCode = keyEvent.charCode;\n    if (this.condition_(mapBrowserEvent) &&\n        (charCode == '+'.charCodeAt(0) || charCode == '-'.charCodeAt(0))) {\n      const map = mapBrowserEvent.map;\n      const delta = (charCode == '+'.charCodeAt(0)) ? this.delta_ : -this.delta_;\n      const view = map.getView();\n      zoomByDelta(view, delta, undefined, this.duration_);\n      mapBrowserEvent.preventDefault();\n      stopEvent = true;\n    }\n  }\n  return !stopEvent;\n}\n\nexport default KeyboardZoom;\n","/**\n * @module ol/interaction/MouseWheelZoom\n */\nimport {always} from '../events/condition.js';\nimport EventType from '../events/EventType.js';\nimport {DEVICE_PIXEL_RATIO, FIREFOX} from '../has.js';\nimport Interaction, {zoomByDelta} from './Interaction.js';\nimport {clamp} from '../math.js';\n\n\n/**\n * @enum {string}\n */\nexport const Mode = {\n  TRACKPAD: 'trackpad',\n  WHEEL: 'wheel'\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. Default is\n * {@link module:ol/events/condition~always}.\n * @property {number} [maxDelta=1] Maximum mouse wheel delta.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {number} [timeout=80] Mouse wheel timeout duration in milliseconds.\n * @property {boolean} [useAnchor=true] Enable zooming using the mouse's\n * location as the anchor. When set to `false`, zooming in and out will zoom to\n * the center of the screen instead of zooming on the mouse's location.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by scrolling the mouse wheel.\n * @api\n */\nclass MouseWheelZoom extends Interaction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super(/** @type {import(\"./Interaction.js\").InteractionOptions} */ (options));\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.totalDelta_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.lastDelta_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDelta_ = options.maxDelta !== undefined ? options.maxDelta : 1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.timeout_ = options.timeout !== undefined ? options.timeout : 80;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.useAnchor_ = options.useAnchor !== undefined ? options.useAnchor : true;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : always;\n\n    /**\n     * @private\n     * @type {?import(\"../coordinate.js\").Coordinate}\n     */\n    this.lastAnchor_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.startTime_ = undefined;\n\n    /**\n     * @private\n     * @type {?}\n     */\n    this.timeoutId_;\n\n    /**\n     * @private\n     * @type {Mode|undefined}\n     */\n    this.mode_ = undefined;\n\n    /**\n     * Trackpad events separated by this delay will be considered separate\n     * interactions.\n     * @type {number}\n     */\n    this.trackpadEventGap_ = 400;\n\n    /**\n     * @type {?}\n     */\n    this.trackpadTimeoutId_;\n\n    /**\n     * The number of delta values per zoom level\n     * @private\n     * @type {number}\n     */\n    this.trackpadDeltaPerZoom_ = 300;\n\n  }\n\n  /**\n   * @private\n   */\n  endInteraction_() {\n    this.trackpadTimeoutId_ = undefined;\n    const view = this.getMap().getView();\n    view.endInteraction(undefined, Math.sign(this.lastDelta_), this.lastAnchor_);\n  }\n\n  /**\n   * Handles the {@link module:ol/MapBrowserEvent map browser event} (if it was a mousewheel-event) and eventually\n   * zooms the map.\n   * @override\n   */\n  handleEvent(mapBrowserEvent) {\n    if (!this.condition_(mapBrowserEvent)) {\n      return true;\n    }\n    const type = mapBrowserEvent.type;\n    if (type !== EventType.WHEEL) {\n      return true;\n    }\n\n    mapBrowserEvent.preventDefault();\n\n    const map = mapBrowserEvent.map;\n    const wheelEvent = /** @type {WheelEvent} */ (mapBrowserEvent.originalEvent);\n\n    if (this.useAnchor_) {\n      this.lastAnchor_ = mapBrowserEvent.coordinate;\n    }\n\n    // Delta normalisation inspired by\n    // https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n    let delta;\n    if (mapBrowserEvent.type == EventType.WHEEL) {\n      delta = wheelEvent.deltaY;\n      if (FIREFOX &&\n          wheelEvent.deltaMode === WheelEvent.DOM_DELTA_PIXEL) {\n        delta /= DEVICE_PIXEL_RATIO;\n      }\n      if (wheelEvent.deltaMode === WheelEvent.DOM_DELTA_LINE) {\n        delta *= 40;\n      }\n    }\n\n    if (delta === 0) {\n      return false;\n    } else {\n      this.lastDelta_ = delta;\n    }\n\n    const now = Date.now();\n\n    if (this.startTime_ === undefined) {\n      this.startTime_ = now;\n    }\n\n    if (!this.mode_ || now - this.startTime_ > this.trackpadEventGap_) {\n      this.mode_ = Math.abs(delta) < 4 ?\n        Mode.TRACKPAD :\n        Mode.WHEEL;\n    }\n\n    if (this.mode_ === Mode.TRACKPAD) {\n      const view = map.getView();\n      if (this.trackpadTimeoutId_) {\n        clearTimeout(this.trackpadTimeoutId_);\n      } else {\n        view.beginInteraction();\n      }\n      this.trackpadTimeoutId_ = setTimeout(this.endInteraction_.bind(this), this.trackpadEventGap_);\n      view.adjustZoom(-delta / this.trackpadDeltaPerZoom_, this.lastAnchor_);\n      this.startTime_ = now;\n      return false;\n    }\n\n    this.totalDelta_ += delta;\n\n    const timeLeft = Math.max(this.timeout_ - (now - this.startTime_), 0);\n\n    clearTimeout(this.timeoutId_);\n    this.timeoutId_ = setTimeout(this.handleWheelZoom_.bind(this, map), timeLeft);\n\n    return false;\n  }\n\n  /**\n   * @private\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n  handleWheelZoom_(map) {\n    const view = map.getView();\n    if (view.getAnimating()) {\n      view.cancelAnimations();\n    }\n    const delta = clamp(this.totalDelta_, -this.maxDelta_, this.maxDelta_);\n    zoomByDelta(view, -delta, this.lastAnchor_, this.duration_);\n    this.mode_ = undefined;\n    this.totalDelta_ = 0;\n    this.lastAnchor_ = null;\n    this.startTime_ = undefined;\n    this.timeoutId_ = undefined;\n  }\n\n  /**\n   * Enable or disable using the mouse's location as an anchor when zooming\n   * @param {boolean} useAnchor true to zoom to the mouse's location, false\n   * to zoom to the center of the map\n   * @api\n   */\n  setMouseAnchor(useAnchor) {\n    this.useAnchor_ = useAnchor;\n    if (!useAnchor) {\n      this.lastAnchor_ = null;\n    }\n  }\n}\n\nexport default MouseWheelZoom;\n","/**\n * @module ol/interaction/PinchRotate\n */\nimport {FALSE} from '../functions.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from './Pointer.js';\nimport {disable} from '../rotationconstraint.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] The duration of the animation in\n * milliseconds.\n * @property {number} [threshold=0.3] Minimal angle in radians to start a rotation.\n */\n\n\n/**\n * @classdesc\n * Allows the user to rotate the map by twisting with two fingers\n * on a touch screen.\n * @api\n */\nclass PinchRotate extends PointerInteraction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    const pointerOptions = /** @type {import(\"./Pointer.js\").Options} */ (options);\n\n    if (!pointerOptions.stopDown) {\n      pointerOptions.stopDown = FALSE;\n    }\n\n    super(pointerOptions);\n\n    /**\n     * @private\n     * @type {import(\"../coordinate.js\").Coordinate}\n     */\n    this.anchor_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastAngle_ = undefined;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.rotating_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.rotationDelta_ = 0.0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.threshold_ = options.threshold !== undefined ? options.threshold : 0.3;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(mapBrowserEvent) {\n    let rotationDelta = 0.0;\n\n    const touch0 = this.targetPointers[0];\n    const touch1 = this.targetPointers[1];\n\n    // angle between touches\n    const angle = Math.atan2(\n      touch1.clientY - touch0.clientY,\n      touch1.clientX - touch0.clientX);\n\n    if (this.lastAngle_ !== undefined) {\n      const delta = angle - this.lastAngle_;\n      this.rotationDelta_ += delta;\n      if (!this.rotating_ &&\n          Math.abs(this.rotationDelta_) > this.threshold_) {\n        this.rotating_ = true;\n      }\n      rotationDelta = delta;\n    }\n    this.lastAngle_ = angle;\n\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    if (view.getConstraints().rotation === disable) {\n      return;\n    }\n\n    // rotate anchor point.\n    // FIXME: should be the intersection point between the lines:\n    //     touch0,touch1 and previousTouch0,previousTouch1\n    const viewportPosition = map.getViewport().getBoundingClientRect();\n    const centroid = centroidFromPointers(this.targetPointers);\n    centroid[0] -= viewportPosition.left;\n    centroid[1] -= viewportPosition.top;\n    this.anchor_ = map.getCoordinateFromPixelInternal(centroid);\n\n    // rotate\n    if (this.rotating_) {\n      map.render();\n      view.adjustRotationInternal(rotationDelta, this.anchor_);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(mapBrowserEvent) {\n    if (this.targetPointers.length < 2) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      view.endInteraction(this.duration_);\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (this.targetPointers.length >= 2) {\n      const map = mapBrowserEvent.map;\n      this.anchor_ = null;\n      this.lastAngle_ = undefined;\n      this.rotating_ = false;\n      this.rotationDelta_ = 0.0;\n      if (!this.handlingDownUpSequence) {\n        map.getView().beginInteraction();\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nexport default PinchRotate;\n","/**\n * @module ol/interaction\n */\nimport Collection from './Collection.js';\nimport Kinetic from './Kinetic.js';\nimport DoubleClickZoom from './interaction/DoubleClickZoom.js';\nimport DragPan from './interaction/DragPan.js';\nimport DragRotate from './interaction/DragRotate.js';\nimport DragZoom from './interaction/DragZoom.js';\nimport KeyboardPan from './interaction/KeyboardPan.js';\nimport KeyboardZoom from './interaction/KeyboardZoom.js';\nimport MouseWheelZoom from './interaction/MouseWheelZoom.js';\nimport PinchRotate from './interaction/PinchRotate.js';\nimport PinchZoom from './interaction/PinchZoom.js';\nimport {focus} from './events/condition.js';\n\nexport {default as DoubleClickZoom} from './interaction/DoubleClickZoom.js';\nexport {default as DragAndDrop} from './interaction/DragAndDrop.js';\nexport {default as DragBox} from './interaction/DragBox.js';\nexport {default as DragPan} from './interaction/DragPan.js';\nexport {default as DragRotate} from './interaction/DragRotate.js';\nexport {default as DragRotateAndZoom} from './interaction/DragRotateAndZoom.js';\nexport {default as DragZoom} from './interaction/DragZoom.js';\nexport {default as Draw} from './interaction/Draw.js';\nexport {default as Extent} from './interaction/Extent.js';\nexport {default as Interaction} from './interaction/Interaction.js';\nexport {default as KeyboardPan} from './interaction/KeyboardPan.js';\nexport {default as KeyboardZoom} from './interaction/KeyboardZoom.js';\nexport {default as Modify} from './interaction/Modify.js';\nexport {default as MouseWheelZoom} from './interaction/MouseWheelZoom.js';\nexport {default as PinchRotate} from './interaction/PinchRotate.js';\nexport {default as PinchZoom} from './interaction/PinchZoom.js';\nexport {default as Pointer} from './interaction/Pointer.js';\nexport {default as Select} from './interaction/Select.js';\nexport {default as Snap} from './interaction/Snap.js';\nexport {default as Translate} from './interaction/Translate.js';\n\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [altShiftDragRotate=true] Whether Alt-Shift-drag rotate is\n * desired.\n * @property {boolean} [onFocusOnly=false] Interact only when the map has the\n * focus. This affects the `MouseWheelZoom` and `DragPan` interactions and is\n * useful when page scroll is desired for maps that do not have the browser's\n * focus.\n * @property {boolean} [doubleClickZoom=true] Whether double click zoom is\n * desired.\n * @property {boolean} [keyboard=true] Whether keyboard interaction is desired.\n * @property {boolean} [mouseWheelZoom=true] Whether mousewheel zoom is desired.\n * @property {boolean} [shiftDragZoom=true] Whether Shift-drag zoom is desired.\n * @property {boolean} [dragPan=true] Whether drag pan is desired.\n * @property {boolean} [pinchRotate=true] Whether pinch rotate is desired.\n * @property {boolean} [pinchZoom=true] Whether pinch zoom is desired.\n * @property {number} [zoomDelta] Zoom level delta when using keyboard or double click zoom.\n * @property {number} [zoomDuration] Duration of the zoom animation in\n * milliseconds.\n */\n\n\n/**\n * Set of interactions included in maps by default. Specific interactions can be\n * excluded by setting the appropriate option to false in the constructor\n * options, but the order of the interactions is fixed.  If you want to specify\n * a different order for interactions, you will need to create your own\n * {@link module:ol/interaction/Interaction} instances and insert\n * them into a {@link module:ol/Collection} in the order you want\n * before creating your {@link module:ol/Map~Map} instance. Changing the order can\n * be of interest if the event propagation needs to be stopped at a point.\n * The default set of interactions, in sequence, is:\n * * {@link module:ol/interaction/DragRotate~DragRotate}\n * * {@link module:ol/interaction/DoubleClickZoom~DoubleClickZoom}\n * * {@link module:ol/interaction/DragPan~DragPan}\n * * {@link module:ol/interaction/PinchRotate~PinchRotate}\n * * {@link module:ol/interaction/PinchZoom~PinchZoom}\n * * {@link module:ol/interaction/KeyboardPan~KeyboardPan}\n * * {@link module:ol/interaction/KeyboardZoom~KeyboardZoom}\n * * {@link module:ol/interaction/MouseWheelZoom~MouseWheelZoom}\n * * {@link module:ol/interaction/DragZoom~DragZoom}\n *\n * @param {DefaultsOptions=} opt_options Defaults options.\n * @return {import(\"./Collection.js\").default<import(\"./interaction/Interaction.js\").default>}\n * A collection of interactions to be used with the {@link module:ol/Map~Map}\n * constructor's `interactions` option.\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const interactions = new Collection();\n\n  const kinetic = new Kinetic(-0.005, 0.05, 100);\n\n  const altShiftDragRotate = options.altShiftDragRotate !== undefined ?\n    options.altShiftDragRotate : true;\n  if (altShiftDragRotate) {\n    interactions.push(new DragRotate());\n  }\n\n  const doubleClickZoom = options.doubleClickZoom !== undefined ?\n    options.doubleClickZoom : true;\n  if (doubleClickZoom) {\n    interactions.push(new DoubleClickZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const dragPan = options.dragPan !== undefined ? options.dragPan : true;\n  if (dragPan) {\n    interactions.push(new DragPan({\n      condition: options.onFocusOnly ? focus : undefined,\n      kinetic: kinetic\n    }));\n  }\n\n  const pinchRotate = options.pinchRotate !== undefined ? options.pinchRotate :\n    true;\n  if (pinchRotate) {\n    interactions.push(new PinchRotate());\n  }\n\n  const pinchZoom = options.pinchZoom !== undefined ? options.pinchZoom : true;\n  if (pinchZoom) {\n    interactions.push(new PinchZoom({\n      duration: options.zoomDuration\n    }));\n  }\n\n  const keyboard = options.keyboard !== undefined ? options.keyboard : true;\n  if (keyboard) {\n    interactions.push(new KeyboardPan());\n    interactions.push(new KeyboardZoom({\n      delta: options.zoomDelta,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const mouseWheelZoom = options.mouseWheelZoom !== undefined ?\n    options.mouseWheelZoom : true;\n  if (mouseWheelZoom) {\n    interactions.push(new MouseWheelZoom({\n      condition: options.onFocusOnly ? focus : undefined,\n      duration: options.zoomDuration\n    }));\n  }\n\n  const shiftDragZoom = options.shiftDragZoom !== undefined ?\n    options.shiftDragZoom : true;\n  if (shiftDragZoom) {\n    interactions.push(new DragZoom({\n      duration: options.zoomDuration\n    }));\n  }\n\n  return interactions;\n\n}\n","/**\n * @module ol/control/Rotate\n */\nimport Control from './Control.js';\nimport {CLASS_CONTROL, CLASS_HIDDEN, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-rotate'] CSS class name.\n * @property {string|HTMLElement} [label='⇧'] Text label to use for the rotate button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Reset rotation'] Text label to use for the rotate tip.\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {boolean} [autoHide=true] Hide the control when rotation is 0.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when the control should\n * be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {function()} [resetNorth] Function called when the control is clicked.\n * This will override the default `resetNorth`.\n * @property {HTMLElement|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A button control to reset rotation to 0.\n * To style this control use css selector `.ol-rotate`. A `.ol-hidden` css\n * selector is added to the button when the rotation is 0.\n *\n * @api\n */\nclass Rotate extends Control {\n\n  /**\n   * @param {Options=} opt_options Rotate options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      element: document.createElement('div'),\n      render: options.render || render,\n      target: options.target\n    });\n\n    const className = options.className !== undefined ? options.className : 'ol-rotate';\n\n    const label = options.label !== undefined ? options.label : '\\u21E7';\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     */\n    this.label_ = null;\n\n    if (typeof label === 'string') {\n      this.label_ = document.createElement('span');\n      this.label_.className = 'ol-compass';\n      this.label_.textContent = label;\n    } else {\n      this.label_ = label;\n      this.label_.classList.add('ol-compass');\n    }\n\n    const tipLabel = options.tipLabel ? options.tipLabel : 'Reset rotation';\n\n    const button = document.createElement('button');\n    button.className = className + '-reset';\n    button.setAttribute('type', 'button');\n    button.title = tipLabel;\n    button.appendChild(this.label_);\n\n    button.addEventListener(EventType.CLICK, this.handleClick_.bind(this), false);\n\n    const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n    const element = this.element;\n    element.className = cssClasses;\n    element.appendChild(button);\n\n    this.callResetNorth_ = options.resetNorth ? options.resetNorth : undefined;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.autoHide_ = options.autoHide !== undefined ? options.autoHide : true;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.rotation_ = undefined;\n\n    if (this.autoHide_) {\n      this.element.classList.add(CLASS_HIDDEN);\n    }\n\n  }\n\n  /**\n   * @param {MouseEvent} event The event to handle\n   * @private\n   */\n  handleClick_(event) {\n    event.preventDefault();\n    if (this.callResetNorth_ !== undefined) {\n      this.callResetNorth_();\n    } else {\n      this.resetNorth_();\n    }\n  }\n\n  /**\n   * @private\n   */\n  resetNorth_() {\n    const map = this.getMap();\n    const view = map.getView();\n    if (!view) {\n      // the map does not have a view, so we can't act\n      // upon it\n      return;\n    }\n    if (view.getRotation() !== undefined) {\n      if (this.duration_ > 0) {\n        view.animate({\n          rotation: 0,\n          duration: this.duration_,\n          easing: easeOut\n        });\n      } else {\n        view.setRotation(0);\n      }\n    }\n  }\n}\n\n\n/**\n * Update the rotate control element.\n * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n * @this {Rotate}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    return;\n  }\n  const rotation = frameState.viewState.rotation;\n  if (rotation != this.rotation_) {\n    const transform = 'rotate(' + rotation + 'rad)';\n    if (this.autoHide_) {\n      const contains = this.element.classList.contains(CLASS_HIDDEN);\n      if (!contains && rotation === 0) {\n        this.element.classList.add(CLASS_HIDDEN);\n      } else if (contains && rotation !== 0) {\n        this.element.classList.remove(CLASS_HIDDEN);\n      }\n    }\n    this.label_.style.transform = transform;\n  }\n  this.rotation_ = rotation;\n}\n\nexport default Rotate;\n","/**\n * @module ol/control/Zoom\n */\nimport EventType from '../events/EventType.js';\nimport Control from './Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=250] Animation duration in milliseconds.\n * @property {string} [className='ol-zoom'] CSS class name.\n * @property {string|HTMLElement} [zoomInLabel='+'] Text label to use for the zoom-in\n * button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|HTMLElement} [zoomOutLabel='-'] Text label to use for the zoom-out button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [zoomInTipLabel='Zoom in'] Text label to use for the button tip.\n * @property {string} [zoomOutTipLabel='Zoom out'] Text label to use for the button tip.\n * @property {number} [delta=1] The zoom delta applied on each click.\n * @property {HTMLElement|string} [target] Specify a target if you want the control to be\n * rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control with 2 buttons, one for zoom in and one for zoom out.\n * This control is one of the default controls of a map. To style this control\n * use css selectors `.ol-zoom-in` and `.ol-zoom-out`.\n *\n * @api\n */\nclass Zoom extends Control {\n\n  /**\n   * @param {Options=} opt_options Zoom options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      element: document.createElement('div'),\n      target: options.target\n    });\n\n    const className = options.className !== undefined ? options.className : 'ol-zoom';\n\n    const delta = options.delta !== undefined ? options.delta : 1;\n\n    const zoomInLabel = options.zoomInLabel !== undefined ? options.zoomInLabel : '+';\n    const zoomOutLabel = options.zoomOutLabel !== undefined ? options.zoomOutLabel : '\\u2212';\n\n    const zoomInTipLabel = options.zoomInTipLabel !== undefined ?\n      options.zoomInTipLabel : 'Zoom in';\n    const zoomOutTipLabel = options.zoomOutTipLabel !== undefined ?\n      options.zoomOutTipLabel : 'Zoom out';\n\n    const inElement = document.createElement('button');\n    inElement.className = className + '-in';\n    inElement.setAttribute('type', 'button');\n    inElement.title = zoomInTipLabel;\n    inElement.appendChild(\n      typeof zoomInLabel === 'string' ? document.createTextNode(zoomInLabel) : zoomInLabel\n    );\n\n    inElement.addEventListener(EventType.CLICK, this.handleClick_.bind(this, delta), false);\n\n    const outElement = document.createElement('button');\n    outElement.className = className + '-out';\n    outElement.setAttribute('type', 'button');\n    outElement.title = zoomOutTipLabel;\n    outElement.appendChild(\n      typeof zoomOutLabel === 'string' ? document.createTextNode(zoomOutLabel) : zoomOutLabel\n    );\n\n    outElement.addEventListener(EventType.CLICK, this.handleClick_.bind(this, -delta), false);\n\n    const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n    const element = this.element;\n    element.className = cssClasses;\n    element.appendChild(inElement);\n    element.appendChild(outElement);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 250;\n\n  }\n\n  /**\n   * @param {number} delta Zoom delta.\n   * @param {MouseEvent} event The event to handle\n   * @private\n   */\n  handleClick_(delta, event) {\n    event.preventDefault();\n    this.zoomByDelta_(delta);\n  }\n\n  /**\n   * @param {number} delta Zoom delta.\n   * @private\n   */\n  zoomByDelta_(delta) {\n    const map = this.getMap();\n    const view = map.getView();\n    if (!view) {\n      // the map does not have a view, so we can't act\n      // upon it\n      return;\n    }\n    const currentZoom = view.getZoom();\n    if (currentZoom !== undefined) {\n      const newZoom = view.getConstrainedZoom(currentZoom + delta);\n      if (this.duration_ > 0) {\n        if (view.getAnimating()) {\n          view.cancelAnimations();\n        }\n        view.animate({\n          zoom: newZoom,\n          duration: this.duration_,\n          easing: easeOut\n        });\n      } else {\n        view.setZoom(newZoom);\n      }\n    }\n  }\n}\n\n\nexport default Zoom;\n","/**\n * @module ol/control\n */\nimport Collection from './Collection.js';\nimport Attribution from './control/Attribution.js';\nimport Rotate from './control/Rotate.js';\nimport Zoom from './control/Zoom.js';\n\nexport {default as Attribution} from './control/Attribution.js';\nexport {default as Control} from './control/Control.js';\nexport {default as FullScreen} from './control/FullScreen.js';\nexport {default as MousePosition} from './control/MousePosition.js';\nexport {default as OverviewMap} from './control/OverviewMap.js';\nexport {default as Rotate} from './control/Rotate.js';\nexport {default as ScaleLine} from './control/ScaleLine.js';\nexport {default as Zoom} from './control/Zoom.js';\nexport {default as ZoomSlider} from './control/ZoomSlider.js';\nexport {default as ZoomToExtent} from './control/ZoomToExtent.js';\n\n/**\n * @typedef {Object} DefaultsOptions\n * @property {boolean} [attribution=true] Include\n * {@link module:ol/control/Attribution~Attribution}.\n * @property {import(\"./control/Attribution.js\").Options} [attributionOptions]\n * Options for {@link module:ol/control/Attribution~Attribution}.\n * @property {boolean} [rotate=true] Include\n * {@link module:ol/control/Rotate~Rotate}.\n * @property {import(\"./control/Rotate.js\").Options} [rotateOptions] Options\n * for {@link module:ol/control/Rotate~Rotate}.\n * @property {boolean} [zoom] Include {@link module:ol/control/Zoom~Zoom}.\n * @property {import(\"./control/Zoom.js\").Options} [zoomOptions] Options for\n * {@link module:ol/control/Zoom~Zoom}.\n * @api\n */\n\n\n/**\n * Set of controls included in maps by default. Unless configured otherwise,\n * this returns a collection containing an instance of each of the following\n * controls:\n * * {@link module:ol/control/Zoom~Zoom}\n * * {@link module:ol/control/Rotate~Rotate}\n * * {@link module:ol/control/Attribution~Attribution}\n *\n * @param {DefaultsOptions=} opt_options\n * Defaults options.\n * @return {Collection<import(\"./control/Control.js\").default>}\n * Controls.\n * @api\n */\nexport function defaults(opt_options) {\n\n  const options = opt_options ? opt_options : {};\n\n  const controls = new Collection();\n\n  const zoomControl = options.zoom !== undefined ? options.zoom : true;\n  if (zoomControl) {\n    controls.push(new Zoom(options.zoomOptions));\n  }\n\n  const rotateControl = options.rotate !== undefined ? options.rotate : true;\n  if (rotateControl) {\n    controls.push(new Rotate(options.rotateOptions));\n  }\n\n  const attributionControl = options.attribution !== undefined ?\n    options.attribution : true;\n  if (attributionControl) {\n    controls.push(new Attribution(options.attributionOptions));\n  }\n\n  return controls;\n}\n","/**\n * @module ol/format/GMLBase\n */\n// FIXME Envelopes should not be treated as geometries! readEnvelope_ is part\n// of GEOMETRY_PARSERS_ and methods using GEOMETRY_PARSERS_ do not expect\n// envelopes/extents, only geometries!\nimport {extend} from '../array.js';\nimport Feature from '../Feature.js';\nimport {transformGeometryWithOptions, transformExtentWithOptions} from './Feature.js';\nimport XMLFeature from './XMLFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport {getAllTextContent, getAttributeNS, makeArrayPusher, makeReplacer, parseNode, pushParseAndPop} from '../xml.js';\n\n\n/**\n * @const\n * @type {string}\n */\nexport const GMLNS = 'http://www.opengis.net/gml';\n\n\n/**\n * A regular expression that matches if a string only contains whitespace\n * characters. It will e.g. match `''`, `' '`, `'\\n'` etc. The non-breaking\n * space (0xa0) is explicitly included as IE doesn't include it in its\n * definition of `\\s`.\n *\n * Information from `goog.string.isEmptyOrWhitespace`: https://github.com/google/closure-library/blob/e877b1e/closure/goog/string/string.js#L156-L160\n *\n * @const\n * @type {RegExp}\n */\nconst ONLY_WHITESPACE_RE = /^[\\s\\xa0]*$/;\n\n\n/**\n * @typedef {Object} Options\n * @property {Object<string, string>|string} [featureNS] Feature\n * namespace. If not defined will be derived from GML. If multiple\n * feature types have been configured which come from different feature\n * namespaces, this will be an object with the keys being the prefixes used\n * in the entries of featureType array. The values of the object will be the\n * feature namespaces themselves. So for instance there might be a featureType\n * item `topp:states` in the `featureType` array and then there will be a key\n * `topp` in the featureNS object with value `http://www.openplans.org/topp`.\n * @property {Array<string>|string} [featureType] Feature type(s) to parse.\n * If multiple feature types need to be configured\n * which come from different feature namespaces, `featureNS` will be an object\n * with the keys being the prefixes used in the entries of featureType array.\n * The values of the object will be the feature namespaces themselves.\n * So for instance there might be a featureType item `topp:states` and then\n * there will be a key named `topp` in the featureNS object with value\n * `http://www.openplans.org/topp`.\n * @property {string} srsName srsName to use when writing geometries.\n * @property {boolean} [surface=false] Write gml:Surface instead of gml:Polygon\n * elements. This also affects the elements in multi-part geometries.\n * @property {boolean} [curve=false] Write gml:Curve instead of gml:LineString\n * elements. This also affects the elements in multi-part geometries.\n * @property {boolean} [multiCurve=true] Write gml:MultiCurve instead of gml:MultiLineString.\n * Since the latter is deprecated in GML 3.\n * @property {boolean} [multiSurface=true] Write gml:multiSurface instead of\n * gml:MultiPolygon. Since the latter is deprecated in GML 3.\n * @property {string} [schemaLocation] Optional schemaLocation to use when\n * writing out the GML, this will override the default provided.\n * @property {boolean} [hasZ=false] If coordinates have a Z value.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Feature base format for reading and writing data in the GML format.\n * This class cannot be instantiated, it contains only base content that\n * is shared with versioned format classes GML2 and GML3.\n *\n * @abstract\n */\nclass GMLBase extends XMLFeature {\n\n  /**\n   * @param {Options=} opt_options Optional configuration object.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = /** @type {Options} */ (opt_options ? opt_options : {});\n\n    /**\n     * @protected\n     * @type {Array<string>|string|undefined}\n     */\n    this.featureType = options.featureType;\n\n    /**\n     * @protected\n     * @type {Object<string, string>|string|undefined}\n     */\n    this.featureNS = options.featureNS;\n\n    /**\n     * @protected\n     * @type {string}\n     */\n    this.srsName = options.srsName;\n\n    /**\n     * @protected\n     * @type {string}\n     */\n    this.schemaLocation = '';\n\n    /**\n     * @type {Object<string, Object<string, Object>>}\n     */\n    this.FEATURE_COLLECTION_PARSERS = {};\n    this.FEATURE_COLLECTION_PARSERS[this.namespace] = {\n      'featureMember': makeArrayPusher(this.readFeaturesInternal),\n      'featureMembers': makeReplacer(this.readFeaturesInternal)\n    };\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {Array<Feature> | undefined} Features.\n   */\n  readFeaturesInternal(node, objectStack) {\n    const localName = node.localName;\n    let features = null;\n    if (localName == 'FeatureCollection') {\n      features = pushParseAndPop([],\n        this.FEATURE_COLLECTION_PARSERS, node,\n        objectStack, this);\n    } else if (localName == 'featureMembers' || localName == 'featureMember') {\n      const context = objectStack[0];\n      let featureType = context['featureType'];\n      let featureNS = context['featureNS'];\n      const prefix = 'p';\n      const defaultPrefix = 'p0';\n      if (!featureType && node.childNodes) {\n        featureType = [], featureNS = {};\n        for (let i = 0, ii = node.childNodes.length; i < ii; ++i) {\n          const child = node.childNodes[i];\n          if (child.nodeType === 1) {\n            const ft = child.nodeName.split(':').pop();\n            if (featureType.indexOf(ft) === -1) {\n              let key = '';\n              let count = 0;\n              const uri = child.namespaceURI;\n              for (const candidate in featureNS) {\n                if (featureNS[candidate] === uri) {\n                  key = candidate;\n                  break;\n                }\n                ++count;\n              }\n              if (!key) {\n                key = prefix + count;\n                featureNS[key] = uri;\n              }\n              featureType.push(key + ':' + ft);\n            }\n          }\n        }\n        if (localName != 'featureMember') {\n          // recheck featureType for each featureMember\n          context['featureType'] = featureType;\n          context['featureNS'] = featureNS;\n        }\n      }\n      if (typeof featureNS === 'string') {\n        const ns = featureNS;\n        featureNS = {};\n        featureNS[defaultPrefix] = ns;\n      }\n      /** @type {Object<string, Object<string, import(\"../xml.js\").Parser>>} */\n      const parsersNS = {};\n      const featureTypes = Array.isArray(featureType) ? featureType : [featureType];\n      for (const p in featureNS) {\n        /** @type {Object<string, import(\"../xml.js\").Parser>} */\n        const parsers = {};\n        for (let i = 0, ii = featureTypes.length; i < ii; ++i) {\n          const featurePrefix = featureTypes[i].indexOf(':') === -1 ?\n            defaultPrefix : featureTypes[i].split(':')[0];\n          if (featurePrefix === p) {\n            parsers[featureTypes[i].split(':').pop()] =\n                (localName == 'featureMembers') ?\n                  makeArrayPusher(this.readFeatureElement, this) :\n                  makeReplacer(this.readFeatureElement, this);\n          }\n        }\n        parsersNS[featureNS[p]] = parsers;\n      }\n      if (localName == 'featureMember') {\n        features = pushParseAndPop(undefined, parsersNS, node, objectStack);\n      } else {\n        features = pushParseAndPop([], parsersNS, node, objectStack);\n      }\n    }\n    if (features === null) {\n      features = [];\n    }\n    return features;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {import(\"../geom/Geometry.js\").default|import(\"../extent.js\").Extent|undefined} Geometry.\n   */\n  readGeometryElement(node, objectStack) {\n    const context = /** @type {Object} */ (objectStack[0]);\n    context['srsName'] = node.firstElementChild.getAttribute('srsName');\n    context['srsDimension'] = node.firstElementChild.getAttribute('srsDimension');\n    const geometry = pushParseAndPop(null, this.GEOMETRY_PARSERS, node, objectStack, this);\n    if (geometry) {\n      if (Array.isArray(geometry)) {\n        return transformExtentWithOptions(/** @type {import(\"../extent.js\").Extent} */ (geometry), context);\n      } else {\n        return transformGeometryWithOptions(/** @type {import(\"../geom/Geometry.js\").default} */ (geometry), false, context);\n      }\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @param {boolean} asFeature whether result should be wrapped as a feature.\n   * @return {Feature|Object} Feature\n   */\n  readFeatureElementInternal(node, objectStack, asFeature) {\n    let geometryName;\n    const values = {};\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      let value;\n      const localName = n.localName;\n      // first, check if it is simple attribute\n      if (n.childNodes.length === 0\n              || (n.childNodes.length === 1 && (n.firstChild.nodeType === 3 || n.firstChild.nodeType === 4))) {\n        value = getAllTextContent(n, false);\n        if (ONLY_WHITESPACE_RE.test(value)) {\n          value = undefined;\n        }\n      } else {\n        if (asFeature) {\n          //if feature, try it as a geometry\n          value = this.readGeometryElement(n, objectStack);\n        }\n        if (!value) { //if not a geometry or not a feature, treat it as a complex attribute\n          value = this.readFeatureElementInternal(n, objectStack, false);\n        } else if (localName !== 'boundedBy') {\n          // boundedBy is an extent and must not be considered as a geometry\n          geometryName = localName;\n        }\n      }\n\n      if (values[localName]) {\n        if (!(values[localName] instanceof Array)) {\n          values[localName] = [values[localName]];\n        }\n        values[localName].push(value);\n      } else {\n        values[localName] = value;\n      }\n\n      const len = n.attributes.length;\n      if (len > 0) {\n        values[localName] = {_content_: values[localName]};\n        for (let i = 0; i < len; i++) {\n          const attName = n.attributes[i].name;\n          values[localName][attName] = n.attributes[i].value;\n        }\n      }\n    }\n    if (!asFeature) {\n      return values;\n    } else {\n      const feature = new Feature(values);\n      if (geometryName) {\n        feature.setGeometryName(geometryName);\n      }\n      const fid = node.getAttribute('fid') ||\n           getAttributeNS(node, this.namespace, 'id');\n      if (fid) {\n        feature.setId(fid);\n      }\n      return feature;\n    }\n  }\n\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {Feature} Feature.\n   */\n  readFeatureElement(node, objectStack) {\n    return this.readFeatureElementInternal(node, objectStack, true);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {Point|undefined} Point.\n   */\n  readPoint(node, objectStack) {\n    const flatCoordinates = this.readFlatCoordinatesFromNode_(node, objectStack);\n    if (flatCoordinates) {\n      return new Point(flatCoordinates, GeometryLayout.XYZ);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {MultiPoint|undefined} MultiPoint.\n   */\n  readMultiPoint(node, objectStack) {\n    /** @type {Array<Array<number>>} */\n    const coordinates = pushParseAndPop([],\n      this.MULTIPOINT_PARSERS_, node, objectStack, this);\n    if (coordinates) {\n      return new MultiPoint(coordinates);\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {MultiLineString|undefined} MultiLineString.\n   */\n  readMultiLineString(node, objectStack) {\n    /** @type {Array<LineString>} */\n    const lineStrings = pushParseAndPop([],\n      this.MULTILINESTRING_PARSERS_, node, objectStack, this);\n    if (lineStrings) {\n      return new MultiLineString(lineStrings);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {MultiPolygon|undefined} MultiPolygon.\n   */\n  readMultiPolygon(node, objectStack) {\n    /** @type {Array<Polygon>} */\n    const polygons = pushParseAndPop([], this.MULTIPOLYGON_PARSERS_, node, objectStack, this);\n    if (polygons) {\n      return new MultiPolygon(polygons);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  pointMemberParser_(node, objectStack) {\n    parseNode(this.POINTMEMBER_PARSERS_, node, objectStack, this);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  lineStringMemberParser_(node, objectStack) {\n    parseNode(this.LINESTRINGMEMBER_PARSERS_, node, objectStack, this);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  polygonMemberParser_(node, objectStack) {\n    parseNode(this.POLYGONMEMBER_PARSERS_, node, objectStack, this);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {LineString|undefined} LineString.\n   */\n  readLineString(node, objectStack) {\n    const flatCoordinates = this.readFlatCoordinatesFromNode_(node, objectStack);\n    if (flatCoordinates) {\n      const lineString = new LineString(flatCoordinates, GeometryLayout.XYZ);\n      return lineString;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Array<number>|undefined} LinearRing flat coordinates.\n   */\n  readFlatLinearRing_(node, objectStack) {\n    const ring = pushParseAndPop(null,\n      this.GEOMETRY_FLAT_COORDINATES_PARSERS, node,\n      objectStack, this);\n    if (ring) {\n      return ring;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {LinearRing|undefined} LinearRing.\n   */\n  readLinearRing(node, objectStack) {\n    const flatCoordinates = this.readFlatCoordinatesFromNode_(node, objectStack);\n    if (flatCoordinates) {\n      return new LinearRing(flatCoordinates, GeometryLayout.XYZ);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @return {Polygon|undefined} Polygon.\n   */\n  readPolygon(node, objectStack) {\n    /** @type {Array<Array<number>>} */\n    const flatLinearRings = pushParseAndPop([null],\n      this.FLAT_LINEAR_RINGS_PARSERS, node, objectStack, this);\n    if (flatLinearRings && flatLinearRings[0]) {\n      const flatCoordinates = flatLinearRings[0];\n      const ends = [flatCoordinates.length];\n      let i, ii;\n      for (i = 1, ii = flatLinearRings.length; i < ii; ++i) {\n        extend(flatCoordinates, flatLinearRings[i]);\n        ends.push(flatCoordinates.length);\n      }\n      return new Polygon(flatCoordinates, GeometryLayout.XYZ, ends);\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Array<number>} Flat coordinates.\n   */\n  readFlatCoordinatesFromNode_(node, objectStack) {\n    return pushParseAndPop(null, this.GEOMETRY_FLAT_COORDINATES_PARSERS, node, objectStack, this);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  //@ts-ignore\n  readGeometryFromNode(node, opt_options) {\n    const geometry = this.readGeometryElement(node,\n      [this.getReadOptions(node, opt_options ? opt_options : {})]);\n    return geometry ? geometry : null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromNode(node, opt_options) {\n    const options = {\n      featureType: this.featureType,\n      featureNS: this.featureNS\n    };\n    if (opt_options) {\n      assign(options, this.getReadOptions(node, opt_options));\n    }\n    const features = this.readFeaturesInternal(node, [options]);\n    return features || [];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readProjectionFromNode(node) {\n    return getProjection(this.srsName ? this.srsName : node.firstElementChild.getAttribute('srsName'));\n  }\n}\n\n\nGMLBase.prototype.namespace = GMLNS;\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGMLBase.prototype.FLAT_LINEAR_RINGS_PARSERS = {\n  'http://www.opengis.net/gml': {}\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGMLBase.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS = {\n  'http://www.opengis.net/gml': {}\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGMLBase.prototype.GEOMETRY_PARSERS = {\n  'http://www.opengis.net/gml': {}\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGMLBase.prototype.MULTIPOINT_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'pointMember': makeArrayPusher(GMLBase.prototype.pointMemberParser_),\n    'pointMembers': makeArrayPusher(GMLBase.prototype.pointMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGMLBase.prototype.MULTILINESTRING_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'lineStringMember': makeArrayPusher(GMLBase.prototype.lineStringMemberParser_),\n    'lineStringMembers': makeArrayPusher(GMLBase.prototype.lineStringMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGMLBase.prototype.MULTIPOLYGON_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'polygonMember': makeArrayPusher(GMLBase.prototype.polygonMemberParser_),\n    'polygonMembers': makeArrayPusher(GMLBase.prototype.polygonMemberParser_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGMLBase.prototype.POINTMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Point': makeArrayPusher(GMLBase.prototype.readFlatCoordinatesFromNode_)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGMLBase.prototype.LINESTRINGMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'LineString': makeArrayPusher(GMLBase.prototype.readLineString)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGMLBase.prototype.POLYGONMEMBER_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'Polygon': makeArrayPusher(GMLBase.prototype.readPolygon)\n  }\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGMLBase.prototype.RING_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'LinearRing': makeReplacer(GMLBase.prototype.readFlatLinearRing_)\n  }\n};\n\nexport default GMLBase;\n","/**\n * @module ol/source/TileJSON\n */\n// FIXME check order of async callbacks\n\n/**\n * See https://mapbox.com/developers/api/.\n */\n\n\nimport {createFromTemplates} from '../tileurlfunction.js';\nimport {assert} from '../asserts.js';\nimport {applyTransform, intersects} from '../extent.js';\nimport {jsonp as requestJSONP} from '../net.js';\nimport {get as getProjection, getTransformFromProjections} from '../proj.js';\nimport SourceState from './State.js';\nimport TileImage from './TileImage.js';\nimport {createXYZ, extentFromProjection} from '../tilegrid.js';\n\n\n/**\n * @typedef {Object} Config\n * @property {string} [name] The name.\n * @property {string} [description] The description.\n * @property {string} [version] The version.\n * @property {string} [attribution] The attribution.\n * @property {string} [template] The template.\n * @property {string} [legend] The legend.\n * @property {string} [scheme] The scheme.\n * @property {Array<string>} tiles The tile URL templates.\n * @property {Array<string>} [grids] Optional grids.\n * @property {number} [minzoom] Minimum zoom level.\n * @property {number} [maxzoom] Maximum zoom level.\n * @property {Array<number>} [bounds] Optional bounds.\n * @property {Array<number>} [center] Optional center.\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [jsonp=false] Use JSONP with callback to load the TileJSON.\n * Useful when the server does not support CORS..\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {Config} [tileJSON] TileJSON configuration for this source.\n * If not provided, `url` must be configured.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number|import(\"../size.js\").Size} [tileSize=[256, 256]] The tile size used by the tile service.\n * Note: `tileSize` and other non-standard TileJSON properties are currently ignored.\n * @property {string} [url] URL to the TileJSON file. If not provided, `tileJSON` must be configured.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data in TileJSON format.\n * @api\n */\nclass TileJSON extends TileImage {\n  /**\n   * @param {Options} options TileJSON options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      projection: getProjection('EPSG:3857'),\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      state: SourceState.LOADING,\n      tileLoadFunction: options.tileLoadFunction,\n      wrapX: options.wrapX !== undefined ? options.wrapX : true,\n      transition: options.transition\n    });\n\n    /**\n     * @type {Config}\n     * @private\n     */\n    this.tileJSON_ = null;\n\n    /**\n     * @type {number|import(\"../size.js\").Size}\n     * @private\n     */\n    this.tileSize_ = options.tileSize;\n\n\n    if (options.url) {\n      if (options.jsonp) {\n        requestJSONP(options.url, this.handleTileJSONResponse.bind(this),\n          this.handleTileJSONError.bind(this));\n      } else {\n        const client = new XMLHttpRequest();\n        client.addEventListener('load', this.onXHRLoad_.bind(this));\n        client.addEventListener('error', this.onXHRError_.bind(this));\n        client.open('GET', options.url);\n        client.send();\n      }\n    } else if (options.tileJSON) {\n      this.handleTileJSONResponse(options.tileJSON);\n    } else {\n      assert(false, 51); // Either `url` or `tileJSON` options must be provided\n    }\n\n  }\n\n  /**\n   * @private\n   * @param {Event} event The load event.\n   */\n  onXHRLoad_(event) {\n    const client = /** @type {XMLHttpRequest} */ (event.target);\n    // status will be 0 for file:// urls\n    if (!client.status || client.status >= 200 && client.status < 300) {\n      let response;\n      try {\n        response = /** @type {TileJSON} */(JSON.parse(client.responseText));\n      } catch (err) {\n        this.handleTileJSONError();\n        return;\n      }\n      this.handleTileJSONResponse(response);\n    } else {\n      this.handleTileJSONError();\n    }\n  }\n\n  /**\n   * @private\n   * @param {Event} event The error event.\n   */\n  onXHRError_(event) {\n    this.handleTileJSONError();\n  }\n\n  /**\n   * @return {Config} The tilejson object.\n   * @api\n   */\n  getTileJSON() {\n    return this.tileJSON_;\n  }\n\n  /**\n   * @protected\n   * @param {Config} tileJSON Tile JSON.\n   */\n  handleTileJSONResponse(tileJSON) {\n\n    const epsg4326Projection = getProjection('EPSG:4326');\n\n    const sourceProjection = this.getProjection();\n    let extent;\n    if (tileJSON['bounds'] !== undefined) {\n      const transform = getTransformFromProjections(\n        epsg4326Projection, sourceProjection);\n      extent = applyTransform(tileJSON['bounds'], transform);\n    }\n\n    const minZoom = tileJSON['minzoom'] || 0;\n    const maxZoom = tileJSON['maxzoom'] || 22;\n    const tileGrid = createXYZ({\n      extent: extentFromProjection(sourceProjection),\n      maxZoom: maxZoom,\n      minZoom: minZoom,\n      tileSize: this.tileSize_\n    });\n    this.tileGrid = tileGrid;\n\n    this.tileUrlFunction = createFromTemplates(tileJSON['tiles'], tileGrid);\n\n    if (tileJSON['attribution'] !== undefined && !this.getAttributions()) {\n      const attributionExtent = extent !== undefined ?\n        extent : epsg4326Projection.getExtent();\n\n      this.setAttributions(function(frameState) {\n        if (intersects(attributionExtent, frameState.extent)) {\n          return [tileJSON['attribution']];\n        }\n        return null;\n      });\n\n    }\n    this.tileJSON_ = tileJSON;\n    this.setState(SourceState.READY);\n\n  }\n\n  /**\n   * @protected\n   */\n  handleTileJSONError() {\n    this.setState(SourceState.ERROR);\n  }\n}\n\n\nexport default TileJSON;\n","/**\n * @module ol/tilecoord\n */\n\n\n/**\n * An array of three numbers representing the location of a tile in a tile\n * grid. The order is `z` (zoom level), `x` (column), and `y` (row).\n * @typedef {Array<number>} TileCoord\n * @api\n */\n\n\n/**\n * @param {number} z Z.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {TileCoord=} opt_tileCoord Tile coordinate.\n * @return {TileCoord} Tile coordinate.\n */\nexport function createOrUpdate(z, x, y, opt_tileCoord) {\n  if (opt_tileCoord !== undefined) {\n    opt_tileCoord[0] = z;\n    opt_tileCoord[1] = x;\n    opt_tileCoord[2] = y;\n    return opt_tileCoord;\n  } else {\n    return [z, x, y];\n  }\n}\n\n\n/**\n * @param {number} z Z.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {string} Key.\n */\nexport function getKeyZXY(z, x, y) {\n  return z + '/' + x + '/' + y;\n}\n\n\n/**\n * Get the key for a tile coord.\n * @param {TileCoord} tileCoord The tile coord.\n * @return {string} Key.\n */\nexport function getKey(tileCoord) {\n  return getKeyZXY(tileCoord[0], tileCoord[1], tileCoord[2]);\n}\n\n\n/**\n * Get a tile coord given a key.\n * @param {string} key The tile coord key.\n * @return {TileCoord} The tile coord.\n */\nexport function fromKey(key) {\n  return key.split('/').map(Number);\n}\n\n\n/**\n * @param {TileCoord} tileCoord Tile coord.\n * @return {number} Hash.\n */\nexport function hash(tileCoord) {\n  return (tileCoord[1] << tileCoord[0]) + tileCoord[2];\n}\n\n\n/**\n * @param {TileCoord} tileCoord Tile coordinate.\n * @param {!import(\"./tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n * @return {boolean} Tile coordinate is within extent and zoom level range.\n */\nexport function withinExtentAndZ(tileCoord, tileGrid) {\n  const z = tileCoord[0];\n  const x = tileCoord[1];\n  const y = tileCoord[2];\n\n  if (tileGrid.getMinZoom() > z || z > tileGrid.getMaxZoom()) {\n    return false;\n  }\n  const extent = tileGrid.getExtent();\n  let tileRange;\n  if (!extent) {\n    tileRange = tileGrid.getFullTileRange(z);\n  } else {\n    tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n  }\n  if (!tileRange) {\n    return true;\n  } else {\n    return tileRange.containsXY(x, y);\n  }\n}\n","/**\n * @module ol/easing\n */\n\n\n/**\n * Start slow and speed up.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeIn(t) {\n  return Math.pow(t, 3);\n}\n\n\n/**\n * Start fast and slow down.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function easeOut(t) {\n  return 1 - easeIn(1 - t);\n}\n\n\n/**\n * Start slow, speed up, and then slow down again.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function inAndOut(t) {\n  return 3 * t * t - 2 * t * t * t;\n}\n\n\n/**\n * Maintain a constant speed over time.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function linear(t) {\n  return t;\n}\n\n\n/**\n * Start slow, speed up, and at the very end slow down again.  This has the\n * same general behavior as {@link module:ol/easing~inAndOut}, but the final\n * slowdown is delayed.\n * @param {number} t Input between 0 and 1.\n * @return {number} Output between 0 and 1.\n * @api\n */\nexport function upAndDown(t) {\n  if (t < 0.5) {\n    return inAndOut(2 * t);\n  } else {\n    return 1 - inAndOut(2 * (t - 0.5));\n  }\n}\n","/**\n * @module ol/size\n */\n\n\n/**\n * An array of numbers representing a size: `[width, height]`.\n * @typedef {Array<number>} Size\n * @api\n */\n\n\n/**\n * Returns a buffered size.\n * @param {Size} size Size.\n * @param {number} num The amount by which to buffer.\n * @param {Size=} opt_size Optional reusable size array.\n * @return {Size} The buffered size.\n */\nexport function buffer(size, num, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = size[0] + 2 * num;\n  opt_size[1] = size[1] + 2 * num;\n  return opt_size;\n}\n\n\n/**\n * Determines if a size has a positive area.\n * @param {Size} size The size to test.\n * @return {boolean} The size has a positive area.\n */\nexport function hasArea(size) {\n  return size[0] > 0 && size[1] > 0;\n}\n\n\n/**\n * Returns a size scaled by a ratio. The result will be an array of integers.\n * @param {Size} size Size.\n * @param {number} ratio Ratio.\n * @param {Size=} opt_size Optional reusable size array.\n * @return {Size} The scaled size.\n */\nexport function scale(size, ratio, opt_size) {\n  if (opt_size === undefined) {\n    opt_size = [0, 0];\n  }\n  opt_size[0] = (size[0] * ratio + 0.5) | 0;\n  opt_size[1] = (size[1] * ratio + 0.5) | 0;\n  return opt_size;\n}\n\n\n/**\n * Returns an `Size` array for the passed in number (meaning: square) or\n * `Size` array.\n * (meaning: non-square),\n * @param {number|Size} size Width and height.\n * @param {Size=} opt_size Optional reusable size array.\n * @return {Size} Size.\n * @api\n */\nexport function toSize(size, opt_size) {\n  if (Array.isArray(size)) {\n    return size;\n  } else {\n    if (opt_size === undefined) {\n      opt_size = [size, size];\n    } else {\n      opt_size[0] = opt_size[1] = /** @type {number} */ (size);\n    }\n    return opt_size;\n  }\n}\n","/**\n * @module ol/layer/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  OPACITY: 'opacity',\n  VISIBLE: 'visible',\n  EXTENT: 'extent',\n  Z_INDEX: 'zIndex',\n  MAX_RESOLUTION: 'maxResolution',\n  MIN_RESOLUTION: 'minResolution',\n  MAX_ZOOM: 'maxZoom',\n  MIN_ZOOM: 'minZoom',\n  SOURCE: 'source'\n};\n","/**\n * @module ol/interaction/Pointer\n */\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport Interaction from './Interaction.js';\nimport {getValues} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {function(import(\"../MapBrowserPointerEvent.js\").default):boolean} [handleDownEvent]\n * Function handling \"down\" events. If the function returns `true` then a drag\n * sequence is started.\n * @property {function(import(\"../MapBrowserPointerEvent.js\").default)} [handleDragEvent]\n * Function handling \"drag\" events. This function is called on \"move\" events\n * during a drag sequence.\n * @property {function(import(\"../MapBrowserEvent.js\").default):boolean} [handleEvent]\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. The function may return `false` to prevent the\n * propagation of the event to other interactions in the map's interactions\n * chain.\n * @property {function(import(\"../MapBrowserPointerEvent.js\").default)} [handleMoveEvent]\n * Function handling \"move\" events. This function is called on \"move\" events,\n * also during a drag sequence (so during a drag sequence both the\n * `handleDragEvent` function and this function are called).\n * @property {function(import(\"../MapBrowserPointerEvent.js\").default):boolean} [handleUpEvent]\n *  Function handling \"up\" events. If the function returns `false` then the\n * current drag sequence is stopped.\n * @property {function(boolean):boolean} [stopDown]\n * Should the down event be propagated to other interactions, or should be\n * stopped?\n */\n\n\n/**\n * @classdesc\n * Base class that calls user-defined functions on `down`, `move` and `up`\n * events. This class also manages \"drag sequences\".\n *\n * When the `handleDownEvent` user function returns `true` a drag sequence is\n * started. During a drag sequence the `handleDragEvent` user function is\n * called on `move` events. The drag sequence ends when the `handleUpEvent`\n * user function is called and returns `false`.\n * @api\n */\nclass PointerInteraction extends Interaction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super(/** @type {import(\"./Interaction.js\").InteractionOptions} */ (options));\n\n    if (options.handleDownEvent) {\n      this.handleDownEvent = options.handleDownEvent;\n    }\n\n    if (options.handleDragEvent) {\n      this.handleDragEvent = options.handleDragEvent;\n    }\n\n    if (options.handleMoveEvent) {\n      this.handleMoveEvent = options.handleMoveEvent;\n    }\n\n    if (options.handleUpEvent) {\n      this.handleUpEvent = options.handleUpEvent;\n    }\n\n    if (options.stopDown) {\n      this.stopDown = options.stopDown;\n    }\n\n    /**\n     * @type {boolean}\n     * @protected\n     */\n    this.handlingDownUpSequence = false;\n\n    /**\n     * @type {!Object<string, PointerEvent>}\n     * @private\n     */\n    this.trackedPointers_ = {};\n\n    /**\n     * @type {Array<PointerEvent>}\n     * @protected\n     */\n    this.targetPointers = [];\n\n  }\n\n  /**\n   * Handle pointer down events.\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Event.\n   * @return {boolean} If the event was consumed.\n   * @protected\n   */\n  handleDownEvent(mapBrowserEvent) {\n    return false;\n  }\n\n  /**\n   * Handle pointer drag events.\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Event.\n   * @protected\n   */\n  handleDragEvent(mapBrowserEvent) {}\n\n  /**\n   * Handles the {@link module:ol/MapBrowserEvent map browser event} and may call into\n   * other functions, if event sequences like e.g. 'drag' or 'down-up' etc. are\n   * detected.\n   * @override\n   * @api\n   */\n  handleEvent(mapBrowserEvent) {\n    if (!(/** @type {import(\"../MapBrowserPointerEvent.js\").default} */ (mapBrowserEvent).pointerEvent)) {\n      return true;\n    }\n\n    let stopEvent = false;\n    this.updateTrackedPointers_(mapBrowserEvent);\n    if (this.handlingDownUpSequence) {\n      if (mapBrowserEvent.type == MapBrowserEventType.POINTERDRAG) {\n        this.handleDragEvent(mapBrowserEvent);\n      } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n        const handledUp = this.handleUpEvent(mapBrowserEvent);\n        this.handlingDownUpSequence = handledUp && this.targetPointers.length > 0;\n      }\n    } else {\n      if (mapBrowserEvent.type == MapBrowserEventType.POINTERDOWN) {\n        const handled = this.handleDownEvent(mapBrowserEvent);\n        if (handled) {\n          mapBrowserEvent.preventDefault();\n        }\n        this.handlingDownUpSequence = handled;\n        stopEvent = this.stopDown(handled);\n      } else if (mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE) {\n        this.handleMoveEvent(mapBrowserEvent);\n      }\n    }\n    return !stopEvent;\n  }\n\n  /**\n   * Handle pointer move events.\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Event.\n   * @protected\n   */\n  handleMoveEvent(mapBrowserEvent) {}\n\n  /**\n   * Handle pointer up events.\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Event.\n   * @return {boolean} If the event was consumed.\n   * @protected\n   */\n  handleUpEvent(mapBrowserEvent) {\n    return false;\n  }\n\n  /**\n   * This function is used to determine if \"down\" events should be propagated\n   * to other interactions or should be stopped.\n   * @param {boolean} handled Was the event handled by the interaction?\n   * @return {boolean} Should the `down` event be stopped?\n   */\n  stopDown(handled) {\n    return handled;\n  }\n\n  /**\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Event.\n   * @private\n   */\n  updateTrackedPointers_(mapBrowserEvent) {\n    if (isPointerDraggingEvent(mapBrowserEvent)) {\n      const event = mapBrowserEvent.pointerEvent;\n\n      const id = event.pointerId.toString();\n      if (mapBrowserEvent.type == MapBrowserEventType.POINTERUP) {\n        delete this.trackedPointers_[id];\n      } else if (mapBrowserEvent.type ==\n          MapBrowserEventType.POINTERDOWN) {\n        this.trackedPointers_[id] = event;\n      } else if (id in this.trackedPointers_) {\n        // update only when there was a pointerdown event for this pointer\n        this.trackedPointers_[id] = event;\n      }\n      this.targetPointers = getValues(this.trackedPointers_);\n    }\n  }\n\n}\n\n\n/**\n * @param {Array<PointerEvent>} pointerEvents List of events.\n * @return {import(\"../pixel.js\").Pixel} Centroid pixel.\n */\nexport function centroid(pointerEvents) {\n  const length = pointerEvents.length;\n  let clientX = 0;\n  let clientY = 0;\n  for (let i = 0; i < length; i++) {\n    clientX += pointerEvents[i].clientX;\n    clientY += pointerEvents[i].clientY;\n  }\n  return [clientX / length, clientY / length];\n}\n\n\n/**\n * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserEvent Event.\n * @return {boolean} Whether the event is a pointerdown, pointerdrag\n *     or pointerup event.\n */\nfunction isPointerDraggingEvent(mapBrowserEvent) {\n  const type = mapBrowserEvent.type;\n  return type === MapBrowserEventType.POINTERDOWN ||\n    type === MapBrowserEventType.POINTERDRAG ||\n    type === MapBrowserEventType.POINTERUP;\n}\n\n\nexport default PointerInteraction;\n","/**\n * @module ol/proj/Units\n */\n\n/**\n * Projection units: `'degrees'`, `'ft'`, `'m'`, `'pixels'`, `'tile-pixels'` or\n * `'us-ft'`.\n * @enum {string}\n */\nconst Units = {\n  DEGREES: 'degrees',\n  FEET: 'ft',\n  METERS: 'm',\n  PIXELS: 'pixels',\n  TILE_PIXELS: 'tile-pixels',\n  USFEET: 'us-ft'\n};\n\n\n/**\n * Meters per unit lookup table.\n * @const\n * @type {Object<Units, number>}\n * @api\n */\nexport const METERS_PER_UNIT = {};\n// use the radius of the Normal sphere\nMETERS_PER_UNIT[Units.DEGREES] = 2 * Math.PI * 6370997 / 360;\nMETERS_PER_UNIT[Units.FEET] = 0.3048;\nMETERS_PER_UNIT[Units.METERS] = 1;\nMETERS_PER_UNIT[Units.USFEET] = 1200 / 3937;\n\nexport default Units;\n","/**\n * @module ol/tilegrid\n */\nimport {DEFAULT_MAX_ZOOM, DEFAULT_TILE_SIZE} from './tilegrid/common.js';\nimport {toSize} from './size.js';\nimport {containsCoordinate, createOrUpdate, getCorner, getHeight, getWidth} from './extent.js';\nimport Corner from './extent/Corner.js';\nimport {get as getProjection, METERS_PER_UNIT} from './proj.js';\nimport Units from './proj/Units.js';\nimport TileGrid from './tilegrid/TileGrid.js';\n\n\n/**\n * @param {import(\"./proj/Projection.js\").default} projection Projection.\n * @return {!TileGrid} Default tile grid for the\n * passed projection.\n */\nexport function getForProjection(projection) {\n  let tileGrid = projection.getDefaultTileGrid();\n  if (!tileGrid) {\n    tileGrid = createForProjection(projection);\n    projection.setDefaultTileGrid(tileGrid);\n  }\n  return tileGrid;\n}\n\n\n/**\n * @param {TileGrid} tileGrid Tile grid.\n * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @param {import(\"./proj/Projection.js\").default} projection Projection.\n * @return {import(\"./tilecoord.js\").TileCoord} Tile coordinate.\n */\nexport function wrapX(tileGrid, tileCoord, projection) {\n  const z = tileCoord[0];\n  const center = tileGrid.getTileCoordCenter(tileCoord);\n  const projectionExtent = extentFromProjection(projection);\n  if (!containsCoordinate(projectionExtent, center)) {\n    const worldWidth = getWidth(projectionExtent);\n    const worldsAway = Math.ceil((projectionExtent[0] - center[0]) / worldWidth);\n    center[0] += worldWidth * worldsAway;\n    return tileGrid.getTileCoordForCoordAndZ(center, z);\n  } else {\n    return tileCoord;\n  }\n}\n\n\n/**\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|import(\"./size.js\").Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {Corner=} opt_corner Extent corner (default is `'top-left'`).\n * @return {!TileGrid} TileGrid instance.\n */\nexport function createForExtent(extent, opt_maxZoom, opt_tileSize, opt_corner) {\n  const corner = opt_corner !== undefined ? opt_corner : Corner.TOP_LEFT;\n\n  const resolutions = resolutionsFromExtent(extent, opt_maxZoom, opt_tileSize);\n\n  return new TileGrid({\n    extent: extent,\n    origin: getCorner(extent, corner),\n    resolutions: resolutions,\n    tileSize: opt_tileSize\n  });\n}\n\n\n/**\n * @typedef {Object} XYZOptions\n * @property {import(\"./extent.js\").Extent} [extent] Extent for the tile grid. The origin for an XYZ tile grid is the\n * top-left corner of the extent. The zero level of the grid is defined by the resolution at which one tile fits in the\n * provided extent. If not provided, the extent of the EPSG:3857 projection is used.\n * @property {number} [maxZoom] Maximum zoom. The default is `42`. This determines the number of levels\n * in the grid set. For example, a `maxZoom` of 21 means there are 22 levels in the grid set.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {number|import(\"./size.js\").Size} [tileSize=[256, 256]] Tile size in pixels.\n */\n\n\n/**\n * Creates a tile grid with a standard XYZ tiling scheme.\n * @param {XYZOptions=} opt_options Tile grid options.\n * @return {!TileGrid} Tile grid instance.\n * @api\n */\nexport function createXYZ(opt_options) {\n  /** @type {XYZOptions} */\n  const xyzOptions = opt_options || {};\n\n  const extent = xyzOptions.extent || getProjection('EPSG:3857').getExtent();\n\n  /** @type {import(\"./tilegrid/TileGrid.js\").Options} */\n  const gridOptions = {\n    extent: extent,\n    minZoom: xyzOptions.minZoom,\n    tileSize: xyzOptions.tileSize,\n    resolutions: resolutionsFromExtent(\n      extent,\n      xyzOptions.maxZoom,\n      xyzOptions.tileSize\n    )\n  };\n  return new TileGrid(gridOptions);\n}\n\n\n/**\n * Create a resolutions array from an extent.  A zoom factor of 2 is assumed.\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|import(\"./size.js\").Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @return {!Array<number>} Resolutions array.\n */\nfunction resolutionsFromExtent(extent, opt_maxZoom, opt_tileSize) {\n  const maxZoom = opt_maxZoom !== undefined ?\n    opt_maxZoom : DEFAULT_MAX_ZOOM;\n\n  const height = getHeight(extent);\n  const width = getWidth(extent);\n\n  const tileSize = toSize(opt_tileSize !== undefined ?\n    opt_tileSize : DEFAULT_TILE_SIZE);\n  const maxResolution = Math.max(\n    width / tileSize[0], height / tileSize[1]);\n\n  const length = maxZoom + 1;\n  const resolutions = new Array(length);\n  for (let z = 0; z < length; ++z) {\n    resolutions[z] = maxResolution / Math.pow(2, z);\n  }\n  return resolutions;\n}\n\n\n/**\n * @param {import(\"./proj.js\").ProjectionLike} projection Projection.\n * @param {number=} opt_maxZoom Maximum zoom level (default is\n *     DEFAULT_MAX_ZOOM).\n * @param {number|import(\"./size.js\").Size=} opt_tileSize Tile size (default uses\n *     DEFAULT_TILE_SIZE).\n * @param {Corner=} opt_corner Extent corner (default is `'top-left'`).\n * @return {!TileGrid} TileGrid instance.\n */\nexport function createForProjection(projection, opt_maxZoom, opt_tileSize, opt_corner) {\n  const extent = extentFromProjection(projection);\n  return createForExtent(extent, opt_maxZoom, opt_tileSize, opt_corner);\n}\n\n\n/**\n * Generate a tile grid extent from a projection.  If the projection has an\n * extent, it is used.  If not, a global extent is assumed.\n * @param {import(\"./proj.js\").ProjectionLike} projection Projection.\n * @return {import(\"./extent.js\").Extent} Extent.\n */\nexport function extentFromProjection(projection) {\n  projection = getProjection(projection);\n  let extent = projection.getExtent();\n  if (!extent) {\n    const half = 180 * METERS_PER_UNIT[Units.DEGREES] / projection.getMetersPerUnit();\n    extent = createOrUpdate(-half, -half, half, half);\n  }\n  return extent;\n}\n","/**\n * @module ol/CollectionEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when an item is added to the collection.\n   * @event module:ol/Collection.CollectionEvent#add\n   * @api\n   */\n  ADD: 'add',\n  /**\n   * Triggered when an item is removed from the collection.\n   * @event module:ol/Collection.CollectionEvent#remove\n   * @api\n   */\n  REMOVE: 'remove'\n};\n","/**\n * @module ol/Collection\n */\nimport AssertionError from './AssertionError.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport BaseObject from './Object.js';\nimport Event from './events/Event.js';\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LENGTH: 'length'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/Collection~Collection} instances are instances of this\n * type.\n */\nexport class CollectionEvent extends Event {\n\n  /**\n   * @param {CollectionEventType} type Type.\n   * @param {*=} opt_element Element.\n   * @param {number} opt_index The index of the added or removed element.\n   */\n  constructor(type, opt_element, opt_index) {\n    super(type);\n\n    /**\n     * The element that is added to or removed from the collection.\n     * @type {*}\n     * @api\n     */\n    this.element = opt_element;\n\n    /**\n     * The index of the added or removed element.\n     * @type {number}\n     * @api\n     */\n    this.index = opt_index;\n  }\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [unique=false] Disallow the same item from being added to\n * the collection twice.\n */\n\n/**\n * @classdesc\n * An expanded version of standard JS Array, adding convenience methods for\n * manipulation. Add and remove changes to the Collection trigger a Collection\n * event. Note that this does not cover changes to the objects _within_ the\n * Collection; they trigger events on the appropriate object, not on the\n * Collection as a whole.\n *\n * @fires CollectionEvent\n *\n * @template T\n * @api\n */\nclass Collection extends BaseObject {\n\n  /**\n   * @param {Array<T>=} opt_array Array.\n   * @param {Options=} opt_options Collection options.\n   */\n  constructor(opt_array, opt_options) {\n\n    super();\n\n    const options = opt_options || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.unique_ = !!options.unique;\n\n    /**\n     * @private\n     * @type {!Array<T>}\n     */\n    this.array_ = opt_array ? opt_array : [];\n\n    if (this.unique_) {\n      for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n        this.assertUnique_(this.array_[i], i);\n      }\n    }\n\n    this.updateLength_();\n\n  }\n\n  /**\n   * Remove all elements from the collection.\n   * @api\n   */\n  clear() {\n    while (this.getLength() > 0) {\n      this.pop();\n    }\n  }\n\n  /**\n   * Add elements to the collection.  This pushes each item in the provided array\n   * to the end of the collection.\n   * @param {!Array<T>} arr Array.\n   * @return {Collection<T>} This collection.\n   * @api\n   */\n  extend(arr) {\n    for (let i = 0, ii = arr.length; i < ii; ++i) {\n      this.push(arr[i]);\n    }\n    return this;\n  }\n\n  /**\n   * Iterate over each element, calling the provided callback.\n   * @param {function(T, number, Array<T>): *} f The function to call\n   *     for every element. This function takes 3 arguments (the element, the\n   *     index and the array). The return value is ignored.\n   * @api\n   */\n  forEach(f) {\n    const array = this.array_;\n    for (let i = 0, ii = array.length; i < ii; ++i) {\n      f(array[i], i, array);\n    }\n  }\n\n  /**\n   * Get a reference to the underlying Array object. Warning: if the array\n   * is mutated, no events will be dispatched by the collection, and the\n   * collection's \"length\" property won't be in sync with the actual length\n   * of the array.\n   * @return {!Array<T>} Array.\n   * @api\n   */\n  getArray() {\n    return this.array_;\n  }\n\n  /**\n   * Get the element at the provided index.\n   * @param {number} index Index.\n   * @return {T} Element.\n   * @api\n   */\n  item(index) {\n    return this.array_[index];\n  }\n\n  /**\n   * Get the length of this collection.\n   * @return {number} The length of the array.\n   * @observable\n   * @api\n   */\n  getLength() {\n    return this.get(Property.LENGTH);\n  }\n\n  /**\n   * Insert an element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  insertAt(index, elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    this.array_.splice(index, 0, elem);\n    this.updateLength_();\n    this.dispatchEvent(\n      new CollectionEvent(CollectionEventType.ADD, elem, index));\n  }\n\n  /**\n   * Remove the last element of the collection and return it.\n   * Return `undefined` if the collection is empty.\n   * @return {T|undefined} Element.\n   * @api\n   */\n  pop() {\n    return this.removeAt(this.getLength() - 1);\n  }\n\n  /**\n   * Insert the provided element at the end of the collection.\n   * @param {T} elem Element.\n   * @return {number} New length of the collection.\n   * @api\n   */\n  push(elem) {\n    if (this.unique_) {\n      this.assertUnique_(elem);\n    }\n    const n = this.getLength();\n    this.insertAt(n, elem);\n    return this.getLength();\n  }\n\n  /**\n   * Remove the first occurrence of an element from the collection.\n   * @param {T} elem Element.\n   * @return {T|undefined} The removed element or undefined if none found.\n   * @api\n   */\n  remove(elem) {\n    const arr = this.array_;\n    for (let i = 0, ii = arr.length; i < ii; ++i) {\n      if (arr[i] === elem) {\n        return this.removeAt(i);\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Remove the element at the provided index and return it.\n   * Return `undefined` if the collection does not contain this index.\n   * @param {number} index Index.\n   * @return {T|undefined} Value.\n   * @api\n   */\n  removeAt(index) {\n    const prev = this.array_[index];\n    this.array_.splice(index, 1);\n    this.updateLength_();\n    this.dispatchEvent(new CollectionEvent(CollectionEventType.REMOVE, prev, index));\n    return prev;\n  }\n\n  /**\n   * Set the element at the provided index.\n   * @param {number} index Index.\n   * @param {T} elem Element.\n   * @api\n   */\n  setAt(index, elem) {\n    const n = this.getLength();\n    if (index < n) {\n      if (this.unique_) {\n        this.assertUnique_(elem, index);\n      }\n      const prev = this.array_[index];\n      this.array_[index] = elem;\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.REMOVE, prev, index));\n      this.dispatchEvent(\n        new CollectionEvent(CollectionEventType.ADD, elem, index));\n    } else {\n      for (let j = n; j < index; ++j) {\n        this.insertAt(j, undefined);\n      }\n      this.insertAt(index, elem);\n    }\n  }\n\n  /**\n   * @private\n   */\n  updateLength_() {\n    this.set(Property.LENGTH, this.array_.length);\n  }\n\n  /**\n   * @private\n   * @param {T} elem Element.\n   * @param {number=} opt_except Optional index to ignore.\n   */\n  assertUnique_(elem, opt_except) {\n    for (let i = 0, ii = this.array_.length; i < ii; ++i) {\n      if (this.array_[i] === elem && i !== opt_except) {\n        throw new AssertionError(58);\n      }\n    }\n  }\n}\n\n\nexport default Collection;\n","/**\n * @module ol/render/canvas/Immediate\n */\n// FIXME test, especially polygons with holes and multipolygons\n// FIXME need to handle large thick features (where pixel size matters)\n// FIXME add offset and end to ol/geom/flat/transform~transform2D?\n\nimport {equals} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {intersects} from '../../extent.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {transformGeom2D} from '../../geom/SimpleGeometry.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport VectorContext from '../VectorContext.js';\nimport {defaultTextAlign, defaultFillStyle, defaultLineCap, defaultLineDash, defaultLineDashOffset, defaultLineJoin, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline, defaultFont} from '../canvas.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\n\n/**\n * @classdesc\n * A concrete subclass of {@link module:ol/render/VectorContext} that implements\n * direct rendering of features and geometries to an HTML5 Canvas context.\n * Instances of this class are created internally by the library and\n * provided to application code as vectorContext member of the\n * {@link module:ol/render/Event~RenderEvent} object associated with postcompose, precompose and\n * render events emitted by layers and maps.\n */\nclass CanvasImmediateRenderer extends VectorContext {\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {number=} opt_squaredTolerance Optional squared tolerance for simplification.\n   * @param {import(\"../../proj.js\").TransformFunction=} opt_userTransform Transform from user to view projection.\n   */\n  constructor(context, pixelRatio, extent, transform, viewRotation, opt_squaredTolerance, opt_userTransform) {\n    super();\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context_ = context;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.extent_ = extent;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.transform_ = transform;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.viewRotation_ = viewRotation;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.squaredTolerance_ = opt_squaredTolerance;\n\n    /**\n     * @private\n     * @type {import(\"../../proj.js\").TransformFunction}\n     */\n    this.userTransform_ = opt_userTransform;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.contextFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.contextStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.contextTextState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.fillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.strokeState_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageAnchorY_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageHeight_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOpacity_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageOriginY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.imageRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageRotation_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageScale_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.imageWidth_ = 0;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.text_ = '';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.textRotateWithView_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textRotation_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textScale_ = 0;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.textFillState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.textStrokeState_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").TextState}\n     */\n    this.textState_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.pixelCoordinates_ = [];\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tmpLocalTransform_ = createTransform();\n\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  drawImages_(flatCoordinates, offset, end, stride) {\n    if (!this.image_) {\n      return;\n    }\n    const pixelCoordinates = transform2D(\n      flatCoordinates, offset, end, 2, this.transform_,\n      this.pixelCoordinates_);\n    const context = this.context_;\n    const localTransform = this.tmpLocalTransform_;\n    const alpha = context.globalAlpha;\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha * this.imageOpacity_;\n    }\n    let rotation = this.imageRotation_;\n    if (this.imageRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (let i = 0, ii = pixelCoordinates.length; i < ii; i += 2) {\n      const x = pixelCoordinates[i] - this.imageAnchorX_;\n      const y = pixelCoordinates[i + 1] - this.imageAnchorY_;\n      if (rotation !== 0 || this.imageScale_ != 1) {\n        const centerX = x + this.imageAnchorX_;\n        const centerY = y + this.imageAnchorY_;\n        composeTransform(localTransform,\n          centerX, centerY,\n          this.imageScale_, this.imageScale_,\n          rotation,\n          -centerX, -centerY);\n        context.setTransform.apply(context, localTransform);\n      }\n      context.drawImage(this.image_, this.imageOriginX_, this.imageOriginY_,\n        this.imageWidth_, this.imageHeight_, x, y,\n        this.imageWidth_, this.imageHeight_);\n    }\n    if (rotation !== 0 || this.imageScale_ != 1) {\n      context.setTransform(1, 0, 0, 1, 0, 0);\n    }\n    if (this.imageOpacity_ != 1) {\n      context.globalAlpha = alpha;\n    }\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   */\n  drawText_(flatCoordinates, offset, end, stride) {\n    if (!this.textState_ || this.text_ === '') {\n      return;\n    }\n    if (this.textFillState_) {\n      this.setContextFillState_(this.textFillState_);\n    }\n    if (this.textStrokeState_) {\n      this.setContextStrokeState_(this.textStrokeState_);\n    }\n    this.setContextTextState_(this.textState_);\n    const pixelCoordinates = transform2D(\n      flatCoordinates, offset, end, stride, this.transform_,\n      this.pixelCoordinates_);\n    const context = this.context_;\n    let rotation = this.textRotation_;\n    if (this.textRotateWithView_) {\n      rotation += this.viewRotation_;\n    }\n    for (; offset < end; offset += stride) {\n      const x = pixelCoordinates[offset] + this.textOffsetX_;\n      const y = pixelCoordinates[offset + 1] + this.textOffsetY_;\n      if (rotation !== 0 || this.textScale_ != 1) {\n        const localTransform = composeTransform(this.tmpLocalTransform_,\n          x, y,\n          this.textScale_, this.textScale_,\n          rotation,\n          -x, -y);\n        context.setTransform.apply(context, localTransform);\n      }\n      if (this.textStrokeState_) {\n        context.strokeText(this.text_, x, y);\n      }\n      if (this.textFillState_) {\n        context.fillText(this.text_, x, y);\n      }\n    }\n    if (rotation !== 0 || this.textScale_ != 1) {\n      context.setTransform(1, 0, 0, 1, 0, 0);\n    }\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} close Close.\n   * @private\n   * @return {number} end End.\n   */\n  moveToLineTo_(flatCoordinates, offset, end, stride, close) {\n    const context = this.context_;\n    const pixelCoordinates = transform2D(\n      flatCoordinates, offset, end, stride, this.transform_,\n      this.pixelCoordinates_);\n    context.moveTo(pixelCoordinates[0], pixelCoordinates[1]);\n    let length = pixelCoordinates.length;\n    if (close) {\n      length -= 2;\n    }\n    for (let i = 2; i < length; i += 2) {\n      context.lineTo(pixelCoordinates[i], pixelCoordinates[i + 1]);\n    }\n    if (close) {\n      context.closePath();\n    }\n    return end;\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  drawRings_(flatCoordinates, offset, ends, stride) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, true);\n    }\n    return offset;\n  }\n\n  /**\n   * Render a circle geometry into the canvas.  Rendering is immediate and uses\n   * the current fill and stroke styles.\n   *\n   * @param {import(\"../../geom/Circle.js\").default} geometry Circle geometry.\n   * @override\n   * @api\n   */\n  drawCircle(geometry) {\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.fillState_ || this.strokeState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const pixelCoordinates = transformGeom2D(\n        geometry, this.transform_, this.pixelCoordinates_);\n      const dx = pixelCoordinates[2] - pixelCoordinates[0];\n      const dy = pixelCoordinates[3] - pixelCoordinates[1];\n      const radius = Math.sqrt(dx * dx + dy * dy);\n      const context = this.context_;\n      context.beginPath();\n      context.arc(\n        pixelCoordinates[0], pixelCoordinates[1], radius, 0, 2 * Math.PI);\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      this.drawText_(geometry.getCenter(), 0, 2, 2);\n    }\n  }\n\n  /**\n   * Set the rendering style.  Note that since this is an immediate rendering API,\n   * any `zIndex` on the provided style will be ignored.\n   *\n   * @param {import(\"../../style/Style.js\").default} style The rendering style.\n   * @override\n   * @api\n   */\n  setStyle(style) {\n    this.setFillStrokeStyle(style.getFill(), style.getStroke());\n    this.setImageStyle(style.getImage());\n    this.setTextStyle(style.getText());\n  }\n\n  /**\n   * Render a geometry into the canvas.  Call\n   * {@link module:ol/render/canvas/Immediate#setStyle} first to set the rendering style.\n   *\n   * @param {import(\"../../geom/Geometry.js\").default|import(\"../Feature.js\").default} geometry The geometry to render.\n   * @override\n   * @api\n   */\n  drawGeometry(geometry) {\n    const type = geometry.getType();\n    switch (type) {\n      case GeometryType.POINT:\n        this.drawPoint(/** @type {import(\"../../geom/Point.js\").default} */ (geometry));\n        break;\n      case GeometryType.LINE_STRING:\n        this.drawLineString(/** @type {import(\"../../geom/LineString.js\").default} */ (geometry));\n        break;\n      case GeometryType.POLYGON:\n        this.drawPolygon(/** @type {import(\"../../geom/Polygon.js\").default} */ (geometry));\n        break;\n      case GeometryType.MULTI_POINT:\n        this.drawMultiPoint(/** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry));\n        break;\n      case GeometryType.MULTI_LINE_STRING:\n        this.drawMultiLineString(/** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry));\n        break;\n      case GeometryType.MULTI_POLYGON:\n        this.drawMultiPolygon(/** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry));\n        break;\n      case GeometryType.GEOMETRY_COLLECTION:\n        this.drawGeometryCollection(/** @type {import(\"../../geom/GeometryCollection.js\").default} */ (geometry));\n        break;\n      case GeometryType.CIRCLE:\n        this.drawCircle(/** @type {import(\"../../geom/Circle.js\").default} */ (geometry));\n        break;\n      default:\n    }\n  }\n\n  /**\n   * Render a feature into the canvas.  Note that any `zIndex` on the provided\n   * style will be ignored - features are rendered immediately in the order that\n   * this method is called.  If you need `zIndex` support, you should be using an\n   * {@link module:ol/layer/Vector~VectorLayer} instead.\n   *\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {import(\"../../style/Style.js\").default} style Style.\n   * @override\n   * @api\n   */\n  drawFeature(feature, style) {\n    const geometry = style.getGeometryFunction()(feature);\n    if (!geometry || !intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    this.setStyle(style);\n    this.drawGeometry(geometry);\n  }\n\n  /**\n   * Render a GeometryCollection to the canvas.  Rendering is immediate and\n   * uses the current styles appropriate for each geometry in the collection.\n   *\n   * @param {import(\"../../geom/GeometryCollection.js\").default} geometry Geometry collection.\n   * @override\n   */\n  drawGeometryCollection(geometry) {\n    const geometries = geometry.getGeometriesArray();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      this.drawGeometry(geometries[i]);\n    }\n  }\n\n  /**\n   * Render a Point geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Point.js\").default|import(\"../Feature.js\").default} geometry Point geometry.\n   * @override\n   */\n  drawPoint(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Point.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n    }\n    const flatCoordinates = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  }\n\n  /**\n   * Render a MultiPoint geometry  into the canvas.  Rendering is immediate and\n   * uses the current style.\n   *\n   * @param {import(\"../../geom/MultiPoint.js\").default|import(\"../Feature.js\").default} geometry MultiPoint geometry.\n   * @override\n   */\n  drawMultiPoint(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPoint.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n    }\n    const flatCoordinates = geometry.getFlatCoordinates();\n    const stride = geometry.getStride();\n    if (this.image_) {\n      this.drawImages_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n    if (this.text_ !== '') {\n      this.drawText_(flatCoordinates, 0, flatCoordinates.length, stride);\n    }\n  }\n\n  /**\n   * Render a LineString into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/LineString.js\").default|import(\"../Feature.js\").default} geometry LineString geometry.\n   * @override\n   */\n  drawLineString(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/LineString.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      const context = this.context_;\n      const flatCoordinates = geometry.getFlatCoordinates();\n      context.beginPath();\n      this.moveToLineTo_(flatCoordinates, 0, flatCoordinates.length,\n        geometry.getStride(), false);\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      const flatMidpoint = geometry.getFlatMidpoint();\n      this.drawText_(flatMidpoint, 0, 2, 2);\n    }\n  }\n\n  /**\n   * Render a MultiLineString geometry into the canvas.  Rendering is immediate\n   * and uses the current style.\n   *\n   * @param {import(\"../../geom/MultiLineString.js\").default|import(\"../Feature.js\").default} geometry MultiLineString geometry.\n   * @override\n   */\n  drawMultiLineString(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n    }\n    const geometryExtent = geometry.getExtent();\n    if (!intersects(this.extent_, geometryExtent)) {\n      return;\n    }\n    if (this.strokeState_) {\n      this.setContextStrokeState_(this.strokeState_);\n      const context = this.context_;\n      const flatCoordinates = geometry.getFlatCoordinates();\n      let offset = 0;\n      const ends = /** @type {Array<number>} */ (geometry.getEnds());\n      const stride = geometry.getStride();\n      context.beginPath();\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        offset = this.moveToLineTo_(flatCoordinates, offset, ends[i], stride, false);\n      }\n      context.stroke();\n    }\n    if (this.text_ !== '') {\n      const flatMidpoints = geometry.getFlatMidpoints();\n      this.drawText_(flatMidpoints, 0, flatMidpoints.length, 2);\n    }\n  }\n\n  /**\n   * Render a Polygon geometry into the canvas.  Rendering is immediate and uses\n   * the current style.\n   *\n   * @param {import(\"../../geom/Polygon.js\").default|import(\"../Feature.js\").default} geometry Polygon geometry.\n   * @override\n   */\n  drawPolygon(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const context = this.context_;\n      context.beginPath();\n      this.drawRings_(geometry.getOrientedFlatCoordinates(),\n        0, /** @type {Array<number>} */ (geometry.getEnds()), geometry.getStride());\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      const flatInteriorPoint = geometry.getFlatInteriorPoint();\n      this.drawText_(flatInteriorPoint, 0, 2, 2);\n    }\n  }\n\n  /**\n   * Render MultiPolygon geometry into the canvas.  Rendering is immediate and\n   * uses the current style.\n   * @param {import(\"../../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   * @override\n   */\n  drawMultiPolygon(geometry) {\n    if (this.squaredTolerance_) {\n      geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry.simplifyTransformed(this.squaredTolerance_, this.userTransform_));\n    }\n    if (!intersects(this.extent_, geometry.getExtent())) {\n      return;\n    }\n    if (this.strokeState_ || this.fillState_) {\n      if (this.fillState_) {\n        this.setContextFillState_(this.fillState_);\n      }\n      if (this.strokeState_) {\n        this.setContextStrokeState_(this.strokeState_);\n      }\n      const context = this.context_;\n      const flatCoordinates = geometry.getOrientedFlatCoordinates();\n      let offset = 0;\n      const endss = geometry.getEndss();\n      const stride = geometry.getStride();\n      context.beginPath();\n      for (let i = 0, ii = endss.length; i < ii; ++i) {\n        const ends = endss[i];\n        offset = this.drawRings_(flatCoordinates, offset, ends, stride);\n      }\n      if (this.fillState_) {\n        context.fill();\n      }\n      if (this.strokeState_) {\n        context.stroke();\n      }\n    }\n    if (this.text_ !== '') {\n      const flatInteriorPoints = geometry.getFlatInteriorPoints();\n      this.drawText_(flatInteriorPoints, 0, flatInteriorPoints.length, 2);\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillState} fillState Fill state.\n   * @private\n   */\n  setContextFillState_(fillState) {\n    const context = this.context_;\n    const contextFillState = this.contextFillState_;\n    if (!contextFillState) {\n      context.fillStyle = fillState.fillStyle;\n      this.contextFillState_ = {\n        fillStyle: fillState.fillStyle\n      };\n    } else {\n      if (contextFillState.fillStyle != fillState.fillStyle) {\n        contextFillState.fillStyle = context.fillStyle = fillState.fillStyle;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").StrokeState} strokeState Stroke state.\n   * @private\n   */\n  setContextStrokeState_(strokeState) {\n    const context = this.context_;\n    const contextStrokeState = this.contextStrokeState_;\n    if (!contextStrokeState) {\n      context.lineCap = strokeState.lineCap;\n      if (context.setLineDash) {\n        context.setLineDash(strokeState.lineDash);\n        context.lineDashOffset = strokeState.lineDashOffset;\n      }\n      context.lineJoin = strokeState.lineJoin;\n      context.lineWidth = strokeState.lineWidth;\n      context.miterLimit = strokeState.miterLimit;\n      context.strokeStyle = strokeState.strokeStyle;\n      this.contextStrokeState_ = {\n        lineCap: strokeState.lineCap,\n        lineDash: strokeState.lineDash,\n        lineDashOffset: strokeState.lineDashOffset,\n        lineJoin: strokeState.lineJoin,\n        lineWidth: strokeState.lineWidth,\n        miterLimit: strokeState.miterLimit,\n        strokeStyle: strokeState.strokeStyle\n      };\n    } else {\n      if (contextStrokeState.lineCap != strokeState.lineCap) {\n        contextStrokeState.lineCap = context.lineCap = strokeState.lineCap;\n      }\n      if (context.setLineDash) {\n        if (!equals(contextStrokeState.lineDash, strokeState.lineDash)) {\n          context.setLineDash(contextStrokeState.lineDash = strokeState.lineDash);\n        }\n        if (contextStrokeState.lineDashOffset != strokeState.lineDashOffset) {\n          contextStrokeState.lineDashOffset = context.lineDashOffset =\n              strokeState.lineDashOffset;\n        }\n      }\n      if (contextStrokeState.lineJoin != strokeState.lineJoin) {\n        contextStrokeState.lineJoin = context.lineJoin = strokeState.lineJoin;\n      }\n      if (contextStrokeState.lineWidth != strokeState.lineWidth) {\n        contextStrokeState.lineWidth = context.lineWidth = strokeState.lineWidth;\n      }\n      if (contextStrokeState.miterLimit != strokeState.miterLimit) {\n        contextStrokeState.miterLimit = context.miterLimit =\n            strokeState.miterLimit;\n      }\n      if (contextStrokeState.strokeStyle != strokeState.strokeStyle) {\n        contextStrokeState.strokeStyle = context.strokeStyle =\n            strokeState.strokeStyle;\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").TextState} textState Text state.\n   * @private\n   */\n  setContextTextState_(textState) {\n    const context = this.context_;\n    const contextTextState = this.contextTextState_;\n    const textAlign = textState.textAlign ?\n      textState.textAlign : defaultTextAlign;\n    if (!contextTextState) {\n      context.font = textState.font;\n      context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n      context.textBaseline = /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n      this.contextTextState_ = {\n        font: textState.font,\n        textAlign: textAlign,\n        textBaseline: textState.textBaseline\n      };\n    } else {\n      if (contextTextState.font != textState.font) {\n        contextTextState.font = context.font = textState.font;\n      }\n      if (contextTextState.textAlign != textAlign) {\n        contextTextState.textAlign = context.textAlign = /** @type {CanvasTextAlign} */ (textAlign);\n      }\n      if (contextTextState.textBaseline != textState.textBaseline) {\n        contextTextState.textBaseline = context.textBaseline =\n          /** @type {CanvasTextBaseline} */ (textState.textBaseline);\n      }\n    }\n  }\n\n  /**\n   * Set the fill and stroke style for subsequent draw operations.  To clear\n   * either fill or stroke styles, pass null for the appropriate parameter.\n   *\n   * @param {import(\"../../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../../style/Stroke.js\").default} strokeStyle Stroke style.\n   * @override\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {\n    if (!fillStyle) {\n      this.fillState_ = null;\n    } else {\n      const fillStyleColor = fillStyle.getColor();\n      this.fillState_ = {\n        fillStyle: asColorLike(fillStyleColor ?\n          fillStyleColor : defaultFillStyle)\n      };\n    }\n    if (!strokeStyle) {\n      this.strokeState_ = null;\n    } else {\n      const strokeStyleColor = strokeStyle.getColor();\n      const strokeStyleLineCap = strokeStyle.getLineCap();\n      const strokeStyleLineDash = strokeStyle.getLineDash();\n      const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      const strokeStyleLineJoin = strokeStyle.getLineJoin();\n      const strokeStyleWidth = strokeStyle.getWidth();\n      const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      this.strokeState_ = {\n        lineCap: strokeStyleLineCap !== undefined ?\n          strokeStyleLineCap : defaultLineCap,\n        lineDash: strokeStyleLineDash ?\n          strokeStyleLineDash : defaultLineDash,\n        lineDashOffset: strokeStyleLineDashOffset ?\n          strokeStyleLineDashOffset : defaultLineDashOffset,\n        lineJoin: strokeStyleLineJoin !== undefined ?\n          strokeStyleLineJoin : defaultLineJoin,\n        lineWidth: this.pixelRatio_ * (strokeStyleWidth !== undefined ?\n          strokeStyleWidth : defaultLineWidth),\n        miterLimit: strokeStyleMiterLimit !== undefined ?\n          strokeStyleMiterLimit : defaultMiterLimit,\n        strokeStyle: asColorLike(strokeStyleColor ?\n          strokeStyleColor : defaultStrokeStyle)\n      };\n    }\n  }\n\n  /**\n   * Set the image style for subsequent draw operations.  Pass null to remove\n   * the image style.\n   *\n   * @param {import(\"../../style/Image.js\").default} imageStyle Image style.\n   * @override\n   */\n  setImageStyle(imageStyle) {\n    if (!imageStyle) {\n      this.image_ = null;\n    } else {\n      const imageAnchor = imageStyle.getAnchor();\n      // FIXME pixel ratio\n      const imageImage = imageStyle.getImage(1);\n      const imageOrigin = imageStyle.getOrigin();\n      const imageSize = imageStyle.getSize();\n      this.imageAnchorX_ = imageAnchor[0];\n      this.imageAnchorY_ = imageAnchor[1];\n      this.imageHeight_ = imageSize[1];\n      this.image_ = imageImage;\n      this.imageOpacity_ = imageStyle.getOpacity();\n      this.imageOriginX_ = imageOrigin[0];\n      this.imageOriginY_ = imageOrigin[1];\n      this.imageRotateWithView_ = imageStyle.getRotateWithView();\n      this.imageRotation_ = imageStyle.getRotation();\n      this.imageScale_ = imageStyle.getScale() * this.pixelRatio_;\n      this.imageWidth_ = imageSize[0];\n    }\n  }\n\n  /**\n   * Set the text style for subsequent draw operations.  Pass null to\n   * remove the text style.\n   *\n   * @param {import(\"../../style/Text.js\").default} textStyle Text style.\n   * @override\n   */\n  setTextStyle(textStyle) {\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      const textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        this.textFillState_ = null;\n      } else {\n        const textFillStyleColor = textFillStyle.getColor();\n        this.textFillState_ = {\n          fillStyle: asColorLike(textFillStyleColor ?\n            textFillStyleColor : defaultFillStyle)\n        };\n      }\n      const textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        this.textStrokeState_ = null;\n      } else {\n        const textStrokeStyleColor = textStrokeStyle.getColor();\n        const textStrokeStyleLineCap = textStrokeStyle.getLineCap();\n        const textStrokeStyleLineDash = textStrokeStyle.getLineDash();\n        const textStrokeStyleLineDashOffset = textStrokeStyle.getLineDashOffset();\n        const textStrokeStyleLineJoin = textStrokeStyle.getLineJoin();\n        const textStrokeStyleWidth = textStrokeStyle.getWidth();\n        const textStrokeStyleMiterLimit = textStrokeStyle.getMiterLimit();\n        this.textStrokeState_ = {\n          lineCap: textStrokeStyleLineCap !== undefined ?\n            textStrokeStyleLineCap : defaultLineCap,\n          lineDash: textStrokeStyleLineDash ?\n            textStrokeStyleLineDash : defaultLineDash,\n          lineDashOffset: textStrokeStyleLineDashOffset ?\n            textStrokeStyleLineDashOffset : defaultLineDashOffset,\n          lineJoin: textStrokeStyleLineJoin !== undefined ?\n            textStrokeStyleLineJoin : defaultLineJoin,\n          lineWidth: textStrokeStyleWidth !== undefined ?\n            textStrokeStyleWidth : defaultLineWidth,\n          miterLimit: textStrokeStyleMiterLimit !== undefined ?\n            textStrokeStyleMiterLimit : defaultMiterLimit,\n          strokeStyle: asColorLike(textStrokeStyleColor ?\n            textStrokeStyleColor : defaultStrokeStyle)\n        };\n      }\n      const textFont = textStyle.getFont();\n      const textOffsetX = textStyle.getOffsetX();\n      const textOffsetY = textStyle.getOffsetY();\n      const textRotateWithView = textStyle.getRotateWithView();\n      const textRotation = textStyle.getRotation();\n      const textScale = textStyle.getScale();\n      const textText = textStyle.getText();\n      const textTextAlign = textStyle.getTextAlign();\n      const textTextBaseline = textStyle.getTextBaseline();\n      this.textState_ = {\n        font: textFont !== undefined ?\n          textFont : defaultFont,\n        textAlign: textTextAlign !== undefined ?\n          textTextAlign : defaultTextAlign,\n        textBaseline: textTextBaseline !== undefined ?\n          textTextBaseline : defaultTextBaseline\n      };\n      this.text_ = textText !== undefined ? textText : '';\n      this.textOffsetX_ =\n          textOffsetX !== undefined ? (this.pixelRatio_ * textOffsetX) : 0;\n      this.textOffsetY_ =\n          textOffsetY !== undefined ? (this.pixelRatio_ * textOffsetY) : 0;\n      this.textRotateWithView_ = textRotateWithView !== undefined ? textRotateWithView : false;\n      this.textRotation_ = textRotation !== undefined ? textRotation : 0;\n      this.textScale_ = this.pixelRatio_ * (textScale !== undefined ?\n        textScale : 1);\n    }\n  }\n}\n\n\nexport default CanvasImmediateRenderer;\n","/**\n * @module ol/render\n */\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport {\n  apply as applyTransform,\n  create as createTransform,\n  multiply as multiplyTransform,\n  scale as scaleTransform\n} from './transform.js';\nimport CanvasImmediateRenderer from './render/canvas/Immediate.js';\nimport {getSquaredTolerance} from './renderer/vector.js';\nimport {getUserProjection, getTransformFromProjections} from './proj.js';\n\n\n/**\n * @typedef {Object} State\n * @property {CanvasRenderingContext2D} context Canvas context that the layer is being rendered to.\n * @property {import(\"./Feature.js\").FeatureLike} feature\n * @property {import(\"./geom/SimpleGeometry.js\").default} geometry\n * @property {number} pixelRatio Pixel ratio used by the layer renderer.\n * @property {number} resolution Resolution that the render batch was created and optimized for.\n * This is not the view's resolution that is being rendered.\n * @property {number} rotation Rotation of the rendered layer in radians.\n */\n\n\n/**\n * A function to be used when sorting features before rendering.\n * It takes two instances of {@link module:ol/Feature} or\n * {@link module:ol/render/Feature} and returns a `{number}`.\n *\n * @typedef {function(import(\"./Feature.js\").FeatureLike, import(\"./Feature.js\").FeatureLike):number} OrderFunction\n */\n\n\n/**\n * @typedef {Object} ToContextOptions\n * @property {import(\"./size.js\").Size} [size] Desired size of the canvas in css\n * pixels. When provided, both canvas and css size will be set according to the\n * `pixelRatio`. If not provided, the current canvas and css sizes will not be\n * altered.\n * @property {number} [pixelRatio=window.devicePixelRatio] Pixel ratio (canvas\n * pixel to css pixel ratio) for the canvas.\n */\n\n\n/**\n * Binds a Canvas Immediate API to a canvas context, to allow drawing geometries\n * to the context's canvas.\n *\n * The units for geometry coordinates are css pixels relative to the top left\n * corner of the canvas element.\n * ```js\n * import {toContext} from 'ol/render';\n * import Fill from 'ol/style/Fill';\n * import Polygon from 'ol/geom/Polygon';\n *\n * var canvas = document.createElement('canvas');\n * var render = toContext(canvas.getContext('2d'),\n *     { size: [100, 100] });\n * render.setFillStrokeStyle(new Fill({ color: blue }));\n * render.drawPolygon(\n *     new Polygon([[[0, 0], [100, 100], [100, 0], [0, 0]]]));\n * ```\n *\n * @param {CanvasRenderingContext2D} context Canvas context.\n * @param {ToContextOptions=} opt_options Options.\n * @return {CanvasImmediateRenderer} Canvas Immediate.\n * @api\n */\nexport function toContext(context, opt_options) {\n  const canvas = context.canvas;\n  const options = opt_options ? opt_options : {};\n  const pixelRatio = options.pixelRatio || DEVICE_PIXEL_RATIO;\n  const size = options.size;\n  if (size) {\n    canvas.width = size[0] * pixelRatio;\n    canvas.height = size[1] * pixelRatio;\n    canvas.style.width = size[0] + 'px';\n    canvas.style.height = size[1] + 'px';\n  }\n  const extent = [0, 0, canvas.width, canvas.height];\n  const transform = scaleTransform(createTransform(), pixelRatio, pixelRatio);\n  return new CanvasImmediateRenderer(context, pixelRatio, extent, transform, 0);\n}\n\n/**\n * Gets a vector context for drawing to the event's canvas.\n * @param {import(\"./render/Event.js\").default} event Render event.\n * @returns {CanvasImmediateRenderer} Vector context.\n * @api\n */\nexport function getVectorContext(event) {\n  const frameState = event.frameState;\n  const transform = multiplyTransform(event.inversePixelTransform.slice(), frameState.coordinateToPixelTransform);\n  const squaredTolerance = getSquaredTolerance(frameState.viewState.resolution, frameState.pixelRatio);\n  let userTransform;\n  const userProjection = getUserProjection();\n  if (userProjection) {\n    userTransform = getTransformFromProjections(userProjection, frameState.viewState.projection);\n  }\n  return new CanvasImmediateRenderer(\n    event.context, frameState.pixelRatio, frameState.extent, transform,\n    frameState.viewState.rotation, squaredTolerance, userTransform);\n}\n\n/**\n * Gets the pixel of the event's canvas context from the map viewport's CSS pixel.\n * @param {import(\"./render/Event.js\").default} event Render event.\n * @param {import(\"./pixel.js\").Pixel} pixel CSS pixel relative to the top-left\n * corner of the map viewport.\n * @returns {import(\"./pixel.js\").Pixel} Pixel on the event's canvas context.\n * @api\n */\nexport function getRenderPixel(event, pixel) {\n  const result = pixel.slice(0);\n  applyTransform(event.inversePixelTransform.slice(), result);\n  return result;\n}\n\n/**\n * @param {import(\"./PluggableMap.js\").FrameState} frameState Frame state.\n * @param {?} declutterTree Declutter tree.\n * @returns {?} Declutter tree.\n */\nexport function renderDeclutterItems(frameState, declutterTree) {\n  if (declutterTree) {\n    declutterTree.clear();\n  }\n  const items = frameState.declutterItems;\n  for (let z = items.length - 1; z >= 0; --z) {\n    const item = items[z];\n    const zIndexItems = item.items;\n    for (let i = 0, ii = zIndexItems.length; i < ii; i += 3) {\n      declutterTree = zIndexItems[i].renderDeclutter(zIndexItems[i + 1], zIndexItems[i + 2], item.opacity, declutterTree);\n    }\n  }\n  items.length = 0;\n  return declutterTree;\n}\n","/**\n * @module ol/source/Stamen\n */\n\nimport {ATTRIBUTION as OSM_ATTRIBUTION} from './OSM.js';\nimport XYZ from './XYZ.js';\n\n\n/**\n * @const\n * @type {Array<string>}\n */\nconst ATTRIBUTIONS = [\n  'Map tiles by <a href=\"https://stamen.com/\">Stamen Design</a>, ' +\n        'under <a href=\"https://creativecommons.org/licenses/by/3.0/\">CC BY' +\n        ' 3.0</a>.',\n  OSM_ATTRIBUTION\n];\n\n\n/**\n * @type {Object<string, {extension: string, opaque: boolean}>}\n */\nconst LayerConfig = {\n  'terrain': {\n    extension: 'jpg',\n    opaque: true\n  },\n  'terrain-background': {\n    extension: 'jpg',\n    opaque: true\n  },\n  'terrain-labels': {\n    extension: 'png',\n    opaque: false\n  },\n  'terrain-lines': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-background': {\n    extension: 'png',\n    opaque: true\n  },\n  'toner': {\n    extension: 'png',\n    opaque: true\n  },\n  'toner-hybrid': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-labels': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-lines': {\n    extension: 'png',\n    opaque: false\n  },\n  'toner-lite': {\n    extension: 'png',\n    opaque: true\n  },\n  'watercolor': {\n    extension: 'jpg',\n    opaque: true\n  }\n};\n\n\n/**\n * @type {Object<string, {minZoom: number, maxZoom: number}>}\n */\nconst ProviderConfig = {\n  'terrain': {\n    minZoom: 0,\n    maxZoom: 18\n  },\n  'toner': {\n    minZoom: 0,\n    maxZoom: 20\n  },\n  'watercolor': {\n    minZoom: 0,\n    maxZoom: 18\n  }\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {string} layer Layer name.\n * @property {number} [minZoom] Minimum zoom.\n * @property {number} [maxZoom] Maximum zoom.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction]\n * Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source for the Stamen tile server.\n * @api\n */\nclass Stamen extends XYZ {\n  /**\n   * @param {Options} options Stamen options.\n   */\n  constructor(options) {\n    const i = options.layer.indexOf('-');\n    const provider = i == -1 ? options.layer : options.layer.slice(0, i);\n    const providerConfig = ProviderConfig[provider];\n\n    const layerConfig = LayerConfig[options.layer];\n\n    const url = options.url !== undefined ? options.url :\n      'https://stamen-tiles-{a-d}.a.ssl.fastly.net/' + options.layer +\n        '/{z}/{x}/{y}.' + layerConfig.extension;\n\n    super({\n      attributions: ATTRIBUTIONS,\n      cacheSize: options.cacheSize,\n      crossOrigin: 'anonymous',\n      maxZoom: options.maxZoom != undefined ? options.maxZoom : providerConfig.maxZoom,\n      minZoom: options.minZoom != undefined ? options.minZoom : providerConfig.minZoom,\n      opaque: layerConfig.opaque,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileLoadFunction: options.tileLoadFunction,\n      transition: options.transition,\n      url: url,\n      wrapX: options.wrapX\n    });\n\n  }\n\n}\n\nexport default Stamen;\n","/**\n * @module ol/interaction/Draw\n */\nimport EventType from '../events/EventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport MapBrowserPointerEvent from '../MapBrowserPointerEvent.js';\nimport {getChangeEventType} from '../Object.js';\nimport {squaredDistance as squaredCoordinateDistance} from '../coordinate.js';\nimport Event from '../events/Event.js';\nimport {noModifierKeys, always, shiftKeyOnly} from '../events/condition.js';\nimport {boundingExtent, getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport Circle from '../geom/Circle.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon, {fromCircle, makeRegular} from '../geom/Polygon.js';\nimport PointerInteraction from './Pointer.js';\nimport InteractionProperty from './Property.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport {createEditingStyle} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {GeometryType} type Geometry type of\n * the geometries being drawn with this instance.\n * @property {number} [clickTolerance=6] The maximum distance in pixels between\n * \"down\" and \"up\" for a \"up\" event to be considered a \"click\" event and\n * actually add a point/vertex to the geometry being drawn.  The default of `6`\n * was chosen for the draw interaction to behave correctly on mouse as well as\n * on touch devices.\n * @property {import(\"../Collection.js\").default<Feature>} [features]\n * Destination collection for the drawn features.\n * @property {VectorSource} [source] Destination source for\n * the drawn features.\n * @property {number} [dragVertexDelay=500] Delay in milliseconds after pointerdown\n * before the current vertex can be dragged to its exact position.\n * @property {number} [snapTolerance=12] Pixel distance for snapping to the\n * drawing finish.\n * @property {boolean} [stopClick=false] Stop click, singleclick, and\n * doubleclick events from firing during drawing.\n * @property {number} [maxPoints] The number of points that can be drawn before\n * a polygon ring or line string is finished. By default there is no\n * restriction.\n * @property {number} [minPoints] The number of points that must be drawn\n * before a polygon ring or line string can be finished. Default is `3` for\n * polygon rings and `2` for line strings.\n * @property {import(\"../events/condition.js\").Condition} [finishCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether the drawing can be finished.\n * @property {import(\"../style/Style.js\").StyleLike} [style]\n * Style for sketch features.\n * @property {GeometryFunction} [geometryFunction]\n * Function that is called when a geometry's coordinates are updated.\n * @property {string} [geometryName] Geometry name to use for features created\n * by the draw interaction.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default {@link module:ol/events/condition~noModifierKeys}, i.e. a click,\n * adds a vertex or deactivates freehand drawing.\n * @property {boolean} [freehand=false] Operate in freehand mode for lines,\n * polygons, and circles.  This makes the interaction always operate in freehand\n * mode and takes precedence over any `freehandCondition` option.\n * @property {import(\"../events/condition.js\").Condition} [freehandCondition]\n * Condition that activates freehand drawing for lines and polygons. This\n * function takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether that event should be handled. The\n * default is {@link module:ol/events/condition~shiftKeyOnly}, meaning that the\n * Shift key activates freehand drawing.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * Coordinate type when drawing points.\n * @typedef {import(\"../coordinate.js\").Coordinate} PointCoordType\n */\n\n\n/**\n * Coordinate type when drawing lines.\n * @typedef {Array<import(\"../coordinate.js\").Coordinate>} LineCoordType\n */\n\n\n/**\n * Coordinate type when drawing polygons.\n * @typedef {Array<Array<import(\"../coordinate.js\").Coordinate>>} PolyCoordType\n */\n\n\n/**\n * Types used for drawing coordinates.\n * @typedef {PointCoordType|LineCoordType|PolyCoordType} SketchCoordType\n */\n\n\n/**\n * Function that takes an array of coordinates and an optional existing geometry as\n * arguments, and returns a geometry. The optional existing geometry is the\n * geometry that is returned when the function is called without a second\n * argument.\n * @typedef {function(!SketchCoordType, import(\"../geom/SimpleGeometry.js\").default=):\n *     import(\"../geom/SimpleGeometry.js\").default} GeometryFunction\n */\n\n\n/**\n * Draw mode.  This collapses multi-part geometry types with their single-part\n * cousins.\n * @enum {string}\n */\nconst Mode = {\n  POINT: 'Point',\n  LINE_STRING: 'LineString',\n  POLYGON: 'Polygon',\n  CIRCLE: 'Circle'\n};\n\n\n/**\n * @enum {string}\n */\nconst DrawEventType = {\n  /**\n   * Triggered upon feature draw start\n   * @event DrawEvent#drawstart\n   * @api\n   */\n  DRAWSTART: 'drawstart',\n  /**\n   * Triggered upon feature draw end\n   * @event DrawEvent#drawend\n   * @api\n   */\n  DRAWEND: 'drawend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Draw~Draw} instances are\n * instances of this type.\n */\nclass DrawEvent extends Event {\n  /**\n   * @param {DrawEventType} type Type.\n   * @param {Feature} feature The feature drawn.\n   */\n  constructor(type, feature) {\n\n    super(type);\n\n    /**\n     * The feature being drawn.\n     * @type {Feature}\n     * @api\n     */\n    this.feature = feature;\n\n  }\n\n}\n\n\n/**\n * @classdesc\n * Interaction for drawing feature geometries.\n *\n * @fires DrawEvent\n * @api\n */\nclass Draw extends PointerInteraction {\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n\n    const pointerOptions = /** @type {import(\"./Pointer.js\").Options} */ (options);\n    if (!pointerOptions.stopDown) {\n      pointerOptions.stopDown = FALSE;\n    }\n\n    super(pointerOptions);\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.shouldHandle_ = false;\n\n    /**\n     * @type {import(\"../pixel.js\").Pixel}\n     * @private\n     */\n    this.downPx_ = null;\n\n    /**\n     * @type {?}\n     * @private\n     */\n    this.downTimeout_;\n\n    /**\n     * @type {number|undefined}\n     * @private\n     */\n    this.lastDragTime_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.freehand_ = false;\n\n    /**\n     * Target source for drawn features.\n     * @type {VectorSource}\n     * @private\n     */\n    this.source_ = options.source ? options.source : null;\n\n    /**\n     * Target collection for drawn features.\n     * @type {import(\"../Collection.js\").default<Feature>}\n     * @private\n     */\n    this.features_ = options.features ? options.features : null;\n\n    /**\n     * Pixel distance for snapping.\n     * @type {number}\n     * @private\n     */\n    this.snapTolerance_ = options.snapTolerance ? options.snapTolerance : 12;\n\n    /**\n     * Geometry type.\n     * @type {GeometryType}\n     * @private\n     */\n    this.type_ = /** @type {GeometryType} */ (options.type);\n\n    /**\n     * Drawing mode (derived from geometry type.\n     * @type {Mode}\n     * @private\n     */\n    this.mode_ = getMode(this.type_);\n\n    /**\n     * Stop click, singleclick, and doubleclick events from firing during drawing.\n     * Default is `false`.\n     * @type {boolean}\n     * @private\n     */\n    this.stopClick_ = !!options.stopClick;\n\n    /**\n     * The number of points that must be drawn before a polygon ring or line\n     * string can be finished.  The default is 3 for polygon rings and 2 for\n     * line strings.\n     * @type {number}\n     * @private\n     */\n    this.minPoints_ = options.minPoints ?\n      options.minPoints :\n      (this.mode_ === Mode.POLYGON ? 3 : 2);\n\n    /**\n     * The number of points that can be drawn before a polygon ring or line string\n     * is finished. The default is no restriction.\n     * @type {number}\n     * @private\n     */\n    this.maxPoints_ = options.maxPoints ? options.maxPoints : Infinity;\n\n    /**\n     * A function to decide if a potential finish coordinate is permissible\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.finishCondition_ = options.finishCondition ? options.finishCondition : TRUE;\n\n    let geometryFunction = options.geometryFunction;\n    if (!geometryFunction) {\n      if (this.type_ === GeometryType.CIRCLE) {\n        /**\n         * @param {!LineCoordType} coordinates The coordinates.\n         * @param {import(\"../geom/SimpleGeometry.js\").default=} opt_geometry Optional geometry.\n         * @return {import(\"../geom/SimpleGeometry.js\").default} A geometry.\n         */\n        geometryFunction = function(coordinates, opt_geometry) {\n          const circle = opt_geometry ? /** @type {Circle} */ (opt_geometry) :\n            new Circle([NaN, NaN]);\n          const squaredLength = squaredCoordinateDistance(\n            coordinates[0], coordinates[1]);\n          circle.setCenterAndRadius(coordinates[0], Math.sqrt(squaredLength));\n          return circle;\n        };\n      } else {\n        let Constructor;\n        const mode = this.mode_;\n        if (mode === Mode.POINT) {\n          Constructor = Point;\n        } else if (mode === Mode.LINE_STRING) {\n          Constructor = LineString;\n        } else if (mode === Mode.POLYGON) {\n          Constructor = Polygon;\n        }\n        /**\n         * @param {!LineCoordType} coordinates The coordinates.\n         * @param {import(\"../geom/SimpleGeometry.js\").default=} opt_geometry Optional geometry.\n         * @return {import(\"../geom/SimpleGeometry.js\").default} A geometry.\n         */\n        geometryFunction = function(coordinates, opt_geometry) {\n          let geometry = opt_geometry;\n          if (geometry) {\n            if (mode === Mode.POLYGON) {\n              if (coordinates[0].length) {\n                // Add a closing coordinate to match the first\n                geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n              } else {\n                geometry.setCoordinates([]);\n              }\n            } else {\n              geometry.setCoordinates(coordinates);\n            }\n          } else {\n            geometry = new Constructor(coordinates);\n          }\n          return geometry;\n        };\n      }\n    }\n\n    /**\n     * @type {GeometryFunction}\n     * @private\n     */\n    this.geometryFunction_ = geometryFunction;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.dragVertexDelay_ = options.dragVertexDelay !== undefined ? options.dragVertexDelay : 500;\n\n    /**\n     * Finish coordinate for the feature (first point for polygons, last point for\n     * linestrings).\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n    this.finishCoordinate_ = null;\n\n    /**\n     * Sketch feature.\n     * @type {Feature}\n     * @private\n     */\n    this.sketchFeature_ = null;\n\n    /**\n     * Sketch point.\n     * @type {Feature<Point>}\n     * @private\n     */\n    this.sketchPoint_ = null;\n\n    /**\n     * Sketch coordinates. Used when drawing a line or polygon.\n     * @type {SketchCoordType}\n     * @private\n     */\n    this.sketchCoords_ = null;\n\n    /**\n     * Sketch line. Used when drawing polygon.\n     * @type {Feature<LineString>}\n     * @private\n     */\n    this.sketchLine_ = null;\n\n    /**\n     * Sketch line coordinates. Used when drawing a polygon or circle.\n     * @type {LineCoordType}\n     * @private\n     */\n    this.sketchLineCoords_ = null;\n\n    /**\n     * Squared tolerance for handling up events.  If the squared distance\n     * between a down and up event is greater than this tolerance, up events\n     * will not be handled.\n     * @type {number}\n     * @private\n     */\n    this.squaredClickTolerance_ = options.clickTolerance ?\n      options.clickTolerance * options.clickTolerance : 36;\n\n    /**\n     * Draw overlay where our sketch features are drawn.\n     * @type {VectorLayer}\n     * @private\n     */\n    this.overlay_ = new VectorLayer({\n      source: new VectorSource({\n        useSpatialIndex: false,\n        wrapX: options.wrapX ? options.wrapX : false\n      }),\n      style: options.style ? options.style : getDefaultStyleFunction(),\n      updateWhileInteracting: true\n    });\n\n    /**\n     * Name of the geometry attribute for newly created features.\n     * @type {string|undefined}\n     * @private\n     */\n    this.geometryName_ = options.geometryName;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : noModifierKeys;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.freehandCondition_;\n    if (options.freehand) {\n      this.freehandCondition_ = always;\n    } else {\n      this.freehandCondition_ = options.freehandCondition ? options.freehandCondition : shiftKeyOnly;\n    }\n\n    this.addEventListener(getChangeEventType(InteractionProperty.ACTIVE), this.updateState_);\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setMap(map) {\n    super.setMap(map);\n    this.updateState_();\n  }\n\n  /**\n   * Get the overlay layer that this interaction renders sketch features to.\n   * @return {VectorLayer} Overlay layer.\n   * @api\n   */\n  getOverlay() {\n    return this.overlay_;\n  }\n\n  /**\n   * Handles the {@link module:ol/MapBrowserEvent map browser event} and may actually draw or finish the drawing.\n   * @override\n   * @api\n   */\n  handleEvent(event) {\n    if (event.originalEvent.type === EventType.CONTEXTMENU) {\n      // Avoid context menu for long taps when drawing on mobile\n      event.preventDefault();\n    }\n    this.freehand_ = this.mode_ !== Mode.POINT && this.freehandCondition_(event);\n    let move = event.type === MapBrowserEventType.POINTERMOVE;\n    let pass = true;\n    if (!this.freehand_ && this.lastDragTime_ && event.type === MapBrowserEventType.POINTERDRAG) {\n      const now = Date.now();\n      if (now - this.lastDragTime_ >= this.dragVertexDelay_) {\n        this.downPx_ = event.pixel;\n        this.shouldHandle_ = !this.freehand_;\n        move = true;\n      } else {\n        this.lastDragTime_ = undefined;\n      }\n      if (this.shouldHandle_ && this.downTimeout_ !== undefined) {\n        clearTimeout(this.downTimeout_);\n        this.downTimeout_ = undefined;\n      }\n    }\n    if (this.freehand_ &&\n        event.type === MapBrowserEventType.POINTERDRAG &&\n        this.sketchFeature_ !== null) {\n      this.addToDrawing_(event);\n      pass = false;\n    } else if (this.freehand_ &&\n        event.type === MapBrowserEventType.POINTERDOWN) {\n      pass = false;\n    } else if (move) {\n      pass = event.type === MapBrowserEventType.POINTERMOVE;\n      if (pass && this.freehand_) {\n        pass = this.handlePointerMove_(event);\n      } else if (/** @type {MapBrowserPointerEvent} */ (event).pointerEvent.pointerType == 'mouse' ||\n          (event.type === MapBrowserEventType.POINTERDRAG && this.downTimeout_ === undefined)) {\n        this.handlePointerMove_(event);\n      }\n    } else if (event.type === MapBrowserEventType.DBLCLICK) {\n      pass = false;\n    }\n\n    return super.handleEvent(event) && pass;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(event) {\n    this.shouldHandle_ = !this.freehand_;\n\n    if (this.freehand_) {\n      this.downPx_ = event.pixel;\n      if (!this.finishCoordinate_) {\n        this.startDrawing_(event);\n      }\n      return true;\n    } else if (this.condition_(event)) {\n      this.lastDragTime_ = Date.now();\n      this.downTimeout_ = setTimeout(function() {\n        this.handlePointerMove_(new MapBrowserPointerEvent(\n          MapBrowserEventType.POINTERMOVE, event.map, event.pointerEvent, false, event.frameState));\n      }.bind(this), this.dragVertexDelay_);\n      this.downPx_ = event.pixel;\n      return true;\n    } else {\n      this.lastDragTime_ = undefined;\n      return false;\n    }\n  }\n\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(event) {\n    let pass = true;\n\n    if (this.downTimeout_) {\n      clearTimeout(this.downTimeout_);\n      this.downTimeout_ = undefined;\n    }\n\n    this.handlePointerMove_(event);\n\n    const circleMode = this.mode_ === Mode.CIRCLE;\n\n    if (this.shouldHandle_) {\n      if (!this.finishCoordinate_) {\n        this.startDrawing_(event);\n        if (this.mode_ === Mode.POINT) {\n          this.finishDrawing();\n        }\n      } else if (this.freehand_ || circleMode) {\n        this.finishDrawing();\n      } else if (this.atFinish_(event)) {\n        if (this.finishCondition_(event)) {\n          this.finishDrawing();\n        }\n      } else {\n        this.addToDrawing_(event);\n      }\n      pass = false;\n    } else if (this.freehand_) {\n      this.finishCoordinate_ = null;\n      this.abortDrawing_();\n    }\n    if (!pass && this.stopClick_) {\n      event.stopPropagation();\n    }\n    return pass;\n  }\n\n  /**\n   * Handle move events.\n   * @param {import(\"../MapBrowserEvent.js\").default} event A move event.\n   * @return {boolean} Pass the event to other interactions.\n   * @private\n   */\n  handlePointerMove_(event) {\n    if (this.downPx_ &&\n        ((!this.freehand_ && this.shouldHandle_) ||\n        (this.freehand_ && !this.shouldHandle_))) {\n      const downPx = this.downPx_;\n      const clickPx = event.pixel;\n      const dx = downPx[0] - clickPx[0];\n      const dy = downPx[1] - clickPx[1];\n      const squaredDistance = dx * dx + dy * dy;\n      this.shouldHandle_ = this.freehand_ ?\n        squaredDistance > this.squaredClickTolerance_ :\n        squaredDistance <= this.squaredClickTolerance_;\n      if (!this.shouldHandle_) {\n        return true;\n      }\n    }\n\n    if (this.finishCoordinate_) {\n      this.modifyDrawing_(event);\n    } else {\n      this.createOrUpdateSketchPoint_(event);\n    }\n    return true;\n  }\n\n  /**\n   * Determine if an event is within the snapping tolerance of the start coord.\n   * @param {import(\"../MapBrowserEvent.js\").default} event Event.\n   * @return {boolean} The event is within the snapping tolerance of the start.\n   * @private\n   */\n  atFinish_(event) {\n    let at = false;\n    if (this.sketchFeature_) {\n      let potentiallyDone = false;\n      let potentiallyFinishCoordinates = [this.finishCoordinate_];\n      if (this.mode_ === Mode.LINE_STRING) {\n        potentiallyDone = this.sketchCoords_.length > this.minPoints_;\n      } else if (this.mode_ === Mode.POLYGON) {\n        const sketchCoords = /** @type {PolyCoordType} */ (this.sketchCoords_);\n        potentiallyDone = sketchCoords[0].length > this.minPoints_;\n        potentiallyFinishCoordinates = [sketchCoords[0][0], sketchCoords[0][sketchCoords[0].length - 2]];\n      }\n      if (potentiallyDone) {\n        const map = event.map;\n        for (let i = 0, ii = potentiallyFinishCoordinates.length; i < ii; i++) {\n          const finishCoordinate = potentiallyFinishCoordinates[i];\n          const finishPixel = map.getPixelFromCoordinate(finishCoordinate);\n          const pixel = event.pixel;\n          const dx = pixel[0] - finishPixel[0];\n          const dy = pixel[1] - finishPixel[1];\n          const snapTolerance = this.freehand_ ? 1 : this.snapTolerance_;\n          at = Math.sqrt(dx * dx + dy * dy) <= snapTolerance;\n          if (at) {\n            this.finishCoordinate_ = finishCoordinate;\n            break;\n          }\n        }\n      }\n    }\n    return at;\n  }\n\n  /**\n   * @param {import(\"../MapBrowserEvent.js\").default} event Event.\n   * @private\n   */\n  createOrUpdateSketchPoint_(event) {\n    const coordinates = event.coordinate.slice();\n    if (!this.sketchPoint_) {\n      this.sketchPoint_ = new Feature(new Point(coordinates));\n      this.updateSketchFeatures_();\n    } else {\n      const sketchPointGeom = this.sketchPoint_.getGeometry();\n      sketchPointGeom.setCoordinates(coordinates);\n    }\n  }\n\n  /**\n   * Start the drawing.\n   * @param {import(\"../MapBrowserEvent.js\").default} event Event.\n   * @private\n   */\n  startDrawing_(event) {\n    const start = event.coordinate;\n    this.finishCoordinate_ = start;\n    if (this.mode_ === Mode.POINT) {\n      this.sketchCoords_ = start.slice();\n    } else if (this.mode_ === Mode.POLYGON) {\n      this.sketchCoords_ = [[start.slice(), start.slice()]];\n      this.sketchLineCoords_ = this.sketchCoords_[0];\n    } else {\n      this.sketchCoords_ = [start.slice(), start.slice()];\n    }\n    if (this.sketchLineCoords_) {\n      this.sketchLine_ = new Feature(\n        new LineString(this.sketchLineCoords_));\n    }\n    const geometry = this.geometryFunction_(this.sketchCoords_);\n    this.sketchFeature_ = new Feature();\n    if (this.geometryName_) {\n      this.sketchFeature_.setGeometryName(this.geometryName_);\n    }\n    this.sketchFeature_.setGeometry(geometry);\n    this.updateSketchFeatures_();\n    this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n  }\n\n  /**\n   * Modify the drawing.\n   * @param {import(\"../MapBrowserEvent.js\").default} event Event.\n   * @private\n   */\n  modifyDrawing_(event) {\n    let coordinate = event.coordinate;\n    const geometry = this.sketchFeature_.getGeometry();\n    let coordinates, last;\n    if (this.mode_ === Mode.POINT) {\n      last = this.sketchCoords_;\n    } else if (this.mode_ === Mode.POLYGON) {\n      coordinates = /** @type {PolyCoordType} */ (this.sketchCoords_)[0];\n      last = coordinates[coordinates.length - 1];\n      if (this.atFinish_(event)) {\n        // snap to finish\n        coordinate = this.finishCoordinate_.slice();\n      }\n    } else {\n      coordinates = this.sketchCoords_;\n      last = coordinates[coordinates.length - 1];\n    }\n    last[0] = coordinate[0];\n    last[1] = coordinate[1];\n    this.geometryFunction_(/** @type {!LineCoordType} */ (this.sketchCoords_), geometry);\n    if (this.sketchPoint_) {\n      const sketchPointGeom = this.sketchPoint_.getGeometry();\n      sketchPointGeom.setCoordinates(coordinate);\n    }\n    /** @type {LineString} */\n    let sketchLineGeom;\n    if (geometry.getType() == GeometryType.POLYGON &&\n        this.mode_ !== Mode.POLYGON) {\n      if (!this.sketchLine_) {\n        this.sketchLine_ = new Feature();\n      }\n      const ring = geometry.getLinearRing(0);\n      sketchLineGeom = this.sketchLine_.getGeometry();\n      if (!sketchLineGeom) {\n        sketchLineGeom = new LineString(ring.getFlatCoordinates(), ring.getLayout());\n        this.sketchLine_.setGeometry(sketchLineGeom);\n      } else {\n        sketchLineGeom.setFlatCoordinates(\n          ring.getLayout(), ring.getFlatCoordinates());\n        sketchLineGeom.changed();\n      }\n    } else if (this.sketchLineCoords_) {\n      sketchLineGeom = this.sketchLine_.getGeometry();\n      sketchLineGeom.setCoordinates(this.sketchLineCoords_);\n    }\n    this.updateSketchFeatures_();\n  }\n\n  /**\n   * Add a new coordinate to the drawing.\n   * @param {import(\"../MapBrowserEvent.js\").default} event Event.\n   * @private\n   */\n  addToDrawing_(event) {\n    const coordinate = event.coordinate;\n    const geometry = this.sketchFeature_.getGeometry();\n    let done;\n    let coordinates;\n    if (this.mode_ === Mode.LINE_STRING) {\n      this.finishCoordinate_ = coordinate.slice();\n      coordinates = /** @type {LineCoordType} */ (this.sketchCoords_);\n      if (coordinates.length >= this.maxPoints_) {\n        if (this.freehand_) {\n          coordinates.pop();\n        } else {\n          done = true;\n        }\n      }\n      coordinates.push(coordinate.slice());\n      this.geometryFunction_(coordinates, geometry);\n    } else if (this.mode_ === Mode.POLYGON) {\n      coordinates = /** @type {PolyCoordType} */ (this.sketchCoords_)[0];\n      if (coordinates.length >= this.maxPoints_) {\n        if (this.freehand_) {\n          coordinates.pop();\n        } else {\n          done = true;\n        }\n      }\n      coordinates.push(coordinate.slice());\n      if (done) {\n        this.finishCoordinate_ = coordinates[0];\n      }\n      this.geometryFunction_(this.sketchCoords_, geometry);\n    }\n    this.updateSketchFeatures_();\n    if (done) {\n      this.finishDrawing();\n    }\n  }\n\n  /**\n   * Remove last point of the feature currently being drawn.\n   * @api\n   */\n  removeLastPoint() {\n    if (!this.sketchFeature_) {\n      return;\n    }\n    const geometry = this.sketchFeature_.getGeometry();\n    let coordinates;\n    /** @type {LineString} */\n    let sketchLineGeom;\n    if (this.mode_ === Mode.LINE_STRING) {\n      coordinates = /** @type {LineCoordType} */ (this.sketchCoords_);\n      coordinates.splice(-2, 1);\n      this.geometryFunction_(coordinates, geometry);\n      if (coordinates.length >= 2) {\n        this.finishCoordinate_ = coordinates[coordinates.length - 2].slice();\n      }\n    } else if (this.mode_ === Mode.POLYGON) {\n      coordinates = /** @type {PolyCoordType} */ (this.sketchCoords_)[0];\n      coordinates.splice(-2, 1);\n      sketchLineGeom = this.sketchLine_.getGeometry();\n      sketchLineGeom.setCoordinates(coordinates);\n      this.geometryFunction_(this.sketchCoords_, geometry);\n    }\n\n    if (coordinates.length === 0) {\n      this.finishCoordinate_ = null;\n    }\n\n    this.updateSketchFeatures_();\n  }\n\n  /**\n   * Stop drawing and add the sketch feature to the target layer.\n   * The {@link module:ol/interaction/Draw~DrawEventType.DRAWEND} event is\n   * dispatched before inserting the feature.\n   * @api\n   */\n  finishDrawing() {\n    const sketchFeature = this.abortDrawing_();\n    if (!sketchFeature) {\n      return;\n    }\n    let coordinates = this.sketchCoords_;\n    const geometry = sketchFeature.getGeometry();\n    if (this.mode_ === Mode.LINE_STRING) {\n      // remove the redundant last point\n      coordinates.pop();\n      this.geometryFunction_(coordinates, geometry);\n    } else if (this.mode_ === Mode.POLYGON) {\n      // remove the redundant last point in ring\n      /** @type {PolyCoordType} */ (coordinates)[0].pop();\n      this.geometryFunction_(coordinates, geometry);\n      coordinates = geometry.getCoordinates();\n    }\n\n    // cast multi-part geometries\n    if (this.type_ === GeometryType.MULTI_POINT) {\n      sketchFeature.setGeometry(new MultiPoint([/** @type {PointCoordType} */(coordinates)]));\n    } else if (this.type_ === GeometryType.MULTI_LINE_STRING) {\n      sketchFeature.setGeometry(new MultiLineString([/** @type {LineCoordType} */(coordinates)]));\n    } else if (this.type_ === GeometryType.MULTI_POLYGON) {\n      sketchFeature.setGeometry(new MultiPolygon([/** @type {PolyCoordType} */(coordinates)]));\n    }\n\n    // First dispatch event to allow full set up of feature\n    this.dispatchEvent(new DrawEvent(DrawEventType.DRAWEND, sketchFeature));\n\n    // Then insert feature\n    if (this.features_) {\n      this.features_.push(sketchFeature);\n    }\n    if (this.source_) {\n      this.source_.addFeature(sketchFeature);\n    }\n  }\n\n  /**\n   * Stop drawing without adding the sketch feature to the target layer.\n   * @return {Feature} The sketch feature (or null if none).\n   * @private\n   */\n  abortDrawing_() {\n    this.finishCoordinate_ = null;\n    const sketchFeature = this.sketchFeature_;\n    if (sketchFeature) {\n      this.sketchFeature_ = null;\n      this.sketchPoint_ = null;\n      this.sketchLine_ = null;\n      this.overlay_.getSource().clear(true);\n    }\n    return sketchFeature;\n  }\n\n  /**\n   * Extend an existing geometry by adding additional points. This only works\n   * on features with `LineString` geometries, where the interaction will\n   * extend lines by adding points to the end of the coordinates array.\n   * @param {!Feature<LineString>} feature Feature to be extended.\n   * @api\n   */\n  extend(feature) {\n    const geometry = feature.getGeometry();\n    const lineString = geometry;\n    this.sketchFeature_ = feature;\n    this.sketchCoords_ = lineString.getCoordinates();\n    const last = this.sketchCoords_[this.sketchCoords_.length - 1];\n    this.finishCoordinate_ = last.slice();\n    this.sketchCoords_.push(last.slice());\n    this.updateSketchFeatures_();\n    this.dispatchEvent(new DrawEvent(DrawEventType.DRAWSTART, this.sketchFeature_));\n  }\n\n  /**\n   * Redraw the sketch features.\n   * @private\n   */\n  updateSketchFeatures_() {\n    const sketchFeatures = [];\n    if (this.sketchFeature_) {\n      sketchFeatures.push(this.sketchFeature_);\n    }\n    if (this.sketchLine_) {\n      sketchFeatures.push(this.sketchLine_);\n    }\n    if (this.sketchPoint_) {\n      sketchFeatures.push(this.sketchPoint_);\n    }\n    const overlaySource = this.overlay_.getSource();\n    overlaySource.clear(true);\n    overlaySource.addFeatures(sketchFeatures);\n  }\n\n  /**\n   * @private\n   */\n  updateState_() {\n    const map = this.getMap();\n    const active = this.getActive();\n    if (!map || !active) {\n      this.abortDrawing_();\n    }\n    this.overlay_.setMap(active ? map : null);\n  }\n}\n\n\n/**\n * @return {import(\"../style/Style.js\").StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  return function(feature, resolution) {\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\n/**\n * Create a `geometryFunction` for `type: 'Circle'` that will create a regular\n * polygon with a user specified number of sides and start angle instead of an\n * `import(\"../geom/Circle.js\").Circle` geometry.\n * @param {number=} opt_sides Number of sides of the regular polygon. Default is\n *     32.\n * @param {number=} opt_angle Angle of the first point in radians. 0 means East.\n *     Default is the angle defined by the heading from the center of the\n *     regular polygon to the current pointer position.\n * @return {GeometryFunction} Function that draws a\n *     polygon.\n * @api\n */\nexport function createRegularPolygon(opt_sides, opt_angle) {\n  return function(coordinates, opt_geometry) {\n    const center = /** @type {LineCoordType} */ (coordinates)[0];\n    const end = /** @type {LineCoordType} */ (coordinates)[1];\n    const radius = Math.sqrt(\n      squaredCoordinateDistance(center, end));\n    const geometry = opt_geometry ? /** @type {Polygon} */ (opt_geometry) :\n      fromCircle(new Circle(center), opt_sides);\n    let angle = opt_angle;\n    if (!opt_angle) {\n      const x = end[0] - center[0];\n      const y = end[1] - center[1];\n      angle = Math.atan(y / x) - (x < 0 ? Math.PI : 0);\n    }\n    makeRegular(geometry, center, radius, angle);\n    return geometry;\n  };\n}\n\n\n/**\n * Create a `geometryFunction` that will create a box-shaped polygon (aligned\n * with the coordinate system axes).  Use this with the draw interaction and\n * `type: 'Circle'` to return a box instead of a circle geometry.\n * @return {GeometryFunction} Function that draws a box-shaped polygon.\n * @api\n */\nexport function createBox() {\n  return (\n    function(coordinates, opt_geometry) {\n      const extent = boundingExtent(/** @type {LineCoordType} */ (coordinates));\n      const boxCoordinates = [[\n        getBottomLeft(extent),\n        getBottomRight(extent),\n        getTopRight(extent),\n        getTopLeft(extent),\n        getBottomLeft(extent)\n      ]];\n      let geometry = opt_geometry;\n      if (geometry) {\n        geometry.setCoordinates(boxCoordinates);\n      } else {\n        geometry = new Polygon(boxCoordinates);\n      }\n      return geometry;\n    }\n  );\n}\n\n\n/**\n * Get the drawing mode.  The mode for mult-part geometries is the same as for\n * their single-part cousins.\n * @param {GeometryType} type Geometry type.\n * @return {Mode} Drawing mode.\n */\nfunction getMode(type) {\n  let mode;\n  if (type === GeometryType.POINT ||\n      type === GeometryType.MULTI_POINT) {\n    mode = Mode.POINT;\n  } else if (type === GeometryType.LINE_STRING ||\n      type === GeometryType.MULTI_LINE_STRING) {\n    mode = Mode.LINE_STRING;\n  } else if (type === GeometryType.POLYGON ||\n      type === GeometryType.MULTI_POLYGON) {\n    mode = Mode.POLYGON;\n  } else if (type === GeometryType.CIRCLE) {\n    mode = Mode.CIRCLE;\n  }\n  return (\n    /** @type {!Mode} */ (mode)\n  );\n}\n\n\nexport default Draw;\n","export default function(defs) {\n  defs('EPSG:4326', \"+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees\");\n  defs('EPSG:4269', \"+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees\");\n  defs('EPSG:3857', \"+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs\");\n\n  defs.WGS84 = defs['EPSG:4326'];\n  defs['EPSG:3785'] = defs['EPSG:3857']; // maintain backward compat, official code is 3857\n  defs.GOOGLE = defs['EPSG:3857'];\n  defs['EPSG:900913'] = defs['EPSG:3857'];\n  defs['EPSG:102113'] = defs['EPSG:3857'];\n}\n","export var PJD_3PARAM = 1;\nexport var PJD_7PARAM = 2;\nexport var PJD_WGS84 = 4; // WGS84 or equivalent\nexport var PJD_NODATUM = 5; // WGS84 or equivalent\nexport var SEC_TO_RAD = 4.84813681109535993589914102357e-6;\nexport var HALF_PI = Math.PI/2;\n// ellipoid pj_set_ell.c\nexport var SIXTH = 0.1666666666666666667;\n/* 1/6 */\nexport var RA4 = 0.04722222222222222222;\n/* 17/360 */\nexport var RA6 = 0.02215608465608465608;\nexport var EPSLN = 1.0e-10;\n// you'd think you could use Number.EPSILON above but that makes\n// Mollweide get into an infinate loop.\n\nexport var D2R = 0.01745329251994329577;\nexport var R2D = 57.29577951308232088;\nexport var FORTPI = Math.PI/4;\nexport var TWO_PI = Math.PI * 2;\n// SPI is slightly greater than Math.PI, so values that exceed the -180..180\n// degree range by a tiny amount don't get wrapped. This prevents points that\n// have drifted from their original location along the 180th meridian (due to\n// floating point error) from changing their sign.\nexport var SPI = 3.14159265359;\n","var exports = {};\nexport {exports as default};\n\nexports.greenwich = 0.0; //\"0dE\",\nexports.lisbon = -9.131906111111; //\"9d07'54.862\\\"W\",\nexports.paris = 2.337229166667; //\"2d20'14.025\\\"E\",\nexports.bogota = -74.080916666667; //\"74d04'51.3\\\"W\",\nexports.madrid = -3.687938888889; //\"3d41'16.58\\\"W\",\nexports.rome = 12.452333333333; //\"12d27'8.4\\\"E\",\nexports.bern = 7.439583333333; //\"7d26'22.5\\\"E\",\nexports.jakarta = 106.807719444444; //\"106d48'27.79\\\"E\",\nexports.ferro = -17.666666666667; //\"17d40'W\",\nexports.brussels = 4.367975; //\"4d22'4.71\\\"E\",\nexports.stockholm = 18.058277777778; //\"18d3'29.8\\\"E\",\nexports.athens = 23.7163375; //\"23d42'58.815\\\"E\",\nexports.oslo = 10.722916666667; //\"10d43'22.5\\\"E\"\n","export default {\n  ft: {to_meter: 0.3048},\n  'us-ft': {to_meter: 1200 / 3937}\n};\n","var ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\nexport default function match(obj, key) {\n  if (obj[key]) {\n    return obj[key];\n  }\n  var keys = Object.keys(obj);\n  var lkey = key.toLowerCase().replace(ignoredChar, '');\n  var i = -1;\n  var testkey, processedKey;\n  while (++i < keys.length) {\n    testkey = keys[i];\n    processedKey = testkey.toLowerCase().replace(ignoredChar, '');\n    if (processedKey === lkey) {\n      return obj[testkey];\n    }\n  }\n}\n","import {D2R} from './constants/values';\nimport PrimeMeridian from './constants/PrimeMeridian';\nimport units from './constants/units';\nimport match from './match';\n\nexport default function(defData) {\n  var self = {};\n  var paramObj = defData.split('+').map(function(v) {\n    return v.trim();\n  }).filter(function(a) {\n    return a;\n  }).reduce(function(p, a) {\n    var split = a.split('=');\n    split.push(true);\n    p[split[0].toLowerCase()] = split[1];\n    return p;\n  }, {});\n  var paramName, paramVal, paramOutname;\n  var params = {\n    proj: 'projName',\n    datum: 'datumCode',\n    rf: function(v) {\n      self.rf = parseFloat(v);\n    },\n    lat_0: function(v) {\n      self.lat0 = v * D2R;\n    },\n    lat_1: function(v) {\n      self.lat1 = v * D2R;\n    },\n    lat_2: function(v) {\n      self.lat2 = v * D2R;\n    },\n    lat_ts: function(v) {\n      self.lat_ts = v * D2R;\n    },\n    lon_0: function(v) {\n      self.long0 = v * D2R;\n    },\n    lon_1: function(v) {\n      self.long1 = v * D2R;\n    },\n    lon_2: function(v) {\n      self.long2 = v * D2R;\n    },\n    alpha: function(v) {\n      self.alpha = parseFloat(v) * D2R;\n    },\n    lonc: function(v) {\n      self.longc = v * D2R;\n    },\n    x_0: function(v) {\n      self.x0 = parseFloat(v);\n    },\n    y_0: function(v) {\n      self.y0 = parseFloat(v);\n    },\n    k_0: function(v) {\n      self.k0 = parseFloat(v);\n    },\n    k: function(v) {\n      self.k0 = parseFloat(v);\n    },\n    a: function(v) {\n      self.a = parseFloat(v);\n    },\n    b: function(v) {\n      self.b = parseFloat(v);\n    },\n    r_a: function() {\n      self.R_A = true;\n    },\n    zone: function(v) {\n      self.zone = parseInt(v, 10);\n    },\n    south: function() {\n      self.utmSouth = true;\n    },\n    towgs84: function(v) {\n      self.datum_params = v.split(\",\").map(function(a) {\n        return parseFloat(a);\n      });\n    },\n    to_meter: function(v) {\n      self.to_meter = parseFloat(v);\n    },\n    units: function(v) {\n      self.units = v;\n      var unit = match(units, v);\n      if (unit) {\n        self.to_meter = unit.to_meter;\n      }\n    },\n    from_greenwich: function(v) {\n      self.from_greenwich = v * D2R;\n    },\n    pm: function(v) {\n      var pm = match(PrimeMeridian, v);\n      self.from_greenwich = (pm ? pm : parseFloat(v)) * D2R;\n    },\n    nadgrids: function(v) {\n      if (v === '@null') {\n        self.datumCode = 'none';\n      }\n      else {\n        self.nadgrids = v;\n      }\n    },\n    axis: function(v) {\n      var legalAxis = \"ewnsud\";\n      if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {\n        self.axis = v;\n      }\n    }\n  };\n  for (paramName in paramObj) {\n    paramVal = paramObj[paramName];\n    if (paramName in params) {\n      paramOutname = params[paramName];\n      if (typeof paramOutname === 'function') {\n        paramOutname(paramVal);\n      }\n      else {\n        self[paramOutname] = paramVal;\n      }\n    }\n    else {\n      self[paramName] = paramVal;\n    }\n  }\n  if(typeof self.datumCode === 'string' && self.datumCode !== \"WGS84\"){\n    self.datumCode = self.datumCode.toLowerCase();\n  }\n  return self;\n}\n","export default parseString;\n\nvar NEUTRAL = 1;\nvar KEYWORD = 2;\nvar NUMBER = 3;\nvar QUOTED = 4;\nvar AFTERQUOTE = 5;\nvar ENDED = -1;\nvar whitespace = /\\s/;\nvar latin = /[A-Za-z]/;\nvar keyword = /[A-Za-z84]/;\nvar endThings = /[,\\]]/;\nvar digets = /[\\d\\.E\\-\\+]/;\n// const ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\nfunction Parser(text) {\n  if (typeof text !== 'string') {\n    throw new Error('not a string');\n  }\n  this.text = text.trim();\n  this.level = 0;\n  this.place = 0;\n  this.root = null;\n  this.stack = [];\n  this.currentObject = null;\n  this.state = NEUTRAL;\n}\nParser.prototype.readCharicter = function() {\n  var char = this.text[this.place++];\n  if (this.state !== QUOTED) {\n    while (whitespace.test(char)) {\n      if (this.place >= this.text.length) {\n        return;\n      }\n      char = this.text[this.place++];\n    }\n  }\n  switch (this.state) {\n    case NEUTRAL:\n      return this.neutral(char);\n    case KEYWORD:\n      return this.keyword(char)\n    case QUOTED:\n      return this.quoted(char);\n    case AFTERQUOTE:\n      return this.afterquote(char);\n    case NUMBER:\n      return this.number(char);\n    case ENDED:\n      return;\n  }\n};\nParser.prototype.afterquote = function(char) {\n  if (char === '\"') {\n    this.word += '\"';\n    this.state = QUOTED;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.word = this.word.trim();\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in afterquote yet, index ' + this.place);\n};\nParser.prototype.afterItem = function(char) {\n  if (char === ',') {\n    if (this.word !== null) {\n      this.currentObject.push(this.word);\n    }\n    this.word = null;\n    this.state = NEUTRAL;\n    return;\n  }\n  if (char === ']') {\n    this.level--;\n    if (this.word !== null) {\n      this.currentObject.push(this.word);\n      this.word = null;\n    }\n    this.state = NEUTRAL;\n    this.currentObject = this.stack.pop();\n    if (!this.currentObject) {\n      this.state = ENDED;\n    }\n\n    return;\n  }\n};\nParser.prototype.number = function(char) {\n  if (digets.test(char)) {\n    this.word += char;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.word = parseFloat(this.word);\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in number yet, index ' + this.place);\n};\nParser.prototype.quoted = function(char) {\n  if (char === '\"') {\n    this.state = AFTERQUOTE;\n    return;\n  }\n  this.word += char;\n  return;\n};\nParser.prototype.keyword = function(char) {\n  if (keyword.test(char)) {\n    this.word += char;\n    return;\n  }\n  if (char === '[') {\n    var newObjects = [];\n    newObjects.push(this.word);\n    this.level++;\n    if (this.root === null) {\n      this.root = newObjects;\n    } else {\n      this.currentObject.push(newObjects);\n    }\n    this.stack.push(this.currentObject);\n    this.currentObject = newObjects;\n    this.state = NEUTRAL;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in keyword yet, index ' + this.place);\n};\nParser.prototype.neutral = function(char) {\n  if (latin.test(char)) {\n    this.word = char;\n    this.state = KEYWORD;\n    return;\n  }\n  if (char === '\"') {\n    this.word = '';\n    this.state = QUOTED;\n    return;\n  }\n  if (digets.test(char)) {\n    this.word = char;\n    this.state = NUMBER;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in neutral yet, index ' + this.place);\n};\nParser.prototype.output = function() {\n  while (this.place < this.text.length) {\n    this.readCharicter();\n  }\n  if (this.state === ENDED) {\n    return this.root;\n  }\n  throw new Error('unable to parse string \"' +this.text + '\". State is ' + this.state);\n};\n\nfunction parseString(txt) {\n  var parser = new Parser(txt);\n  return parser.output();\n}\n","\n\nfunction mapit(obj, key, value) {\n  if (Array.isArray(key)) {\n    value.unshift(key);\n    key = null;\n  }\n  var thing = key ? {} : obj;\n\n  var out = value.reduce(function(newObj, item) {\n    sExpr(item, newObj);\n    return newObj\n  }, thing);\n  if (key) {\n    obj[key] = out;\n  }\n}\n\nexport function sExpr(v, obj) {\n  if (!Array.isArray(v)) {\n    obj[v] = true;\n    return;\n  }\n  var key = v.shift();\n  if (key === 'PARAMETER') {\n    key = v.shift();\n  }\n  if (v.length === 1) {\n    if (Array.isArray(v[0])) {\n      obj[key] = {};\n      sExpr(v[0], obj[key]);\n      return;\n    }\n    obj[key] = v[0];\n    return;\n  }\n  if (!v.length) {\n    obj[key] = true;\n    return;\n  }\n  if (key === 'TOWGS84') {\n    obj[key] = v;\n    return;\n  }\n  if (!Array.isArray(key)) {\n    obj[key] = {};\n  }\n\n  var i;\n  switch (key) {\n    case 'UNIT':\n    case 'PRIMEM':\n    case 'VERT_DATUM':\n      obj[key] = {\n        name: v[0].toLowerCase(),\n        convert: v[1]\n      };\n      if (v.length === 3) {\n        sExpr(v[2], obj[key]);\n      }\n      return;\n    case 'SPHEROID':\n    case 'ELLIPSOID':\n      obj[key] = {\n        name: v[0],\n        a: v[1],\n        rf: v[2]\n      };\n      if (v.length === 4) {\n        sExpr(v[3], obj[key]);\n      }\n      return;\n    case 'PROJECTEDCRS':\n    case 'PROJCRS':\n    case 'GEOGCS':\n    case 'GEOCCS':\n    case 'PROJCS':\n    case 'LOCAL_CS':\n    case 'GEODCRS':\n    case 'GEODETICCRS':\n    case 'GEODETICDATUM':\n    case 'EDATUM':\n    case 'ENGINEERINGDATUM':\n    case 'VERT_CS':\n    case 'VERTCRS':\n    case 'VERTICALCRS':\n    case 'COMPD_CS':\n    case 'COMPOUNDCRS':\n    case 'ENGINEERINGCRS':\n    case 'ENGCRS':\n    case 'FITTED_CS':\n    case 'LOCAL_DATUM':\n    case 'DATUM':\n      v[0] = ['name', v[0]];\n      mapit(obj, key, v);\n      return;\n    default:\n      i = -1;\n      while (++i < v.length) {\n        if (!Array.isArray(v[i])) {\n          return sExpr(v, obj[key]);\n        }\n      }\n      return mapit(obj, key, v);\n  }\n}\n","var D2R = 0.01745329251994329577;\nimport parser from './parser';\nimport {sExpr} from './process';\n\n\n\nfunction rename(obj, params) {\n  var outName = params[0];\n  var inName = params[1];\n  if (!(outName in obj) && (inName in obj)) {\n    obj[outName] = obj[inName];\n    if (params.length === 3) {\n      obj[outName] = params[2](obj[outName]);\n    }\n  }\n}\n\nfunction d2r(input) {\n  return input * D2R;\n}\n\nfunction cleanWKT(wkt) {\n  if (wkt.type === 'GEOGCS') {\n    wkt.projName = 'longlat';\n  } else if (wkt.type === 'LOCAL_CS') {\n    wkt.projName = 'identity';\n    wkt.local = true;\n  } else {\n    if (typeof wkt.PROJECTION === 'object') {\n      wkt.projName = Object.keys(wkt.PROJECTION)[0];\n    } else {\n      wkt.projName = wkt.PROJECTION;\n    }\n  }\n  if (wkt.UNIT) {\n    wkt.units = wkt.UNIT.name.toLowerCase();\n    if (wkt.units === 'metre') {\n      wkt.units = 'meter';\n    }\n    if (wkt.UNIT.convert) {\n      if (wkt.type === 'GEOGCS') {\n        if (wkt.DATUM && wkt.DATUM.SPHEROID) {\n          wkt.to_meter = wkt.UNIT.convert*wkt.DATUM.SPHEROID.a;\n        }\n      } else {\n        wkt.to_meter = wkt.UNIT.convert;\n      }\n    }\n  }\n  var geogcs = wkt.GEOGCS;\n  if (wkt.type === 'GEOGCS') {\n    geogcs = wkt;\n  }\n  if (geogcs) {\n    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){\n    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;\n    //}\n    if (geogcs.DATUM) {\n      wkt.datumCode = geogcs.DATUM.name.toLowerCase();\n    } else {\n      wkt.datumCode = geogcs.name.toLowerCase();\n    }\n    if (wkt.datumCode.slice(0, 2) === 'd_') {\n      wkt.datumCode = wkt.datumCode.slice(2);\n    }\n    if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {\n      wkt.datumCode = 'nzgd49';\n    }\n    if (wkt.datumCode === 'wgs_1984') {\n      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {\n        wkt.sphere = true;\n      }\n      wkt.datumCode = 'wgs84';\n    }\n    if (wkt.datumCode.slice(-6) === '_ferro') {\n      wkt.datumCode = wkt.datumCode.slice(0, - 6);\n    }\n    if (wkt.datumCode.slice(-8) === '_jakarta') {\n      wkt.datumCode = wkt.datumCode.slice(0, - 8);\n    }\n    if (~wkt.datumCode.indexOf('belge')) {\n      wkt.datumCode = 'rnb72';\n    }\n    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {\n      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\\_18/, 'clrk');\n      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {\n        wkt.ellps = 'intl';\n      }\n\n      wkt.a = geogcs.DATUM.SPHEROID.a;\n      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);\n    }\n\n    if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {\n      wkt.datum_params = geogcs.DATUM.TOWGS84;\n    }\n    if (~wkt.datumCode.indexOf('osgb_1936')) {\n      wkt.datumCode = 'osgb36';\n    }\n    if (~wkt.datumCode.indexOf('osni_1952')) {\n      wkt.datumCode = 'osni52';\n    }\n    if (~wkt.datumCode.indexOf('tm65')\n      || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {\n      wkt.datumCode = 'ire65';\n    }\n    if (wkt.datumCode === 'ch1903+') {\n      wkt.datumCode = 'ch1903';\n    }\n    if (~wkt.datumCode.indexOf('israel')) {\n      wkt.datumCode = 'isr93';\n    }\n  }\n  if (wkt.b && !isFinite(wkt.b)) {\n    wkt.b = wkt.a;\n  }\n\n  function toMeter(input) {\n    var ratio = wkt.to_meter || 1;\n    return input * ratio;\n  }\n  var renamer = function(a) {\n    return rename(wkt, a);\n  };\n  var list = [\n    ['standard_parallel_1', 'Standard_Parallel_1'],\n    ['standard_parallel_2', 'Standard_Parallel_2'],\n    ['false_easting', 'False_Easting'],\n    ['false_northing', 'False_Northing'],\n    ['central_meridian', 'Central_Meridian'],\n    ['latitude_of_origin', 'Latitude_Of_Origin'],\n    ['latitude_of_origin', 'Central_Parallel'],\n    ['scale_factor', 'Scale_Factor'],\n    ['k0', 'scale_factor'],\n    ['latitude_of_center', 'Latitude_Of_Center'],\n    ['latitude_of_center', 'Latitude_of_center'],\n    ['lat0', 'latitude_of_center', d2r],\n    ['longitude_of_center', 'Longitude_Of_Center'],\n    ['longitude_of_center', 'Longitude_of_center'],\n    ['longc', 'longitude_of_center', d2r],\n    ['x0', 'false_easting', toMeter],\n    ['y0', 'false_northing', toMeter],\n    ['long0', 'central_meridian', d2r],\n    ['lat0', 'latitude_of_origin', d2r],\n    ['lat0', 'standard_parallel_1', d2r],\n    ['lat1', 'standard_parallel_1', d2r],\n    ['lat2', 'standard_parallel_2', d2r],\n    ['azimuth', 'Azimuth'],\n    ['alpha', 'azimuth', d2r],\n    ['srsCode', 'name']\n  ];\n  list.forEach(renamer);\n  if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {\n    wkt.long0 = wkt.longc;\n  }\n  if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {\n    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);\n    wkt.lat_ts = wkt.lat1;\n  }\n}\nexport default function(wkt) {\n  var lisp = parser(wkt);\n  var type = lisp.shift();\n  var name = lisp.shift();\n  lisp.unshift(['name', name]);\n  lisp.unshift(['type', type]);\n  var obj = {};\n  sExpr(lisp, obj);\n  cleanWKT(obj);\n  return obj;\n}\n","import globals from './global';\nimport parseProj from './projString';\nimport wkt from 'wkt-parser';\n\nfunction defs(name) {\n  /*global console*/\n  var that = this;\n  if (arguments.length === 2) {\n    var def = arguments[1];\n    if (typeof def === 'string') {\n      if (def.charAt(0) === '+') {\n        defs[name] = parseProj(arguments[1]);\n      }\n      else {\n        defs[name] = wkt(arguments[1]);\n      }\n    } else {\n      defs[name] = def;\n    }\n  }\n  else if (arguments.length === 1) {\n    if (Array.isArray(name)) {\n      return name.map(function(v) {\n        if (Array.isArray(v)) {\n          defs.apply(that, v);\n        }\n        else {\n          defs(v);\n        }\n      });\n    }\n    else if (typeof name === 'string') {\n      if (name in defs) {\n        return defs[name];\n      }\n    }\n    else if ('EPSG' in name) {\n      defs['EPSG:' + name.EPSG] = name;\n    }\n    else if ('ESRI' in name) {\n      defs['ESRI:' + name.ESRI] = name;\n    }\n    else if ('IAU2000' in name) {\n      defs['IAU2000:' + name.IAU2000] = name;\n    }\n    else {\n      console.log(name);\n    }\n    return;\n  }\n\n\n}\nglobals(defs);\nexport default defs;\n","import defs from './defs';\nimport wkt from 'wkt-parser';\nimport projStr from './projString';\nimport match from './match';\nfunction testObj(code){\n  return typeof code === 'string';\n}\nfunction testDef(code){\n  return code in defs;\n}\n var codeWords = ['PROJECTEDCRS', 'PROJCRS', 'GEOGCS','GEOCCS','PROJCS','LOCAL_CS', 'GEODCRS', 'GEODETICCRS', 'GEODETICDATUM', 'ENGCRS', 'ENGINEERINGCRS'];\nfunction testWKT(code){\n  return codeWords.some(function (word) {\n    return code.indexOf(word) > -1;\n  });\n}\nvar codes = ['3857', '900913', '3785', '102113'];\nfunction checkMercator(item) {\n  var auth = match(item, 'authority');\n  if (!auth) {\n    return;\n  }\n  var code = match(auth, 'epsg');\n  return code && codes.indexOf(code) > -1;\n}\nfunction checkProjStr(item) {\n  var ext = match(item, 'extension');\n  if (!ext) {\n    return;\n  }\n  return match(ext, 'proj4');\n}\nfunction testProj(code){\n  return code[0] === '+';\n}\nfunction parse(code){\n  if (testObj(code)) {\n    //check to see if this is a WKT string\n    if (testDef(code)) {\n      return defs[code];\n    }\n    if (testWKT(code)) {\n      var out = wkt(code);\n      // test of spetial case, due to this being a very common and often malformed\n      if (checkMercator(out)) {\n        return defs['EPSG:3857'];\n      }\n      var maybeProjStr = checkProjStr(out);\n      if (maybeProjStr) {\n        return projStr(maybeProjStr);\n      }\n      return out;\n    }\n    if (testProj(code)) {\n      return projStr(code);\n    }\n  }else{\n    return code;\n  }\n}\n\nexport default parse;\n","export default function(destination, source) {\n  destination = destination || {};\n  var value, property;\n  if (!source) {\n    return destination;\n  }\n  for (property in source) {\n    value = source[property];\n    if (value !== undefined) {\n      destination[property] = value;\n    }\n  }\n  return destination;\n}\n","export default function(eccent, sinphi, cosphi) {\n  var con = eccent * sinphi;\n  return cosphi / (Math.sqrt(1 - con * con));\n}","export default function(x) {\n  return x<0 ? -1 : 1;\n}","\nimport {TWO_PI, SPI} from '../constants/values';\nimport sign from './sign';\n\nexport default function(x) {\n  return (Math.abs(x) <= SPI) ? x : (x - (sign(x) * TWO_PI));\n}\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, phi, sinphi) {\n  var con = eccent * sinphi;\n  var com = 0.5 * eccent;\n  con = Math.pow(((1 - con) / (1 + con)), com);\n  return (Math.tan(0.5 * (HALF_PI - phi)) / con);\n}\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, ts) {\n  var eccnth = 0.5 * eccent;\n  var con, dphi;\n  var phi = HALF_PI - 2 * Math.atan(ts);\n  for (var i = 0; i <= 15; i++) {\n    con = eccent * Math.sin(phi);\n    dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n  //console.log(\"phi2z has NoConvergence\");\n  return -9999;\n}\n","export function init() {\n  //no-op for longlat\n}\n\nfunction identity(pt) {\n  return pt;\n}\nexport {identity as forward};\nexport {identity as inverse};\nexport var names = [\"longlat\", \"identity\"];\nexport default {\n  init: init,\n  forward: identity,\n  inverse: identity,\n  names: names\n};\n","import merc from \"./projections/merc\";\nimport longlat from \"./projections/longlat\";\nvar projs = [merc, longlat];\nvar names = {};\nvar projStore = [];\n\nfunction add(proj, i) {\n  var len = projStore.length;\n  if (!proj.names) {\n    console.log(i);\n    return true;\n  }\n  projStore[len] = proj;\n  proj.names.forEach(function(n) {\n    names[n.toLowerCase()] = len;\n  });\n  return this;\n}\n\nexport {add};\n\nexport function get(name) {\n  if (!name) {\n    return false;\n  }\n  var n = name.toLowerCase();\n  if (typeof names[n] !== 'undefined' && projStore[names[n]]) {\n    return projStore[names[n]];\n  }\n}\n\nexport function start() {\n  projs.forEach(add);\n}\nexport default {\n  start: start,\n  add: add,\n  get: get\n};\n","import msfnz from '../common/msfnz';\n\nimport adjust_lon from '../common/adjust_lon';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport {FORTPI, R2D, EPSLN, HALF_PI} from '../constants/values';\nexport function init() {\n  var con = this.b / this.a;\n  this.es = 1 - con * con;\n  if(!('x0' in this)){\n    this.x0 = 0;\n  }\n  if(!('y0' in this)){\n    this.y0 = 0;\n  }\n  this.e = Math.sqrt(this.es);\n  if (this.lat_ts) {\n    if (this.sphere) {\n      this.k0 = Math.cos(this.lat_ts);\n    }\n    else {\n      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n    }\n  }\n  else {\n    if (!this.k0) {\n      if (this.k) {\n        this.k0 = this.k;\n      }\n      else {\n        this.k0 = 1;\n      }\n    }\n  }\n}\n\n/* Mercator forward equations--mapping lat,long to x,y\n  --------------------------------------------------*/\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  // convert to radians\n  if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {\n    return null;\n  }\n\n  var x, y;\n  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    return null;\n  }\n  else {\n    if (this.sphere) {\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));\n    }\n    else {\n      var sinphi = Math.sin(lat);\n      var ts = tsfnz(this.e, lat, sinphi);\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 - this.a * this.k0 * Math.log(ts);\n    }\n    p.x = x;\n    p.y = y;\n    return p;\n  }\n}\n\n/* Mercator inverse equations--mapping x,y to lat/long\n  --------------------------------------------------*/\nexport function inverse(p) {\n\n  var x = p.x - this.x0;\n  var y = p.y - this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));\n  }\n  else {\n    var ts = Math.exp(-y / (this.a * this.k0));\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  }\n  lon = adjust_lon(this.long0 + x / (this.a * this.k0));\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Mercator\", \"Popular Visualisation Pseudo Mercator\", \"Mercator_1SP\", \"Mercator_Auxiliary_Sphere\", \"merc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","var exports = {};\nexport {exports as default};\nexports.MERIT = {\n  a: 6378137.0,\n  rf: 298.257,\n  ellipseName: \"MERIT 1983\"\n};\n\nexports.SGS85 = {\n  a: 6378136.0,\n  rf: 298.257,\n  ellipseName: \"Soviet Geodetic System 85\"\n};\n\nexports.GRS80 = {\n  a: 6378137.0,\n  rf: 298.257222101,\n  ellipseName: \"GRS 1980(IUGG, 1980)\"\n};\n\nexports.IAU76 = {\n  a: 6378140.0,\n  rf: 298.257,\n  ellipseName: \"IAU 1976\"\n};\n\nexports.airy = {\n  a: 6377563.396,\n  b: 6356256.910,\n  ellipseName: \"Airy 1830\"\n};\n\nexports.APL4 = {\n  a: 6378137,\n  rf: 298.25,\n  ellipseName: \"Appl. Physics. 1965\"\n};\n\nexports.NWL9D = {\n  a: 6378145.0,\n  rf: 298.25,\n  ellipseName: \"Naval Weapons Lab., 1965\"\n};\n\nexports.mod_airy = {\n  a: 6377340.189,\n  b: 6356034.446,\n  ellipseName: \"Modified Airy\"\n};\n\nexports.andrae = {\n  a: 6377104.43,\n  rf: 300.0,\n  ellipseName: \"Andrae 1876 (Den., Iclnd.)\"\n};\n\nexports.aust_SA = {\n  a: 6378160.0,\n  rf: 298.25,\n  ellipseName: \"Australian Natl & S. Amer. 1969\"\n};\n\nexports.GRS67 = {\n  a: 6378160.0,\n  rf: 298.2471674270,\n  ellipseName: \"GRS 67(IUGG 1967)\"\n};\n\nexports.bessel = {\n  a: 6377397.155,\n  rf: 299.1528128,\n  ellipseName: \"Bessel 1841\"\n};\n\nexports.bess_nam = {\n  a: 6377483.865,\n  rf: 299.1528128,\n  ellipseName: \"Bessel 1841 (Namibia)\"\n};\n\nexports.clrk66 = {\n  a: 6378206.4,\n  b: 6356583.8,\n  ellipseName: \"Clarke 1866\"\n};\n\nexports.clrk80 = {\n  a: 6378249.145,\n  rf: 293.4663,\n  ellipseName: \"Clarke 1880 mod.\"\n};\n\nexports.clrk58 = {\n  a: 6378293.645208759,\n  rf: 294.2606763692654,\n  ellipseName: \"Clarke 1858\"\n};\n\nexports.CPM = {\n  a: 6375738.7,\n  rf: 334.29,\n  ellipseName: \"Comm. des Poids et Mesures 1799\"\n};\n\nexports.delmbr = {\n  a: 6376428.0,\n  rf: 311.5,\n  ellipseName: \"Delambre 1810 (Belgium)\"\n};\n\nexports.engelis = {\n  a: 6378136.05,\n  rf: 298.2566,\n  ellipseName: \"Engelis 1985\"\n};\n\nexports.evrst30 = {\n  a: 6377276.345,\n  rf: 300.8017,\n  ellipseName: \"Everest 1830\"\n};\n\nexports.evrst48 = {\n  a: 6377304.063,\n  rf: 300.8017,\n  ellipseName: \"Everest 1948\"\n};\n\nexports.evrst56 = {\n  a: 6377301.243,\n  rf: 300.8017,\n  ellipseName: \"Everest 1956\"\n};\n\nexports.evrst69 = {\n  a: 6377295.664,\n  rf: 300.8017,\n  ellipseName: \"Everest 1969\"\n};\n\nexports.evrstSS = {\n  a: 6377298.556,\n  rf: 300.8017,\n  ellipseName: \"Everest (Sabah & Sarawak)\"\n};\n\nexports.fschr60 = {\n  a: 6378166.0,\n  rf: 298.3,\n  ellipseName: \"Fischer (Mercury Datum) 1960\"\n};\n\nexports.fschr60m = {\n  a: 6378155.0,\n  rf: 298.3,\n  ellipseName: \"Fischer 1960\"\n};\n\nexports.fschr68 = {\n  a: 6378150.0,\n  rf: 298.3,\n  ellipseName: \"Fischer 1968\"\n};\n\nexports.helmert = {\n  a: 6378200.0,\n  rf: 298.3,\n  ellipseName: \"Helmert 1906\"\n};\n\nexports.hough = {\n  a: 6378270.0,\n  rf: 297.0,\n  ellipseName: \"Hough\"\n};\n\nexports.intl = {\n  a: 6378388.0,\n  rf: 297.0,\n  ellipseName: \"International 1909 (Hayford)\"\n};\n\nexports.kaula = {\n  a: 6378163.0,\n  rf: 298.24,\n  ellipseName: \"Kaula 1961\"\n};\n\nexports.lerch = {\n  a: 6378139.0,\n  rf: 298.257,\n  ellipseName: \"Lerch 1979\"\n};\n\nexports.mprts = {\n  a: 6397300.0,\n  rf: 191.0,\n  ellipseName: \"Maupertius 1738\"\n};\n\nexports.new_intl = {\n  a: 6378157.5,\n  b: 6356772.2,\n  ellipseName: \"New International 1967\"\n};\n\nexports.plessis = {\n  a: 6376523.0,\n  rf: 6355863.0,\n  ellipseName: \"Plessis 1817 (France)\"\n};\n\nexports.krass = {\n  a: 6378245.0,\n  rf: 298.3,\n  ellipseName: \"Krassovsky, 1942\"\n};\n\nexports.SEasia = {\n  a: 6378155.0,\n  b: 6356773.3205,\n  ellipseName: \"Southeast Asia\"\n};\n\nexports.walbeck = {\n  a: 6376896.0,\n  b: 6355834.8467,\n  ellipseName: \"Walbeck\"\n};\n\nexports.WGS60 = {\n  a: 6378165.0,\n  rf: 298.3,\n  ellipseName: \"WGS 60\"\n};\n\nexports.WGS66 = {\n  a: 6378145.0,\n  rf: 298.25,\n  ellipseName: \"WGS 66\"\n};\n\nexports.WGS7 = {\n  a: 6378135.0,\n  rf: 298.26,\n  ellipseName: \"WGS 72\"\n};\n\nexport var WGS84 = exports.WGS84 = {\n  a: 6378137.0,\n  rf: 298.257223563,\n  ellipseName: \"WGS 84\"\n};\n\nexports.sphere = {\n  a: 6370997.0,\n  b: 6370997.0,\n  ellipseName: \"Normal Sphere (r=6370997)\"\n};\n","var exports = {};\nexport {exports as default};\nexports.wgs84 = {\n  towgs84: \"0,0,0\",\n  ellipse: \"WGS84\",\n  datumName: \"WGS84\"\n};\n\nexports.ch1903 = {\n  towgs84: \"674.374,15.056,405.346\",\n  ellipse: \"bessel\",\n  datumName: \"swiss\"\n};\n\nexports.ggrs87 = {\n  towgs84: \"-199.87,74.79,246.62\",\n  ellipse: \"GRS80\",\n  datumName: \"Greek_Geodetic_Reference_System_1987\"\n};\n\nexports.nad83 = {\n  towgs84: \"0,0,0\",\n  ellipse: \"GRS80\",\n  datumName: \"North_American_Datum_1983\"\n};\n\nexports.nad27 = {\n  nadgrids: \"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat\",\n  ellipse: \"clrk66\",\n  datumName: \"North_American_Datum_1927\"\n};\n\nexports.potsdam = {\n  towgs84: \"606.0,23.0,413.0\",\n  ellipse: \"bessel\",\n  datumName: \"Potsdam Rauenberg 1950 DHDN\"\n};\n\nexports.carthage = {\n  towgs84: \"-263.0,6.0,431.0\",\n  ellipse: \"clark80\",\n  datumName: \"Carthage 1934 Tunisia\"\n};\n\nexports.hermannskogel = {\n  towgs84: \"653.0,-212.0,449.0\",\n  ellipse: \"bessel\",\n  datumName: \"Hermannskogel\"\n};\n\nexports.osni52 = {\n  towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\",\n  ellipse: \"airy\",\n  datumName: \"Irish National\"\n};\n\nexports.ire65 = {\n  towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\",\n  ellipse: \"mod_airy\",\n  datumName: \"Ireland 1965\"\n};\n\nexports.rassadiran = {\n  towgs84: \"-133.63,-157.5,-158.62\",\n  ellipse: \"intl\",\n  datumName: \"Rassadiran\"\n};\n\nexports.nzgd49 = {\n  towgs84: \"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993\",\n  ellipse: \"intl\",\n  datumName: \"New Zealand Geodetic Datum 1949\"\n};\n\nexports.osgb36 = {\n  towgs84: \"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894\",\n  ellipse: \"airy\",\n  datumName: \"Airy 1830\"\n};\n\nexports.s_jtsk = {\n  towgs84: \"589,76,480\",\n  ellipse: 'bessel',\n  datumName: 'S-JTSK (Ferro)'\n};\n\nexports.beduaram = {\n  towgs84: '-106,-87,188',\n  ellipse: 'clrk80',\n  datumName: 'Beduaram'\n};\n\nexports.gunung_segara = {\n  towgs84: '-403,684,41',\n  ellipse: 'bessel',\n  datumName: 'Gunung Segara Jakarta'\n};\n\nexports.rnb72 = {\n  towgs84: \"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1\",\n  ellipse: \"intl\",\n  datumName: \"Reseau National Belge 1972\"\n};\n","import {PJD_3PARAM, PJD_7PARAM, PJD_WGS84, PJD_NODATUM, SEC_TO_RAD} from './constants/values';\n\nfunction datum(datumCode, datum_params, a, b, es, ep2) {\n  var out = {};\n\n  if (datumCode === undefined || datumCode === 'none') {\n    out.datum_type = PJD_NODATUM;\n  } else {\n    out.datum_type = PJD_WGS84;\n  }\n\n  if (datum_params) {\n    out.datum_params = datum_params.map(parseFloat);\n    if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {\n      out.datum_type = PJD_3PARAM;\n    }\n    if (out.datum_params.length > 3) {\n      if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {\n        out.datum_type = PJD_7PARAM;\n        out.datum_params[3] *= SEC_TO_RAD;\n        out.datum_params[4] *= SEC_TO_RAD;\n        out.datum_params[5] *= SEC_TO_RAD;\n        out.datum_params[6] = (out.datum_params[6] / 1000000.0) + 1.0;\n      }\n    }\n  }\n\n  out.a = a; //datum object also uses these values\n  out.b = b;\n  out.es = es;\n  out.ep2 = ep2;\n  return out;\n}\n\nexport default datum;\n","import parseCode from './parseCode';\nimport extend from './extend';\nimport projections from './projections';\nimport {sphere as dc_sphere, eccentricity as dc_eccentricity} from './deriveConstants';\nimport Datum from './constants/Datum';\nimport datum from './datum';\nimport match from './match';\n\nfunction Projection(srsCode,callback) {\n  if (!(this instanceof Projection)) {\n    return new Projection(srsCode);\n  }\n  callback = callback || function(error){\n    if(error){\n      throw error;\n    }\n  };\n  var json = parseCode(srsCode);\n  if(typeof json !== 'object'){\n    callback(srsCode);\n    return;\n  }\n  var ourProj = Projection.projections.get(json.projName);\n  if(!ourProj){\n    callback(srsCode);\n    return;\n  }\n  if (json.datumCode && json.datumCode !== 'none') {\n    var datumDef = match(Datum, json.datumCode);\n    if (datumDef) {\n      json.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(',') : null;\n      json.ellps = datumDef.ellipse;\n      json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;\n    }\n  }\n  json.k0 = json.k0 || 1.0;\n  json.axis = json.axis || 'enu';\n  json.ellps = json.ellps || 'wgs84';\n  var sphere_ = dc_sphere(json.a, json.b, json.rf, json.ellps, json.sphere);\n  var ecc = dc_eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);\n  var datumObj = json.datum || datum(json.datumCode, json.datum_params, sphere_.a, sphere_.b, ecc.es, ecc.ep2);\n\n  extend(this, json); // transfer everything over from the projection because we don't know what we'll need\n  extend(this, ourProj); // transfer all the methods from the projection\n\n  // copy the 4 things over we calulated in deriveConstants.sphere\n  this.a = sphere_.a;\n  this.b = sphere_.b;\n  this.rf = sphere_.rf;\n  this.sphere = sphere_.sphere;\n\n  // copy the 3 things we calculated in deriveConstants.eccentricity\n  this.es = ecc.es;\n  this.e = ecc.e;\n  this.ep2 = ecc.ep2;\n\n  // add in the datum object\n  this.datum = datumObj;\n\n  // init the projection\n  this.init();\n\n  // legecy callback from back in the day when it went to spatialreference.org\n  callback(null, this);\n\n}\nProjection.projections = projections;\nProjection.projections.start();\nexport default Projection;\n","import {SIXTH, RA4, RA6, EPSLN} from './constants/values';\nimport {default as Ellipsoid, WGS84} from './constants/Ellipsoid';\nimport match from './match';\n\nexport function eccentricity(a, b, rf, R_A) {\n  var a2 = a * a; // used in geocentric\n  var b2 = b * b; // used in geocentric\n  var es = (a2 - b2) / a2; // e ^ 2\n  var e = 0;\n  if (R_A) {\n    a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));\n    a2 = a * a;\n    es = 0;\n  } else {\n    e = Math.sqrt(es); // eccentricity\n  }\n  var ep2 = (a2 - b2) / b2; // used in geocentric\n  return {\n    es: es,\n    e: e,\n    ep2: ep2\n  };\n}\nexport function sphere(a, b, rf, ellps, sphere) {\n  if (!a) { // do we have an ellipsoid?\n    var ellipse = match(Ellipsoid, ellps);\n    if (!ellipse) {\n      ellipse = WGS84;\n    }\n    a = ellipse.a;\n    b = ellipse.b;\n    rf = ellipse.rf;\n  }\n\n  if (rf && !b) {\n    b = (1.0 - 1.0 / rf) * a;\n  }\n  if (rf === 0 || Math.abs(a - b) < EPSLN) {\n    sphere = true;\n    b = a;\n  }\n  return {\n    a: a,\n    b: b,\n    rf: rf,\n    sphere: sphere\n  };\n}\n","import {PJD_3PARAM, PJD_7PARAM, PJD_NODATUM} from './constants/values';\n\nimport {geodeticToGeocentric, geocentricToGeodetic, geocentricToWgs84, geocentricFromWgs84, compareDatums} from './datumUtils';\nfunction checkParams(type) {\n  return (type === PJD_3PARAM || type === PJD_7PARAM);\n}\n\nexport default function(source, dest, point) {\n  // Short cut if the datums are identical.\n  if (compareDatums(source, dest)) {\n    return point; // in this case, zero is sucess,\n    // whereas cs_compare_datums returns 1 to indicate TRUE\n    // confusing, should fix this\n  }\n\n  // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest\n  if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {\n    return point;\n  }\n\n  // If this datum requires grid shifts, then apply it to geodetic coordinates.\n\n  // Do we need to go through geocentric coordinates?\n  if (source.es === dest.es && source.a === dest.a && !checkParams(source.datum_type) &&  !checkParams(dest.datum_type)) {\n    return point;\n  }\n\n  // Convert to geocentric coordinates.\n  point = geodeticToGeocentric(point, source.es, source.a);\n  // Convert between datums\n  if (checkParams(source.datum_type)) {\n    point = geocentricToWgs84(point, source.datum_type, source.datum_params);\n  }\n  if (checkParams(dest.datum_type)) {\n    point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);\n  }\n  return geocentricToGeodetic(point, dest.es, dest.a, dest.b);\n\n}\n","'use strict';\nimport {PJD_3PARAM, PJD_7PARAM, HALF_PI} from './constants/values';\nexport function compareDatums(source, dest) {\n  if (source.datum_type !== dest.datum_type) {\n    return false; // false, datums are not equal\n  } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 0.000000000050) {\n    // the tolerance for es is to ensure that GRS80 and WGS84\n    // are considered identical\n    return false;\n  } else if (source.datum_type === PJD_3PARAM) {\n    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2]);\n  } else if (source.datum_type === PJD_7PARAM) {\n    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6]);\n  } else {\n    return true; // datums are equal\n  }\n} // cs_compare_datums()\n\n/*\n * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates\n * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),\n * according to the current ellipsoid parameters.\n *\n *    Latitude  : Geodetic latitude in radians                     (input)\n *    Longitude : Geodetic longitude in radians                    (input)\n *    Height    : Geodetic height, in meters                       (input)\n *    X         : Calculated Geocentric X coordinate, in meters    (output)\n *    Y         : Calculated Geocentric Y coordinate, in meters    (output)\n *    Z         : Calculated Geocentric Z coordinate, in meters    (output)\n *\n */\nexport function geodeticToGeocentric(p, es, a) {\n  var Longitude = p.x;\n  var Latitude = p.y;\n  var Height = p.z ? p.z : 0; //Z value not always supplied\n\n  var Rn; /*  Earth radius at location  */\n  var Sin_Lat; /*  Math.sin(Latitude)  */\n  var Sin2_Lat; /*  Square of Math.sin(Latitude)  */\n  var Cos_Lat; /*  Math.cos(Latitude)  */\n\n  /*\n   ** Don't blow up if Latitude is just a little out of the value\n   ** range as it may just be a rounding issue.  Also removed longitude\n   ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n   */\n  if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {\n    Latitude = -HALF_PI;\n  } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {\n    Latitude = HALF_PI;\n  } else if (Latitude < -HALF_PI) {\n    /* Latitude out of range */\n    //..reportError('geocent:lat out of range:' + Latitude);\n    return { x: -Infinity, y: -Infinity, z: p.z };\n  } else if (Latitude > HALF_PI) {\n    /* Latitude out of range */\n    return { x: Infinity, y: Infinity, z: p.z };\n  }\n\n  if (Longitude > Math.PI) {\n    Longitude -= (2 * Math.PI);\n  }\n  Sin_Lat = Math.sin(Latitude);\n  Cos_Lat = Math.cos(Latitude);\n  Sin2_Lat = Sin_Lat * Sin_Lat;\n  Rn = a / (Math.sqrt(1.0e0 - es * Sin2_Lat));\n  return {\n    x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),\n    y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),\n    z: ((Rn * (1 - es)) + Height) * Sin_Lat\n  };\n} // cs_geodetic_to_geocentric()\n\nexport function geocentricToGeodetic(p, es, a, b) {\n  /* local defintions and variables */\n  /* end-criterium of loop, accuracy of sin(Latitude) */\n  var genau = 1e-12;\n  var genau2 = (genau * genau);\n  var maxiter = 30;\n\n  var P; /* distance between semi-minor axis and location */\n  var RR; /* distance between center and location */\n  var CT; /* sin of geocentric latitude */\n  var ST; /* cos of geocentric latitude */\n  var RX;\n  var RK;\n  var RN; /* Earth radius at location */\n  var CPHI0; /* cos of start or old geodetic latitude in iterations */\n  var SPHI0; /* sin of start or old geodetic latitude in iterations */\n  var CPHI; /* cos of searched geodetic latitude */\n  var SPHI; /* sin of searched geodetic latitude */\n  var SDPHI; /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */\n  var iter; /* # of continous iteration, max. 30 is always enough (s.a.) */\n\n  var X = p.x;\n  var Y = p.y;\n  var Z = p.z ? p.z : 0.0; //Z value not always supplied\n  var Longitude;\n  var Latitude;\n  var Height;\n\n  P = Math.sqrt(X * X + Y * Y);\n  RR = Math.sqrt(X * X + Y * Y + Z * Z);\n\n  /*      special cases for latitude and longitude */\n  if (P / a < genau) {\n\n    /*  special case, if P=0. (X=0., Y=0.) */\n    Longitude = 0.0;\n\n    /*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis\n     *  of ellipsoid (=center of mass), Latitude becomes PI/2 */\n    if (RR / a < genau) {\n      Latitude = HALF_PI;\n      Height = -b;\n      return {\n        x: p.x,\n        y: p.y,\n        z: p.z\n      };\n    }\n  } else {\n    /*  ellipsoidal (geodetic) longitude\n     *  interval: -PI < Longitude <= +PI */\n    Longitude = Math.atan2(Y, X);\n  }\n\n  /* --------------------------------------------------------------\n   * Following iterative algorithm was developped by\n   * \"Institut for Erdmessung\", University of Hannover, July 1988.\n   * Internet: www.ife.uni-hannover.de\n   * Iterative computation of CPHI,SPHI and Height.\n   * Iteration of CPHI and SPHI to 10**-12 radian resp.\n   * 2*10**-7 arcsec.\n   * --------------------------------------------------------------\n   */\n  CT = Z / RR;\n  ST = P / RR;\n  RX = 1.0 / Math.sqrt(1.0 - es * (2.0 - es) * ST * ST);\n  CPHI0 = ST * (1.0 - es) * RX;\n  SPHI0 = CT * RX;\n  iter = 0;\n\n  /* loop to find sin(Latitude) resp. Latitude\n   * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */\n  do {\n    iter++;\n    RN = a / Math.sqrt(1.0 - es * SPHI0 * SPHI0);\n\n    /*  ellipsoidal (geodetic) height */\n    Height = P * CPHI0 + Z * SPHI0 - RN * (1.0 - es * SPHI0 * SPHI0);\n\n    RK = es * RN / (RN + Height);\n    RX = 1.0 / Math.sqrt(1.0 - RK * (2.0 - RK) * ST * ST);\n    CPHI = ST * (1.0 - RK) * RX;\n    SPHI = CT * RX;\n    SDPHI = SPHI * CPHI0 - CPHI * SPHI0;\n    CPHI0 = CPHI;\n    SPHI0 = SPHI;\n  }\n  while (SDPHI * SDPHI > genau2 && iter < maxiter);\n\n  /*      ellipsoidal (geodetic) latitude */\n  Latitude = Math.atan(SPHI / Math.abs(CPHI));\n  return {\n    x: Longitude,\n    y: Latitude,\n    z: Height\n  };\n} // cs_geocentric_to_geodetic()\n\n/****************************************************************/\n// pj_geocentic_to_wgs84( p )\n//  p = point to transform in geocentric coordinates (x,y,z)\n\n\n/** point object, nothing fancy, just allows values to be\n    passed back and forth by reference rather than by value.\n    Other point classes may be used as long as they have\n    x and y properties, which will get modified in the transform method.\n*/\nexport function geocentricToWgs84(p, datum_type, datum_params) {\n\n  if (datum_type === PJD_3PARAM) {\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: p.x + datum_params[0],\n      y: p.y + datum_params[1],\n      z: p.z + datum_params[2],\n    };\n  } else if (datum_type === PJD_7PARAM) {\n    var Dx_BF = datum_params[0];\n    var Dy_BF = datum_params[1];\n    var Dz_BF = datum_params[2];\n    var Rx_BF = datum_params[3];\n    var Ry_BF = datum_params[4];\n    var Rz_BF = datum_params[5];\n    var M_BF = datum_params[6];\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF,\n      y: M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF,\n      z: M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF\n    };\n  }\n} // cs_geocentric_to_wgs84\n\n/****************************************************************/\n// pj_geocentic_from_wgs84()\n//  coordinate system definition,\n//  point to transform in geocentric coordinates (x,y,z)\nexport function geocentricFromWgs84(p, datum_type, datum_params) {\n\n  if (datum_type === PJD_3PARAM) {\n    //if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: p.x - datum_params[0],\n      y: p.y - datum_params[1],\n      z: p.z - datum_params[2],\n    };\n\n  } else if (datum_type === PJD_7PARAM) {\n    var Dx_BF = datum_params[0];\n    var Dy_BF = datum_params[1];\n    var Dz_BF = datum_params[2];\n    var Rx_BF = datum_params[3];\n    var Ry_BF = datum_params[4];\n    var Rz_BF = datum_params[5];\n    var M_BF = datum_params[6];\n    var x_tmp = (p.x - Dx_BF) / M_BF;\n    var y_tmp = (p.y - Dy_BF) / M_BF;\n    var z_tmp = (p.z - Dz_BF) / M_BF;\n    //if( x[io] === HUGE_VAL )\n    //    continue;\n\n    return {\n      x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,\n      y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,\n      z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp\n    };\n  } //cs_geocentric_from_wgs84()\n}\n","export default function(crs, denorm, point) {\n  var xin = point.x,\n    yin = point.y,\n    zin = point.z || 0.0;\n  var v, t, i;\n  var out = {};\n  for (i = 0; i < 3; i++) {\n    if (denorm && i === 2 && point.z === undefined) {\n      continue;\n    }\n    if (i === 0) {\n      v = xin;\n      t = 'x';\n    }\n    else if (i === 1) {\n      v = yin;\n      t = 'y';\n    }\n    else {\n      v = zin;\n      t = 'z';\n    }\n    switch (crs.axis[i]) {\n    case 'e':\n      out[t] = v;\n      break;\n    case 'w':\n      out[t] = -v;\n      break;\n    case 'n':\n      out[t] = v;\n      break;\n    case 's':\n      out[t] = -v;\n      break;\n    case 'u':\n      if (point[t] !== undefined) {\n        out.z = v;\n      }\n      break;\n    case 'd':\n      if (point[t] !== undefined) {\n        out.z = -v;\n      }\n      break;\n    default:\n      //console.log(\"ERROR: unknow axis (\"+crs.axis[i]+\") - check definition of \"+crs.projName);\n      return null;\n    }\n  }\n  return out;\n}\n","export default function (array){\n  var out = {\n    x: array[0],\n    y: array[1]\n  };\n  if (array.length>2) {\n    out.z = array[2];\n  }\n  if (array.length>3) {\n    out.m = array[3];\n  }\n  return out;\n}","export default function (point) {\n  checkCoord(point.x);\n  checkCoord(point.y);\n}\nfunction checkCoord(num) {\n  if (typeof Number.isFinite === 'function') {\n    if (Number.isFinite(num)) {\n      return;\n    }\n    throw new TypeError('coordinates must be finite numbers');\n  }\n  if (typeof num !== 'number' || num !== num || !isFinite(num)) {\n    throw new TypeError('coordinates must be finite numbers');\n  }\n}\n","import {D2R, R2D, PJD_3PARAM, PJD_7PARAM} from './constants/values';\nimport datum_transform from './datum_transform';\nimport adjust_axis from './adjust_axis';\nimport proj from './Proj';\nimport toPoint from './common/toPoint';\nimport checkSanity from './checkSanity';\n\nfunction checkNotWGS(source, dest) {\n  return ((source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM) && dest.datumCode !== 'WGS84') || ((dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM) && source.datumCode !== 'WGS84');\n}\n\nexport default function transform(source, dest, point) {\n  var wgs84;\n  if (Array.isArray(point)) {\n    point = toPoint(point);\n  }\n  checkSanity(point);\n  // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84\n  if (source.datum && dest.datum && checkNotWGS(source, dest)) {\n    wgs84 = new proj('WGS84');\n    point = transform(source, wgs84, point);\n    source = wgs84;\n  }\n  // DGR, 2010/11/12\n  if (source.axis !== 'enu') {\n    point = adjust_axis(source, false, point);\n  }\n  // Transform source points to long/lat, if they aren't already.\n  if (source.projName === 'longlat') {\n    point = {\n      x: point.x * D2R,\n      y: point.y * D2R\n    };\n  }\n  else {\n    if (source.to_meter) {\n      point = {\n        x: point.x * source.to_meter,\n        y: point.y * source.to_meter\n      };\n    }\n    point = source.inverse(point); // Convert Cartesian to longlat\n  }\n  // Adjust for the prime meridian if necessary\n  if (source.from_greenwich) {\n    point.x += source.from_greenwich;\n  }\n\n  // Convert datums if needed, and if possible.\n  point = datum_transform(source.datum, dest.datum, point);\n\n  // Adjust for the prime meridian if necessary\n  if (dest.from_greenwich) {\n    point = {\n      x: point.x - dest.from_greenwich,\n      y: point.y\n    };\n  }\n\n  if (dest.projName === 'longlat') {\n    // convert radians to decimal degrees\n    point = {\n      x: point.x * R2D,\n      y: point.y * R2D\n    };\n  } else { // else project\n    point = dest.forward(point);\n    if (dest.to_meter) {\n      point = {\n        x: point.x / dest.to_meter,\n        y: point.y / dest.to_meter\n      };\n    }\n  }\n\n  // DGR, 2010/11/12\n  if (dest.axis !== 'enu') {\n    return adjust_axis(dest, true, point);\n  }\n\n  return point;\n}\n","import proj from './Proj';\nimport transform from './transform';\nvar wgs84 = proj('WGS84');\n\nfunction transformer(from, to, coords) {\n  var transformedArray, out, keys;\n  if (Array.isArray(coords)) {\n    transformedArray = transform(from, to, coords);\n    if (coords.length === 3) {\n      return [transformedArray.x, transformedArray.y, transformedArray.z];\n    }\n    else {\n      return [transformedArray.x, transformedArray.y];\n    }\n  }\n  else {\n    out = transform(from, to, coords);\n    keys = Object.keys(coords);\n    if (keys.length === 2) {\n      return out;\n    }\n    keys.forEach(function (key) {\n      if (key === 'x' || key === 'y') {\n        return;\n      }\n      out[key] = coords[key];\n    });\n    return out;\n  }\n}\n\nfunction checkProj(item) {\n  if (item instanceof proj) {\n    return item;\n  }\n  if (item.oProj) {\n    return item.oProj;\n  }\n  return proj(item);\n}\nfunction proj4(fromProj, toProj, coord) {\n  fromProj = checkProj(fromProj);\n  var single = false;\n  var obj;\n  if (typeof toProj === 'undefined') {\n    toProj = fromProj;\n    fromProj = wgs84;\n    single = true;\n  }\n  else if (typeof toProj.x !== 'undefined' || Array.isArray(toProj)) {\n    coord = toProj;\n    toProj = fromProj;\n    fromProj = wgs84;\n    single = true;\n  }\n  toProj = checkProj(toProj);\n  if (coord) {\n    return transformer(fromProj, toProj, coord);\n  }\n  else {\n    obj = {\n      forward: function(coords) {\n        return transformer(fromProj, toProj, coords);\n      },\n      inverse: function(coords) {\n        return transformer(toProj, fromProj, coords);\n      }\n    };\n    if (single) {\n      obj.oProj = toProj;\n    }\n    return obj;\n  }\n}\nexport default proj4;\n","\n\n\n/**\n * UTM zones are grouped, and assigned to one of a group of 6\n * sets.\n *\n * {int} @private\n */\nvar NUM_100K_SETS = 6;\n\n/**\n * The column letters (for easting) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';\n\n/**\n * The row letters (for northing) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_ROW_LETTERS = 'AFAFAF';\n\nvar A = 65; // A\nvar I = 73; // I\nvar O = 79; // O\nvar V = 86; // V\nvar Z = 90; // Z\nexport default {\n  forward: forward,\n  inverse: inverse,\n  toPoint: toPoint\n};\n/**\n * Conversion of lat/lon to MGRS.\n *\n * @param {object} ll Object literal with lat and lon properties on a\n *     WGS84 ellipsoid.\n * @param {int} accuracy Accuracy in digits (5 for 1 m, 4 for 10 m, 3 for\n *      100 m, 2 for 1000 m or 1 for 10000 m). Optional, default is 5.\n * @return {string} the MGRS string for the given location and accuracy.\n */\nexport function forward(ll, accuracy) {\n  accuracy = accuracy || 5; // default accuracy 1m\n  return encode(LLtoUTM({\n    lat: ll[1],\n    lon: ll[0]\n  }), accuracy);\n};\n\n/**\n * Conversion of MGRS to lat/lon.\n *\n * @param {string} mgrs MGRS string.\n * @return {array} An array with left (longitude), bottom (latitude), right\n *     (longitude) and top (latitude) values in WGS84, representing the\n *     bounding box for the provided MGRS reference.\n */\nexport function inverse(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];\n  }\n  return [bbox.left, bbox.bottom, bbox.right, bbox.top];\n};\n\nexport function toPoint(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat];\n  }\n  return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];\n};\n/**\n * Conversion from degrees to radians.\n *\n * @private\n * @param {number} deg the angle in degrees.\n * @return {number} the angle in radians.\n */\nfunction degToRad(deg) {\n  return (deg * (Math.PI / 180.0));\n}\n\n/**\n * Conversion from radians to degrees.\n *\n * @private\n * @param {number} rad the angle in radians.\n * @return {number} the angle in degrees.\n */\nfunction radToDeg(rad) {\n  return (180.0 * (rad / Math.PI));\n}\n\n/**\n * Converts a set of Longitude and Latitude co-ordinates to UTM\n * using the WGS84 ellipsoid.\n *\n * @private\n * @param {object} ll Object literal with lat and lon properties\n *     representing the WGS84 coordinate to be converted.\n * @return {object} Object literal containing the UTM value with easting,\n *     northing, zoneNumber and zoneLetter properties, and an optional\n *     accuracy property in digits. Returns null if the conversion failed.\n */\nfunction LLtoUTM(ll) {\n  var Lat = ll.lat;\n  var Long = ll.lon;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var k0 = 0.9996;\n  var LongOrigin;\n  var eccPrimeSquared;\n  var N, T, C, A, M;\n  var LatRad = degToRad(Lat);\n  var LongRad = degToRad(Long);\n  var LongOriginRad;\n  var ZoneNumber;\n  // (int)\n  ZoneNumber = Math.floor((Long + 180) / 6) + 1;\n\n  //Make sure the longitude 180.00 is in Zone 60\n  if (Long === 180) {\n    ZoneNumber = 60;\n  }\n\n  // Special zone for Norway\n  if (Lat >= 56.0 && Lat < 64.0 && Long >= 3.0 && Long < 12.0) {\n    ZoneNumber = 32;\n  }\n\n  // Special zones for Svalbard\n  if (Lat >= 72.0 && Lat < 84.0) {\n    if (Long >= 0.0 && Long < 9.0) {\n      ZoneNumber = 31;\n    }\n    else if (Long >= 9.0 && Long < 21.0) {\n      ZoneNumber = 33;\n    }\n    else if (Long >= 21.0 && Long < 33.0) {\n      ZoneNumber = 35;\n    }\n    else if (Long >= 33.0 && Long < 42.0) {\n      ZoneNumber = 37;\n    }\n  }\n\n  LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; //+3 puts origin\n  // in middle of\n  // zone\n  LongOriginRad = degToRad(LongOrigin);\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));\n  T = Math.tan(LatRad) * Math.tan(LatRad);\n  C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);\n  A = Math.cos(LatRad) * (LongRad - LongOriginRad);\n\n  M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));\n\n  var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6.0 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120.0) + 500000.0);\n\n  var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24.0 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720.0)));\n  if (Lat < 0.0) {\n    UTMNorthing += 10000000.0; //10000000 meter offset for\n    // southern hemisphere\n  }\n\n  return {\n    northing: Math.round(UTMNorthing),\n    easting: Math.round(UTMEasting),\n    zoneNumber: ZoneNumber,\n    zoneLetter: getLetterDesignator(Lat)\n  };\n}\n\n/**\n * Converts UTM coords to lat/long, using the WGS84 ellipsoid. This is a convenience\n * class where the Zone can be specified as a single string eg.\"60N\" which\n * is then broken down into the ZoneNumber and ZoneLetter.\n *\n * @private\n * @param {object} utm An object literal with northing, easting, zoneNumber\n *     and zoneLetter properties. If an optional accuracy property is\n *     provided (in meters), a bounding box will be returned instead of\n *     latitude and longitude.\n * @return {object} An object literal containing either lat and lon values\n *     (if no accuracy was provided), or top, right, bottom and left values\n *     for the bounding box calculated according to the provided accuracy.\n *     Returns null if the conversion failed.\n */\nfunction UTMtoLL(utm) {\n\n  var UTMNorthing = utm.northing;\n  var UTMEasting = utm.easting;\n  var zoneLetter = utm.zoneLetter;\n  var zoneNumber = utm.zoneNumber;\n  // check the ZoneNummber is valid\n  if (zoneNumber < 0 || zoneNumber > 60) {\n    return null;\n  }\n\n  var k0 = 0.9996;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var eccPrimeSquared;\n  var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));\n  var N1, T1, C1, R1, D, M;\n  var LongOrigin;\n  var mu, phi1Rad;\n\n  // remove 500,000 meter offset for longitude\n  var x = UTMEasting - 500000.0;\n  var y = UTMNorthing;\n\n  // We must know somehow if we are in the Northern or Southern\n  // hemisphere, this is the only time we use the letter So even\n  // if the Zone letter isn't exactly correct it should indicate\n  // the hemisphere correctly\n  if (zoneLetter < 'N') {\n    y -= 10000000.0; // remove 10,000,000 meter offset used\n    // for southern hemisphere\n  }\n\n  // There are 60 zones with zone 1 being at West -180 to -174\n  LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; // +3 puts origin\n  // in middle of\n  // zone\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  M = y / k0;\n  mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));\n\n  phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);\n  // double phi1 = ProjMath.radToDeg(phi1Rad);\n\n  N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));\n  T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);\n  C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);\n  R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);\n  D = x / (N1 * k0);\n\n  var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);\n  lat = radToDeg(lat);\n\n  var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);\n  lon = LongOrigin + radToDeg(lon);\n\n  var result;\n  if (utm.accuracy) {\n    var topRight = UTMtoLL({\n      northing: utm.northing + utm.accuracy,\n      easting: utm.easting + utm.accuracy,\n      zoneLetter: utm.zoneLetter,\n      zoneNumber: utm.zoneNumber\n    });\n    result = {\n      top: topRight.lat,\n      right: topRight.lon,\n      bottom: lat,\n      left: lon\n    };\n  }\n  else {\n    result = {\n      lat: lat,\n      lon: lon\n    };\n  }\n  return result;\n}\n\n/**\n * Calculates the MGRS letter designator for the given latitude.\n *\n * @private\n * @param {number} lat The latitude in WGS84 to get the letter designator\n *     for.\n * @return {char} The letter designator.\n */\nfunction getLetterDesignator(lat) {\n  //This is here as an error flag to show that the Latitude is\n  //outside MGRS limits\n  var LetterDesignator = 'Z';\n\n  if ((84 >= lat) && (lat >= 72)) {\n    LetterDesignator = 'X';\n  }\n  else if ((72 > lat) && (lat >= 64)) {\n    LetterDesignator = 'W';\n  }\n  else if ((64 > lat) && (lat >= 56)) {\n    LetterDesignator = 'V';\n  }\n  else if ((56 > lat) && (lat >= 48)) {\n    LetterDesignator = 'U';\n  }\n  else if ((48 > lat) && (lat >= 40)) {\n    LetterDesignator = 'T';\n  }\n  else if ((40 > lat) && (lat >= 32)) {\n    LetterDesignator = 'S';\n  }\n  else if ((32 > lat) && (lat >= 24)) {\n    LetterDesignator = 'R';\n  }\n  else if ((24 > lat) && (lat >= 16)) {\n    LetterDesignator = 'Q';\n  }\n  else if ((16 > lat) && (lat >= 8)) {\n    LetterDesignator = 'P';\n  }\n  else if ((8 > lat) && (lat >= 0)) {\n    LetterDesignator = 'N';\n  }\n  else if ((0 > lat) && (lat >= -8)) {\n    LetterDesignator = 'M';\n  }\n  else if ((-8 > lat) && (lat >= -16)) {\n    LetterDesignator = 'L';\n  }\n  else if ((-16 > lat) && (lat >= -24)) {\n    LetterDesignator = 'K';\n  }\n  else if ((-24 > lat) && (lat >= -32)) {\n    LetterDesignator = 'J';\n  }\n  else if ((-32 > lat) && (lat >= -40)) {\n    LetterDesignator = 'H';\n  }\n  else if ((-40 > lat) && (lat >= -48)) {\n    LetterDesignator = 'G';\n  }\n  else if ((-48 > lat) && (lat >= -56)) {\n    LetterDesignator = 'F';\n  }\n  else if ((-56 > lat) && (lat >= -64)) {\n    LetterDesignator = 'E';\n  }\n  else if ((-64 > lat) && (lat >= -72)) {\n    LetterDesignator = 'D';\n  }\n  else if ((-72 > lat) && (lat >= -80)) {\n    LetterDesignator = 'C';\n  }\n  return LetterDesignator;\n}\n\n/**\n * Encodes a UTM location as MGRS string.\n *\n * @private\n * @param {object} utm An object literal with easting, northing,\n *     zoneLetter, zoneNumber\n * @param {number} accuracy Accuracy in digits (1-5).\n * @return {string} MGRS string for the given UTM location.\n */\nfunction encode(utm, accuracy) {\n  // prepend with leading zeroes\n  var seasting = \"00000\" + utm.easting,\n    snorthing = \"00000\" + utm.northing;\n\n  return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);\n}\n\n/**\n * Get the two letter 100k designator for a given UTM easting,\n * northing and zone number value.\n *\n * @private\n * @param {number} easting\n * @param {number} northing\n * @param {number} zoneNumber\n * @return the two letter 100k designator for the given UTM location.\n */\nfunction get100kID(easting, northing, zoneNumber) {\n  var setParm = get100kSetForZone(zoneNumber);\n  var setColumn = Math.floor(easting / 100000);\n  var setRow = Math.floor(northing / 100000) % 20;\n  return getLetter100kID(setColumn, setRow, setParm);\n}\n\n/**\n * Given a UTM zone number, figure out the MGRS 100K set it is in.\n *\n * @private\n * @param {number} i An UTM zone number.\n * @return {number} the 100k set the UTM zone is in.\n */\nfunction get100kSetForZone(i) {\n  var setParm = i % NUM_100K_SETS;\n  if (setParm === 0) {\n    setParm = NUM_100K_SETS;\n  }\n\n  return setParm;\n}\n\n/**\n * Get the two-letter MGRS 100k designator given information\n * translated from the UTM northing, easting and zone number.\n *\n * @private\n * @param {number} column the column index as it relates to the MGRS\n *        100k set spreadsheet, created from the UTM easting.\n *        Values are 1-8.\n * @param {number} row the row index as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM northing value. Values\n *        are from 0-19.\n * @param {number} parm the set block, as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM zone. Values are from\n *        1-60.\n * @return two letter MGRS 100k code.\n */\nfunction getLetter100kID(column, row, parm) {\n  // colOrigin and rowOrigin are the letters at the origin of the set\n  var index = parm - 1;\n  var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);\n  var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);\n\n  // colInt and rowInt are the letters to build to return\n  var colInt = colOrigin + column - 1;\n  var rowInt = rowOrigin + row;\n  var rollover = false;\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n    rollover = true;\n  }\n\n  if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {\n    colInt++;\n  }\n\n  if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {\n    colInt++;\n\n    if (colInt === I) {\n      colInt++;\n    }\n  }\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n    rollover = true;\n  }\n  else {\n    rollover = false;\n  }\n\n  if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) {\n    rowInt++;\n  }\n\n  if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {\n    rowInt++;\n\n    if (rowInt === I) {\n      rowInt++;\n    }\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n  }\n\n  var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);\n  return twoLetter;\n}\n\n/**\n * Decode the UTM parameters from a MGRS string.\n *\n * @private\n * @param {string} mgrsString an UPPERCASE coordinate string is expected.\n * @return {object} An object literal with easting, northing, zoneLetter,\n *     zoneNumber and accuracy (in meters) properties.\n */\nfunction decode(mgrsString) {\n\n  if (mgrsString && mgrsString.length === 0) {\n    throw (\"MGRSPoint coverting from nothing\");\n  }\n\n  var length = mgrsString.length;\n\n  var hunK = null;\n  var sb = \"\";\n  var testChar;\n  var i = 0;\n\n  // get Zone number\n  while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {\n    if (i >= 2) {\n      throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n    }\n    sb += testChar;\n    i++;\n  }\n\n  var zoneNumber = parseInt(sb, 10);\n\n  if (i === 0 || i + 3 > length) {\n    // A good MGRS string has to be 4-5 digits long,\n    // ##AAA/#AAA at least.\n    throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n  }\n\n  var zoneLetter = mgrsString.charAt(i++);\n\n  // Should we check the zone letter here? Why not.\n  if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {\n    throw (\"MGRSPoint zone letter \" + zoneLetter + \" not handled: \" + mgrsString);\n  }\n\n  hunK = mgrsString.substring(i, i += 2);\n\n  var set = get100kSetForZone(zoneNumber);\n\n  var east100k = getEastingFromChar(hunK.charAt(0), set);\n  var north100k = getNorthingFromChar(hunK.charAt(1), set);\n\n  // We have a bug where the northing may be 2000000 too low.\n  // How\n  // do we know when to roll over?\n\n  while (north100k < getMinNorthing(zoneLetter)) {\n    north100k += 2000000;\n  }\n\n  // calculate the char index for easting/northing separator\n  var remainder = length - i;\n\n  if (remainder % 2 !== 0) {\n    throw (\"MGRSPoint has to have an even number \\nof digits after the zone letter and two 100km letters - front \\nhalf for easting meters, second half for \\nnorthing meters\" + mgrsString);\n  }\n\n  var sep = remainder / 2;\n\n  var sepEasting = 0.0;\n  var sepNorthing = 0.0;\n  var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;\n  if (sep > 0) {\n    accuracyBonus = 100000.0 / Math.pow(10, sep);\n    sepEastingString = mgrsString.substring(i, i + sep);\n    sepEasting = parseFloat(sepEastingString) * accuracyBonus;\n    sepNorthingString = mgrsString.substring(i + sep);\n    sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;\n  }\n\n  easting = sepEasting + east100k;\n  northing = sepNorthing + north100k;\n\n  return {\n    easting: easting,\n    northing: northing,\n    zoneLetter: zoneLetter,\n    zoneNumber: zoneNumber,\n    accuracy: accuracyBonus\n  };\n}\n\n/**\n * Given the first letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the easting value that\n * should be added to the other, secondary easting value.\n *\n * @private\n * @param {char} e The first letter from a two-letter MGRS 100´k zone.\n * @param {number} set The MGRS table set for the zone number.\n * @return {number} The easting value for the given letter and set.\n */\nfunction getEastingFromChar(e, set) {\n  // colOrigin is the letter at the origin of the set for the\n  // column\n  var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);\n  var eastingValue = 100000.0;\n  var rewindMarker = false;\n\n  while (curCol !== e.charCodeAt(0)) {\n    curCol++;\n    if (curCol === I) {\n      curCol++;\n    }\n    if (curCol === O) {\n      curCol++;\n    }\n    if (curCol > Z) {\n      if (rewindMarker) {\n        throw (\"Bad character: \" + e);\n      }\n      curCol = A;\n      rewindMarker = true;\n    }\n    eastingValue += 100000.0;\n  }\n\n  return eastingValue;\n}\n\n/**\n * Given the second letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the northing value that\n * should be added to the other, secondary northing value. You have to\n * remember that Northings are determined from the equator, and the vertical\n * cycle of letters mean a 2000000 additional northing meters. This happens\n * approx. every 18 degrees of latitude. This method does *NOT* count any\n * additional northings. You have to figure out how many 2000000 meters need\n * to be added for the zone letter of the MGRS coordinate.\n *\n * @private\n * @param {char} n Second letter of the MGRS 100k zone\n * @param {number} set The MGRS table set number, which is dependent on the\n *     UTM zone number.\n * @return {number} The northing value for the given letter and set.\n */\nfunction getNorthingFromChar(n, set) {\n\n  if (n > 'V') {\n    throw (\"MGRSPoint given invalid Northing \" + n);\n  }\n\n  // rowOrigin is the letter at the origin of the set for the\n  // column\n  var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);\n  var northingValue = 0.0;\n  var rewindMarker = false;\n\n  while (curRow !== n.charCodeAt(0)) {\n    curRow++;\n    if (curRow === I) {\n      curRow++;\n    }\n    if (curRow === O) {\n      curRow++;\n    }\n    // fixing a bug making whole application hang in this loop\n    // when 'n' is a wrong character\n    if (curRow > V) {\n      if (rewindMarker) { // making sure that this loop ends\n        throw (\"Bad character: \" + n);\n      }\n      curRow = A;\n      rewindMarker = true;\n    }\n    northingValue += 100000.0;\n  }\n\n  return northingValue;\n}\n\n/**\n * The function getMinNorthing returns the minimum northing value of a MGRS\n * zone.\n *\n * Ported from Geotrans' c Lattitude_Band_Value structure table.\n *\n * @private\n * @param {char} zoneLetter The MGRS zone to get the min northing for.\n * @return {number}\n */\nfunction getMinNorthing(zoneLetter) {\n  var northing;\n  switch (zoneLetter) {\n  case 'C':\n    northing = 1100000.0;\n    break;\n  case 'D':\n    northing = 2000000.0;\n    break;\n  case 'E':\n    northing = 2800000.0;\n    break;\n  case 'F':\n    northing = 3700000.0;\n    break;\n  case 'G':\n    northing = 4600000.0;\n    break;\n  case 'H':\n    northing = 5500000.0;\n    break;\n  case 'J':\n    northing = 6400000.0;\n    break;\n  case 'K':\n    northing = 7300000.0;\n    break;\n  case 'L':\n    northing = 8200000.0;\n    break;\n  case 'M':\n    northing = 9100000.0;\n    break;\n  case 'N':\n    northing = 0.0;\n    break;\n  case 'P':\n    northing = 800000.0;\n    break;\n  case 'Q':\n    northing = 1700000.0;\n    break;\n  case 'R':\n    northing = 2600000.0;\n    break;\n  case 'S':\n    northing = 3500000.0;\n    break;\n  case 'T':\n    northing = 4400000.0;\n    break;\n  case 'U':\n    northing = 5300000.0;\n    break;\n  case 'V':\n    northing = 6200000.0;\n    break;\n  case 'W':\n    northing = 7000000.0;\n    break;\n  case 'X':\n    northing = 7900000.0;\n    break;\n  default:\n    northing = -1.0;\n  }\n  if (northing >= 0.0) {\n    return northing;\n  }\n  else {\n    throw (\"Invalid zone letter: \" + zoneLetter);\n  }\n\n}\n","import {toPoint, forward} from 'mgrs';\n\nfunction Point(x, y, z) {\n  if (!(this instanceof Point)) {\n    return new Point(x, y, z);\n  }\n  if (Array.isArray(x)) {\n    this.x = x[0];\n    this.y = x[1];\n    this.z = x[2] || 0.0;\n  } else if(typeof x === 'object') {\n    this.x = x.x;\n    this.y = x.y;\n    this.z = x.z || 0.0;\n  } else if (typeof x === 'string' && typeof y === 'undefined') {\n    var coords = x.split(',');\n    this.x = parseFloat(coords[0], 10);\n    this.y = parseFloat(coords[1], 10);\n    this.z = parseFloat(coords[2], 10) || 0.0;\n  } else {\n    this.x = x;\n    this.y = y;\n    this.z = z || 0.0;\n  }\n  console.warn('proj4.Point will be removed in version 3, use proj4.toPoint');\n}\n\nPoint.fromMGRS = function(mgrsStr) {\n  return new Point(toPoint(mgrsStr));\n};\nPoint.prototype.toMGRS = function(accuracy) {\n  return forward([this.x, this.y], accuracy);\n};\nexport default Point;\n","var C00 = 1;\nvar C02 = 0.25;\nvar C04 = 0.046875;\nvar C06 = 0.01953125;\nvar C08 = 0.01068115234375;\nvar C22 = 0.75;\nvar C44 = 0.46875;\nvar C46 = 0.01302083333333333333;\nvar C48 = 0.00712076822916666666;\nvar C66 = 0.36458333333333333333;\nvar C68 = 0.00569661458333333333;\nvar C88 = 0.3076171875;\n\nexport default function(es) {\n  var en = [];\n  en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));\n  en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));\n  var t = es * es;\n  en[2] = t * (C44 - es * (C46 + es * C48));\n  t *= es;\n  en[3] = t * (C66 - es * C68);\n  en[4] = t * es * C88;\n  return en;\n}","export default function(phi, sphi, cphi, en) {\n  cphi *= sphi;\n  sphi *= sphi;\n  return (en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4]))));\n}","import pj_mlfn from \"./pj_mlfn\";\nimport {EPSLN} from '../constants/values';\n\nvar MAX_ITER = 20;\n\nexport default function(arg, es, en) {\n  var k = 1 / (1 - es);\n  var phi = arg;\n  for (var i = MAX_ITER; i; --i) { /* rarely goes over 2 iterations */\n    var s = Math.sin(phi);\n    var t = 1 - es * s * s;\n    //t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;\n    //phi -= t * (t * Math.sqrt(t)) * k;\n    t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;\n    phi -= t;\n    if (Math.abs(t) < EPSLN) {\n      return phi;\n    }\n  }\n  //..reportError(\"cass:pj_inv_mlfn: Convergence error\");\n  return phi;\n}\n","// Heavily based on this tmerc projection implementation\n// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/tmerc.js\n\nimport pj_enfn from '../common/pj_enfn';\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport adjust_lon from '../common/adjust_lon';\n\nimport {EPSLN, HALF_PI} from '../constants/values';\nimport sign from '../common/sign';\n\nexport function init() {\n  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n  if (this.es) {\n    this.en = pj_enfn(this.es);\n    this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);\n  }\n}\n\n/**\n    Transverse Mercator Forward  - long/lat to x/y\n    long/lat in radians\n  */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lon = adjust_lon(lon - this.long0);\n  var con;\n  var x, y;\n  var sin_phi = Math.sin(lat);\n  var cos_phi = Math.cos(lat);\n\n  if (!this.es) {\n    var b = cos_phi * Math.sin(delta_lon);\n\n    if ((Math.abs(Math.abs(b) - 1)) < EPSLN) {\n      return (93);\n    }\n    else {\n      x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;\n      y = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));\n      b = Math.abs(y);\n\n      if (b >= 1) {\n        if ((b - 1) > EPSLN) {\n          return (93);\n        }\n        else {\n          y = 0;\n        }\n      }\n      else {\n        y = Math.acos(y);\n      }\n\n      if (lat < 0) {\n        y = -y;\n      }\n\n      y = this.a * this.k0 * (y - this.lat0) + this.y0;\n    }\n  }\n  else {\n    var al = cos_phi * delta_lon;\n    var als = Math.pow(al, 2);\n    var c = this.ep2 * Math.pow(cos_phi, 2);\n    var cs = Math.pow(c, 2);\n    var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;\n    var t = Math.pow(tq, 2);\n    var ts = Math.pow(t, 2);\n    con = 1 - this.es * Math.pow(sin_phi, 2);\n    al = al / Math.sqrt(con);\n    var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);\n\n    x = this.a * (this.k0 * al * (1 +\n      als / 6 * (1 - t + c +\n      als / 20 * (5 - 18 * t + ts + 14 * c - 58 * t * c +\n      als / 42 * (61 + 179 * ts - ts * t - 479 * t))))) +\n      this.x0;\n\n    y = this.a * (this.k0 * (ml - this.ml0 +\n      sin_phi * delta_lon * al / 2 * (1 +\n      als / 12 * (5 - t + 9 * c + 4 * cs +\n      als / 30 * (61 + ts - 58 * t + 270 * c - 330 * t * c +\n      als / 56 * (1385 + 543 * ts - ts * t - 3111 * t)))))) +\n      this.y0;\n  }\n\n  p.x = x;\n  p.y = y;\n\n  return p;\n}\n\n/**\n    Transverse Mercator Inverse  -  x/y to long/lat\n  */\nexport function inverse(p) {\n  var con, phi;\n  var lat, lon;\n  var x = (p.x - this.x0) * (1 / this.a);\n  var y = (p.y - this.y0) * (1 / this.a);\n\n  if (!this.es) {\n    var f = Math.exp(x / this.k0);\n    var g = 0.5 * (f - 1 / f);\n    var temp = this.lat0 + y / this.k0;\n    var h = Math.cos(temp);\n    con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));\n    lat = Math.asin(con);\n\n    if (y < 0) {\n      lat = -lat;\n    }\n\n    if ((g === 0) && (h === 0)) {\n      lon = 0;\n    }\n    else {\n      lon = adjust_lon(Math.atan2(g, h) + this.long0);\n    }\n  }\n  else { // ellipsoidal form\n    con = this.ml0 + y / this.k0;\n    phi = pj_inv_mlfn(con, this.es, this.en);\n\n    if (Math.abs(phi) < HALF_PI) {\n      var sin_phi = Math.sin(phi);\n      var cos_phi = Math.cos(phi);\n      var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;\n      var c = this.ep2 * Math.pow(cos_phi, 2);\n      var cs = Math.pow(c, 2);\n      var t = Math.pow(tan_phi, 2);\n      var ts = Math.pow(t, 2);\n      con = 1 - this.es * Math.pow(sin_phi, 2);\n      var d = x * Math.sqrt(con) / this.k0;\n      var ds = Math.pow(d, 2);\n      con = con * tan_phi;\n\n      lat = phi - (con * ds / (1 - this.es)) * 0.5 * (1 -\n        ds / 12 * (5 + 3 * t - 9 * c * t + c - 4 * cs -\n        ds / 30 * (61 + 90 * t - 252 * c * t + 45 * ts + 46 * c -\n        ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));\n\n      lon = adjust_lon(this.long0 + (d * (1 -\n        ds / 6 * (1 + 2 * t + c -\n        ds / 20 * (5 + 28 * t + 24 * ts + 8 * c * t + 6 * c -\n        ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi));\n    }\n    else {\n      lat = HALF_PI * sign(y);\n      lon = 0;\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = [\"Transverse_Mercator\", \"Transverse Mercator\", \"tmerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(x) {\n  var r = Math.exp(x);\n  r = (r - 1 / r) / 2;\n  return r;\n}","export default function(x, y) {\n  x = Math.abs(x);\n  y = Math.abs(y);\n  var a = Math.max(x, y);\n  var b = Math.min(x, y) / (a ? a : 1);\n\n  return a * Math.sqrt(1 + Math.pow(b, 2));\n}\n","import hypot from './hypot';\nimport log1py from './log1py';\n\nexport default function(x) {\n  var y = Math.abs(x);\n  y = log1py(y * (1 + y / (hypot(1, y) + 1)));\n\n  return x < 0 ? -y : y;\n}\n","export default function(x) {\n  var y = 1 + x;\n  var z = y - 1;\n\n  return z === 0 ? x : x * Math.log(y) / z;\n}\n","export default function(pp, B) {\n  var cos_2B = 2 * Math.cos(2 * B);\n  var i = pp.length - 1;\n  var h1 = pp[i];\n  var h2 = 0;\n  var h;\n\n  while (--i >= 0) {\n    h = -h2 + cos_2B * h1 + pp[i];\n    h2 = h1;\n    h1 = h;\n  }\n\n  return (B + h * Math.sin(2 * B));\n}\n","export default function(pp, arg_r) {\n  var r = 2 * Math.cos(arg_r);\n  var i = pp.length - 1;\n  var hr1 = pp[i];\n  var hr2 = 0;\n  var hr;\n\n  while (--i >= 0) {\n    hr = -hr2 + r * hr1 + pp[i];\n    hr2 = hr1;\n    hr1 = hr;\n  }\n\n  return Math.sin(arg_r) * hr;\n}\n","import sinh from './sinh';\nimport cosh from './cosh';\n\nexport default function(pp, arg_r, arg_i) {\n  var sin_arg_r = Math.sin(arg_r);\n  var cos_arg_r = Math.cos(arg_r);\n  var sinh_arg_i = sinh(arg_i);\n  var cosh_arg_i = cosh(arg_i);\n  var r = 2 * cos_arg_r * cosh_arg_i;\n  var i = -2 * sin_arg_r * sinh_arg_i;\n  var j = pp.length - 1;\n  var hr = pp[j];\n  var hi1 = 0;\n  var hr1 = 0;\n  var hi = 0;\n  var hr2;\n  var hi2;\n\n  while (--j >= 0) {\n    hr2 = hr1;\n    hi2 = hi1;\n    hr1 = hr;\n    hi1 = hi;\n    hr = -hr2 + r * hr1 - i * hi1 + pp[j];\n    hi = -hi2 + i * hr1 + r * hi1;\n  }\n\n  r = sin_arg_r * cosh_arg_i;\n  i = cos_arg_r * sinh_arg_i;\n\n  return [r * hr - i * hi, r * hi + i * hr];\n}\n","export default function(x) {\n  var r = Math.exp(x);\n  r = (r + 1 / r) / 2;\n  return r;\n}","// Heavily based on this etmerc projection implementation\n// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/etmerc.js\n\nimport sinh from '../common/sinh';\nimport hypot from '../common/hypot';\nimport asinhy from '../common/asinhy';\nimport gatg from '../common/gatg';\nimport clens from '../common/clens';\nimport clens_cmplx from '../common/clens_cmplx';\nimport adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  if (this.es === undefined || this.es <= 0) {\n    throw new Error('incorrect elliptical usage');\n  }\n\n  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n  this.cgb = [];\n  this.cbg = [];\n  this.utg = [];\n  this.gtu = [];\n\n  var f = this.es / (1 + Math.sqrt(1 - this.es));\n  var n = f / (2 - f);\n  var np = n;\n\n  this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675 ))))));\n  this.cbg[0] = n * (-2 + n * ( 2 / 3 + n * ( 4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));\n\n  np = np * n;\n  this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));\n  this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * ( -13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));\n\n  np = np * n;\n  this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));\n  this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));\n\n  np = np * n;\n  this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));\n  this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * ( -24832 / 14175)));\n\n  np = np * n;\n  this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));\n  this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));\n\n  np = np * n;\n  this.cgb[5] = np * (601676 / 22275);\n  this.cbg[5] = np * (444337 / 155925);\n\n  np = Math.pow(n, 2);\n  this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));\n\n  this.utg[0] = n * (-0.5 + n * ( 2 / 3 + n * (-37 / 96 + n * ( 1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));\n  this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));\n\n  this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));\n  this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));\n\n  np = np * n;\n  this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720 ))));\n  this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));\n\n  np = np * n;\n  this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));\n  this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));\n\n  np = np * n;\n  this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));\n  this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));\n\n  np = np * n;\n  this.utg[5] = np * (-20648693 / 638668800);\n  this.gtu[5] = np * (212378941 / 319334400);\n\n  var Z = gatg(this.cbg, this.lat0);\n  this.Zb = -this.Qn * (Z + clens(this.gtu, 2 * Z));\n}\n\nexport function forward(p) {\n  var Ce = adjust_lon(p.x - this.long0);\n  var Cn = p.y;\n\n  Cn = gatg(this.cbg, Cn);\n  var sin_Cn = Math.sin(Cn);\n  var cos_Cn = Math.cos(Cn);\n  var sin_Ce = Math.sin(Ce);\n  var cos_Ce = Math.cos(Ce);\n\n  Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);\n  Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));\n  Ce = asinhy(Math.tan(Ce));\n\n  var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);\n\n  Cn = Cn + tmp[0];\n  Ce = Ce + tmp[1];\n\n  var x;\n  var y;\n\n  if (Math.abs(Ce) <= 2.623395162778) {\n    x = this.a * (this.Qn * Ce) + this.x0;\n    y = this.a * (this.Qn * Cn + this.Zb) + this.y0;\n  }\n  else {\n    x = Infinity;\n    y = Infinity;\n  }\n\n  p.x = x;\n  p.y = y;\n\n  return p;\n}\n\nexport function inverse(p) {\n  var Ce = (p.x - this.x0) * (1 / this.a);\n  var Cn = (p.y - this.y0) * (1 / this.a);\n\n  Cn = (Cn - this.Zb) / this.Qn;\n  Ce = Ce / this.Qn;\n\n  var lon;\n  var lat;\n\n  if (Math.abs(Ce) <= 2.623395162778) {\n    var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);\n\n    Cn = Cn + tmp[0];\n    Ce = Ce + tmp[1];\n    Ce = Math.atan(sinh(Ce));\n\n    var sin_Cn = Math.sin(Cn);\n    var cos_Cn = Math.cos(Cn);\n    var sin_Ce = Math.sin(Ce);\n    var cos_Ce = Math.cos(Ce);\n\n    Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));\n    Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);\n\n    lon = adjust_lon(Ce + this.long0);\n    lat = gatg(this.cgb, Cn);\n  }\n  else {\n    lon = Infinity;\n    lat = Infinity;\n  }\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = [\"Extended_Transverse_Mercator\", \"Extended Transverse Mercator\", \"etmerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from './adjust_lon';\n\nexport default function(zone, lon) {\n  if (zone === undefined) {\n    zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;\n\n    if (zone < 0) {\n      return 0;\n    } else if (zone > 60) {\n      return 60;\n    }\n  }\n  return zone;\n}\n","import adjust_zone from '../common/adjust_zone';\nimport etmerc from './etmerc';\nexport var dependsOn = 'etmerc';\nimport {D2R} from '../constants/values';\n\n\nexport function init() {\n  var zone = adjust_zone(this.zone, this.long0);\n  if (zone === undefined) {\n    throw new Error('unknown utm zone');\n  }\n  this.lat0 = 0;\n  this.long0 =  ((6 * Math.abs(zone)) - 183) * D2R;\n  this.x0 = 500000;\n  this.y0 = this.utmSouth ? 10000000 : 0;\n  this.k0 = 0.9996;\n\n  etmerc.init.apply(this);\n  this.forward = etmerc.forward;\n  this.inverse = etmerc.inverse;\n}\n\nexport var names = [\"Universal Transverse Mercator System\", \"utm\"];\nexport default {\n  init: init,\n  names: names,\n  dependsOn: dependsOn\n};\n","export default function(esinp, exp) {\n  return (Math.pow((1 - esinp) / (1 + esinp), exp));\n}","import srat from '../common/srat';\nvar MAX_ITER = 20;\nimport {HALF_PI, FORTPI} from '../constants/values';\n\nexport function init() {\n  var sphi = Math.sin(this.lat0);\n  var cphi = Math.cos(this.lat0);\n  cphi *= cphi;\n  this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);\n  this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));\n  this.phic0 = Math.asin(sphi / this.C);\n  this.ratexp = 0.5 * this.C * this.e;\n  this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;\n  p.x = this.C * lon;\n  return p;\n}\n\nexport function inverse(p) {\n  var DEL_TOL = 1e-14;\n  var lon = p.x / this.C;\n  var lat = p.y;\n  var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);\n  for (var i = MAX_ITER; i > 0; --i) {\n    lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), - 0.5 * this.e)) - HALF_PI;\n    if (Math.abs(lat - p.y) < DEL_TOL) {\n      break;\n    }\n    p.y = lat;\n  }\n  /* convergence failed */\n  if (!i) {\n    return null;\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"gauss\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import gauss from './gauss';\nimport adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  gauss.init.apply(this);\n  if (!this.rc) {\n    return;\n  }\n  this.sinc0 = Math.sin(this.phic0);\n  this.cosc0 = Math.cos(this.phic0);\n  this.R2 = 2 * this.rc;\n  if (!this.title) {\n    this.title = \"Oblique Stereographic Alternative\";\n  }\n}\n\nexport function forward(p) {\n  var sinc, cosc, cosl, k;\n  p.x = adjust_lon(p.x - this.long0);\n  gauss.forward.apply(this, [p]);\n  sinc = Math.sin(p.y);\n  cosc = Math.cos(p.y);\n  cosl = Math.cos(p.x);\n  k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);\n  p.x = k * cosc * Math.sin(p.x);\n  p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);\n  p.x = this.a * p.x + this.x0;\n  p.y = this.a * p.y + this.y0;\n  return p;\n}\n\nexport function inverse(p) {\n  var sinc, cosc, lon, lat, rho;\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  p.x /= this.k0;\n  p.y /= this.k0;\n  if ((rho = Math.sqrt(p.x * p.x + p.y * p.y))) {\n    var c = 2 * Math.atan2(rho, this.R2);\n    sinc = Math.sin(c);\n    cosc = Math.cos(c);\n    lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho);\n    lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);\n  }\n  else {\n    lat = this.phic0;\n    lon = 0;\n  }\n\n  p.x = lon;\n  p.y = lat;\n  gauss.inverse.apply(this, [p]);\n  p.x = adjust_lon(p.x + this.long0);\n  return p;\n}\n\nexport var names = [\"Stereographic_North_Pole\", \"Oblique_Stereographic\", \"Polar_Stereographic\", \"sterea\",\"Oblique Stereographic Alternative\",\"Double_Stereographic\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {EPSLN, HALF_PI} from '../constants/values';\n\nimport sign from '../common/sign';\nimport msfnz from '../common/msfnz';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport adjust_lon from '../common/adjust_lon';\n\nexport function ssfn_(phit, sinphi, eccen) {\n  sinphi *= eccen;\n  return (Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen));\n}\n\nexport function init() {\n  this.coslat0 = Math.cos(this.lat0);\n  this.sinlat0 = Math.sin(this.lat0);\n  if (this.sphere) {\n    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n      this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));\n    }\n  }\n  else {\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      if (this.lat0 > 0) {\n        //North pole\n        //trace('stere:north pole');\n        this.con = 1;\n      }\n      else {\n        //South pole\n        //trace('stere:south pole');\n        this.con = -1;\n      }\n    }\n    this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));\n    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n      this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));\n    }\n    this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);\n    this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;\n    this.cosX0 = Math.cos(this.X0);\n    this.sinX0 = Math.sin(this.X0);\n  }\n}\n\n// Stereographic forward equations--mapping lat,long to x,y\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var sinlat = Math.sin(lat);\n  var coslat = Math.cos(lat);\n  var A, X, sinX, cosX, ts, rh;\n  var dlon = adjust_lon(lon - this.long0);\n\n  if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {\n    //case of the origine point\n    //trace('stere:this is the origin point');\n    p.x = NaN;\n    p.y = NaN;\n    return p;\n  }\n  if (this.sphere) {\n    //trace('stere:sphere case');\n    A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));\n    p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;\n    p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;\n    return p;\n  }\n  else {\n    X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;\n    cosX = Math.cos(X);\n    sinX = Math.sin(X);\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      ts = tsfnz(this.e, lat * this.con, this.con * sinlat);\n      rh = 2 * this.a * this.k0 * ts / this.cons;\n      p.x = this.x0 + rh * Math.sin(lon - this.long0);\n      p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);\n      //trace(p.toString());\n      return p;\n    }\n    else if (Math.abs(this.sinlat0) < EPSLN) {\n      //Eq\n      //trace('stere:equateur');\n      A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));\n      p.y = A * sinX;\n    }\n    else {\n      //other case\n      //trace('stere:normal case');\n      A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));\n      p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;\n    }\n    p.x = A * cosX * Math.sin(dlon) + this.x0;\n  }\n  //trace(p.toString());\n  return p;\n}\n\n//* Stereographic inverse equations--mapping x,y to lat/long\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var lon, lat, ts, ce, Chi;\n  var rh = Math.sqrt(p.x * p.x + p.y * p.y);\n  if (this.sphere) {\n    var c = 2 * Math.atan(rh / (2 * this.a * this.k0));\n    lon = this.long0;\n    lat = this.lat0;\n    if (rh <= EPSLN) {\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);\n    if (Math.abs(this.coslat0) < EPSLN) {\n      if (this.lat0 > 0) {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));\n      }\n      else {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n      }\n    }\n    else {\n      lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));\n    }\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  else {\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      if (rh <= EPSLN) {\n        lat = this.lat0;\n        lon = this.long0;\n        p.x = lon;\n        p.y = lat;\n        //trace(p.toString());\n        return p;\n      }\n      p.x *= this.con;\n      p.y *= this.con;\n      ts = rh * this.cons / (2 * this.a * this.k0);\n      lat = this.con * phi2z(this.e, ts);\n      lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, - 1 * p.y));\n    }\n    else {\n      ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));\n      lon = this.long0;\n      if (rh <= EPSLN) {\n        Chi = this.X0;\n      }\n      else {\n        Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);\n        lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));\n      }\n      lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n\n  //trace(p.toString());\n  return p;\n\n}\n\nexport var names = [\"stere\", \"Stereographic_South_Pole\", \"Polar Stereographic (variant B)\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  ssfn_: ssfn_\n};\n","/*\n  references:\n    Formules et constantes pour le Calcul pour la\n    projection cylindrique conforme à axe oblique et pour la transformation entre\n    des systèmes de référence.\n    http://www.swisstopo.admin.ch/internet/swisstopo/fr/home/topics/survey/sys/refsys/switzerland.parsysrelated1.31216.downloadList.77004.DownloadFile.tmp/swissprojectionfr.pdf\n  */\n\nexport function init() {\n  var phy0 = this.lat0;\n  this.lambda0 = this.long0;\n  var sinPhy0 = Math.sin(phy0);\n  var semiMajorAxis = this.a;\n  var invF = this.rf;\n  var flattening = 1 / invF;\n  var e2 = 2 * flattening - Math.pow(flattening, 2);\n  var e = this.e = Math.sqrt(e2);\n  this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));\n  this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));\n  this.b0 = Math.asin(sinPhy0 / this.alpha);\n  var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));\n  var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));\n  var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));\n  this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;\n}\n\nexport function forward(p) {\n  var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2));\n  var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));\n  var S = -this.alpha * (Sa1 + Sa2) + this.K;\n\n  // spheric latitude\n  var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);\n\n  // spheric longitude\n  var I = this.alpha * (p.x - this.lambda0);\n\n  // psoeudo equatorial rotation\n  var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I)));\n\n  var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));\n\n  p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;\n  p.x = this.R * rotI + this.x0;\n  return p;\n}\n\nexport function inverse(p) {\n  var Y = p.x - this.x0;\n  var X = p.y - this.y0;\n\n  var rotI = Y / this.R;\n  var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);\n\n  var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));\n  var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));\n\n  var lambda = this.lambda0 + I / this.alpha;\n\n  var S = 0;\n  var phy = b;\n  var prevPhy = -1000;\n  var iteration = 0;\n  while (Math.abs(phy - prevPhy) > 0.0000001) {\n    if (++iteration > 20) {\n      //...reportError(\"omercFwdInfinity\");\n      return;\n    }\n    //S = Math.log(Math.tan(Math.PI / 4 + phy / 2));\n    S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));\n    prevPhy = phy;\n    phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;\n  }\n\n  p.x = lambda;\n  p.y = phy;\n  return p;\n}\n\nexport var names = [\"somerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import tsfnz from '../common/tsfnz';\nimport adjust_lon from '../common/adjust_lon';\nimport phi2z from '../common/phi2z';\nimport {EPSLN, HALF_PI, FORTPI} from '../constants/values';\n\n/* Initialize the Oblique Mercator  projection\n    ------------------------------------------*/\nexport function init() {\n  this.no_off = this.no_off || false;\n  this.no_rot = this.no_rot || false;\n\n  if (isNaN(this.k0)) {\n    this.k0 = 1;\n  }\n  var sinlat = Math.sin(this.lat0);\n  var coslat = Math.cos(this.lat0);\n  var con = this.e * sinlat;\n\n  this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(coslat, 4));\n  this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - con * con);\n  var t0 = tsfnz(this.e, this.lat0, sinlat);\n  var dl = this.bl / coslat * Math.sqrt((1 - this.es) / (1 - con * con));\n  if (dl * dl < 1) {\n    dl = 1;\n  }\n  var fl;\n  var gl;\n  if (!isNaN(this.longc)) {\n    //Central point and azimuth method\n\n    if (this.lat0 >= 0) {\n      fl = dl + Math.sqrt(dl * dl - 1);\n    }\n    else {\n      fl = dl - Math.sqrt(dl * dl - 1);\n    }\n    this.el = fl * Math.pow(t0, this.bl);\n    gl = 0.5 * (fl - 1 / fl);\n    this.gamma0 = Math.asin(Math.sin(this.alpha) / dl);\n    this.long0 = this.longc - Math.asin(gl * Math.tan(this.gamma0)) / this.bl;\n\n  }\n  else {\n    //2 points method\n    var t1 = tsfnz(this.e, this.lat1, Math.sin(this.lat1));\n    var t2 = tsfnz(this.e, this.lat2, Math.sin(this.lat2));\n    if (this.lat0 >= 0) {\n      this.el = (dl + Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);\n    }\n    else {\n      this.el = (dl - Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);\n    }\n    var hl = Math.pow(t1, this.bl);\n    var ll = Math.pow(t2, this.bl);\n    fl = this.el / hl;\n    gl = 0.5 * (fl - 1 / fl);\n    var jl = (this.el * this.el - ll * hl) / (this.el * this.el + ll * hl);\n    var pl = (ll - hl) / (ll + hl);\n    var dlon12 = adjust_lon(this.long1 - this.long2);\n    this.long0 = 0.5 * (this.long1 + this.long2) - Math.atan(jl * Math.tan(0.5 * this.bl * (dlon12)) / pl) / this.bl;\n    this.long0 = adjust_lon(this.long0);\n    var dlon10 = adjust_lon(this.long1 - this.long0);\n    this.gamma0 = Math.atan(Math.sin(this.bl * (dlon10)) / gl);\n    this.alpha = Math.asin(dl * Math.sin(this.gamma0));\n  }\n\n  if (this.no_off) {\n    this.uc = 0;\n  }\n  else {\n    if (this.lat0 >= 0) {\n      this.uc = this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));\n    }\n    else {\n      this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));\n    }\n  }\n\n}\n\n/* Oblique Mercator forward equations--mapping lat,long to x,y\n    ----------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var dlon = adjust_lon(lon - this.long0);\n  var us, vs;\n  var con;\n  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    if (lat > 0) {\n      con = -1;\n    }\n    else {\n      con = 1;\n    }\n    vs = this.al / this.bl * Math.log(Math.tan(FORTPI + con * this.gamma0 * 0.5));\n    us = -1 * con * HALF_PI * this.al / this.bl;\n  }\n  else {\n    var t = tsfnz(this.e, lat, Math.sin(lat));\n    var ql = this.el / Math.pow(t, this.bl);\n    var sl = 0.5 * (ql - 1 / ql);\n    var tl = 0.5 * (ql + 1 / ql);\n    var vl = Math.sin(this.bl * (dlon));\n    var ul = (sl * Math.sin(this.gamma0) - vl * Math.cos(this.gamma0)) / tl;\n    if (Math.abs(Math.abs(ul) - 1) <= EPSLN) {\n      vs = Number.POSITIVE_INFINITY;\n    }\n    else {\n      vs = 0.5 * this.al * Math.log((1 - ul) / (1 + ul)) / this.bl;\n    }\n    if (Math.abs(Math.cos(this.bl * (dlon))) <= EPSLN) {\n      us = this.al * this.bl * (dlon);\n    }\n    else {\n      us = this.al * Math.atan2(sl * Math.cos(this.gamma0) + vl * Math.sin(this.gamma0), Math.cos(this.bl * dlon)) / this.bl;\n    }\n  }\n\n  if (this.no_rot) {\n    p.x = this.x0 + us;\n    p.y = this.y0 + vs;\n  }\n  else {\n\n    us -= this.uc;\n    p.x = this.x0 + vs * Math.cos(this.alpha) + us * Math.sin(this.alpha);\n    p.y = this.y0 + us * Math.cos(this.alpha) - vs * Math.sin(this.alpha);\n  }\n  return p;\n}\n\nexport function inverse(p) {\n  var us, vs;\n  if (this.no_rot) {\n    vs = p.y - this.y0;\n    us = p.x - this.x0;\n  }\n  else {\n    vs = (p.x - this.x0) * Math.cos(this.alpha) - (p.y - this.y0) * Math.sin(this.alpha);\n    us = (p.y - this.y0) * Math.cos(this.alpha) + (p.x - this.x0) * Math.sin(this.alpha);\n    us += this.uc;\n  }\n  var qp = Math.exp(-1 * this.bl * vs / this.al);\n  var sp = 0.5 * (qp - 1 / qp);\n  var tp = 0.5 * (qp + 1 / qp);\n  var vp = Math.sin(this.bl * us / this.al);\n  var up = (vp * Math.cos(this.gamma0) + sp * Math.sin(this.gamma0)) / tp;\n  var ts = Math.pow(this.el / Math.sqrt((1 + up) / (1 - up)), 1 / this.bl);\n  if (Math.abs(up - 1) < EPSLN) {\n    p.x = this.long0;\n    p.y = HALF_PI;\n  }\n  else if (Math.abs(up + 1) < EPSLN) {\n    p.x = this.long0;\n    p.y = -1 * HALF_PI;\n  }\n  else {\n    p.y = phi2z(this.e, ts);\n    p.x = adjust_lon(this.long0 - Math.atan2(sp * Math.cos(this.gamma0) - vp * Math.sin(this.gamma0), Math.cos(this.bl * us / this.al)) / this.bl);\n  }\n  return p;\n}\n\nexport var names = [\"Hotine_Oblique_Mercator\", \"Hotine Oblique Mercator\", \"Hotine_Oblique_Mercator_Azimuth_Natural_Origin\", \"Hotine_Oblique_Mercator_Azimuth_Center\", \"omerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import msfnz from '../common/msfnz';\nimport tsfnz from '../common/tsfnz';\nimport sign from '../common/sign';\nimport adjust_lon from '../common/adjust_lon';\nimport phi2z from '../common/phi2z';\nimport {HALF_PI, EPSLN} from '../constants/values';\nexport function init() {\n\n  // array of:  r_maj,r_min,lat1,lat2,c_lon,c_lat,false_east,false_north\n  //double c_lat;                   /* center latitude                      */\n  //double c_lon;                   /* center longitude                     */\n  //double lat1;                    /* first standard parallel              */\n  //double lat2;                    /* second standard parallel             */\n  //double r_maj;                   /* major axis                           */\n  //double r_min;                   /* minor axis                           */\n  //double false_east;              /* x offset in meters                   */\n  //double false_north;             /* y offset in meters                   */\n\n  if (!this.lat2) {\n    this.lat2 = this.lat1;\n  } //if lat2 is not defined\n  if (!this.k0) {\n    this.k0 = 1;\n  }\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  // Standard Parallels cannot be equal and on opposite sides of the equator\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n\n  var temp = this.b / this.a;\n  this.e = Math.sqrt(1 - temp * temp);\n\n  var sin1 = Math.sin(this.lat1);\n  var cos1 = Math.cos(this.lat1);\n  var ms1 = msfnz(this.e, sin1, cos1);\n  var ts1 = tsfnz(this.e, this.lat1, sin1);\n\n  var sin2 = Math.sin(this.lat2);\n  var cos2 = Math.cos(this.lat2);\n  var ms2 = msfnz(this.e, sin2, cos2);\n  var ts2 = tsfnz(this.e, this.lat2, sin2);\n\n  var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));\n\n  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n    this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);\n  }\n  else {\n    this.ns = sin1;\n  }\n  if (isNaN(this.ns)) {\n    this.ns = sin1;\n  }\n  this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));\n  this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);\n  if (!this.title) {\n    this.title = \"Lambert Conformal Conic\";\n  }\n}\n\n// Lambert Conformal conic forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  // singular cases :\n  if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {\n    lat = sign(lat) * (HALF_PI - 2 * EPSLN);\n  }\n\n  var con = Math.abs(Math.abs(lat) - HALF_PI);\n  var ts, rh1;\n  if (con > EPSLN) {\n    ts = tsfnz(this.e, lat, Math.sin(lat));\n    rh1 = this.a * this.f0 * Math.pow(ts, this.ns);\n  }\n  else {\n    con = lat * this.ns;\n    if (con <= 0) {\n      return null;\n    }\n    rh1 = 0;\n  }\n  var theta = this.ns * adjust_lon(lon - this.long0);\n  p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;\n  p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;\n\n  return p;\n}\n\n// Lambert Conformal Conic inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n\n  var rh1, con, ts;\n  var lat, lon;\n  var x = (p.x - this.x0) / this.k0;\n  var y = (this.rh - (p.y - this.y0) / this.k0);\n  if (this.ns > 0) {\n    rh1 = Math.sqrt(x * x + y * y);\n    con = 1;\n  }\n  else {\n    rh1 = -Math.sqrt(x * x + y * y);\n    con = -1;\n  }\n  var theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2((con * x), (con * y));\n  }\n  if ((rh1 !== 0) || (this.ns > 0)) {\n    con = 1 / this.ns;\n    ts = Math.pow((rh1 / (this.a * this.f0)), con);\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  }\n  else {\n    lat = -HALF_PI;\n  }\n  lon = adjust_lon(theta / this.ns + this.long0);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Lambert Tangential Conformal Conic Projection\", \"Lambert_Conformal_Conic\", \"Lambert_Conformal_Conic_2SP\", \"lcc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  this.a = 6377397.155;\n  this.es = 0.006674372230614;\n  this.e = Math.sqrt(this.es);\n  if (!this.lat0) {\n    this.lat0 = 0.863937979737193;\n  }\n  if (!this.long0) {\n    this.long0 = 0.7417649320975901 - 0.308341501185665;\n  }\n  /* if scale not set default to 0.9999 */\n  if (!this.k0) {\n    this.k0 = 0.9999;\n  }\n  this.s45 = 0.785398163397448; /* 45 */\n  this.s90 = 2 * this.s45;\n  this.fi0 = this.lat0;\n  this.e2 = this.es;\n  this.e = Math.sqrt(this.e2);\n  this.alfa = Math.sqrt(1 + (this.e2 * Math.pow(Math.cos(this.fi0), 4)) / (1 - this.e2));\n  this.uq = 1.04216856380474;\n  this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);\n  this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);\n  this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;\n  this.k1 = this.k0;\n  this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));\n  this.s0 = 1.37008346281555;\n  this.n = Math.sin(this.s0);\n  this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);\n  this.ad = this.s90 - this.uq;\n}\n\n/* ellipsoid */\n/* calculate xy from lat/lon */\n/* Constants, identical to inverse transform function */\nexport function forward(p) {\n  var gfi, u, deltav, s, d, eps, ro;\n  var lon = p.x;\n  var lat = p.y;\n  var delta_lon = adjust_lon(lon - this.long0);\n  /* Transformation */\n  gfi = Math.pow(((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat))), (this.alfa * this.e / 2));\n  u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);\n  deltav = -delta_lon * this.alfa;\n  s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));\n  d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));\n  eps = this.n * d;\n  ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);\n  p.y = ro * Math.cos(eps) / 1;\n  p.x = ro * Math.sin(eps) / 1;\n\n  if (!this.czech) {\n    p.y *= -1;\n    p.x *= -1;\n  }\n  return (p);\n}\n\n/* calculate lat/lon from xy */\nexport function inverse(p) {\n  var u, deltav, s, d, eps, ro, fi1;\n  var ok;\n\n  /* Transformation */\n  /* revert y, x*/\n  var tmp = p.x;\n  p.x = p.y;\n  p.y = tmp;\n  if (!this.czech) {\n    p.y *= -1;\n    p.x *= -1;\n  }\n  ro = Math.sqrt(p.x * p.x + p.y * p.y);\n  eps = Math.atan2(p.y, p.x);\n  d = eps / Math.sin(this.s0);\n  s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);\n  u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));\n  deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));\n  p.x = this.long0 - deltav / this.alfa;\n  fi1 = u;\n  ok = 0;\n  var iter = 0;\n  do {\n    p.y = 2 * (Math.atan(Math.pow(this.k, - 1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);\n    if (Math.abs(fi1 - p.y) < 0.0000000001) {\n      ok = 1;\n    }\n    fi1 = p.y;\n    iter += 1;\n  } while (ok === 0 && iter < 15);\n  if (iter >= 15) {\n    return null;\n  }\n\n  return (p);\n}\n\nexport var names = [\"Krovak\", \"krovak\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(e0, e1, e2, e3, phi) {\n  return (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi));\n}","export default function(x) {\n  return (1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x)));\n}","export default function(x) {\n  return (0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x)));\n}","export default function(x) {\n  return (0.05859375 * x * x * (1 + 0.75 * x));\n}","export default function(x) {\n  return (x * x * x * (35 / 3072));\n}","export default function(a, e, sinphi) {\n  var temp = e * sinphi;\n  return a / Math.sqrt(1 - temp * temp);\n}","import {HALF_PI} from '../constants/values';\nimport sign from './sign';\n\nexport default function(x) {\n  return (Math.abs(x) < HALF_PI) ? x : (x - (sign(x) * Math.PI));\n}\n","export default function(ml, e0, e1, e2, e3) {\n  var phi;\n  var dphi;\n\n  phi = ml / e0;\n  for (var i = 0; i < 15; i++) {\n    dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n\n  //..reportError(\"IMLFN-CONV:Latitude failed to converge after 15 iterations\");\n  return NaN;\n}","import mlfn from '../common/mlfn';\nimport e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport gN from '../common/gN';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport imlfn from '../common/imlfn';\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nexport function init() {\n  if (!this.sphere) {\n    this.e0 = e0fn(this.es);\n    this.e1 = e1fn(this.es);\n    this.e2 = e2fn(this.es);\n    this.e3 = e3fn(this.es);\n    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n  }\n}\n\n/* Cassini forward equations--mapping lat,long to x,y\n  -----------------------------------------------------------------------*/\nexport function forward(p) {\n\n  /* Forward equations\n      -----------------*/\n  var x, y;\n  var lam = p.x;\n  var phi = p.y;\n  lam = adjust_lon(lam - this.long0);\n\n  if (this.sphere) {\n    x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));\n    y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);\n  }\n  else {\n    //ellipsoid\n    var sinphi = Math.sin(phi);\n    var cosphi = Math.cos(phi);\n    var nl = gN(this.a, this.e, sinphi);\n    var tl = Math.tan(phi) * Math.tan(phi);\n    var al = lam * Math.cos(phi);\n    var asq = al * al;\n    var cl = this.es * cosphi * cosphi / (1 - this.es);\n    var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n\n    x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));\n    y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);\n\n\n  }\n\n  p.x = x + this.x0;\n  p.y = y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var x = p.x / this.a;\n  var y = p.y / this.a;\n  var phi, lam;\n\n  if (this.sphere) {\n    var dd = y + this.lat0;\n    phi = Math.asin(Math.sin(dd) * Math.cos(x));\n    lam = Math.atan2(Math.tan(x), Math.cos(dd));\n  }\n  else {\n    /* ellipsoid */\n    var ml1 = this.ml0 / this.a + y;\n    var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);\n    if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {\n      p.x = this.long0;\n      p.y = HALF_PI;\n      if (y < 0) {\n        p.y *= -1;\n      }\n      return p;\n    }\n    var nl1 = gN(this.a, this.e, Math.sin(phi1));\n\n    var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);\n    var tl1 = Math.pow(Math.tan(phi1), 2);\n    var dl = x * this.a / nl1;\n    var dsq = dl * dl;\n    phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);\n    lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);\n\n  }\n\n  p.x = adjust_lon(lam + this.long0);\n  p.y = adjust_lat(phi);\n  return p;\n\n}\n\nexport var names = [\"Cassini\", \"Cassini_Soldner\", \"cass\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(eccent, sinphi) {\n  var con;\n  if (eccent > 1.0e-7) {\n    con = eccent * sinphi;\n    return ((1 - eccent * eccent) * (sinphi / (1 - con * con) - (0.5 / eccent) * Math.log((1 - con) / (1 + con))));\n  }\n  else {\n    return (2 * sinphi);\n  }\n}","\nimport {HALF_PI, EPSLN, FORTPI} from '../constants/values';\n\nimport qsfnz from '../common/qsfnz';\nimport adjust_lon from '../common/adjust_lon';\n\n/*\n  reference\n    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n  */\n\nexport var S_POLE = 1;\n\nexport var N_POLE = 2;\nexport var EQUIT = 3;\nexport var OBLIQ = 4;\n\n/* Initialize the Lambert Azimuthal Equal Area projection\n  ------------------------------------------------------*/\nexport function init() {\n  var t = Math.abs(this.lat0);\n  if (Math.abs(t - HALF_PI) < EPSLN) {\n    this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE;\n  }\n  else if (Math.abs(t) < EPSLN) {\n    this.mode = this.EQUIT;\n  }\n  else {\n    this.mode = this.OBLIQ;\n  }\n  if (this.es > 0) {\n    var sinphi;\n\n    this.qp = qsfnz(this.e, 1);\n    this.mmf = 0.5 / (1 - this.es);\n    this.apa = authset(this.es);\n    switch (this.mode) {\n    case this.N_POLE:\n      this.dd = 1;\n      break;\n    case this.S_POLE:\n      this.dd = 1;\n      break;\n    case this.EQUIT:\n      this.rq = Math.sqrt(0.5 * this.qp);\n      this.dd = 1 / this.rq;\n      this.xmf = 1;\n      this.ymf = 0.5 * this.qp;\n      break;\n    case this.OBLIQ:\n      this.rq = Math.sqrt(0.5 * this.qp);\n      sinphi = Math.sin(this.lat0);\n      this.sinb1 = qsfnz(this.e, sinphi) / this.qp;\n      this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);\n      this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);\n      this.ymf = (this.xmf = this.rq) / this.dd;\n      this.xmf *= this.dd;\n      break;\n    }\n  }\n  else {\n    if (this.mode === this.OBLIQ) {\n      this.sinph0 = Math.sin(this.lat0);\n      this.cosph0 = Math.cos(this.lat0);\n    }\n  }\n}\n\n/* Lambert Azimuthal Equal Area forward equations--mapping lat,long to x,y\n  -----------------------------------------------------------------------*/\nexport function forward(p) {\n\n  /* Forward equations\n      -----------------*/\n  var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;\n  var lam = p.x;\n  var phi = p.y;\n\n  lam = adjust_lon(lam - this.long0);\n  if (this.sphere) {\n    sinphi = Math.sin(phi);\n    cosphi = Math.cos(phi);\n    coslam = Math.cos(lam);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      y = (this.mode === this.EQUIT) ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;\n      if (y <= EPSLN) {\n        return null;\n      }\n      y = Math.sqrt(2 / y);\n      x = y * cosphi * Math.sin(lam);\n      y *= (this.mode === this.EQUIT) ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;\n    }\n    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n      if (this.mode === this.N_POLE) {\n        coslam = -coslam;\n      }\n      if (Math.abs(phi + this.phi0) < EPSLN) {\n        return null;\n      }\n      y = FORTPI - phi * 0.5;\n      y = 2 * ((this.mode === this.S_POLE) ? Math.cos(y) : Math.sin(y));\n      x = y * Math.sin(lam);\n      y *= coslam;\n    }\n  }\n  else {\n    sinb = 0;\n    cosb = 0;\n    b = 0;\n    coslam = Math.cos(lam);\n    sinlam = Math.sin(lam);\n    sinphi = Math.sin(phi);\n    q = qsfnz(this.e, sinphi);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      sinb = q / this.qp;\n      cosb = Math.sqrt(1 - sinb * sinb);\n    }\n    switch (this.mode) {\n    case this.OBLIQ:\n      b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;\n      break;\n    case this.EQUIT:\n      b = 1 + cosb * coslam;\n      break;\n    case this.N_POLE:\n      b = HALF_PI + phi;\n      q = this.qp - q;\n      break;\n    case this.S_POLE:\n      b = phi - HALF_PI;\n      q = this.qp + q;\n      break;\n    }\n    if (Math.abs(b) < EPSLN) {\n      return null;\n    }\n    switch (this.mode) {\n    case this.OBLIQ:\n    case this.EQUIT:\n      b = Math.sqrt(2 / b);\n      if (this.mode === this.OBLIQ) {\n        y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);\n      }\n      else {\n        y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;\n      }\n      x = this.xmf * b * cosb * sinlam;\n      break;\n    case this.N_POLE:\n    case this.S_POLE:\n      if (q >= 0) {\n        x = (b = Math.sqrt(q)) * sinlam;\n        y = coslam * ((this.mode === this.S_POLE) ? b : -b);\n      }\n      else {\n        x = y = 0;\n      }\n      break;\n    }\n  }\n\n  p.x = this.a * x + this.x0;\n  p.y = this.a * y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var x = p.x / this.a;\n  var y = p.y / this.a;\n  var lam, phi, cCe, sCe, q, rho, ab;\n  if (this.sphere) {\n    var cosz = 0,\n      rh, sinz = 0;\n\n    rh = Math.sqrt(x * x + y * y);\n    phi = rh * 0.5;\n    if (phi > 1) {\n      return null;\n    }\n    phi = 2 * Math.asin(phi);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      sinz = Math.sin(phi);\n      cosz = Math.cos(phi);\n    }\n    switch (this.mode) {\n    case this.EQUIT:\n      phi = (Math.abs(rh) <= EPSLN) ? 0 : Math.asin(y * sinz / rh);\n      x *= sinz;\n      y = cosz * rh;\n      break;\n    case this.OBLIQ:\n      phi = (Math.abs(rh) <= EPSLN) ? this.phi0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);\n      x *= sinz * this.cosph0;\n      y = (cosz - Math.sin(phi) * this.sinph0) * rh;\n      break;\n    case this.N_POLE:\n      y = -y;\n      phi = HALF_PI - phi;\n      break;\n    case this.S_POLE:\n      phi -= HALF_PI;\n      break;\n    }\n    lam = (y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ)) ? 0 : Math.atan2(x, y);\n  }\n  else {\n    ab = 0;\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      x /= this.dd;\n      y *= this.dd;\n      rho = Math.sqrt(x * x + y * y);\n      if (rho < EPSLN) {\n        p.x = 0;\n        p.y = this.phi0;\n        return p;\n      }\n      sCe = 2 * Math.asin(0.5 * rho / this.rq);\n      cCe = Math.cos(sCe);\n      x *= (sCe = Math.sin(sCe));\n      if (this.mode === this.OBLIQ) {\n        ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho;\n        q = this.qp * ab;\n        y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;\n      }\n      else {\n        ab = y * sCe / rho;\n        q = this.qp * ab;\n        y = rho * cCe;\n      }\n    }\n    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n      if (this.mode === this.N_POLE) {\n        y = -y;\n      }\n      q = (x * x + y * y);\n      if (!q) {\n        p.x = 0;\n        p.y = this.phi0;\n        return p;\n      }\n      ab = 1 - q / this.qp;\n      if (this.mode === this.S_POLE) {\n        ab = -ab;\n      }\n    }\n    lam = Math.atan2(x, y);\n    phi = authlat(Math.asin(ab), this.apa);\n  }\n\n  p.x = adjust_lon(this.long0 + lam);\n  p.y = phi;\n  return p;\n}\n\n/* determine latitude from authalic latitude */\nvar P00 = 0.33333333333333333333;\n\nvar P01 = 0.17222222222222222222;\nvar P02 = 0.10257936507936507936;\nvar P10 = 0.06388888888888888888;\nvar P11 = 0.06640211640211640211;\nvar P20 = 0.01641501294219154443;\n\nfunction authset(es) {\n  var t;\n  var APA = [];\n  APA[0] = es * P00;\n  t = es * es;\n  APA[0] += t * P01;\n  APA[1] = t * P10;\n  t *= es;\n  APA[0] += t * P02;\n  APA[1] += t * P11;\n  APA[2] = t * P20;\n  return APA;\n}\n\nfunction authlat(beta, APA) {\n  var t = beta + beta;\n  return (beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t));\n}\n\nexport var names = [\"Lambert Azimuthal Equal Area\", \"Lambert_Azimuthal_Equal_Area\", \"laea\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  S_POLE: S_POLE,\n  N_POLE: N_POLE,\n  EQUIT: EQUIT,\n  OBLIQ: OBLIQ\n};\n","export default function(x) {\n  if (Math.abs(x) > 1) {\n    x = (x > 1) ? 1 : -1;\n  }\n  return Math.asin(x);\n}","import msfnz from '../common/msfnz';\nimport qsfnz from '../common/qsfnz';\nimport adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport {EPSLN} from '../constants/values';\n\nexport function init() {\n\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2);\n  this.e3 = Math.sqrt(this.es);\n\n  this.sin_po = Math.sin(this.lat1);\n  this.cos_po = Math.cos(this.lat1);\n  this.t1 = this.sin_po;\n  this.con = this.sin_po;\n  this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);\n  this.qs1 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n  this.sin_po = Math.sin(this.lat2);\n  this.cos_po = Math.cos(this.lat2);\n  this.t2 = this.sin_po;\n  this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);\n  this.qs2 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n  this.sin_po = Math.sin(this.lat0);\n  this.cos_po = Math.cos(this.lat0);\n  this.t3 = this.sin_po;\n  this.qs0 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n    this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);\n  }\n  else {\n    this.ns0 = this.con;\n  }\n  this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;\n  this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;\n}\n\n/* Albers Conical Equal Area forward equations--mapping lat,long to x,y\n  -------------------------------------------------------------------*/\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  this.sin_phi = Math.sin(lat);\n  this.cos_phi = Math.cos(lat);\n\n  var qs = qsfnz(this.e3, this.sin_phi, this.cos_phi);\n  var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;\n  var theta = this.ns0 * adjust_lon(lon - this.long0);\n  var x = rh1 * Math.sin(theta) + this.x0;\n  var y = this.rh - rh1 * Math.cos(theta) + this.y0;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh1, qs, con, theta, lon, lat;\n\n  p.x -= this.x0;\n  p.y = this.rh - p.y + this.y0;\n  if (this.ns0 >= 0) {\n    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n    con = 1;\n  }\n  else {\n    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n    con = -1;\n  }\n  theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2(con * p.x, con * p.y);\n  }\n  con = rh1 * this.ns0 / this.a;\n  if (this.sphere) {\n    lat = Math.asin((this.c - con * con) / (2 * this.ns0));\n  }\n  else {\n    qs = (this.c - con * con) / this.ns0;\n    lat = this.phi1z(this.e3, qs);\n  }\n\n  lon = adjust_lon(theta / this.ns0 + this.long0);\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\n/* Function to compute phi1, the latitude for the inverse of the\n   Albers Conical Equal-Area projection.\n-------------------------------------------*/\nexport function phi1z(eccent, qs) {\n  var sinphi, cosphi, con, com, dphi;\n  var phi = asinz(0.5 * qs);\n  if (eccent < EPSLN) {\n    return phi;\n  }\n\n  var eccnts = eccent * eccent;\n  for (var i = 1; i <= 25; i++) {\n    sinphi = Math.sin(phi);\n    cosphi = Math.cos(phi);\n    con = eccent * sinphi;\n    com = 1 - con * con;\n    dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n    phi = phi + dphi;\n    if (Math.abs(dphi) <= 1e-7) {\n      return phi;\n    }\n  }\n  return null;\n}\n\nexport var names = [\"Albers_Conic_Equal_Area\", \"Albers\", \"aea\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  phi1z: phi1z\n};\n","import adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport {EPSLN} from '../constants/values';\n\n/*\n  reference:\n    Wolfram Mathworld \"Gnomonic Projection\"\n    http://mathworld.wolfram.com/GnomonicProjection.html\n    Accessed: 12th November 2009\n  */\nexport function init() {\n\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  this.sin_p14 = Math.sin(this.lat0);\n  this.cos_p14 = Math.cos(this.lat0);\n  // Approximation for projecting points to the horizon (infinity)\n  this.infinity_dist = 1000 * this.a;\n  this.rc = 1;\n}\n\n/* Gnomonic forward equations--mapping lat,long to x,y\n    ---------------------------------------------------*/\nexport function forward(p) {\n  var sinphi, cosphi; /* sin and cos value        */\n  var dlon; /* delta longitude value      */\n  var coslon; /* cos of longitude        */\n  var ksp; /* scale factor          */\n  var g;\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      -----------------*/\n  dlon = adjust_lon(lon - this.long0);\n\n  sinphi = Math.sin(lat);\n  cosphi = Math.cos(lat);\n\n  coslon = Math.cos(dlon);\n  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n  ksp = 1;\n  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n    x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;\n    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;\n  }\n  else {\n\n    // Point is in the opposing hemisphere and is unprojectable\n    // We still need to return a reasonable point, so we project\n    // to infinity, on a bearing\n    // equivalent to the northern hemisphere equivalent\n    // This is a reasonable approximation for short shapes and lines that\n    // straddle the horizon.\n\n    x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);\n    y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh; /* Rho */\n  var sinc, cosc;\n  var c;\n  var lon, lat;\n\n  /* Inverse equations\n      -----------------*/\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  p.x /= this.k0;\n  p.y /= this.k0;\n\n  if ((rh = Math.sqrt(p.x * p.x + p.y * p.y))) {\n    c = Math.atan2(rh, this.rc);\n    sinc = Math.sin(c);\n    cosc = Math.cos(c);\n\n    lat = asinz(cosc * this.sin_p14 + (p.y * sinc * this.cos_p14) / rh);\n    lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);\n    lon = adjust_lon(this.long0 + lon);\n  }\n  else {\n    lat = this.phic0;\n    lon = 0;\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"gnom\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, q) {\n  var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));\n  if (Math.abs(Math.abs(q) - temp) < 1.0E-6) {\n    if (q < 0) {\n      return (-1 * HALF_PI);\n    }\n    else {\n      return HALF_PI;\n    }\n  }\n  //var phi = 0.5* q/(1-eccent*eccent);\n  var phi = Math.asin(0.5 * q);\n  var dphi;\n  var sin_phi;\n  var cos_phi;\n  var con;\n  for (var i = 0; i < 30; i++) {\n    sin_phi = Math.sin(phi);\n    cos_phi = Math.cos(phi);\n    con = eccent * sin_phi;\n    dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n\n  //console.log(\"IQSFN-CONV:Latitude failed to converge after 30 iterations\");\n  return NaN;\n}\n","import adjust_lon from '../common/adjust_lon';\nimport qsfnz from '../common/qsfnz';\nimport msfnz from '../common/msfnz';\nimport iqsfnz from '../common/iqsfnz';\n\n/*\n  reference:\n    \"Cartographic Projection Procedures for the UNIX Environment-\n    A User's Manual\" by Gerald I. Evenden,\n    USGS Open File Report 90-284and Release 4 Interim Reports (2003)\n*/\nexport function init() {\n  //no-op\n  if (!this.sphere) {\n    this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n  }\n}\n\n/* Cylindrical Equal Area forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var x, y;\n  /* Forward equations\n      -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  if (this.sphere) {\n    x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);\n    y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);\n  }\n  else {\n    var qs = qsfnz(this.e, Math.sin(lat));\n    x = this.x0 + this.a * this.k0 * dlon;\n    y = this.y0 + this.a * qs * 0.5 / this.k0;\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Cylindrical Equal Area inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lon = adjust_lon(this.long0 + (p.x / this.a) / Math.cos(this.lat_ts));\n    lat = Math.asin((p.y / this.a) * Math.cos(this.lat_ts));\n  }\n  else {\n    lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a);\n    lon = adjust_lon(this.long0 + p.x / (this.a * this.k0));\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"cea\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\n\nexport function init() {\n\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n  this.lat_ts = this.lat_ts || 0;\n  this.title = this.title || \"Equidistant Cylindrical (Plate Carre)\";\n\n  this.rc = Math.cos(this.lat_ts);\n}\n\n// forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  var dlon = adjust_lon(lon - this.long0);\n  var dlat = adjust_lat(lat - this.lat0);\n  p.x = this.x0 + (this.a * dlon * this.rc);\n  p.y = this.y0 + (this.a * dlat);\n  return p;\n}\n\n// inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n\n  var x = p.x;\n  var y = p.y;\n\n  p.x = adjust_lon(this.long0 + ((x - this.x0) / (this.a * this.rc)));\n  p.y = adjust_lat(this.lat0 + ((y - this.y0) / (this.a)));\n  return p;\n}\n\nexport var names = [\"Equirectangular\", \"Equidistant_Cylindrical\", \"eqc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport mlfn from '../common/mlfn';\nimport {EPSLN} from '../constants/values';\n\nimport gN from '../common/gN';\nvar MAX_ITER = 20;\n\nexport function init() {\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2); // devait etre dans tmerc.js mais n y est pas donc je commente sinon retour de valeurs nulles\n  this.e = Math.sqrt(this.es);\n  this.e0 = e0fn(this.es);\n  this.e1 = e1fn(this.es);\n  this.e2 = e2fn(this.es);\n  this.e3 = e3fn(this.es);\n  this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0); //si que des zeros le calcul ne se fait pas\n}\n\n/* Polyconic forward equations--mapping lat,long to x,y\n    ---------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var x, y, el;\n  var dlon = adjust_lon(lon - this.long0);\n  el = dlon * Math.sin(lat);\n  if (this.sphere) {\n    if (Math.abs(lat) <= EPSLN) {\n      x = this.a * dlon;\n      y = -1 * this.a * this.lat0;\n    }\n    else {\n      x = this.a * Math.sin(el) / Math.tan(lat);\n      y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));\n    }\n  }\n  else {\n    if (Math.abs(lat) <= EPSLN) {\n      x = this.a * dlon;\n      y = -1 * this.ml0;\n    }\n    else {\n      var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);\n      x = nl * Math.sin(el);\n      y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));\n    }\n\n  }\n  p.x = x + this.x0;\n  p.y = y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  var lon, lat, x, y, i;\n  var al, bl;\n  var phi, dphi;\n  x = p.x - this.x0;\n  y = p.y - this.y0;\n\n  if (this.sphere) {\n    if (Math.abs(y + this.a * this.lat0) <= EPSLN) {\n      lon = adjust_lon(x / this.a + this.long0);\n      lat = 0;\n    }\n    else {\n      al = this.lat0 + y / this.a;\n      bl = x * x / this.a / this.a + al * al;\n      phi = al;\n      var tanphi;\n      for (i = MAX_ITER; i; --i) {\n        tanphi = Math.tan(phi);\n        dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);\n        phi += dphi;\n        if (Math.abs(dphi) <= EPSLN) {\n          lat = phi;\n          break;\n        }\n      }\n      lon = adjust_lon(this.long0 + (Math.asin(x * Math.tan(phi) / this.a)) / Math.sin(lat));\n    }\n  }\n  else {\n    if (Math.abs(y + this.ml0) <= EPSLN) {\n      lat = 0;\n      lon = adjust_lon(this.long0 + x / this.a);\n    }\n    else {\n\n      al = (this.ml0 + y) / this.a;\n      bl = x * x / this.a / this.a + al * al;\n      phi = al;\n      var cl, mln, mlnp, ma;\n      var con;\n      for (i = MAX_ITER; i; --i) {\n        con = this.e * Math.sin(phi);\n        cl = Math.sqrt(1 - con * con) * Math.tan(phi);\n        mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n        mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);\n        ma = mln / this.a;\n        dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);\n        phi -= dphi;\n        if (Math.abs(dphi) <= EPSLN) {\n          lat = phi;\n          break;\n        }\n      }\n\n      //lat=phi4z(this.e,this.e0,this.e1,this.e2,this.e3,al,bl,0,0);\n      cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);\n      lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Polyconic\", \"poly\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {SEC_TO_RAD} from '../constants/values';\n\n/*\n  reference\n    Department of Land and Survey Technical Circular 1973/32\n      http://www.linz.govt.nz/docs/miscellaneous/nz-map-definition.pdf\n    OSG Technical Report 4.1\n      http://www.linz.govt.nz/docs/miscellaneous/nzmg.pdf\n  */\n\n/**\n * iterations: Number of iterations to refine inverse transform.\n *     0 -> km accuracy\n *     1 -> m accuracy -- suitable for most mapping applications\n *     2 -> mm accuracy\n */\nexport var iterations = 1;\n\nexport function init() {\n  this.A = [];\n  this.A[1] = 0.6399175073;\n  this.A[2] = -0.1358797613;\n  this.A[3] = 0.063294409;\n  this.A[4] = -0.02526853;\n  this.A[5] = 0.0117879;\n  this.A[6] = -0.0055161;\n  this.A[7] = 0.0026906;\n  this.A[8] = -0.001333;\n  this.A[9] = 0.00067;\n  this.A[10] = -0.00034;\n\n  this.B_re = [];\n  this.B_im = [];\n  this.B_re[1] = 0.7557853228;\n  this.B_im[1] = 0;\n  this.B_re[2] = 0.249204646;\n  this.B_im[2] = 0.003371507;\n  this.B_re[3] = -0.001541739;\n  this.B_im[3] = 0.041058560;\n  this.B_re[4] = -0.10162907;\n  this.B_im[4] = 0.01727609;\n  this.B_re[5] = -0.26623489;\n  this.B_im[5] = -0.36249218;\n  this.B_re[6] = -0.6870983;\n  this.B_im[6] = -1.1651967;\n\n  this.C_re = [];\n  this.C_im = [];\n  this.C_re[1] = 1.3231270439;\n  this.C_im[1] = 0;\n  this.C_re[2] = -0.577245789;\n  this.C_im[2] = -0.007809598;\n  this.C_re[3] = 0.508307513;\n  this.C_im[3] = -0.112208952;\n  this.C_re[4] = -0.15094762;\n  this.C_im[4] = 0.18200602;\n  this.C_re[5] = 1.01418179;\n  this.C_im[5] = 1.64497696;\n  this.C_re[6] = 1.9660549;\n  this.C_im[6] = 2.5127645;\n\n  this.D = [];\n  this.D[1] = 1.5627014243;\n  this.D[2] = 0.5185406398;\n  this.D[3] = -0.03333098;\n  this.D[4] = -0.1052906;\n  this.D[5] = -0.0368594;\n  this.D[6] = 0.007317;\n  this.D[7] = 0.01220;\n  this.D[8] = 0.00394;\n  this.D[9] = -0.0013;\n}\n\n/**\n    New Zealand Map Grid Forward  - long/lat to x/y\n    long/lat in radians\n  */\nexport function forward(p) {\n  var n;\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lat = lat - this.lat0;\n  var delta_lon = lon - this.long0;\n\n  // 1. Calculate d_phi and d_psi    ...                          // and d_lambda\n  // For this algorithm, delta_latitude is in seconds of arc x 10-5, so we need to scale to those units. Longitude is radians.\n  var d_phi = delta_lat / SEC_TO_RAD * 1E-5;\n  var d_lambda = delta_lon;\n  var d_phi_n = 1; // d_phi^0\n\n  var d_psi = 0;\n  for (n = 1; n <= 10; n++) {\n    d_phi_n = d_phi_n * d_phi;\n    d_psi = d_psi + this.A[n] * d_phi_n;\n  }\n\n  // 2. Calculate theta\n  var th_re = d_psi;\n  var th_im = d_lambda;\n\n  // 3. Calculate z\n  var th_n_re = 1;\n  var th_n_im = 0; // theta^0\n  var th_n_re1;\n  var th_n_im1;\n\n  var z_re = 0;\n  var z_im = 0;\n  for (n = 1; n <= 6; n++) {\n    th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n    th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n    th_n_re = th_n_re1;\n    th_n_im = th_n_im1;\n    z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;\n    z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;\n  }\n\n  // 4. Calculate easting and northing\n  p.x = (z_im * this.a) + this.x0;\n  p.y = (z_re * this.a) + this.y0;\n\n  return p;\n}\n\n/**\n    New Zealand Map Grid Inverse  -  x/y to long/lat\n  */\nexport function inverse(p) {\n  var n;\n  var x = p.x;\n  var y = p.y;\n\n  var delta_x = x - this.x0;\n  var delta_y = y - this.y0;\n\n  // 1. Calculate z\n  var z_re = delta_y / this.a;\n  var z_im = delta_x / this.a;\n\n  // 2a. Calculate theta - first approximation gives km accuracy\n  var z_n_re = 1;\n  var z_n_im = 0; // z^0\n  var z_n_re1;\n  var z_n_im1;\n\n  var th_re = 0;\n  var th_im = 0;\n  for (n = 1; n <= 6; n++) {\n    z_n_re1 = z_n_re * z_re - z_n_im * z_im;\n    z_n_im1 = z_n_im * z_re + z_n_re * z_im;\n    z_n_re = z_n_re1;\n    z_n_im = z_n_im1;\n    th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;\n    th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;\n  }\n\n  // 2b. Iterate to refine the accuracy of the calculation\n  //        0 iterations gives km accuracy\n  //        1 iteration gives m accuracy -- good enough for most mapping applications\n  //        2 iterations bives mm accuracy\n  for (var i = 0; i < this.iterations; i++) {\n    var th_n_re = th_re;\n    var th_n_im = th_im;\n    var th_n_re1;\n    var th_n_im1;\n\n    var num_re = z_re;\n    var num_im = z_im;\n    for (n = 2; n <= 6; n++) {\n      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n      th_n_re = th_n_re1;\n      th_n_im = th_n_im1;\n      num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n      num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n    }\n\n    th_n_re = 1;\n    th_n_im = 0;\n    var den_re = this.B_re[1];\n    var den_im = this.B_im[1];\n    for (n = 2; n <= 6; n++) {\n      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n      th_n_re = th_n_re1;\n      th_n_im = th_n_im1;\n      den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n      den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n    }\n\n    // Complex division\n    var den2 = den_re * den_re + den_im * den_im;\n    th_re = (num_re * den_re + num_im * den_im) / den2;\n    th_im = (num_im * den_re - num_re * den_im) / den2;\n  }\n\n  // 3. Calculate d_phi              ...                                    // and d_lambda\n  var d_psi = th_re;\n  var d_lambda = th_im;\n  var d_psi_n = 1; // d_psi^0\n\n  var d_phi = 0;\n  for (n = 1; n <= 9; n++) {\n    d_psi_n = d_psi_n * d_psi;\n    d_phi = d_phi + this.D[n] * d_psi_n;\n  }\n\n  // 4. Calculate latitude and longitude\n  // d_phi is calcuated in second of arc * 10^-5, so we need to scale back to radians. d_lambda is in radians.\n  var lat = this.lat0 + (d_phi * SEC_TO_RAD * 1E5);\n  var lon = this.long0 + d_lambda;\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = [\"New_Zealand_Map_Grid\", \"nzmg\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\n/*\n  reference\n    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n  */\n\n\n/* Initialize the Miller Cylindrical projection\n  -------------------------------------------*/\nexport function init() {\n  //no-op\n}\n\n/* Miller Cylindrical forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  var x = this.x0 + this.a * dlon;\n  var y = this.y0 + this.a * Math.log(Math.tan((Math.PI / 4) + (lat / 2.5))) * 1.25;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Miller Cylindrical inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n\n  var lon = adjust_lon(this.long0 + p.x / this.a);\n  var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Miller_Cylindrical\", \"mill\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport pj_enfn from '../common/pj_enfn';\nvar MAX_ITER = 20;\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport {EPSLN, HALF_PI} from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n\nexport function init() {\n  /* Place parameters in static storage for common use\n    -------------------------------------------------*/\n\n\n  if (!this.sphere) {\n    this.en = pj_enfn(this.es);\n  }\n  else {\n    this.n = 1;\n    this.m = 0;\n    this.es = 0;\n    this.C_y = Math.sqrt((this.m + 1) / this.n);\n    this.C_x = this.C_y / (this.m + 1);\n  }\n\n}\n\n/* Sinusoidal forward equations--mapping lat,long to x,y\n  -----------------------------------------------------*/\nexport function forward(p) {\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n    -----------------*/\n  lon = adjust_lon(lon - this.long0);\n\n  if (this.sphere) {\n    if (!this.m) {\n      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;\n    }\n    else {\n      var k = this.n * Math.sin(lat);\n      for (var i = MAX_ITER; i; --i) {\n        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));\n        lat -= V;\n        if (Math.abs(V) < EPSLN) {\n          break;\n        }\n      }\n    }\n    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));\n    y = this.a * this.C_y * lat;\n\n  }\n  else {\n\n    var s = Math.sin(lat);\n    var c = Math.cos(lat);\n    y = this.a * pj_mlfn(lat, s, c, this.en);\n    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var lat, temp, lon, s;\n\n  p.x -= this.x0;\n  lon = p.x / this.a;\n  p.y -= this.y0;\n  lat = p.y / this.a;\n\n  if (this.sphere) {\n    lat /= this.C_y;\n    lon = lon / (this.C_x * (this.m + Math.cos(lat)));\n    if (this.m) {\n      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);\n    }\n    else if (this.n !== 1) {\n      lat = asinz(Math.sin(lat) / this.n);\n    }\n    lon = adjust_lon(lon + this.long0);\n    lat = adjust_lat(lat);\n  }\n  else {\n    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);\n    s = Math.abs(lat);\n    if (s < HALF_PI) {\n      s = Math.sin(lat);\n      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));\n      //temp = this.long0 + p.x / (this.a * Math.cos(lat));\n      lon = adjust_lon(temp);\n    }\n    else if ((s - EPSLN) < HALF_PI) {\n      lon = this.long0;\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Sinusoidal\", \"sinu\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nexport function init() {}\nimport {EPSLN} from '../constants/values';\n/* Mollweide forward equations--mapping lat,long to x,y\n    ----------------------------------------------------*/\nexport function forward(p) {\n\n  /* Forward equations\n      -----------------*/\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lon = adjust_lon(lon - this.long0);\n  var theta = lat;\n  var con = Math.PI * Math.sin(lat);\n\n  /* Iterate using the Newton-Raphson method to find theta\n      -----------------------------------------------------*/\n  while (true) {\n    var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));\n    theta += delta_theta;\n    if (Math.abs(delta_theta) < EPSLN) {\n      break;\n    }\n  }\n  theta /= 2;\n\n  /* If the latitude is 90 deg, force the x coordinate to be \"0 + false easting\"\n       this is done here because of precision problems with \"cos(theta)\"\n       --------------------------------------------------------------------------*/\n  if (Math.PI / 2 - Math.abs(lat) < EPSLN) {\n    delta_lon = 0;\n  }\n  var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;\n  var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var theta;\n  var arg;\n\n  /* Inverse equations\n      -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  arg = p.y / (1.4142135623731 * this.a);\n\n  /* Because of division by zero problems, 'arg' can not be 1.  Therefore\n       a number very close to one is used instead.\n       -------------------------------------------------------------------*/\n  if (Math.abs(arg) > 0.999999999999) {\n    arg = 0.999999999999;\n  }\n  theta = Math.asin(arg);\n  var lon = adjust_lon(this.long0 + (p.x / (0.900316316158 * this.a * Math.cos(theta))));\n  if (lon < (-Math.PI)) {\n    lon = -Math.PI;\n  }\n  if (lon > Math.PI) {\n    lon = Math.PI;\n  }\n  arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;\n  if (Math.abs(arg) > 1) {\n    arg = 1;\n  }\n  var lat = Math.asin(arg);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Mollweide\", \"moll\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport msfnz from '../common/msfnz';\nimport mlfn from '../common/mlfn';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport imlfn from '../common/imlfn';\nimport {EPSLN} from '../constants/values';\n\nexport function init() {\n\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  // Standard Parallels cannot be equal and on opposite sides of the equator\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n  this.lat2 = this.lat2 || this.lat1;\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2);\n  this.e = Math.sqrt(this.es);\n  this.e0 = e0fn(this.es);\n  this.e1 = e1fn(this.es);\n  this.e2 = e2fn(this.es);\n  this.e3 = e3fn(this.es);\n\n  this.sinphi = Math.sin(this.lat1);\n  this.cosphi = Math.cos(this.lat1);\n\n  this.ms1 = msfnz(this.e, this.sinphi, this.cosphi);\n  this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);\n\n  if (Math.abs(this.lat1 - this.lat2) < EPSLN) {\n    this.ns = this.sinphi;\n  }\n  else {\n    this.sinphi = Math.sin(this.lat2);\n    this.cosphi = Math.cos(this.lat2);\n    this.ms2 = msfnz(this.e, this.sinphi, this.cosphi);\n    this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);\n    this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);\n  }\n  this.g = this.ml1 + this.ms1 / this.ns;\n  this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n  this.rh = this.a * (this.g - this.ml0);\n}\n\n/* Equidistant Conic forward equations--mapping lat,long to x,y\n  -----------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var rh1;\n\n  /* Forward equations\n      -----------------*/\n  if (this.sphere) {\n    rh1 = this.a * (this.g - lat);\n  }\n  else {\n    var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);\n    rh1 = this.a * (this.g - ml);\n  }\n  var theta = this.ns * adjust_lon(lon - this.long0);\n  var x = this.x0 + rh1 * Math.sin(theta);\n  var y = this.y0 + this.rh - rh1 * Math.cos(theta);\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y = this.rh - p.y + this.y0;\n  var con, rh1, lat, lon;\n  if (this.ns >= 0) {\n    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n    con = 1;\n  }\n  else {\n    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n    con = -1;\n  }\n  var theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2(con * p.x, con * p.y);\n  }\n\n  if (this.sphere) {\n    lon = adjust_lon(this.long0 + theta / this.ns);\n    lat = adjust_lat(this.g - rh1 / this.a);\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  else {\n    var ml = this.g - rh1 / this.a;\n    lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);\n    lon = adjust_lon(this.long0 + theta / this.ns);\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n\n}\n\nexport var names = [\"Equidistant_Conic\", \"eqdc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n/* Initialize the Van Der Grinten projection\n  ----------------------------------------*/\nexport function init() {\n  //this.R = 6370997; //Radius of earth\n  this.R = this.a;\n}\n\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  /* Forward equations\n    -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  var x, y;\n\n  if (Math.abs(lat) <= EPSLN) {\n    x = this.x0 + this.R * dlon;\n    y = this.y0;\n  }\n  var theta = asinz(2 * Math.abs(lat / Math.PI));\n  if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {\n    x = this.x0;\n    if (lat >= 0) {\n      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);\n    }\n    else {\n      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);\n    }\n    //  return(OK);\n  }\n  var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI));\n  var asq = al * al;\n  var sinth = Math.sin(theta);\n  var costh = Math.cos(theta);\n\n  var g = costh / (sinth + costh - 1);\n  var gsq = g * g;\n  var m = g * (2 / sinth - 1);\n  var msq = m * m;\n  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);\n  if (dlon < 0) {\n    con = -con;\n  }\n  x = this.x0 + con;\n  //con = Math.abs(con / (Math.PI * this.R));\n  var q = asq + g;\n  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);\n  if (lat >= 0) {\n    //y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 + con;\n  }\n  else {\n    //y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 - con;\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Van Der Grinten inverse equations--mapping x,y to lat/long\n  ---------------------------------------------------------*/\nexport function inverse(p) {\n  var lon, lat;\n  var xx, yy, xys, c1, c2, c3;\n  var a1;\n  var m1;\n  var con;\n  var th1;\n  var d;\n\n  /* inverse equations\n    -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  con = Math.PI * this.R;\n  xx = p.x / con;\n  yy = p.y / con;\n  xys = xx * xx + yy * yy;\n  c1 = -Math.abs(yy) * (1 + xys);\n  c2 = c1 - 2 * yy * yy + xx * xx;\n  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;\n  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;\n  a1 = (c1 - c2 * c2 / 3 / c3) / c3;\n  m1 = 2 * Math.sqrt(-a1 / 3);\n  con = ((3 * d) / a1) / m1;\n  if (Math.abs(con) > 1) {\n    if (con >= 0) {\n      con = 1;\n    }\n    else {\n      con = -1;\n    }\n  }\n  th1 = Math.acos(con) / 3;\n  if (p.y >= 0) {\n    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n  else {\n    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n\n  if (Math.abs(xx) < EPSLN) {\n    lon = this.long0;\n  }\n  else {\n    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Van_der_Grinten_I\", \"VanDerGrinten\", \"vandg\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nimport mlfn from '../common/mlfn';\nimport e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport gN from '../common/gN';\nimport asinz from '../common/asinz';\nimport imlfn from '../common/imlfn';\n\n\n\nexport function init() {\n  this.sin_p12 = Math.sin(this.lat0);\n  this.cos_p12 = Math.cos(this.lat0);\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var sinphi = Math.sin(p.y);\n  var cosphi = Math.cos(p.y);\n  var dlon = adjust_lon(lon - this.long0);\n  var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c, kp, cos_c, s, s2, s3, s4, s5;\n  if (this.sphere) {\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      //North Pole case\n      p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);\n      p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);\n      return p;\n    }\n    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      //South Pole case\n      p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);\n      p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);\n      return p;\n    }\n    else {\n      //default case\n      cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);\n      c = Math.acos(cos_c);\n      kp = c / Math.sin(c);\n      p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);\n      p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));\n      return p;\n    }\n  }\n  else {\n    e0 = e0fn(this.es);\n    e1 = e1fn(this.es);\n    e2 = e2fn(this.es);\n    e3 = e3fn(this.es);\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      //North Pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n      p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);\n      p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);\n      return p;\n    }\n    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      //South Pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n      p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);\n      p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);\n      return p;\n    }\n    else {\n      //Default case\n      tanphi = sinphi / cosphi;\n      Nl1 = gN(this.a, this.e, this.sin_p12);\n      Nl = gN(this.a, this.e, sinphi);\n      psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));\n      Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon));\n      if (Az === 0) {\n        s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));\n      }\n      else if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {\n        s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));\n      }\n      else {\n        s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az));\n      }\n      G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);\n      H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es);\n      GH = G * H;\n      Hs = H * H;\n      s2 = s * s;\n      s3 = s2 * s;\n      s4 = s3 * s;\n      s5 = s4 * s;\n      c = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH);\n      p.x = this.x0 + c * Math.sin(Az);\n      p.y = this.y0 + c * Math.cos(Az);\n      return p;\n    }\n  }\n\n\n}\n\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A, B, D, Ee, F;\n  if (this.sphere) {\n    rh = Math.sqrt(p.x * p.x + p.y * p.y);\n    if (rh > (2 * HALF_PI * this.a)) {\n      return;\n    }\n    z = rh / this.a;\n\n    sinz = Math.sin(z);\n    cosz = Math.cos(z);\n\n    lon = this.long0;\n    if (Math.abs(rh) <= EPSLN) {\n      lat = this.lat0;\n    }\n    else {\n      lat = asinz(cosz * this.sin_p12 + (p.y * sinz * this.cos_p12) / rh);\n      con = Math.abs(this.lat0) - HALF_PI;\n      if (Math.abs(con) <= EPSLN) {\n        if (this.lat0 >= 0) {\n          lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));\n        }\n        else {\n          lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n        }\n      }\n      else {\n        /*con = cosz - this.sin_p12 * Math.sin(lat);\n        if ((Math.abs(con) < EPSLN) && (Math.abs(p.x) < EPSLN)) {\n          //no-op, just keep the lon value as is\n        } else {\n          var temp = Math.atan2((p.x * sinz * this.cos_p12), (con * rh));\n          lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz * this.cos_p12), (con * rh)));\n        }*/\n        lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));\n      }\n    }\n\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  else {\n    e0 = e0fn(this.es);\n    e1 = e1fn(this.es);\n    e2 = e2fn(this.es);\n    e3 = e3fn(this.es);\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      //North pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      M = Mlp - rh;\n      lat = imlfn(M / this.a, e0, e1, e2, e3);\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      //South pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      M = rh - Mlp;\n\n      lat = imlfn(M / this.a, e0, e1, e2, e3);\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    else {\n      //default case\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      Az = Math.atan2(p.x, p.y);\n      N1 = gN(this.a, this.e, this.sin_p12);\n      cosAz = Math.cos(Az);\n      tmp = this.e * this.cos_p12 * cosAz;\n      A = -tmp * tmp / (1 - this.es);\n      B = 3 * this.es * (1 - A) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);\n      D = rh / N1;\n      Ee = D - A * (1 + A) * Math.pow(D, 3) / 6 - B * (1 + 3 * A) * Math.pow(D, 4) / 24;\n      F = 1 - A * Ee * Ee / 2 - D * Ee * Ee * Ee / 6;\n      psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);\n      lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi)));\n      lat = Math.atan((1 - this.es * F * this.sin_p12 / Math.sin(psi)) * Math.tan(psi) / (1 - this.es));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n  }\n\n}\n\nexport var names = [\"Azimuthal_Equidistant\", \"aeqd\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport {EPSLN, HALF_PI} from '../constants/values';\n\nexport function init() {\n  //double temp;      /* temporary variable    */\n\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  this.sin_p14 = Math.sin(this.lat0);\n  this.cos_p14 = Math.cos(this.lat0);\n}\n\n/* Orthographic forward equations--mapping lat,long to x,y\n    ---------------------------------------------------*/\nexport function forward(p) {\n  var sinphi, cosphi; /* sin and cos value        */\n  var dlon; /* delta longitude value      */\n  var coslon; /* cos of longitude        */\n  var ksp; /* scale factor          */\n  var g, x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      -----------------*/\n  dlon = adjust_lon(lon - this.long0);\n\n  sinphi = Math.sin(lat);\n  cosphi = Math.cos(lat);\n\n  coslon = Math.cos(dlon);\n  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n  ksp = 1;\n  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n    x = this.a * ksp * cosphi * Math.sin(dlon);\n    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh; /* height above ellipsoid      */\n  var z; /* angle          */\n  var sinz, cosz; /* sin of z and cos of z      */\n  var con;\n  var lon, lat;\n  /* Inverse equations\n      -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  rh = Math.sqrt(p.x * p.x + p.y * p.y);\n  z = asinz(rh / this.a);\n\n  sinz = Math.sin(z);\n  cosz = Math.cos(z);\n\n  lon = this.long0;\n  if (Math.abs(rh) <= EPSLN) {\n    lat = this.lat0;\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  lat = asinz(cosz * this.sin_p14 + (p.y * sinz * this.cos_p14) / rh);\n  con = Math.abs(this.lat0) - HALF_PI;\n  if (Math.abs(con) <= EPSLN) {\n    if (this.lat0 >= 0) {\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));\n    }\n    else {\n      lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n    }\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz), rh * this.cos_p14 * cosz - p.y * this.sin_p14 * sinz));\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"ortho\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","// QSC projection rewritten from the original PROJ4\n// https://github.com/OSGeo/proj.4/blob/master/src/PJ_qsc.c\n\nimport {EPSLN, TWO_PI, SPI, HALF_PI, FORTPI} from '../constants/values';\n\n/* constants */\nvar FACE_ENUM = {\n    FRONT: 1,\n    RIGHT: 2,\n    BACK: 3,\n    LEFT: 4,\n    TOP: 5,\n    BOTTOM: 6\n};\n\nvar AREA_ENUM = {\n    AREA_0: 1,\n    AREA_1: 2,\n    AREA_2: 3,\n    AREA_3: 4\n};\n\nexport function init() {\n\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n  this.lat_ts = this.lat_ts || 0;\n  this.title = this.title || \"Quadrilateralized Spherical Cube\";\n\n  /* Determine the cube face from the center of projection. */\n  if (this.lat0 >= HALF_PI - FORTPI / 2.0) {\n    this.face = FACE_ENUM.TOP;\n  } else if (this.lat0 <= -(HALF_PI - FORTPI / 2.0)) {\n    this.face = FACE_ENUM.BOTTOM;\n  } else if (Math.abs(this.long0) <= FORTPI) {\n    this.face = FACE_ENUM.FRONT;\n  } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {\n    this.face = this.long0 > 0.0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;\n  } else {\n    this.face = FACE_ENUM.BACK;\n  }\n\n  /* Fill in useful values for the ellipsoid <-> sphere shift\n   * described in [LK12]. */\n  if (this.es !== 0) {\n    this.one_minus_f = 1 - (this.a - this.b) / this.a;\n    this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;\n  }\n}\n\n// QSC forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n  var xy = {x: 0, y: 0};\n  var lat, lon;\n  var theta, phi;\n  var t, mu;\n  /* nu; */\n  var area = {value: 0};\n\n  // move lon according to projection's lon\n  p.x -= this.long0;\n\n  /* Convert the geodetic latitude to a geocentric latitude.\n   * This corresponds to the shift from the ellipsoid to the sphere\n   * described in [LK12]. */\n  if (this.es !== 0) {//if (P->es != 0) {\n    lat = Math.atan(this.one_minus_f_squared * Math.tan(p.y));\n  } else {\n    lat = p.y;\n  }\n\n  /* Convert the input lat, lon into theta, phi as used by QSC.\n   * This depends on the cube face and the area on it.\n   * For the top and bottom face, we can compute theta and phi\n   * directly from phi, lam. For the other faces, we must use\n   * unit sphere cartesian coordinates as an intermediate step. */\n  lon = p.x; //lon = lp.lam;\n  if (this.face === FACE_ENUM.TOP) {\n    phi = HALF_PI - lat;\n    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n      theta = lon - HALF_PI;\n    } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_1;\n      theta = (lon > 0.0 ? lon - SPI : lon + SPI);\n    } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = lon + HALF_PI;\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta = lon;\n    }\n  } else if (this.face === FACE_ENUM.BOTTOM) {\n    phi = HALF_PI + lat;\n    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n      theta = -lon + HALF_PI;\n    } else if (lon < FORTPI && lon >= -FORTPI) {\n      area.value = AREA_ENUM.AREA_1;\n      theta = -lon;\n    } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = -lon - HALF_PI;\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta = (lon > 0.0 ? -lon + SPI : -lon - SPI);\n    }\n  } else {\n    var q, r, s;\n    var sinlat, coslat;\n    var sinlon, coslon;\n\n    if (this.face === FACE_ENUM.RIGHT) {\n      lon = qsc_shift_lon_origin(lon, +HALF_PI);\n    } else if (this.face === FACE_ENUM.BACK) {\n      lon = qsc_shift_lon_origin(lon, +SPI);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      lon = qsc_shift_lon_origin(lon, -HALF_PI);\n    }\n    sinlat = Math.sin(lat);\n    coslat = Math.cos(lat);\n    sinlon = Math.sin(lon);\n    coslon = Math.cos(lon);\n    q = coslat * coslon;\n    r = coslat * sinlon;\n    s = sinlat;\n\n    if (this.face === FACE_ENUM.FRONT) {\n      phi = Math.acos(q);\n      theta = qsc_fwd_equat_face_theta(phi, s, r, area);\n    } else if (this.face === FACE_ENUM.RIGHT) {\n      phi = Math.acos(r);\n      theta = qsc_fwd_equat_face_theta(phi, s, -q, area);\n    } else if (this.face === FACE_ENUM.BACK) {\n      phi = Math.acos(-q);\n      theta = qsc_fwd_equat_face_theta(phi, s, -r, area);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      phi = Math.acos(-r);\n      theta = qsc_fwd_equat_face_theta(phi, s, q, area);\n    } else {\n      /* Impossible */\n      phi = theta = 0;\n      area.value = AREA_ENUM.AREA_0;\n    }\n  }\n\n  /* Compute mu and nu for the area of definition.\n   * For mu, see Eq. (3-21) in [OL76], but note the typos:\n   * compare with Eq. (3-14). For nu, see Eq. (3-38). */\n  mu = Math.atan((12 / SPI) * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));\n  t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));\n\n  /* Apply the result to the real area. */\n  if (area.value === AREA_ENUM.AREA_1) {\n    mu += HALF_PI;\n  } else if (area.value === AREA_ENUM.AREA_2) {\n    mu += SPI;\n  } else if (area.value === AREA_ENUM.AREA_3) {\n    mu += 1.5 * SPI;\n  }\n\n  /* Now compute x, y from mu and nu */\n  xy.x = t * Math.cos(mu);\n  xy.y = t * Math.sin(mu);\n  xy.x = xy.x * this.a + this.x0;\n  xy.y = xy.y * this.a + this.y0;\n\n  p.x = xy.x;\n  p.y = xy.y;\n  return p;\n}\n\n// QSC inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n  var lp = {lam: 0, phi: 0};\n  var mu, nu, cosmu, tannu;\n  var tantheta, theta, cosphi, phi;\n  var t;\n  var area = {value: 0};\n\n  /* de-offset */\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  /* Convert the input x, y to the mu and nu angles as used by QSC.\n   * This depends on the area of the cube face. */\n  nu = Math.atan(Math.sqrt(p.x * p.x + p.y * p.y));\n  mu = Math.atan2(p.y, p.x);\n  if (p.x >= 0.0 && p.x >= Math.abs(p.y)) {\n    area.value = AREA_ENUM.AREA_0;\n  } else if (p.y >= 0.0 && p.y >= Math.abs(p.x)) {\n    area.value = AREA_ENUM.AREA_1;\n    mu -= HALF_PI;\n  } else if (p.x < 0.0 && -p.x >= Math.abs(p.y)) {\n    area.value = AREA_ENUM.AREA_2;\n    mu = (mu < 0.0 ? mu + SPI : mu - SPI);\n  } else {\n    area.value = AREA_ENUM.AREA_3;\n    mu += HALF_PI;\n  }\n\n  /* Compute phi and theta for the area of definition.\n   * The inverse projection is not described in the original paper, but some\n   * good hints can be found here (as of 2011-12-14):\n   * http://fits.gsfc.nasa.gov/fitsbits/saf.93/saf.9302\n   * (search for \"Message-Id: <9302181759.AA25477 at fits.cv.nrao.edu>\") */\n  t = (SPI / 12) * Math.tan(mu);\n  tantheta = Math.sin(t) / (Math.cos(t) - (1 / Math.sqrt(2)));\n  theta = Math.atan(tantheta);\n  cosmu = Math.cos(mu);\n  tannu = Math.tan(nu);\n  cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));\n  if (cosphi < -1) {\n    cosphi = -1;\n  } else if (cosphi > +1) {\n    cosphi = +1;\n  }\n\n  /* Apply the result to the real area on the cube face.\n   * For the top and bottom face, we can compute phi and lam directly.\n   * For the other faces, we must use unit sphere cartesian coordinates\n   * as an intermediate step. */\n  if (this.face === FACE_ENUM.TOP) {\n    phi = Math.acos(cosphi);\n    lp.phi = HALF_PI - phi;\n    if (area.value === AREA_ENUM.AREA_0) {\n      lp.lam = theta + HALF_PI;\n    } else if (area.value === AREA_ENUM.AREA_1) {\n      lp.lam = (theta < 0.0 ? theta + SPI : theta - SPI);\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      lp.lam = theta - HALF_PI;\n    } else /* area.value == AREA_ENUM.AREA_3 */ {\n      lp.lam = theta;\n    }\n  } else if (this.face === FACE_ENUM.BOTTOM) {\n    phi = Math.acos(cosphi);\n    lp.phi = phi - HALF_PI;\n    if (area.value === AREA_ENUM.AREA_0) {\n      lp.lam = -theta + HALF_PI;\n    } else if (area.value === AREA_ENUM.AREA_1) {\n      lp.lam = -theta;\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      lp.lam = -theta - HALF_PI;\n    } else /* area.value == AREA_ENUM.AREA_3 */ {\n      lp.lam = (theta < 0.0 ? -theta - SPI : -theta + SPI);\n    }\n  } else {\n    /* Compute phi and lam via cartesian unit sphere coordinates. */\n    var q, r, s;\n    q = cosphi;\n    t = q * q;\n    if (t >= 1) {\n      s = 0;\n    } else {\n      s = Math.sqrt(1 - t) * Math.sin(theta);\n    }\n    t += s * s;\n    if (t >= 1) {\n      r = 0;\n    } else {\n      r = Math.sqrt(1 - t);\n    }\n    /* Rotate q,r,s into the correct area. */\n    if (area.value === AREA_ENUM.AREA_1) {\n      t = r;\n      r = -s;\n      s = t;\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      r = -r;\n      s = -s;\n    } else if (area.value === AREA_ENUM.AREA_3) {\n      t = r;\n      r = s;\n      s = -t;\n    }\n    /* Rotate q,r,s into the correct cube face. */\n    if (this.face === FACE_ENUM.RIGHT) {\n      t = q;\n      q = -r;\n      r = t;\n    } else if (this.face === FACE_ENUM.BACK) {\n      q = -q;\n      r = -r;\n    } else if (this.face === FACE_ENUM.LEFT) {\n      t = q;\n      q = r;\n      r = -t;\n    }\n    /* Now compute phi and lam from the unit sphere coordinates. */\n    lp.phi = Math.acos(-s) - HALF_PI;\n    lp.lam = Math.atan2(r, q);\n    if (this.face === FACE_ENUM.RIGHT) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);\n    } else if (this.face === FACE_ENUM.BACK) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);\n    }\n  }\n\n  /* Apply the shift from the sphere to the ellipsoid as described\n   * in [LK12]. */\n  if (this.es !== 0) {\n    var invert_sign;\n    var tanphi, xa;\n    invert_sign = (lp.phi < 0 ? 1 : 0);\n    tanphi = Math.tan(lp.phi);\n    xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);\n    lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));\n    if (invert_sign) {\n      lp.phi = -lp.phi;\n    }\n  }\n\n  lp.lam += this.long0;\n  p.x = lp.lam;\n  p.y = lp.phi;\n  return p;\n}\n\n/* Helper function for forward projection: compute the theta angle\n * and determine the area number. */\nfunction qsc_fwd_equat_face_theta(phi, y, x, area) {\n  var theta;\n  if (phi < EPSLN) {\n    area.value = AREA_ENUM.AREA_0;\n    theta = 0.0;\n  } else {\n    theta = Math.atan2(y, x);\n    if (Math.abs(theta) <= FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n    } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_1;\n      theta -= HALF_PI;\n    } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = (theta >= 0.0 ? theta - SPI : theta + SPI);\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta += HALF_PI;\n    }\n  }\n  return theta;\n}\n\n/* Helper function: shift the longitude. */\nfunction qsc_shift_lon_origin(lon, offset) {\n  var slon = lon + offset;\n  if (slon < -SPI) {\n    slon += TWO_PI;\n  } else if (slon > +SPI) {\n    slon -= TWO_PI;\n  }\n  return slon;\n}\n\nexport var names = [\"Quadrilateralized Spherical Cube\", \"Quadrilateralized_Spherical_Cube\", \"qsc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n\n","// Robinson projection\n// Based on https://github.com/OSGeo/proj.4/blob/master/src/PJ_robin.c\n// Polynomial coeficients from http://article.gmane.org/gmane.comp.gis.proj-4.devel/6039\n\nimport {HALF_PI, D2R, R2D, EPSLN} from '../constants/values';\nimport adjust_lon from '../common/adjust_lon';\n\nvar COEFS_X = [\n    [1.0000, 2.2199e-17, -7.15515e-05, 3.1103e-06],\n    [0.9986, -0.000482243, -2.4897e-05, -1.3309e-06],\n    [0.9954, -0.00083103, -4.48605e-05, -9.86701e-07],\n    [0.9900, -0.00135364, -5.9661e-05, 3.6777e-06],\n    [0.9822, -0.00167442, -4.49547e-06, -5.72411e-06],\n    [0.9730, -0.00214868, -9.03571e-05, 1.8736e-08],\n    [0.9600, -0.00305085, -9.00761e-05, 1.64917e-06],\n    [0.9427, -0.00382792, -6.53386e-05, -2.6154e-06],\n    [0.9216, -0.00467746, -0.00010457, 4.81243e-06],\n    [0.8962, -0.00536223, -3.23831e-05, -5.43432e-06],\n    [0.8679, -0.00609363, -0.000113898, 3.32484e-06],\n    [0.8350, -0.00698325, -6.40253e-05, 9.34959e-07],\n    [0.7986, -0.00755338, -5.00009e-05, 9.35324e-07],\n    [0.7597, -0.00798324, -3.5971e-05, -2.27626e-06],\n    [0.7186, -0.00851367, -7.01149e-05, -8.6303e-06],\n    [0.6732, -0.00986209, -0.000199569, 1.91974e-05],\n    [0.6213, -0.010418, 8.83923e-05, 6.24051e-06],\n    [0.5722, -0.00906601, 0.000182, 6.24051e-06],\n    [0.5322, -0.00677797, 0.000275608, 6.24051e-06]\n];\n\nvar COEFS_Y = [\n    [-5.20417e-18, 0.0124, 1.21431e-18, -8.45284e-11],\n    [0.0620, 0.0124, -1.26793e-09, 4.22642e-10],\n    [0.1240, 0.0124, 5.07171e-09, -1.60604e-09],\n    [0.1860, 0.0123999, -1.90189e-08, 6.00152e-09],\n    [0.2480, 0.0124002, 7.10039e-08, -2.24e-08],\n    [0.3100, 0.0123992, -2.64997e-07, 8.35986e-08],\n    [0.3720, 0.0124029, 9.88983e-07, -3.11994e-07],\n    [0.4340, 0.0123893, -3.69093e-06, -4.35621e-07],\n    [0.4958, 0.0123198, -1.02252e-05, -3.45523e-07],\n    [0.5571, 0.0121916, -1.54081e-05, -5.82288e-07],\n    [0.6176, 0.0119938, -2.41424e-05, -5.25327e-07],\n    [0.6769, 0.011713, -3.20223e-05, -5.16405e-07],\n    [0.7346, 0.0113541, -3.97684e-05, -6.09052e-07],\n    [0.7903, 0.0109107, -4.89042e-05, -1.04739e-06],\n    [0.8435, 0.0103431, -6.4615e-05, -1.40374e-09],\n    [0.8936, 0.00969686, -6.4636e-05, -8.547e-06],\n    [0.9394, 0.00840947, -0.000192841, -4.2106e-06],\n    [0.9761, 0.00616527, -0.000256, -4.2106e-06],\n    [1.0000, 0.00328947, -0.000319159, -4.2106e-06]\n];\n\nvar FXC = 0.8487;\nvar FYC = 1.3523;\nvar C1 = R2D/5; // rad to 5-degree interval\nvar RC1 = 1/C1;\nvar NODES = 18;\n\nvar poly3_val = function(coefs, x) {\n    return coefs[0] + x * (coefs[1] + x * (coefs[2] + x * coefs[3]));\n};\n\nvar poly3_der = function(coefs, x) {\n    return coefs[1] + x * (2 * coefs[2] + x * 3 * coefs[3]);\n};\n\nfunction newton_rapshon(f_df, start, max_err, iters) {\n    var x = start;\n    for (; iters; --iters) {\n        var upd = f_df(x);\n        x -= upd;\n        if (Math.abs(upd) < max_err) {\n            break;\n        }\n    }\n    return x;\n}\n\nexport function init() {\n    this.x0 = this.x0 || 0;\n    this.y0 = this.y0 || 0;\n    this.long0 = this.long0 || 0;\n    this.es = 0;\n    this.title = this.title || \"Robinson\";\n}\n\nexport function forward(ll) {\n    var lon = adjust_lon(ll.x - this.long0);\n\n    var dphi = Math.abs(ll.y);\n    var i = Math.floor(dphi * C1);\n    if (i < 0) {\n        i = 0;\n    } else if (i >= NODES) {\n        i = NODES - 1;\n    }\n    dphi = R2D * (dphi - RC1 * i);\n    var xy = {\n        x: poly3_val(COEFS_X[i], dphi) * lon,\n        y: poly3_val(COEFS_Y[i], dphi)\n    };\n    if (ll.y < 0) {\n        xy.y = -xy.y;\n    }\n\n    xy.x = xy.x * this.a * FXC + this.x0;\n    xy.y = xy.y * this.a * FYC + this.y0;\n    return xy;\n}\n\nexport function inverse(xy) {\n    var ll = {\n        x: (xy.x - this.x0) / (this.a * FXC),\n        y: Math.abs(xy.y - this.y0) / (this.a * FYC)\n    };\n\n    if (ll.y >= 1) { // pathologic case\n        ll.x /= COEFS_X[NODES][0];\n        ll.y = xy.y < 0 ? -HALF_PI : HALF_PI;\n    } else {\n        // find table interval\n        var i = Math.floor(ll.y * NODES);\n        if (i < 0) {\n            i = 0;\n        } else if (i >= NODES) {\n            i = NODES - 1;\n        }\n        for (;;) {\n            if (COEFS_Y[i][0] > ll.y) {\n                --i;\n            } else if (COEFS_Y[i+1][0] <= ll.y) {\n                ++i;\n            } else {\n                break;\n            }\n        }\n        // linear interpolation in 5 degree interval\n        var coefs = COEFS_Y[i];\n        var t = 5 * (ll.y - coefs[0]) / (COEFS_Y[i+1][0] - coefs[0]);\n        // find t so that poly3_val(coefs, t) = ll.y\n        t = newton_rapshon(function(x) {\n            return (poly3_val(coefs, x) - ll.y) / poly3_der(coefs, x);\n        }, t, EPSLN, 100);\n\n        ll.x /= poly3_val(COEFS_X[i], t);\n        ll.y = (5 * i + t) * D2R;\n        if (xy.y < 0) {\n            ll.y = -ll.y;\n        }\n    }\n\n    ll.x = adjust_lon(ll.x + this.long0);\n    return ll;\n}\n\nexport var names = [\"Robinson\", \"robin\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import tmerc from './lib/projections/tmerc';\nimport etmerc from './lib/projections/etmerc';\nimport utm from './lib/projections/utm';\nimport sterea from './lib/projections/sterea';\nimport stere from './lib/projections/stere';\nimport somerc from './lib/projections/somerc';\nimport omerc from './lib/projections/omerc';\nimport lcc from './lib/projections/lcc';\nimport krovak from './lib/projections/krovak';\nimport cass from './lib/projections/cass';\nimport laea from './lib/projections/laea';\nimport aea from './lib/projections/aea';\nimport gnom from './lib/projections/gnom';\nimport cea from './lib/projections/cea';\nimport eqc from './lib/projections/eqc';\nimport poly from './lib/projections/poly';\nimport nzmg from './lib/projections/nzmg';\nimport mill from './lib/projections/mill';\nimport sinu from './lib/projections/sinu';\nimport moll from './lib/projections/moll';\nimport eqdc from './lib/projections/eqdc';\nimport vandg from './lib/projections/vandg';\nimport aeqd from './lib/projections/aeqd';\nimport ortho from './lib/projections/ortho';\nimport qsc from './lib/projections/qsc';\nimport robin from './lib/projections/robin';\nexport default function(proj4){\n  proj4.Proj.projections.add(tmerc);\n  proj4.Proj.projections.add(etmerc);\n  proj4.Proj.projections.add(utm);\n  proj4.Proj.projections.add(sterea);\n  proj4.Proj.projections.add(stere);\n  proj4.Proj.projections.add(somerc);\n  proj4.Proj.projections.add(omerc);\n  proj4.Proj.projections.add(lcc);\n  proj4.Proj.projections.add(krovak);\n  proj4.Proj.projections.add(cass);\n  proj4.Proj.projections.add(laea);\n  proj4.Proj.projections.add(aea);\n  proj4.Proj.projections.add(gnom);\n  proj4.Proj.projections.add(cea);\n  proj4.Proj.projections.add(eqc);\n  proj4.Proj.projections.add(poly);\n  proj4.Proj.projections.add(nzmg);\n  proj4.Proj.projections.add(mill);\n  proj4.Proj.projections.add(sinu);\n  proj4.Proj.projections.add(moll);\n  proj4.Proj.projections.add(eqdc);\n  proj4.Proj.projections.add(vandg);\n  proj4.Proj.projections.add(aeqd);\n  proj4.Proj.projections.add(ortho);\n  proj4.Proj.projections.add(qsc);\n  proj4.Proj.projections.add(robin);\n}","import proj4 from './core';\nimport Proj from \"./Proj\";\nimport Point from \"./Point\";\nimport common from \"./common/toPoint\";\nimport defs from \"./defs\";\nimport transform from \"./transform\";\nimport mgrs from \"mgrs\";\nimport version from \"./version\";\nimport includedProjections from \"../projs\";\n\nproj4.defaultDatum = 'WGS84'; //default datum\nproj4.Proj = Proj;\nproj4.WGS84 = new proj4.Proj('WGS84');\nproj4.Point = Point;\nproj4.toPoint = common;\nproj4.defs = defs;\nproj4.transform = transform;\nproj4.mgrs = mgrs;\nproj4.version = version;\nincludedProjections(proj4);\nexport default proj4;\n","/**\n * @module ol/source/TileWMS\n */\n\nimport {DEFAULT_WMS_VERSION} from './common.js';\n\nimport {assert} from '../asserts.js';\nimport {buffer, createEmpty} from '../extent.js';\nimport {assign} from '../obj.js';\nimport {modulo} from '../math.js';\nimport {get as getProjection, transform, transformExtent} from '../proj.js';\nimport {calculateSourceResolution} from '../reproj.js';\nimport {toSize, buffer as bufferSize, scale as scaleSize} from '../size.js';\nimport TileImage from './TileImage.js';\nimport WMSServerType from './WMSServerType.js';\nimport {hash as tileCoordHash} from '../tilecoord.js';\nimport {compareVersions} from '../string.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {Object<string,*>} params WMS request parameters.\n * At least a `LAYERS` param is required. `STYLES` is\n * `''` by default. `VERSION` is `1.3.0` by default. `WIDTH`, `HEIGHT`, `BBOX`\n * and `CRS` (`SRS` for WMS version < 1.3.0) will be set dynamically.\n * @property {number} [gutter=0]\n * The size in pixels of the gutter around image tiles to ignore. By setting\n * this property to a non-zero value, images will be requested that are wider\n * and taller than the tile size by a value of `2 x gutter`.\n * Using a non-zero value allows artifacts of rendering at tile edges to be\n * ignored. If you control the WMS service it is recommended to address\n * \"artifacts at tile edges\" issues by properly configuring the WMS service. For\n * example, MapServer has a `tile_map_edge_buffer` configuration parameter for\n * this. See http://mapserver.org/output/tile_mode.html.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {typeof import(\"../ImageTile.js\").default} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid. Base this on the resolutions,\n * tilesize and extent supported by the server.\n * If this is not defined, a default grid will be used: if there is a projection\n * extent, the grid will be based on that; if not, a grid based on a global\n * extent with origin at 0,0 will be used..\n * @property {import(\"./WMSServerType.js\").default|string} [serverType]\n * The type of the remote WMS server. Currently only used when `hidpi` is\n * `true`.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {string} [url] WMS service URL.\n * @property {Array<string>} [urls] WMS service urls.\n * Use this instead of `url` when the WMS supports multiple urls for GetMap requests.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * When set to `false`, only one world\n * will be rendered. When `true`, tiles will be requested for one world only,\n * but they will be wrapped horizontally to render multiple worlds.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data from WMS servers.\n * @api\n */\nclass TileWMS extends TileImage {\n  /**\n   * @param {Options=} [opt_options] Tile WMS options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : /** @type {Options} */ ({});\n\n    const params = options.params || {};\n\n    const transparent = 'TRANSPARENT' in params ? params['TRANSPARENT'] : true;\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      opaque: !transparent,\n      projection: options.projection,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileClass: options.tileClass,\n      tileGrid: options.tileGrid,\n      tileLoadFunction: options.tileLoadFunction,\n      tileUrlFunction: tileUrlFunction,\n      url: options.url,\n      urls: options.urls,\n      wrapX: options.wrapX !== undefined ? options.wrapX : true,\n      transition: options.transition\n    });\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.gutter_ = options.gutter !== undefined ? options.gutter : 0;\n\n    /**\n     * @private\n     * @type {!Object}\n     */\n    this.params_ = params;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.v13_ = true;\n\n    /**\n     * @private\n     * @type {import(\"./WMSServerType.js\").default|undefined}\n     */\n    this.serverType_ = /** @type {import(\"./WMSServerType.js\").default|undefined} */ (options.serverType);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.tmpExtent_ = createEmpty();\n\n    this.updateV13_();\n    this.setKey(this.getKeyForParams_());\n\n  }\n\n  /**\n   * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n   * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n   * constructed.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {number} resolution Resolution.\n   * @param {import(\"../proj.js\").ProjectionLike} projection Projection.\n   * @param {!Object} params GetFeatureInfo params. `INFO_FORMAT` at least should\n   *     be provided. If `QUERY_LAYERS` is not provided then the layers specified\n   *     in the `LAYERS` parameter will be used. `VERSION` should not be\n   *     specified here.\n   * @return {string|undefined} GetFeatureInfo URL.\n   * @api\n   */\n  getFeatureInfoUrl(coordinate, resolution, projection, params) {\n    const projectionObj = getProjection(projection);\n    const sourceProjectionObj = this.getProjection();\n\n    let tileGrid = this.getTileGrid();\n    if (!tileGrid) {\n      tileGrid = this.getTileGridForProjection(projectionObj);\n    }\n\n    const z = tileGrid.getZForResolution(resolution, this.zDirection);\n    const tileCoord = tileGrid.getTileCoordForCoordAndZ(coordinate, z);\n\n    if (tileGrid.getResolutions().length <= tileCoord[0]) {\n      return undefined;\n    }\n\n    let tileResolution = tileGrid.getResolution(tileCoord[0]);\n    let tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n    let tileSize = toSize(tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n\n    const gutter = this.gutter_;\n    if (gutter !== 0) {\n      tileSize = bufferSize(tileSize, gutter, this.tmpSize);\n      tileExtent = buffer(tileExtent, tileResolution * gutter, tileExtent);\n    }\n\n    if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {\n      tileResolution = calculateSourceResolution(sourceProjectionObj, projectionObj, coordinate, tileResolution);\n      tileExtent = transformExtent(tileExtent, projectionObj, sourceProjectionObj);\n      coordinate = transform(coordinate, projectionObj, sourceProjectionObj);\n    }\n\n    const baseParams = {\n      'SERVICE': 'WMS',\n      'VERSION': DEFAULT_WMS_VERSION,\n      'REQUEST': 'GetFeatureInfo',\n      'FORMAT': 'image/png',\n      'TRANSPARENT': true,\n      'QUERY_LAYERS': this.params_['LAYERS']\n    };\n    assign(baseParams, this.params_, params);\n\n    const x = Math.floor((coordinate[0] - tileExtent[0]) / tileResolution);\n    const y = Math.floor((tileExtent[3] - coordinate[1]) / tileResolution);\n\n    baseParams[this.v13_ ? 'I' : 'X'] = x;\n    baseParams[this.v13_ ? 'J' : 'Y'] = y;\n\n    return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n      1, sourceProjectionObj || projectionObj, baseParams);\n  }\n\n  /**\n   * Return the GetLegendGraphic URL, optionally optimized for the passed\n   * resolution and possibly including any passed specific parameters. Returns\n   * `undefined` if the GetLegendGraphic URL cannot be constructed.\n   *\n   * @param {number} [resolution] Resolution. If set to undefined, `SCALE`\n   *     will not be calculated and included in URL.\n   * @param {Object} [params] GetLegendGraphic params. If `LAYER` is set, the\n   *     request is generated for this wms layer, else it will try to use the\n   *     configured wms layer. Default `FORMAT` is `image/png`.\n   *     `VERSION` should not be specified here.\n   * @return {string|undefined} GetLegendGraphic URL.\n   * @api\n   */\n  getLegendUrl(resolution, params) {\n    if (this.urls[0] === undefined) {\n      return undefined;\n    }\n\n    const baseParams = {\n      'SERVICE': 'WMS',\n      'VERSION': DEFAULT_WMS_VERSION,\n      'REQUEST': 'GetLegendGraphic',\n      'FORMAT': 'image/png'\n    };\n\n    if (params === undefined || params['LAYER'] === undefined) {\n      const layers = this.params_.LAYERS;\n      const isSingleLayer = !Array.isArray(layers) || layers.length === 1;\n      if (!isSingleLayer) {\n        return undefined;\n      }\n      baseParams['LAYER'] = layers;\n    }\n\n    if (resolution !== undefined) {\n      const mpu = this.getProjection() ? this.getProjection().getMetersPerUnit() : 1;\n      const dpi = 25.4 / 0.28;\n      const inchesPerMeter = 39.37;\n      baseParams['SCALE'] = resolution * mpu * inchesPerMeter * dpi;\n    }\n\n    assign(baseParams, params);\n\n    return appendParams(/** @type {string} */ (this.urls[0]), baseParams);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getGutter() {\n    return this.gutter_;\n  }\n\n  /**\n   * Get the user-provided params, i.e. those passed to the constructor through\n   * the \"params\" option, and possibly updated using the updateParams method.\n   * @return {Object} Params.\n   * @api\n   */\n  getParams() {\n    return this.params_;\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"../size.js\").Size} tileSize Tile size.\n   * @param {import(\"../extent.js\").Extent} tileExtent Tile extent.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {Object} params Params.\n   * @return {string|undefined} Request URL.\n   * @private\n   */\n  getRequestUrl_(tileCoord, tileSize, tileExtent, pixelRatio, projection, params) {\n\n    const urls = this.urls;\n    if (!urls) {\n      return undefined;\n    }\n\n    params['WIDTH'] = tileSize[0];\n    params['HEIGHT'] = tileSize[1];\n\n    params[this.v13_ ? 'CRS' : 'SRS'] = projection.getCode();\n\n    if (!('STYLES' in this.params_)) {\n      params['STYLES'] = '';\n    }\n\n    if (pixelRatio != 1) {\n      switch (this.serverType_) {\n        case WMSServerType.GEOSERVER:\n          const dpi = (90 * pixelRatio + 0.5) | 0;\n          if ('FORMAT_OPTIONS' in params) {\n            params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n          } else {\n            params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n          }\n          break;\n        case WMSServerType.MAPSERVER:\n          params['MAP_RESOLUTION'] = 90 * pixelRatio;\n          break;\n        case WMSServerType.CARMENTA_SERVER:\n        case WMSServerType.QGIS:\n          params['DPI'] = 90 * pixelRatio;\n          break;\n        default:\n          assert(false, 52); // Unknown `serverType` configured\n          break;\n      }\n    }\n\n    const axisOrientation = projection.getAxisOrientation();\n    const bbox = tileExtent;\n    if (this.v13_ && axisOrientation.substr(0, 2) == 'ne') {\n      let tmp;\n      tmp = tileExtent[0];\n      bbox[0] = tileExtent[1];\n      bbox[1] = tmp;\n      tmp = tileExtent[2];\n      bbox[2] = tileExtent[3];\n      bbox[3] = tmp;\n    }\n    params['BBOX'] = bbox.join(',');\n\n    let url;\n    if (urls.length == 1) {\n      url = urls[0];\n    } else {\n      const index = modulo(tileCoordHash(tileCoord), urls.length);\n      url = urls[index];\n    }\n    return appendParams(url, params);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTilePixelRatio(pixelRatio) {\n    return (!this.hidpi_ || this.serverType_ === undefined) ? 1 :\n    /** @type {number} */ (pixelRatio);\n  }\n\n  /**\n   * @private\n   * @return {string} The key for the current params.\n   */\n  getKeyForParams_() {\n    let i = 0;\n    const res = [];\n    for (const key in this.params_) {\n      res[i++] = key + '-' + this.params_[key];\n    }\n    return res.join('/');\n  }\n\n  /**\n   * Update the user-provided params.\n   * @param {Object} params Params.\n   * @api\n   */\n  updateParams(params) {\n    assign(this.params_, params);\n    this.updateV13_();\n    this.setKey(this.getKeyForParams_());\n  }\n\n  /**\n   * @private\n   */\n  updateV13_() {\n    const version = this.params_['VERSION'] || DEFAULT_WMS_VERSION;\n    this.v13_ = compareVersions(version, '1.3') >= 0;\n  }\n}\n\n/**\n * @param {import(\"../tilecoord.js\").TileCoord} tileCoord The tile coordinate\n * @param {number} pixelRatio The pixel ratio\n * @param {import(\"../proj/Projection.js\").default} projection The projection\n * @return {string|undefined} The tile URL\n * @this {TileWMS}\n */\nfunction tileUrlFunction(tileCoord, pixelRatio, projection) {\n\n  let tileGrid = this.getTileGrid();\n  if (!tileGrid) {\n    tileGrid = this.getTileGridForProjection(projection);\n  }\n\n  if (tileGrid.getResolutions().length <= tileCoord[0]) {\n    return undefined;\n  }\n\n  if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === undefined)) {\n    pixelRatio = 1;\n  }\n\n  const tileResolution = tileGrid.getResolution(tileCoord[0]);\n  let tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent_);\n  let tileSize = toSize(\n    tileGrid.getTileSize(tileCoord[0]), this.tmpSize);\n\n  const gutter = this.gutter_;\n  if (gutter !== 0) {\n    tileSize = bufferSize(tileSize, gutter, this.tmpSize);\n    tileExtent = buffer(tileExtent, tileResolution * gutter, tileExtent);\n  }\n\n  if (pixelRatio != 1) {\n    tileSize = scaleSize(tileSize, pixelRatio, this.tmpSize);\n  }\n\n  const baseParams = {\n    'SERVICE': 'WMS',\n    'VERSION': DEFAULT_WMS_VERSION,\n    'REQUEST': 'GetMap',\n    'FORMAT': 'image/png',\n    'TRANSPARENT': true\n  };\n  assign(baseParams, this.params_);\n\n  return this.getRequestUrl_(tileCoord, tileSize, tileExtent,\n    pixelRatio, projection, baseParams);\n}\n\n\nexport default TileWMS;\n","/**\n * @module ol/layer/BaseImage\n */\nimport Layer from './Layer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {import(\"../PluggableMap.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {import(\"../source/Image.js\").default} [source] Source for this layer.\n */\n\n\n/**\n * @classdesc\n * Server-rendered images that are available for arbitrary extents and\n * resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @extends {Layer<import(\"../source/Image.js\").default>}\n * @api\n */\nclass BaseImageLayer extends Layer {\n\n  /**\n   * @param {Options=} opt_options Layer options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n    super(options);\n  }\n\n}\n\nexport default BaseImageLayer;\n","/**\n * @module ol/layer/Image\n */\nimport BaseImageLayer from './BaseImage.js';\nimport CanvasImageLayerRenderer from '../renderer/canvas/ImageLayer.js';\n\n\n/**\n * @classdesc\n * Server-rendered images that are available for arbitrary extents and\n * resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @api\n */\nclass ImageLayer extends BaseImageLayer {\n\n  /**\n   * @param {import(\"./BaseImage.js\").Options=} opt_options Layer options.\n   */\n  constructor(opt_options) {\n    super(opt_options);\n  }\n\n  /**\n   * Create a renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n   * @protected\n   */\n  createRenderer() {\n    return new CanvasImageLayerRenderer(this);\n  }\n\n}\n\nexport default ImageLayer;\n","/**\n * @module ol/proj/Projection\n */\nimport {METERS_PER_UNIT} from './Units.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} code The SRS identifier code, e.g. `EPSG:4326`.\n * @property {import(\"./Units.js\").default|string} [units] Units. Required unless a\n * proj4 projection is defined for `code`.\n * @property {import(\"../extent.js\").Extent} [extent] The validity extent for the SRS.\n * @property {string} [axisOrientation='enu'] The axis orientation as specified in Proj4.\n * @property {boolean} [global=false] Whether the projection is valid for the whole globe.\n * @property {number} [metersPerUnit] The meters per unit for the SRS.\n * If not provided, the `units` are used to get the meters per unit from the {@link module:ol/proj/Units~METERS_PER_UNIT}\n * lookup table.\n * @property {import(\"../extent.js\").Extent} [worldExtent] The world extent for the SRS.\n * @property {function(number, import(\"../coordinate.js\").Coordinate):number} [getPointResolution]\n * Function to determine resolution at a point. The function is called with a\n * `{number}` view resolution and an `{import(\"../coordinate.js\").Coordinate}` as arguments, and returns\n * the `{number}` resolution in projection units at the passed coordinate. If this is `undefined`,\n * the default {@link module:ol/proj#getPointResolution} function will be used.\n */\n\n\n/**\n * @classdesc\n * Projection definition class. One of these is created for each projection\n * supported in the application and stored in the {@link module:ol/proj} namespace.\n * You can use these in applications, but this is not required, as API params\n * and options use {@link module:ol/proj~ProjectionLike} which means the simple string\n * code will suffice.\n *\n * You can use {@link module:ol/proj~get} to retrieve the object for a particular\n * projection.\n *\n * The library includes definitions for `EPSG:4326` and `EPSG:3857`, together\n * with the following aliases:\n * * `EPSG:4326`: CRS:84, urn:ogc:def:crs:EPSG:6.6:4326,\n *     urn:ogc:def:crs:OGC:1.3:CRS84, urn:ogc:def:crs:OGC:2:84,\n *     http://www.opengis.net/gml/srs/epsg.xml#4326,\n *     urn:x-ogc:def:crs:EPSG:4326\n * * `EPSG:3857`: EPSG:102100, EPSG:102113, EPSG:900913,\n *     urn:ogc:def:crs:EPSG:6.18:3:3857,\n *     http://www.opengis.net/gml/srs/epsg.xml#3857\n *\n * If you use [proj4js](https://github.com/proj4js/proj4js), aliases can\n * be added using `proj4.defs()`. After all required projection definitions are\n * added, call the {@link module:ol/proj/proj4~register} function.\n *\n * @api\n */\nclass Projection {\n\n  /**\n   * @param {Options} options Projection options.\n   */\n  constructor(options) {\n    /**\n     * @private\n     * @type {string}\n     */\n    this.code_ = options.code;\n\n    /**\n     * Units of projected coordinates. When set to `TILE_PIXELS`, a\n     * `this.extent_` and `this.worldExtent_` must be configured properly for each\n     * tile.\n     * @private\n     * @type {import(\"./Units.js\").default}\n     */\n    this.units_ = /** @type {import(\"./Units.js\").default} */ (options.units);\n\n    /**\n     * Validity extent of the projection in projected coordinates. For projections\n     * with `TILE_PIXELS` units, this is the extent of the tile in\n     * tile pixel space.\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.extent_ = options.extent !== undefined ? options.extent : null;\n\n    /**\n     * Extent of the world in EPSG:4326. For projections with\n     * `TILE_PIXELS` units, this is the extent of the tile in\n     * projected coordinate space.\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.worldExtent_ = options.worldExtent !== undefined ?\n      options.worldExtent : null;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.axisOrientation_ = options.axisOrientation !== undefined ?\n      options.axisOrientation : 'enu';\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.global_ = options.global !== undefined ? options.global : false;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.canWrapX_ = !!(this.global_ && this.extent_);\n\n    /**\n     * @private\n     * @type {function(number, import(\"../coordinate.js\").Coordinate):number|undefined}\n     */\n    this.getPointResolutionFunc_ = options.getPointResolution;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.defaultTileGrid_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.metersPerUnit_ = options.metersPerUnit;\n  }\n\n  /**\n   * @return {boolean} The projection is suitable for wrapping the x-axis\n   */\n  canWrapX() {\n    return this.canWrapX_;\n  }\n\n  /**\n   * Get the code for this projection, e.g. 'EPSG:4326'.\n   * @return {string} Code.\n   * @api\n   */\n  getCode() {\n    return this.code_;\n  }\n\n  /**\n   * Get the validity extent for this projection.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getExtent() {\n    return this.extent_;\n  }\n\n  /**\n   * Get the units of this projection.\n   * @return {import(\"./Units.js\").default} Units.\n   * @api\n   */\n  getUnits() {\n    return this.units_;\n  }\n\n  /**\n   * Get the amount of meters per unit of this projection.  If the projection is\n   * not configured with `metersPerUnit` or a units identifier, the return is\n   * `undefined`.\n   * @return {number|undefined} Meters.\n   * @api\n   */\n  getMetersPerUnit() {\n    return this.metersPerUnit_ || METERS_PER_UNIT[this.units_];\n  }\n\n  /**\n   * Get the world extent for this projection.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getWorldExtent() {\n    return this.worldExtent_;\n  }\n\n  /**\n   * Get the axis orientation of this projection.\n   * Example values are:\n   * enu - the default easting, northing, elevation.\n   * neu - northing, easting, up - useful for \"lat/long\" geographic coordinates,\n   *     or south orientated transverse mercator.\n   * wnu - westing, northing, up - some planetary coordinate systems have\n   *     \"west positive\" coordinate systems\n   * @return {string} Axis orientation.\n   * @api\n   */\n  getAxisOrientation() {\n    return this.axisOrientation_;\n  }\n\n  /**\n   * Is this projection a global projection which spans the whole world?\n   * @return {boolean} Whether the projection is global.\n   * @api\n   */\n  isGlobal() {\n    return this.global_;\n  }\n\n  /**\n   * Set if the projection is a global projection which spans the whole world\n   * @param {boolean} global Whether the projection is global.\n   * @api\n   */\n  setGlobal(global) {\n    this.global_ = global;\n    this.canWrapX_ = !!(global && this.extent_);\n  }\n\n  /**\n   * @return {import(\"../tilegrid/TileGrid.js\").default} The default tile grid.\n   */\n  getDefaultTileGrid() {\n    return this.defaultTileGrid_;\n  }\n\n  /**\n   * @param {import(\"../tilegrid/TileGrid.js\").default} tileGrid The default tile grid.\n   */\n  setDefaultTileGrid(tileGrid) {\n    this.defaultTileGrid_ = tileGrid;\n  }\n\n  /**\n   * Set the validity extent for this projection.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @api\n   */\n  setExtent(extent) {\n    this.extent_ = extent;\n    this.canWrapX_ = !!(this.global_ && extent);\n  }\n\n  /**\n   * Set the world extent for this projection.\n   * @param {import(\"../extent.js\").Extent} worldExtent World extent\n   *     [minlon, minlat, maxlon, maxlat].\n   * @api\n   */\n  setWorldExtent(worldExtent) {\n    this.worldExtent_ = worldExtent;\n  }\n\n  /**\n   * Set the getPointResolution function (see {@link module:ol/proj~getPointResolution}\n   * for this projection.\n   * @param {function(number, import(\"../coordinate.js\").Coordinate):number} func Function\n   * @api\n   */\n  setGetPointResolution(func) {\n    this.getPointResolutionFunc_ = func;\n  }\n\n  /**\n   * Get the custom point resolution function for this projection (if set).\n   * @return {function(number, import(\"../coordinate.js\").Coordinate):number|undefined} The custom point\n   * resolution function (if set).\n   */\n  getPointResolutionFunc() {\n    return this.getPointResolutionFunc_;\n  }\n}\n\nexport default Projection;\n","/**\n * @module ol/geom/MultiLineString\n */\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from './GeometryLayout.js';\nimport GeometryType from './GeometryType.js';\nimport LineString from './LineString.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {assignClosestArrayPoint, arrayMaxSquaredDelta} from './flat/closest.js';\nimport {deflateCoordinatesArray} from './flat/deflate.js';\nimport {inflateCoordinatesArray} from './flat/inflate.js';\nimport {interpolatePoint, lineStringsCoordinateAtM} from './flat/interpolate.js';\nimport {intersectsLineStringArray} from './flat/intersectsextent.js';\nimport {douglasPeuckerArray} from './flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-linestring geometry.\n *\n * @api\n */\nclass MultiLineString extends SimpleGeometry {\n\n  /**\n   * @param {Array<Array<import(\"../coordinate.js\").Coordinate>|LineString>|Array<number>} coordinates\n   *     Coordinates or LineString geometries. (For internal use, flat coordinates in\n   *     combination with `opt_layout` and `opt_ends` are also accepted.)\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @param {Array<number>=} opt_ends Flat coordinate ends for internal use.\n   */\n  constructor(coordinates, opt_layout, opt_ends) {\n\n    super();\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.ends_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDelta_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDeltaRevision_ = -1;\n\n    if (Array.isArray(coordinates[0])) {\n      this.setCoordinates(/** @type {Array<Array<import(\"../coordinate.js\").Coordinate>>} */ (coordinates), opt_layout);\n    } else if (opt_layout !== undefined && opt_ends) {\n      this.setFlatCoordinates(opt_layout, /** @type {Array<number>} */ (coordinates));\n      this.ends_ = opt_ends;\n    } else {\n      let layout = this.getLayout();\n      const lineStrings = /** @type {Array<LineString>} */ (coordinates);\n      const flatCoordinates = [];\n      const ends = [];\n      for (let i = 0, ii = lineStrings.length; i < ii; ++i) {\n        const lineString = lineStrings[i];\n        if (i === 0) {\n          layout = lineString.getLayout();\n        }\n        extend(flatCoordinates, lineString.getFlatCoordinates());\n        ends.push(flatCoordinates.length);\n      }\n      this.setFlatCoordinates(layout, flatCoordinates);\n      this.ends_ = ends;\n    }\n\n  }\n\n  /**\n   * Append the passed linestring to the multilinestring.\n   * @param {LineString} lineString LineString.\n   * @api\n   */\n  appendLineString(lineString) {\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = lineString.getFlatCoordinates().slice();\n    } else {\n      extend(this.flatCoordinates, lineString.getFlatCoordinates().slice());\n    }\n    this.ends_.push(this.flatCoordinates.length);\n    this.changed();\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!MultiLineString} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    return new MultiLineString(this.flatCoordinates.slice(), this.layout, this.ends_.slice());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    if (this.maxDeltaRevision_ != this.getRevision()) {\n      this.maxDelta_ = Math.sqrt(arrayMaxSquaredDelta(\n        this.flatCoordinates, 0, this.ends_, this.stride, 0));\n      this.maxDeltaRevision_ = this.getRevision();\n    }\n    return assignClosestArrayPoint(\n      this.flatCoordinates, 0, this.ends_, this.stride,\n      this.maxDelta_, false, x, y, closestPoint, minSquaredDistance);\n  }\n\n  /**\n   * Returns the coordinate at `m` using linear interpolation, or `null` if no\n   * such coordinate exists.\n   *\n   * `opt_extrapolate` controls extrapolation beyond the range of Ms in the\n   * MultiLineString. If `opt_extrapolate` is `true` then Ms less than the first\n   * M will return the first coordinate and Ms greater than the last M will\n   * return the last coordinate.\n   *\n   * `opt_interpolate` controls interpolation between consecutive LineStrings\n   * within the MultiLineString. If `opt_interpolate` is `true` the coordinates\n   * will be linearly interpolated between the last coordinate of one LineString\n   * and the first coordinate of the next LineString.  If `opt_interpolate` is\n   * `false` then the function will return `null` for Ms falling between\n   * LineStrings.\n   *\n   * @param {number} m M.\n   * @param {boolean=} opt_extrapolate Extrapolate. Default is `false`.\n   * @param {boolean=} opt_interpolate Interpolate. Default is `false`.\n   * @return {import(\"../coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  getCoordinateAtM(m, opt_extrapolate, opt_interpolate) {\n    if ((this.layout != GeometryLayout.XYM &&\n         this.layout != GeometryLayout.XYZM) ||\n        this.flatCoordinates.length === 0) {\n      return null;\n    }\n    const extrapolate = opt_extrapolate !== undefined ? opt_extrapolate : false;\n    const interpolate = opt_interpolate !== undefined ? opt_interpolate : false;\n    return lineStringsCoordinateAtM(this.flatCoordinates, 0,\n      this.ends_, this.stride, m, extrapolate, interpolate);\n  }\n\n  /**\n   * Return the coordinates of the multilinestring.\n   * @return {Array<Array<import(\"../coordinate.js\").Coordinate>>} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates() {\n    return inflateCoordinatesArray(\n      this.flatCoordinates, 0, this.ends_, this.stride);\n  }\n\n  /**\n   * @return {Array<number>} Ends.\n   */\n  getEnds() {\n    return this.ends_;\n  }\n\n  /**\n   * Return the linestring at the specified index.\n   * @param {number} index Index.\n   * @return {LineString} LineString.\n   * @api\n   */\n  getLineString(index) {\n    if (index < 0 || this.ends_.length <= index) {\n      return null;\n    }\n    return new LineString(this.flatCoordinates.slice(\n      index === 0 ? 0 : this.ends_[index - 1], this.ends_[index]), this.layout);\n  }\n\n  /**\n   * Return the linestrings of this multilinestring.\n   * @return {Array<LineString>} LineStrings.\n   * @api\n   */\n  getLineStrings() {\n    const flatCoordinates = this.flatCoordinates;\n    const ends = this.ends_;\n    const layout = this.layout;\n    /** @type {Array<LineString>} */\n    const lineStrings = [];\n    let offset = 0;\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      const end = ends[i];\n      const lineString = new LineString(flatCoordinates.slice(offset, end), layout);\n      lineStrings.push(lineString);\n      offset = end;\n    }\n    return lineStrings;\n  }\n\n  /**\n   * @return {Array<number>} Flat midpoints.\n   */\n  getFlatMidpoints() {\n    const midpoints = [];\n    const flatCoordinates = this.flatCoordinates;\n    let offset = 0;\n    const ends = this.ends_;\n    const stride = this.stride;\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      const end = ends[i];\n      const midpoint = interpolatePoint(\n        flatCoordinates, offset, end, stride, 0.5);\n      extend(midpoints, midpoint);\n      offset = end;\n    }\n    return midpoints;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometryInternal(squaredTolerance) {\n    const simplifiedFlatCoordinates = [];\n    const simplifiedEnds = [];\n    simplifiedFlatCoordinates.length = douglasPeuckerArray(\n      this.flatCoordinates, 0, this.ends_, this.stride, squaredTolerance,\n      simplifiedFlatCoordinates, 0, simplifiedEnds);\n    return new MultiLineString(simplifiedFlatCoordinates, GeometryLayout.XY, simplifiedEnds);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.MULTI_LINE_STRING;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    return intersectsLineStringArray(\n      this.flatCoordinates, 0, this.ends_, this.stride, extent);\n  }\n\n  /**\n   * Set the coordinates of the multilinestring.\n   * @param {!Array<Array<import(\"../coordinate.js\").Coordinate>>} coordinates Coordinates.\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @override\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 2);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const ends = deflateCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.ends_);\n    this.flatCoordinates.length = ends.length === 0 ? 0 : ends[ends.length - 1];\n    this.changed();\n  }\n}\n\n\nexport default MultiLineString;\n","/**\n * @module ol/geom/MultiPoint\n */\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY, containsXY} from '../extent.js';\nimport GeometryType from './GeometryType.js';\nimport Point from './Point.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {deflateCoordinates} from './flat/deflate.js';\nimport {inflateCoordinates} from './flat/inflate.js';\nimport {squaredDistance as squaredDx} from '../math.js';\n\n/**\n * @classdesc\n * Multi-point geometry.\n *\n * @api\n */\nclass MultiPoint extends SimpleGeometry {\n\n  /**\n   * @param {Array<import(\"../coordinate.js\").Coordinate>|Array<number>} coordinates Coordinates.\n   *     For internal use, flat coordinates in combination with `opt_layout` are also accepted.\n   * @param {import(\"./GeometryLayout.js\").default=} opt_layout Layout.\n   */\n  constructor(coordinates, opt_layout) {\n    super();\n    if (opt_layout && !Array.isArray(coordinates[0])) {\n      this.setFlatCoordinates(opt_layout, /** @type {Array<number>} */ (coordinates));\n    } else {\n      this.setCoordinates(/** @type {Array<import(\"../coordinate.js\").Coordinate>} */ (coordinates), opt_layout);\n    }\n  }\n\n  /**\n   * Append the passed point to this multipoint.\n   * @param {Point} point Point.\n   * @api\n   */\n  appendPoint(point) {\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = point.getFlatCoordinates().slice();\n    } else {\n      extend(this.flatCoordinates, point.getFlatCoordinates());\n    }\n    this.changed();\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!MultiPoint} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    const multiPoint = new MultiPoint(this.flatCoordinates.slice(), this.layout);\n    return multiPoint;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    const flatCoordinates = this.flatCoordinates;\n    const stride = this.stride;\n    for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n      const squaredDistance = squaredDx(\n        x, y, flatCoordinates[i], flatCoordinates[i + 1]);\n      if (squaredDistance < minSquaredDistance) {\n        minSquaredDistance = squaredDistance;\n        for (let j = 0; j < stride; ++j) {\n          closestPoint[j] = flatCoordinates[i + j];\n        }\n        closestPoint.length = stride;\n      }\n    }\n    return minSquaredDistance;\n  }\n\n  /**\n   * Return the coordinates of the multipoint.\n   * @return {Array<import(\"../coordinate.js\").Coordinate>} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates() {\n    return inflateCoordinates(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n  }\n\n  /**\n   * Return the point at the specified index.\n   * @param {number} index Index.\n   * @return {Point} Point.\n   * @api\n   */\n  getPoint(index) {\n    const n = !this.flatCoordinates ? 0 : this.flatCoordinates.length / this.stride;\n    if (index < 0 || n <= index) {\n      return null;\n    }\n    return new Point(this.flatCoordinates.slice(\n      index * this.stride, (index + 1) * this.stride), this.layout);\n  }\n\n  /**\n   * Return the points of this multipoint.\n   * @return {Array<Point>} Points.\n   * @api\n   */\n  getPoints() {\n    const flatCoordinates = this.flatCoordinates;\n    const layout = this.layout;\n    const stride = this.stride;\n    /** @type {Array<Point>} */\n    const points = [];\n    for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n      const point = new Point(flatCoordinates.slice(i, i + stride), layout);\n      points.push(point);\n    }\n    return points;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.MULTI_POINT;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    const flatCoordinates = this.flatCoordinates;\n    const stride = this.stride;\n    for (let i = 0, ii = flatCoordinates.length; i < ii; i += stride) {\n      const x = flatCoordinates[i];\n      const y = flatCoordinates[i + 1];\n      if (containsXY(extent, x, y)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Set the coordinates of the multipoint.\n   * @param {!Array<import(\"../coordinate.js\").Coordinate>} coordinates Coordinates.\n   * @param {import(\"./GeometryLayout.js\").default=} opt_layout Layout.\n   * @override\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n}\n\n\nexport default MultiPoint;\n","/**\n * @module ol/control/Control\n */\nimport {VOID} from '../functions.js';\nimport MapEventType from '../MapEventType.js';\nimport BaseObject from '../Object.js';\nimport {removeNode} from '../dom.js';\nimport {listen, unlistenByKey} from '../events.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {HTMLElement} [element] The element is the control's\n * container element. This only needs to be specified if you're developing\n * a custom control.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n * @property {HTMLElement|string} [target] Specify a target if you want\n * the control to be rendered outside of the map's viewport.\n */\n\n\n/**\n * @classdesc\n * A control is a visible widget with a DOM element in a fixed position on the\n * screen. They can involve user input (buttons), or be informational only;\n * the position is determined using CSS. By default these are placed in the\n * container with CSS class name `ol-overlaycontainer-stopevent`, but can use\n * any outside DOM element.\n *\n * This is the base class for controls. You can use it for simple custom\n * controls by creating the element with listeners, creating an instance:\n * ```js\n * var myControl = new Control({element: myElement});\n * ```\n * and then adding this to the map.\n *\n * The main advantage of having this as a control rather than a simple separate\n * DOM element is that preventing propagation is handled for you. Controls\n * will also be objects in a {@link module:ol/Collection~Collection}, so you can use their methods.\n *\n * You can also extend this base for your own control class. See\n * examples/custom-controls for an example of how to do this.\n *\n * @api\n */\nclass Control extends BaseObject {\n\n  /**\n   * @param {Options} options Control options.\n   */\n  constructor(options) {\n\n    super();\n\n    /**\n     * @protected\n     * @type {HTMLElement}\n     */\n    this.element = options.element ? options.element : null;\n\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this.target_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").default}\n     */\n    this.map_ = null;\n\n    /**\n     * @protected\n     * @type {!Array<import(\"../events.js\").EventsKey>}\n     */\n    this.listenerKeys = [];\n\n    /**\n     * @type {function(import(\"../MapEvent.js\").default): void}\n     */\n    this.render = options.render ? options.render : VOID;\n\n    if (options.target) {\n      this.setTarget(options.target);\n    }\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    removeNode(this.element);\n    super.disposeInternal();\n  }\n\n  /**\n   * Get the map associated with this control.\n   * @return {import(\"../PluggableMap.js\").default} Map.\n   * @api\n   */\n  getMap() {\n    return this.map_;\n  }\n\n  /**\n   * Remove the control from its current map and attach it to the new map.\n   * Subclasses may set up event handlers to get notified about changes to\n   * the map here.\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   * @api\n   */\n  setMap(map) {\n    if (this.map_) {\n      removeNode(this.element);\n    }\n    for (let i = 0, ii = this.listenerKeys.length; i < ii; ++i) {\n      unlistenByKey(this.listenerKeys[i]);\n    }\n    this.listenerKeys.length = 0;\n    this.map_ = map;\n    if (this.map_) {\n      const target = this.target_ ?\n        this.target_ : map.getOverlayContainerStopEvent();\n      target.appendChild(this.element);\n      if (this.render !== VOID) {\n        this.listenerKeys.push(listen(map,\n          MapEventType.POSTRENDER, this.render, this));\n      }\n      map.render();\n    }\n  }\n\n  /**\n   * This function is used to set a target element for the control. It has no\n   * effect if it is called after the control has been added to the map (i.e.\n   * after `setMap` is called on the control). If no `target` is set in the\n   * options passed to the control constructor and if `setTarget` is not called\n   * then the control is added to the map's overlay container.\n   * @param {HTMLElement|string} target Target.\n   * @api\n   */\n  setTarget(target) {\n    this.target_ = typeof target === 'string' ?\n      document.getElementById(target) :\n      target;\n  }\n}\n\n\nexport default Control;\n","/**\n * @module ol/has\n */\n\nconst ua = typeof navigator !== 'undefined' ?\n  navigator.userAgent.toLowerCase() : '';\n\n/**\n * User agent string says we are dealing with Firefox as browser.\n * @type {boolean}\n */\nexport const FIREFOX = ua.indexOf('firefox') !== -1;\n\n/**\n * User agent string says we are dealing with Safari as browser.\n * @type {boolean}\n */\nexport const SAFARI = ua.indexOf('safari') !== -1 && ua.indexOf('chrom') == -1;\n\n/**\n * User agent string says we are dealing with a WebKit engine.\n * @type {boolean}\n */\nexport const WEBKIT = ua.indexOf('webkit') !== -1 && ua.indexOf('edge') == -1;\n\n/**\n * User agent string says we are dealing with a Mac as platform.\n * @type {boolean}\n */\nexport const MAC = ua.indexOf('macintosh') !== -1;\n\n\n/**\n * The ratio between physical pixels and device-independent pixels\n * (dips) on the device (`window.devicePixelRatio`).\n * @const\n * @type {number}\n * @api\n */\nexport const DEVICE_PIXEL_RATIO = window.devicePixelRatio || 1;\n\n/**\n * Image.prototype.decode() is supported.\n * @type {boolean}\n */\nexport const IMAGE_DECODE = typeof Image !== 'undefined' && Image.prototype.decode;\n","/**\n * @module ol/style/Text\n */\nimport Fill from './Fill.js';\nimport TextPlacement from './TextPlacement.js';\n\n\n/**\n * The default fill color to use if no fill was set at construction time; a\n * blackish `#333`.\n *\n * @const {string}\n */\nconst DEFAULT_FILL_COLOR = '#333';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [font] Font style as CSS 'font' value, see:\n * https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font. Default is '10px sans-serif'\n * @property {number} [maxAngle=Math.PI/4] When `placement` is set to `'line'`, allow a maximum angle between adjacent characters.\n * The expected value is in radians, and the default is 45° (`Math.PI / 4`).\n * @property {number} [offsetX=0] Horizontal text offset in pixels. A positive will shift the text right.\n * @property {number} [offsetY=0] Vertical text offset in pixels. A positive will shift the text down.\n * @property {boolean} [overflow=false] For polygon labels or when `placement` is set to `'line'`, allow text to exceed\n * the width of the polygon at the label position or the length of the path that it follows.\n * @property {import(\"./TextPlacement.js\").default|string} [placement='point'] Text placement.\n * @property {number} [scale] Scale.\n * @property {boolean} [rotateWithView=false] Whether to rotate the text with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {string} [text] Text content.\n * @property {string} [textAlign] Text alignment. Possible values: 'left', 'right', 'center', 'end' or 'start'.\n * Default is 'center' for `placement: 'point'`. For `placement: 'line'`, the default is to let the renderer choose a\n * placement where `maxAngle` is not exceeded.\n * @property {string} [textBaseline='middle'] Text base line. Possible values: 'bottom', 'top', 'middle', 'alphabetic',\n * 'hanging', 'ideographic'.\n * @property {import(\"./Fill.js\").default} [fill] Fill style. If none is provided, we'll use a dark fill-style (#333).\n * @property {import(\"./Stroke.js\").default} [stroke] Stroke style.\n * @property {import(\"./Fill.js\").default} [backgroundFill] Fill style for the text background when `placement` is\n * `'point'`. Default is no fill.\n * @property {import(\"./Stroke.js\").default} [backgroundStroke] Stroke style for the text background  when `placement`\n * is `'point'`. Default is no stroke.\n * @property {Array<number>} [padding=[0, 0, 0, 0]] Padding in pixels around the text for decluttering and background. The order of\n * values in the array is `[top, right, bottom, left]`.\n */\n\n\n/**\n * @classdesc\n * Set text style for vector features.\n * @api\n */\nclass Text {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.font_ = options.font;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.rotation_ = options.rotation;\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.rotateWithView_ = options.rotateWithView;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.scale_ = options.scale;\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.text_ = options.text;\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.textAlign_ = options.textAlign;\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.textBaseline_ = options.textBaseline;\n\n    /**\n     * @private\n     * @type {import(\"./Fill.js\").default}\n     */\n    this.fill_ = options.fill !== undefined ? options.fill :\n      new Fill({color: DEFAULT_FILL_COLOR});\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxAngle_ = options.maxAngle !== undefined ? options.maxAngle : Math.PI / 4;\n\n    /**\n     * @private\n     * @type {import(\"./TextPlacement.js\").default|string}\n     */\n    this.placement_ = options.placement !== undefined ? options.placement : TextPlacement.POINT;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.overflow_ = !!options.overflow;\n\n    /**\n     * @private\n     * @type {import(\"./Stroke.js\").default}\n     */\n    this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.offsetX_ = options.offsetX !== undefined ? options.offsetX : 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.offsetY_ = options.offsetY !== undefined ? options.offsetY : 0;\n\n    /**\n     * @private\n     * @type {import(\"./Fill.js\").default}\n     */\n    this.backgroundFill_ = options.backgroundFill ? options.backgroundFill : null;\n\n    /**\n     * @private\n     * @type {import(\"./Stroke.js\").default}\n     */\n    this.backgroundStroke_ = options.backgroundStroke ? options.backgroundStroke : null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.padding_ = options.padding === undefined ? null : options.padding;\n  }\n\n  /**\n   * Clones the style.\n   * @return {Text} The cloned style.\n   * @api\n   */\n  clone() {\n    return new Text({\n      font: this.getFont(),\n      placement: this.getPlacement(),\n      maxAngle: this.getMaxAngle(),\n      overflow: this.getOverflow(),\n      rotation: this.getRotation(),\n      rotateWithView: this.getRotateWithView(),\n      scale: this.getScale(),\n      text: this.getText(),\n      textAlign: this.getTextAlign(),\n      textBaseline: this.getTextBaseline(),\n      fill: this.getFill() ? this.getFill().clone() : undefined,\n      stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n      offsetX: this.getOffsetX(),\n      offsetY: this.getOffsetY(),\n      backgroundFill: this.getBackgroundFill() ? this.getBackgroundFill().clone() : undefined,\n      backgroundStroke: this.getBackgroundStroke() ? this.getBackgroundStroke().clone() : undefined,\n      padding: this.getPadding()\n    });\n  }\n\n  /**\n   * Get the `overflow` configuration.\n   * @return {boolean} Let text overflow the length of the path they follow.\n   * @api\n   */\n  getOverflow() {\n    return this.overflow_;\n  }\n\n  /**\n   * Get the font name.\n   * @return {string|undefined} Font.\n   * @api\n   */\n  getFont() {\n    return this.font_;\n  }\n\n  /**\n   * Get the maximum angle between adjacent characters.\n   * @return {number} Angle in radians.\n   * @api\n   */\n  getMaxAngle() {\n    return this.maxAngle_;\n  }\n\n  /**\n   * Get the label placement.\n   * @return {import(\"./TextPlacement.js\").default|string} Text placement.\n   * @api\n   */\n  getPlacement() {\n    return this.placement_;\n  }\n\n  /**\n   * Get the x-offset for the text.\n   * @return {number} Horizontal text offset.\n   * @api\n   */\n  getOffsetX() {\n    return this.offsetX_;\n  }\n\n  /**\n   * Get the y-offset for the text.\n   * @return {number} Vertical text offset.\n   * @api\n   */\n  getOffsetY() {\n    return this.offsetY_;\n  }\n\n  /**\n   * Get the fill style for the text.\n   * @return {import(\"./Fill.js\").default} Fill style.\n   * @api\n   */\n  getFill() {\n    return this.fill_;\n  }\n\n  /**\n   * Determine whether the text rotates with the map.\n   * @return {boolean|undefined} Rotate with map.\n   * @api\n   */\n  getRotateWithView() {\n    return this.rotateWithView_;\n  }\n\n  /**\n   * Get the text rotation.\n   * @return {number|undefined} Rotation.\n   * @api\n   */\n  getRotation() {\n    return this.rotation_;\n  }\n\n  /**\n   * Get the text scale.\n   * @return {number|undefined} Scale.\n   * @api\n   */\n  getScale() {\n    return this.scale_;\n  }\n\n  /**\n   * Get the stroke style for the text.\n   * @return {import(\"./Stroke.js\").default} Stroke style.\n   * @api\n   */\n  getStroke() {\n    return this.stroke_;\n  }\n\n  /**\n   * Get the text to be rendered.\n   * @return {string|undefined} Text.\n   * @api\n   */\n  getText() {\n    return this.text_;\n  }\n\n  /**\n   * Get the text alignment.\n   * @return {string|undefined} Text align.\n   * @api\n   */\n  getTextAlign() {\n    return this.textAlign_;\n  }\n\n  /**\n   * Get the text baseline.\n   * @return {string|undefined} Text baseline.\n   * @api\n   */\n  getTextBaseline() {\n    return this.textBaseline_;\n  }\n\n  /**\n   * Get the background fill style for the text.\n   * @return {import(\"./Fill.js\").default} Fill style.\n   * @api\n   */\n  getBackgroundFill() {\n    return this.backgroundFill_;\n  }\n\n  /**\n   * Get the background stroke style for the text.\n   * @return {import(\"./Stroke.js\").default} Stroke style.\n   * @api\n   */\n  getBackgroundStroke() {\n    return this.backgroundStroke_;\n  }\n\n  /**\n   * Get the padding for the text.\n   * @return {Array<number>} Padding.\n   * @api\n   */\n  getPadding() {\n    return this.padding_;\n  }\n\n  /**\n   * Set the `overflow` property.\n   *\n   * @param {boolean} overflow Let text overflow the path that it follows.\n   * @api\n   */\n  setOverflow(overflow) {\n    this.overflow_ = overflow;\n  }\n\n  /**\n   * Set the font.\n   *\n   * @param {string|undefined} font Font.\n   * @api\n   */\n  setFont(font) {\n    this.font_ = font;\n  }\n\n  /**\n   * Set the maximum angle between adjacent characters.\n   *\n   * @param {number} maxAngle Angle in radians.\n   * @api\n   */\n  setMaxAngle(maxAngle) {\n    this.maxAngle_ = maxAngle;\n  }\n\n  /**\n   * Set the x offset.\n   *\n   * @param {number} offsetX Horizontal text offset.\n   * @api\n   */\n  setOffsetX(offsetX) {\n    this.offsetX_ = offsetX;\n  }\n\n  /**\n   * Set the y offset.\n   *\n   * @param {number} offsetY Vertical text offset.\n   * @api\n   */\n  setOffsetY(offsetY) {\n    this.offsetY_ = offsetY;\n  }\n\n  /**\n   * Set the text placement.\n   *\n   * @param {import(\"./TextPlacement.js\").default|string} placement Placement.\n   * @api\n   */\n  setPlacement(placement) {\n    this.placement_ = placement;\n  }\n\n  /**\n   * Set whether to rotate the text with the view.\n   *\n   * @param {boolean} rotateWithView Rotate with map.\n   * @api\n   */\n  setRotateWithView(rotateWithView) {\n    this.rotateWithView_ = rotateWithView;\n  }\n\n  /**\n   * Set the fill.\n   *\n   * @param {import(\"./Fill.js\").default} fill Fill style.\n   * @api\n   */\n  setFill(fill) {\n    this.fill_ = fill;\n  }\n\n  /**\n   * Set the rotation.\n   *\n   * @param {number|undefined} rotation Rotation.\n   * @api\n   */\n  setRotation(rotation) {\n    this.rotation_ = rotation;\n  }\n\n  /**\n   * Set the scale.\n   *\n   * @param {number|undefined} scale Scale.\n   * @api\n   */\n  setScale(scale) {\n    this.scale_ = scale;\n  }\n\n  /**\n   * Set the stroke.\n   *\n   * @param {import(\"./Stroke.js\").default} stroke Stroke style.\n   * @api\n   */\n  setStroke(stroke) {\n    this.stroke_ = stroke;\n  }\n\n  /**\n   * Set the text.\n   *\n   * @param {string|undefined} text Text.\n   * @api\n   */\n  setText(text) {\n    this.text_ = text;\n  }\n\n  /**\n   * Set the text alignment.\n   *\n   * @param {string|undefined} textAlign Text align.\n   * @api\n   */\n  setTextAlign(textAlign) {\n    this.textAlign_ = textAlign;\n  }\n\n  /**\n   * Set the text baseline.\n   *\n   * @param {string|undefined} textBaseline Text baseline.\n   * @api\n   */\n  setTextBaseline(textBaseline) {\n    this.textBaseline_ = textBaseline;\n  }\n\n  /**\n   * Set the background fill.\n   *\n   * @param {import(\"./Fill.js\").default} fill Fill style.\n   * @api\n   */\n  setBackgroundFill(fill) {\n    this.backgroundFill_ = fill;\n  }\n\n  /**\n   * Set the background stroke.\n   *\n   * @param {import(\"./Stroke.js\").default} stroke Stroke style.\n   * @api\n   */\n  setBackgroundStroke(stroke) {\n    this.backgroundStroke_ = stroke;\n  }\n\n  /**\n   * Set the padding (`[top, right, bottom, left]`).\n   *\n   * @param {!Array<number>} padding Padding.\n   * @api\n   */\n  setPadding(padding) {\n    this.padding_ = padding;\n  }\n}\n\nexport default Text;\n","/**\n * @module ol/style/IconOrigin\n */\n\n/**\n * Icon origin. One of 'bottom-left', 'bottom-right', 'top-left', 'top-right'.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/geom/SimpleGeometry\n */\nimport {abstract} from '../util.js';\nimport {createOrUpdateFromFlatCoordinates, getCenter} from '../extent.js';\nimport Geometry from './Geometry.js';\nimport GeometryLayout from './GeometryLayout.js';\nimport {rotate, scale, translate, transform2D} from './flat/transform.js';\n\n/**\n * @classdesc\n * Abstract base class; only used for creating subclasses; do not instantiate\n * in apps, as cannot be rendered.\n *\n * @abstract\n * @api\n */\nclass SimpleGeometry extends Geometry {\n  constructor() {\n\n    super();\n\n    /**\n     * @protected\n     * @type {GeometryLayout}\n     */\n    this.layout = GeometryLayout.XY;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.stride = 2;\n\n    /**\n     * @protected\n     * @type {Array<number>}\n     */\n    this.flatCoordinates = null;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  computeExtent(extent) {\n    return createOrUpdateFromFlatCoordinates(this.flatCoordinates,\n      0, this.flatCoordinates.length, this.stride, extent);\n  }\n\n  /**\n   * @abstract\n   * @return {Array<*>} Coordinates.\n   */\n  getCoordinates() {\n    return abstract();\n  }\n\n  /**\n   * Return the first coordinate of the geometry.\n   * @return {import(\"../coordinate.js\").Coordinate} First coordinate.\n   * @api\n   */\n  getFirstCoordinate() {\n    return this.flatCoordinates.slice(0, this.stride);\n  }\n\n  /**\n   * @return {Array<number>} Flat coordinates.\n   */\n  getFlatCoordinates() {\n    return this.flatCoordinates;\n  }\n\n  /**\n   * Return the last coordinate of the geometry.\n   * @return {import(\"../coordinate.js\").Coordinate} Last point.\n   * @api\n   */\n  getLastCoordinate() {\n    return this.flatCoordinates.slice(this.flatCoordinates.length - this.stride);\n  }\n\n  /**\n   * Return the {@link module:ol/geom/GeometryLayout layout} of the geometry.\n   * @return {GeometryLayout} Layout.\n   * @api\n   */\n  getLayout() {\n    return this.layout;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometry(squaredTolerance) {\n    if (this.simplifiedGeometryRevision !== this.getRevision()) {\n      this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n      this.simplifiedGeometryRevision = this.getRevision();\n    }\n    // If squaredTolerance is negative or if we know that simplification will not\n    // have any effect then just return this.\n    if (squaredTolerance < 0 ||\n        (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n         squaredTolerance <= this.simplifiedGeometryMaxMinSquaredTolerance)) {\n      return this;\n    }\n\n    const simplifiedGeometry =\n        this.getSimplifiedGeometryInternal(squaredTolerance);\n    const simplifiedFlatCoordinates = simplifiedGeometry.getFlatCoordinates();\n    if (simplifiedFlatCoordinates.length < this.flatCoordinates.length) {\n      return simplifiedGeometry;\n    } else {\n      // Simplification did not actually remove any coordinates.  We now know\n      // that any calls to getSimplifiedGeometry with a squaredTolerance less\n      // than or equal to the current squaredTolerance will also not have any\n      // effect.  This allows us to short circuit simplification (saving CPU\n      // cycles) and prevents the cache of simplified geometries from filling\n      // up with useless identical copies of this geometry (saving memory).\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n\n  /**\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {SimpleGeometry} Simplified geometry.\n   * @protected\n   */\n  getSimplifiedGeometryInternal(squaredTolerance) {\n    return this;\n  }\n\n  /**\n   * @return {number} Stride.\n   */\n  getStride() {\n    return this.stride;\n  }\n\n  /**\n   * @param {GeometryLayout} layout Layout.\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   */\n  setFlatCoordinates(layout, flatCoordinates) {\n    this.stride = getStrideForLayout(layout);\n    this.layout = layout;\n    this.flatCoordinates = flatCoordinates;\n  }\n\n  /**\n   * @abstract\n   * @param {!Array<*>} coordinates Coordinates.\n   * @param {GeometryLayout=} opt_layout Layout.\n   */\n  setCoordinates(coordinates, opt_layout) {\n    abstract();\n  }\n\n  /**\n   * @param {GeometryLayout|undefined} layout Layout.\n   * @param {Array<*>} coordinates Coordinates.\n   * @param {number} nesting Nesting.\n   * @protected\n   */\n  setLayout(layout, coordinates, nesting) {\n    /** @type {number} */\n    let stride;\n    if (layout) {\n      stride = getStrideForLayout(layout);\n    } else {\n      for (let i = 0; i < nesting; ++i) {\n        if (coordinates.length === 0) {\n          this.layout = GeometryLayout.XY;\n          this.stride = 2;\n          return;\n        } else {\n          coordinates = /** @type {Array} */ (coordinates[0]);\n        }\n      }\n      stride = coordinates.length;\n      layout = getLayoutForStride(stride);\n    }\n    this.layout = layout;\n    this.stride = stride;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  applyTransform(transformFn) {\n    if (this.flatCoordinates) {\n      transformFn(this.flatCoordinates, this.flatCoordinates, this.stride);\n      this.changed();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  rotate(angle, anchor) {\n    const flatCoordinates = this.getFlatCoordinates();\n    if (flatCoordinates) {\n      const stride = this.getStride();\n      rotate(\n        flatCoordinates, 0, flatCoordinates.length,\n        stride, angle, anchor, flatCoordinates);\n      this.changed();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  scale(sx, opt_sy, opt_anchor) {\n    let sy = opt_sy;\n    if (sy === undefined) {\n      sy = sx;\n    }\n    let anchor = opt_anchor;\n    if (!anchor) {\n      anchor = getCenter(this.getExtent());\n    }\n    const flatCoordinates = this.getFlatCoordinates();\n    if (flatCoordinates) {\n      const stride = this.getStride();\n      scale(\n        flatCoordinates, 0, flatCoordinates.length,\n        stride, sx, sy, anchor, flatCoordinates);\n      this.changed();\n    }\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  translate(deltaX, deltaY) {\n    const flatCoordinates = this.getFlatCoordinates();\n    if (flatCoordinates) {\n      const stride = this.getStride();\n      translate(\n        flatCoordinates, 0, flatCoordinates.length, stride,\n        deltaX, deltaY, flatCoordinates);\n      this.changed();\n    }\n  }\n}\n\n\n/**\n * @param {number} stride Stride.\n * @return {GeometryLayout} layout Layout.\n */\nfunction getLayoutForStride(stride) {\n  let layout;\n  if (stride == 2) {\n    layout = GeometryLayout.XY;\n  } else if (stride == 3) {\n    layout = GeometryLayout.XYZ;\n  } else if (stride == 4) {\n    layout = GeometryLayout.XYZM;\n  }\n  return (\n    /** @type {GeometryLayout} */ (layout)\n  );\n}\n\n\n/**\n * @param {GeometryLayout} layout Layout.\n * @return {number} Stride.\n */\nexport function getStrideForLayout(layout) {\n  let stride;\n  if (layout == GeometryLayout.XY) {\n    stride = 2;\n  } else if (layout == GeometryLayout.XYZ || layout == GeometryLayout.XYM) {\n    stride = 3;\n  } else if (layout == GeometryLayout.XYZM) {\n    stride = 4;\n  }\n  return /** @type {number} */ (stride);\n}\n\n\n/**\n * @param {SimpleGeometry} simpleGeometry Simple geometry.\n * @param {import(\"../transform.js\").Transform} transform Transform.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Transformed flat coordinates.\n */\nexport function transformGeom2D(simpleGeometry, transform, opt_dest) {\n  const flatCoordinates = simpleGeometry.getFlatCoordinates();\n  if (!flatCoordinates) {\n    return null;\n  } else {\n    const stride = simpleGeometry.getStride();\n    return transform2D(\n      flatCoordinates, 0, flatCoordinates.length, stride,\n      transform, opt_dest);\n  }\n}\n\nexport default SimpleGeometry;\n","/**\n * @module ol/interaction/Interaction\n */\nimport BaseObject from '../Object.js';\nimport {easeOut, linear} from '../easing.js';\nimport InteractionProperty from './Property.js';\n\n\n/**\n * Object literal with config options for interactions.\n * @typedef {Object} InteractionOptions\n * @property {function(import(\"../MapBrowserEvent.js\").default):boolean} handleEvent\n * Method called by the map to notify the interaction that a browser event was\n * dispatched to the map. If the function returns a falsy value, propagation of\n * the event to other interactions in the map's interactions chain will be\n * prevented (this includes functions with no explicit return). The interactions\n * are traversed in reverse order of the interactions collection of the map.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * User actions that change the state of the map. Some are similar to controls,\n * but are not associated with a DOM element.\n * For example, {@link module:ol/interaction/KeyboardZoom~KeyboardZoom} is\n * functionally the same as {@link module:ol/control/Zoom~Zoom}, but triggered\n * by a keyboard event not a button element event.\n * Although interactions do not have a DOM element, some of them do render\n * vectors and so are visible on the screen.\n * @api\n */\nclass Interaction extends BaseObject {\n  /**\n   * @param {InteractionOptions} options Options.\n   */\n  constructor(options) {\n    super();\n\n    if (options.handleEvent) {\n      this.handleEvent = options.handleEvent;\n    }\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").default}\n     */\n    this.map_ = null;\n\n    this.setActive(true);\n  }\n\n  /**\n   * Return whether the interaction is currently active.\n   * @return {boolean} `true` if the interaction is active, `false` otherwise.\n   * @observable\n   * @api\n   */\n  getActive() {\n    return /** @type {boolean} */ (this.get(InteractionProperty.ACTIVE));\n  }\n\n  /**\n   * Get the map associated with this interaction.\n   * @return {import(\"../PluggableMap.js\").default} Map.\n   * @api\n   */\n  getMap() {\n    return this.map_;\n  }\n\n  /**\n   * Handles the {@link module:ol/MapBrowserEvent map browser event}.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n   * @return {boolean} `false` to stop event propagation.\n   * @api\n   */\n  handleEvent(mapBrowserEvent) {\n    return true;\n  }\n\n  /**\n   * Activate or deactivate the interaction.\n   * @param {boolean} active Active.\n   * @observable\n   * @api\n   */\n  setActive(active) {\n    this.set(InteractionProperty.ACTIVE, active);\n  }\n\n  /**\n   * Remove the interaction from its current map and attach it to the new map.\n   * Subclasses may set up event handlers to get notified about changes to\n   * the map here.\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n  setMap(map) {\n    this.map_ = map;\n  }\n}\n\n\n/**\n * @param {import(\"../View.js\").default} view View.\n * @param {import(\"../coordinate.js\").Coordinate} delta Delta.\n * @param {number=} opt_duration Duration.\n */\nexport function pan(view, delta, opt_duration) {\n  const currentCenter = view.getCenterInternal();\n  if (currentCenter) {\n    const center = [currentCenter[0] + delta[0], currentCenter[1] + delta[1]];\n    view.animateInternal({\n      duration: opt_duration !== undefined ? opt_duration : 250,\n      easing: linear,\n      center: view.getConstrainedCenter(center)\n    });\n  }\n}\n\n/**\n * @param {import(\"../View.js\").default} view View.\n * @param {number} delta Delta from previous zoom level.\n * @param {import(\"../coordinate.js\").Coordinate=} opt_anchor Anchor coordinate in the user projection.\n * @param {number=} opt_duration Duration.\n */\nexport function zoomByDelta(view, delta, opt_anchor, opt_duration) {\n  const currentZoom = view.getZoom();\n\n  if (currentZoom === undefined) {\n    return;\n  }\n\n  const newZoom = view.getConstrainedZoom(currentZoom + delta);\n  const newResolution = view.getResolutionForZoom(newZoom);\n\n  if (view.getAnimating()) {\n    view.cancelAnimations();\n  }\n  view.animate({\n    resolution: newResolution,\n    anchor: opt_anchor,\n    duration: opt_duration !== undefined ? opt_duration : 250,\n    easing: easeOut\n  });\n}\n\nexport default Interaction;\n","/**\n * @module ol/Overlay\n */\nimport MapEventType from './MapEventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport OverlayPositioning from './OverlayPositioning.js';\nimport {CLASS_SELECTABLE} from './css.js';\nimport {removeNode, removeChildren, outerWidth, outerHeight} from './dom.js';\nimport {listen, unlistenByKey} from './events.js';\nimport {containsExtent} from './extent.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number|string} [id] Set the overlay id. The overlay id can be used\n * with the {@link module:ol/Map~Map#getOverlayById} method.\n * @property {HTMLElement} [element] The overlay element.\n * @property {Array<number>} [offset=[0, 0]] Offsets in pixels used when positioning\n * the overlay. The first element in the\n * array is the horizontal offset. A positive value shifts the overlay right.\n * The second element in the array is the vertical offset. A positive value\n * shifts the overlay down.\n * @property {import(\"./coordinate.js\").Coordinate} [position] The overlay position\n * in map projection.\n * @property {OverlayPositioning} [positioning='top-left'] Defines how\n * the overlay is actually positioned with respect to its `position` property.\n * Possible values are `'bottom-left'`, `'bottom-center'`, `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, and `'top-right'`.\n * @property {boolean} [stopEvent=true] Whether event propagation to the map\n * viewport should be stopped. If `true` the overlay is placed in the same\n * container as that of the controls (CSS class name\n * `ol-overlaycontainer-stopevent`); if `false` it is placed in the container\n * with CSS class name specified by the `className` property.\n * @property {boolean} [insertFirst=true] Whether the overlay is inserted first\n * in the overlay container, or appended. If the overlay is placed in the same\n * container as that of the controls (see the `stopEvent` option) you will\n * probably set `insertFirst` to `true` so the overlay is displayed below the\n * controls.\n * @property {boolean} [autoPan=false] If set to `true` the map is panned when\n * calling `setPosition`, so that the overlay is entirely visible in the current\n * viewport.\n * @property {PanOptions} [autoPanAnimation] The\n * animation options used to pan the overlay into view. This animation is only\n * used when `autoPan` is enabled. A `duration` and `easing` may be provided to\n * customize the animation.\n * @property {number} [autoPanMargin=20] The margin (in pixels) between the\n * overlay and the borders of the map when autopanning.\n * @property {string} [className='ol-overlay-container ol-selectable'] CSS class\n * name.\n */\n\n\n/**\n * @typedef {Object} PanOptions\n * @property {number} [duration=1000] The duration of the animation in\n * milliseconds.\n * @property {function(number):number} [easing] The easing function to use. Can\n * be one from {@link module:ol/easing} or a custom function.\n * Default is {@link module:ol/easing~inAndOut}.\n */\n\n\n/**\n * @enum {string}\n * @protected\n */\nconst Property = {\n  ELEMENT: 'element',\n  MAP: 'map',\n  OFFSET: 'offset',\n  POSITION: 'position',\n  POSITIONING: 'positioning'\n};\n\n\n/**\n * @classdesc\n * An element to be displayed over the map and attached to a single map\n * location.  Like {@link module:ol/control/Control~Control}, Overlays are\n * visible widgets. Unlike Controls, they are not in a fixed position on the\n * screen, but are tied to a geographical coordinate, so panning the map will\n * move an Overlay but not a Control.\n *\n * Example:\n *\n *     import Overlay from 'ol/Overlay';\n *\n *     var popup = new Overlay({\n *       element: document.getElementById('popup')\n *     });\n *     popup.setPosition(coordinate);\n *     map.addOverlay(popup);\n *\n * @api\n */\nclass Overlay extends BaseObject {\n\n  /**\n   * @param {Options} options Overlay options.\n   */\n  constructor(options) {\n\n    super();\n\n    /**\n     * @protected\n     * @type {Options}\n     */\n    this.options = options;\n\n    /**\n     * @protected\n     * @type {number|string|undefined}\n     */\n    this.id = options.id;\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.insertFirst = options.insertFirst !== undefined ?\n      options.insertFirst : true;\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.stopEvent = options.stopEvent !== undefined ? options.stopEvent : true;\n\n    /**\n     * @protected\n     * @type {HTMLElement}\n     */\n    this.element = document.createElement('div');\n    this.element.className = options.className !== undefined ?\n      options.className : 'ol-overlay-container ' + CLASS_SELECTABLE;\n    this.element.style.position = 'absolute';\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.autoPan = options.autoPan !== undefined ? options.autoPan : false;\n\n    /**\n     * @protected\n     * @type {PanOptions}\n     */\n    this.autoPanAnimation = options.autoPanAnimation || /** @type {PanOptions} */ ({});\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.autoPanMargin = options.autoPanMargin !== undefined ?\n      options.autoPanMargin : 20;\n\n    /**\n     * @protected\n     * @type {{bottom_: string,\n     *         left_: string,\n     *         right_: string,\n     *         top_: string,\n     *         visible: boolean}}\n     */\n    this.rendered = {\n      bottom_: '',\n      left_: '',\n      right_: '',\n      top_: '',\n      visible: true\n    };\n\n    /**\n     * @protected\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.mapPostrenderListenerKey = null;\n\n    this.addEventListener(getChangeEventType(Property.ELEMENT), this.handleElementChanged);\n    this.addEventListener(getChangeEventType(Property.MAP), this.handleMapChanged);\n    this.addEventListener(getChangeEventType(Property.OFFSET), this.handleOffsetChanged);\n    this.addEventListener(getChangeEventType(Property.POSITION), this.handlePositionChanged);\n    this.addEventListener(getChangeEventType(Property.POSITIONING), this.handlePositioningChanged);\n\n    if (options.element !== undefined) {\n      this.setElement(options.element);\n    }\n\n    this.setOffset(options.offset !== undefined ? options.offset : [0, 0]);\n\n    this.setPositioning(options.positioning !== undefined ?\n      /** @type {OverlayPositioning} */ (options.positioning) :\n      OverlayPositioning.TOP_LEFT);\n\n    if (options.position !== undefined) {\n      this.setPosition(options.position);\n    }\n\n  }\n\n  /**\n   * Get the DOM element of this overlay.\n   * @return {HTMLElement|undefined} The Element containing the overlay.\n   * @observable\n   * @api\n   */\n  getElement() {\n    return /** @type {HTMLElement|undefined} */ (this.get(Property.ELEMENT));\n  }\n\n  /**\n   * Get the overlay identifier which is set on constructor.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id;\n  }\n\n  /**\n   * Get the map associated with this overlay.\n   * @return {import(\"./PluggableMap.js\").default|undefined} The map that the\n   * overlay is part of.\n   * @observable\n   * @api\n   */\n  getMap() {\n    return (\n      /** @type {import(\"./PluggableMap.js\").default|undefined} */ (this.get(Property.MAP))\n    );\n  }\n\n  /**\n   * Get the offset of this overlay.\n   * @return {Array<number>} The offset.\n   * @observable\n   * @api\n   */\n  getOffset() {\n    return /** @type {Array<number>} */ (this.get(Property.OFFSET));\n  }\n\n  /**\n   * Get the current position of this overlay.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The spatial point that the overlay is\n   *     anchored at.\n   * @observable\n   * @api\n   */\n  getPosition() {\n    return (\n      /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (this.get(Property.POSITION))\n    );\n  }\n\n  /**\n   * Get the current positioning of this overlay.\n   * @return {OverlayPositioning} How the overlay is positioned\n   *     relative to its point on the map.\n   * @observable\n   * @api\n   */\n  getPositioning() {\n    return (\n      /** @type {OverlayPositioning} */ (this.get(Property.POSITIONING))\n    );\n  }\n\n  /**\n   * @protected\n   */\n  handleElementChanged() {\n    removeChildren(this.element);\n    const element = this.getElement();\n    if (element) {\n      this.element.appendChild(element);\n    }\n  }\n\n  /**\n   * @protected\n   */\n  handleMapChanged() {\n    if (this.mapPostrenderListenerKey) {\n      removeNode(this.element);\n      unlistenByKey(this.mapPostrenderListenerKey);\n      this.mapPostrenderListenerKey = null;\n    }\n    const map = this.getMap();\n    if (map) {\n      this.mapPostrenderListenerKey = listen(map,\n        MapEventType.POSTRENDER, this.render, this);\n      this.updatePixelPosition();\n      const container = this.stopEvent ?\n        map.getOverlayContainerStopEvent() : map.getOverlayContainer();\n      if (this.insertFirst) {\n        container.insertBefore(this.element, container.childNodes[0] || null);\n      } else {\n        container.appendChild(this.element);\n      }\n    }\n  }\n\n  /**\n   * @protected\n   */\n  render() {\n    this.updatePixelPosition();\n  }\n\n  /**\n   * @protected\n   */\n  handleOffsetChanged() {\n    this.updatePixelPosition();\n  }\n\n  /**\n   * @protected\n   */\n  handlePositionChanged() {\n    this.updatePixelPosition();\n    if (this.get(Property.POSITION) && this.autoPan) {\n      this.panIntoView();\n    }\n  }\n\n  /**\n   * @protected\n   */\n  handlePositioningChanged() {\n    this.updatePixelPosition();\n  }\n\n  /**\n   * Set the DOM element to be associated with this overlay.\n   * @param {HTMLElement|undefined} element The Element containing the overlay.\n   * @observable\n   * @api\n   */\n  setElement(element) {\n    this.set(Property.ELEMENT, element);\n  }\n\n  /**\n   * Set the map to be associated with this overlay.\n   * @param {import(\"./PluggableMap.js\").default|undefined} map The map that the\n   * overlay is part of.\n   * @observable\n   * @api\n   */\n  setMap(map) {\n    this.set(Property.MAP, map);\n  }\n\n  /**\n   * Set the offset for this overlay.\n   * @param {Array<number>} offset Offset.\n   * @observable\n   * @api\n   */\n  setOffset(offset) {\n    this.set(Property.OFFSET, offset);\n  }\n\n  /**\n   * Set the position for this overlay. If the position is `undefined` the\n   * overlay is hidden.\n   * @param {import(\"./coordinate.js\").Coordinate|undefined} position The spatial point that the overlay\n   *     is anchored at.\n   * @observable\n   * @api\n   */\n  setPosition(position) {\n    this.set(Property.POSITION, position);\n  }\n\n  /**\n   * Pan the map so that the overlay is entirely visible in the current viewport\n   * (if necessary).\n   * @protected\n   */\n  panIntoView() {\n    const map = this.getMap();\n\n    if (!map || !map.getTargetElement()) {\n      return;\n    }\n\n    const mapRect = this.getRect(map.getTargetElement(), map.getSize());\n    const element = this.getElement();\n    const overlayRect = this.getRect(element, [outerWidth(element), outerHeight(element)]);\n\n    const margin = this.autoPanMargin;\n    if (!containsExtent(mapRect, overlayRect)) {\n      // the overlay is not completely inside the viewport, so pan the map\n      const offsetLeft = overlayRect[0] - mapRect[0];\n      const offsetRight = mapRect[2] - overlayRect[2];\n      const offsetTop = overlayRect[1] - mapRect[1];\n      const offsetBottom = mapRect[3] - overlayRect[3];\n\n      const delta = [0, 0];\n      if (offsetLeft < 0) {\n        // move map to the left\n        delta[0] = offsetLeft - margin;\n      } else if (offsetRight < 0) {\n        // move map to the right\n        delta[0] = Math.abs(offsetRight) + margin;\n      }\n      if (offsetTop < 0) {\n        // move map up\n        delta[1] = offsetTop - margin;\n      } else if (offsetBottom < 0) {\n        // move map down\n        delta[1] = Math.abs(offsetBottom) + margin;\n      }\n\n      if (delta[0] !== 0 || delta[1] !== 0) {\n        const center = /** @type {import(\"./coordinate.js\").Coordinate} */ (map.getView().getCenterInternal());\n        const centerPx = map.getPixelFromCoordinateInternal(center);\n        const newCenterPx = [\n          centerPx[0] + delta[0],\n          centerPx[1] + delta[1]\n        ];\n\n        map.getView().animateInternal({\n          center: map.getCoordinateFromPixelInternal(newCenterPx),\n          duration: this.autoPanAnimation.duration,\n          easing: this.autoPanAnimation.easing\n        });\n      }\n    }\n  }\n\n  /**\n   * Get the extent of an element relative to the document\n   * @param {HTMLElement} element The element.\n   * @param {import(\"./size.js\").Size} size The size of the element.\n   * @return {import(\"./extent.js\").Extent} The extent.\n   * @protected\n   */\n  getRect(element, size) {\n    const box = element.getBoundingClientRect();\n    const offsetX = box.left + window.pageXOffset;\n    const offsetY = box.top + window.pageYOffset;\n    return [\n      offsetX,\n      offsetY,\n      offsetX + size[0],\n      offsetY + size[1]\n    ];\n  }\n\n  /**\n   * Set the positioning for this overlay.\n   * @param {OverlayPositioning} positioning how the overlay is\n   *     positioned relative to its point on the map.\n   * @observable\n   * @api\n   */\n  setPositioning(positioning) {\n    this.set(Property.POSITIONING, positioning);\n  }\n\n  /**\n   * Modify the visibility of the element.\n   * @param {boolean} visible Element visibility.\n   * @protected\n   */\n  setVisible(visible) {\n    if (this.rendered.visible !== visible) {\n      this.element.style.display = visible ? '' : 'none';\n      this.rendered.visible = visible;\n    }\n  }\n\n  /**\n   * Update pixel position.\n   * @protected\n   */\n  updatePixelPosition() {\n    const map = this.getMap();\n    const position = this.getPosition();\n    if (!map || !map.isRendered() || !position) {\n      this.setVisible(false);\n      return;\n    }\n\n    const pixel = map.getPixelFromCoordinate(position);\n    const mapSize = map.getSize();\n    this.updateRenderedPosition(pixel, mapSize);\n  }\n\n  /**\n   * @param {import(\"./pixel.js\").Pixel} pixel The pixel location.\n   * @param {import(\"./size.js\").Size|undefined} mapSize The map size.\n   * @protected\n   */\n  updateRenderedPosition(pixel, mapSize) {\n    const style = this.element.style;\n    const offset = this.getOffset();\n\n    const positioning = this.getPositioning();\n\n    this.setVisible(true);\n\n    let offsetX = offset[0];\n    let offsetY = offset[1];\n    if (positioning == OverlayPositioning.BOTTOM_RIGHT ||\n        positioning == OverlayPositioning.CENTER_RIGHT ||\n        positioning == OverlayPositioning.TOP_RIGHT) {\n      if (this.rendered.left_ !== '') {\n        this.rendered.left_ = style.left = '';\n      }\n      const right = Math.round(mapSize[0] - pixel[0] - offsetX) + 'px';\n      if (this.rendered.right_ != right) {\n        this.rendered.right_ = style.right = right;\n      }\n    } else {\n      if (this.rendered.right_ !== '') {\n        this.rendered.right_ = style.right = '';\n      }\n      if (positioning == OverlayPositioning.BOTTOM_CENTER ||\n          positioning == OverlayPositioning.CENTER_CENTER ||\n          positioning == OverlayPositioning.TOP_CENTER) {\n        offsetX -= this.element.offsetWidth / 2;\n      }\n      const left = Math.round(pixel[0] + offsetX) + 'px';\n      if (this.rendered.left_ != left) {\n        this.rendered.left_ = style.left = left;\n      }\n    }\n    if (positioning == OverlayPositioning.BOTTOM_LEFT ||\n        positioning == OverlayPositioning.BOTTOM_CENTER ||\n        positioning == OverlayPositioning.BOTTOM_RIGHT) {\n      if (this.rendered.top_ !== '') {\n        this.rendered.top_ = style.top = '';\n      }\n      const bottom = Math.round(mapSize[1] - pixel[1] - offsetY) + 'px';\n      if (this.rendered.bottom_ != bottom) {\n        this.rendered.bottom_ = style.bottom = bottom;\n      }\n    } else {\n      if (this.rendered.bottom_ !== '') {\n        this.rendered.bottom_ = style.bottom = '';\n      }\n      if (positioning == OverlayPositioning.CENTER_LEFT ||\n          positioning == OverlayPositioning.CENTER_CENTER ||\n          positioning == OverlayPositioning.CENTER_RIGHT) {\n        offsetY -= this.element.offsetHeight / 2;\n      }\n      const top = Math.round(pixel[1] + offsetY) + 'px';\n      if (this.rendered.top_ != top) {\n        this.rendered.top_ = style.top = top;\n      }\n    }\n  }\n\n  /**\n   * returns the options this Overlay has been created with\n   * @return {Options} overlay options\n   */\n  getOptions() {\n    return this.options;\n  }\n}\n\n\nexport default Overlay;\n","/**\n * @module ol/geom/flat/transform\n */\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {import(\"../../transform.js\").Transform} transform Transform.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function transform2D(flatCoordinates, offset, end, stride, transform, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const x = flatCoordinates[j];\n    const y = flatCoordinates[j + 1];\n    dest[i++] = transform[0] * x + transform[2] * y + transform[4];\n    dest[i++] = transform[1] * x + transform[3] * y + transform[5];\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} angle Angle.\n * @param {Array<number>} anchor Rotation anchor point.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function rotate(flatCoordinates, offset, end, stride, angle, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const cos = Math.cos(angle);\n  const sin = Math.sin(angle);\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + deltaX * cos - deltaY * sin;\n    dest[i++] = anchorY + deltaX * sin + deltaY * cos;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * Scale the coordinates.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} sx Scale factor in the x-direction.\n * @param {number} sy Scale factor in the y-direction.\n * @param {Array<number>} anchor Scale anchor point.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function scale(flatCoordinates, offset, end, stride, sx, sy, anchor, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  const anchorX = anchor[0];\n  const anchorY = anchor[1];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    const deltaX = flatCoordinates[j] - anchorX;\n    const deltaY = flatCoordinates[j + 1] - anchorY;\n    dest[i++] = anchorX + sx * deltaX;\n    dest[i++] = anchorY + sy * deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} deltaX Delta X.\n * @param {number} deltaY Delta Y.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Transformed coordinates.\n */\nexport function translate(flatCoordinates, offset, end, stride, deltaX, deltaY, opt_dest) {\n  const dest = opt_dest ? opt_dest : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    dest[i++] = flatCoordinates[j] + deltaX;\n    dest[i++] = flatCoordinates[j + 1] + deltaY;\n    for (let k = j + 2; k < j + stride; ++k) {\n      dest[i++] = flatCoordinates[k];\n    }\n  }\n  if (opt_dest && dest.length != i) {\n    dest.length = i;\n  }\n  return dest;\n}\n","/**\n * @module ol/extent/Relationship\n */\n\n/**\n * Relationship to an extent.\n * @enum {number}\n */\nexport default {\n  UNKNOWN: 0,\n  INTERSECTING: 1,\n  ABOVE: 2,\n  RIGHT: 4,\n  BELOW: 8,\n  LEFT: 16\n};\n","/**\n * @module ol/geom/MultiPolygon\n */\nimport {extend} from '../array.js';\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from './GeometryLayout.js';\nimport GeometryType from './GeometryType.js';\nimport MultiPoint from './MultiPoint.js';\nimport Polygon from './Polygon.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {linearRingss as linearRingssArea} from './flat/area.js';\nimport {linearRingss as linearRingssCenter} from './flat/center.js';\nimport {assignClosestMultiArrayPoint, multiArrayMaxSquaredDelta} from './flat/closest.js';\nimport {linearRingssContainsXY} from './flat/contains.js';\nimport {deflateMultiCoordinatesArray} from './flat/deflate.js';\nimport {inflateMultiCoordinatesArray} from './flat/inflate.js';\nimport {getInteriorPointsOfMultiArray} from './flat/interiorpoint.js';\nimport {intersectsLinearRingMultiArray} from './flat/intersectsextent.js';\nimport {linearRingssAreOriented, orientLinearRingsArray} from './flat/orient.js';\nimport {quantizeMultiArray} from './flat/simplify.js';\n\n/**\n * @classdesc\n * Multi-polygon geometry.\n *\n * @api\n */\nclass MultiPolygon extends SimpleGeometry {\n\n  /**\n   * @param {Array<Array<Array<import(\"../coordinate.js\").Coordinate>>|Polygon>|Array<number>} coordinates Coordinates.\n   *     For internal use, flat coordinates in combination with `opt_layout` and `opt_endss` are also accepted.\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @param {Array<Array<number>>=} opt_endss Array of ends for internal use with flat coordinates.\n   */\n  constructor(coordinates, opt_layout, opt_endss) {\n\n    super();\n\n    /**\n     * @type {Array<Array<number>>}\n     * @private\n     */\n    this.endss_ = [];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.flatInteriorPointsRevision_ = -1;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatInteriorPoints_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDelta_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDeltaRevision_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.orientedRevision_ = -1;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.orientedFlatCoordinates_ = null;\n\n    if (!opt_endss && !Array.isArray(coordinates[0])) {\n      let layout = this.getLayout();\n      const polygons = /** @type {Array<Polygon>} */ (coordinates);\n      const flatCoordinates = [];\n      const endss = [];\n      for (let i = 0, ii = polygons.length; i < ii; ++i) {\n        const polygon = polygons[i];\n        if (i === 0) {\n          layout = polygon.getLayout();\n        }\n        const offset = flatCoordinates.length;\n        const ends = polygon.getEnds();\n        for (let j = 0, jj = ends.length; j < jj; ++j) {\n          ends[j] += offset;\n        }\n        extend(flatCoordinates, polygon.getFlatCoordinates());\n        endss.push(ends);\n      }\n      opt_layout = layout;\n      coordinates = flatCoordinates;\n      opt_endss = endss;\n    }\n    if (opt_layout !== undefined && opt_endss) {\n      this.setFlatCoordinates(opt_layout, /** @type {Array<number>} */ (coordinates));\n      this.endss_ = opt_endss;\n    } else {\n      this.setCoordinates(/** @type {Array<Array<Array<import(\"../coordinate.js\").Coordinate>>>} */ (coordinates),\n        opt_layout);\n    }\n\n  }\n\n  /**\n   * Append the passed polygon to this multipolygon.\n   * @param {Polygon} polygon Polygon.\n   * @api\n   */\n  appendPolygon(polygon) {\n    /** @type {Array<number>} */\n    let ends;\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = polygon.getFlatCoordinates().slice();\n      ends = polygon.getEnds().slice();\n      this.endss_.push();\n    } else {\n      const offset = this.flatCoordinates.length;\n      extend(this.flatCoordinates, polygon.getFlatCoordinates());\n      ends = polygon.getEnds().slice();\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        ends[i] += offset;\n      }\n    }\n    this.endss_.push(ends);\n    this.changed();\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!MultiPolygon} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    const len = this.endss_.length;\n    const newEndss = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      newEndss[i] = this.endss_[i].slice();\n    }\n\n    return new MultiPolygon(\n      this.flatCoordinates.slice(), this.layout, newEndss);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    if (this.maxDeltaRevision_ != this.getRevision()) {\n      this.maxDelta_ = Math.sqrt(multiArrayMaxSquaredDelta(\n        this.flatCoordinates, 0, this.endss_, this.stride, 0));\n      this.maxDeltaRevision_ = this.getRevision();\n    }\n    return assignClosestMultiArrayPoint(\n      this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n      this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  containsXY(x, y) {\n    return linearRingssContainsXY(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, x, y);\n  }\n\n  /**\n   * Return the area of the multipolygon on projected plane.\n   * @return {number} Area (on projected plane).\n   * @api\n   */\n  getArea() {\n    return linearRingssArea(this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride);\n  }\n\n  /**\n   * Get the coordinate array for this geometry.  This array has the structure\n   * of a GeoJSON coordinate array for multi-polygons.\n   *\n   * @param {boolean=} opt_right Orient coordinates according to the right-hand\n   *     rule (counter-clockwise for exterior and clockwise for interior rings).\n   *     If `false`, coordinates will be oriented according to the left-hand rule\n   *     (clockwise for exterior and counter-clockwise for interior rings).\n   *     By default, coordinate orientation will depend on how the geometry was\n   *     constructed.\n   * @return {Array<Array<Array<import(\"../coordinate.js\").Coordinate>>>} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates(opt_right) {\n    let flatCoordinates;\n    if (opt_right !== undefined) {\n      flatCoordinates = this.getOrientedFlatCoordinates().slice();\n      orientLinearRingsArray(\n        flatCoordinates, 0, this.endss_, this.stride, opt_right);\n    } else {\n      flatCoordinates = this.flatCoordinates;\n    }\n\n    return inflateMultiCoordinatesArray(\n      flatCoordinates, 0, this.endss_, this.stride);\n  }\n\n  /**\n   * @return {Array<Array<number>>} Endss.\n   */\n  getEndss() {\n    return this.endss_;\n  }\n\n  /**\n   * @return {Array<number>} Flat interior points.\n   */\n  getFlatInteriorPoints() {\n    if (this.flatInteriorPointsRevision_ != this.getRevision()) {\n      const flatCenters = linearRingssCenter(\n        this.flatCoordinates, 0, this.endss_, this.stride);\n      this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n        this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride,\n        flatCenters);\n      this.flatInteriorPointsRevision_ = this.getRevision();\n    }\n    return this.flatInteriorPoints_;\n  }\n\n  /**\n   * Return the interior points as {@link module:ol/geom/MultiPoint multipoint}.\n   * @return {MultiPoint} Interior points as XYM coordinates, where M is\n   * the length of the horizontal intersection that the point belongs to.\n   * @api\n   */\n  getInteriorPoints() {\n    return new MultiPoint(this.getFlatInteriorPoints().slice(), GeometryLayout.XYM);\n  }\n\n  /**\n   * @return {Array<number>} Oriented flat coordinates.\n   */\n  getOrientedFlatCoordinates() {\n    if (this.orientedRevision_ != this.getRevision()) {\n      const flatCoordinates = this.flatCoordinates;\n      if (linearRingssAreOriented(\n        flatCoordinates, 0, this.endss_, this.stride)) {\n        this.orientedFlatCoordinates_ = flatCoordinates;\n      } else {\n        this.orientedFlatCoordinates_ = flatCoordinates.slice();\n        this.orientedFlatCoordinates_.length =\n            orientLinearRingsArray(\n              this.orientedFlatCoordinates_, 0, this.endss_, this.stride);\n      }\n      this.orientedRevision_ = this.getRevision();\n    }\n    return this.orientedFlatCoordinates_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometryInternal(squaredTolerance) {\n    const simplifiedFlatCoordinates = [];\n    const simplifiedEndss = [];\n    simplifiedFlatCoordinates.length = quantizeMultiArray(\n      this.flatCoordinates, 0, this.endss_, this.stride,\n      Math.sqrt(squaredTolerance),\n      simplifiedFlatCoordinates, 0, simplifiedEndss);\n    return new MultiPolygon(simplifiedFlatCoordinates, GeometryLayout.XY, simplifiedEndss);\n  }\n\n  /**\n   * Return the polygon at the specified index.\n   * @param {number} index Index.\n   * @return {Polygon} Polygon.\n   * @api\n   */\n  getPolygon(index) {\n    if (index < 0 || this.endss_.length <= index) {\n      return null;\n    }\n    let offset;\n    if (index === 0) {\n      offset = 0;\n    } else {\n      const prevEnds = this.endss_[index - 1];\n      offset = prevEnds[prevEnds.length - 1];\n    }\n    const ends = this.endss_[index].slice();\n    const end = ends[ends.length - 1];\n    if (offset !== 0) {\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        ends[i] -= offset;\n      }\n    }\n    return new Polygon(this.flatCoordinates.slice(offset, end), this.layout, ends);\n  }\n\n  /**\n   * Return the polygons of this multipolygon.\n   * @return {Array<Polygon>} Polygons.\n   * @api\n   */\n  getPolygons() {\n    const layout = this.layout;\n    const flatCoordinates = this.flatCoordinates;\n    const endss = this.endss_;\n    const polygons = [];\n    let offset = 0;\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      const ends = endss[i].slice();\n      const end = ends[ends.length - 1];\n      if (offset !== 0) {\n        for (let j = 0, jj = ends.length; j < jj; ++j) {\n          ends[j] -= offset;\n        }\n      }\n      const polygon = new Polygon(flatCoordinates.slice(offset, end), layout, ends);\n      polygons.push(polygon);\n      offset = end;\n    }\n    return polygons;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.MULTI_POLYGON;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    return intersectsLinearRingMultiArray(\n      this.getOrientedFlatCoordinates(), 0, this.endss_, this.stride, extent);\n  }\n\n  /**\n   * Set the coordinates of the multipolygon.\n   * @param {!Array<Array<Array<import(\"../coordinate.js\").Coordinate>>>} coordinates Coordinates.\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @override\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 3);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    const endss = deflateMultiCoordinatesArray(\n      this.flatCoordinates, 0, coordinates, this.stride, this.endss_);\n    if (endss.length === 0) {\n      this.flatCoordinates.length = 0;\n    } else {\n      const lastEnds = endss[endss.length - 1];\n      this.flatCoordinates.length = lastEnds.length === 0 ?\n        0 : lastEnds[lastEnds.length - 1];\n    }\n    this.changed();\n  }\n}\n\n\nexport default MultiPolygon;\n","/**\n * @module ol/reproj/Tile\n */\nimport {ERROR_THRESHOLD} from './common.js';\n\nimport Tile from '../Tile.js';\nimport TileState from '../TileState.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getArea, getCenter, getIntersection} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {calculateSourceResolution, render as renderReprojected} from '../reproj.js';\nimport Triangulation from './Triangulation.js';\n\n\n/**\n * @typedef {function(number, number, number, number) : import(\"../Tile.js\").default} FunctionType\n */\n\n\n/**\n * @classdesc\n * Class encapsulating single reprojected tile.\n * See {@link module:ol/source/TileImage~TileImage}.\n *\n */\nclass ReprojTile extends Tile {\n  /**\n   * @param {import(\"../proj/Projection.js\").default} sourceProj Source projection.\n   * @param {import(\"../tilegrid/TileGrid.js\").default} sourceTileGrid Source tile grid.\n   * @param {import(\"../proj/Projection.js\").default} targetProj Target projection.\n   * @param {import(\"../tilegrid/TileGrid.js\").default} targetTileGrid Target tile grid.\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Coordinate of the tile.\n   * @param {import(\"../tilecoord.js\").TileCoord} wrappedTileCoord Coordinate of the tile wrapped in X.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {number} gutter Gutter of the source tiles.\n   * @param {FunctionType} getTileFunction\n   *     Function returning source tiles (z, x, y, pixelRatio).\n   * @param {number=} opt_errorThreshold Acceptable reprojection error (in px).\n   * @param {boolean=} opt_renderEdges Render reprojection edges.\n   */\n  constructor(\n    sourceProj,\n    sourceTileGrid,\n    targetProj,\n    targetTileGrid,\n    tileCoord,\n    wrappedTileCoord,\n    pixelRatio,\n    gutter,\n    getTileFunction,\n    opt_errorThreshold,\n    opt_renderEdges\n  ) {\n    super(tileCoord, TileState.IDLE);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderEdges_ = opt_renderEdges !== undefined ? opt_renderEdges : false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.gutter_ = gutter;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.sourceTileGrid_ = sourceTileGrid;\n\n    /**\n     * @private\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.targetTileGrid_ = targetTileGrid;\n\n    /**\n     * @private\n     * @type {import(\"../tilecoord.js\").TileCoord}\n     */\n    this.wrappedTileCoord_ = wrappedTileCoord ? wrappedTileCoord : tileCoord;\n\n    /**\n     * @private\n     * @type {!Array<import(\"../Tile.js\").default>}\n     */\n    this.sourceTiles_ = [];\n\n    /**\n     * @private\n     * @type {?Array<import(\"../events.js\").EventsKey>}\n     */\n    this.sourcesListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.sourceZ_ = 0;\n\n    const targetExtent = targetTileGrid.getTileCoordExtent(this.wrappedTileCoord_);\n    const maxTargetExtent = this.targetTileGrid_.getExtent();\n    let maxSourceExtent = this.sourceTileGrid_.getExtent();\n\n    const limitedTargetExtent = maxTargetExtent ?\n      getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n    if (getArea(limitedTargetExtent) === 0) {\n      // Tile is completely outside range -> EMPTY\n      // TODO: is it actually correct that the source even creates the tile ?\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    const sourceProjExtent = sourceProj.getExtent();\n    if (sourceProjExtent) {\n      if (!maxSourceExtent) {\n        maxSourceExtent = sourceProjExtent;\n      } else {\n        maxSourceExtent = getIntersection(maxSourceExtent, sourceProjExtent);\n      }\n    }\n\n    const targetResolution = targetTileGrid.getResolution(\n      this.wrappedTileCoord_[0]);\n\n    const targetCenter = getCenter(limitedTargetExtent);\n    const sourceResolution = calculateSourceResolution(\n      sourceProj, targetProj, targetCenter, targetResolution);\n\n    if (!isFinite(sourceResolution) || sourceResolution <= 0) {\n      // invalid sourceResolution -> EMPTY\n      // probably edges of the projections when no extent is defined\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    const errorThresholdInPixels = opt_errorThreshold !== undefined ?\n      opt_errorThreshold : ERROR_THRESHOLD;\n\n    /**\n     * @private\n     * @type {!import(\"./Triangulation.js\").default}\n     */\n    this.triangulation_ = new Triangulation(\n      sourceProj, targetProj, limitedTargetExtent, maxSourceExtent,\n      sourceResolution * errorThresholdInPixels);\n\n    if (this.triangulation_.getTriangles().length === 0) {\n      // no valid triangles -> EMPTY\n      this.state = TileState.EMPTY;\n      return;\n    }\n\n    this.sourceZ_ = sourceTileGrid.getZForResolution(sourceResolution);\n    let sourceExtent = this.triangulation_.calculateSourceExtent();\n\n    if (maxSourceExtent) {\n      if (sourceProj.canWrapX()) {\n        sourceExtent[1] = clamp(\n          sourceExtent[1], maxSourceExtent[1], maxSourceExtent[3]);\n        sourceExtent[3] = clamp(\n          sourceExtent[3], maxSourceExtent[1], maxSourceExtent[3]);\n      } else {\n        sourceExtent = getIntersection(sourceExtent, maxSourceExtent);\n      }\n    }\n\n    if (!getArea(sourceExtent)) {\n      this.state = TileState.EMPTY;\n    } else {\n      const sourceRange = sourceTileGrid.getTileRangeForExtentAndZ(\n        sourceExtent, this.sourceZ_);\n\n      for (let srcX = sourceRange.minX; srcX <= sourceRange.maxX; srcX++) {\n        for (let srcY = sourceRange.minY; srcY <= sourceRange.maxY; srcY++) {\n          const tile = getTileFunction(this.sourceZ_, srcX, srcY, pixelRatio);\n          if (tile) {\n            this.sourceTiles_.push(tile);\n          }\n        }\n      }\n\n      if (this.sourceTiles_.length === 0) {\n        this.state = TileState.EMPTY;\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    if (this.state == TileState.LOADING) {\n      this.unlistenSources_();\n    }\n    super.disposeInternal();\n  }\n\n  /**\n   * Get the HTML Canvas element for this tile.\n   * @return {HTMLCanvasElement} Canvas.\n   */\n  getImage() {\n    return this.canvas_;\n  }\n\n  /**\n   * @private\n   */\n  reproject_() {\n    const sources = [];\n    this.sourceTiles_.forEach(function(tile, i, arr) {\n      if (tile && tile.getState() == TileState.LOADED) {\n        sources.push({\n          extent: this.sourceTileGrid_.getTileCoordExtent(tile.tileCoord),\n          image: tile.getImage()\n        });\n      }\n    }.bind(this));\n    this.sourceTiles_.length = 0;\n\n    if (sources.length === 0) {\n      this.state = TileState.ERROR;\n    } else {\n      const z = this.wrappedTileCoord_[0];\n      const size = this.targetTileGrid_.getTileSize(z);\n      const width = typeof size === 'number' ? size : size[0];\n      const height = typeof size === 'number' ? size : size[1];\n      const targetResolution = this.targetTileGrid_.getResolution(z);\n      const sourceResolution = this.sourceTileGrid_.getResolution(this.sourceZ_);\n\n      const targetExtent = this.targetTileGrid_.getTileCoordExtent(\n        this.wrappedTileCoord_);\n      this.canvas_ = renderReprojected(width, height, this.pixelRatio_,\n        sourceResolution, this.sourceTileGrid_.getExtent(),\n        targetResolution, targetExtent, this.triangulation_, sources,\n        this.gutter_, this.renderEdges_);\n\n      this.state = TileState.LOADED;\n    }\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  load() {\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n\n      let leftToLoad = 0;\n\n      this.sourcesListenerKeys_ = [];\n      this.sourceTiles_.forEach(function(tile, i, arr) {\n        const state = tile.getState();\n        if (state == TileState.IDLE || state == TileState.LOADING) {\n          leftToLoad++;\n\n          const sourceListenKey = listen(tile, EventType.CHANGE,\n            function(e) {\n              const state = tile.getState();\n              if (state == TileState.LOADED ||\n                    state == TileState.ERROR ||\n                    state == TileState.EMPTY) {\n                unlistenByKey(sourceListenKey);\n                leftToLoad--;\n                if (leftToLoad === 0) {\n                  this.unlistenSources_();\n                  this.reproject_();\n                }\n              }\n            }, this);\n          this.sourcesListenerKeys_.push(sourceListenKey);\n        }\n      }.bind(this));\n\n      this.sourceTiles_.forEach(function(tile, i, arr) {\n        const state = tile.getState();\n        if (state == TileState.IDLE) {\n          tile.load();\n        }\n      });\n\n      if (leftToLoad === 0) {\n        setTimeout(this.reproject_.bind(this), 0);\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  unlistenSources_() {\n    this.sourcesListenerKeys_.forEach(unlistenByKey);\n    this.sourcesListenerKeys_ = null;\n  }\n}\n\n\nexport default ReprojTile;\n","/**\n * @module ol/source/TileImage\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../reproj/common.js';\nimport {getUid} from '../util.js';\nimport ImageTile from '../ImageTile.js';\nimport TileCache from '../TileCache.js';\nimport TileState from '../TileState.js';\nimport EventType from '../events/EventType.js';\nimport {equivalent, get as getProjection} from '../proj.js';\nimport ReprojTile from '../reproj/Tile.js';\nimport UrlTile from './UrlTile.js';\nimport {getKey, getKeyZXY} from '../tilecoord.js';\nimport {getForProjection as getTileGridForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"./State.js\").default} [state] Source state.\n * @property {typeof import(\"../ImageTile.js\").default} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service. For example, if the tile\n * service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {import(\"../Tile.js\").UrlFunction} [tileUrlFunction] Optional function to get tile URL given a tile coordinate and the projection.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {Array<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX] Whether to wrap the world horizontally. The default, is to\n * request out-of-bounds tiles from the server. When set to `false`, only one\n * world will be rendered. When set to `true`, tiles will be requested for one\n * world only, but they will be wrapped horizontally to render multiple worlds.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {string} [key] Optional tile key for proper cache fetching\n * @property {number} [zDirection=0] Indicate which resolution should be used\n * by a renderer if the view resolution does not match any resolution of the tile source.\n * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n * will be used. If -1, the nearest higher resolution will be used.\n */\n\n\n/**\n * @classdesc\n * Base class for sources providing images divided into a tile grid.\n *\n * @fires import(\"./Tile.js\").TileSourceEvent\n * @api\n */\nclass TileImage extends UrlTile {\n  /**\n   * @param {!Options} options Image tile options.\n   */\n  constructor(options) {\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      opaque: options.opaque,\n      projection: options.projection,\n      state: options.state,\n      tileGrid: options.tileGrid,\n      tileLoadFunction: options.tileLoadFunction ?\n        options.tileLoadFunction : defaultTileLoadFunction,\n      tilePixelRatio: options.tilePixelRatio,\n      tileUrlFunction: options.tileUrlFunction,\n      url: options.url,\n      urls: options.urls,\n      wrapX: options.wrapX,\n      transition: options.transition,\n      key: options.key,\n      attributionsCollapsible: options.attributionsCollapsible,\n      zDirection: options.zDirection\n    });\n\n    /**\n     * @protected\n     * @type {?string}\n     */\n    this.crossOrigin =\n        options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n    /**\n     * @protected\n     * @type {typeof ImageTile}\n     */\n    this.tileClass = options.tileClass !== undefined ?\n      options.tileClass : ImageTile;\n\n    /**\n     * @protected\n     * @type {!Object<string, TileCache>}\n     */\n    this.tileCacheForProjection = {};\n\n    /**\n     * @protected\n     * @type {!Object<string, import(\"../tilegrid/TileGrid.js\").default>}\n     */\n    this.tileGridForProjection = {};\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.reprojectionErrorThreshold_ = options.reprojectionErrorThreshold;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderReprojectionEdges_ = false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  canExpireCache() {\n    if (!ENABLE_RASTER_REPROJECTION) {\n      return super.canExpireCache();\n    }\n    if (this.tileCache.canExpireCache()) {\n      return true;\n    } else {\n      for (const key in this.tileCacheForProjection) {\n        if (this.tileCacheForProjection[key].canExpireCache()) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  expireCache(projection, usedTiles) {\n    if (!ENABLE_RASTER_REPROJECTION) {\n      super.expireCache(projection, usedTiles);\n      return;\n    }\n    const usedTileCache = this.getTileCacheForProjection(projection);\n\n    this.tileCache.expireCache(this.tileCache == usedTileCache ? usedTiles : {});\n    for (const id in this.tileCacheForProjection) {\n      const tileCache = this.tileCacheForProjection[id];\n      tileCache.expireCache(tileCache == usedTileCache ? usedTiles : {});\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getGutterForProjection(projection) {\n    if (ENABLE_RASTER_REPROJECTION &&\n        this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {\n      return 0;\n    } else {\n      return this.getGutter();\n    }\n  }\n\n  /**\n   * @return {number} Gutter.\n   */\n  getGutter() {\n    return 0;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getOpaque(projection) {\n    if (ENABLE_RASTER_REPROJECTION &&\n        this.getProjection() && projection && !equivalent(this.getProjection(), projection)) {\n      return false;\n    } else {\n      return super.getOpaque(projection);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTileGridForProjection(projection) {\n    if (!ENABLE_RASTER_REPROJECTION) {\n      return super.getTileGridForProjection(projection);\n    }\n    const thisProj = this.getProjection();\n    if (this.tileGrid && (!thisProj || equivalent(thisProj, projection))) {\n      return this.tileGrid;\n    } else {\n      const projKey = getUid(projection);\n      if (!(projKey in this.tileGridForProjection)) {\n        this.tileGridForProjection[projKey] = getTileGridForProjection(projection);\n      }\n      return (\n        /** @type {!import(\"../tilegrid/TileGrid.js\").default} */ (this.tileGridForProjection[projKey])\n      );\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTileCacheForProjection(projection) {\n    if (!ENABLE_RASTER_REPROJECTION) {\n      return super.getTileCacheForProjection(projection);\n    }\n    const thisProj = this.getProjection(); if (!thisProj || equivalent(thisProj, projection)) {\n      return this.tileCache;\n    } else {\n      const projKey = getUid(projection);\n      if (!(projKey in this.tileCacheForProjection)) {\n        this.tileCacheForProjection[projKey] = new TileCache(this.tileCache.highWaterMark);\n      }\n      return this.tileCacheForProjection[projKey];\n    }\n  }\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {string} key The key set on the tile.\n   * @return {!import(\"../Tile.js\").default} Tile.\n   * @private\n   */\n  createTile_(z, x, y, pixelRatio, projection, key) {\n    const tileCoord = [z, x, y];\n    const urlTileCoord = this.getTileCoordForTileUrlFunction(\n      tileCoord, projection);\n    const tileUrl = urlTileCoord ?\n      this.tileUrlFunction(urlTileCoord, pixelRatio, projection) : undefined;\n    const tile = new this.tileClass(\n      tileCoord,\n      tileUrl !== undefined ? TileState.IDLE : TileState.EMPTY,\n      tileUrl !== undefined ? tileUrl : '',\n      this.crossOrigin,\n      this.tileLoadFunction,\n      this.tileOptions);\n    tile.key = key;\n    tile.addEventListener(EventType.CHANGE, this.handleTileChange.bind(this));\n    return tile;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTile(z, x, y, pixelRatio, projection) {\n    const sourceProjection = /** @type {!import(\"../proj/Projection.js\").default} */ (this.getProjection());\n    if (!ENABLE_RASTER_REPROJECTION ||\n        !sourceProjection || !projection || equivalent(sourceProjection, projection)) {\n      return this.getTileInternal(z, x, y, pixelRatio, sourceProjection || projection);\n    } else {\n      const cache = this.getTileCacheForProjection(projection);\n      const tileCoord = [z, x, y];\n      let tile;\n      const tileCoordKey = getKey(tileCoord);\n      if (cache.containsKey(tileCoordKey)) {\n        tile = /** @type {!import(\"../Tile.js\").default} */ (cache.get(tileCoordKey));\n      }\n      const key = this.getKey();\n      if (tile && tile.key == key) {\n        return tile;\n      } else {\n        const sourceTileGrid = this.getTileGridForProjection(sourceProjection);\n        const targetTileGrid = this.getTileGridForProjection(projection);\n        const wrappedTileCoord =\n            this.getTileCoordForTileUrlFunction(tileCoord, projection);\n        const newTile = new ReprojTile(\n          sourceProjection, sourceTileGrid,\n          projection, targetTileGrid,\n          tileCoord, wrappedTileCoord, this.getTilePixelRatio(pixelRatio),\n          this.getGutter(),\n          function(z, x, y, pixelRatio) {\n            return this.getTileInternal(z, x, y, pixelRatio, sourceProjection);\n          }.bind(this), this.reprojectionErrorThreshold_,\n          this.renderReprojectionEdges_);\n        newTile.key = key;\n\n        if (tile) {\n          newTile.interimTile = tile;\n          newTile.refreshInterimChain();\n          cache.replace(tileCoordKey, newTile);\n        } else {\n          cache.set(tileCoordKey, newTile);\n        }\n        return newTile;\n      }\n    }\n  }\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {!import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {!import(\"../Tile.js\").default} Tile.\n   * @protected\n   */\n  getTileInternal(z, x, y, pixelRatio, projection) {\n    let tile = null;\n    const tileCoordKey = getKeyZXY(z, x, y);\n    const key = this.getKey();\n    if (!this.tileCache.containsKey(tileCoordKey)) {\n      tile = this.createTile_(z, x, y, pixelRatio, projection, key);\n      this.tileCache.set(tileCoordKey, tile);\n    } else {\n      tile = this.tileCache.get(tileCoordKey);\n      if (tile.key != key) {\n        // The source's params changed. If the tile has an interim tile and if we\n        // can use it then we use it. Otherwise we create a new tile.  In both\n        // cases we attempt to assign an interim tile to the new tile.\n        const interimTile = tile;\n        tile = this.createTile_(z, x, y, pixelRatio, projection, key);\n\n        //make the new tile the head of the list,\n        if (interimTile.getState() == TileState.IDLE) {\n          //the old tile hasn't begun loading yet, and is now outdated, so we can simply discard it\n          tile.interimTile = interimTile.interimTile;\n        } else {\n          tile.interimTile = interimTile;\n        }\n        tile.refreshInterimChain();\n        this.tileCache.replace(tileCoordKey, tile);\n      }\n    }\n    return tile;\n  }\n\n  /**\n   * Sets whether to render reprojection edges or not (usually for debugging).\n   * @param {boolean} render Render the edges.\n   * @api\n   */\n  setRenderReprojectionEdges(render) {\n    if (!ENABLE_RASTER_REPROJECTION ||\n        this.renderReprojectionEdges_ == render) {\n      return;\n    }\n    this.renderReprojectionEdges_ = render;\n    for (const id in this.tileCacheForProjection) {\n      this.tileCacheForProjection[id].clear();\n    }\n    this.changed();\n  }\n\n  /**\n   * Sets the tile grid to use when reprojecting the tiles to the given\n   * projection instead of the default tile grid for the projection.\n   *\n   * This can be useful when the default tile grid cannot be created\n   * (e.g. projection has no extent defined) or\n   * for optimization reasons (custom tile size, resolutions, ...).\n   *\n   * @param {import(\"../proj.js\").ProjectionLike} projection Projection.\n   * @param {import(\"../tilegrid/TileGrid.js\").default} tilegrid Tile grid to use for the projection.\n   * @api\n   */\n  setTileGridForProjection(projection, tilegrid) {\n    if (ENABLE_RASTER_REPROJECTION) {\n      const proj = getProjection(projection);\n      if (proj) {\n        const projKey = getUid(proj);\n        if (!(projKey in this.tileGridForProjection)) {\n          this.tileGridForProjection[projKey] = tilegrid;\n        }\n      }\n    }\n  }\n}\n\n\n/**\n * @param {ImageTile} imageTile Image tile.\n * @param {string} src Source.\n */\nfunction defaultTileLoadFunction(imageTile, src) {\n  /** @type {HTMLImageElement|HTMLVideoElement} */ (imageTile.getImage()).src = src;\n}\n\nexport default TileImage;\n","/**\n * @module ol/tileurlfunction\n */\nimport {assert} from './asserts.js';\nimport {modulo} from './math.js';\nimport {hash as tileCoordHash} from './tilecoord.js';\n\n\n/**\n * @param {string} template Template.\n * @param {import(\"./tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n * @return {import(\"./Tile.js\").UrlFunction} Tile URL function.\n */\nexport function createFromTemplate(template, tileGrid) {\n  const zRegEx = /\\{z\\}/g;\n  const xRegEx = /\\{x\\}/g;\n  const yRegEx = /\\{y\\}/g;\n  const dashYRegEx = /\\{-y\\}/g;\n  return (\n    /**\n     * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"./proj/Projection.js\").default} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        return template.replace(zRegEx, tileCoord[0].toString())\n          .replace(xRegEx, tileCoord[1].toString())\n          .replace(yRegEx, tileCoord[2].toString())\n          .replace(dashYRegEx, function() {\n            const z = tileCoord[0];\n            const range = tileGrid.getFullTileRange(z);\n            assert(range, 55); // The {-y} placeholder requires a tile grid with extent\n            const y = range.getHeight() - tileCoord[2] - 1;\n            return y.toString();\n          });\n      }\n    }\n  );\n}\n\n\n/**\n * @param {Array<string>} templates Templates.\n * @param {import(\"./tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n * @return {import(\"./Tile.js\").UrlFunction} Tile URL function.\n */\nexport function createFromTemplates(templates, tileGrid) {\n  const len = templates.length;\n  const tileUrlFunctions = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    tileUrlFunctions[i] = createFromTemplate(templates[i], tileGrid);\n  }\n  return createFromTileUrlFunctions(tileUrlFunctions);\n}\n\n\n/**\n * @param {Array<import(\"./Tile.js\").UrlFunction>} tileUrlFunctions Tile URL Functions.\n * @return {import(\"./Tile.js\").UrlFunction} Tile URL function.\n */\nexport function createFromTileUrlFunctions(tileUrlFunctions) {\n  if (tileUrlFunctions.length === 1) {\n    return tileUrlFunctions[0];\n  }\n  return (\n    /**\n     * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile Coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"./proj/Projection.js\").default} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        const h = tileCoordHash(tileCoord);\n        const index = modulo(h, tileUrlFunctions.length);\n        return tileUrlFunctions[index](tileCoord, pixelRatio, projection);\n      }\n    }\n  );\n}\n\n\n/**\n * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n * @param {number} pixelRatio Pixel ratio.\n * @param {import(\"./proj/Projection.js\").default} projection Projection.\n * @return {string|undefined} Tile URL.\n */\nexport function nullTileUrlFunction(tileCoord, pixelRatio, projection) {\n  return undefined;\n}\n\n\n/**\n * @param {string} url URL.\n * @return {Array<string>} Array of urls.\n */\nexport function expandUrl(url) {\n  const urls = [];\n  let match = /\\{([a-z])-([a-z])\\}/.exec(url);\n  if (match) {\n    // char range\n    const startCharCode = match[1].charCodeAt(0);\n    const stopCharCode = match[2].charCodeAt(0);\n    let charCode;\n    for (charCode = startCharCode; charCode <= stopCharCode; ++charCode) {\n      urls.push(url.replace(match[0], String.fromCharCode(charCode)));\n    }\n    return urls;\n  }\n  match = match = /\\{(\\d+)-(\\d+)\\}/.exec(url);\n  if (match) {\n    // number range\n    const stop = parseInt(match[2], 10);\n    for (let i = parseInt(match[1], 10); i <= stop; i++) {\n      urls.push(url.replace(match[0], i.toString()));\n    }\n    return urls;\n  }\n  urls.push(url);\n  return urls;\n}\n","/**\n * @module ol/geom/flat/deflate\n */\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinate(flatCoordinates, offset, coordinate, stride) {\n  for (let i = 0, ii = coordinate.length; i < ii; ++i) {\n    flatCoordinates[offset++] = coordinate[i];\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<import(\"../../coordinate.js\").Coordinate>} coordinates Coordinates.\n * @param {number} stride Stride.\n * @return {number} offset Offset.\n */\nexport function deflateCoordinates(flatCoordinates, offset, coordinates, stride) {\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    const coordinate = coordinates[i];\n    for (let j = 0; j < stride; ++j) {\n      flatCoordinates[offset++] = coordinate[j];\n    }\n  }\n  return offset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<import(\"../../coordinate.js\").Coordinate>>} coordinatess Coordinatess.\n * @param {number} stride Stride.\n * @param {Array<number>=} opt_ends Ends.\n * @return {Array<number>} Ends.\n */\nexport function deflateCoordinatesArray(flatCoordinates, offset, coordinatess, stride, opt_ends) {\n  const ends = opt_ends ? opt_ends : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatess.length; j < jj; ++j) {\n    const end = deflateCoordinates(\n      flatCoordinates, offset, coordinatess[j], stride);\n    ends[i++] = end;\n    offset = end;\n  }\n  ends.length = i;\n  return ends;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<Array<import(\"../../coordinate.js\").Coordinate>>>} coordinatesss Coordinatesss.\n * @param {number} stride Stride.\n * @param {Array<Array<number>>=} opt_endss Endss.\n * @return {Array<Array<number>>} Endss.\n */\nexport function deflateMultiCoordinatesArray(flatCoordinates, offset, coordinatesss, stride, opt_endss) {\n  const endss = opt_endss ? opt_endss : [];\n  let i = 0;\n  for (let j = 0, jj = coordinatesss.length; j < jj; ++j) {\n    const ends = deflateCoordinatesArray(\n      flatCoordinates, offset, coordinatesss[j], stride, endss[i]);\n    endss[i++] = ends;\n    offset = ends[ends.length - 1];\n  }\n  endss.length = i;\n  return endss;\n}\n","/**\n * @module ol/layer/Layer\n */\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport BaseLayer from './Base.js';\nimport LayerProperty from './Property.js';\nimport {assign} from '../obj.js';\nimport RenderEventType from '../render/EventType.js';\nimport SourceState from '../source/State.js';\n\n/**\n * @typedef {function(import(\"../PluggableMap.js\").FrameState):HTMLElement} RenderFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {import(\"../source/Source.js\").default} [source] Source for this layer.  If not provided to the constructor,\n * the source can be set by calling {@link module:ol/layer/Layer#setSource layer.setSource(source)} after\n * construction.\n * @property {import(\"../PluggableMap.js\").default} [map] Map.\n * @property {RenderFunction} [render] Render function. Takes the frame state as input and is expected to return an\n * HTML element. Will overwrite the default rendering for the layer.\n */\n\n\n/**\n * @typedef {Object} State\n * @property {import(\"./Base.js\").default} layer\n * @property {number} opacity Opacity, the value is rounded to two digits to appear after the decimal point.\n * @property {SourceState} sourceState\n * @property {boolean} visible\n * @property {boolean} managed\n * @property {boolean} hasOverlay Set by the renderer when an overlay for points and text is used.\n * @property {import(\"../extent.js\").Extent} [extent]\n * @property {number} zIndex\n * @property {number} maxResolution\n * @property {number} minResolution\n * @property {number} minZoom\n * @property {number} maxZoom\n */\n\n/**\n * @classdesc\n * Base class from which all layer types are derived. This should only be instantiated\n * in the case where a custom layer is be added to the map with a custom `render` function.\n * Such a function can be specified in the `options` object, and is expected to return an HTML element.\n *\n * A visual representation of raster or vector map data.\n * Layers group together those properties that pertain to how the data is to be\n * displayed, irrespective of the source of that data.\n *\n * Layers are usually added to a map with {@link module:ol/Map#addLayer}. Components\n * like {@link module:ol/interaction/Select~Select} use unmanaged layers\n * internally. These unmanaged layers are associated with the map using\n * {@link module:ol/layer/Layer~Layer#setMap} instead.\n *\n * A generic `change` event is fired when the state of the source changes.\n *\n * Please note that for performance reasons several layers might get rendered to\n * the same HTML element, which will cause {@link module:ol/Map~Map#forEachLayerAtPixel} to\n * give false positives. To avoid this, apply different `className` properties to the\n * layers at creation time.\n *\n * @fires import(\"../render/Event.js\").RenderEvent#prerender\n * @fires import(\"../render/Event.js\").RenderEvent#postrender\n *\n * @template {import(\"../source/Source.js\").default} SourceType\n * @api\n */\nclass Layer extends BaseLayer {\n  /**\n   * @param {Options} options Layer options.\n   */\n  constructor(options) {\n\n    const baseOptions = assign({}, options);\n    delete baseOptions.source;\n\n    super(baseOptions);\n\n    /**\n     * @private\n     * @type {?import(\"../events.js\").EventsKey}\n     */\n    this.mapPrecomposeKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../events.js\").EventsKey}\n     */\n    this.mapRenderKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../events.js\").EventsKey}\n     */\n    this.sourceChangeKey_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../renderer/Layer.js\").default}\n     */\n    this.renderer_ = null;\n\n    // Overwrite default render method with a custom one\n    if (options.render) {\n      this.render = options.render;\n    }\n\n    if (options.map) {\n      this.setMap(options.map);\n    }\n\n    this.addEventListener(getChangeEventType(LayerProperty.SOURCE), this.handleSourcePropertyChange_);\n\n    const source = options.source ? /** @type {SourceType} */ (options.source) : null;\n    this.setSource(source);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getLayersArray(opt_array) {\n    const array = opt_array ? opt_array : [];\n    array.push(this);\n    return array;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getLayerStatesArray(opt_states) {\n    const states = opt_states ? opt_states : [];\n    states.push(this.getLayerState());\n    return states;\n  }\n\n  /**\n   * Get the layer source.\n   * @return {SourceType} The layer source (or `null` if not yet set).\n   * @observable\n   * @api\n   */\n  getSource() {\n    return /** @type {SourceType} */ (this.get(LayerProperty.SOURCE)) || null;\n  }\n\n  /**\n    * @inheritDoc\n    */\n  getSourceState() {\n    const source = this.getSource();\n    return !source ? SourceState.UNDEFINED : source.getState();\n  }\n\n  /**\n   * @private\n   */\n  handleSourceChange_() {\n    this.changed();\n  }\n\n  /**\n   * @private\n   */\n  handleSourcePropertyChange_() {\n    if (this.sourceChangeKey_) {\n      unlistenByKey(this.sourceChangeKey_);\n      this.sourceChangeKey_ = null;\n    }\n    const source = this.getSource();\n    if (source) {\n      this.sourceChangeKey_ = listen(source,\n        EventType.CHANGE, this.handleSourceChange_, this);\n    }\n    this.changed();\n  }\n\n  /**\n   * In charge to manage the rendering of the layer. One layer type is\n   * bounded with one layer renderer.\n   * @param {?import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {HTMLElement} target Target which the renderer may (but need not) use\n   * for rendering its content.\n   * @return {HTMLElement} The rendered element.\n   */\n  render(frameState, target) {\n    const layerRenderer = this.getRenderer();\n\n    if (layerRenderer.prepareFrame(frameState)) {\n      return layerRenderer.renderFrame(frameState, target);\n    }\n  }\n\n  /**\n   * Sets the layer to be rendered on top of other layers on a map. The map will\n   * not manage this layer in its layers collection, and the callback in\n   * {@link module:ol/Map#forEachLayerAtPixel} will receive `null` as layer. This\n   * is useful for temporary layers. To remove an unmanaged layer from the map,\n   * use `#setMap(null)`.\n   *\n   * To add the layer to a map and have it managed by the map, use\n   * {@link module:ol/Map#addLayer} instead.\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   * @api\n   */\n  setMap(map) {\n    if (this.mapPrecomposeKey_) {\n      unlistenByKey(this.mapPrecomposeKey_);\n      this.mapPrecomposeKey_ = null;\n    }\n    if (!map) {\n      this.changed();\n    }\n    if (this.mapRenderKey_) {\n      unlistenByKey(this.mapRenderKey_);\n      this.mapRenderKey_ = null;\n    }\n    if (map) {\n      this.mapPrecomposeKey_ = listen(map, RenderEventType.PRECOMPOSE, function(evt) {\n        const renderEvent = /** @type {import(\"../render/Event.js\").default} */ (evt);\n        renderEvent.frameState.layerStatesArray.push(this.getLayerState(false));\n      }, this);\n      this.mapRenderKey_ = listen(this, EventType.CHANGE, map.render, map);\n      this.changed();\n    }\n  }\n\n  /**\n   * Set the layer source.\n   * @param {SourceType} source The layer source.\n   * @observable\n   * @api\n   */\n  setSource(source) {\n    this.set(LayerProperty.SOURCE, source);\n  }\n\n  /**\n   * Get the renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} The layer renderer.\n   */\n  getRenderer() {\n    if (!this.renderer_) {\n      this.renderer_ = this.createRenderer();\n    }\n    return this.renderer_;\n  }\n\n  /**\n   * @return {boolean} The layer has a renderer.\n   */\n  hasRenderer() {\n    return !!this.renderer_;\n  }\n\n  /**\n   * Create a renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n   * @protected\n   */\n  createRenderer() {\n    return null;\n  }\n\n}\n\n\n/**\n * Return `true` if the layer is visible and if the provided view state\n * has resolution and zoom levels that are in range of the layer's min/max.\n * @param {State} layerState Layer state.\n * @param {import(\"../View.js\").State} viewState View state.\n * @return {boolean} The layer is visible at the given view state.\n */\nexport function inView(layerState, viewState) {\n  if (!layerState.visible) {\n    return false;\n  }\n  const resolution = viewState.resolution;\n  if (resolution < layerState.minResolution || resolution >= layerState.maxResolution) {\n    return false;\n  }\n  const zoom = viewState.zoom;\n  return zoom > layerState.minZoom && zoom <= layerState.maxZoom;\n}\n\nexport default Layer;\n","/**\n * @module ol/geom/flat/inflate\n */\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {Array<import(\"../../coordinate.js\").Coordinate>=} opt_coordinates Coordinates.\n * @return {Array<import(\"../../coordinate.js\").Coordinate>} Coordinates.\n */\nexport function inflateCoordinates(flatCoordinates, offset, end, stride, opt_coordinates) {\n  const coordinates = opt_coordinates !== undefined ? opt_coordinates : [];\n  let i = 0;\n  for (let j = offset; j < end; j += stride) {\n    coordinates[i++] = flatCoordinates.slice(j, j + stride);\n  }\n  coordinates.length = i;\n  return coordinates;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array<Array<import(\"../../coordinate.js\").Coordinate>>=} opt_coordinatess Coordinatess.\n * @return {Array<Array<import(\"../../coordinate.js\").Coordinate>>} Coordinatess.\n */\nexport function inflateCoordinatesArray(flatCoordinates, offset, ends, stride, opt_coordinatess) {\n  const coordinatess = opt_coordinatess !== undefined ? opt_coordinatess : [];\n  let i = 0;\n  for (let j = 0, jj = ends.length; j < jj; ++j) {\n    const end = ends[j];\n    coordinatess[i++] = inflateCoordinates(\n      flatCoordinates, offset, end, stride, coordinatess[i]);\n    offset = end;\n  }\n  coordinatess.length = i;\n  return coordinatess;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array<Array<Array<import(\"../../coordinate.js\").Coordinate>>>=} opt_coordinatesss\n *     Coordinatesss.\n * @return {Array<Array<Array<import(\"../../coordinate.js\").Coordinate>>>} Coordinatesss.\n */\nexport function inflateMultiCoordinatesArray(flatCoordinates, offset, endss, stride, opt_coordinatesss) {\n  const coordinatesss = opt_coordinatesss !== undefined ? opt_coordinatesss : [];\n  let i = 0;\n  for (let j = 0, jj = endss.length; j < jj; ++j) {\n    const ends = endss[j];\n    coordinatesss[i++] = inflateCoordinatesArray(\n      flatCoordinates, offset, ends, stride, coordinatesss[i]);\n    offset = ends[ends.length - 1];\n  }\n  coordinatesss.length = i;\n  return coordinatesss;\n}\n","/**\n * @module ol/tilegrid/TileGrid\n */\nimport {DEFAULT_TILE_SIZE} from './common.js';\nimport {assert} from '../asserts.js';\nimport TileRange, {createOrUpdate as createOrUpdateTileRange} from '../TileRange.js';\nimport {isSorted, linearFindNearest} from '../array.js';\nimport {createOrUpdate, getTopLeft} from '../extent.js';\nimport {clamp} from '../math.js';\nimport {toSize} from '../size.js';\nimport {createOrUpdate as createOrUpdateTileCoord} from '../tilecoord.js';\n\n\n/**\n * @private\n * @type {import(\"../tilecoord.js\").TileCoord}\n */\nconst tmpTileCoord = [0, 0, 0];\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../extent.js\").Extent} [extent] Extent for the tile grid. No tiles outside this\n * extent will be requested by {@link module:ol/source/Tile} sources. When no `origin` or\n * `origins` are configured, the `origin` will be set to the top-left corner of the extent.\n * @property {number} [minZoom=0] Minimum zoom.\n * @property {import(\"../coordinate.js\").Coordinate} [origin] The tile grid origin, i.e. where the `x`\n * and `y` axes meet (`[z, 0, 0]`). Tile coordinates increase left to right and upwards. If not\n * specified, `extent` or `origins` must be provided.\n * @property {Array<import(\"../coordinate.js\").Coordinate>} [origins] Tile grid origins, i.e. where\n * the `x` and `y` axes meet (`[z, 0, 0]`), for each zoom level. If given, the array length\n * should match the length of the `resolutions` array, i.e. each resolution can have a different\n * origin. Tile coordinates increase left to right and upwards. If not specified, `extent` or\n * `origin` must be provided.\n * @property {!Array<number>} resolutions Resolutions. The array index of each resolution needs\n * to match the zoom level. This means that even if a `minZoom` is configured, the resolutions\n * array will have a length of `maxZoom + 1`.\n * @property {Array<import(\"../size.js\").Size>} [sizes] Sizes.\n * @property {number|import(\"../size.js\").Size} [tileSize] Tile size.\n * Default is `[256, 256]`.\n * @property {Array<import(\"../size.js\").Size>} [tileSizes] Tile sizes. If given, the array length\n * should match the length of the `resolutions` array, i.e. each resolution can have a different\n * tile size.\n */\n\n\n/**\n * @classdesc\n * Base class for setting the grid pattern for sources accessing tiled-image\n * servers.\n * @api\n */\nclass TileGrid {\n  /**\n   * @param {Options} options Tile grid options.\n   */\n  constructor(options) {\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.minZoom = options.minZoom !== undefined ? options.minZoom : 0;\n\n    /**\n     * @private\n     * @type {!Array<number>}\n     */\n    this.resolutions_ = options.resolutions;\n    assert(isSorted(this.resolutions_, function(a, b) {\n      return b - a;\n    }, true), 17); // `resolutions` must be sorted in descending order\n\n\n    // check if we've got a consistent zoom factor and origin\n    let zoomFactor;\n    if (!options.origins) {\n      for (let i = 0, ii = this.resolutions_.length - 1; i < ii; ++i) {\n        if (!zoomFactor) {\n          zoomFactor = this.resolutions_[i] / this.resolutions_[i + 1];\n        } else {\n          if (this.resolutions_[i] / this.resolutions_[i + 1] !== zoomFactor) {\n            zoomFactor = undefined;\n            break;\n          }\n        }\n      }\n    }\n\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.zoomFactor_ = zoomFactor;\n\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.maxZoom = this.resolutions_.length - 1;\n\n    /**\n     * @private\n     * @type {import(\"../coordinate.js\").Coordinate}\n     */\n    this.origin_ = options.origin !== undefined ? options.origin : null;\n\n    /**\n     * @private\n     * @type {Array<import(\"../coordinate.js\").Coordinate>}\n     */\n    this.origins_ = null;\n    if (options.origins !== undefined) {\n      this.origins_ = options.origins;\n      assert(this.origins_.length == this.resolutions_.length,\n        20); // Number of `origins` and `resolutions` must be equal\n    }\n\n    const extent = options.extent;\n\n    if (extent !== undefined &&\n        !this.origin_ && !this.origins_) {\n      this.origin_ = getTopLeft(extent);\n    }\n\n    assert(\n      (!this.origin_ && this.origins_) || (this.origin_ && !this.origins_),\n      18); // Either `origin` or `origins` must be configured, never both\n\n    /**\n     * @private\n     * @type {Array<number|import(\"../size.js\").Size>}\n     */\n    this.tileSizes_ = null;\n    if (options.tileSizes !== undefined) {\n      this.tileSizes_ = options.tileSizes;\n      assert(this.tileSizes_.length == this.resolutions_.length,\n        19); // Number of `tileSizes` and `resolutions` must be equal\n    }\n\n    /**\n     * @private\n     * @type {number|import(\"../size.js\").Size}\n     */\n    this.tileSize_ = options.tileSize !== undefined ?\n      options.tileSize :\n      !this.tileSizes_ ? DEFAULT_TILE_SIZE : null;\n    assert(\n      (!this.tileSize_ && this.tileSizes_) ||\n        (this.tileSize_ && !this.tileSizes_),\n      22); // Either `tileSize` or `tileSizes` must be configured, never both\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.extent_ = extent !== undefined ? extent : null;\n\n\n    /**\n     * @private\n     * @type {Array<import(\"../TileRange.js\").default>}\n     */\n    this.fullTileRanges_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.tmpSize_ = [0, 0];\n\n    if (options.sizes !== undefined) {\n      this.fullTileRanges_ = options.sizes.map(function(size, z) {\n        const tileRange = new TileRange(\n          Math.min(0, size[0]), Math.max(size[0] - 1, -1),\n          Math.min(0, size[1]), Math.max(size[1] - 1, -1));\n        return tileRange;\n      }, this);\n    } else if (extent) {\n      this.calculateTileRanges_(extent);\n    }\n\n  }\n\n  /**\n   * Call a function with each tile coordinate for a given extent and zoom level.\n   *\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} zoom Integer zoom level.\n   * @param {function(import(\"../tilecoord.js\").TileCoord): void} callback Function called with each tile coordinate.\n   * @api\n   */\n  forEachTileCoord(extent, zoom, callback) {\n    const tileRange = this.getTileRangeForExtentAndZ(extent, zoom);\n    for (let i = tileRange.minX, ii = tileRange.maxX; i <= ii; ++i) {\n      for (let j = tileRange.minY, jj = tileRange.maxY; j <= jj; ++j) {\n        callback([zoom, i, j]);\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {function(number, import(\"../TileRange.js\").default): boolean} callback Callback.\n   * @param {import(\"../TileRange.js\").default=} opt_tileRange Temporary import(\"../TileRange.js\").default object.\n   * @param {import(\"../extent.js\").Extent=} opt_extent Temporary import(\"../extent.js\").Extent object.\n   * @return {boolean} Callback succeeded.\n   */\n  forEachTileCoordParentTileRange(tileCoord, callback, opt_tileRange, opt_extent) {\n    let tileRange, x, y;\n    let tileCoordExtent = null;\n    let z = tileCoord[0] - 1;\n    if (this.zoomFactor_ === 2) {\n      x = tileCoord[1];\n      y = tileCoord[2];\n    } else {\n      tileCoordExtent = this.getTileCoordExtent(tileCoord, opt_extent);\n    }\n    while (z >= this.minZoom) {\n      if (this.zoomFactor_ === 2) {\n        x = Math.floor(x / 2);\n        y = Math.floor(y / 2);\n        tileRange = createOrUpdateTileRange(x, x, y, y, opt_tileRange);\n      } else {\n        tileRange = this.getTileRangeForExtentAndZ(tileCoordExtent, z, opt_tileRange);\n      }\n      if (callback(z, tileRange)) {\n        return true;\n      }\n      --z;\n    }\n    return false;\n  }\n\n  /**\n   * Get the extent for this tile grid, if it was configured.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getExtent() {\n    return this.extent_;\n  }\n\n  /**\n   * Get the maximum zoom level for the grid.\n   * @return {number} Max zoom.\n   * @api\n   */\n  getMaxZoom() {\n    return this.maxZoom;\n  }\n\n  /**\n   * Get the minimum zoom level for the grid.\n   * @return {number} Min zoom.\n   * @api\n   */\n  getMinZoom() {\n    return this.minZoom;\n  }\n\n  /**\n   * Get the origin for the grid at the given zoom level.\n   * @param {number} z Integer zoom level.\n   * @return {import(\"../coordinate.js\").Coordinate} Origin.\n   * @api\n   */\n  getOrigin(z) {\n    if (this.origin_) {\n      return this.origin_;\n    } else {\n      return this.origins_[z];\n    }\n  }\n\n  /**\n   * Get the resolution for the given zoom level.\n   * @param {number} z Integer zoom level.\n   * @return {number} Resolution.\n   * @api\n   */\n  getResolution(z) {\n    return this.resolutions_[z];\n  }\n\n  /**\n   * Get the list of resolutions for the tile grid.\n   * @return {Array<number>} Resolutions.\n   * @api\n   */\n  getResolutions() {\n    return this.resolutions_;\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"../TileRange.js\").default=} opt_tileRange Temporary import(\"../TileRange.js\").default object.\n   * @param {import(\"../extent.js\").Extent=} opt_extent Temporary import(\"../extent.js\").Extent object.\n   * @return {import(\"../TileRange.js\").default} Tile range.\n   */\n  getTileCoordChildTileRange(tileCoord, opt_tileRange, opt_extent) {\n    if (tileCoord[0] < this.maxZoom) {\n      if (this.zoomFactor_ === 2) {\n        const minX = tileCoord[1] * 2;\n        const minY = tileCoord[2] * 2;\n        return createOrUpdateTileRange(minX, minX + 1, minY, minY + 1, opt_tileRange);\n      }\n      const tileCoordExtent = this.getTileCoordExtent(tileCoord, opt_extent);\n      return this.getTileRangeForExtentAndZ(\n        tileCoordExtent, tileCoord[0] + 1, opt_tileRange);\n    }\n    return null;\n  }\n\n  /**\n   * Get the extent for a tile range.\n   * @param {number} z Integer zoom level.\n   * @param {import(\"../TileRange.js\").default} tileRange Tile range.\n   * @param {import(\"../extent.js\").Extent=} opt_extent Temporary import(\"../extent.js\").Extent object.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   */\n  getTileRangeExtent(z, tileRange, opt_extent) {\n    const origin = this.getOrigin(z);\n    const resolution = this.getResolution(z);\n    const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n    const minX = origin[0] + tileRange.minX * tileSize[0] * resolution;\n    const maxX = origin[0] + (tileRange.maxX + 1) * tileSize[0] * resolution;\n    const minY = origin[1] + tileRange.minY * tileSize[1] * resolution;\n    const maxY = origin[1] + (tileRange.maxY + 1) * tileSize[1] * resolution;\n    return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n  }\n\n  /**\n   * Get a tile range for the given extent and integer zoom level.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} z Integer zoom level.\n   * @param {import(\"../TileRange.js\").default=} opt_tileRange Temporary tile range object.\n   * @return {import(\"../TileRange.js\").default} Tile range.\n   */\n  getTileRangeForExtentAndZ(extent, z, opt_tileRange) {\n    const tileCoord = tmpTileCoord;\n    this.getTileCoordForXYAndZ_(extent[0], extent[3], z, false, tileCoord);\n    const minX = tileCoord[1];\n    const minY = tileCoord[2];\n    this.getTileCoordForXYAndZ_(extent[2], extent[1], z, true, tileCoord);\n    return createOrUpdateTileRange(minX, tileCoord[1], minY, tileCoord[2], opt_tileRange);\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @return {import(\"../coordinate.js\").Coordinate} Tile center.\n   */\n  getTileCoordCenter(tileCoord) {\n    const origin = this.getOrigin(tileCoord[0]);\n    const resolution = this.getResolution(tileCoord[0]);\n    const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);\n    return [\n      origin[0] + (tileCoord[1] + 0.5) * tileSize[0] * resolution,\n      origin[1] - (tileCoord[2] + 0.5) * tileSize[1] * resolution\n    ];\n  }\n\n  /**\n   * Get the extent of a tile coordinate.\n   *\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"../extent.js\").Extent=} opt_extent Temporary extent object.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getTileCoordExtent(tileCoord, opt_extent) {\n    const origin = this.getOrigin(tileCoord[0]);\n    const resolution = this.getResolution(tileCoord[0]);\n    const tileSize = toSize(this.getTileSize(tileCoord[0]), this.tmpSize_);\n    const minX = origin[0] + tileCoord[1] * tileSize[0] * resolution;\n    const minY = origin[1] - (tileCoord[2] + 1) * tileSize[1] * resolution;\n    const maxX = minX + tileSize[0] * resolution;\n    const maxY = minY + tileSize[1] * resolution;\n    return createOrUpdate(minX, minY, maxX, maxY, opt_extent);\n  }\n\n  /**\n   * Get the tile coordinate for the given map coordinate and resolution.  This\n   * method considers that coordinates that intersect tile boundaries should be\n   * assigned the higher tile coordinate.\n   *\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {number} resolution Resolution.\n   * @param {import(\"../tilecoord.js\").TileCoord=} opt_tileCoord Destination import(\"../tilecoord.js\").TileCoord object.\n   * @return {import(\"../tilecoord.js\").TileCoord} Tile coordinate.\n   * @api\n   */\n  getTileCoordForCoordAndResolution(coordinate, resolution, opt_tileCoord) {\n    return this.getTileCoordForXYAndResolution_(\n      coordinate[0], coordinate[1], resolution, false, opt_tileCoord);\n  }\n\n  /**\n   * Note that this method should not be called for resolutions that correspond\n   * to an integer zoom level.  Instead call the `getTileCoordForXYAndZ_` method.\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @param {number} resolution Resolution (for a non-integer zoom level).\n   * @param {boolean} reverseIntersectionPolicy Instead of letting edge\n   *     intersections go to the higher tile coordinate, let edge intersections\n   *     go to the lower tile coordinate.\n   * @param {import(\"../tilecoord.js\").TileCoord=} opt_tileCoord Temporary import(\"../tilecoord.js\").TileCoord object.\n   * @return {import(\"../tilecoord.js\").TileCoord} Tile coordinate.\n   * @private\n   */\n  getTileCoordForXYAndResolution_(x, y, resolution, reverseIntersectionPolicy, opt_tileCoord) {\n    const z = this.getZForResolution(resolution);\n    const scale = resolution / this.getResolution(z);\n    const origin = this.getOrigin(z);\n    const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n\n    const adjustX = reverseIntersectionPolicy ? 0.5 : 0;\n    const adjustY = reverseIntersectionPolicy ? 0.5 : 0;\n    const xFromOrigin = Math.floor((x - origin[0]) / resolution + adjustX);\n    const yFromOrigin = Math.floor((origin[1] - y) / resolution + adjustY);\n    let tileCoordX = scale * xFromOrigin / tileSize[0];\n    let tileCoordY = scale * yFromOrigin / tileSize[1];\n\n    if (reverseIntersectionPolicy) {\n      tileCoordX = Math.ceil(tileCoordX) - 1;\n      tileCoordY = Math.ceil(tileCoordY) - 1;\n    } else {\n      tileCoordX = Math.floor(tileCoordX);\n      tileCoordY = Math.floor(tileCoordY);\n    }\n\n    return createOrUpdateTileCoord(z, tileCoordX, tileCoordY, opt_tileCoord);\n  }\n\n  /**\n   * Although there is repetition between this method and `getTileCoordForXYAndResolution_`,\n   * they should have separate implementations.  This method is for integer zoom\n   * levels.  The other method should only be called for resolutions corresponding\n   * to non-integer zoom levels.\n   * @param {number} x Map x coordinate.\n   * @param {number} y Map y coordinate.\n   * @param {number} z Integer zoom level.\n   * @param {boolean} reverseIntersectionPolicy Instead of letting edge\n   *     intersections go to the higher tile coordinate, let edge intersections\n   *     go to the lower tile coordinate.\n   * @param {import(\"../tilecoord.js\").TileCoord=} opt_tileCoord Temporary import(\"../tilecoord.js\").TileCoord object.\n   * @return {import(\"../tilecoord.js\").TileCoord} Tile coordinate.\n   * @private\n   */\n  getTileCoordForXYAndZ_(x, y, z, reverseIntersectionPolicy, opt_tileCoord) {\n    const origin = this.getOrigin(z);\n    const resolution = this.getResolution(z);\n    const tileSize = toSize(this.getTileSize(z), this.tmpSize_);\n\n    const adjustX = reverseIntersectionPolicy ? 0.5 : 0;\n    const adjustY = reverseIntersectionPolicy ? 0.5 : 0;\n    const xFromOrigin = Math.floor((x - origin[0]) / resolution + adjustX);\n    const yFromOrigin = Math.floor((origin[1] - y) / resolution + adjustY);\n    let tileCoordX = xFromOrigin / tileSize[0];\n    let tileCoordY = yFromOrigin / tileSize[1];\n\n    if (reverseIntersectionPolicy) {\n      tileCoordX = Math.ceil(tileCoordX) - 1;\n      tileCoordY = Math.ceil(tileCoordY) - 1;\n    } else {\n      tileCoordX = Math.floor(tileCoordX);\n      tileCoordY = Math.floor(tileCoordY);\n    }\n\n    return createOrUpdateTileCoord(z, tileCoordX, tileCoordY, opt_tileCoord);\n  }\n\n  /**\n   * Get a tile coordinate given a map coordinate and zoom level.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {number} z Zoom level.\n   * @param {import(\"../tilecoord.js\").TileCoord=} opt_tileCoord Destination import(\"../tilecoord.js\").TileCoord object.\n   * @return {import(\"../tilecoord.js\").TileCoord} Tile coordinate.\n   * @api\n   */\n  getTileCoordForCoordAndZ(coordinate, z, opt_tileCoord) {\n    return this.getTileCoordForXYAndZ_(\n      coordinate[0], coordinate[1], z, false, opt_tileCoord);\n  }\n\n  /**\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @return {number} Tile resolution.\n   */\n  getTileCoordResolution(tileCoord) {\n    return this.resolutions_[tileCoord[0]];\n  }\n\n  /**\n   * Get the tile size for a zoom level. The type of the return value matches the\n   * `tileSize` or `tileSizes` that the tile grid was configured with. To always\n   * get an `import(\"../size.js\").Size`, run the result through `import(\"../size.js\").Size.toSize()`.\n   * @param {number} z Z.\n   * @return {number|import(\"../size.js\").Size} Tile size.\n   * @api\n   */\n  getTileSize(z) {\n    if (this.tileSize_) {\n      return this.tileSize_;\n    } else {\n      return this.tileSizes_[z];\n    }\n  }\n\n  /**\n   * @param {number} z Zoom level.\n   * @return {import(\"../TileRange.js\").default} Extent tile range for the specified zoom level.\n   */\n  getFullTileRange(z) {\n    if (!this.fullTileRanges_) {\n      return null;\n    } else {\n      return this.fullTileRanges_[z];\n    }\n  }\n\n  /**\n   * @param {number} resolution Resolution.\n   * @param {number=} opt_direction If 0, the nearest resolution will be used.\n   *     If 1, the nearest lower resolution will be used. If -1, the nearest\n   *     higher resolution will be used. Default is 0.\n   * @return {number} Z.\n   * @api\n   */\n  getZForResolution(resolution, opt_direction) {\n    const z = linearFindNearest(this.resolutions_, resolution, opt_direction || 0);\n    return clamp(z, this.minZoom, this.maxZoom);\n  }\n\n  /**\n   * @param {!import(\"../extent.js\").Extent} extent Extent for this tile grid.\n   * @private\n   */\n  calculateTileRanges_(extent) {\n    const length = this.resolutions_.length;\n    const fullTileRanges = new Array(length);\n    for (let z = this.minZoom; z < length; ++z) {\n      fullTileRanges[z] = this.getTileRangeForExtentAndZ(extent, z);\n    }\n    this.fullTileRanges_ = fullTileRanges;\n  }\n}\n\n\nexport default TileGrid;\n","/**\n * @module ol/reproj/common\n */\n\n/**\n * Default maximum allowed threshold  (in pixels) for reprojection\n * triangulation.\n * @type {number}\n */\nexport const ERROR_THRESHOLD = 0.5;\n\n/**\n * Enable automatic reprojection of raster sources. Default is `true`.\n * TODO: decide if we want to expose this as a build flag or remove it\n * @type {boolean}\n */\nexport const ENABLE_RASTER_REPROJECTION = true;\n","/**\n * Utilities for generating shaders from literal style objects\n * @module ol/webgl/ShaderBuilder\n */\n\nimport {asArray} from '../color.js';\n\n/**\n * Will return the number as a float with a dot separator, which is required by GLSL.\n * @param {number} v Numerical value.\n * @returns {string} The value as string.\n */\nexport function formatNumber(v) {\n  const s = v.toString();\n  return s.indexOf('.') === -1 ? s + '.0' : s;\n}\n\n/**\n * Will return the number array as a float with a dot separator, concatenated with ', '.\n * @param {Array<number>} array Numerical values array.\n * @returns {string} The array as string, e. g.: `1.0, 2.0, 3.0`.\n */\nexport function formatArray(array) {\n  return array.map(formatNumber).join(', ');\n}\n\n/**\n * Will normalize and converts to string a color array compatible with GLSL.\n * @param {Array<number>} colorArray Color in [r, g, b, a] array form, with RGB components in the\n * 0..255 range and the alpha component in the 0..1 range. Note that if the A component is\n * missing, only 3 values will be output.\n * @returns {string} The color components concatenated in `1.0, 1.0, 1.0, 1.0` form.\n */\nexport function formatColor(colorArray) {\n  return colorArray.map(function(c, i) {\n    return i < 3 ? c / 255 : c;\n  }).map(formatNumber).join(', ');\n}\n\n/**\n * @typedef {Object} VaryingDescription\n * @property {string} name Varying name, as will be declared in the header.\n * @property {string} type Varying type, either `float`, `vec2`, `vec4`...\n * @property {string} expression Expression which will be assigned to the varying in the vertex shader, and\n * passed on to the fragment shader.\n */\n\n/**\n * @typedef {Object} ShaderParameters\n * @property {Array<string>} [uniforms] Uniforms; these will be declared in the header (should include the type).\n * @property {Array<string>} [attributes] Attributes; these will be declared in the header (should include the type).\n * @property {Array<VaryingDescription>} [varyings] Varyings with a name, a type and an expression.\n * @property {string} sizeExpression This will be assigned to a `vec2 size` variable.\n * @property {string} offsetExpression This will be assigned to a `vec2 offset` variable.\n * @property {string} colorExpression This will be the value assigned to gl_FragColor\n * @property {string} texCoordExpression This will be the value assigned to the `vec4 v_texCoord` varying.\n * @property {boolean} [rotateWithView=false] Whether symbols should rotate with view\n */\n\n/**\n * Generates a symbol vertex shader from a set of parameters,\n * intended to be used on point geometries.\n *\n * Three uniforms are hardcoded in all shaders: `u_projectionMatrix`, `u_offsetScaleMatrix` and\n * `u_offsetRotateMatrix`.\n *\n * The following attributes are hardcoded and expected to be present in the vertex buffers:\n * `vec2 a_position`, `float a_index` (being the index of the vertex in the quad, 0 to 3).\n *\n * The following varyings are hardcoded and gives the coordinate of the pixel both in the quad on the texture:\n * `vec2 v_quadCoord`, `vec2 v_texCoord`\n *\n * @param {ShaderParameters} parameters Parameters for the shader.\n * @returns {string} The full shader as a string.\n */\nexport function getSymbolVertexShader(parameters) {\n  const offsetMatrix = parameters.rotateWithView ?\n    'u_offsetScaleMatrix * u_offsetRotateMatrix' :\n    'u_offsetScaleMatrix';\n\n  const uniforms = parameters.uniforms || [];\n  const attributes = parameters.attributes || [];\n  const varyings = parameters.varyings || [];\n\n  const body = `precision mediump float;\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n${uniforms.map(function(uniform) {\n    return 'uniform ' + uniform + ';';\n  }).join('\\n')}\nattribute vec2 a_position;\nattribute float a_index;\n${attributes.map(function(attribute) {\n    return 'attribute ' + attribute + ';';\n  }).join('\\n')}\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n${varyings.map(function(varying) {\n    return 'varying ' + varying.type + ' ' + varying.name + ';';\n  }).join('\\n')}\nvoid main(void) {\n  mat4 offsetMatrix = ${offsetMatrix};\n  vec2 size = ${parameters.sizeExpression};\n  vec2 offset = ${parameters.offsetExpression};\n  float offsetX = a_index == 0.0 || a_index == 3.0 ? offset.x - size.x / 2.0 : offset.x + size.x / 2.0;\n  float offsetY = a_index == 0.0 || a_index == 1.0 ? offset.y - size.y / 2.0 : offset.y + size.y / 2.0;\n  vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  vec4 texCoord = ${parameters.texCoordExpression};\n  float u = a_index == 0.0 || a_index == 3.0 ? texCoord.s : texCoord.q;\n  float v = a_index == 2.0 || a_index == 3.0 ? texCoord.t : texCoord.p;\n  v_texCoord = vec2(u, v);\n  u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v = a_index == 2.0 || a_index == 3.0 ? 0.0 : 1.0;\n  v_quadCoord = vec2(u, v);\n${varyings.map(function(varying) {\n    return '  ' + varying.name + ' = ' + varying.expression + ';';\n  }).join('\\n')}\n}`;\n\n  return body;\n}\n\n/**\n * Generates a symbol fragment shader intended to be used on point geometries.\n *\n * Expected the following varyings to be transmitted by the vertex shader:\n * `vec2 v_texCoord`\n *\n * @param {ShaderParameters} parameters Parameters for the shader.\n * @returns {string} The full shader as a string.\n */\nexport function getSymbolFragmentShader(parameters) {\n  const uniforms = parameters.uniforms || [];\n  const varyings = parameters.varyings || [];\n\n  const body = `precision mediump float;\n${uniforms.map(function(uniform) {\n    return 'uniform ' + uniform + ';';\n  }).join('\\n')}\nvarying vec2 v_texCoord;\nvarying vec2 v_quadCoord;\n${varyings.map(function(varying) {\n    return 'varying ' + varying.type + ' ' + varying.name + ';';\n  }).join('\\n')}\nvoid main(void) {\n  gl_FragColor = ${parameters.colorExpression};\n  gl_FragColor.rgb *= gl_FragColor.a;\n}`;\n\n  return body;\n}\n\n/**\n * Base type for values fed to operators; can be a number literal or the output of another operator\n * @typedef {Array<*>|number} OperatorValue\n */\n\n/**\n * Parses the provided expressions and produces a GLSL-compatible assignment string, such as:\n * `['add', ['*', ['get', 'size'], 0.001], 12] => '(a_size * (0.001)) + (12.0)'\n *\n * The following operators can be used:\n * * `['get', 'attributeName']` fetches a feature attribute (it will be prefixed by `a_` in the shader)\n * * `['*', value1, value1]` multiplies value1 by value2\n * * `['+', value1, value1]` adds value1 and value2\n * * `['clamp', value1, value2, value3]` clamps value1 between values2 and value3\n * * `['stretch', value1, value2, value3, value4, value5]` maps value1 from [value2, value3] range to\n *   [value4, value5] range, clamping values along the way\n *\n * Values can either be literals (numbers) or another operator, as they will be evaluated recursively.\n *\n * Also takes in an array where new attributes will be pushed, so that the user of the `parse` function\n * knows which attributes are expected to be available at evaluation time.\n *\n * A prefix must be specified so that the attributes can either be written as `a_name` or `v_name` in\n * the final assignment string.\n *\n * @param {OperatorValue} value Either literal or an operator.\n * @param {Array<string>} attributes Array containing the attribute names prefixed with `a_`; it\n * it passed along recursively\n * @param {string} attributePrefix Prefix added to attribute names in the final output (typically `a_` or `v_`).\n * @returns {string} Assignment string.\n */\nexport function parse(value, attributes, attributePrefix) {\n  const v = value;\n  function p(value) {\n    return parse(value, attributes, attributePrefix);\n  }\n  if (Array.isArray(v)) {\n    switch (v[0]) {\n      case 'get':\n        if (attributes.indexOf(v[1]) === -1) {\n          attributes.push(v[1]);\n        }\n        return attributePrefix + v[1];\n      case '*': return `(${p(v[1])} * ${p(v[2])})`;\n      case '+': return `(${p(v[1])} + ${p(v[2])})`;\n      case 'clamp': return `clamp(${p(v[1])}, ${p(v[2])}, ${p(v[3])})`;\n      case 'stretch': return `(clamp(${p(v[1])}, ${p(v[2])}, ${p(v[3])}) * ((${p(v[5])} - ${p(v[4])}) / (${p(v[3])} - ${p(v[2])})) + ${p(v[4])})`;\n      default: throw new Error('Unrecognized literal style expression: ' + JSON.stringify(value));\n    }\n  } else if (typeof value === 'number') {\n    return formatNumber(value);\n  } else {\n    throw new Error('Invalid value type in expression: ' + JSON.stringify(value));\n  }\n}\n\n/**\n * @typedef {Object} StyleParseResult\n * @property {ShaderParameters} params Symbol shader params.\n * @property {Object.<string,import(\"./Helper\").UniformValue>} uniforms Uniform definitions.\n * @property {Array<import(\"../renderer/webgl/PointsLayer\").CustomAttribute>} attributes Attribute descriptions.\n */\n\n/**\n * Parses a {@link import(\"../style/LiteralStyle\").LiteralSymbolStyle} object and outputs shader parameters to be\n * then fed to {@link getSymbolVertexShader} and {@link getSymbolFragmentShader}.\n *\n * Also returns `uniforms` and `attributes` properties as expected by the\n * {@link module:ol/renderer/webgl/PointsLayer~WebGLPointsLayerRenderer}.\n *\n * @param {import(\"../style/LiteralStyle\").LiteralSymbolStyle} style Symbol style.\n * @returns {StyleParseResult} Result containing shader params, attributes and uniforms.\n */\nexport function parseSymbolStyle(style) {\n  const size = Array.isArray(style.size) && typeof style.size[0] == 'number' ?\n    style.size : [style.size, style.size];\n  const color = (typeof style.color === 'string' ?\n    asArray(style.color).map(function(c, i) {\n      return i < 3 ? c / 255 : c;\n    }) :\n    style.color || [255, 255, 255, 1]);\n  const texCoord = style.textureCoord || [0, 0, 1, 1];\n  const offset = style.offset || [0, 0];\n  const opacity = style.opacity !== undefined ? style.opacity : 1;\n\n  let attributes = [];\n  const varyings = [];\n  function pA(value) {\n    return parse(value, attributes, 'a_');\n  }\n  function pV(value) {\n    return parse(value, varyings, 'v_');\n  }\n\n  let opacityFilter = '1.0';\n  const visibleSize = pV(size[0]);\n  switch (style.symbolType) {\n    case 'square': break;\n    case 'image': break;\n    // taken from https://thebookofshaders.com/07/\n    case 'circle':\n      opacityFilter = `(1.0-smoothstep(1.-4./${visibleSize},1.,dot(v_quadCoord-.5,v_quadCoord-.5)*4.))`;\n      break;\n    case 'triangle':\n      const st = '(v_quadCoord*2.-1.)';\n      const a = `(atan(${st}.x,${st}.y))`;\n      opacityFilter = `(1.0-smoothstep(.5-3./${visibleSize},.5,cos(floor(.5+${a}/2.094395102)*2.094395102-${a})*length(${st})))`;\n      break;\n\n    default: throw new Error('Unexpected symbol type: ' + style.symbolType);\n  }\n\n  /** @type {import('../webgl/ShaderBuilder.js').ShaderParameters} */\n  const params = {\n    uniforms: [],\n    colorExpression: `vec4(${pV(color[0])}, ${pV(color[1])}, ${pV(color[2])}, ${pV(color[3])})` +\n      ` * vec4(1.0, 1.0, 1.0, ${pV(opacity)} * ${opacityFilter})`,\n    sizeExpression: `vec2(${pA(size[0])}, ${pA(size[1])})`,\n    offsetExpression: `vec2(${pA(offset[0])}, ${pA(offset[1])})`,\n    texCoordExpression: `vec4(${pA(texCoord[0])}, ${pA(texCoord[1])}, ${pA(texCoord[2])}, ${pA(texCoord[3])})`,\n    rotateWithView: !!style.rotateWithView\n  };\n\n  attributes = attributes.concat(varyings).filter(function(attrName, index, arr) {\n    return arr.indexOf(attrName) === index;\n  });\n  params.attributes = attributes.map(function(attributeName) {\n    return `float a_${attributeName}`;\n  });\n  params.varyings = varyings.map(function(attributeName) {\n    return {\n      name: `v_${attributeName}`,\n      type: 'float',\n      expression: `a_${attributeName}`\n    };\n  });\n\n  /** @type {Object.<string,import(\"../webgl/Helper\").UniformValue>} */\n  const uniforms = {};\n\n  if (style.symbolType === 'image' && style.src) {\n    const texture = new Image();\n    texture.src = style.src;\n    params.uniforms.push('sampler2D u_texture');\n    params.colorExpression = params.colorExpression +\n      ' * texture2D(u_texture, v_texCoord)';\n    uniforms['u_texture'] = texture;\n  }\n\n  return {\n    params: params,\n    attributes: attributes.map(function(attributeName) {\n      return {\n        name: attributeName,\n        callback: function(feature) {\n          return feature.get(attributeName) || 0;\n        }\n      };\n    }),\n    uniforms: uniforms\n  };\n}\n","/**\n * @module ol/MapProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LAYERGROUP: 'layergroup',\n  SIZE: 'size',\n  TARGET: 'target',\n  VIEW: 'view'\n};\n","/**\n * @module ol/style/IconAnchorUnits\n */\n\n/**\n * Icon anchor units. One of 'fraction', 'pixels'.\n * @enum {string}\n */\nexport default {\n  FRACTION: 'fraction',\n  PIXELS: 'pixels'\n};\n","/**\n * @module ol/OverlayPositioning\n */\n\n/**\n * Overlay position: `'bottom-left'`, `'bottom-center'`,  `'bottom-right'`,\n * `'center-left'`, `'center-center'`, `'center-right'`, `'top-left'`,\n * `'top-center'`, `'top-right'`\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_CENTER: 'bottom-center',\n  BOTTOM_RIGHT: 'bottom-right',\n  CENTER_LEFT: 'center-left',\n  CENTER_CENTER: 'center-center',\n  CENTER_RIGHT: 'center-right',\n  TOP_LEFT: 'top-left',\n  TOP_CENTER: 'top-center',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/style/IconImage\n */\n\nimport {createCanvasContext2D} from '../dom.js';\nimport EventTarget from '../events/Target.js';\nimport EventType from '../events/EventType.js';\nimport ImageState from '../ImageState.js';\nimport {shared as iconImageCache} from './IconImageCache.js';\nimport {listenImage} from '../Image.js';\n\n\nclass IconImage extends EventTarget {\n  /**\n   * @param {HTMLImageElement|HTMLCanvasElement} image Image.\n   * @param {string|undefined} src Src.\n   * @param {import(\"../size.js\").Size} size Size.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {import(\"../ImageState.js\").default} imageState Image state.\n   * @param {import(\"../color.js\").Color} color Color.\n   */\n  constructor(image, src, size, crossOrigin, imageState, color) {\n\n    super();\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.hitDetectionImage_ = null;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = !image ? new Image() : image;\n\n    if (crossOrigin !== null) {\n      /** @type {HTMLImageElement} */ (this.image_).crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = color ? document.createElement('canvas') : null;\n\n    /**\n     * @private\n     * @type {import(\"../color.js\").Color}\n     */\n    this.color_ = color;\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../ImageState.js\").default}\n     */\n    this.imageState_ = imageState;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.size_ = size;\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.tainted_;\n\n  }\n\n  /**\n   * @private\n   * @return {boolean} The image canvas is tainted.\n   */\n  isTainted_() {\n    if (this.tainted_ === undefined && this.imageState_ === ImageState.LOADED) {\n      this.tainted_ = false;\n      const context = createCanvasContext2D(1, 1);\n      try {\n        context.drawImage(this.image_, 0, 0);\n        context.getImageData(0, 0, 1, 1);\n      } catch (e) {\n        this.tainted_ = true;\n      }\n    }\n    return this.tainted_ === true;\n  }\n\n  /**\n   * @private\n   */\n  dispatchChangeEvent_() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * @private\n   */\n  handleImageError_() {\n    this.imageState_ = ImageState.ERROR;\n    this.unlistenImage_();\n    this.dispatchChangeEvent_();\n  }\n\n  /**\n   * @private\n   */\n  handleImageLoad_() {\n    this.imageState_ = ImageState.LOADED;\n    if (this.size_) {\n      this.image_.width = this.size_[0];\n      this.image_.height = this.size_[1];\n    }\n    this.size_ = [this.image_.width, this.image_.height];\n    this.unlistenImage_();\n    this.replaceColor_();\n    this.dispatchChangeEvent_();\n  }\n\n  /**\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {HTMLImageElement|HTMLCanvasElement} Image or Canvas element.\n   */\n  getImage(pixelRatio) {\n    return this.canvas_ ? this.canvas_ : this.image_;\n  }\n\n  /**\n   * @return {import(\"../ImageState.js\").default} Image state.\n   */\n  getImageState() {\n    return this.imageState_;\n  }\n\n  /**\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {HTMLImageElement|HTMLCanvasElement} Image element.\n   */\n  getHitDetectionImage(pixelRatio) {\n    if (!this.hitDetectionImage_) {\n      if (this.isTainted_()) {\n        const width = this.size_[0];\n        const height = this.size_[1];\n        const context = createCanvasContext2D(width, height);\n        context.fillRect(0, 0, width, height);\n        this.hitDetectionImage_ = context.canvas;\n      } else {\n        this.hitDetectionImage_ = this.image_;\n      }\n    }\n    return this.hitDetectionImage_;\n  }\n\n  /**\n   * @return {import(\"../size.js\").Size} Image size.\n   */\n  getSize() {\n    return this.size_;\n  }\n\n  /**\n   * @return {string|undefined} Image src.\n   */\n  getSrc() {\n    return this.src_;\n  }\n\n  /**\n   * Load not yet loaded URI.\n   */\n  load() {\n    if (this.imageState_ == ImageState.IDLE) {\n      this.imageState_ = ImageState.LOADING;\n      try {\n        /** @type {HTMLImageElement} */ (this.image_).src = this.src_;\n      } catch (e) {\n        this.handleImageError_();\n      }\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * @private\n   */\n  replaceColor_() {\n    if (!this.color_ || this.isTainted_()) {\n      return;\n    }\n\n    this.canvas_.width = this.image_.width;\n    this.canvas_.height = this.image_.height;\n\n    const ctx = this.canvas_.getContext('2d');\n    ctx.drawImage(this.image_, 0, 0);\n\n    const imgData = ctx.getImageData(0, 0, this.image_.width, this.image_.height);\n    const data = imgData.data;\n    const r = this.color_[0] / 255.0;\n    const g = this.color_[1] / 255.0;\n    const b = this.color_[2] / 255.0;\n\n    for (let i = 0, ii = data.length; i < ii; i += 4) {\n      data[i] *= r;\n      data[i + 1] *= g;\n      data[i + 2] *= b;\n    }\n    ctx.putImageData(imgData, 0, 0);\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n\n/**\n * @param {HTMLImageElement|HTMLCanvasElement} image Image.\n * @param {string} src Src.\n * @param {import(\"../size.js\").Size} size Size.\n * @param {?string} crossOrigin Cross origin.\n * @param {import(\"../ImageState.js\").default} imageState Image state.\n * @param {import(\"../color.js\").Color} color Color.\n * @return {IconImage} Icon image.\n */\nexport function get(image, src, size, crossOrigin, imageState, color) {\n  let iconImage = iconImageCache.get(src, crossOrigin, color);\n  if (!iconImage) {\n    iconImage = new IconImage(image, src, size, crossOrigin, imageState, color);\n    iconImageCache.set(src, crossOrigin, color, iconImage);\n  }\n  return iconImage;\n}\n\n\nexport default IconImage;\n","/**\n * @module ol/style/Icon\n */\nimport {getUid} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport {assert} from '../asserts.js';\nimport {asArray} from '../color.js';\nimport EventType from '../events/EventType.js';\nimport IconAnchorUnits from './IconAnchorUnits.js';\nimport {get as getIconImage} from './IconImage.js';\nimport IconOrigin from './IconOrigin.js';\nimport ImageStyle from './Image.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array<number>} [anchor=[0.5, 0.5]] Anchor. Default value is the icon center.\n * @property {import(\"./IconOrigin.js\").default} [anchorOrigin='top-left'] Origin of the anchor: `bottom-left`, `bottom-right`,\n * `top-left` or `top-right`.\n * @property {import(\"./IconAnchorUnits.js\").default} [anchorXUnits='fraction'] Units in which the anchor x value is\n * specified. A value of `'fraction'` indicates the x value is a fraction of the icon. A value of `'pixels'` indicates\n * the x value in pixels.\n * @property {import(\"./IconAnchorUnits.js\").default} [anchorYUnits='fraction'] Units in which the anchor y value is\n * specified. A value of `'fraction'` indicates the y value is a fraction of the icon. A value of `'pixels'` indicates\n * the y value in pixels.\n * @property {import(\"../color.js\").Color|string} [color] Color to tint the icon. If not specified,\n * the icon will be left as is.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images. Note that you must provide a\n * `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {HTMLImageElement|HTMLCanvasElement} [img] Image object for the icon. If the `src` option is not provided then the\n * provided image must already be loaded. And in that case, it is required\n * to provide the size of the image, with the `imgSize` option.\n * @property {Array<number>} [offset=[0, 0]] Offset, which, together with the size and the offset origin, define the\n * sub-rectangle to use from the original icon image.\n * @property {import(\"./IconOrigin.js\").default} [offsetOrigin='top-left'] Origin of the offset: `bottom-left`, `bottom-right`,\n * `top-left` or `top-right`.\n * @property {number} [opacity=1] Opacity of the icon.\n * @property {number} [scale=1] Scale.\n * @property {boolean} [rotateWithView=false] Whether to rotate the icon with the view.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {import(\"../size.js\").Size} [size] Icon size in pixel. Can be used together with `offset` to define the\n * sub-rectangle to use from the origin (sprite) icon image.\n * @property {import(\"../size.js\").Size} [imgSize] Image size in pixels. Only required if `img` is set and `src` is not, and\n * for SVG images in Internet Explorer 11. The provided `imgSize` needs to match the actual size of the image.\n * @property {string} [src] Image source URI.\n */\n\n\n/**\n * @classdesc\n * Set icon style for vector features.\n * @api\n */\nclass Icon extends ImageStyle {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options || {};\n\n    /**\n     * @type {number}\n     */\n    const opacity = options.opacity !== undefined ? options.opacity : 1;\n\n    /**\n     * @type {number}\n     */\n    const rotation = options.rotation !== undefined ? options.rotation : 0;\n\n    /**\n     * @type {number}\n     */\n    const scale = options.scale !== undefined ? options.scale : 1;\n\n    /**\n     * @type {boolean}\n     */\n    const rotateWithView = options.rotateWithView !== undefined ?\n      options.rotateWithView : false;\n\n    super({\n      opacity: opacity,\n      rotation: rotation,\n      scale: scale,\n      rotateWithView: rotateWithView\n    });\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.anchor_ = options.anchor !== undefined ? options.anchor : [0.5, 0.5];\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.normalizedAnchor_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./IconOrigin.js\").default}\n     */\n    this.anchorOrigin_ = options.anchorOrigin !== undefined ?\n      options.anchorOrigin : IconOrigin.TOP_LEFT;\n\n    /**\n     * @private\n     * @type {import(\"./IconAnchorUnits.js\").default}\n     */\n    this.anchorXUnits_ = options.anchorXUnits !== undefined ?\n      options.anchorXUnits : IconAnchorUnits.FRACTION;\n\n    /**\n     * @private\n     * @type {import(\"./IconAnchorUnits.js\").default}\n     */\n    this.anchorYUnits_ = options.anchorYUnits !== undefined ?\n      options.anchorYUnits : IconAnchorUnits.FRACTION;\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ =\n        options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n    /**\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    const image = options.img !== undefined ? options.img : null;\n\n    /**\n     * @type {import(\"../size.js\").Size}\n     */\n    const imgSize = options.imgSize !== undefined ? options.imgSize : null;\n\n    /**\n     * @type {string|undefined}\n     */\n    let src = options.src;\n\n    assert(!(src !== undefined && image),\n      4); // `image` and `src` cannot be provided at the same time\n    assert(!image || (image && imgSize),\n      5); // `imgSize` must be set when `image` is provided\n\n    if ((src === undefined || src.length === 0) && image) {\n      src = /** @type {HTMLImageElement} */ (image).src || getUid(image);\n    }\n    assert(src !== undefined && src.length > 0,\n      6); // A defined and non-empty `src` or `image` must be provided\n\n    /**\n     * @type {import(\"../ImageState.js\").default}\n     */\n    const imageState = options.src !== undefined ?\n      ImageState.IDLE : ImageState.LOADED;\n\n    /**\n     * @private\n     * @type {import(\"../color.js\").Color}\n     */\n    this.color_ = options.color !== undefined ? asArray(options.color) : null;\n\n    /**\n     * @private\n     * @type {import(\"./IconImage.js\").default}\n     */\n    this.iconImage_ = getIconImage(\n      image, /** @type {string} */ (src), imgSize, this.crossOrigin_, imageState, this.color_);\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.offset_ = options.offset !== undefined ? options.offset : [0, 0];\n\n    /**\n     * @private\n     * @type {import(\"./IconOrigin.js\").default}\n     */\n    this.offsetOrigin_ = options.offsetOrigin !== undefined ?\n      options.offsetOrigin : IconOrigin.TOP_LEFT;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.origin_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.size_ = options.size !== undefined ? options.size : null;\n\n  }\n\n  /**\n   * Clones the style. The underlying Image/HTMLCanvasElement is not cloned.\n   * @return {Icon} The cloned style.\n   * @api\n   */\n  clone() {\n    return new Icon({\n      anchor: this.anchor_.slice(),\n      anchorOrigin: this.anchorOrigin_,\n      anchorXUnits: this.anchorXUnits_,\n      anchorYUnits: this.anchorYUnits_,\n      crossOrigin: this.crossOrigin_,\n      color: (this.color_ && this.color_.slice) ? this.color_.slice() : this.color_ || undefined,\n      src: this.getSrc(),\n      offset: this.offset_.slice(),\n      offsetOrigin: this.offsetOrigin_,\n      size: this.size_ !== null ? this.size_.slice() : undefined,\n      opacity: this.getOpacity(),\n      scale: this.getScale(),\n      rotation: this.getRotation(),\n      rotateWithView: this.getRotateWithView()\n    });\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getAnchor() {\n    if (this.normalizedAnchor_) {\n      return this.normalizedAnchor_;\n    }\n    let anchor = this.anchor_;\n    const size = this.getSize();\n    if (this.anchorXUnits_ == IconAnchorUnits.FRACTION ||\n        this.anchorYUnits_ == IconAnchorUnits.FRACTION) {\n      if (!size) {\n        return null;\n      }\n      anchor = this.anchor_.slice();\n      if (this.anchorXUnits_ == IconAnchorUnits.FRACTION) {\n        anchor[0] *= size[0];\n      }\n      if (this.anchorYUnits_ == IconAnchorUnits.FRACTION) {\n        anchor[1] *= size[1];\n      }\n    }\n\n    if (this.anchorOrigin_ != IconOrigin.TOP_LEFT) {\n      if (!size) {\n        return null;\n      }\n      if (anchor === this.anchor_) {\n        anchor = this.anchor_.slice();\n      }\n      if (this.anchorOrigin_ == IconOrigin.TOP_RIGHT ||\n          this.anchorOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n        anchor[0] = -anchor[0] + size[0];\n      }\n      if (this.anchorOrigin_ == IconOrigin.BOTTOM_LEFT ||\n          this.anchorOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n        anchor[1] = -anchor[1] + size[1];\n      }\n    }\n    this.normalizedAnchor_ = anchor;\n    return this.normalizedAnchor_;\n  }\n\n  /**\n   * Set the anchor point. The anchor determines the center point for the\n   * symbolizer.\n   *\n   * @param {Array<number>} anchor Anchor.\n   * @api\n   */\n  setAnchor(anchor) {\n    this.anchor_ = anchor;\n    this.normalizedAnchor_ = null;\n  }\n\n  /**\n   * Get the icon color.\n   * @return {import(\"../color.js\").Color} Color.\n   * @api\n   */\n  getColor() {\n    return this.color_;\n  }\n\n  /**\n   * Get the image icon.\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {HTMLImageElement|HTMLCanvasElement} Image or Canvas element.\n   * @override\n   * @api\n   */\n  getImage(pixelRatio) {\n    return this.iconImage_.getImage(pixelRatio);\n  }\n\n  /**\n   * @override\n   */\n  getImageSize() {\n    return this.iconImage_.getSize();\n  }\n\n  /**\n   * @override\n   */\n  getHitDetectionImageSize() {\n    return this.getImageSize();\n  }\n\n  /**\n   * @override\n   */\n  getImageState() {\n    return this.iconImage_.getImageState();\n  }\n\n  /**\n   * @override\n   */\n  getHitDetectionImage(pixelRatio) {\n    return this.iconImage_.getHitDetectionImage(pixelRatio);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getOrigin() {\n    if (this.origin_) {\n      return this.origin_;\n    }\n    let offset = this.offset_;\n\n    if (this.offsetOrigin_ != IconOrigin.TOP_LEFT) {\n      const size = this.getSize();\n      const iconImageSize = this.iconImage_.getSize();\n      if (!size || !iconImageSize) {\n        return null;\n      }\n      offset = offset.slice();\n      if (this.offsetOrigin_ == IconOrigin.TOP_RIGHT ||\n          this.offsetOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n        offset[0] = iconImageSize[0] - size[0] - offset[0];\n      }\n      if (this.offsetOrigin_ == IconOrigin.BOTTOM_LEFT ||\n          this.offsetOrigin_ == IconOrigin.BOTTOM_RIGHT) {\n        offset[1] = iconImageSize[1] - size[1] - offset[1];\n      }\n    }\n    this.origin_ = offset;\n    return this.origin_;\n  }\n\n  /**\n   * Get the image URL.\n   * @return {string|undefined} Image src.\n   * @api\n   */\n  getSrc() {\n    return this.iconImage_.getSrc();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getSize() {\n    return !this.size_ ? this.iconImage_.getSize() : this.size_;\n  }\n\n  /**\n   * @override\n   */\n  listenImageChange(listener) {\n    this.iconImage_.addEventListener(EventType.CHANGE, listener);\n  }\n\n  /**\n   * Load not yet loaded URI.\n   * When rendering a feature with an icon style, the vector renderer will\n   * automatically call this method. However, you might want to call this\n   * method yourself for preloading or other purposes.\n   * @override\n   * @api\n   */\n  load() {\n    this.iconImage_.load();\n  }\n\n  /**\n   * @override\n   */\n  unlistenImageChange(listener) {\n    this.iconImage_.removeEventListener(EventType.CHANGE, listener);\n  }\n}\n\n\nexport default Icon;\n","/**\n * @module ol/VectorRenderTile\n */\nimport {getUid} from './util.js';\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\n\n\n/**\n * @typedef {Object} ReplayState\n * @property {boolean} dirty\n * @property {null|import(\"./render.js\").OrderFunction} renderedRenderOrder\n * @property {number} renderedTileRevision\n * @property {number} renderedResolution\n * @property {number} renderedRevision\n * @property {number} renderedZ\n * @property {number} renderedTileResolution\n * @property {number} renderedTileZ\n */\n\n\nclass VectorRenderTile extends Tile {\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {TileState} state State.\n   * @param {import(\"./tilecoord.js\").TileCoord} urlTileCoord Wrapped tile coordinate for source urls.\n   * @param {import(\"./tilegrid/TileGrid.js\").default} sourceTileGrid Tile grid of the source.\n   * @param {function(VectorRenderTile):Array<import(\"./VectorTile\").default>} getSourceTiles Function\n   * to get an source tiles for this tile.\n   * @param {function(VectorRenderTile):void} removeSourceTiles Function to remove this tile from its\n   * source tiles's consumer count.\n   */\n  constructor(tileCoord, state, urlTileCoord, sourceTileGrid, getSourceTiles, removeSourceTiles) {\n\n    super(tileCoord, state, {transition: 0});\n\n    /**\n     * @private\n     * @type {!Object<string, CanvasRenderingContext2D>}\n     */\n    this.context_ = {};\n\n    /**\n     * Executor groups by layer uid. Entries are read/written by the renderer.\n     * @type {Object<string, Array<import(\"./render/canvas/ExecutorGroup.js\").default>>}\n     */\n    this.executorGroups = {};\n\n    /**\n     * Number of loading source tiles. Read/written by the source.\n     * @type {number}\n     */\n    this.loadingSourceTiles = 0;\n\n    /**\n     * Tile keys of error source tiles. Read/written by the source.\n     * @type {Object<string, boolean>}\n     */\n    this.errorSourceTileKeys = {};\n\n    /**\n     * @private\n     * @type {!Object<string, ReplayState>}\n     */\n    this.replayState_ = {};\n\n    /**\n     * @type {number}\n     */\n    this.wantedResolution;\n\n    /**\n     * @type {!function(import(\"./VectorRenderTile.js\").default):Array<import(\"./VectorTile.js\").default>}\n     */\n    this.getSourceTiles_ = getSourceTiles;\n\n    /**\n     * @type {!function(import(\"./VectorRenderTile.js\").default):void}\n     */\n    this.removeSourceTiles_ = removeSourceTiles;\n\n    /**\n     * @private\n     * @type {import(\"./tilegrid/TileGrid.js\").default}\n     */\n    this.sourceTileGrid_ = sourceTileGrid;\n\n    /**\n     * z of the source tiles of the last getSourceTiles call.\n     * @type {number}\n     */\n    this.sourceZ = -1;\n\n    /**\n     * True when all tiles for this tile's nominal resolution are available.\n     * @type {boolean}\n     */\n    this.hifi = false;\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.wrappedTileCoord = urlTileCoord;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.removeSourceTiles_(this);\n    for (const key in this.context_) {\n      const canvas = this.context_[key].canvas;\n      canvas.width = canvas.height = 0;\n    }\n    for (const key in this.executorGroups) {\n      const executorGroups = this.executorGroups[key];\n      for (let i = 0, ii = executorGroups.length; i < ii; ++i) {\n        executorGroups[i].disposeInternal();\n      }\n    }\n    this.setState(TileState.ABORT);\n    super.disposeInternal();\n  }\n\n  /**\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {CanvasRenderingContext2D} The rendering context.\n   */\n  getContext(layer) {\n    const key = getUid(layer);\n    if (!(key in this.context_)) {\n      this.context_[key] = createCanvasContext2D();\n    }\n    return this.context_[key];\n  }\n\n  /**\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {boolean} Tile has a rendering context for the given layer.\n   */\n  hasContext(layer) {\n    return getUid(layer) in this.context_;\n  }\n\n  /**\n   * Get the Canvas for this tile.\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {HTMLCanvasElement} Canvas.\n   */\n  getImage(layer) {\n    return this.hasContext(layer) ? this.getContext(layer).canvas : null;\n  }\n\n  /**\n   * @param {import(\"./layer/Layer.js\").default} layer Layer.\n   * @return {ReplayState} The replay state.\n   */\n  getReplayState(layer) {\n    const key = getUid(layer);\n    if (!(key in this.replayState_)) {\n      this.replayState_[key] = {\n        dirty: false,\n        renderedRenderOrder: null,\n        renderedResolution: NaN,\n        renderedRevision: -1,\n        renderedTileResolution: NaN,\n        renderedTileRevision: -1,\n        renderedZ: -1,\n        renderedTileZ: -1\n      };\n    }\n    return this.replayState_[key];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  load() {\n    this.getSourceTiles_(this);\n  }\n}\n\n\nexport default VectorRenderTile;\n","/**\n * @module ol/VectorTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\n\nclass VectorTile extends Tile {\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {TileState} state State.\n   * @param {string} src Data source url.\n   * @param {import(\"./format/Feature.js\").default} format Feature format.\n   * @param {import(\"./Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @param {import(\"./Tile.js\").Options=} opt_options Tile options.\n   */\n  constructor(tileCoord, state, src, format, tileLoadFunction, opt_options) {\n\n    super(tileCoord, state, opt_options);\n\n    /**\n     * @type {number}\n     */\n    this.consumers = 0;\n\n    /**\n     * Extent of this tile; set by the source.\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.extent = null;\n\n    /**\n     * @private\n     * @type {import(\"./format/Feature.js\").default}\n     */\n    this.format_ = format;\n\n    /**\n     * @private\n     * @type {Array<import(\"./Feature.js\").default>}\n     */\n    this.features_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./featureloader.js\").FeatureLoader}\n     */\n    this.loader_;\n\n    /**\n     * Feature projection of this tile; set by the source.\n     * @type {import(\"./proj/Projection.js\").default}\n     */\n    this.projection = null;\n\n    /**\n     * Resolution of this tile; set by the source.\n     * @type {number}\n     */\n    this.resolution;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.url_ = src;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.setState(TileState.ABORT);\n    super.disposeInternal();\n  }\n\n  /**\n   * Get the feature format assigned for reading this tile's features.\n   * @return {import(\"./format/Feature.js\").default} Feature format.\n   * @api\n   */\n  getFormat() {\n    return this.format_;\n  }\n\n  /**\n   * Get the features for this tile. Geometries will be in the view projection.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} Features.\n   * @api\n   */\n  getFeatures() {\n    return this.features_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getKey() {\n    return this.url_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  load() {\n    if (this.state == TileState.IDLE) {\n      this.setState(TileState.LOADING);\n      this.tileLoadFunction_(this, this.url_);\n      this.loader_(this.extent, this.resolution, this.projection);\n    }\n  }\n\n  /**\n   * Handler for successful tile load.\n   * @param {Array<import(\"./Feature.js\").default>} features The loaded features.\n   * @param {import(\"./proj/Projection.js\").default} dataProjection Data projection.\n   */\n  onLoad(features, dataProjection) {\n    this.setFeatures(features);\n  }\n\n  /**\n   * Handler for tile load errors.\n   */\n  onError() {\n    this.setState(TileState.ERROR);\n  }\n\n  /**\n   * Function for use in an {@link module:ol/source/VectorTile~VectorTile}'s `tileLoadFunction`.\n   * Sets the features for the tile.\n   * @param {Array<import(\"./Feature.js\").default>} features Features.\n   * @api\n   */\n  setFeatures(features) {\n    this.features_ = features;\n    this.setState(TileState.LOADED);\n  }\n\n  /**\n   * Set the feature loader for reading this tile's features.\n   * @param {import(\"./featureloader.js\").FeatureLoader} loader Feature loader.\n   * @api\n   */\n  setLoader(loader) {\n    this.loader_ = loader;\n  }\n}\n\nexport default VectorTile;\n","/**\n * @module ol/source/VectorTile\n */\n\nimport TileState from '../TileState.js';\nimport VectorRenderTile from '../VectorRenderTile.js';\nimport Tile from '../VectorTile.js';\nimport {toSize} from '../size.js';\nimport UrlTile from './UrlTile.js';\nimport {getKeyZXY, getKey} from '../tilecoord.js';\nimport {createXYZ, extentFromProjection, createForProjection} from '../tilegrid.js';\nimport {buffer as bufferExtent, getIntersection, intersects} from '../extent.js';\nimport EventType from '../events/EventType.js';\nimport {loadFeaturesXhr} from '../featureloader.js';\nimport {isEmpty} from '../obj.js';\nimport {equals} from '../array.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize=128] Cache size.\n * @property {import(\"../extent.js\").Extent} [extent]\n * @property {import(\"../format/Feature.js\").default} [format] Feature format for tiles. Used and required by the default.\n * @property {boolean} [overlaps=true] This source may have overlapping geometries. Setting this\n * to `false` (e.g. for sources with polygons that represent administrative\n * boundaries or TopoJSON sources) allows the renderer to optimise fill and\n * stroke operations.\n * @property {import(\"../proj.js\").ProjectionLike} [projection='EPSG:3857'] Projection of the tile grid.\n * @property {import(\"./State.js\").default} [state] Source state.\n * @property {typeof import(\"../VectorTile.js\").default} [tileClass] Class used to instantiate image tiles.\n * Default is {@link module:ol/VectorTile}.\n * @property {number} [maxZoom=22] Optional max zoom level.\n * @property {number} [minZoom] Optional min zoom level.\n * @property {number|import(\"../size.js\").Size} [tileSize=512] Optional tile size.\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid] Tile grid.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction]\n * Optional function to load a tile given a URL. Could look like this for pbf tiles:\n * ```js\n * function(tile, url) {\n *   tile.setLoader(function(extent, resolution, projection) {\n *     fetch(url).then(function(response) {\n *       response.arrayBuffer().then(function(data) {\n *         const format = tile.getFormat() // ol/format/MVT configured as source format\n *         const features = format.readFeatures(data, {\n *           extent: extent,\n *           featureProjection: projection\n *         });\n *         tile.setFeatures(features);\n *       });\n *     });\n *   });\n * }\n * ```\n * @property {import(\"../Tile.js\").UrlFunction} [tileUrlFunction] Optional function to get tile URL given a tile coordinate and the projection.\n * @property {string} [url] URL template. Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {number} [transition] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @property {Array<string>} [urls] An array of URL templates.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * When set to `false`, only one world\n * will be rendered. When set to `true`, tiles will be wrapped horizontally to\n * render multiple worlds.\n * @property {number} [zDirection=1] Indicate which resolution should be used\n * by a renderer if the view resolution does not match any resolution of the tile source.\n * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n * will be used. If -1, the nearest higher resolution will be used.\n */\n\n\n/**\n * @classdesc\n * Class for layer sources providing vector data divided into a tile grid, to be\n * used with {@link module:ol/layer/VectorTile~VectorTile}. Although this source receives tiles\n * with vector features from the server, it is not meant for feature editing.\n * Features are optimized for rendering, their geometries are clipped at or near\n * tile boundaries and simplified for a view resolution. See\n * {@link module:ol/source/Vector} for vector sources that are suitable for feature\n * editing.\n *\n * @fires import(\"./Tile.js\").TileSourceEvent\n * @api\n */\nclass VectorTile extends UrlTile {\n  /**\n   * @param {!Options} options Vector tile options.\n   */\n  constructor(options) {\n    const projection = options.projection || 'EPSG:3857';\n\n    const extent = options.extent || extentFromProjection(projection);\n\n    const tileGrid = options.tileGrid || createXYZ({\n      extent: extent,\n      maxZoom: options.maxZoom || 22,\n      minZoom: options.minZoom,\n      tileSize: options.tileSize || 512\n    });\n\n    super({\n      attributions: options.attributions,\n      attributionsCollapsible: options.attributionsCollapsible,\n      cacheSize: options.cacheSize,\n      opaque: false,\n      projection: projection,\n      state: options.state,\n      tileGrid: tileGrid,\n      tileLoadFunction: options.tileLoadFunction ? options.tileLoadFunction : defaultLoadFunction,\n      tileUrlFunction: options.tileUrlFunction,\n      url: options.url,\n      urls: options.urls,\n      wrapX: options.wrapX === undefined ? true : options.wrapX,\n      transition: options.transition,\n      zDirection: options.zDirection === undefined ? 1 : options.zDirection\n    });\n\n    /**\n     * @private\n     * @type {import(\"../format/Feature.js\").default}\n     */\n    this.format_ = options.format ? options.format : null;\n\n    /**\n     * @type {Object<string, import(\"./VectorTile\").default>}\n     */\n    this.loadingTiles_ = {};\n\n    /**\n     * @private\n     * @type {Object<string, import(\"../VectorTile.js\").default>}\n     */\n    this.sourceTileByCoordKey_ = {};\n\n    /**\n     * @private\n     * @type {Object<string, Array<import(\"../VectorTile.js\").default>>}\n     */\n    this.sourceTilesByTileKey_ = {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.overlaps_ = options.overlaps == undefined ? true : options.overlaps;\n\n    /**\n     * @protected\n     * @type {typeof import(\"../VectorTile.js\").default}\n     */\n    this.tileClass = options.tileClass ? options.tileClass : Tile;\n\n    /**\n     * @private\n     * @type {Object<string, import(\"../tilegrid/TileGrid.js\").default>}\n     */\n    this.tileGrids_ = {};\n\n  }\n\n  /**\n   * @return {boolean} The source can have overlapping geometries.\n   */\n  getOverlaps() {\n    return this.overlaps_;\n  }\n\n  /**\n   * clear {@link module:ol/TileCache~TileCache} and delete all source tiles\n   * @api\n   */\n  clear() {\n    this.tileCache.clear();\n    this.sourceTileByCoordKey_ = {};\n    this.sourceTilesByTileKey_ = {};\n  }\n\n  /**\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection\").default} projection Projection.\n   * @param {VectorRenderTile} tile Vector image tile.\n   * @return {Array<import(\"../VectorTile\").default>} Tile keys.\n   */\n  getSourceTiles(pixelRatio, projection, tile) {\n    const urlTileCoord = tile.wrappedTileCoord;\n    const tileGrid = this.getTileGridForProjection(projection);\n    const extent = tileGrid.getTileCoordExtent(urlTileCoord);\n    const z = urlTileCoord[0];\n    const resolution = tileGrid.getResolution(z);\n    // make extent 1 pixel smaller so we don't load tiles for < 0.5 pixel render space\n    bufferExtent(extent, -resolution, extent);\n    const sourceTileGrid = this.tileGrid;\n    const sourceExtent = sourceTileGrid.getExtent();\n    if (sourceExtent) {\n      getIntersection(extent, sourceExtent, extent);\n    }\n    const sourceZ = sourceTileGrid.getZForResolution(resolution, 1);\n    const minZoom = sourceTileGrid.getMinZoom();\n\n    const previousSourceTiles = this.sourceTilesByTileKey_[tile.getKey()];\n    let sourceTiles, covered, loadedZ;\n    if (previousSourceTiles && previousSourceTiles.length > 0 && previousSourceTiles[0].tileCoord[0] === sourceZ) {\n      sourceTiles = previousSourceTiles;\n      covered = true;\n      loadedZ = sourceZ;\n    } else {\n      sourceTiles = [];\n      loadedZ = sourceZ + 1;\n      do {\n        --loadedZ;\n        covered = true;\n        sourceTileGrid.forEachTileCoord(extent, loadedZ, function(sourceTileCoord) {\n          const coordKey = getKey(sourceTileCoord);\n          let sourceTile;\n          if (coordKey in this.sourceTileByCoordKey_) {\n            sourceTile = this.sourceTileByCoordKey_[coordKey];\n            const state = sourceTile.getState();\n            if (state === TileState.LOADED || state === TileState.ERROR || state === TileState.EMPTY) {\n              sourceTiles.push(sourceTile);\n              return;\n            }\n          } else if (loadedZ === sourceZ) {\n            const tileUrl = this.tileUrlFunction(sourceTileCoord, pixelRatio, projection);\n            if (tileUrl !== undefined) {\n              sourceTile = new this.tileClass(sourceTileCoord, TileState.IDLE, tileUrl,\n                this.format_, this.tileLoadFunction);\n              sourceTile.extent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n              sourceTile.projection = projection;\n              sourceTile.resolution = sourceTileGrid.getResolution(sourceTileCoord[0]);\n              this.sourceTileByCoordKey_[coordKey] = sourceTile;\n              sourceTile.addEventListener(EventType.CHANGE, this.handleTileChange.bind(this));\n              sourceTile.load();\n            }\n          }\n          covered = false;\n          if (!sourceTile) {\n            return;\n          }\n          if (sourceTile.getState() !== TileState.EMPTY && tile.getState() === TileState.IDLE) {\n            tile.loadingSourceTiles++;\n            const onSourceTileChange = function() {\n              const state = sourceTile.getState();\n              const sourceTileKey = sourceTile.getKey();\n              if (state === TileState.LOADED || state === TileState.ERROR) {\n                if (state === TileState.LOADED) {\n                  sourceTile.removeEventListener(EventType.CHANGE, onSourceTileChange);\n                  tile.loadingSourceTiles--;\n                  // eslint-disable-next-line no-use-before-define\n                  tile.removeEventListener(EventType.CHANGE, onTileChange);\n                  delete tile.errorSourceTileKeys[sourceTileKey];\n                } else if (state === TileState.ERROR) {\n                  tile.errorSourceTileKeys[sourceTileKey] = true;\n                }\n                if (tile.loadingSourceTiles - Object.keys(tile.errorSourceTileKeys).length === 0) {\n                  tile.hifi = true;\n                  tile.sourceZ = sourceZ;\n                  tile.setState(isEmpty(tile.errorSourceTileKeys) ? TileState.LOADED : TileState.ERROR);\n                }\n              }\n            };\n            const onTileChange = function() {\n              if (tile.getState() === TileState.ABORT) {\n                sourceTile.removeEventListener(EventType.CHANGE, onSourceTileChange);\n                tile.removeEventListener(EventType.CHANGE, onTileChange);\n              }\n            };\n            sourceTile.addEventListener(EventType.CHANGE, onSourceTileChange);\n            tile.addEventListener(EventType.CHANGE, onTileChange);\n          }\n        }.bind(this));\n        if (!covered) {\n          sourceTiles.length = 0;\n        }\n      } while (!covered && loadedZ > minZoom);\n    }\n\n    if (tile.getState() === TileState.IDLE) {\n      tile.setState(TileState.LOADING);\n    }\n    if (covered) {\n      tile.hifi = sourceZ === loadedZ;\n      tile.sourceZ = loadedZ;\n      if (tile.getState() < TileState.LOADED) {\n        tile.setState(TileState.LOADED);\n      } else if (!previousSourceTiles || !equals(sourceTiles, previousSourceTiles)) {\n        this.removeSourceTiles(tile);\n        this.addSourceTiles(tile, sourceTiles);\n      }\n    }\n    return sourceTiles;\n  }\n\n  /**\n   * @param {VectorRenderTile} tile Tile.\n   * @param {Array<import(\"../VectorTile\").default>} sourceTiles Source tiles.\n   */\n  addSourceTiles(tile, sourceTiles) {\n    this.sourceTilesByTileKey_[tile.getKey()] = sourceTiles;\n    for (let i = 0, ii = sourceTiles.length; i < ii; ++i) {\n      sourceTiles[i].consumers++;\n    }\n  }\n\n  /**\n   * @param {VectorRenderTile} tile Tile.\n   */\n  removeSourceTiles(tile) {\n    const tileKey = tile.getKey();\n    if (tileKey in this.sourceTilesByTileKey_) {\n      const sourceTiles = this.sourceTilesByTileKey_[tileKey];\n      for (let i = 0, ii = sourceTiles.length; i < ii; ++i) {\n        const sourceTile = sourceTiles[i];\n        sourceTile.consumers--;\n        if (sourceTile.consumers === 0) {\n          sourceTile.dispose();\n          delete this.sourceTileByCoordKey_[getKey(sourceTile.tileCoord)];\n        }\n      }\n    }\n    delete this.sourceTilesByTileKey_[tileKey];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTile(z, x, y, pixelRatio, projection) {\n    const coordKey = getKeyZXY(z, x, y);\n    const key = this.getKey();\n    let tile;\n    if (this.tileCache.containsKey(coordKey)) {\n      tile = /** @type {!import(\"../Tile.js\").default} */ (this.tileCache.get(coordKey));\n      if (tile.key === key) {\n        return tile;\n      }\n    }\n    const tileCoord = [z, x, y];\n    let urlTileCoord = this.getTileCoordForTileUrlFunction(tileCoord, projection);\n    const sourceExtent = this.getTileGrid().getExtent();\n    const tileGrid = this.getTileGridForProjection(projection);\n    if (urlTileCoord && sourceExtent) {\n      const tileExtent = tileGrid.getTileCoordExtent(urlTileCoord);\n      // make extent 1 pixel smaller so we don't load tiles for < 0.5 pixel render space\n      bufferExtent(tileExtent, -tileGrid.getResolution(z), tileExtent);\n      if (!intersects(sourceExtent, tileExtent)) {\n        urlTileCoord = null;\n      }\n    }\n    let empty = true;\n    if (urlTileCoord !== null) {\n      const sourceTileGrid = this.tileGrid;\n      const resolution = tileGrid.getResolution(z);\n      const sourceZ = sourceTileGrid.getZForResolution(resolution, 1);\n      // make extent 1 pixel smaller so we don't load tiles for < 0.5 pixel render space\n      const extent = tileGrid.getTileCoordExtent(urlTileCoord);\n      bufferExtent(extent, -resolution, extent);\n      sourceTileGrid.forEachTileCoord(extent, sourceZ, function(sourceTileCoord) {\n        empty = empty && !this.tileUrlFunction(sourceTileCoord, pixelRatio, projection);\n      }.bind(this));\n    }\n    const newTile = new VectorRenderTile(\n      tileCoord,\n      empty ? TileState.EMPTY : TileState.IDLE,\n      urlTileCoord,\n      this.tileGrid,\n      this.getSourceTiles.bind(this, pixelRatio, projection),\n      this.removeSourceTiles.bind(this));\n\n    newTile.key = key;\n    if (tile) {\n      newTile.interimTile = tile;\n      newTile.refreshInterimChain();\n      this.tileCache.replace(coordKey, newTile);\n    } else {\n      this.tileCache.set(coordKey, newTile);\n    }\n    return newTile;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTileGridForProjection(projection) {\n    const code = projection.getCode();\n    let tileGrid = this.tileGrids_[code];\n    if (!tileGrid) {\n      // A tile grid that matches the tile size of the source tile grid is more\n      // likely to have 1:1 relationships between source tiles and rendered tiles.\n      const sourceTileGrid = this.tileGrid;\n      tileGrid = this.tileGrids_[code] = createForProjection(projection, undefined,\n        sourceTileGrid ? sourceTileGrid.getTileSize(sourceTileGrid.getMinZoom()) : undefined);\n    }\n    return tileGrid;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTilePixelRatio(pixelRatio) {\n    return pixelRatio;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTilePixelSize(z, pixelRatio, projection) {\n    const tileGrid = this.getTileGridForProjection(projection);\n    const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);\n    return [Math.round(tileSize[0] * pixelRatio), Math.round(tileSize[1] * pixelRatio)];\n  }\n}\n\n\nexport default VectorTile;\n\n\n/**\n * Sets the loader for a tile.\n * @param {import(\"../VectorTile.js\").default} tile Vector tile.\n * @param {string} url URL.\n */\nexport function defaultLoadFunction(tile, url) {\n  const loader = loadFeaturesXhr(url, tile.getFormat(), tile.onLoad.bind(tile), tile.onError.bind(tile));\n  tile.setLoader(loader);\n}\n","/**\n * @module ol/uri\n */\n\n\n/**\n * Appends query parameters to a URI.\n *\n * @param {string} uri The original URI, which may already have query data.\n * @param {!Object} params An object where keys are URI-encoded parameter keys,\n *     and the values are arbitrary types or arrays.\n * @return {string} The new URI.\n */\nexport function appendParams(uri, params) {\n  const keyParams = [];\n  // Skip any null or undefined parameter values\n  Object.keys(params).forEach(function(k) {\n    if (params[k] !== null && params[k] !== undefined) {\n      keyParams.push(k + '=' + encodeURIComponent(params[k]));\n    }\n  });\n  const qs = keyParams.join('&');\n  // remove any trailing ? or &\n  uri = uri.replace(/[?&]$/, '');\n  // append ? or & depending on whether uri has existing parameters\n  uri = uri.indexOf('?') === -1 ? uri + '?' : uri + '&';\n  return uri + qs;\n}\n","/**\n * @module ol/source/WMTSRequestEncoding\n */\n\n/**\n * Request encoding. One of 'KVP', 'REST'.\n * @enum {string}\n */\nexport default {\n  KVP: 'KVP', // see spec §8\n  REST: 'REST' // see spec §10\n};\n","/**\n * @module ol/source/WMTS\n */\n\nimport {expandUrl, createFromTileUrlFunctions, nullTileUrlFunction} from '../tileurlfunction.js';\nimport {find, findIndex, includes} from '../array.js';\nimport {containsExtent} from '../extent.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, equivalent, transformExtent} from '../proj.js';\nimport TileImage from './TileImage.js';\nimport WMTSRequestEncoding from './WMTSRequestEncoding.js';\nimport {createFromCapabilitiesMatrixSet} from '../tilegrid/WMTS.js';\nimport {appendParams} from '../uri.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {import(\"../tilegrid/WMTS.js\").default} tileGrid Tile grid.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"./WMTSRequestEncoding.js\").default|string} [requestEncoding='KVP'] Request encoding.\n * @property {string} layer Layer name as advertised in the WMTS capabilities.\n * @property {string} style Style name as advertised in the WMTS capabilities.\n * @property {typeof import(\"../ImageTile.js\").default} [tileClass]  Class used to instantiate image tiles. Default is {@link module:ol/ImageTile~ImageTile}.\n * @property {number} [tilePixelRatio=1] The pixel ratio used by the tile service.\n * For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px\n * by 512px images (for retina/hidpi devices) then `tilePixelRatio`\n * should be set to `2`.\n * @property {string} [format='image/jpeg'] Image format. Only used when `requestEncoding` is `'KVP'`.\n * @property {string} [version='1.0.0'] WMTS version.\n * @property {string} matrixSet Matrix set.\n * @property {!Object} [dimensions] Additional \"dimensions\" for tile requests.\n * This is an object with properties named like the advertised WMTS dimensions.\n * @property {string} [url]  A URL for the service.\n * For the RESTful request encoding, this is a URL\n * template.  For KVP encoding, it is normal URL. A `{?-?}` template pattern,\n * for example `subdomain{a-f}.domain.com`, may be used instead of defining\n * each one separately in the `urls` option.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {Array<string>} [urls] An array of URLs.\n * Requests will be distributed among the URLs in this array.\n * @property {boolean} [wrapX=false] Whether to wrap the world horizontally.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data from WMTS servers.\n * @api\n */\nclass WMTS extends TileImage {\n  /**\n   * @param {Options} options WMTS options.\n   */\n  constructor(options) {\n\n    // TODO: add support for TileMatrixLimits\n\n    const requestEncoding = options.requestEncoding !== undefined ?\n      /** @type {import(\"./WMTSRequestEncoding.js\").default} */ (options.requestEncoding) :\n      WMTSRequestEncoding.KVP;\n\n    // FIXME: should we create a default tileGrid?\n    // we could issue a getCapabilities xhr to retrieve missing configuration\n    const tileGrid = options.tileGrid;\n\n    let urls = options.urls;\n    if (urls === undefined && options.url !== undefined) {\n      urls = expandUrl(options.url);\n    }\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      projection: options.projection,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileClass: options.tileClass,\n      tileGrid: tileGrid,\n      tileLoadFunction: options.tileLoadFunction,\n      tilePixelRatio: options.tilePixelRatio,\n      tileUrlFunction: nullTileUrlFunction,\n      urls: urls,\n      wrapX: options.wrapX !== undefined ? options.wrapX : false,\n      transition: options.transition\n    });\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.version_ = options.version !== undefined ? options.version : '1.0.0';\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.format_ = options.format !== undefined ? options.format : 'image/jpeg';\n\n    /**\n     * @private\n     * @type {!Object}\n     */\n    this.dimensions_ = options.dimensions !== undefined ? options.dimensions : {};\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.layer_ = options.layer;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.matrixSet_ = options.matrixSet;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.style_ = options.style;\n\n    // FIXME: should we guess this requestEncoding from options.url(s)\n    //        structure? that would mean KVP only if a template is not provided.\n\n    /**\n     * @private\n     * @type {import(\"./WMTSRequestEncoding.js\").default}\n     */\n    this.requestEncoding_ = requestEncoding;\n\n    this.setKey(this.getKeyForDimensions_());\n\n    if (urls && urls.length > 0) {\n      this.tileUrlFunction = createFromTileUrlFunctions(urls.map(createFromWMTSTemplate.bind(this)));\n    }\n\n  }\n\n  /**\n   * Set the URLs to use for requests.\n   * URLs may contain OCG conform URL Template Variables: {TileMatrix}, {TileRow}, {TileCol}.\n   * @override\n   */\n  setUrls(urls) {\n    this.urls = urls;\n    const key = urls.join('\\n');\n    this.setTileUrlFunction(createFromTileUrlFunctions(urls.map(createFromWMTSTemplate.bind(this))), key);\n  }\n\n  /**\n   * Get the dimensions, i.e. those passed to the constructor through the\n   * \"dimensions\" option, and possibly updated using the updateDimensions\n   * method.\n   * @return {!Object} Dimensions.\n   * @api\n   */\n  getDimensions() {\n    return this.dimensions_;\n  }\n\n\n  /**\n   * Return the image format of the WMTS source.\n   * @return {string} Format.\n   * @api\n   */\n  getFormat() {\n    return this.format_;\n  }\n\n\n  /**\n   * Return the layer of the WMTS source.\n   * @return {string} Layer.\n   * @api\n   */\n  getLayer() {\n    return this.layer_;\n  }\n\n\n  /**\n   * Return the matrix set of the WMTS source.\n   * @return {string} MatrixSet.\n   * @api\n   */\n  getMatrixSet() {\n    return this.matrixSet_;\n  }\n\n\n  /**\n   * Return the request encoding, either \"KVP\" or \"REST\".\n   * @return {import(\"./WMTSRequestEncoding.js\").default} Request encoding.\n   * @api\n   */\n  getRequestEncoding() {\n    return this.requestEncoding_;\n  }\n\n\n  /**\n   * Return the style of the WMTS source.\n   * @return {string} Style.\n   * @api\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n\n  /**\n   * Return the version of the WMTS source.\n   * @return {string} Version.\n   * @api\n   */\n  getVersion() {\n    return this.version_;\n  }\n\n\n  /**\n   * @private\n   * @return {string} The key for the current dimensions.\n   */\n  getKeyForDimensions_() {\n    let i = 0;\n    const res = [];\n    for (const key in this.dimensions_) {\n      res[i++] = key + '-' + this.dimensions_[key];\n    }\n    return res.join('/');\n  }\n\n\n  /**\n   * Update the dimensions.\n   * @param {Object} dimensions Dimensions.\n   * @api\n   */\n  updateDimensions(dimensions) {\n    assign(this.dimensions_, dimensions);\n    this.setKey(this.getKeyForDimensions_());\n  }\n\n}\n\nexport default WMTS;\n\n/**\n * Generate source options from a capabilities object.\n * @param {Object} wmtsCap An object representing the capabilities document.\n * @param {!Object} config Configuration properties for the layer.  Defaults for\n *                  the layer will apply if not provided.\n *\n * Required config properties:\n *  - layer - {string} The layer identifier.\n *\n * Optional config properties:\n *  - matrixSet - {string} The matrix set identifier, required if there is\n *       more than one matrix set in the layer capabilities.\n *  - projection - {string} The desired CRS when no matrixSet is specified.\n *       eg: \"EPSG:3857\". If the desired projection is not available,\n *       an error is thrown.\n *  - requestEncoding - {string} url encoding format for the layer. Default is\n *       the first tile url format found in the GetCapabilities response.\n *  - style - {string} The name of the style\n *  - format - {string} Image format for the layer. Default is the first\n *       format returned in the GetCapabilities response.\n *  - crossOrigin - {string|null|undefined} Cross origin. Default is `undefined`.\n * @return {?Options} WMTS source options object or `null` if the layer was not found.\n * @api\n */\nexport function optionsFromCapabilities(wmtsCap, config) {\n  const layers = wmtsCap['Contents']['Layer'];\n  const l = find(layers, function(elt, index, array) {\n    return elt['Identifier'] == config['layer'];\n  });\n  if (l === null) {\n    return null;\n  }\n  const tileMatrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  let idx;\n  if (l['TileMatrixSetLink'].length > 1) {\n    if ('projection' in config) {\n      idx = findIndex(l['TileMatrixSetLink'],\n        function(elt, index, array) {\n          const tileMatrixSet = find(tileMatrixSets, function(el) {\n            return el['Identifier'] == elt['TileMatrixSet'];\n          });\n          const supportedCRS = tileMatrixSet['SupportedCRS'];\n          const proj1 = getProjection(supportedCRS.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n                getProjection(supportedCRS);\n          const proj2 = getProjection(config['projection']);\n          if (proj1 && proj2) {\n            return equivalent(proj1, proj2);\n          } else {\n            return supportedCRS == config['projection'];\n          }\n        });\n    } else {\n      idx = findIndex(l['TileMatrixSetLink'],\n        function(elt, index, array) {\n          return elt['TileMatrixSet'] == config['matrixSet'];\n        });\n    }\n  } else {\n    idx = 0;\n  }\n  if (idx < 0) {\n    idx = 0;\n  }\n  const matrixSet = /** @type {string} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSet']);\n  const matrixLimits = /** @type {Array<Object>} */\n    (l['TileMatrixSetLink'][idx]['TileMatrixSetLimits']);\n\n  let format = /** @type {string} */ (l['Format'][0]);\n  if ('format' in config) {\n    format = config['format'];\n  }\n  idx = findIndex(l['Style'], function(elt, index, array) {\n    if ('style' in config) {\n      return elt['Title'] == config['style'];\n    } else {\n      return elt['isDefault'];\n    }\n  });\n  if (idx < 0) {\n    idx = 0;\n  }\n  const style = /** @type {string} */ (l['Style'][idx]['Identifier']);\n\n  const dimensions = {};\n  if ('Dimension' in l) {\n    l['Dimension'].forEach(function(elt, index, array) {\n      const key = elt['Identifier'];\n      let value = elt['Default'];\n      if (value === undefined) {\n        value = elt['Value'][0];\n      }\n      dimensions[key] = value;\n    });\n  }\n\n  const matrixSets = wmtsCap['Contents']['TileMatrixSet'];\n  const matrixSetObj = find(matrixSets, function(elt, index, array) {\n    return elt['Identifier'] == matrixSet;\n  });\n\n  let projection;\n  const code = matrixSetObj['SupportedCRS'];\n  if (code) {\n    projection = getProjection(code.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n        getProjection(code);\n  }\n  if ('projection' in config) {\n    const projConfig = getProjection(config['projection']);\n    if (projConfig) {\n      if (!projection || equivalent(projConfig, projection)) {\n        projection = projConfig;\n      }\n    }\n  }\n\n  const wgs84BoundingBox = l['WGS84BoundingBox'];\n  let extent, wrapX;\n  if (wgs84BoundingBox !== undefined) {\n    const wgs84ProjectionExtent = getProjection('EPSG:4326').getExtent();\n    wrapX = (wgs84BoundingBox[0] == wgs84ProjectionExtent[0] &&\n        wgs84BoundingBox[2] == wgs84ProjectionExtent[2]);\n    extent = transformExtent(\n      wgs84BoundingBox, 'EPSG:4326', projection);\n    const projectionExtent = projection.getExtent();\n    if (projectionExtent) {\n      // If possible, do a sanity check on the extent - it should never be\n      // bigger than the validity extent of the projection of a matrix set.\n      if (!containsExtent(projectionExtent, extent)) {\n        extent = undefined;\n      }\n    }\n  }\n\n  const tileGrid = createFromCapabilitiesMatrixSet(matrixSetObj, extent, matrixLimits);\n\n  /** @type {!Array<string>} */\n  const urls = [];\n  let requestEncoding = config['requestEncoding'];\n  requestEncoding = requestEncoding !== undefined ? requestEncoding : '';\n\n  if ('OperationsMetadata' in wmtsCap && 'GetTile' in wmtsCap['OperationsMetadata']) {\n    const gets = wmtsCap['OperationsMetadata']['GetTile']['DCP']['HTTP']['Get'];\n\n    for (let i = 0, ii = gets.length; i < ii; ++i) {\n      if (gets[i]['Constraint']) {\n        const constraint = find(gets[i]['Constraint'], function(element) {\n          return element['name'] == 'GetEncoding';\n        });\n        const encodings = constraint['AllowedValues']['Value'];\n\n        if (requestEncoding === '') {\n          // requestEncoding not provided, use the first encoding from the list\n          requestEncoding = encodings[0];\n        }\n        if (requestEncoding === WMTSRequestEncoding.KVP) {\n          if (includes(encodings, WMTSRequestEncoding.KVP)) {\n            urls.push(/** @type {string} */ (gets[i]['href']));\n          }\n        } else {\n          break;\n        }\n      } else if (gets[i]['href']) {\n        requestEncoding = WMTSRequestEncoding.KVP;\n        urls.push(/** @type {string} */ (gets[i]['href']));\n      }\n    }\n  }\n  if (urls.length === 0) {\n    requestEncoding = WMTSRequestEncoding.REST;\n    l['ResourceURL'].forEach(function(element) {\n      if (element['resourceType'] === 'tile') {\n        format = element['format'];\n        urls.push(/** @type {string} */ (element['template']));\n      }\n    });\n  }\n\n  return {\n    urls: urls,\n    layer: config['layer'],\n    matrixSet: matrixSet,\n    format: format,\n    projection: projection,\n    requestEncoding: requestEncoding,\n    tileGrid: tileGrid,\n    style: style,\n    dimensions: dimensions,\n    wrapX: wrapX,\n    crossOrigin: config['crossOrigin']\n  };\n}\n\n/**\n * @param {string} template Template.\n * @return {import(\"../Tile.js\").UrlFunction} Tile URL function.\n * @this {WMTS}\n */\nfunction createFromWMTSTemplate(template) {\n  const requestEncoding = this.requestEncoding_;\n\n  // context property names are lower case to allow for a case insensitive\n  // replacement as some services use different naming conventions\n  const context = {\n    'layer': this.layer_,\n    'style': this.style_,\n    'tilematrixset': this.matrixSet_\n  };\n\n  if (requestEncoding == WMTSRequestEncoding.KVP) {\n    assign(context, {\n      'Service': 'WMTS',\n      'Request': 'GetTile',\n      'Version': this.version_,\n      'Format': this.format_\n    });\n  }\n\n  // TODO: we may want to create our own appendParams function so that params\n  // order conforms to wmts spec guidance, and so that we can avoid to escape\n  // special template params\n\n  template = (requestEncoding == WMTSRequestEncoding.KVP) ?\n    appendParams(template, context) :\n    template.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n      return (p.toLowerCase() in context) ? context[p.toLowerCase()] : m;\n    });\n\n  const tileGrid = /** @type {import(\"../tilegrid/WMTS.js\").default} */ (\n    this.tileGrid);\n  const dimensions = this.dimensions_;\n\n  return (\n    /**\n     * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n     * @param {number} pixelRatio Pixel ratio.\n     * @param {import(\"../proj/Projection.js\").default} projection Projection.\n     * @return {string|undefined} Tile URL.\n     */\n    function(tileCoord, pixelRatio, projection) {\n      if (!tileCoord) {\n        return undefined;\n      } else {\n        const localContext = {\n          'TileMatrix': tileGrid.getMatrixId(tileCoord[0]),\n          'TileCol': tileCoord[1],\n          'TileRow': tileCoord[2]\n        };\n        assign(localContext, dimensions);\n        let url = template;\n        if (requestEncoding == WMTSRequestEncoding.KVP) {\n          url = appendParams(url, localContext);\n        } else {\n          url = url.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n            return localContext[p];\n          });\n        }\n        return url;\n      }\n    }\n  );\n}\n","/**\n * @module ol/geom/flat/closest\n */\nimport {lerp, squaredDistance as squaredDx} from '../../math.js';\n\n\n/**\n * Returns the point on the 2D line segment flatCoordinates[offset1] to\n * flatCoordinates[offset2] that is closest to the point (x, y).  Extra\n * dimensions are linearly interpolated.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset1 Offset 1.\n * @param {number} offset2 Offset 2.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array<number>} closestPoint Closest point.\n */\nfunction assignClosest(flatCoordinates, offset1, offset2, stride, x, y, closestPoint) {\n  const x1 = flatCoordinates[offset1];\n  const y1 = flatCoordinates[offset1 + 1];\n  const dx = flatCoordinates[offset2] - x1;\n  const dy = flatCoordinates[offset2 + 1] - y1;\n  let offset;\n  if (dx === 0 && dy === 0) {\n    offset = offset1;\n  } else {\n    const t = ((x - x1) * dx + (y - y1) * dy) / (dx * dx + dy * dy);\n    if (t > 1) {\n      offset = offset2;\n    } else if (t > 0) {\n      for (let i = 0; i < stride; ++i) {\n        closestPoint[i] = lerp(flatCoordinates[offset1 + i],\n          flatCoordinates[offset2 + i], t);\n      }\n      closestPoint.length = stride;\n      return;\n    } else {\n      offset = offset1;\n    }\n  }\n  for (let i = 0; i < stride; ++i) {\n    closestPoint[i] = flatCoordinates[offset + i];\n  }\n  closestPoint.length = stride;\n}\n\n\n/**\n * Return the squared of the largest distance between any pair of consecutive\n * coordinates.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function maxSquaredDelta(flatCoordinates, offset, end, stride, max) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  for (offset += stride; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    const squaredDelta = squaredDx(x1, y1, x2, y2);\n    if (squaredDelta > max) {\n      max = squaredDelta;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function arrayMaxSquaredDelta(flatCoordinates, offset, ends, stride, max) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    max = maxSquaredDelta(\n      flatCoordinates, offset, end, stride, max);\n    offset = end;\n  }\n  return max;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} max Max squared delta.\n * @return {number} Max squared delta.\n */\nexport function multiArrayMaxSquaredDelta(flatCoordinates, offset, endss, stride, max) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    max = arrayMaxSquaredDelta(\n      flatCoordinates, offset, ends, stride, max);\n    offset = ends[ends.length - 1];\n  }\n  return max;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestPoint(flatCoordinates, offset, end,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  if (offset == end) {\n    return minSquaredDistance;\n  }\n  let i, squaredDistance;\n  if (maxDelta === 0) {\n    // All points are identical, so just test the first point.\n    squaredDistance = squaredDx(\n      x, y, flatCoordinates[offset], flatCoordinates[offset + 1]);\n    if (squaredDistance < minSquaredDistance) {\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = flatCoordinates[offset + i];\n      }\n      closestPoint.length = stride;\n      return squaredDistance;\n    } else {\n      return minSquaredDistance;\n    }\n  }\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  let index = offset + stride;\n  while (index < end) {\n    assignClosest(\n      flatCoordinates, index - stride, index, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n      index += stride;\n    } else {\n      // Skip ahead multiple points, because we know that all the skipped\n      // points cannot be any closer than the closest point we have found so\n      // far.  We know this because we know how close the current point is, how\n      // close the closest point we have found so far is, and the maximum\n      // distance between consecutive points.  For example, if we're currently\n      // at distance 10, the best we've found so far is 3, and that the maximum\n      // distance between consecutive points is 2, then we'll need to skip at\n      // least (10 - 3) / 2 == 3 (rounded down) points to have any chance of\n      // finding a closer point.  We use Math.max(..., 1) to ensure that we\n      // always advance at least one point, to avoid an infinite loop.\n      index += stride * Math.max(\n        ((Math.sqrt(squaredDistance) -\n            Math.sqrt(minSquaredDistance)) / maxDelta) | 0, 1);\n    }\n  }\n  if (isRing) {\n    // Check the closing segment.\n    assignClosest(\n      flatCoordinates, end - stride, offset, stride, x, y, tmpPoint);\n    squaredDistance = squaredDx(x, y, tmpPoint[0], tmpPoint[1]);\n    if (squaredDistance < minSquaredDistance) {\n      minSquaredDistance = squaredDistance;\n      for (i = 0; i < stride; ++i) {\n        closestPoint[i] = tmpPoint[i];\n      }\n      closestPoint.length = stride;\n    }\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestArrayPoint(flatCoordinates, offset, ends,\n  stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    minSquaredDistance = assignClosestPoint(\n      flatCoordinates, offset, end, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = end;\n  }\n  return minSquaredDistance;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} maxDelta Max delta.\n * @param {boolean} isRing Is ring.\n * @param {number} x X.\n * @param {number} y Y.\n * @param {Array<number>} closestPoint Closest point.\n * @param {number} minSquaredDistance Minimum squared distance.\n * @param {Array<number>=} opt_tmpPoint Temporary point object.\n * @return {number} Minimum squared distance.\n */\nexport function assignClosestMultiArrayPoint(flatCoordinates, offset,\n  endss, stride, maxDelta, isRing, x, y, closestPoint, minSquaredDistance,\n  opt_tmpPoint) {\n  const tmpPoint = opt_tmpPoint ? opt_tmpPoint : [NaN, NaN];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    minSquaredDistance = assignClosestArrayPoint(\n      flatCoordinates, offset, ends, stride,\n      maxDelta, isRing, x, y, closestPoint, minSquaredDistance, tmpPoint);\n    offset = ends[ends.length - 1];\n  }\n  return minSquaredDistance;\n}\n","/**\n * @module ol/reproj/Image\n */\nimport {ERROR_THRESHOLD} from './common.js';\n\nimport ImageBase from '../ImageBase.js';\nimport ImageState from '../ImageState.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getCenter, getIntersection, getHeight, getWidth} from '../extent.js';\nimport {calculateSourceResolution, render as renderReprojected} from '../reproj.js';\nimport Triangulation from './Triangulation.js';\n\n\n/**\n * @typedef {function(import(\"../extent.js\").Extent, number, number) : import(\"../ImageBase.js\").default} FunctionType\n */\n\n\n/**\n * @classdesc\n * Class encapsulating single reprojected image.\n * See {@link module:ol/source/Image~ImageSource}.\n */\nclass ReprojImage extends ImageBase {\n  /**\n   * @param {import(\"../proj/Projection.js\").default} sourceProj Source projection (of the data).\n   * @param {import(\"../proj/Projection.js\").default} targetProj Target projection.\n   * @param {import(\"../extent.js\").Extent} targetExtent Target extent.\n   * @param {number} targetResolution Target resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {FunctionType} getImageFunction\n   *     Function returning source images (extent, resolution, pixelRatio).\n   */\n  constructor(sourceProj, targetProj, targetExtent, targetResolution, pixelRatio, getImageFunction) {\n    const maxSourceExtent = sourceProj.getExtent();\n    const maxTargetExtent = targetProj.getExtent();\n\n    const limitedTargetExtent = maxTargetExtent ?\n      getIntersection(targetExtent, maxTargetExtent) : targetExtent;\n\n    const targetCenter = getCenter(limitedTargetExtent);\n    const sourceResolution = calculateSourceResolution(\n      sourceProj, targetProj, targetCenter, targetResolution);\n\n    const errorThresholdInPixels = ERROR_THRESHOLD;\n\n    const triangulation = new Triangulation(\n      sourceProj, targetProj, limitedTargetExtent, maxSourceExtent,\n      sourceResolution * errorThresholdInPixels);\n\n    const sourceExtent = triangulation.calculateSourceExtent();\n    const sourceImage = getImageFunction(sourceExtent, sourceResolution, pixelRatio);\n    const state = sourceImage ? ImageState.IDLE : ImageState.EMPTY;\n    const sourcePixelRatio = sourceImage ? sourceImage.getPixelRatio() : 1;\n\n    super(targetExtent, targetResolution, sourcePixelRatio, state);\n\n    /**\n     * @private\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.targetProj_ = targetProj;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.maxSourceExtent_ = maxSourceExtent;\n\n    /**\n     * @private\n     * @type {!import(\"./Triangulation.js\").default}\n     */\n    this.triangulation_ = triangulation;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.targetResolution_ = targetResolution;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.targetExtent_ = targetExtent;\n\n    /**\n     * @private\n     * @type {import(\"../ImageBase.js\").default}\n     */\n    this.sourceImage_ = sourceImage;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.sourcePixelRatio_ = sourcePixelRatio;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../events.js\").EventsKey}\n     */\n    this.sourceListenerKey_ = null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    if (this.state == ImageState.LOADING) {\n      this.unlistenSource_();\n    }\n    super.disposeInternal();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImage() {\n    return this.canvas_;\n  }\n\n  /**\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  getProjection() {\n    return this.targetProj_;\n  }\n\n  /**\n   * @private\n   */\n  reproject_() {\n    const sourceState = this.sourceImage_.getState();\n    if (sourceState == ImageState.LOADED) {\n      const width = getWidth(this.targetExtent_) / this.targetResolution_;\n      const height = getHeight(this.targetExtent_) / this.targetResolution_;\n\n      this.canvas_ = renderReprojected(width, height, this.sourcePixelRatio_,\n        this.sourceImage_.getResolution(), this.maxSourceExtent_,\n        this.targetResolution_, this.targetExtent_, this.triangulation_, [{\n          extent: this.sourceImage_.getExtent(),\n          image: this.sourceImage_.getImage()\n        }], 0);\n    }\n    this.state = sourceState;\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  load() {\n    if (this.state == ImageState.IDLE) {\n      this.state = ImageState.LOADING;\n      this.changed();\n\n      const sourceState = this.sourceImage_.getState();\n      if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {\n        this.reproject_();\n      } else {\n        this.sourceListenerKey_ = listen(this.sourceImage_,\n          EventType.CHANGE, function(e) {\n            const sourceState = this.sourceImage_.getState();\n            if (sourceState == ImageState.LOADED || sourceState == ImageState.ERROR) {\n              this.unlistenSource_();\n              this.reproject_();\n            }\n          }, this);\n        this.sourceImage_.load();\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  unlistenSource_() {\n    unlistenByKey(/** @type {!import(\"../events.js\").EventsKey} */ (this.sourceListenerKey_));\n    this.sourceListenerKey_ = null;\n  }\n}\n\n\nexport default ReprojImage;\n","/**\n * @module ol/source/Image\n */\nimport {abstract} from '../util.js';\nimport {ENABLE_RASTER_REPROJECTION} from '../reproj/common.js';\nimport ImageState from '../ImageState.js';\nimport {linearFindNearest} from '../array.js';\nimport Event from '../events/Event.js';\nimport {equals} from '../extent.js';\nimport {equivalent} from '../proj.js';\nimport ReprojImage from '../reproj/Image.js';\nimport Source from './Source.js';\n\n\n/**\n * @enum {string}\n */\nconst ImageSourceEventType = {\n\n  /**\n   * Triggered when an image starts loading.\n   * @event module:ol/source/Image.ImageSourceEvent#imageloadstart\n   * @api\n   */\n  IMAGELOADSTART: 'imageloadstart',\n\n  /**\n   * Triggered when an image finishes loading.\n   * @event module:ol/source/Image.ImageSourceEvent#imageloadend\n   * @api\n   */\n  IMAGELOADEND: 'imageloadend',\n\n  /**\n   * Triggered if image loading results in an error.\n   * @event module:ol/source/Image.ImageSourceEvent#imageloaderror\n   * @api\n   */\n  IMAGELOADERROR: 'imageloaderror'\n\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Image~ImageSource} instances are instances of this\n * type.\n */\nexport class ImageSourceEvent extends Event {\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../Image.js\").default} image The image.\n   */\n  constructor(type, image) {\n\n    super(type);\n\n    /**\n     * The image related to the event.\n     * @type {import(\"../Image.js\").default}\n     * @api\n     */\n    this.image = image;\n\n  }\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions]\n * @property {import(\"../proj.js\").ProjectionLike} [projection]\n * @property {Array<number>} [resolutions]\n * @property {import(\"./State.js\").default} [state]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing a single image.\n * @abstract\n * @fires module:ol/source/Image.ImageSourceEvent\n * @api\n */\nclass ImageSource extends Source {\n  /**\n   * @param {Options} options Single image source options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      projection: options.projection,\n      state: options.state\n    });\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.resolutions_ = options.resolutions !== undefined ?\n      options.resolutions : null;\n\n\n    /**\n     * @private\n     * @type {import(\"../reproj/Image.js\").default}\n     */\n    this.reprojectedImage_ = null;\n\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.reprojectedRevision_ = 0;\n  }\n\n  /**\n   * @return {Array<number>} Resolutions.\n   * @override\n   */\n  getResolutions() {\n    return this.resolutions_;\n  }\n\n  /**\n   * @protected\n   * @param {number} resolution Resolution.\n   * @return {number} Resolution.\n   */\n  findNearestResolution(resolution) {\n    if (this.resolutions_) {\n      const idx = linearFindNearest(this.resolutions_, resolution, 0);\n      resolution = this.resolutions_[idx];\n    }\n    return resolution;\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../ImageBase.js\").default} Single image.\n   */\n  getImage(extent, resolution, pixelRatio, projection) {\n    const sourceProjection = this.getProjection();\n    if (!ENABLE_RASTER_REPROJECTION ||\n        !sourceProjection ||\n        !projection ||\n        equivalent(sourceProjection, projection)) {\n      if (sourceProjection) {\n        projection = sourceProjection;\n      }\n      return this.getImageInternal(extent, resolution, pixelRatio, projection);\n    } else {\n      if (this.reprojectedImage_) {\n        if (this.reprojectedRevision_ == this.getRevision() &&\n            equivalent(\n              this.reprojectedImage_.getProjection(), projection) &&\n            this.reprojectedImage_.getResolution() == resolution &&\n            equals(this.reprojectedImage_.getExtent(), extent)) {\n          return this.reprojectedImage_;\n        }\n        this.reprojectedImage_.dispose();\n        this.reprojectedImage_ = null;\n      }\n\n      this.reprojectedImage_ = new ReprojImage(\n        sourceProjection, projection, extent, resolution, pixelRatio,\n        function(extent, resolution, pixelRatio) {\n          return this.getImageInternal(extent, resolution,\n            pixelRatio, sourceProjection);\n        }.bind(this));\n      this.reprojectedRevision_ = this.getRevision();\n\n      return this.reprojectedImage_;\n    }\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../ImageBase.js\").default} Single image.\n   * @protected\n   */\n  getImageInternal(extent, resolution, pixelRatio, projection) {\n    return abstract();\n  }\n\n  /**\n   * Handle image change events.\n   * @param {import(\"../events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleImageChange(event) {\n    const image = /** @type {import(\"../Image.js\").default} */ (event.target);\n    switch (image.getState()) {\n      case ImageState.LOADING:\n        this.loading = true;\n        this.dispatchEvent(\n          new ImageSourceEvent(ImageSourceEventType.IMAGELOADSTART,\n            image));\n        break;\n      case ImageState.LOADED:\n        this.loading = false;\n        this.dispatchEvent(\n          new ImageSourceEvent(ImageSourceEventType.IMAGELOADEND,\n            image));\n        break;\n      case ImageState.ERROR:\n        this.loading = false;\n        this.dispatchEvent(\n          new ImageSourceEvent(ImageSourceEventType.IMAGELOADERROR,\n            image));\n        break;\n      default:\n        // pass\n    }\n  }\n}\n\n\n/**\n * Default image load function for image sources that use import(\"../Image.js\").Image image\n * instances.\n * @param {import(\"../Image.js\").default} image Image.\n * @param {string} src Source.\n */\nexport function defaultImageLoadFunction(image, src) {\n  /** @type {HTMLImageElement|HTMLVideoElement} */ (image.getImage()).src = src;\n}\n\nexport default ImageSource;\n","/**\n * @module ol/format/KML\n */\nimport Feature from '../Feature.js';\nimport {extend, includes} from '../array.js';\nimport {assert} from '../asserts.js';\nimport {asArray} from '../color.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport XMLFeature from './XMLFeature.js';\nimport {readDecimal, readBoolean, readString, writeStringTextNode, writeCDATASection, writeDecimalTextNode, writeBooleanTextNode} from './xsd.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {toRadians} from '../math.js';\nimport {get as getProjection} from '../proj.js';\nimport Fill from '../style/Fill.js';\nimport Icon from '../style/Icon.js';\nimport IconAnchorUnits from '../style/IconAnchorUnits.js';\nimport IconOrigin from '../style/IconOrigin.js';\nimport Stroke from '../style/Stroke.js';\nimport Style from '../style/Style.js';\nimport Text from '../style/Text.js';\nimport {createElementNS, getAllTextContent, isDocument, makeArrayExtender,\n  makeArrayPusher, makeChildAppender, makeObjectPropertySetter,\n  makeReplacer, makeSequence, makeSimpleNodeFactory, makeStructureNS,\n  OBJECT_PROPERTY_NODE_FACTORY, parse, parseNode, pushParseAndPop,\n  pushSerializeAndPop, XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n/**\n * @typedef {Object} Vec2\n * @property {number} x\n * @property {IconAnchorUnits} xunits\n * @property {number} y\n * @property {IconAnchorUnits} yunits\n * @property {IconOrigin} origin\n */\n\n/**\n * @typedef {Object} GxTrackObject\n * @property {Array<number>} flatCoordinates\n * @property {Array<number>} whens\n */\n\n\n/**\n * @const\n * @type {Array<string>}\n */\nconst GX_NAMESPACE_URIS = [\n  'http://www.google.com/kml/ext/2.2'\n];\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://earth.google.com/kml/2.0',\n  'http://earth.google.com/kml/2.1',\n  'http://earth.google.com/kml/2.2',\n  'http://www.opengis.net/kml/2.2'\n];\n\n\n/**\n * @const\n * @type {string}\n */\nconst SCHEMA_LOCATION = 'http://www.opengis.net/kml/2.2 ' +\n    'https://developers.google.com/kml/schema/kml22gx.xsd';\n\n\n/**\n * @type {Object<string, IconAnchorUnits>}\n */\nconst ICON_ANCHOR_UNITS_MAP = {\n  'fraction': IconAnchorUnits.FRACTION,\n  'pixels': IconAnchorUnits.PIXELS,\n  'insetPixels': IconAnchorUnits.PIXELS\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PLACEMARK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': extendedDataParser,\n    'Region': regionParser,\n    'MultiGeometry': makeObjectPropertySetter(\n      readMultiGeometry, 'geometry'),\n    'LineString': makeObjectPropertySetter(\n      readLineString, 'geometry'),\n    'LinearRing': makeObjectPropertySetter(\n      readLinearRing, 'geometry'),\n    'Point': makeObjectPropertySetter(\n      readPoint, 'geometry'),\n    'Polygon': makeObjectPropertySetter(\n      readPolygon, 'geometry'),\n    'Style': makeObjectPropertySetter(readStyle),\n    'StyleMap': placemarkStyleMapParser,\n    'address': makeObjectPropertySetter(readString),\n    'description': makeObjectPropertySetter(readString),\n    'name': makeObjectPropertySetter(readString),\n    'open': makeObjectPropertySetter(readBoolean),\n    'phoneNumber': makeObjectPropertySetter(readString),\n    'styleUrl': makeObjectPropertySetter(readURI),\n    'visibility': makeObjectPropertySetter(readBoolean)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'MultiTrack': makeObjectPropertySetter(\n        readGxMultiTrack, 'geometry'),\n      'Track': makeObjectPropertySetter(\n        readGxTrack, 'geometry')\n    }\n  ));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst NETWORK_LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': extendedDataParser,\n    'Region': regionParser,\n    'Link': linkParser,\n    'address': makeObjectPropertySetter(readString),\n    'description': makeObjectPropertySetter(readString),\n    'name': makeObjectPropertySetter(readString),\n    'open': makeObjectPropertySetter(readBoolean),\n    'phoneNumber': makeObjectPropertySetter(readString),\n    'visibility': makeObjectPropertySetter(readBoolean)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeObjectPropertySetter(readURI)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst REGION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LatLonAltBox': latLonAltBoxParser,\n    'Lod': lodParser\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst KML_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'Document', 'Placemark'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst KML_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Document': makeChildAppender(writeDocument),\n    'Placemark': makeChildAppender(writePlacemark)\n  });\n\n\n/**\n * @type {import(\"../color.js\").Color}\n */\nlet DEFAULT_COLOR;\n\n/**\n * @type {Fill}\n */\nlet DEFAULT_FILL_STYLE = null;\n\n/**\n * Get the default fill style (or null if not yet set).\n * @return {Fill} The default fill style.\n */\nexport function getDefaultFillStyle() {\n  return DEFAULT_FILL_STYLE;\n}\n\n/**\n * @type {import(\"../size.js\").Size}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR;\n\n/**\n * @type {IconAnchorUnits}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\n\n/**\n * @type {IconAnchorUnits}\n */\nlet DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\n\n/**\n * @type {import(\"../size.js\").Size}\n */\nlet DEFAULT_IMAGE_STYLE_SIZE;\n\n/**\n * @type {string}\n */\nlet DEFAULT_IMAGE_STYLE_SRC;\n\n/**\n * @type {number}\n */\nlet DEFAULT_IMAGE_SCALE_MULTIPLIER;\n\n/**\n * @type {import(\"../style/Image.js\").default}\n */\nlet DEFAULT_IMAGE_STYLE = null;\n\n/**\n * Get the default image style (or null if not yet set).\n * @return {import(\"../style/Image.js\").default} The default image style.\n */\nexport function getDefaultImageStyle() {\n  return DEFAULT_IMAGE_STYLE;\n}\n\n/**\n * @type {string}\n */\nlet DEFAULT_NO_IMAGE_STYLE;\n\n/**\n * @type {Stroke}\n */\nlet DEFAULT_STROKE_STYLE = null;\n\n/**\n * Get the default stroke style (or null if not yet set).\n * @return {Stroke} The default stroke style.\n */\nexport function getDefaultStrokeStyle() {\n  return DEFAULT_STROKE_STYLE;\n}\n\n/**\n * @type {Stroke}\n */\nlet DEFAULT_TEXT_STROKE_STYLE;\n\n/**\n * @type {Text}\n */\nlet DEFAULT_TEXT_STYLE = null;\n\n/**\n * Get the default text style (or null if not yet set).\n * @return {Text} The default text style.\n */\nexport function getDefaultTextStyle() {\n  return DEFAULT_TEXT_STYLE;\n}\n\n/**\n * @type {Style}\n */\nlet DEFAULT_STYLE = null;\n\n/**\n * Get the default style (or null if not yet set).\n * @return {Style} The default style.\n */\nexport function getDefaultStyle() {\n  return DEFAULT_STYLE;\n}\n\n/**\n * @type {Array<Style>}\n */\nlet DEFAULT_STYLE_ARRAY = null;\n\n/**\n * Get the default style array (or null if not yet set).\n * @return {Array<Style>} The default style.\n */\nexport function getDefaultStyleArray() {\n  return DEFAULT_STYLE_ARRAY;\n}\n\n\nfunction createStyleDefaults() {\n\n  DEFAULT_COLOR = [255, 255, 255, 1];\n\n  DEFAULT_FILL_STYLE = new Fill({\n    color: DEFAULT_COLOR\n  });\n\n  DEFAULT_IMAGE_STYLE_ANCHOR = [20, 2]; // FIXME maybe [8, 32] ?\n\n  DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS = IconAnchorUnits.PIXELS;\n\n  DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS = IconAnchorUnits.PIXELS;\n\n  DEFAULT_IMAGE_STYLE_SIZE = [64, 64];\n\n  DEFAULT_IMAGE_STYLE_SRC =\n      'https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png';\n\n  DEFAULT_IMAGE_SCALE_MULTIPLIER = 0.5;\n\n  DEFAULT_IMAGE_STYLE = new Icon({\n    anchor: DEFAULT_IMAGE_STYLE_ANCHOR,\n    anchorOrigin: IconOrigin.BOTTOM_LEFT,\n    anchorXUnits: DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS,\n    anchorYUnits: DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS,\n    crossOrigin: 'anonymous',\n    rotation: 0,\n    scale: DEFAULT_IMAGE_SCALE_MULTIPLIER,\n    size: DEFAULT_IMAGE_STYLE_SIZE,\n    src: DEFAULT_IMAGE_STYLE_SRC\n  });\n\n  DEFAULT_NO_IMAGE_STYLE = 'NO_IMAGE';\n\n  DEFAULT_STROKE_STYLE = new Stroke({\n    color: DEFAULT_COLOR,\n    width: 1\n  });\n\n  DEFAULT_TEXT_STROKE_STYLE = new Stroke({\n    color: [51, 51, 51, 1],\n    width: 2\n  });\n\n  DEFAULT_TEXT_STYLE = new Text({\n    font: 'bold 16px Helvetica',\n    fill: DEFAULT_FILL_STYLE,\n    stroke: DEFAULT_TEXT_STROKE_STYLE,\n    scale: 0.8\n  });\n\n  DEFAULT_STYLE = new Style({\n    fill: DEFAULT_FILL_STYLE,\n    image: DEFAULT_IMAGE_STYLE,\n    text: DEFAULT_TEXT_STYLE,\n    stroke: DEFAULT_STROKE_STYLE,\n    zIndex: 0\n  });\n\n  DEFAULT_STYLE_ARRAY = [DEFAULT_STYLE];\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [extractStyles=true] Extract styles from the KML.\n * @property {boolean} [showPointNames=true] Show names as labels for placemarks which contain points.\n * @property {Array<Style>} [defaultStyle] Default style. The\n * default default style is the same as Google Earth.\n * @property {boolean} [writeStyles=true] Write styles into KML.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the KML format.\n *\n * {@link module:ol/format/KML~KML#readFeature} will read the first feature from\n * a KML source.\n *\n * MultiGeometries are converted into GeometryCollections if they are a mix of\n * geometry types, and into MultiPoint/MultiLineString/MultiPolygon if they are\n * all of the same type.\n *\n * Note that the KML format uses the URL() constructor. Older browsers such as IE\n * which do not support this will need a URL polyfill to be loaded before use.\n *\n * @api\n */\nclass KML extends XMLFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    if (!DEFAULT_STYLE_ARRAY) {\n      createStyleDefaults();\n    }\n\n    /**\n     * @inheritDoc\n     */\n    this.dataProjection = getProjection('EPSG:4326');\n\n    /**\n     * @private\n     * @type {Array<Style>}\n     */\n    this.defaultStyle_ = options.defaultStyle ?\n      options.defaultStyle : DEFAULT_STYLE_ARRAY;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.extractStyles_ = options.extractStyles !== undefined ?\n      options.extractStyles : true;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.writeStyles_ = options.writeStyles !== undefined ?\n      options.writeStyles : true;\n\n    /**\n     * @private\n     * @type {!Object<string, (Array<Style>|string)>}\n     */\n    this.sharedStyles_ = {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.showPointNames_ = options.showPointNames !== undefined ?\n      options.showPointNames : true;\n\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Array<Feature>|undefined} Features.\n   */\n  readDocumentOrFolder_(node, objectStack) {\n    // FIXME use scope somehow\n    const parsersNS = makeStructureNS(\n      NAMESPACE_URIS, {\n        'Document': makeArrayExtender(this.readDocumentOrFolder_, this),\n        'Folder': makeArrayExtender(this.readDocumentOrFolder_, this),\n        'Placemark': makeArrayPusher(this.readPlacemark_, this),\n        'Style': this.readSharedStyle_.bind(this),\n        'StyleMap': this.readSharedStyleMap_.bind(this)\n      });\n    /** @type {Array<Feature>} */\n    // @ts-ignore\n    const features = pushParseAndPop([], parsersNS, node, objectStack, this);\n    if (features) {\n      return features;\n    } else {\n      return undefined;\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Feature|undefined} Feature.\n   */\n  readPlacemark_(node, objectStack) {\n    const object = pushParseAndPop({'geometry': null},\n      PLACEMARK_PARSERS, node, objectStack);\n    if (!object) {\n      return undefined;\n    }\n    const feature = new Feature();\n    const id = node.getAttribute('id');\n    if (id !== null) {\n      feature.setId(id);\n    }\n    const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (objectStack[0]);\n\n    const geometry = object['geometry'];\n    if (geometry) {\n      transformGeometryWithOptions(geometry, false, options);\n    }\n    feature.setGeometry(geometry);\n    delete object['geometry'];\n\n    if (this.extractStyles_) {\n      const style = object['Style'];\n      const styleUrl = object['styleUrl'];\n      const styleFunction = createFeatureStyleFunction(\n        style, styleUrl, this.defaultStyle_, this.sharedStyles_,\n        this.showPointNames_);\n      feature.setStyle(styleFunction);\n    }\n    delete object['Style'];\n    // we do not remove the styleUrl property from the object, so it\n    // gets stored on feature when setProperties is called\n\n    feature.setProperties(object, true);\n\n    return feature;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  readSharedStyle_(node, objectStack) {\n    const id = node.getAttribute('id');\n    if (id !== null) {\n      const style = readStyle(node, objectStack);\n      if (style) {\n        let styleUri;\n        let baseURI = node.baseURI;\n        if (!baseURI || baseURI == 'about:blank') {\n          baseURI = window.location.href;\n        }\n        if (baseURI) {\n          const url = new URL('#' + id, baseURI);\n          styleUri = url.href;\n        } else {\n          styleUri = '#' + id;\n        }\n        this.sharedStyles_[styleUri] = style;\n      }\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  readSharedStyleMap_(node, objectStack) {\n    const id = node.getAttribute('id');\n    if (id === null) {\n      return;\n    }\n    const styleMapValue = readStyleMapValue(node, objectStack);\n    if (!styleMapValue) {\n      return;\n    }\n    let styleUri;\n    let baseURI = node.baseURI;\n    if (!baseURI || baseURI == 'about:blank') {\n      baseURI = window.location.href;\n    }\n    if (baseURI) {\n      const url = new URL('#' + id, baseURI);\n      styleUri = url.href;\n    } else {\n      styleUri = '#' + id;\n    }\n    this.sharedStyles_[styleUri] = styleMapValue;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromNode(node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return null;\n    }\n    const feature = this.readPlacemark_(\n      node, [this.getReadOptions(node, opt_options)]);\n    if (feature) {\n      return feature;\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromNode(node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return [];\n    }\n    let features;\n    const localName = node.localName;\n    if (localName == 'Document' || localName == 'Folder') {\n      features = this.readDocumentOrFolder_(\n        node, [this.getReadOptions(node, opt_options)]);\n      if (features) {\n        return features;\n      } else {\n        return [];\n      }\n    } else if (localName == 'Placemark') {\n      const feature = this.readPlacemark_(\n        node, [this.getReadOptions(node, opt_options)]);\n      if (feature) {\n        return [feature];\n      } else {\n        return [];\n      }\n    } else if (localName == 'kml') {\n      features = [];\n      for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n        const fs = this.readFeaturesFromNode(n, opt_options);\n        if (fs) {\n          extend(features, fs);\n        }\n      }\n      return features;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * Read the name of the KML.\n   *\n   * @param {Document|Element|string} source Source.\n   * @return {string|undefined} Name.\n   * @api\n   */\n  readName(source) {\n    if (!source) {\n      return undefined;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readNameFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readNameFromDocument(/** @type {Document} */ (source));\n    } else {\n      return this.readNameFromNode(/** @type {Element} */ (source));\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {string|undefined} Name.\n   */\n  readNameFromDocument(doc) {\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        const name = this.readNameFromNode(/** @type {Element} */ (n));\n        if (name) {\n          return name;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {string|undefined} Name.\n   */\n  readNameFromNode(node) {\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          n.localName == 'name') {\n        return readString(n);\n      }\n    }\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const localName = n.localName;\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          (localName == 'Document' ||\n            localName == 'Folder' ||\n            localName == 'Placemark' ||\n            localName == 'kml')) {\n        const name = this.readNameFromNode(n);\n        if (name) {\n          return name;\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * Read the network links of the KML.\n   *\n   * @param {Document|Element|string} source Source.\n   * @return {Array<Object>} Network links.\n   * @api\n   */\n  readNetworkLinks(source) {\n    const networkLinks = [];\n    if (typeof source === 'string') {\n      const doc = parse(source);\n      extend(networkLinks, this.readNetworkLinksFromDocument(doc));\n    } else if (isDocument(source)) {\n      extend(networkLinks, this.readNetworkLinksFromDocument(\n        /** @type {Document} */ (source)));\n    } else {\n      extend(networkLinks, this.readNetworkLinksFromNode(\n        /** @type {Element} */ (source)));\n    }\n    return networkLinks;\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {Array<Object>} Network links.\n   */\n  readNetworkLinksFromDocument(doc) {\n    const networkLinks = [];\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        extend(networkLinks, this.readNetworkLinksFromNode(/** @type {Element} */ (n)));\n      }\n    }\n    return networkLinks;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {Array<Object>} Network links.\n   */\n  readNetworkLinksFromNode(node) {\n    const networkLinks = [];\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          n.localName == 'NetworkLink') {\n        const obj = pushParseAndPop({}, NETWORK_LINK_PARSERS,\n          n, []);\n        networkLinks.push(obj);\n      }\n    }\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const localName = n.localName;\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          (localName == 'Document' ||\n            localName == 'Folder' ||\n            localName == 'kml')) {\n        extend(networkLinks, this.readNetworkLinksFromNode(n));\n      }\n    }\n    return networkLinks;\n  }\n\n  /**\n   * Read the regions of the KML.\n   *\n   * @param {Document|Element|string} source Source.\n   * @return {Array<Object>} Regions.\n   * @api\n   */\n  readRegion(source) {\n    const regions = [];\n    if (typeof source === 'string') {\n      const doc = parse(source);\n      extend(regions, this.readRegionFromDocument(doc));\n    } else if (isDocument(source)) {\n      extend(regions, this.readRegionFromDocument(\n        /** @type {Document} */ (source)));\n    } else {\n      extend(regions, this.readRegionFromNode(\n        /** @type {Element} */ (source)));\n    }\n    return regions;\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @return {Array<Object>} Region.\n   */\n  readRegionFromDocument(doc) {\n    const regions = [];\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        extend(regions, this.readRegionFromNode(/** @type {Element} */ (n)));\n      }\n    }\n    return regions;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @return {Array<Object>} Region.\n   * @api\n   */\n  readRegionFromNode(node) {\n    const regions = [];\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          n.localName == 'Region') {\n        const obj = pushParseAndPop({}, REGION_PARSERS,\n          n, []);\n        regions.push(obj);\n      }\n    }\n    for (let n = node.firstElementChild; n; n = n.nextElementSibling) {\n      const localName = n.localName;\n      if (includes(NAMESPACE_URIS, n.namespaceURI) &&\n          (localName == 'Document' ||\n            localName == 'Folder' ||\n            localName == 'kml')) {\n        extend(regions, this.readRegionFromNode(n));\n      }\n    }\n    return regions;\n  }\n\n  /**\n   * Encode an array of features in the KML format as an XML node. GeometryCollections,\n   * MultiPoints, MultiLineStrings, and MultiPolygons are output as MultiGeometries.\n   *\n   * @param {Array<Feature>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\n   * @return {Node} Node.\n   * @override\n   * @api\n   */\n  writeFeaturesNode(features, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n    const kml = createElementNS(NAMESPACE_URIS[4], 'kml');\n    const xmlnsUri = 'http://www.w3.org/2000/xmlns/';\n    kml.setAttributeNS(xmlnsUri, 'xmlns:gx', GX_NAMESPACE_URIS[0]);\n    kml.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\n    kml.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\n\n    const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: kml};\n    /** @type {!Object<string, (Array<Feature>|Feature|undefined)>} */\n    const properties = {};\n    if (features.length > 1) {\n      properties['Document'] = features;\n    } else if (features.length == 1) {\n      properties['Placemark'] = features[0];\n    }\n    const orderedKeys = KML_SEQUENCE[kml.namespaceURI];\n    const values = makeSequence(properties, orderedKeys);\n    pushSerializeAndPop(context, KML_SERIALIZERS,\n      OBJECT_PROPERTY_NODE_FACTORY, values, [opt_options], orderedKeys,\n      this);\n    return kml;\n  }\n}\n\n\n/**\n * @param {Style|undefined} foundStyle Style.\n * @param {string} name Name.\n * @return {Style} style Style.\n */\nfunction createNameStyleFunction(foundStyle, name) {\n  let textStyle = null;\n  const textOffset = [0, 0];\n  let textAlign = 'start';\n  if (foundStyle.getImage()) {\n    let imageSize = foundStyle.getImage().getImageSize();\n    if (imageSize === null) {\n      imageSize = DEFAULT_IMAGE_STYLE_SIZE;\n    }\n    if (imageSize.length == 2) {\n      const imageScale = foundStyle.getImage().getScale();\n      // Offset the label to be centered to the right of the icon, if there is\n      // one.\n      textOffset[0] = imageScale * imageSize[0] / 2;\n      textOffset[1] = -imageScale * imageSize[1] / 2;\n      textAlign = 'left';\n    }\n  }\n  if (foundStyle.getText() !== null) {\n    // clone the text style, customizing it with name, alignments and offset.\n    // Note that kml does not support many text options that OpenLayers does (rotation, textBaseline).\n    const foundText = foundStyle.getText();\n    textStyle = foundText.clone();\n    textStyle.setFont(foundText.getFont() || DEFAULT_TEXT_STYLE.getFont());\n    textStyle.setScale(foundText.getScale() || DEFAULT_TEXT_STYLE.getScale());\n    textStyle.setFill(foundText.getFill() || DEFAULT_TEXT_STYLE.getFill());\n    textStyle.setStroke(foundText.getStroke() || DEFAULT_TEXT_STROKE_STYLE);\n  } else {\n    textStyle = DEFAULT_TEXT_STYLE.clone();\n  }\n  textStyle.setText(name);\n  textStyle.setOffsetX(textOffset[0]);\n  textStyle.setOffsetY(textOffset[1]);\n  textStyle.setTextAlign(textAlign);\n\n  const nameStyle = new Style({\n    text: textStyle\n  });\n  return nameStyle;\n}\n\n\n/**\n * @param {Array<Style>|undefined} style Style.\n * @param {string} styleUrl Style URL.\n * @param {Array<Style>} defaultStyle Default style.\n * @param {!Object<string, (Array<Style>|string)>} sharedStyles Shared styles.\n * @param {boolean|undefined} showPointNames true to show names for point placemarks.\n * @return {import(\"../style/Style.js\").StyleFunction} Feature style function.\n */\nfunction createFeatureStyleFunction(style, styleUrl, defaultStyle, sharedStyles, showPointNames) {\n\n  return (\n    /**\n     * @param {Feature} feature feature.\n     * @param {number} resolution Resolution.\n     * @return {Array<Style>} Style.\n     */\n    function(feature, resolution) {\n      let drawName = showPointNames;\n      /** @type {Style|undefined} */\n      let nameStyle;\n      let name = '';\n      if (drawName) {\n        const geometry = feature.getGeometry();\n        if (geometry) {\n          drawName = geometry.getType() === GeometryType.POINT;\n        }\n      }\n\n      if (drawName) {\n        name = /** @type {string} */ (feature.get('name'));\n        drawName = drawName && !!name;\n      }\n\n      if (style) {\n        if (drawName) {\n          nameStyle = createNameStyleFunction(style[0], name);\n          return style.concat(nameStyle);\n        }\n        return style;\n      }\n      if (styleUrl) {\n        const foundStyle = findStyle(styleUrl, defaultStyle, sharedStyles);\n        if (drawName) {\n          nameStyle = createNameStyleFunction(foundStyle[0], name);\n          return foundStyle.concat(nameStyle);\n        }\n        return foundStyle;\n      }\n      if (drawName) {\n        nameStyle = createNameStyleFunction(defaultStyle[0], name);\n        return defaultStyle.concat(nameStyle);\n      }\n      return defaultStyle;\n    }\n  );\n}\n\n\n/**\n * @param {Array<Style>|string|undefined} styleValue Style value.\n * @param {Array<Style>} defaultStyle Default style.\n * @param {!Object<string, (Array<Style>|string)>} sharedStyles\n * Shared styles.\n * @return {Array<Style>} Style.\n */\nfunction findStyle(styleValue, defaultStyle, sharedStyles) {\n  if (Array.isArray(styleValue)) {\n    return styleValue;\n  } else if (typeof styleValue === 'string') {\n    // KML files in the wild occasionally forget the leading `#` on styleUrls\n    // defined in the same document.  Add a leading `#` if it enables to find\n    // a style.\n    if (!(styleValue in sharedStyles) && ('#' + styleValue in sharedStyles)) {\n      styleValue = '#' + styleValue;\n    }\n    return findStyle(sharedStyles[styleValue], defaultStyle, sharedStyles);\n  } else {\n    return defaultStyle;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {import(\"../color.js\").Color|undefined} Color.\n */\nfunction readColor(node) {\n  const s = getAllTextContent(node, false);\n  // The KML specification states that colors should not include a leading `#`\n  // but we tolerate them.\n  const m = /^\\s*#?\\s*([0-9A-Fa-f]{8})\\s*$/.exec(s);\n  if (m) {\n    const hexColor = m[1];\n    return [\n      parseInt(hexColor.substr(6, 2), 16),\n      parseInt(hexColor.substr(4, 2), 16),\n      parseInt(hexColor.substr(2, 2), 16),\n      parseInt(hexColor.substr(0, 2), 16) / 255\n    ];\n\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {Array<number>|undefined} Flat coordinates.\n */\nexport function readFlatCoordinates(node) {\n  let s = getAllTextContent(node, false);\n  const flatCoordinates = [];\n  // The KML specification states that coordinate tuples should not include\n  // spaces, but we tolerate them.\n  const re =\n      /^\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?)(?:\\s*,\\s*([+\\-]?\\d*\\.?\\d+(?:e[+\\-]?\\d+)?))?\\s*/i;\n  let m;\n  while ((m = re.exec(s))) {\n    const x = parseFloat(m[1]);\n    const y = parseFloat(m[2]);\n    const z = m[3] ? parseFloat(m[3]) : 0;\n    flatCoordinates.push(x, y, z);\n    s = s.substr(m[0].length);\n  }\n  if (s !== '') {\n    return undefined;\n  }\n  return flatCoordinates;\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {string} URI.\n */\nfunction readURI(node) {\n  const s = getAllTextContent(node, false).trim();\n  let baseURI = node.baseURI;\n  if (!baseURI || baseURI == 'about:blank') {\n    baseURI = window.location.href;\n  }\n  if (baseURI) {\n    const url = new URL(s, baseURI);\n    return url.href;\n  } else {\n    return s;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @return {Vec2} Vec2.\n */\nfunction readVec2(node) {\n  const xunits = node.getAttribute('xunits');\n  const yunits = node.getAttribute('yunits');\n  let origin;\n  if (xunits !== 'insetPixels') {\n    if (yunits !== 'insetPixels') {\n      origin = IconOrigin.BOTTOM_LEFT;\n    } else {\n      origin = IconOrigin.TOP_LEFT;\n    }\n  } else {\n    if (yunits !== 'insetPixels') {\n      origin = IconOrigin.BOTTOM_RIGHT;\n    } else {\n      origin = IconOrigin.TOP_RIGHT;\n    }\n  }\n  return {\n    x: parseFloat(node.getAttribute('x')),\n    xunits: ICON_ANCHOR_UNITS_MAP[xunits],\n    y: parseFloat(node.getAttribute('y')),\n    yunits: ICON_ANCHOR_UNITS_MAP[yunits],\n    origin: origin\n  };\n}\n\n\n/**\n * @param {Node} node Node.\n * @return {number|undefined} Scale.\n */\nfunction readScale(node) {\n  return readDecimal(node);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst STYLE_MAP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Pair': pairDataParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<Style>|string|undefined} StyleMap.\n */\nfunction readStyleMapValue(node, objectStack) {\n  return pushParseAndPop(undefined,\n    STYLE_MAP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst ICON_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Icon': makeObjectPropertySetter(readIcon),\n    'heading': makeObjectPropertySetter(readDecimal),\n    'hotSpot': makeObjectPropertySetter(readVec2),\n    'scale': makeObjectPropertySetter(readScale)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction iconStyleParser(node, objectStack) {\n  // FIXME refreshMode\n  // FIXME refreshInterval\n  // FIXME viewRefreshTime\n  // FIXME viewBoundScale\n  // FIXME viewFormat\n  // FIXME httpQuery\n  const object = pushParseAndPop(\n    {}, ICON_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const IconObject = 'Icon' in object ? object['Icon'] : {};\n  const drawIcon = (!('Icon' in object) || Object.keys(IconObject).length > 0);\n  let src;\n  const href = /** @type {string|undefined} */\n      (IconObject['href']);\n  if (href) {\n    src = href;\n  } else if (drawIcon) {\n    src = DEFAULT_IMAGE_STYLE_SRC;\n  }\n  let anchor, anchorXUnits, anchorYUnits;\n  let anchorOrigin = IconOrigin.BOTTOM_LEFT;\n  const hotSpot = /** @type {Vec2|undefined} */\n      (object['hotSpot']);\n  if (hotSpot) {\n    anchor = [hotSpot.x, hotSpot.y];\n    anchorXUnits = hotSpot.xunits;\n    anchorYUnits = hotSpot.yunits;\n    anchorOrigin = hotSpot.origin;\n  } else if (src === DEFAULT_IMAGE_STYLE_SRC) {\n    anchor = DEFAULT_IMAGE_STYLE_ANCHOR;\n    anchorXUnits = DEFAULT_IMAGE_STYLE_ANCHOR_X_UNITS;\n    anchorYUnits = DEFAULT_IMAGE_STYLE_ANCHOR_Y_UNITS;\n  } else if (/^http:\\/\\/maps\\.(?:google|gstatic)\\.com\\//.test(src)) {\n    anchor = [0.5, 0];\n    anchorXUnits = IconAnchorUnits.FRACTION;\n    anchorYUnits = IconAnchorUnits.FRACTION;\n  }\n\n  let offset;\n  const x = /** @type {number|undefined} */\n      (IconObject['x']);\n  const y = /** @type {number|undefined} */\n      (IconObject['y']);\n  if (x !== undefined && y !== undefined) {\n    offset = [x, y];\n  }\n\n  let size;\n  const w = /** @type {number|undefined} */\n      (IconObject['w']);\n  const h = /** @type {number|undefined} */\n      (IconObject['h']);\n  if (w !== undefined && h !== undefined) {\n    size = [w, h];\n  }\n\n  let rotation;\n  const heading = /** @type {number} */\n      (object['heading']);\n  if (heading !== undefined) {\n    rotation = toRadians(heading);\n  }\n\n  let scale = /** @type {number|undefined} */\n      (object['scale']);\n\n  if (drawIcon) {\n    if (src == DEFAULT_IMAGE_STYLE_SRC) {\n      size = DEFAULT_IMAGE_STYLE_SIZE;\n      if (scale === undefined) {\n        scale = DEFAULT_IMAGE_SCALE_MULTIPLIER;\n      }\n    }\n\n    const imageStyle = new Icon({\n      anchor: anchor,\n      anchorOrigin: anchorOrigin,\n      anchorXUnits: anchorXUnits,\n      anchorYUnits: anchorYUnits,\n      crossOrigin: 'anonymous', // FIXME should this be configurable?\n      offset: offset,\n      offsetOrigin: IconOrigin.BOTTOM_LEFT,\n      rotation: rotation,\n      scale: scale,\n      size: size,\n      src: src\n    });\n    styleObject['imageStyle'] = imageStyle;\n  } else {\n    // handle the case when we explicitly want to draw no icon.\n    styleObject['imageStyle'] = DEFAULT_NO_IMAGE_STYLE;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LABEL_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'scale': makeObjectPropertySetter(readScale)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction labelStyleParser(node, objectStack) {\n  // FIXME colorMode\n  const object = pushParseAndPop(\n    {}, LABEL_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const textStyle = new Text({\n    fill: new Fill({\n      color: /** @type {import(\"../color.js\").Color} */\n          ('color' in object ? object['color'] : DEFAULT_COLOR)\n    }),\n    scale: /** @type {number|undefined} */\n        (object['scale'])\n  });\n  styleObject['textStyle'] = textStyle;\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LINE_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'width': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction lineStyleParser(node, objectStack) {\n  // FIXME colorMode\n  // FIXME gx:outerColor\n  // FIXME gx:outerWidth\n  // FIXME gx:physicalWidth\n  // FIXME gx:labelVisibility\n  const object = pushParseAndPop(\n    {}, LINE_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const strokeStyle = new Stroke({\n    color: /** @type {import(\"../color.js\").Color} */\n        ('color' in object ? object['color'] : DEFAULT_COLOR),\n    width: /** @type {number} */ ('width' in object ? object['width'] : 1)\n  });\n  styleObject['strokeStyle'] = strokeStyle;\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst POLY_STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeObjectPropertySetter(readColor),\n    'fill': makeObjectPropertySetter(readBoolean),\n    'outline': makeObjectPropertySetter(readBoolean)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction polyStyleParser(node, objectStack) {\n  // FIXME colorMode\n  const object = pushParseAndPop(\n    {}, POLY_STYLE_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const styleObject = objectStack[objectStack.length - 1];\n  const fillStyle = new Fill({\n    color: /** @type {import(\"../color.js\").Color} */\n        ('color' in object ? object['color'] : DEFAULT_COLOR)\n  });\n  styleObject['fillStyle'] = fillStyle;\n  const fill = /** @type {boolean|undefined} */ (object['fill']);\n  if (fill !== undefined) {\n    styleObject['fill'] = fill;\n  }\n  const outline = /** @type {boolean|undefined} */ (object['outline']);\n  if (outline !== undefined) {\n    styleObject['outline'] = outline;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst FLAT_LINEAR_RING_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'coordinates': makeReplacer(readFlatCoordinates)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<number>} LinearRing flat coordinates.\n */\nfunction readFlatLinearRing(node, objectStack) {\n  return pushParseAndPop(null,\n    FLAT_LINEAR_RING_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction gxCoordParser(node, objectStack) {\n  const gxTrackObject = /** @type {GxTrackObject} */\n      (objectStack[objectStack.length - 1]);\n  const flatCoordinates = gxTrackObject.flatCoordinates;\n  const s = getAllTextContent(node, false);\n  const re =\n      /^\\s*([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s+([+\\-]?\\d+(?:\\.\\d*)?(?:e[+\\-]?\\d*)?)\\s*$/i;\n  const m = re.exec(s);\n  if (m) {\n    const x = parseFloat(m[1]);\n    const y = parseFloat(m[2]);\n    const z = parseFloat(m[3]);\n    flatCoordinates.push(x, y, z, 0);\n  } else {\n    flatCoordinates.push(0, 0, 0, 0);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst GX_MULTITRACK_GEOMETRY_PARSERS = makeStructureNS(\n  GX_NAMESPACE_URIS, {\n    'Track': makeArrayPusher(readGxTrack)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {MultiLineString|undefined} MultiLineString.\n */\nfunction readGxMultiTrack(node, objectStack) {\n  const lineStrings = pushParseAndPop([],\n    GX_MULTITRACK_GEOMETRY_PARSERS, node, objectStack);\n  if (!lineStrings) {\n    return undefined;\n  }\n  return new MultiLineString(lineStrings);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst GX_TRACK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'when': whenParser\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'coord': gxCoordParser\n    }));\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {LineString|undefined} LineString.\n */\nfunction readGxTrack(node, objectStack) {\n  const gxTrackObject = pushParseAndPop(\n    /** @type {GxTrackObject} */ ({\n      flatCoordinates: [],\n      whens: []\n    }), GX_TRACK_PARSERS, node, objectStack);\n  if (!gxTrackObject) {\n    return undefined;\n  }\n  const flatCoordinates = gxTrackObject.flatCoordinates;\n  const whens = gxTrackObject.whens;\n  for (let i = 0, ii = Math.min(flatCoordinates.length, whens.length); i < ii; ++i) {\n    flatCoordinates[4 * i + 3] = whens[i];\n  }\n  return new LineString(flatCoordinates, GeometryLayout.XYZM);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst ICON_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeObjectPropertySetter(readURI)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'x': makeObjectPropertySetter(readDecimal),\n      'y': makeObjectPropertySetter(readDecimal),\n      'w': makeObjectPropertySetter(readDecimal),\n      'h': makeObjectPropertySetter(readDecimal)\n    }));\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object} Icon object.\n */\nfunction readIcon(node, objectStack) {\n  const iconObject = pushParseAndPop(\n    {}, ICON_PARSERS, node, objectStack);\n  if (iconObject) {\n    return iconObject;\n  } else {\n    return null;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst GEOMETRY_FLAT_COORDINATES_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'coordinates': makeReplacer(readFlatCoordinates)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<number>} Flat coordinates.\n */\nfunction readFlatCoordinatesFromNode(node, objectStack) {\n  return pushParseAndPop(null,\n    GEOMETRY_FLAT_COORDINATES_PARSERS, node, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst EXTRUDE_AND_ALTITUDE_MODE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'extrude': makeObjectPropertySetter(readBoolean),\n    'tessellate': makeObjectPropertySetter(readBoolean),\n    'altitudeMode': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {LineString|undefined} LineString.\n */\nfunction readLineString(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const lineString = new LineString(flatCoordinates, GeometryLayout.XYZ);\n    lineString.setProperties(properties, true);\n    return lineString;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Polygon|undefined} Polygon.\n */\nfunction readLinearRing(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const polygon = new Polygon(flatCoordinates, GeometryLayout.XYZ, [flatCoordinates.length]);\n    polygon.setProperties(properties, true);\n    return polygon;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst MULTI_GEOMETRY_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LineString': makeArrayPusher(readLineString),\n    'LinearRing': makeArrayPusher(readLinearRing),\n    'MultiGeometry': makeArrayPusher(readMultiGeometry),\n    'Point': makeArrayPusher(readPoint),\n    'Polygon': makeArrayPusher(readPolygon)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {import(\"../geom/Geometry.js\").default} Geometry.\n */\nfunction readMultiGeometry(node, objectStack) {\n  const geometries = pushParseAndPop([],\n    MULTI_GEOMETRY_PARSERS, node, objectStack);\n  if (!geometries) {\n    return null;\n  }\n  if (geometries.length === 0) {\n    return new GeometryCollection(geometries);\n  }\n  let multiGeometry;\n  let homogeneous = true;\n  const type = geometries[0].getType();\n  let geometry;\n  for (let i = 1, ii = geometries.length; i < ii; ++i) {\n    geometry = geometries[i];\n    if (geometry.getType() != type) {\n      homogeneous = false;\n      break;\n    }\n  }\n  if (homogeneous) {\n    let layout;\n    let flatCoordinates;\n    if (type == GeometryType.POINT) {\n      const point = geometries[0];\n      layout = point.getLayout();\n      flatCoordinates = point.getFlatCoordinates();\n      for (let i = 1, ii = geometries.length; i < ii; ++i) {\n        geometry = geometries[i];\n        extend(flatCoordinates, geometry.getFlatCoordinates());\n      }\n      multiGeometry = new MultiPoint(flatCoordinates, layout);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.LINE_STRING) {\n      multiGeometry = new MultiLineString(geometries);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.POLYGON) {\n      multiGeometry = new MultiPolygon(geometries);\n      setCommonGeometryProperties(multiGeometry, geometries);\n    } else if (type == GeometryType.GEOMETRY_COLLECTION) {\n      multiGeometry = new GeometryCollection(geometries);\n    } else {\n      assert(false, 37); // Unknown geometry type found\n    }\n  } else {\n    multiGeometry = new GeometryCollection(geometries);\n  }\n  return (\n    /** @type {import(\"../geom/Geometry.js\").default} */ (multiGeometry)\n  );\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Point|undefined} Point.\n */\nfunction readPoint(node, objectStack) {\n  const properties = pushParseAndPop({},\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatCoordinates =\n      readFlatCoordinatesFromNode(node, objectStack);\n  if (flatCoordinates) {\n    const point = new Point(flatCoordinates, GeometryLayout.XYZ);\n    point.setProperties(properties, true);\n    return point;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst FLAT_LINEAR_RINGS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'innerBoundaryIs': innerBoundaryIsParser,\n    'outerBoundaryIs': outerBoundaryIsParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Polygon|undefined} Polygon.\n */\nfunction readPolygon(node, objectStack) {\n  const properties = pushParseAndPop(/** @type {Object<string,*>} */ ({}),\n    EXTRUDE_AND_ALTITUDE_MODE_PARSERS, node,\n    objectStack);\n  const flatLinearRings = pushParseAndPop([null],\n    FLAT_LINEAR_RINGS_PARSERS, node, objectStack);\n  if (flatLinearRings && flatLinearRings[0]) {\n    const flatCoordinates = flatLinearRings[0];\n    const ends = [flatCoordinates.length];\n    for (let i = 1, ii = flatLinearRings.length; i < ii; ++i) {\n      extend(flatCoordinates, flatLinearRings[i]);\n      ends.push(flatCoordinates.length);\n    }\n    const polygon = new Polygon(flatCoordinates, GeometryLayout.XYZ, ends);\n    polygon.setProperties(properties, true);\n    return polygon;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'IconStyle': iconStyleParser,\n    'LabelStyle': labelStyleParser,\n    'LineStyle': lineStyleParser,\n    'PolyStyle': polyStyleParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Array<Style>} Style.\n */\nfunction readStyle(node, objectStack) {\n  const styleObject = pushParseAndPop(\n    {}, STYLE_PARSERS, node, objectStack);\n  if (!styleObject) {\n    return null;\n  }\n  let fillStyle = /** @type {Fill} */\n      ('fillStyle' in styleObject ?\n        styleObject['fillStyle'] : DEFAULT_FILL_STYLE);\n  const fill = /** @type {boolean|undefined} */ (styleObject['fill']);\n  if (fill !== undefined && !fill) {\n    fillStyle = null;\n  }\n  let imageStyle;\n  if ('imageStyle' in styleObject) {\n    if (styleObject['imageStyle'] != DEFAULT_NO_IMAGE_STYLE) {\n      imageStyle = styleObject['imageStyle'];\n    }\n  } else {\n    imageStyle = DEFAULT_IMAGE_STYLE;\n  }\n  const textStyle = /** @type {Text} */\n      ('textStyle' in styleObject ?\n        styleObject['textStyle'] : DEFAULT_TEXT_STYLE);\n  let strokeStyle = /** @type {Stroke} */\n      ('strokeStyle' in styleObject ?\n        styleObject['strokeStyle'] : DEFAULT_STROKE_STYLE);\n  const outline = /** @type {boolean|undefined} */\n      (styleObject['outline']);\n  if (outline !== undefined && !outline) {\n    strokeStyle = null;\n  }\n  return [new Style({\n    fill: fillStyle,\n    image: imageStyle,\n    stroke: strokeStyle,\n    text: textStyle,\n    zIndex: undefined // FIXME\n  })];\n}\n\n\n/**\n * Reads an array of geometries and creates arrays for common geometry\n * properties. Then sets them to the multi geometry.\n * @param {MultiPoint|MultiLineString|MultiPolygon} multiGeometry A multi-geometry.\n * @param {Array<import(\"../geom/Geometry.js\").default>} geometries List of geometries.\n */\nfunction setCommonGeometryProperties(multiGeometry, geometries) {\n  const ii = geometries.length;\n  const extrudes = new Array(geometries.length);\n  const tessellates = new Array(geometries.length);\n  const altitudeModes = new Array(geometries.length);\n  let hasExtrude, hasTessellate, hasAltitudeMode;\n  hasExtrude = hasTessellate = hasAltitudeMode = false;\n  for (let i = 0; i < ii; ++i) {\n    const geometry = geometries[i];\n    extrudes[i] = geometry.get('extrude');\n    tessellates[i] = geometry.get('tessellate');\n    altitudeModes[i] = geometry.get('altitudeMode');\n    hasExtrude = hasExtrude || extrudes[i] !== undefined;\n    hasTessellate = hasTessellate || tessellates[i] !== undefined;\n    hasAltitudeMode = hasAltitudeMode || altitudeModes[i];\n  }\n  if (hasExtrude) {\n    multiGeometry.set('extrude', extrudes);\n  }\n  if (hasTessellate) {\n    multiGeometry.set('tessellate', tessellates);\n  }\n  if (hasAltitudeMode) {\n    multiGeometry.set('altitudeMode', altitudeModes);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'displayName': makeObjectPropertySetter(readString),\n    'value': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction dataParser(node, objectStack) {\n  const name = node.getAttribute('name');\n  parseNode(DATA_PARSERS, node, objectStack);\n  const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  if (name && featureObject.displayName) {\n    featureObject[name] = {\n      value: featureObject.value,\n      displayName: featureObject.displayName,\n      toString: function() {\n        return featureObject.value;\n      }\n    };\n  } else if (name !== null) {\n    featureObject[name] = featureObject.value;\n  } else if (featureObject.displayName !== null) {\n    featureObject[featureObject.displayName] = featureObject.value;\n  }\n  delete featureObject['value'];\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst EXTENDED_DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Data': dataParser,\n    'SchemaData': schemaDataParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction extendedDataParser(node, objectStack) {\n  parseNode(EXTENDED_DATA_PARSERS, node, objectStack);\n}\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction regionParser(node, objectStack) {\n  parseNode(REGION_PARSERS, node, objectStack);\n}\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PAIR_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Style': makeObjectPropertySetter(readStyle),\n    'key': makeObjectPropertySetter(readString),\n    'styleUrl': makeObjectPropertySetter(readURI)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction pairDataParser(node, objectStack) {\n  const pairObject = pushParseAndPop(\n    {}, PAIR_PARSERS, node, objectStack);\n  if (!pairObject) {\n    return;\n  }\n  const key = /** @type {string|undefined} */\n      (pairObject['key']);\n  if (key && key == 'normal') {\n    const styleUrl = /** @type {string|undefined} */\n        (pairObject['styleUrl']);\n    if (styleUrl) {\n      objectStack[objectStack.length - 1] = styleUrl;\n    }\n    const style = /** @type {Style} */\n        (pairObject['Style']);\n    if (style) {\n      objectStack[objectStack.length - 1] = style;\n    }\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction placemarkStyleMapParser(node, objectStack) {\n  const styleMapValue = readStyleMapValue(node, objectStack);\n  if (!styleMapValue) {\n    return;\n  }\n  const placemarkObject = objectStack[objectStack.length - 1];\n  if (Array.isArray(styleMapValue)) {\n    placemarkObject['Style'] = styleMapValue;\n  } else if (typeof styleMapValue === 'string') {\n    placemarkObject['styleUrl'] = styleMapValue;\n  } else {\n    assert(false, 38); // `styleMapValue` has an unknown type\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SCHEMA_DATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'SimpleData': simpleDataParser\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction schemaDataParser(node, objectStack) {\n  parseNode(SCHEMA_DATA_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction simpleDataParser(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (name !== null) {\n    const data = readString(node);\n    const featureObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n    featureObject[name] = data;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LAT_LON_ALT_BOX_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'altitudeMode': makeObjectPropertySetter(readString),\n    'minAltitude': makeObjectPropertySetter(readDecimal),\n    'maxAltitude': makeObjectPropertySetter(readDecimal),\n    'north': makeObjectPropertySetter(readDecimal),\n    'south': makeObjectPropertySetter(readDecimal),\n    'east': makeObjectPropertySetter(readDecimal),\n    'west': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction latLonAltBoxParser(node, objectStack) {\n  const object = pushParseAndPop({}, LAT_LON_ALT_BOX_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const regionObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const extent = [\n    parseFloat(object['west']),\n    parseFloat(object['south']),\n    parseFloat(object['east']),\n    parseFloat(object['north'])\n  ];\n  regionObject['extent'] = extent;\n  regionObject['altitudeMode'] = object['altitudeMode'];\n  regionObject['minAltitude'] = parseFloat(object['minAltitude']);\n  regionObject['maxAltitude'] = parseFloat(object['maxAltitude']);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LOD_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'minLodPixels': makeObjectPropertySetter(readDecimal),\n    'maxLodPixels': makeObjectPropertySetter(readDecimal),\n    'minFadeExtent': makeObjectPropertySetter(readDecimal),\n    'maxFadeExtent': makeObjectPropertySetter(readDecimal)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction lodParser(node, objectStack) {\n  const object = pushParseAndPop({}, LOD_PARSERS, node, objectStack);\n  if (!object) {\n    return;\n  }\n  const lodObject = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  lodObject['minLodPixels'] = parseFloat(object['minLodPixels']);\n  lodObject['maxLodPixels'] = parseFloat(object['maxLodPixels']);\n  lodObject['minFadeExtent'] = parseFloat(object['minFadeExtent']);\n  lodObject['maxFadeExtent'] = parseFloat(object['maxFadeExtent']);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst INNER_BOUNDARY_IS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeReplacer(readFlatLinearRing)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction innerBoundaryIsParser(node, objectStack) {\n  /** @type {Array<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    INNER_BOUNDARY_IS_PARSERS, node, objectStack);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array<Array<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings.push(flatLinearRing);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst OUTER_BOUNDARY_IS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeReplacer(readFlatLinearRing)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction outerBoundaryIsParser(node, objectStack) {\n  /** @type {Array<number>|undefined} */\n  const flatLinearRing = pushParseAndPop(undefined,\n    OUTER_BOUNDARY_IS_PARSERS, node, objectStack);\n  if (flatLinearRing) {\n    const flatLinearRings = /** @type {Array<Array<number>>} */\n        (objectStack[objectStack.length - 1]);\n    flatLinearRings[0] = flatLinearRing;\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction linkParser(node, objectStack) {\n  parseNode(LINK_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction whenParser(node, objectStack) {\n  const gxTrackObject = /** @type {GxTrackObject} */\n      (objectStack[objectStack.length - 1]);\n  const whens = gxTrackObject.whens;\n  const s = getAllTextContent(node, false);\n  const when = Date.parse(s);\n  whens.push(isNaN(when) ? 0 : when);\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the color to.\n * @param {import(\"../color.js\").Color|string} color Color.\n */\nfunction writeColorTextNode(node, color) {\n  const rgba = asArray(color);\n  const opacity = (rgba.length == 4) ? rgba[3] : 1;\n  /** @type {Array<string|number>} */\n  const abgr = [opacity * 255, rgba[2], rgba[1], rgba[0]];\n  for (let i = 0; i < 4; ++i) {\n    const hex = Math.floor(/** @type {number} */ (abgr[i])).toString(16);\n    abgr[i] = (hex.length == 1) ? '0' + hex : hex;\n  }\n  writeStringTextNode(node, abgr.join(''));\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the coordinates to.\n * @param {Array<number>} coordinates Coordinates.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeCoordinatesTextNode(node, coordinates, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n\n  const layout = context['layout'];\n  const stride = context['stride'];\n\n  let dimension;\n  if (layout == GeometryLayout.XY ||\n      layout == GeometryLayout.XYM) {\n    dimension = 2;\n  } else if (layout == GeometryLayout.XYZ ||\n      layout == GeometryLayout.XYZM) {\n    dimension = 3;\n  } else {\n    assert(false, 34); // Invalid geometry layout\n  }\n\n  const ii = coordinates.length;\n  let text = '';\n  if (ii > 0) {\n    text += coordinates[0];\n    for (let d = 1; d < dimension; ++d) {\n      text += ',' + coordinates[d];\n    }\n    for (let i = stride; i < ii; i += stride) {\n      text += ' ' + coordinates[i];\n      for (let d = 1; d < dimension; ++d) {\n        text += ',' + coordinates[i + d];\n      }\n    }\n  }\n  writeStringTextNode(node, text);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst EXTENDEDDATA_NODE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Data': makeChildAppender(writeDataNode),\n    'value': makeChildAppender(writeDataNodeValue),\n    'displayName': makeChildAppender(writeDataNodeName)\n  });\n\n\n/**\n * @param {Element} node Node.\n * @param {{name: *, value: *}} pair Name value pair.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeDataNode(node, pair, objectStack) {\n  node.setAttribute('name', pair.name);\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const value = pair.value;\n\n  if (typeof value == 'object') {\n    if (value !== null && value.displayName) {\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n        OBJECT_PROPERTY_NODE_FACTORY, [value.displayName], objectStack, ['displayName']);\n    }\n\n    if (value !== null && value.value) {\n      pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n        OBJECT_PROPERTY_NODE_FACTORY, [value.value], objectStack, ['value']);\n    }\n  } else {\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n      OBJECT_PROPERTY_NODE_FACTORY, [value], objectStack, ['value']);\n  }\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the name to.\n * @param {string} name DisplayName.\n */\nfunction writeDataNodeName(node, name) {\n  writeCDATASection(node, name);\n}\n\n\n/**\n * @param {Node} node Node to append a CDATA Section with the value to.\n * @param {string} value Value.\n */\nfunction writeDataNodeValue(node, value) {\n  writeStringTextNode(node, value);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst DOCUMENT_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Placemark': makeChildAppender(writePlacemark)\n  });\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst DOCUMENT_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  const parentNode = objectStack[objectStack.length - 1].node;\n  return createElementNS(parentNode.namespaceURI, 'Placemark');\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<Feature>} features Features.\n * @param {Array<*>} objectStack Object stack.\n * @this {KML}\n */\nfunction writeDocument(node, features, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context, DOCUMENT_SERIALIZERS,\n    DOCUMENT_NODE_FACTORY, features, objectStack, undefined,\n    this);\n}\n\n\n/**\n * A factory for creating Data nodes.\n * @const\n * @type {function(*, Array<*>): (Node|undefined)}\n */\nconst DATA_NODE_FACTORY = makeSimpleNodeFactory('Data');\n\n\n/**\n * @param {Node} node Node.\n * @param {{names: Array<string>, values: (Array<*>)}} namesAndValues Names and values.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeExtendedData(node, namesAndValues, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const names = namesAndValues.names;\n  const values = namesAndValues.values;\n  const length = names.length;\n\n  for (let i = 0; i < length; i++) {\n    pushSerializeAndPop(context, EXTENDEDDATA_NODE_SERIALIZERS,\n      DATA_NODE_FACTORY, [{name: names[i], value: values[i]}], objectStack);\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst ICON_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'href'\n  ],\n  makeStructureNS(GX_NAMESPACE_URIS, [\n    'x', 'y', 'w', 'h'\n  ]));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst ICON_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'href': makeChildAppender(writeStringTextNode)\n  }, makeStructureNS(\n    GX_NAMESPACE_URIS, {\n      'x': makeChildAppender(writeDecimalTextNode),\n      'y': makeChildAppender(writeDecimalTextNode),\n      'w': makeChildAppender(writeDecimalTextNode),\n      'h': makeChildAppender(writeDecimalTextNode)\n    }));\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst GX_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  return createElementNS(GX_NAMESPACE_URIS[0],\n    'gx:' + opt_nodeName);\n};\n\n\n/**\n * @param {Node} node Node.\n * @param {Object} icon Icon object.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeIcon(node, icon, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const parentNode = objectStack[objectStack.length - 1].node;\n  let orderedKeys = ICON_SEQUENCE[parentNode.namespaceURI];\n  let values = makeSequence(icon, orderedKeys);\n  pushSerializeAndPop(context,\n    ICON_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n  orderedKeys =\n      ICON_SEQUENCE[GX_NAMESPACE_URIS[0]];\n  values = makeSequence(icon, orderedKeys);\n  pushSerializeAndPop(context, ICON_SERIALIZERS,\n    GX_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst ICON_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'scale', 'heading', 'Icon', 'hotSpot'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst ICON_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Icon': makeChildAppender(writeIcon),\n    'heading': makeChildAppender(writeDecimalTextNode),\n    'hotSpot': makeChildAppender(writeVec2),\n    'scale': makeChildAppender(writeScaleTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../style/Icon.js\").default} style Icon style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeIconStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const /** @type {Object<string, any>} */ properties = {};\n  const src = style.getSrc();\n  const size = style.getSize();\n  const iconImageSize = style.getImageSize();\n  const iconProperties = {\n    'href': src\n  };\n\n  if (size) {\n    iconProperties['w'] = size[0];\n    iconProperties['h'] = size[1];\n    const anchor = style.getAnchor(); // top-left\n    const origin = style.getOrigin(); // top-left\n\n    if (origin && iconImageSize && origin[0] !== 0 && origin[1] !== size[1]) {\n      iconProperties['x'] = origin[0];\n      iconProperties['y'] = iconImageSize[1] - (origin[1] + size[1]);\n    }\n\n    if (anchor && (anchor[0] !== size[0] / 2 || anchor[1] !== size[1] / 2)) {\n      const /** @type {Vec2} */ hotSpot = {\n        x: anchor[0],\n        xunits: IconAnchorUnits.PIXELS,\n        y: size[1] - anchor[1],\n        yunits: IconAnchorUnits.PIXELS\n      };\n      properties['hotSpot'] = hotSpot;\n    }\n  }\n\n  properties['Icon'] = iconProperties;\n\n  const scale = style.getScale();\n  if (scale !== 1) {\n    properties['scale'] = scale;\n  }\n\n  const rotation = style.getRotation();\n  if (rotation !== 0) {\n    properties['heading'] = rotation; // 0-360\n  }\n\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = ICON_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, ICON_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst LABEL_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'color', 'scale'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst LABEL_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode),\n    'scale': makeChildAppender(writeScaleTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Text} style style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeLabelStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const fill = style.getFill();\n  if (fill) {\n    properties['color'] = fill.getColor();\n  }\n  const scale = style.getScale();\n  if (scale && scale !== 1) {\n    properties['scale'] = scale;\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys =\n      LABEL_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, LABEL_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst LINE_STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'color', 'width'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst LINE_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode),\n    'width': makeChildAppender(writeDecimalTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Stroke} style style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeLineStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {\n    'color': style.getColor(),\n    'width': style.getWidth()\n  };\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = LINE_STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, LINE_STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, string>}\n */\nconst GEOMETRY_TYPE_TO_NODENAME = {\n  'Point': 'Point',\n  'LineString': 'LineString',\n  'LinearRing': 'LinearRing',\n  'Polygon': 'Polygon',\n  'MultiPoint': 'MultiGeometry',\n  'MultiLineString': 'MultiGeometry',\n  'MultiPolygon': 'MultiGeometry',\n  'GeometryCollection': 'MultiGeometry'\n};\n\n\n/**\n * @const\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nconst GEOMETRY_NODE_FACTORY = function(value, objectStack, opt_nodeName) {\n  if (value) {\n    const parentNode = objectStack[objectStack.length - 1].node;\n    return createElementNS(parentNode.namespaceURI,\n      GEOMETRY_TYPE_TO_NODENAME[/** @type {import(\"../geom/Geometry.js\").default} */ (value).getType()]);\n  }\n};\n\n\n/**\n * A factory for creating Point nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst POINT_NODE_FACTORY = makeSimpleNodeFactory('Point');\n\n\n/**\n * A factory for creating LineString nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst LINE_STRING_NODE_FACTORY = makeSimpleNodeFactory('LineString');\n\n\n/**\n * A factory for creating LinearRing nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst LINEAR_RING_NODE_FACTORY = makeSimpleNodeFactory('LinearRing');\n\n\n/**\n * A factory for creating Polygon nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst POLYGON_NODE_FACTORY = makeSimpleNodeFactory('Polygon');\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst MULTI_GEOMETRY_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LineString': makeChildAppender(\n      writePrimitiveGeometry),\n    'Point': makeChildAppender(\n      writePrimitiveGeometry),\n    'Polygon': makeChildAppender(writePolygon),\n    'GeometryCollection': makeChildAppender(\n      writeMultiGeometry)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeMultiGeometry(node, geometry, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const context = {node: node};\n  const type = geometry.getType();\n  /** @type {Array<import(\"../geom/Geometry.js\").default>} */\n  let geometries;\n  /** @type {function(*, Array<*>, string=): (Node|undefined)} */\n  let factory;\n  if (type == GeometryType.GEOMETRY_COLLECTION) {\n    geometries = /** @type {GeometryCollection} */ (geometry).getGeometries();\n    factory = GEOMETRY_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_POINT) {\n    geometries = /** @type {MultiPoint} */ (geometry).getPoints();\n    factory = POINT_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_LINE_STRING) {\n    geometries =\n        (/** @type {MultiLineString} */ (geometry)).getLineStrings();\n    factory = LINE_STRING_NODE_FACTORY;\n  } else if (type == GeometryType.MULTI_POLYGON) {\n    geometries =\n        (/** @type {MultiPolygon} */ (geometry)).getPolygons();\n    factory = POLYGON_NODE_FACTORY;\n  } else {\n    assert(false, 39); // Unknown geometry type\n  }\n  pushSerializeAndPop(context,\n    MULTI_GEOMETRY_SERIALIZERS, factory,\n    geometries, objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst BOUNDARY_IS_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LinearRing': makeChildAppender(\n      writePrimitiveGeometry)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../geom/LinearRing.js\").default} linearRing Linear ring.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeBoundaryIs(node, linearRing, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context,\n    BOUNDARY_IS_SERIALIZERS,\n    LINEAR_RING_NODE_FACTORY, [linearRing], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst PLACEMARK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ExtendedData': makeChildAppender(writeExtendedData),\n    'MultiGeometry': makeChildAppender(writeMultiGeometry),\n    'LineString': makeChildAppender(writePrimitiveGeometry),\n    'LinearRing': makeChildAppender(writePrimitiveGeometry),\n    'Point': makeChildAppender(writePrimitiveGeometry),\n    'Polygon': makeChildAppender(writePolygon),\n    'Style': makeChildAppender(writeStyle),\n    'address': makeChildAppender(writeStringTextNode),\n    'description': makeChildAppender(writeStringTextNode),\n    'name': makeChildAppender(writeStringTextNode),\n    'open': makeChildAppender(writeBooleanTextNode),\n    'phoneNumber': makeChildAppender(writeStringTextNode),\n    'styleUrl': makeChildAppender(writeStringTextNode),\n    'visibility': makeChildAppender(writeBooleanTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst PLACEMARK_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'open', 'visibility', 'address', 'phoneNumber', 'description',\n    'styleUrl', 'Style'\n  ]);\n\n\n/**\n * A factory for creating ExtendedData nodes.\n * @const\n * @type {function(*, Array<*>): (Node|undefined)}\n */\nconst EXTENDEDDATA_NODE_FACTORY = makeSimpleNodeFactory('ExtendedData');\n\n\n/**\n * FIXME currently we do serialize arbitrary/custom feature properties\n * (ExtendedData).\n * @param {Element} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n * @this {KML}\n */\nfunction writePlacemark(node, feature, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n\n  // set id\n  if (feature.getId()) {\n    node.setAttribute('id', /** @type {string} */ (feature.getId()));\n  }\n\n  // serialize properties (properties unknown to KML are not serialized)\n  const properties = feature.getProperties();\n\n  // don't export these to ExtendedData\n  const filter = {'address': 1, 'description': 1, 'name': 1, 'open': 1,\n    'phoneNumber': 1, 'styleUrl': 1, 'visibility': 1};\n  filter[feature.getGeometryName()] = 1;\n  const keys = Object.keys(properties || {}).sort().filter(function(v) {\n    return !filter[v];\n  });\n\n  const styleFunction = feature.getStyleFunction();\n  if (styleFunction) {\n    // FIXME the styles returned by the style function are supposed to be\n    // resolution-independent here\n    const styles = styleFunction(feature, 0);\n    if (styles) {\n      const style = Array.isArray(styles) ? styles[0] : styles;\n      if (this.writeStyles_) {\n        properties['Style'] = style;\n      }\n      const textStyle = style.getText();\n      if (textStyle) {\n        properties['name'] = textStyle.getText();\n      }\n    }\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = PLACEMARK_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n\n  if (keys.length > 0) {\n    const sequence = makeSequence(properties, keys);\n    const namesAndValues = {names: keys, values: sequence};\n    pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n      EXTENDEDDATA_NODE_FACTORY, [namesAndValues], objectStack);\n  }\n\n  // serialize geometry\n  const options = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[0]);\n  let geometry = feature.getGeometry();\n  if (geometry) {\n    geometry = transformGeometryWithOptions(geometry, true, options);\n  }\n  pushSerializeAndPop(context, PLACEMARK_SERIALIZERS,\n    GEOMETRY_NODE_FACTORY, [geometry], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst PRIMITIVE_GEOMETRY_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'extrude', 'tessellate', 'altitudeMode', 'coordinates'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst PRIMITIVE_GEOMETRY_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'extrude': makeChildAppender(writeBooleanTextNode),\n    'tessellate': makeChildAppender(writeBooleanTextNode),\n    'altitudeMode': makeChildAppender(writeStringTextNode),\n    'coordinates': makeChildAppender(writeCoordinatesTextNode)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writePrimitiveGeometry(node, geometry, objectStack) {\n  const flatCoordinates = geometry.getFlatCoordinates();\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  context['layout'] = geometry.getLayout();\n  context['stride'] = geometry.getStride();\n\n  // serialize properties (properties unknown to KML are not serialized)\n  const properties = geometry.getProperties();\n  properties.coordinates = flatCoordinates;\n\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = PRIMITIVE_GEOMETRY_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, PRIMITIVE_GEOMETRY_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst POLYGON_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'outerBoundaryIs': makeChildAppender(\n      writeBoundaryIs),\n    'innerBoundaryIs': makeChildAppender(\n      writeBoundaryIs)\n  });\n\n\n/**\n * A factory for creating innerBoundaryIs nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst INNER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('innerBoundaryIs');\n\n\n/**\n * A factory for creating outerBoundaryIs nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst OUTER_BOUNDARY_NODE_FACTORY = makeSimpleNodeFactory('outerBoundaryIs');\n\n\n/**\n * @param {Node} node Node.\n * @param {Polygon} polygon Polygon.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writePolygon(node, polygon, objectStack) {\n  const linearRings = polygon.getLinearRings();\n  const outerRing = linearRings.shift();\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  // inner rings\n  pushSerializeAndPop(context,\n    POLYGON_SERIALIZERS,\n    INNER_BOUNDARY_NODE_FACTORY,\n    linearRings, objectStack);\n  // outer ring\n  pushSerializeAndPop(context,\n    POLYGON_SERIALIZERS,\n    OUTER_BOUNDARY_NODE_FACTORY,\n    [outerRing], objectStack);\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst POLY_STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'color': makeChildAppender(writeColorTextNode)\n  });\n\n\n/**\n * A factory for creating coordinates nodes.\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst COLOR_NODE_FACTORY = makeSimpleNodeFactory('color');\n\n\n/**\n * @param {Node} node Node.\n * @param {Fill} style Style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writePolyStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  pushSerializeAndPop(context, POLY_STYLE_SERIALIZERS,\n    COLOR_NODE_FACTORY, [style.getColor()], objectStack);\n}\n\n\n/**\n * @param {Node} node Node to append a TextNode with the scale to.\n * @param {number|undefined} scale Scale.\n */\nfunction writeScaleTextNode(node, scale) {\n  // the Math is to remove any excess decimals created by float arithmetic\n  writeDecimalTextNode(node,\n    Math.round(scale * 1e6) / 1e6);\n}\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst STYLE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'IconStyle', 'LabelStyle', 'LineStyle', 'PolyStyle'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst STYLE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'IconStyle': makeChildAppender(writeIconStyle),\n    'LabelStyle': makeChildAppender(writeLabelStyle),\n    'LineStyle': makeChildAppender(writeLineStyle),\n    'PolyStyle': makeChildAppender(writePolyStyle)\n  });\n\n\n/**\n * @param {Node} node Node.\n * @param {Style} style Style.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeStyle(node, style, objectStack) {\n  const /** @type {import(\"../xml.js\").NodeStackItem} */ context = {node: node};\n  const properties = {};\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  const imageStyle = style.getImage();\n  const textStyle = style.getText();\n  if (imageStyle && typeof /** @type {?} */ (imageStyle).getSrc === 'function') {\n    properties['IconStyle'] = imageStyle;\n  }\n  if (textStyle) {\n    properties['LabelStyle'] = textStyle;\n  }\n  if (strokeStyle) {\n    properties['LineStyle'] = strokeStyle;\n  }\n  if (fillStyle) {\n    properties['PolyStyle'] = fillStyle;\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = STYLE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context, STYLE_SERIALIZERS,\n    OBJECT_PROPERTY_NODE_FACTORY, values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Element} node Node to append a TextNode with the Vec2 to.\n * @param {Vec2} vec2 Vec2.\n */\nfunction writeVec2(node, vec2) {\n  node.setAttribute('x', String(vec2.x));\n  node.setAttribute('y', String(vec2.y));\n  node.setAttribute('xunits', vec2.xunits);\n  node.setAttribute('yunits', vec2.yunits);\n}\n\n\nexport default KML;\n","/**\n * @module ol/layer/VectorTileRenderType\n */\n\n/**\n * @enum {string}\n * Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but\n *    point symbols and texts are always rotated with the view and pixels are\n *    scaled during zoom animations.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels\n *    are scaled during zoom animations. Point symbols and texts are accurately\n *    rendered as vectors and can stay upright on rotated views.\n * @api\n */\nexport default {\n  IMAGE: 'image',\n  HYBRID: 'hybrid'\n};\n","/**\n * @module ol/renderer/canvas/VectorTileLayer\n */\nimport {getUid} from '../../util.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport TileState from '../../TileState.js';\nimport ViewHint from '../../ViewHint.js';\nimport {listen, unlistenByKey} from '../../events.js';\nimport EventType from '../../events/EventType.js';\nimport {buffer, containsCoordinate, equals, getIntersection, intersects} from '../../extent.js';\nimport VectorTileRenderType from '../../layer/VectorTileRenderType.js';\nimport ReplayType from '../../render/canvas/BuilderType.js';\nimport CanvasBuilderGroup from '../../render/canvas/BuilderGroup.js';\nimport CanvasTileLayerRenderer from './TileLayer.js';\nimport {getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport {\n  apply as applyTransform,\n  create as createTransform,\n  reset as resetTransform,\n  scale as scaleTransform,\n  translate as translateTransform,\n  toString as transformToString,\n  makeScale,\n  makeInverse\n} from '../../transform.js';\nimport CanvasExecutorGroup, {replayDeclutter} from '../../render/canvas/ExecutorGroup.js';\nimport {clear} from '../../obj.js';\n\n\n/**\n * @type {!Object<string, Array<import(\"../../render/canvas/BuilderType.js\").default>>}\n */\nconst IMAGE_REPLAYS = {\n  'image': [ReplayType.POLYGON, ReplayType.CIRCLE,\n    ReplayType.LINE_STRING, ReplayType.IMAGE, ReplayType.TEXT],\n  'hybrid': [ReplayType.POLYGON, ReplayType.LINE_STRING]\n};\n\n\n/**\n * @type {!Object<string, Array<import(\"../../render/canvas/BuilderType.js\").default>>}\n */\nconst VECTOR_REPLAYS = {\n  'image': [ReplayType.DEFAULT],\n  'hybrid': [ReplayType.IMAGE, ReplayType.TEXT, ReplayType.DEFAULT]\n};\n\n\n/**\n * @classdesc\n * Canvas renderer for vector tile layers.\n * @api\n */\nclass CanvasVectorTileLayerRenderer extends CanvasTileLayerRenderer {\n\n  /**\n   * @param {import(\"../../layer/VectorTile.js\").default} layer VectorTile layer.\n   */\n  constructor(layer) {\n    super(layer);\n\n    /** @private */\n    this.boundHandleStyleImageChange_ = this.handleStyleImageChange_.bind(this);\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.overlayContext_ = null;\n\n    /**\n     * @type {string}\n     */\n    this.overlayContextUid_;\n\n    /**\n     * The transform for rendered pixels to viewport CSS pixels for the overlay canvas.\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.overlayPixelTransform_ = createTransform();\n\n    /**\n     * The transform for viewport CSS pixels to rendered pixels for the overlay canvas.\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.inverseOverlayPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.dirty_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedLayerRevision_;\n\n    /**\n     * @private\n     * @type {!Object<string, import(\"../../VectorRenderTile.js\").default>}\n     */\n    this.renderTileImageQueue_ = {};\n\n    /**\n     * @type {Object<string, import(\"../../events.js\").EventsKey>}\n     */\n    this.tileListenerKeys_ = {};\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tmpTransform_ = createTransform();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  useContainer(target, transform, opacity) {\n    let overlayContext;\n    if (target && target.childElementCount === 2) {\n      overlayContext = target.lastElementChild.getContext('2d');\n      if (!overlayContext) {\n        target = null;\n      }\n    }\n    const containerReused = this.containerReused;\n    super.useContainer(target, transform, opacity);\n    if (containerReused) {\n      this.overlayContext_ = overlayContext || null;\n      this.overlayContextUid_ = overlayContext ? getUid(overlayContext) : undefined;\n    }\n    if (!this.overlayContext_) {\n      const overlayContext = createCanvasContext2D();\n      const style = overlayContext.canvas.style;\n      style.position = 'absolute';\n      style.transformOrigin = 'top left';\n      this.overlayContext_ = overlayContext;\n      this.overlayContextUid_ = getUid(overlayContext);\n    }\n    if (this.container.childElementCount === 1) {\n      this.container.appendChild(this.overlayContext_.canvas);\n    }\n  }\n\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection\").default} projection Projection.\n   * @param {boolean} queue Queue tile for rendering.\n   * @return {boolean} Tile needs to be rendered.\n   */\n  prepareTile(tile, pixelRatio, projection, queue) {\n    let render = false;\n    const tileUid = getUid(tile);\n    const state = tile.getState();\n    if (((state === TileState.LOADED && tile.hifi) ||\n        state === TileState.ERROR || state === TileState.ABORT) &&\n        tileUid in this.tileListenerKeys_) {\n      unlistenByKey(this.tileListenerKeys_[tileUid]);\n      delete this.tileListenerKeys_[tileUid];\n    }\n    if (state === TileState.LOADED || state === TileState.ERROR) {\n      this.updateExecutorGroup_(tile, pixelRatio, projection);\n      if (this.tileImageNeedsRender_(tile, pixelRatio, projection)) {\n        render = true;\n        if (queue) {\n          this.renderTileImageQueue_[tileUid] = tile;\n        }\n      }\n    }\n    return render;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTile(z, x, y, frameState) {\n    const tile = /** @type {import(\"../../VectorRenderTile.js\").default} */ (super.getTile(z, x, y, frameState));\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const resolution = viewState.resolution;\n    const projection = viewState.projection;\n    if (tile.getState() < TileState.LOADED) {\n      tile.wantedResolution = resolution;\n      const tileUid = getUid(tile);\n      if (!(tileUid in this.tileListenerKeys_)) {\n        const listenerKey = listen(tile, EventType.CHANGE, this.prepareTile.bind(this, tile, pixelRatio, projection, true));\n        this.tileListenerKeys_[tileUid] = listenerKey;\n      }\n    } else {\n      const viewHints = frameState.viewHints;\n      const hifi = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n      if (hifi || !tile.wantedResolution) {\n        tile.wantedResolution = resolution;\n      }\n      const render = this.prepareTile(tile, pixelRatio, projection, false);\n      if (render) {\n        this.renderTileImage_(tile, frameState);\n      }\n    }\n    return tile;\n  }\n\n  /**\n   * @inheritdoc\n   */\n  isDrawableTile(tile) {\n    return super.isDrawableTile(tile) && tile.hasContext(this.getLayer());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getTileImage(tile) {\n    return tile.getImage(this.getLayer());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState) {\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    layerState.hasOverlay = true;\n    const layerRevision = this.getLayer().getRevision();\n    if (this.renderedLayerRevision_ != layerRevision) {\n      this.renderedTiles.length = 0;\n    }\n    this.renderedLayerRevision_ = layerRevision;\n    return super.prepareFrame(frameState);\n  }\n\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @private\n   */\n  updateExecutorGroup_(tile, pixelRatio, projection) {\n    const layer = /** @type {import(\"../../layer/VectorTile.js\").default} */ (this.getLayer());\n    const revision = layer.getRevision();\n    const renderOrder = layer.getRenderOrder() || null;\n\n    const resolution = tile.wantedResolution;\n    const builderState = tile.getReplayState(layer);\n    if (!builderState.dirty && builderState.renderedResolution === resolution &&\n        builderState.renderedRevision == revision &&\n        builderState.renderedRenderOrder == renderOrder && builderState.renderedZ === tile.sourceZ) {\n      return;\n    }\n\n    const source = layer.getSource();\n    const sourceTileGrid = source.getTileGrid();\n    const tileGrid = source.getTileGridForProjection(projection);\n    const tileExtent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n\n    const sourceTiles = source.getSourceTiles(pixelRatio, projection, tile);\n    const layerUid = getUid(layer);\n    const executorGroups = tile.executorGroups[layerUid];\n    if (executorGroups) {\n      for (let i = 0, ii = executorGroups.length; i < ii; ++i) {\n        executorGroups[i].dispose();\n      }\n    }\n    tile.executorGroups[layerUid] = [];\n    for (let t = 0, tt = sourceTiles.length; t < tt; ++t) {\n      const sourceTile = sourceTiles[t];\n      if (sourceTile.getState() != TileState.LOADED) {\n        continue;\n      }\n      const sourceTileCoord = sourceTile.tileCoord;\n      const sourceTileExtent = sourceTileGrid.getTileCoordExtent(sourceTileCoord);\n      const sharedExtent = getIntersection(tileExtent, sourceTileExtent);\n      const bufferedExtent = equals(sourceTileExtent, sharedExtent) ? null :\n        buffer(sharedExtent, layer.getRenderBuffer() * resolution, this.tmpExtent);\n      builderState.dirty = false;\n      const builderGroup = new CanvasBuilderGroup(0, sharedExtent, resolution,\n        pixelRatio, layer.getDeclutter());\n      const squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n\n      /**\n       * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n       * @this {CanvasVectorTileLayerRenderer}\n       */\n      const render = function(feature) {\n        let styles;\n        const styleFunction = feature.getStyleFunction() || layer.getStyleFunction();\n        if (styleFunction) {\n          styles = styleFunction(feature, resolution);\n        }\n        if (styles) {\n          const dirty = this.renderFeature(feature, squaredTolerance, styles, builderGroup);\n          this.dirty_ = this.dirty_ || dirty;\n          builderState.dirty = builderState.dirty || dirty;\n        }\n      };\n\n      const features = sourceTile.getFeatures();\n      if (renderOrder && renderOrder !== builderState.renderedRenderOrder) {\n        features.sort(renderOrder);\n      }\n      for (let i = 0, ii = features.length; i < ii; ++i) {\n        const feature = features[i];\n        if (!bufferedExtent || intersects(bufferedExtent, feature.getGeometry().getExtent())) {\n          render.call(this, feature);\n        }\n      }\n      const executorGroupInstructions = builderGroup.finish();\n      // no need to clip when the render tile is covered by a single source tile\n      const replayExtent = layer.getDeclutter() && sourceTiles.length === 1 ?\n        null :\n        sharedExtent;\n      const renderingReplayGroup = new CanvasExecutorGroup(replayExtent, resolution,\n        pixelRatio, source.getOverlaps(), executorGroupInstructions, layer.getRenderBuffer());\n      tile.executorGroups[layerUid].push(renderingReplayGroup);\n    }\n    builderState.renderedRevision = revision;\n    builderState.renderedZ = tile.sourceZ;\n    builderState.renderedRenderOrder = renderOrder;\n    builderState.renderedResolution = resolution;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures) {\n    const resolution = frameState.viewState.resolution;\n    const rotation = frameState.viewState.rotation;\n    hitTolerance = hitTolerance == undefined ? 0 : hitTolerance;\n    const layer = /** @type {import(\"../../layer/VectorTile.js\").default} */ (this.getLayer());\n    const declutter = layer.getDeclutter();\n    const source = layer.getSource();\n    const tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n    /** @type {!Object<string, boolean>} */\n    const features = {};\n\n    const renderedTiles = /** @type {Array<import(\"../../VectorRenderTile.js\").default>} */ (this.renderedTiles);\n\n    let found;\n    let i, ii;\n    for (i = 0, ii = renderedTiles.length; i < ii; ++i) {\n      const tile = renderedTiles[i];\n      const tileExtent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n      const tileContainsCoordinate = containsCoordinate(tileExtent, coordinate);\n\n      if (!declutter) {\n        // When not decluttering, we only need to consider the tile that contains the given\n        // coordinate, because each feature will be rendered for each tile that contains it.\n        if (!tileContainsCoordinate) {\n          continue;\n        }\n      }\n      const executorGroups = tile.executorGroups[getUid(layer)];\n      for (let t = 0, tt = executorGroups.length; t < tt; ++t) {\n        const executorGroup = executorGroups[t];\n        found = found || executorGroup.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance,\n          /**\n           * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n           * @return {?} Callback result.\n           */\n          function(feature) {\n            if (tileContainsCoordinate || (declutteredFeatures && declutteredFeatures.indexOf(feature) !== -1)) {\n              let key = feature.getId();\n              if (key === undefined) {\n                key = getUid(feature);\n              }\n              if (!(key in features)) {\n                features[key] = true;\n                return callback(feature, layer);\n              }\n            }\n          }, layer.getDeclutter() ? declutteredFeatures : null);\n      }\n    }\n    return found;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleFontsChanged() {\n    clear(this.renderTileImageQueue_);\n    const layer = this.getLayer();\n    if (layer.getVisible() && this.renderedLayerRevision_ !== undefined) {\n      layer.changed();\n    }\n  }\n\n  /**\n   * Handle changes in image style state.\n   * @param {import(\"../../events/Event.js\").default} event Image style change event.\n   * @private\n   */\n  handleStyleImageChange_(event) {\n    this.renderIfReadyAndVisible();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  renderFrame(frameState, target) {\n    const viewHints = frameState.viewHints;\n    const hifi = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n    this.renderQueuedTileImages_(hifi, frameState);\n\n    super.renderFrame(frameState, target);\n\n    const layer = /** @type {import(\"../../layer/VectorTile.js\").default} */ (this.getLayer());\n    const renderMode = layer.getRenderMode();\n    if (renderMode === VectorTileRenderType.IMAGE) {\n      return this.container;\n    }\n\n    const source = layer.getSource();\n    // Unqueue tiles from the image queue when we don't need any more\n    const usedTiles = frameState.usedTiles[getUid(source)];\n    for (const tileUid in this.renderTileImageQueue_) {\n      if (!usedTiles || !(tileUid in usedTiles)) {\n        delete this.renderTileImageQueue_[tileUid];\n      }\n    }\n\n    const context = this.overlayContext_;\n    const declutterReplays = layer.getDeclutter() ? {} : null;\n    const replayTypes = VECTOR_REPLAYS[renderMode];\n    const pixelRatio = frameState.pixelRatio;\n    const rotation = frameState.viewState.rotation;\n    const size = frameState.size;\n\n    // set forward and inverse pixel transforms\n    makeScale(this.overlayPixelTransform_, 1 / pixelRatio, 1 / pixelRatio);\n    makeInverse(this.inverseOverlayPixelTransform_, this.overlayPixelTransform_);\n\n    // resize and clear\n    const canvas = context.canvas;\n    const width = Math.round(size[0] * pixelRatio);\n    const height = Math.round(size[1] * pixelRatio);\n    if (canvas.width != width || canvas.height != height) {\n      canvas.width = width;\n      canvas.height = height;\n      const canvasTransform = transformToString(this.overlayPixelTransform_);\n      if (canvas.style.transform !== canvasTransform) {\n        canvas.style.transform = canvasTransform;\n      }\n    } else if (getUid(context) === this.overlayContextUid_) {\n      context.clearRect(0, 0, width, height);\n    }\n\n    const tiles = this.renderedTiles;\n    const tileGrid = source.getTileGridForProjection(frameState.viewState.projection);\n    const clips = [];\n    const clipZs = [];\n    for (let i = tiles.length - 1; i >= 0; --i) {\n      const tile = /** @type {import(\"../../VectorRenderTile.js\").default} */ (tiles[i]);\n      if (tile.getState() == TileState.ABORT) {\n        continue;\n      }\n      const tileCoord = tile.tileCoord;\n      const tileExtent = tileGrid.getTileCoordExtent(tile.wrappedTileCoord);\n      const worldOffset = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent)[0] - tileExtent[0];\n      const transform = this.getRenderTransform(frameState, width, height, worldOffset);\n      const executorGroups = tile.executorGroups[getUid(layer)];\n      let clipped = false;\n      for (let t = 0, tt = executorGroups.length; t < tt; ++t) {\n        const executorGroup = executorGroups[t];\n        if (!executorGroup.hasExecutors(replayTypes)) {\n          // sourceTile has no instructions of the types we want to render\n          continue;\n        }\n        const currentZ = tile.tileCoord[0];\n        let currentClip;\n        if (!declutterReplays && !clipped) {\n          currentClip = executorGroup.getClipCoords(transform);\n          context.save();\n\n          // Create a clip mask for regions in this low resolution tile that are\n          // already filled by a higher resolution tile\n          for (let j = 0, jj = clips.length; j < jj; ++j) {\n            const clip = clips[j];\n            if (currentZ < clipZs[j]) {\n              context.beginPath();\n              // counter-clockwise (outer ring) for current tile\n              context.moveTo(currentClip[0], currentClip[1]);\n              context.lineTo(currentClip[2], currentClip[3]);\n              context.lineTo(currentClip[4], currentClip[5]);\n              context.lineTo(currentClip[6], currentClip[7]);\n              // clockwise (inner ring) for higher resolution tile\n              context.moveTo(clip[6], clip[7]);\n              context.lineTo(clip[4], clip[5]);\n              context.lineTo(clip[2], clip[3]);\n              context.lineTo(clip[0], clip[1]);\n              context.clip();\n            }\n          }\n        }\n        executorGroup.execute(context, transform, rotation, hifi, replayTypes, declutterReplays);\n        if (!declutterReplays && !clipped) {\n          context.restore();\n          clips.push(currentClip);\n          clipZs.push(currentZ);\n          clipped = true;\n        }\n      }\n    }\n    if (declutterReplays) {\n      const layerState = frameState.layerStatesArray[frameState.layerIndex];\n      replayDeclutter(declutterReplays, context, rotation, layerState.opacity, hifi, frameState.declutterItems);\n    }\n\n    return this.container;\n  }\n\n  /**\n   * @param {boolean} hifi We have time to render a high fidelity map image.\n   * @param {import('../../PluggableMap.js').FrameState} frameState Frame state.\n   */\n  renderQueuedTileImages_(hifi, frameState) {\n    // When we don't have time to render hifi, only render tiles until we have used up\n    // half of the frame budget of 16 ms\n    for (const uid in this.renderTileImageQueue_) {\n      if (!hifi && Date.now() - frameState.time > 8) {\n        frameState.animate = true;\n        break;\n      }\n      const tile = this.renderTileImageQueue_[uid];\n      delete this.renderTileImageQueue_[uid];\n      this.renderTileImage_(tile, frameState);\n    }\n  }\n\n  /**\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../../style/Style.js\").default|Array<import(\"../../style/Style.js\").default>} styles The style or array of styles.\n   * @param {import(\"../../render/canvas/BuilderGroup.js\").default} executorGroup Replay group.\n   * @return {boolean} `true` if an image is loading.\n   */\n  renderFeature(feature, squaredTolerance, styles, executorGroup) {\n    if (!styles) {\n      return false;\n    }\n    let loading = false;\n    if (Array.isArray(styles)) {\n      for (let i = 0, ii = styles.length; i < ii; ++i) {\n        loading = renderFeature(\n          executorGroup, feature, styles[i], squaredTolerance,\n          this.boundHandleStyleImageChange_) || loading;\n      }\n    } else {\n      loading = renderFeature(\n        executorGroup, feature, styles, squaredTolerance,\n        this.boundHandleStyleImageChange_);\n    }\n    return loading;\n  }\n\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @return {boolean} A new tile image was rendered.\n   * @private\n   */\n  tileImageNeedsRender_(tile, pixelRatio, projection) {\n    const layer = /** @type {import(\"../../layer/VectorTile.js\").default} */ (this.getLayer());\n    const replayState = tile.getReplayState(layer);\n    const revision = layer.getRevision();\n    const sourceZ = tile.sourceZ;\n    const resolution = tile.wantedResolution;\n    return replayState.renderedTileResolution !== resolution || replayState.renderedTileRevision !== revision || replayState.renderedTileZ !== sourceZ;\n  }\n\n  /**\n   * @param {import(\"../../VectorRenderTile.js\").default} tile Tile.\n   * @param {import(\"../../PluggableMap\").FrameState} frameState Frame state.\n   * @private\n   */\n  renderTileImage_(tile, frameState) {\n    const layer = /** @type {import(\"../../layer/VectorTile.js\").default} */ (this.getLayer());\n    const replayState = tile.getReplayState(layer);\n    const revision = layer.getRevision();\n    const executorGroups = tile.executorGroups[getUid(layer)];\n    replayState.renderedTileRevision = revision;\n    replayState.renderedTileZ = tile.sourceZ;\n\n    const tileCoord = tile.wrappedTileCoord;\n    const z = tileCoord[0];\n    const source = layer.getSource();\n    let pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const projection = viewState.projection;\n    const tileGrid = source.getTileGridForProjection(projection);\n    const tileResolution = tileGrid.getResolution(tile.tileCoord[0]);\n    const renderPixelRatio = frameState.pixelRatio / tile.wantedResolution * tileResolution;\n    const resolution = tileGrid.getResolution(z);\n    const context = tile.getContext(layer);\n\n    // Increase tile size when overzooming for low pixel ratio, to avoid blurry tiles\n    pixelRatio = Math.max(pixelRatio, renderPixelRatio / pixelRatio);\n    const size = source.getTilePixelSize(z, pixelRatio, projection);\n    context.canvas.width = size[0];\n    context.canvas.height = size[1];\n    const renderScale = pixelRatio / renderPixelRatio;\n    if (renderScale !== 1) {\n      const canvasTransform = resetTransform(this.tmpTransform_);\n      scaleTransform(canvasTransform, renderScale, renderScale);\n      context.setTransform.apply(context, canvasTransform);\n    }\n    const tileExtent = tileGrid.getTileCoordExtent(tileCoord, this.tmpExtent);\n    const pixelScale = renderPixelRatio / resolution;\n    const transform = resetTransform(this.tmpTransform_);\n    scaleTransform(transform, pixelScale, -pixelScale);\n    translateTransform(transform, -tileExtent[0], -tileExtent[3]);\n    for (let i = 0, ii = executorGroups.length; i < ii; ++i) {\n      const executorGroup = executorGroups[i];\n      executorGroup.execute(context, transform, 0, true, IMAGE_REPLAYS[layer.getRenderMode()]);\n    }\n    replayState.renderedTileResolution = tile.wantedResolution;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getDataAtPixel(pixel, frameState, hitTolerance) {\n    let data = super.getDataAtPixel(pixel, frameState, hitTolerance);\n    if (data) {\n      return data;\n    }\n\n    const renderPixel = applyTransform(this.inverseOverlayPixelTransform_, pixel.slice());\n    const context = this.overlayContext_;\n\n    try {\n      data = context.getImageData(Math.round(renderPixel[0]), Math.round(renderPixel[1]), 1, 1).data;\n    } catch (err) {\n      if (err.name === 'SecurityError') {\n        // tainted canvas, we assume there is data at the given pixel (although there might not be)\n        return new Uint8Array();\n      }\n      return data;\n    }\n\n    if (data[3] === 0) {\n      return null;\n    }\n    return data;\n  }\n\n}\n\n\nexport default CanvasVectorTileLayerRenderer;\n","/**\n * @module ol/layer/VectorTile\n */\nimport {assert} from '../asserts.js';\nimport TileProperty from './TileProperty.js';\nimport BaseVectorLayer from './BaseVector.js';\nimport VectorTileRenderType from './VectorTileRenderType.js';\nimport CanvasVectorTileLayerRenderer from '../renderer/canvas/VectorTileLayer.js';\nimport {assign} from '../obj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {import(\"../render.js\").OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the tile extent used by the\n * renderer when getting features from the vector tile for the rendering or hit-detection.\n * Recommended value: Vector tiles are usually generated with a buffer, so this value should match\n * the largest possible buffer of the used tiles. It should be at least the size of the largest\n * point symbol or line width.\n * @property {import(\"./VectorTileRenderType.js\").default|string} [renderMode='hybrid'] Render mode for vector tiles:\n *  * `'image'`: Vector tiles are rendered as images. Great performance, but point symbols and texts\n *    are always rotated with the view and pixels are scaled during zoom animations. When `declutter`\n *    is set to `true`, the decluttering is done per tile resulting in labels and point symbols getting\n *    cut off at tile boundaries.\n *  * `'hybrid'`: Polygon and line elements are rendered as images, so pixels are scaled during zoom\n *    animations. Point symbols and texts are accurately rendered as vectors and can stay upright on\n *    rotated views.\n *\n * @property {import(\"../source/VectorTile.js\").default} [source] Source.\n * @property {import(\"../PluggableMap.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text. Decluttering is applied to all\n * image and text styles of all Vector and VectorTile layers that have set this to `true`. The priority\n * is defined by the z-index of the layer, the `zIndex` of the style and the render order of features.\n * Higher z-index means higher priority. Within the same z-index, a feature rendered before another has\n * higher priority.\n * @property {import(\"../style/Style.js\").StyleLike} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [updateWhileAnimating=false] When set to `true`, feature batches will be\n * recreated during animations. This means that no vectors will be shown clipped, but the setting\n * will have a performance impact for large amounts of vector data. When set to `false`, batches\n * will be recreated when no animation is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true`, feature batches will be\n * recreated during interactions. See also `updateWhileAnimating`.\n * @property {number} [preload=0] Preload. Load low-resolution tiles up to `preload` levels. `0`\n * means no preloading.\n * @property {boolean} [useInterimTilesOnError=true] Use interim tiles on error.\n */\n\n\n/**\n * @classdesc\n * Layer for vector tile data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @param {Options=} opt_options Options.\n * @extends {BaseVectorLayer<import(\"../source/VectorTile.js\").default>}\n * @api\n */\nclass VectorTileLayer extends BaseVectorLayer {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const baseOptions = /** @type {Object} */ (assign({}, options));\n    delete baseOptions.preload;\n    delete baseOptions.useInterimTilesOnError;\n\n    super(/** @type {import(\"./BaseVector.js\").Options} */ (baseOptions));\n\n    const renderMode = options.renderMode || VectorTileRenderType.HYBRID;\n    assert(renderMode == undefined ||\n        renderMode == VectorTileRenderType.IMAGE ||\n        renderMode == VectorTileRenderType.HYBRID,\n    28); // `renderMode` must be `'image'` or `'hybrid'`\n\n    /**\n     * @private\n     * @type {VectorTileRenderType}\n     */\n    this.renderMode_ = renderMode;\n\n    this.setPreload(options.preload ? options.preload : 0);\n    this.setUseInterimTilesOnError(options.useInterimTilesOnError !== undefined ?\n      options.useInterimTilesOnError : true);\n\n  }\n\n  /**\n   * Create a renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n   * @protected\n   */\n  createRenderer() {\n    return new CanvasVectorTileLayerRenderer(this);\n  }\n\n  /**\n   * @return {VectorTileRenderType} The render mode.\n   */\n  getRenderMode() {\n    return this.renderMode_;\n  }\n\n  /**\n   * Return the level as number to which we will preload tiles up to.\n   * @return {number} The level to preload tiles up to.\n   * @observable\n   * @api\n   */\n  getPreload() {\n    return /** @type {number} */ (this.get(TileProperty.PRELOAD));\n  }\n\n  /**\n   * Whether we use interim tiles on error.\n   * @return {boolean} Use interim tiles on error.\n   * @observable\n   * @api\n   */\n  getUseInterimTilesOnError() {\n    return /** @type {boolean} */ (this.get(TileProperty.USE_INTERIM_TILES_ON_ERROR));\n  }\n\n  /**\n   * Set the level as number to which we will preload tiles up to.\n   * @param {number} preload The level to preload tiles up to.\n   * @observable\n   * @api\n   */\n  setPreload(preload) {\n    this.set(TileProperty.PRELOAD, preload);\n  }\n\n  /**\n   * Set whether we use interim tiles on error.\n   * @param {boolean} useInterimTilesOnError Use interim tiles on error.\n   * @observable\n   * @api\n   */\n  setUseInterimTilesOnError(useInterimTilesOnError) {\n    this.set(TileProperty.USE_INTERIM_TILES_ON_ERROR, useInterimTilesOnError);\n  }\n}\n\n\nexport default VectorTileLayer;\n","/**\n * @module ol/format/FormatType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ARRAY_BUFFER: 'arraybuffer',\n  JSON: 'json',\n  TEXT: 'text',\n  XML: 'xml'\n};\n","/**\n * @module ol/colorlike\n */\nimport {toString} from './color.js';\n\n\n/**\n * A type accepted by CanvasRenderingContext2D.fillStyle\n * or CanvasRenderingContext2D.strokeStyle.\n * Represents a color, pattern, or gradient. The origin for patterns and\n * gradients as fill style is an increment of 512 css pixels from map coordinate\n * `[0, 0]`. For seamless repeat patterns, width and height of the pattern image\n * must be a factor of two (2, 4, 8, ..., 512).\n *\n * @typedef {string|CanvasPattern|CanvasGradient} ColorLike\n * @api\n */\n\n\n/**\n * @param {import(\"./color.js\").Color|ColorLike} color Color.\n * @return {ColorLike} The color as an {@link ol/colorlike~ColorLike}.\n * @api\n */\nexport function asColorLike(color) {\n  if (Array.isArray(color)) {\n    return toString(color);\n  } else {\n    return color;\n  }\n}\n","/**\n * @module ol/source/VectorEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a feature is added to the source.\n   * @event module:ol/source/Vector.VectorSourceEvent#addfeature\n   * @api\n   */\n  ADDFEATURE: 'addfeature',\n\n  /**\n   * Triggered when a feature is updated.\n   * @event module:ol/source/Vector.VectorSourceEvent#changefeature\n   * @api\n   */\n  CHANGEFEATURE: 'changefeature',\n\n  /**\n   * Triggered when the clear method is called on the source.\n   * @event module:ol/source/Vector.VectorSourceEvent#clear\n   * @api\n   */\n  CLEAR: 'clear',\n\n  /**\n   * Triggered when a feature is removed from the source.\n   * See {@link module:ol/source/Vector#clear source.clear()} for exceptions.\n   * @event module:ol/source/Vector.VectorSourceEvent#removefeature\n   * @api\n   */\n  REMOVEFEATURE: 'removefeature'\n};\n","/**\n * @module ol/ViewProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  CENTER: 'center',\n  RESOLUTION: 'resolution',\n  ROTATION: 'rotation'\n};\n","/**\n * @module ol/source/ImageWMS\n */\n\nimport {DEFAULT_WMS_VERSION} from './common.js';\n\nimport ImageWrapper from '../Image.js';\nimport {assert} from '../asserts.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, getCenter, getForViewAndSize, getHeight, getWidth} from '../extent.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection, transform} from '../proj.js';\nimport {calculateSourceResolution} from '../reproj.js';\nimport ImageSource, {defaultImageLoadFunction} from './Image.js';\nimport WMSServerType from './WMSServerType.js';\nimport {compareVersions} from '../string.js';\nimport {appendParams} from '../uri.js';\n\n\n/**\n * @const\n * @type {import(\"../size.js\").Size}\n */\nconst GETFEATUREINFO_IMAGE_SIZE = [101, 101];\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [hidpi=true] Use the `ol/Map#pixelRatio` value when requesting\n * the image from the remote server.\n * @property {import(\"./WMSServerType.js\").default|string} [serverType] The type of\n * the remote WMS server: `mapserver`, `geoserver` or `qgis`. Only needed if `hidpi` is `true`.\n * @property {import(\"../Image.js\").LoadFunction} [imageLoadFunction] Optional function to load an image given a URL.\n * @property {Object<string,*>} params WMS request parameters.\n * At least a `LAYERS` param is required. `STYLES` is\n * `''` by default. `VERSION` is `1.3.0` by default. `WIDTH`, `HEIGHT`, `BBOX`\n * and `CRS` (`SRS` for WMS version < 1.3.0) will be set dynamically.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {number} [ratio=1.5] Ratio. `1` means image requests are the size of the map viewport, `2` means\n * twice the width and height of the map viewport, and so on. Must be `1` or\n * higher.\n * @property {Array<number>} [resolutions] Resolutions.\n * If specified, requests will be made for these resolutions only.\n * @property {string} url WMS service URL.\n */\n\n\n/**\n * @classdesc\n * Source for WMS servers providing single, untiled images.\n *\n * @fires module:ol/source/Image.ImageSourceEvent\n * @api\n */\nclass ImageWMS extends ImageSource {\n  /**\n   * @param {Options=} [opt_options] ImageWMS options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      attributions: options.attributions,\n      projection: options.projection,\n      resolutions: options.resolutions\n    });\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ =\n        options.crossOrigin !== undefined ? options.crossOrigin : null;\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.url_ = options.url;\n\n    /**\n     * @private\n     * @type {import(\"../Image.js\").LoadFunction}\n     */\n    this.imageLoadFunction_ = options.imageLoadFunction !== undefined ?\n      options.imageLoadFunction : defaultImageLoadFunction;\n\n    /**\n     * @private\n     * @type {!Object}\n     */\n    this.params_ = options.params || {};\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.v13_ = true;\n    this.updateV13_();\n\n    /**\n     * @private\n     * @type {import(\"./WMSServerType.js\").default|undefined}\n     */\n    this.serverType_ = /** @type {import(\"./WMSServerType.js\").default|undefined} */ (options.serverType);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.hidpi_ = options.hidpi !== undefined ? options.hidpi : true;\n\n    /**\n     * @private\n     * @type {import(\"../Image.js\").default}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.imageSize_ = [0, 0];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedRevision_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.ratio_ = options.ratio !== undefined ? options.ratio : 1.5;\n\n  }\n\n  /**\n   * Return the GetFeatureInfo URL for the passed coordinate, resolution, and\n   * projection. Return `undefined` if the GetFeatureInfo URL cannot be\n   * constructed.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {number} resolution Resolution.\n   * @param {import(\"../proj.js\").ProjectionLike} projection Projection.\n   * @param {!Object} params GetFeatureInfo params. `INFO_FORMAT` at least should\n   *     be provided. If `QUERY_LAYERS` is not provided then the layers specified\n   *     in the `LAYERS` parameter will be used. `VERSION` should not be\n   *     specified here.\n   * @return {string|undefined} GetFeatureInfo URL.\n   * @api\n   */\n  getFeatureInfoUrl(coordinate, resolution, projection, params) {\n    if (this.url_ === undefined) {\n      return undefined;\n    }\n    const projectionObj = getProjection(projection);\n    const sourceProjectionObj = this.getProjection();\n\n    if (sourceProjectionObj && sourceProjectionObj !== projectionObj) {\n      resolution = calculateSourceResolution(sourceProjectionObj, projectionObj, coordinate, resolution);\n      coordinate = transform(coordinate, projectionObj, sourceProjectionObj);\n    }\n\n    const extent = getForViewAndSize(coordinate, resolution, 0,\n      GETFEATUREINFO_IMAGE_SIZE);\n\n    const baseParams = {\n      'SERVICE': 'WMS',\n      'VERSION': DEFAULT_WMS_VERSION,\n      'REQUEST': 'GetFeatureInfo',\n      'FORMAT': 'image/png',\n      'TRANSPARENT': true,\n      'QUERY_LAYERS': this.params_['LAYERS']\n    };\n    assign(baseParams, this.params_, params);\n\n    const x = Math.floor((coordinate[0] - extent[0]) / resolution);\n    const y = Math.floor((extent[3] - coordinate[1]) / resolution);\n    baseParams[this.v13_ ? 'I' : 'X'] = x;\n    baseParams[this.v13_ ? 'J' : 'Y'] = y;\n\n    return this.getRequestUrl_(\n      extent, GETFEATUREINFO_IMAGE_SIZE,\n      1, sourceProjectionObj || projectionObj, baseParams);\n  }\n\n  /**\n   * Return the GetLegendGraphic URL, optionally optimized for the passed\n   * resolution and possibly including any passed specific parameters. Returns\n   * `undefined` if the GetLegendGraphic URL cannot be constructed.\n   *\n   * @param {number} [resolution] Resolution. If set to undefined, `SCALE`\n   *     will not be calculated and included in URL.\n   * @param {Object} [params] GetLegendGraphic params. If `LAYER` is set, the\n   *     request is generated for this wms layer, else it will try to use the\n   *     configured wms layer. Default `FORMAT` is `image/png`.\n   *     `VERSION` should not be specified here.\n   * @return {string|undefined} GetLegendGraphic URL.\n   * @api\n   */\n  getLegendUrl(resolution, params) {\n    if (this.url_ === undefined) {\n      return undefined;\n    }\n\n    const baseParams = {\n      'SERVICE': 'WMS',\n      'VERSION': DEFAULT_WMS_VERSION,\n      'REQUEST': 'GetLegendGraphic',\n      'FORMAT': 'image/png'\n    };\n\n    if (params === undefined || params['LAYER'] === undefined) {\n      const layers = this.params_.LAYERS;\n      const isSingleLayer = !Array.isArray(layers) || layers.length === 1;\n      if (!isSingleLayer) {\n        return undefined;\n      }\n      baseParams['LAYER'] = layers;\n    }\n\n    if (resolution !== undefined) {\n      const mpu = this.getProjection() ? this.getProjection().getMetersPerUnit() : 1;\n      const dpi = 25.4 / 0.28;\n      const inchesPerMeter = 39.37;\n      baseParams['SCALE'] = resolution * mpu * inchesPerMeter * dpi;\n    }\n\n    assign(baseParams, params);\n\n    return appendParams(/** @type {string} */ (this.url_), baseParams);\n  }\n\n  /**\n   * Get the user-provided params, i.e. those passed to the constructor through\n   * the \"params\" option, and possibly updated using the updateParams method.\n   * @return {Object} Params.\n   * @api\n   */\n  getParams() {\n    return this.params_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImageInternal(extent, resolution, pixelRatio, projection) {\n\n    if (this.url_ === undefined) {\n      return null;\n    }\n\n    resolution = this.findNearestResolution(resolution);\n\n    if (pixelRatio != 1 && (!this.hidpi_ || this.serverType_ === undefined)) {\n      pixelRatio = 1;\n    }\n\n    const imageResolution = resolution / pixelRatio;\n\n    const center = getCenter(extent);\n    const viewWidth = Math.ceil(getWidth(extent) / imageResolution);\n    const viewHeight = Math.ceil(getHeight(extent) / imageResolution);\n    const viewExtent = getForViewAndSize(center, imageResolution, 0,\n      [viewWidth, viewHeight]);\n    const requestWidth = Math.ceil(this.ratio_ * getWidth(extent) / imageResolution);\n    const requestHeight = Math.ceil(this.ratio_ * getHeight(extent) / imageResolution);\n    const requestExtent = getForViewAndSize(center, imageResolution, 0,\n      [requestWidth, requestHeight]);\n\n    const image = this.image_;\n    if (image &&\n        this.renderedRevision_ == this.getRevision() &&\n        image.getResolution() == resolution &&\n        image.getPixelRatio() == pixelRatio &&\n        containsExtent(image.getExtent(), viewExtent)) {\n      return image;\n    }\n\n    const params = {\n      'SERVICE': 'WMS',\n      'VERSION': DEFAULT_WMS_VERSION,\n      'REQUEST': 'GetMap',\n      'FORMAT': 'image/png',\n      'TRANSPARENT': true\n    };\n    assign(params, this.params_);\n\n    this.imageSize_[0] = Math.round(getWidth(requestExtent) / imageResolution);\n    this.imageSize_[1] = Math.round(getHeight(requestExtent) / imageResolution);\n\n    const url = this.getRequestUrl_(requestExtent, this.imageSize_, pixelRatio,\n      projection, params);\n\n    this.image_ = new ImageWrapper(requestExtent, resolution, pixelRatio,\n      url, this.crossOrigin_, this.imageLoadFunction_);\n\n    this.renderedRevision_ = this.getRevision();\n\n    this.image_.addEventListener(EventType.CHANGE, this.handleImageChange.bind(this));\n\n    return this.image_;\n\n  }\n\n  /**\n   * Return the image load function of the source.\n   * @return {import(\"../Image.js\").LoadFunction} The image load function.\n   * @api\n   */\n  getImageLoadFunction() {\n    return this.imageLoadFunction_;\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {import(\"../size.js\").Size} size Size.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {Object} params Params.\n   * @return {string} Request URL.\n   * @private\n   */\n  getRequestUrl_(extent, size, pixelRatio, projection, params) {\n\n    assert(this.url_ !== undefined, 9); // `url` must be configured or set using `#setUrl()`\n\n    params[this.v13_ ? 'CRS' : 'SRS'] = projection.getCode();\n\n    if (!('STYLES' in this.params_)) {\n      params['STYLES'] = '';\n    }\n\n    if (pixelRatio != 1) {\n      switch (this.serverType_) {\n        case WMSServerType.GEOSERVER:\n          const dpi = (90 * pixelRatio + 0.5) | 0;\n          if ('FORMAT_OPTIONS' in params) {\n            params['FORMAT_OPTIONS'] += ';dpi:' + dpi;\n          } else {\n            params['FORMAT_OPTIONS'] = 'dpi:' + dpi;\n          }\n          break;\n        case WMSServerType.MAPSERVER:\n          params['MAP_RESOLUTION'] = 90 * pixelRatio;\n          break;\n        case WMSServerType.CARMENTA_SERVER:\n        case WMSServerType.QGIS:\n          params['DPI'] = 90 * pixelRatio;\n          break;\n        default:\n          assert(false, 8); // Unknown `serverType` configured\n          break;\n      }\n    }\n\n    params['WIDTH'] = size[0];\n    params['HEIGHT'] = size[1];\n\n    const axisOrientation = projection.getAxisOrientation();\n    let bbox;\n    if (this.v13_ && axisOrientation.substr(0, 2) == 'ne') {\n      bbox = [extent[1], extent[0], extent[3], extent[2]];\n    } else {\n      bbox = extent;\n    }\n    params['BBOX'] = bbox.join(',');\n\n    return appendParams(/** @type {string} */ (this.url_), params);\n  }\n\n  /**\n   * Return the URL used for this WMS source.\n   * @return {string|undefined} URL.\n   * @api\n   */\n  getUrl() {\n    return this.url_;\n  }\n\n  /**\n   * Set the image load function of the source.\n   * @param {import(\"../Image.js\").LoadFunction} imageLoadFunction Image load function.\n   * @api\n   */\n  setImageLoadFunction(imageLoadFunction) {\n    this.image_ = null;\n    this.imageLoadFunction_ = imageLoadFunction;\n    this.changed();\n  }\n\n  /**\n   * Set the URL to use for requests.\n   * @param {string|undefined} url URL.\n   * @api\n   */\n  setUrl(url) {\n    if (url != this.url_) {\n      this.url_ = url;\n      this.image_ = null;\n      this.changed();\n    }\n  }\n\n  /**\n   * Update the user-provided params.\n   * @param {Object} params Params.\n   * @api\n   */\n  updateParams(params) {\n    assign(this.params_, params);\n    this.updateV13_();\n    this.image_ = null;\n    this.changed();\n  }\n\n  /**\n   * @private\n   */\n  updateV13_() {\n    const version = this.params_['VERSION'] || DEFAULT_WMS_VERSION;\n    this.v13_ = compareVersions(version, '1.3') >= 0;\n  }\n}\n\n\nexport default ImageWMS;\n","/**\n * @module ol/Observable\n */\nimport {listen, unlistenByKey, listenOnce} from './events.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * An event target providing convenient methods for listener registration\n * and unregistration. A generic `change` event is always available through\n * {@link module:ol/Observable~Observable#changed}.\n *\n * @fires import(\"./events/Event.js\").default\n * @api\n */\nclass Observable extends EventTarget {\n  constructor() {\n\n    super();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.revision_ = 0;\n\n  }\n\n  /**\n   * Increases the revision counter and dispatches a 'change' event.\n   * @api\n   */\n  changed() {\n    ++this.revision_;\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * Get the version number for this object.  Each time the object is modified,\n   * its version number will be incremented.\n   * @return {number} Revision.\n   * @api\n   */\n  getRevision() {\n    return this.revision_;\n  }\n\n  /**\n   * Listen for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  on(type, listener) {\n    if (Array.isArray(type)) {\n      const len = type.length;\n      const keys = new Array(len);\n      for (let i = 0; i < len; ++i) {\n        keys[i] = listen(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listen(this, /** @type {string} */ (type), listener);\n    }\n  }\n\n  /**\n   * Listen once for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @return {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} Unique key for the listener. If\n   *     called with an array of event types as the first argument, the return\n   *     will be an array of keys.\n   * @api\n   */\n  once(type, listener) {\n    if (Array.isArray(type)) {\n      const len = type.length;\n      const keys = new Array(len);\n      for (let i = 0; i < len; ++i) {\n        keys[i] = listenOnce(this, type[i], listener);\n      }\n      return keys;\n    } else {\n      return listenOnce(this, /** @type {string} */ (type), listener);\n    }\n  }\n\n  /**\n   * Unlisten for a certain type of event.\n   * @param {string|Array<string>} type The event type or array of event types.\n   * @param {function(?): ?} listener The listener function.\n   * @api\n   */\n  un(type, listener) {\n    if (Array.isArray(type)) {\n      for (let i = 0, ii = type.length; i < ii; ++i) {\n        this.removeEventListener(type[i], listener);\n      }\n    } else {\n      this.removeEventListener(type, listener);\n    }\n  }\n}\n\n\n/**\n * Removes an event listener using the key returned by `on()` or `once()`.\n * @param {import(\"./events.js\").EventsKey|Array<import(\"./events.js\").EventsKey>} key The key returned by `on()`\n *     or `once()` (or an array of keys).\n * @api\n */\nexport function unByKey(key) {\n  if (Array.isArray(key)) {\n    for (let i = 0, ii = key.length; i < ii; ++i) {\n      unlistenByKey(key[i]);\n    }\n  } else {\n    unlistenByKey(/** @type {import(\"./events.js\").EventsKey} */ (key));\n  }\n}\n\n\nexport default Observable;\n","/**\n * @module ol/string\n */\n\n/**\n * @param {number} number Number to be formatted\n * @param {number} width The desired width\n * @param {number=} opt_precision Precision of the output string (i.e. number of decimal places)\n * @returns {string} Formatted string\n */\nexport function padNumber(number, width, opt_precision) {\n  const numberString = opt_precision !== undefined ? number.toFixed(opt_precision) : '' + number;\n  let decimal = numberString.indexOf('.');\n  decimal = decimal === -1 ? numberString.length : decimal;\n  return decimal > width ? numberString : new Array(1 + width - decimal).join('0') + numberString;\n}\n\n\n/**\n * Adapted from https://github.com/omichelsen/compare-versions/blob/master/index.js\n * @param {string|number} v1 First version\n * @param {string|number} v2 Second version\n * @returns {number} Value\n */\nexport function compareVersions(v1, v2) {\n  const s1 = ('' + v1).split('.');\n  const s2 = ('' + v2).split('.');\n\n  for (let i = 0; i < Math.max(s1.length, s2.length); i++) {\n    const n1 = parseInt(s1[i] || '0', 10);\n    const n2 = parseInt(s2[i] || '0', 10);\n\n    if (n1 > n2) {\n      return 1;\n    }\n    if (n2 > n1) {\n      return -1;\n    }\n  }\n\n  return 0;\n}\n","/**\n * @module ol/events/Target\n */\nimport Disposable from '../Disposable.js';\nimport {VOID} from '../functions.js';\nimport Event from './Event.js';\nimport {clear} from '../obj.js';\n\n\n/**\n * @typedef {EventTarget|Target} EventTargetLike\n */\n\n\n/**\n * @classdesc\n * A simplified implementation of the W3C DOM Level 2 EventTarget interface.\n * See https://www.w3.org/TR/2000/REC-DOM-Level-2-Events-20001113/events.html#Events-EventTarget.\n *\n * There are two important simplifications compared to the specification:\n *\n * 1. The handling of `useCapture` in `addEventListener` and\n *    `removeEventListener`. There is no real capture model.\n * 2. The handling of `stopPropagation` and `preventDefault` on `dispatchEvent`.\n *    There is no event target hierarchy. When a listener calls\n *    `stopPropagation` or `preventDefault` on an event object, it means that no\n *    more listeners after this one will be called. Same as when the listener\n *    returns false.\n */\nclass Target extends Disposable {\n\n  /**\n   * @param {*=} opt_target Default event target for dispatched events.\n   */\n  constructor(opt_target) {\n\n    super();\n\n    /**\n     * @private\n     * @type {*}\n     */\n    this.target_ = opt_target;\n\n    /**\n     * @private\n     * @type {!Object<string, number>}\n     */\n    this.pendingRemovals_ = {};\n\n    /**\n     * @private\n     * @type {!Object<string, number>}\n     */\n    this.dispatching_ = {};\n\n    /**\n     * @private\n     * @type {!Object<string, Array<import(\"../events.js\").ListenerFunction>>}\n     */\n    this.listeners_ = {};\n\n  }\n\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../events.js\").ListenerFunction} listener Listener.\n   */\n  addEventListener(type, listener) {\n    if (!type || !listener) {\n      return;\n    }\n    let listeners = this.listeners_[type];\n    if (!listeners) {\n      listeners = this.listeners_[type] = [];\n    }\n    if (listeners.indexOf(listener) === -1) {\n      listeners.push(listener);\n    }\n  }\n\n  /**\n   * Dispatches an event and calls all listeners listening for events\n   * of this type. The event parameter can either be a string or an\n   * Object with a `type` property.\n   *\n   * @param {{type: string,\n   *     target: (EventTargetLike|undefined),\n   *     propagationStopped: (boolean|undefined)}|\n   *     import(\"./Event.js\").default|string} event Event object.\n   * @return {boolean|undefined} `false` if anyone called preventDefault on the\n   *     event object or if any of the listeners returned false.\n   * @api\n   */\n  dispatchEvent(event) {\n    const evt = typeof event === 'string' ? new Event(event) : event;\n    const type = evt.type;\n    if (!evt.target) {\n      evt.target = this.target_ || this;\n    }\n    const listeners = this.listeners_[type];\n    let propagate;\n    if (listeners) {\n      if (!(type in this.dispatching_)) {\n        this.dispatching_[type] = 0;\n        this.pendingRemovals_[type] = 0;\n      }\n      ++this.dispatching_[type];\n      for (let i = 0, ii = listeners.length; i < ii; ++i) {\n        if (listeners[i].call(this, evt) === false || evt.propagationStopped) {\n          propagate = false;\n          break;\n        }\n      }\n      --this.dispatching_[type];\n      if (this.dispatching_[type] === 0) {\n        let pendingRemovals = this.pendingRemovals_[type];\n        delete this.pendingRemovals_[type];\n        while (pendingRemovals--) {\n          this.removeEventListener(type, VOID);\n        }\n        delete this.dispatching_[type];\n      }\n      return propagate;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    clear(this.listeners_);\n  }\n\n  /**\n   * Get the listeners for a specified event type. Listeners are returned in the\n   * order that they will be called in.\n   *\n   * @param {string} type Type.\n   * @return {Array<import(\"../events.js\").ListenerFunction>} Listeners.\n   */\n  getListeners(type) {\n    return this.listeners_[type];\n  }\n\n  /**\n   * @param {string=} opt_type Type. If not provided,\n   *     `true` will be returned if this event target has any listeners.\n   * @return {boolean} Has listeners.\n   */\n  hasListener(opt_type) {\n    return opt_type ?\n      opt_type in this.listeners_ :\n      Object.keys(this.listeners_).length > 0;\n  }\n\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../events.js\").ListenerFunction} listener Listener.\n   */\n  removeEventListener(type, listener) {\n    const listeners = this.listeners_[type];\n    if (listeners) {\n      const index = listeners.indexOf(listener);\n      if (index !== -1) {\n        if (type in this.pendingRemovals_) {\n          // make listener a no-op, and remove later in #dispatchEvent()\n          listeners[index] = VOID;\n          ++this.pendingRemovals_[type];\n        } else {\n          listeners.splice(index, 1);\n          if (listeners.length === 0) {\n            delete this.listeners_[type];\n          }\n        }\n      }\n    }\n  }\n}\n\n\nexport default Target;\n","/**\n * @module ol/Disposable\n */\n\n/**\n * @classdesc\n * Objects that need to clean up after themselves.\n */\nclass Disposable {\n\n  constructor() {\n    /**\n     * The object has already been disposed.\n     * @type {boolean}\n     * @private\n     */\n    this.disposed_ = false;\n  }\n\n  /**\n   * Clean up.\n   */\n  dispose() {\n    if (!this.disposed_) {\n      this.disposed_ = true;\n      this.disposeInternal();\n    }\n  }\n\n  /**\n   * Extension point for disposable objects.\n   * @protected\n   */\n  disposeInternal() {}\n}\n\nexport default Disposable;\n","/**\n * @module ol/geom/flat/simplify\n */\n// Based on simplify-js https://github.com/mourner/simplify-js\n// Copyright (c) 2012, Vladimir Agafonkin\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n//    1. Redistributions of source code must retain the above copyright notice,\n//       this list of conditions and the following disclaimer.\n//\n//    2. Redistributions in binary form must reproduce the above copyright\n//       notice, this list of conditions and the following disclaimer in the\n//       documentation and/or other materials provided with the distribution.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE\n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n// POSSIBILITY OF SUCH DAMAGE.\n\nimport {squaredSegmentDistance, squaredDistance} from '../../math.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {boolean} highQuality Highest quality.\n * @param {Array<number>=} opt_simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @return {Array<number>} Simplified line string.\n */\nexport function simplifyLineString(flatCoordinates, offset, end,\n  stride, squaredTolerance, highQuality, opt_simplifiedFlatCoordinates) {\n  const simplifiedFlatCoordinates = opt_simplifiedFlatCoordinates !== undefined ?\n    opt_simplifiedFlatCoordinates : [];\n  if (!highQuality) {\n    end = radialDistance(flatCoordinates, offset, end,\n      stride, squaredTolerance,\n      simplifiedFlatCoordinates, 0);\n    flatCoordinates = simplifiedFlatCoordinates;\n    offset = 0;\n    stride = 2;\n  }\n  simplifiedFlatCoordinates.length = douglasPeucker(\n    flatCoordinates, offset, end, stride, squaredTolerance,\n    simplifiedFlatCoordinates, 0);\n  return simplifiedFlatCoordinates;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function douglasPeucker(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  const n = (end - offset) / stride;\n  if (n < 3) {\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  /** @type {Array<number>} */\n  const markers = new Array(n);\n  markers[0] = 1;\n  markers[n - 1] = 1;\n  /** @type {Array<number>} */\n  const stack = [offset, end - stride];\n  let index = 0;\n  while (stack.length > 0) {\n    const last = stack.pop();\n    const first = stack.pop();\n    let maxSquaredDistance = 0;\n    const x1 = flatCoordinates[first];\n    const y1 = flatCoordinates[first + 1];\n    const x2 = flatCoordinates[last];\n    const y2 = flatCoordinates[last + 1];\n    for (let i = first + stride; i < last; i += stride) {\n      const x = flatCoordinates[i];\n      const y = flatCoordinates[i + 1];\n      const squaredDistance = squaredSegmentDistance(\n        x, y, x1, y1, x2, y2);\n      if (squaredDistance > maxSquaredDistance) {\n        index = i;\n        maxSquaredDistance = squaredDistance;\n      }\n    }\n    if (maxSquaredDistance > squaredTolerance) {\n      markers[(index - offset) / stride] = 1;\n      if (first + stride < index) {\n        stack.push(first, index);\n      }\n      if (index + stride < last) {\n        stack.push(index, last);\n      }\n    }\n  }\n  for (let i = 0; i < n; ++i) {\n    if (markers[i]) {\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + i * stride + 1];\n    }\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerArray(flatCoordinates, offset,\n  ends, stride, squaredTolerance, simplifiedFlatCoordinates,\n  simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = douglasPeucker(\n      flatCoordinates, offset, end, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<Array<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function douglasPeuckerMultiArray(\n  flatCoordinates, offset, endss, stride, squaredTolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = douglasPeuckerArray(\n      flatCoordinates, offset, ends, stride, squaredTolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function radialDistance(flatCoordinates, offset, end,\n  stride, squaredTolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  if (end <= offset + stride) {\n    // zero or one point, no simplification possible, so copy and return\n    for (; offset < end; offset += stride) {\n      simplifiedFlatCoordinates[simplifiedOffset++] = flatCoordinates[offset];\n      simplifiedFlatCoordinates[simplifiedOffset++] =\n          flatCoordinates[offset + 1];\n    }\n    return simplifiedOffset;\n  }\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  // copy first point\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  let x2 = x1;\n  let y2 = y1;\n  for (offset += stride; offset < end; offset += stride) {\n    x2 = flatCoordinates[offset];\n    y2 = flatCoordinates[offset + 1];\n    if (squaredDistance(x1, y1, x2, y2) > squaredTolerance) {\n      // copy point at offset\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  if (x2 != x1 || y2 != y1) {\n    // copy last point\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {number} value Value.\n * @param {number} tolerance Tolerance.\n * @return {number} Rounded value.\n */\nexport function snap(value, tolerance) {\n  return tolerance * Math.round(value / tolerance);\n}\n\n\n/**\n * Simplifies a line string using an algorithm designed by Tim Schaub.\n * Coordinates are snapped to the nearest value in a virtual grid and\n * consecutive duplicate coordinates are discarded.  This effectively preserves\n * topology as the simplification of any subsection of a line string is\n * independent of the rest of the line string.  This means that, for examples,\n * the common edge between two polygons will be simplified to the same line\n * string independently in both polygons.  This implementation uses a single\n * pass over the coordinates and eliminates intermediate collinear points.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @return {number} Simplified offset.\n */\nexport function quantize(flatCoordinates, offset, end, stride,\n  tolerance, simplifiedFlatCoordinates, simplifiedOffset) {\n  // do nothing if the line is empty\n  if (offset == end) {\n    return simplifiedOffset;\n  }\n  // snap the first coordinate (P1)\n  let x1 = snap(flatCoordinates[offset], tolerance);\n  let y1 = snap(flatCoordinates[offset + 1], tolerance);\n  offset += stride;\n  // add the first coordinate to the output\n  simplifiedFlatCoordinates[simplifiedOffset++] = x1;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y1;\n  // find the next coordinate that does not snap to the same value as the first\n  // coordinate (P2)\n  let x2, y2;\n  do {\n    x2 = snap(flatCoordinates[offset], tolerance);\n    y2 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    if (offset == end) {\n      // all coordinates snap to the same value, the line collapses to a point\n      // push the last snapped value anyway to ensure that the output contains\n      // at least two points\n      // FIXME should we really return at least two points anyway?\n      simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n      simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n      return simplifiedOffset;\n    }\n  } while (x2 == x1 && y2 == y1);\n  while (offset < end) {\n    // snap the next coordinate (P3)\n    const x3 = snap(flatCoordinates[offset], tolerance);\n    const y3 = snap(flatCoordinates[offset + 1], tolerance);\n    offset += stride;\n    // skip P3 if it is equal to P2\n    if (x3 == x2 && y3 == y2) {\n      continue;\n    }\n    // calculate the delta between P1 and P2\n    const dx1 = x2 - x1;\n    const dy1 = y2 - y1;\n    // calculate the delta between P3 and P1\n    const dx2 = x3 - x1;\n    const dy2 = y3 - y1;\n    // if P1, P2, and P3 are colinear and P3 is further from P1 than P2 is from\n    // P1 in the same direction then P2 is on the straight line between P1 and\n    // P3\n    if ((dx1 * dy2 == dy1 * dx2) &&\n        ((dx1 < 0 && dx2 < dx1) || dx1 == dx2 || (dx1 > 0 && dx2 > dx1)) &&\n        ((dy1 < 0 && dy2 < dy1) || dy1 == dy2 || (dy1 > 0 && dy2 > dy1))) {\n      // discard P2 and set P2 = P3\n      x2 = x3;\n      y2 = y3;\n      continue;\n    }\n    // either P1, P2, and P3 are not colinear, or they are colinear but P3 is\n    // between P3 and P1 or on the opposite half of the line to P2.  add P2,\n    // and continue with P1 = P2 and P2 = P3\n    simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n    simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n    x1 = x2;\n    y1 = y2;\n    x2 = x3;\n    y2 = y3;\n  }\n  // add the last point (P2)\n  simplifiedFlatCoordinates[simplifiedOffset++] = x2;\n  simplifiedFlatCoordinates[simplifiedOffset++] = y2;\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<number>} simplifiedEnds Simplified ends.\n * @return {number} Simplified offset.\n */\nexport function quantizeArray(\n  flatCoordinates, offset, ends, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    simplifiedOffset = quantize(\n      flatCoordinates, offset, end, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset);\n    simplifiedEnds.push(simplifiedOffset);\n    offset = end;\n  }\n  return simplifiedOffset;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} tolerance Tolerance.\n * @param {Array<number>} simplifiedFlatCoordinates Simplified flat\n *     coordinates.\n * @param {number} simplifiedOffset Simplified offset.\n * @param {Array<Array<number>>} simplifiedEndss Simplified endss.\n * @return {number} Simplified offset.\n */\nexport function quantizeMultiArray(\n  flatCoordinates, offset, endss, stride,\n  tolerance,\n  simplifiedFlatCoordinates, simplifiedOffset, simplifiedEndss) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    const simplifiedEnds = [];\n    simplifiedOffset = quantizeArray(\n      flatCoordinates, offset, ends, stride,\n      tolerance,\n      simplifiedFlatCoordinates, simplifiedOffset, simplifiedEnds);\n    simplifiedEndss.push(simplifiedEnds);\n    offset = ends[ends.length - 1];\n  }\n  return simplifiedOffset;\n}\n","/**\n * @module ol/color\n */\nimport {assert} from './asserts.js';\nimport {clamp} from './math.js';\n\n\n/**\n * A color represented as a short array [red, green, blue, alpha].\n * red, green, and blue should be integers in the range 0..255 inclusive.\n * alpha should be a float in the range 0..1 inclusive. If no alpha value is\n * given then `1` will be used.\n * @typedef {Array<number>} Color\n * @api\n */\n\n\n/**\n * This RegExp matches # followed by 3, 4, 6, or 8 hex digits.\n * @const\n * @type {RegExp}\n * @private\n */\nconst HEX_COLOR_RE_ = /^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i;\n\n\n/**\n * Regular expression for matching potential named color style strings.\n * @const\n * @type {RegExp}\n * @private\n */\nconst NAMED_COLOR_RE_ = /^([a-z]*)$/i;\n\n\n/**\n * Return the color as an rgba string.\n * @param {Color|string} color Color.\n * @return {string} Rgba string.\n * @api\n */\nexport function asString(color) {\n  if (typeof color === 'string') {\n    return color;\n  } else {\n    return toString(color);\n  }\n}\n\n/**\n * Return named color as an rgba string.\n * @param {string} color Named color.\n * @return {string} Rgb string.\n */\nfunction fromNamed(color) {\n  const el = document.createElement('div');\n  el.style.color = color;\n  if (el.style.color !== '') {\n    document.body.appendChild(el);\n    const rgb = getComputedStyle(el).color;\n    document.body.removeChild(el);\n    return rgb;\n  } else {\n    return '';\n  }\n}\n\n\n/**\n * @param {string} s String.\n * @return {Color} Color.\n */\nexport const fromString = (\n  function() {\n\n    // We maintain a small cache of parsed strings.  To provide cheap LRU-like\n    // semantics, whenever the cache grows too large we simply delete an\n    // arbitrary 25% of the entries.\n\n    /**\n     * @const\n     * @type {number}\n     */\n    const MAX_CACHE_SIZE = 1024;\n\n    /**\n     * @type {Object<string, Color>}\n     */\n    const cache = {};\n\n    /**\n     * @type {number}\n     */\n    let cacheSize = 0;\n\n    return (\n      /**\n       * @param {string} s String.\n       * @return {Color} Color.\n       */\n      function(s) {\n        let color;\n        if (cache.hasOwnProperty(s)) {\n          color = cache[s];\n        } else {\n          if (cacheSize >= MAX_CACHE_SIZE) {\n            let i = 0;\n            for (const key in cache) {\n              if ((i++ & 3) === 0) {\n                delete cache[key];\n                --cacheSize;\n              }\n            }\n          }\n          color = fromStringInternal_(s);\n          cache[s] = color;\n          ++cacheSize;\n        }\n        return color;\n      }\n    );\n\n  })();\n\n/**\n * Return the color as an array. This function maintains a cache of calculated\n * arrays which means the result should not be modified.\n * @param {Color|string} color Color.\n * @return {Color} Color.\n * @api\n */\nexport function asArray(color) {\n  if (Array.isArray(color)) {\n    return color;\n  } else {\n    return fromString(color);\n  }\n}\n\n/**\n * @param {string} s String.\n * @private\n * @return {Color} Color.\n */\nfunction fromStringInternal_(s) {\n  let r, g, b, a, color;\n\n  if (NAMED_COLOR_RE_.exec(s)) {\n    s = fromNamed(s);\n  }\n\n  if (HEX_COLOR_RE_.exec(s)) { // hex\n    const n = s.length - 1; // number of hex digits\n    let d; // number of digits per channel\n    if (n <= 4) {\n      d = 1;\n    } else {\n      d = 2;\n    }\n    const hasAlpha = n === 4 || n === 8;\n    r = parseInt(s.substr(1 + 0 * d, d), 16);\n    g = parseInt(s.substr(1 + 1 * d, d), 16);\n    b = parseInt(s.substr(1 + 2 * d, d), 16);\n    if (hasAlpha) {\n      a = parseInt(s.substr(1 + 3 * d, d), 16);\n    } else {\n      a = 255;\n    }\n    if (d == 1) {\n      r = (r << 4) + r;\n      g = (g << 4) + g;\n      b = (b << 4) + b;\n      if (hasAlpha) {\n        a = (a << 4) + a;\n      }\n    }\n    color = [r, g, b, a / 255];\n  } else if (s.indexOf('rgba(') == 0) { // rgba()\n    color = s.slice(5, -1).split(',').map(Number);\n    normalize(color);\n  } else if (s.indexOf('rgb(') == 0) { // rgb()\n    color = s.slice(4, -1).split(',').map(Number);\n    color.push(1);\n    normalize(color);\n  } else {\n    assert(false, 14); // Invalid color\n  }\n  return color;\n}\n\n\n/**\n * TODO this function is only used in the test, we probably shouldn't export it\n * @param {Color} color Color.\n * @return {Color} Clamped color.\n */\nexport function normalize(color) {\n  color[0] = clamp((color[0] + 0.5) | 0, 0, 255);\n  color[1] = clamp((color[1] + 0.5) | 0, 0, 255);\n  color[2] = clamp((color[2] + 0.5) | 0, 0, 255);\n  color[3] = clamp(color[3], 0, 1);\n  return color;\n}\n\n\n/**\n * @param {Color} color Color.\n * @return {string} String.\n */\nexport function toString(color) {\n  let r = color[0];\n  if (r != (r | 0)) {\n    r = (r + 0.5) | 0;\n  }\n  let g = color[1];\n  if (g != (g | 0)) {\n    g = (g + 0.5) | 0;\n  }\n  let b = color[2];\n  if (b != (b | 0)) {\n    b = (b + 0.5) | 0;\n  }\n  const a = color[3] === undefined ? 1 : color[3];\n  return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n}\n","/**\n * @module ol/Image\n */\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\nimport {listenOnce, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {getHeight} from './extent.js';\nimport {IMAGE_DECODE} from './has.js';\n\n\n/**\n * A function that takes an {@link module:ol/Image~Image} for the image and a\n * `{string}` for the src as arguments. It is supposed to make it so the\n * underlying image {@link module:ol/Image~Image#getImage} is assigned the\n * content specified by the src. If not specified, the default is\n *\n *     function(image, src) {\n *       image.getImage().src = src;\n *     }\n *\n * Providing a custom `imageLoadFunction` can be useful to load images with\n * post requests or - in general - through XHR requests, where the src of the\n * image element would be set to a data URI when the content is loaded.\n *\n * @typedef {function(ImageWrapper, string): void} LoadFunction\n * @api\n */\n\n\nclass ImageWrapper extends ImageBase {\n\n  /**\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {LoadFunction} imageLoadFunction Image load function.\n   */\n  constructor(extent, resolution, pixelRatio, src, crossOrigin, imageLoadFunction) {\n\n    super(extent, resolution, pixelRatio, ImageState.IDLE);\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @protected\n     * @type {ImageState}\n     */\n    this.state = ImageState.IDLE;\n\n    /**\n     * @private\n     * @type {LoadFunction}\n     */\n    this.imageLoadFunction_ = imageLoadFunction;\n\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getImage() {\n    return this.image_;\n  }\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  handleImageError_() {\n    this.state = ImageState.ERROR;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  handleImageLoad_() {\n    if (this.resolution === undefined) {\n      this.resolution = getHeight(this.extent) / this.image_.height;\n    }\n    this.state = ImageState.LOADED;\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @override\n   * @api\n   */\n  load() {\n    if (this.state == ImageState.IDLE || this.state == ImageState.ERROR) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.imageLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image.\n   */\n  setImage(image) {\n    this.image_ = image;\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n/**\n * @param {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} image Image element.\n * @param {function():any} loadHandler Load callback function.\n * @param {function():any} errorHandler Error callback function.\n * @return {function():void} Callback to stop listening.\n */\nexport function listenImage(image, loadHandler, errorHandler) {\n  const img = /** @type {HTMLImageElement} */ (image);\n\n  if (img.src && IMAGE_DECODE) {\n    const promise = img.decode();\n    let listening = true;\n    const unlisten = function() {\n      listening = false;\n    };\n    promise.then(function() {\n      if (listening) {\n        loadHandler();\n      }\n    }).catch(function(error) {\n      if (listening) {\n        // FIXME: Unconditionally call errorHandler() when this bug is fixed upstream:\n        //        https://bugs.webkit.org/show_bug.cgi?id=198527\n        if (error.name === 'EncodingError' && error.message === 'Invalid image type.') {\n          loadHandler();\n        } else {\n          errorHandler();\n        }\n      }\n    });\n    return unlisten;\n  }\n\n  const listenerKeys = [\n    listenOnce(img, EventType.LOAD, loadHandler),\n    listenOnce(img, EventType.ERROR, errorHandler)\n  ];\n  return function unlisten() {\n    listenerKeys.forEach(unlistenByKey);\n  };\n}\n\n\nexport default ImageWrapper;\n","/**\n * @module ol/Tile\n */\nimport TileState from './TileState.js';\nimport {easeIn} from './easing.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\nimport {abstract} from './util.js';\n\n\n/**\n * A function that takes an {@link module:ol/Tile} for the tile and a\n * `{string}` for the url as arguments. The default is\n * ```js\n * source.setTileLoadFunction(function(tile, src) {\n *   tile.getImage().src = src;\n * });\n * ```\n * For more fine grained control, the load function can use fetch or XMLHttpRequest and involve\n * error handling:\n *\n * ```js\n * import TileState from 'ol/TileState';\n *\n * source.setTileLoadFunction(function(tile, src) {\n *   var xhr = new XMLHttpRequest();\n *   xhr.responseType = 'blob';\n *   xhr.addEventListener('loadend', function (evt) {\n *     var data = this.response;\n *     if (data !== undefined) {\n *       tile.getImage().src = URL.createObjectURL(data);\n *     } else {\n *       tile.setState(TileState.ERROR);\n *     }\n *   });\n *   xhr.addEventListener('error', function () {\n *     tile.setState(TileState.ERROR);\n *   });\n *   xhr.open('GET', src);\n *   xhr.send();\n * });\n * ```\n *\n * @typedef {function(Tile, string): void} LoadFunction\n * @api\n */\n\n/**\n * {@link module:ol/source/Tile~Tile} sources use a function of this type to get\n * the url that provides a tile for a given tile coordinate.\n *\n * This function takes an {@link module:ol/tilecoord~TileCoord} for the tile\n * coordinate, a `{number}` representing the pixel ratio and a\n * {@link module:ol/proj/Projection} for the projection  as arguments\n * and returns a `{string}` representing the tile URL, or undefined if no tile\n * should be requested for the passed tile coordinate.\n *\n * @typedef {function(import(\"./tilecoord.js\").TileCoord, number,\n *           import(\"./proj/Projection.js\").default): (string|undefined)} UrlFunction\n * @api\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [transition=250] A duration for tile opacity\n * transitions in milliseconds. A duration of 0 disables the opacity transition.\n * @api\n */\n\n\n/**\n * @classdesc\n * Base class for tiles.\n *\n * @abstract\n */\nclass Tile extends EventTarget {\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {TileState} state State.\n   * @param {Options=} opt_options Tile options.\n   */\n  constructor(tileCoord, state, opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @type {import(\"./tilecoord.js\").TileCoord}\n     */\n    this.tileCoord = tileCoord;\n\n    /**\n     * @protected\n     * @type {TileState}\n     */\n    this.state = state;\n\n    /**\n     * An \"interim\" tile for this tile. The interim tile may be used while this\n     * one is loading, for \"smooth\" transitions when changing params/dimensions\n     * on the source.\n     * @type {Tile}\n     */\n    this.interimTile = null;\n\n    /**\n     * The tile is available at the highest possible resolution. Subclasses can\n     * set this to `false` initially. Tile load listeners will not be\n     * unregistered before this is set to `true` and a `#changed()` is called.\n     * @type {boolean}\n     */\n    this.hifi = true;\n\n    /**\n     * A key assigned to the tile. This is used by the tile source to determine\n     * if this tile can effectively be used, or if a new tile should be created\n     * and this one be used as an interim tile for this new tile.\n     * @type {string}\n     */\n    this.key = '';\n\n    /**\n     * The duration for the opacity transition.\n     * @type {number}\n     */\n    this.transition_ = options.transition === undefined ? 250 : options.transition;\n\n    /**\n     * Lookup of start times for rendering transitions.  If the start time is\n     * equal to -1, the transition is complete.\n     * @type {Object<string, number>}\n     */\n    this.transitionStarts_ = {};\n\n  }\n\n  /**\n   * @protected\n   */\n  changed() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * @return {string} Key.\n   */\n  getKey() {\n    return this.key + '/' + this.tileCoord;\n  }\n\n  /**\n   * Get the interim tile most suitable for rendering using the chain of interim\n   * tiles. This corresponds to the  most recent tile that has been loaded, if no\n   * such tile exists, the original tile is returned.\n   * @return {!Tile} Best tile for rendering.\n   */\n  getInterimTile() {\n    if (!this.interimTile) {\n      //empty chain\n      return this;\n    }\n    let tile = this.interimTile;\n\n    // find the first loaded tile and return it. Since the chain is sorted in\n    // decreasing order of creation time, there is no need to search the remainder\n    // of the list (all those tiles correspond to older requests and will be\n    // cleaned up by refreshInterimChain)\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        // Show tile immediately instead of fading it in after loading, because\n        // the interim tile is in place already\n        this.transition_ = 0;\n        return tile;\n      }\n      tile = tile.interimTile;\n    } while (tile);\n\n    // we can not find a better tile\n    return this;\n  }\n\n  /**\n   * Goes through the chain of interim tiles and discards sections of the chain\n   * that are no longer relevant.\n   */\n  refreshInterimChain() {\n    if (!this.interimTile) {\n      return;\n    }\n\n    let tile = this.interimTile;\n    let prev = /** @type {Tile} */ (this);\n\n    do {\n      if (tile.getState() == TileState.LOADED) {\n        //we have a loaded tile, we can discard the rest of the list\n        //we would could abort any LOADING tile request\n        //older than this tile (i.e. any LOADING tile following this entry in the chain)\n        tile.interimTile = null;\n        break;\n      } else if (tile.getState() == TileState.LOADING) {\n        //keep this LOADING tile any loaded tiles later in the chain are\n        //older than this tile, so we're still interested in the request\n        prev = tile;\n      } else if (tile.getState() == TileState.IDLE) {\n        //the head of the list is the most current tile, we don't need\n        //to start any other requests for this chain\n        prev.interimTile = tile.interimTile;\n      } else {\n        prev = tile;\n      }\n      tile = prev.interimTile;\n    } while (tile);\n  }\n\n  /**\n   * Get the tile coordinate for this tile.\n   * @return {import(\"./tilecoord.js\").TileCoord} The tile coordinate.\n   * @api\n   */\n  getTileCoord() {\n    return this.tileCoord;\n  }\n\n  /**\n   * @return {TileState} State.\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Sets the state of this tile. If you write your own {@link module:ol/Tile~LoadFunction tileLoadFunction} ,\n   * it is important to set the state correctly to {@link module:ol/TileState~ERROR}\n   * when the tile cannot be loaded. Otherwise the tile cannot be removed from\n   * the tile queue and will block other requests.\n   * @param {TileState} state State.\n   * @api\n   */\n  setState(state) {\n    if (this.state !== TileState.ERROR && this.state > state) {\n      throw new Error('Tile load sequence violation');\n    }\n    this.state = state;\n    this.changed();\n  }\n\n  /**\n   * Load the image or retry if loading previously failed.\n   * Loading is taken care of by the tile queue, and calling this method is\n   * only needed for preloading or for reloading in case of an error.\n   * @abstract\n   * @api\n   */\n  load() {\n    abstract();\n  }\n\n  /**\n   * Get the alpha value for rendering.\n   * @param {string} id An id for the renderer.\n   * @param {number} time The render frame time.\n   * @return {number} A number between 0 and 1.\n   */\n  getAlpha(id, time) {\n    if (!this.transition_) {\n      return 1;\n    }\n\n    let start = this.transitionStarts_[id];\n    if (!start) {\n      start = time;\n      this.transitionStarts_[id] = start;\n    } else if (start === -1) {\n      return 1;\n    }\n\n    const delta = time - start + (1000 / 60); // avoid rendering at 0\n    if (delta >= this.transition_) {\n      return 1;\n    }\n    return easeIn(delta / this.transition_);\n  }\n\n  /**\n   * Determine if a tile is in an alpha transition.  A tile is considered in\n   * transition if tile.getAlpha() has not yet been called or has been called\n   * and returned 1.\n   * @param {string} id An id for the renderer.\n   * @return {boolean} The tile is in transition.\n   */\n  inTransition(id) {\n    if (!this.transition_) {\n      return false;\n    }\n    return this.transitionStarts_[id] !== -1;\n  }\n\n  /**\n   * Mark a transition as complete.\n   * @param {string} id An id for the renderer.\n   */\n  endTransition(id) {\n    if (this.transition_) {\n      this.transitionStarts_[id] = -1;\n    }\n  }\n}\n\n\nexport default Tile;\n","/**\n * @module ol/loadingstrategy\n */\n\n\n/**\n * Strategy function for loading all features with a single request.\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array<import(\"./extent.js\").Extent>} Extents.\n * @api\n */\nexport function all(extent, resolution) {\n  return [[-Infinity, -Infinity, Infinity, Infinity]];\n}\n\n\n/**\n * Strategy function for loading features based on the view's extent and\n * resolution.\n * @param {import(\"./extent.js\").Extent} extent Extent.\n * @param {number} resolution Resolution.\n * @return {Array<import(\"./extent.js\").Extent>} Extents.\n * @api\n */\nexport function bbox(extent, resolution) {\n  return [extent];\n}\n\n\n/**\n * Creates a strategy function for loading features based on a tile grid.\n * @param {import(\"./tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n * @return {function(import(\"./extent.js\").Extent, number): Array<import(\"./extent.js\").Extent>} Loading strategy.\n * @api\n */\nexport function tile(tileGrid) {\n  return (\n    /**\n     * @param {import(\"./extent.js\").Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @return {Array<import(\"./extent.js\").Extent>} Extents.\n     */\n    function(extent, resolution) {\n      const z = tileGrid.getZForResolution(resolution);\n      const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n      /** @type {Array<import(\"./extent.js\").Extent>} */\n      const extents = [];\n      /** @type {import(\"./tilecoord.js\").TileCoord} */\n      const tileCoord = [z, 0, 0];\n      for (tileCoord[1] = tileRange.minX; tileCoord[1] <= tileRange.maxX; ++tileCoord[1]) {\n        for (tileCoord[2] = tileRange.minY; tileCoord[2] <= tileRange.maxY; ++tileCoord[2]) {\n          extents.push(tileGrid.getTileCoordExtent(tileCoord));\n        }\n      }\n      return extents;\n    }\n  );\n}\n","/**\n * @module ol/format/XMLFeature\n */\nimport {abstract} from '../util.js';\nimport {extend} from '../array.js';\nimport FeatureFormat from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\nimport {isDocument, parse} from '../xml.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for XML feature formats.\n *\n * @abstract\n */\nclass XMLFeature extends FeatureFormat {\n  constructor() {\n    super();\n\n    /**\n     * @type {XMLSerializer}\n     * @private\n     */\n    this.xmlSerializer_ = new XMLSerializer();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getType() {\n    return FormatType.XML;\n  }\n\n  /**\n   * Read a single feature.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   * @api\n   */\n  readFeature(source, opt_options) {\n    if (!source) {\n      return null;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readFeatureFromDocument(doc, opt_options);\n    } else if (isDocument(source)) {\n      return this.readFeatureFromDocument(/** @type {Document} */ (source), opt_options);\n    } else {\n      return this.readFeatureFromNode(/** @type {Node} */ (source), opt_options);\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n  readFeatureFromDocument(doc, opt_options) {\n    const features = this.readFeaturesFromDocument(doc, opt_options);\n    if (features.length > 0) {\n      return features[0];\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n  readFeatureFromNode(node, opt_options) {\n    return null; // not implemented\n  }\n\n  /**\n   * Read all features from a feature collection.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   * @api\n   */\n  readFeatures(source, opt_options) {\n    if (!source) {\n      return [];\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readFeaturesFromDocument(doc, opt_options);\n    } else if (isDocument(source)) {\n      return this.readFeaturesFromDocument(\n        /** @type {Document} */ (source), opt_options);\n    } else {\n      return this.readFeaturesFromNode(/** @type {Node} */ (source), opt_options);\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @protected\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n  readFeaturesFromDocument(doc, opt_options) {\n    /** @type {Array<import(\"../Feature.js\").default>} */\n    const features = [];\n    for (let n = /** @type {Node} */ (doc.firstChild); n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        extend(features, this.readFeaturesFromNode(n, opt_options));\n      }\n    }\n    return features;\n  }\n\n  /**\n   * @abstract\n   * @param {Node} node Node.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @protected\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n  readFeaturesFromNode(node, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readGeometry(source, opt_options) {\n    if (!source) {\n      return null;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readGeometryFromDocument(doc, opt_options);\n    } else if (isDocument(source)) {\n      return this.readGeometryFromDocument(\n        /** @type {Document} */ (source), opt_options);\n    } else {\n      return this.readGeometryFromNode(/** @type {Node} */ (source), opt_options);\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @protected\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometryFromDocument(doc, opt_options) {\n    return null; // not implemented\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Options.\n   * @protected\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometryFromNode(node, opt_options) {\n    return null; // not implemented\n  }\n\n  /**\n   * Read the projection from the source.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   * @api\n   */\n  readProjection(source) {\n    if (!source) {\n      return null;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readProjectionFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readProjectionFromDocument(/** @type {Document} */ (source));\n    } else {\n      return this.readProjectionFromNode(/** @type {Node} */ (source));\n    }\n  }\n\n  /**\n   * @param {Document} doc Document.\n   * @protected\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjectionFromDocument(doc) {\n    return this.dataProjection;\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @protected\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjectionFromNode(node) {\n    return this.dataProjection;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  writeFeature(feature, opt_options) {\n    const node = this.writeFeatureNode(feature, opt_options);\n    return this.xmlSerializer_.serializeToString(node);\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\n   * @protected\n   * @return {Node} Node.\n   */\n  writeFeatureNode(feature, opt_options) {\n    return null; // not implemented\n  }\n\n  /**\n   * Encode an array of features as string.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Result.\n   * @api\n   */\n  writeFeatures(features, opt_options) {\n    const node = this.writeFeaturesNode(features, opt_options);\n    return this.xmlSerializer_.serializeToString(node);\n  }\n\n  /**\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\n   * @return {Node} Node.\n   */\n  writeFeaturesNode(features, opt_options) {\n    return null; // not implemented\n  }\n\n  /**\n   * @inheritDoc\n   */\n  writeGeometry(geometry, opt_options) {\n    const node = this.writeGeometryNode(geometry, opt_options);\n    return this.xmlSerializer_.serializeToString(node);\n  }\n\n  /**\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\n   * @return {Node} Node.\n   */\n  writeGeometryNode(geometry, opt_options) {\n    return null; // not implemented\n  }\n}\n\n\nexport default XMLFeature;\n","/**\n * @module ol/proj/proj4\n */\nimport {addCoordinateTransforms, addProjection, addEquivalentProjections, get} from '../proj.js';\nimport {get as getTransform} from './transforms.js';\nimport Projection from './Projection.js';\n\n/**\n * Make projections defined in proj4 (with `proj4.defs()`) available in\n * OpenLayers.\n *\n * This function should be called whenever changes are made to the proj4\n * registry, e.g. after calling `proj4.defs()`. Existing transforms will not be\n * modified by this function.\n *\n * @param {?} proj4 Proj4.\n * @api\n */\nexport function register(proj4) {\n  const projCodes = Object.keys(proj4.defs);\n  const len = projCodes.length;\n  let i, j;\n  for (i = 0; i < len; ++i) {\n    const code = projCodes[i];\n    if (!get(code)) {\n      const def = proj4.defs(code);\n      addProjection(new Projection({\n        code: code,\n        axisOrientation: def.axis,\n        metersPerUnit: def.to_meter,\n        units: def.units\n      }));\n    }\n  }\n  for (i = 0; i < len; ++i) {\n    const code1 = projCodes[i];\n    const proj1 = get(code1);\n    for (j = 0; j < len; ++j) {\n      const code2 = projCodes[j];\n      const proj2 = get(code2);\n      if (!getTransform(code1, code2)) {\n        if (proj4.defs[code1] === proj4.defs[code2]) {\n          addEquivalentProjections([proj1, proj2]);\n        } else {\n          const transform = proj4(code1, code2);\n          addCoordinateTransforms(proj1, proj2, transform.forward, transform.inverse);\n        }\n      }\n    }\n  }\n}\n","/**\n * @module ol/ObjectEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  /**\n   * Triggered when a property is changed.\n   * @event module:ol/Object.ObjectEvent#propertychange\n   * @api\n   */\n  PROPERTYCHANGE: 'propertychange'\n};\n","/**\n * @module ol/tilegrid/common\n */\n\n/**\n * Default maximum zoom for default tile grids.\n * @type {number}\n */\nexport const DEFAULT_MAX_ZOOM = 42;\n\n/**\n * Default tile size.\n * @type {number}\n */\nexport const DEFAULT_TILE_SIZE = 256;\n","/**\n * @module ol/geom/flat/contains\n */\nimport {forEachCorner} from '../../extent.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} Contains extent.\n */\nexport function linearRingContainsExtent(flatCoordinates, offset, end, stride, extent) {\n  const outside = forEachCorner(extent,\n    /**\n     * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n     * @return {boolean} Contains (x, y).\n     */\n    function(coordinate) {\n      return !linearRingContainsXY(flatCoordinates, offset, end, stride, coordinate[0], coordinate[1]);\n    });\n  return !outside;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingContainsXY(flatCoordinates, offset, end, stride, x, y) {\n  // http://geomalgorithms.com/a03-_inclusion.html\n  // Copyright 2000 softSurfer, 2012 Dan Sunday\n  // This code may be freely used and modified for any purpose\n  // providing that this copyright notice is included with it.\n  // SoftSurfer makes no warranty for this code, and cannot be held\n  // liable for any real or imagined damage resulting from its use.\n  // Users of this code must verify correctness for their application.\n  let wn = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    if (y1 <= y) {\n      if (y2 > y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) > 0) {\n        wn++;\n      }\n    } else if (y2 <= y && ((x2 - x1) * (y - y1)) - ((x - x1) * (y2 - y1)) < 0) {\n      wn--;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  return wn !== 0;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y) {\n  if (ends.length === 0) {\n    return false;\n  }\n  if (!linearRingContainsXY(flatCoordinates, offset, ends[0], stride, x, y)) {\n    return false;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsXY(flatCoordinates, ends[i - 1], ends[i], stride, x, y)) {\n      return false;\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {number} x X.\n * @param {number} y Y.\n * @return {boolean} Contains (x, y).\n */\nexport function linearRingssContainsXY(flatCoordinates, offset, endss, stride, x, y) {\n  if (endss.length === 0) {\n    return false;\n  }\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/geom/flat/reverse\n */\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n */\nexport function coordinates(flatCoordinates, offset, end, stride) {\n  while (offset < end - stride) {\n    for (let i = 0; i < stride; ++i) {\n      const tmp = flatCoordinates[offset + i];\n      flatCoordinates[offset + i] = flatCoordinates[end - stride + i];\n      flatCoordinates[end - stride + i] = tmp;\n    }\n    offset += stride;\n    end -= stride;\n  }\n}\n","/**\n * @module ol/geom/flat/orient\n */\nimport {coordinates as reverseCoordinates} from './reverse.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {boolean} Is clockwise.\n */\nexport function linearRingIsClockwise(flatCoordinates, offset, end, stride) {\n  // http://tinyurl.com/clockwise-method\n  // https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrlinearring.cpp\n  let edge = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    edge += (x2 - x1) * (y2 + y1);\n    x1 = x2;\n    y1 = y2;\n  }\n  return edge > 0;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingsAreOriented(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    if (i === 0) {\n      if ((right && isClockwise) || (!right && !isClockwise)) {\n        return false;\n      }\n    } else {\n      if ((right && !isClockwise) || (!right && isClockwise)) {\n        return false;\n      }\n    }\n    offset = end;\n  }\n  return true;\n}\n\n\n/**\n * Determines if linear rings are oriented.  By default, left-hand orientation\n * is tested (first ring must be clockwise, remaining rings counter-clockwise).\n * To test for right-hand orientation, use the `opt_right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Test for right-hand orientation\n *     (counter-clockwise exterior ring and clockwise interior rings).\n * @return {boolean} Rings are correctly oriented.\n */\nexport function linearRingssAreOriented(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (!linearRingsAreOriented(\n      flatCoordinates, offset, ends, stride, opt_right)) {\n      return false;\n    }\n    if (ends.length) {\n      offset = ends[ends.length - 1];\n    }\n  }\n  return true;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRings(flatCoordinates, offset, ends, stride, opt_right) {\n  const right = opt_right !== undefined ? opt_right : false;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    const isClockwise = linearRingIsClockwise(\n      flatCoordinates, offset, end, stride);\n    const reverse = i === 0 ?\n      (right && isClockwise) || (!right && !isClockwise) :\n      (right && !isClockwise) || (!right && isClockwise);\n    if (reverse) {\n      reverseCoordinates(flatCoordinates, offset, end, stride);\n    }\n    offset = end;\n  }\n  return offset;\n}\n\n\n/**\n * Orient coordinates in a flat array of linear rings.  By default, rings\n * are oriented following the left-hand rule (clockwise for exterior and\n * counter-clockwise for interior rings).  To orient according to the\n * right-hand rule, use the `opt_right` argument.\n *\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Array of array of end indexes.\n * @param {number} stride Stride.\n * @param {boolean=} opt_right Follow the right-hand rule for orientation.\n * @return {number} End.\n */\nexport function orientLinearRingsArray(flatCoordinates, offset, endss, stride, opt_right) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    offset = orientLinearRings(\n      flatCoordinates, offset, endss[i], stride, opt_right);\n  }\n  return offset;\n}\n","/**\n * @module ol/renderer/vector\n */\nimport {getUid} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport BuilderType from '../render/canvas/BuilderType.js';\n\n\n/**\n * Tolerance for geometry simplification in device pixels.\n * @type {number}\n */\nconst SIMPLIFY_TOLERANCE = 0.5;\n\n\n/**\n * @const\n * @type {Object<import(\"../geom/GeometryType.js\").default,\n *                function(import(\"../render/canvas/BuilderGroup.js\").default, import(\"../geom/Geometry.js\").default,\n *                         import(\"../style/Style.js\").default, Object): void>}\n */\nconst GEOMETRY_RENDERERS = {\n  'Point': renderPointGeometry,\n  'LineString': renderLineStringGeometry,\n  'Polygon': renderPolygonGeometry,\n  'MultiPoint': renderMultiPointGeometry,\n  'MultiLineString': renderMultiLineStringGeometry,\n  'MultiPolygon': renderMultiPolygonGeometry,\n  'GeometryCollection': renderGeometryCollectionGeometry,\n  'Circle': renderCircleGeometry\n};\n\n\n/**\n * @param {import(\"../Feature.js\").FeatureLike} feature1 Feature 1.\n * @param {import(\"../Feature.js\").FeatureLike} feature2 Feature 2.\n * @return {number} Order.\n */\nexport function defaultOrder(feature1, feature2) {\n  return parseInt(getUid(feature1), 10) - parseInt(getUid(feature2), 10);\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Squared pixel tolerance.\n */\nexport function getSquaredTolerance(resolution, pixelRatio) {\n  const tolerance = getTolerance(resolution, pixelRatio);\n  return tolerance * tolerance;\n}\n\n\n/**\n * @param {number} resolution Resolution.\n * @param {number} pixelRatio Pixel ratio.\n * @return {number} Pixel tolerance.\n */\nexport function getTolerance(resolution, pixelRatio) {\n  return SIMPLIFY_TOLERANCE * resolution / pixelRatio;\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Builder group.\n * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderCircleGeometry(builderGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const circleReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.CIRCLE);\n    circleReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    circleReplay.drawCircle(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {function(import(\"../events/Event.js\").default): void} listener Listener function.\n * @param {import(\"../proj.js\").TransformFunction} [opt_transform] Transform from user to view projection.\n * @return {boolean} `true` if style is loading.\n * @template T\n */\nexport function renderFeature(replayGroup, feature, style, squaredTolerance, listener, opt_transform) {\n  let loading = false;\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    let imageState = imageStyle.getImageState();\n    if (imageState == ImageState.LOADED || imageState == ImageState.ERROR) {\n      imageStyle.unlistenImageChange(listener);\n    } else {\n      if (imageState == ImageState.IDLE) {\n        imageStyle.load();\n      }\n      imageState = imageStyle.getImageState();\n      imageStyle.listenImageChange(listener);\n      loading = true;\n    }\n  }\n  renderFeatureInternal(replayGroup, feature, style, squaredTolerance, opt_transform);\n\n  return loading;\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {number} squaredTolerance Squared tolerance.\n * @param {import(\"../proj.js\").TransformFunction} [opt_transform] Optional transform function.\n */\nfunction renderFeatureInternal(replayGroup, feature, style, squaredTolerance, opt_transform) {\n  const geometry = style.getGeometryFunction()(feature);\n  if (!geometry) {\n    return;\n  }\n  const simplifiedGeometry = geometry.simplifyTransformed(squaredTolerance, opt_transform);\n  const renderer = style.getRenderer();\n  if (renderer) {\n    renderGeometry(replayGroup, simplifiedGeometry, style, feature);\n  } else {\n    const geometryRenderer = GEOMETRY_RENDERERS[simplifiedGeometry.getType()];\n    geometryRenderer(replayGroup, simplifiedGeometry, style, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/Geometry.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderGeometry(replayGroup, geometry, style, feature) {\n  if (geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n    const geometries = /** @type {import(\"../geom/GeometryCollection.js\").default} */ (geometry).getGeometries();\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      renderGeometry(replayGroup, geometries[i], style, feature);\n    }\n    return;\n  }\n  const replay = replayGroup.getBuilder(style.getZIndex(), BuilderType.DEFAULT);\n  replay.drawCustom(/** @type {import(\"../geom/SimpleGeometry.js\").default} */ (geometry), feature, style.getRenderer());\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} replayGroup Replay group.\n * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderGeometryCollectionGeometry(replayGroup, geometry, style, feature) {\n  const geometries = geometry.getGeometriesArray();\n  let i, ii;\n  for (i = 0, ii = geometries.length; i < ii; ++i) {\n    const geometryRenderer =\n        GEOMETRY_RENDERERS[geometries[i].getType()];\n    geometryRenderer(replayGroup, geometries[i], style, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/LineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderLineStringGeometry(builderGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/MultiLineString.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiLineStringGeometry(builderGroup, geometry, style, feature) {\n  const strokeStyle = style.getStroke();\n  if (strokeStyle) {\n    const lineStringReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.LINE_STRING);\n    lineStringReplay.setFillStrokeStyle(null, strokeStyle);\n    lineStringReplay.drawMultiLineString(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").default} feature Feature.\n */\nfunction renderMultiPolygonGeometry(builderGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (strokeStyle || fillStyle) {\n    const polygonReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawMultiPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/Point.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPointGeometry(builderGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, builderGroup.addDeclutter(false));\n    imageReplay.drawPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/MultiPoint.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderMultiPointGeometry(builderGroup, geometry, style, feature) {\n  const imageStyle = style.getImage();\n  if (imageStyle) {\n    if (imageStyle.getImageState() != ImageState.LOADED) {\n      return;\n    }\n    const imageReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.IMAGE);\n    imageReplay.setImageStyle(imageStyle, builderGroup.addDeclutter(false));\n    imageReplay.drawMultiPoint(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(!!imageStyle));\n    textReplay.drawText(geometry, feature);\n  }\n}\n\n\n/**\n * @param {import(\"../render/canvas/BuilderGroup.js\").default} builderGroup Replay group.\n * @param {import(\"../geom/Polygon.js\").default|import(\"../render/Feature.js\").default} geometry Geometry.\n * @param {import(\"../style/Style.js\").default} style Style.\n * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n */\nfunction renderPolygonGeometry(builderGroup, geometry, style, feature) {\n  const fillStyle = style.getFill();\n  const strokeStyle = style.getStroke();\n  if (fillStyle || strokeStyle) {\n    const polygonReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.POLYGON);\n    polygonReplay.setFillStrokeStyle(fillStyle, strokeStyle);\n    polygonReplay.drawPolygon(geometry, feature);\n  }\n  const textStyle = style.getText();\n  if (textStyle) {\n    const textReplay = builderGroup.getBuilder(style.getZIndex(), BuilderType.TEXT);\n    textReplay.setTextStyle(textStyle, builderGroup.addDeclutter(false));\n    textReplay.drawText(geometry, feature);\n  }\n}\n","/**\n * @module ol/pointer/EventType\n */\n\n/**\n * Constants for event names.\n * @enum {string}\n */\nexport default {\n  POINTERMOVE: 'pointermove',\n  POINTERDOWN: 'pointerdown',\n  POINTERUP: 'pointerup',\n  POINTEROVER: 'pointerover',\n  POINTEROUT: 'pointerout',\n  POINTERENTER: 'pointerenter',\n  POINTERLEAVE: 'pointerleave',\n  POINTERCANCEL: 'pointercancel'\n};\n","/**\n * @module ol/interaction/Select\n */\nimport {getUid} from '../util.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {extend, includes} from '../array.js';\nimport Event from '../events/Event.js';\nimport {singleClick, never, shiftKeyOnly, pointerMove} from '../events/condition.js';\nimport {TRUE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Interaction from './Interaction.js';\nimport {clear} from '../obj.js';\nimport {createEditingStyle} from '../style/Style.js';\nimport Collection from '../Collection.js';\n\n\n/**\n * @enum {string}\n */\nconst SelectEventType = {\n  /**\n   * Triggered when feature(s) has been (de)selected.\n   * @event SelectEvent#select\n   * @api\n   */\n  SELECT: 'select'\n};\n\n\n/**\n * A function that takes an {@link module:ol/Feature} or\n * {@link module:ol/render/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @typedef {function(import(\"../Feature.js\").FeatureLike, import(\"../layer/Layer.js\").default):boolean} FilterFunction\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [addCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is the event\n * for the selected features as a whole. By default, this is\n * {@link module:ol/events/condition~singleClick}. Clicking on a feature selects that\n * feature and removes any that were in the selection. Clicking outside any\n * feature removes all from the selection.\n * See `toggle`, `add`, `remove` options for adding/removing extra features to/\n * from the selection.\n * @property {Array<import(\"../layer/Layer.js\").default>|function(import(\"../layer/Layer.js\").default): boolean} [layers]\n * A list of layers from which features should be selected. Alternatively, a\n * filter function can be provided. The function will be called for each layer\n * in the map and should return `true` for layers that you want to be\n * selectable. If the option is absent, all visible layers will be considered\n * selectable.\n * @property {import(\"../style/Style.js\").StyleLike} [style]\n * Style for the selected features. By default the default edit style is used\n * (see {@link module:ol/style}).\n * @property {import(\"../events/condition.js\").Condition} [removeCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * By default, this is {@link module:ol/events/condition~never}. Use this if you\n * want to use different events for add and remove instead of `toggle`.\n * @property {import(\"../events/condition.js\").Condition} [toggleCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. This is in addition\n * to the `condition` event. By default,\n * {@link module:ol/events/condition~shiftKeyOnly}, i.e. pressing `shift` as\n * well as the `condition` event, adds that feature to the current selection if\n * it is not currently selected, and removes it if it is. See `add` and `remove`\n * if you want to use different events instead of a toggle.\n * @property {boolean} [multi=false] A boolean that determines if the default\n * behaviour should select only single features or all (overlapping) features at\n * the clicked map position. The default of `false` means single select.\n * @property {import(\"../Collection.js\").default<import(\"../Feature.js\").default>} [features]\n * Collection where the interaction will place selected features. Optional. If\n * not set the interaction will create a collection. In any case the collection\n * used by the interaction is returned by\n * {@link module:ol/interaction/Select~Select#getFeatures}.\n * @property {FilterFunction} [filter] A function\n * that takes an {@link module:ol/Feature} and an\n * {@link module:ol/layer/Layer} and returns `true` if the feature may be\n * selected or `false` otherwise.\n * @property {number} [hitTolerance=0] Hit-detection tolerance. Pixels inside\n * the radius around the given position will be checked for features.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Select~Select} instances are instances of\n * this type.\n */\nclass SelectEvent extends Event {\n  /**\n   * @param {SelectEventType} type The event type.\n   * @param {Array<import(\"../Feature.js\").default>} selected Selected features.\n   * @param {Array<import(\"../Feature.js\").default>} deselected Deselected features.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Associated\n   *     {@link module:ol/MapBrowserEvent}.\n   */\n  constructor(type, selected, deselected, mapBrowserEvent) {\n    super(type);\n\n    /**\n     * Selected features array.\n     * @type {Array<import(\"../Feature.js\").default>}\n     * @api\n     */\n    this.selected = selected;\n\n    /**\n     * Deselected features array.\n     * @type {Array<import(\"../Feature.js\").default>}\n     * @api\n     */\n    this.deselected = deselected;\n\n    /**\n     * Associated {@link module:ol/MapBrowserEvent}.\n     * @type {import(\"../MapBrowserEvent.js\").default}\n     * @api\n     */\n    this.mapBrowserEvent = mapBrowserEvent;\n\n  }\n\n}\n\n\n/**\n * @classdesc\n * Interaction for selecting vector features. By default, selected features are\n * styled differently, so this interaction can be used for visual highlighting,\n * as well as selecting features for other actions, such as modification or\n * output. There are three ways of controlling which features are selected:\n * using the browser event as defined by the `condition` and optionally the\n * `toggle`, `add`/`remove`, and `multi` options; a `layers` filter; and a\n * further feature filter using the `filter` option.\n *\n * Selected features are added to an internal unmanaged layer.\n *\n * @fires SelectEvent\n * @api\n */\nclass Select extends Interaction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    super({\n      handleEvent: handleEvent\n    });\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : singleClick;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.addCondition_ = options.addCondition ? options.addCondition : never;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.removeCondition_ = options.removeCondition ? options.removeCondition : never;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.toggleCondition_ = options.toggleCondition ? options.toggleCondition : shiftKeyOnly;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.multi_ = options.multi ? options.multi : false;\n\n    /**\n     * @private\n     * @type {FilterFunction}\n     */\n    this.filter_ = options.filter ? options.filter : TRUE;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.hitTolerance_ = options.hitTolerance ? options.hitTolerance : 0;\n\n    /**\n     * @private\n     * @type {import(\"../style/Style.js\").default|Array.<import(\"../style/Style.js\").default>|import(\"../style/Style.js\").StyleFunction|null}\n     */\n    this.style_ = options.style ? options.style : getDefaultStyleFunction();\n\n    /**\n     * An association between selected feature (key)\n     * and original style (value)\n     * @private\n     * @type {Object.<number, import(\"../style/Style.js\").default|Array.<import(\"../style/Style.js\").default>|import(\"../style/Style.js\").StyleFunction>}\n     */\n    this.featureStyleAssociation_ = {};\n\n    /**\n     * @private\n     * @type {import(\"../Collection.js\").default}\n     */\n    this.features_ = options.features || new Collection();\n\n    /** @type {function(import(\"../layer/Layer.js\").default): boolean} */\n    let layerFilter;\n    if (options.layers) {\n      if (typeof options.layers === 'function') {\n        layerFilter = options.layers;\n      } else {\n        const layers = options.layers;\n        layerFilter = function(layer) {\n          return includes(layers, layer);\n        };\n      }\n    } else {\n      layerFilter = TRUE;\n    }\n\n    /**\n     * @private\n     * @type {function(import(\"../layer/Layer.js\").default): boolean}\n     */\n    this.layerFilter_ = layerFilter;\n\n    /**\n     * An association between selected feature (key)\n     * and layer (value)\n     * @private\n     * @type {Object<string, import(\"../layer/Layer.js\").default>}\n     */\n    this.featureLayerAssociation_ = {};\n\n    const features = this.getFeatures();\n    features.addEventListener(CollectionEventType.ADD, this.addFeature_.bind(this));\n    features.addEventListener(CollectionEventType.REMOVE, this.removeFeature_.bind(this));\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {import(\"../layer/Layer.js\").default} layer Layer.\n   * @private\n   */\n  addFeatureLayerAssociation_(feature, layer) {\n    this.featureLayerAssociation_[getUid(feature)] = layer;\n  }\n\n  /**\n   * Get the selected features.\n   * @return {import(\"../Collection.js\").default<import(\"../Feature.js\").default>} Features collection.\n   * @api\n   */\n  getFeatures() {\n    return this.features_;\n  }\n\n  /**\n   * Returns the Hit-detection tolerance.\n   * @returns {number} Hit tolerance in pixels.\n   * @api\n   */\n  getHitTolerance() {\n    return this.hitTolerance_;\n  }\n\n  /**\n   * Returns the associated {@link module:ol/layer/Vector~Vector vectorlayer} of\n   * the (last) selected feature. Note that this will not work with any\n   * programmatic method like pushing features to\n   * {@link module:ol/interaction/Select~Select#getFeatures collection}.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature\n   * @return {import('../layer/Vector.js').default} Layer.\n   * @api\n   */\n  getLayer(feature) {\n    return (\n      /** @type {import('../layer/Vector.js').default} */ (this.featureLayerAssociation_[getUid(feature)])\n    );\n  }\n\n  /**\n   * Hit-detection tolerance. Pixels inside the radius around the given position\n   * will be checked for features.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @api\n   */\n  setHitTolerance(hitTolerance) {\n    this.hitTolerance_ = hitTolerance;\n  }\n\n  /**\n   * Remove the interaction from its current map, if any,  and attach it to a new\n   * map, if any. Pass `null` to just remove the interaction from the current map.\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   * @override\n   * @api\n   */\n  setMap(map) {\n    const currentMap = this.getMap();\n    if (currentMap && this.style_) {\n      this.features_.forEach(this.removeSelectedStyle_.bind(this));\n    }\n    super.setMap(map);\n    if (map && this.style_) {\n      this.features_.forEach(this.giveSelectedStyle_.bind(this));\n    }\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent} evt Event.\n   * @private\n   */\n  addFeature_(evt) {\n    const feature = evt.element;\n    if (this.style_) {\n      this.giveSelectedStyle_(feature);\n    }\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent} evt Event.\n   * @private\n   */\n  removeFeature_(evt) {\n    const feature = evt.element;\n    if (this.style_) {\n      this.removeSelectedStyle_(feature);\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @private\n   */\n  giveSelectedStyle_(feature) {\n    const key = getUid(feature);\n    this.featureStyleAssociation_[key] = feature.getStyle();\n    feature.setStyle(this.style_);\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @private\n   */\n  removeSelectedStyle_(feature) {\n    const key = getUid(feature);\n    feature.setStyle(this.featureStyleAssociation_[key]);\n    delete this.featureStyleAssociation_[key];\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @private\n   */\n  removeFeatureLayerAssociation_(feature) {\n    delete this.featureLayerAssociation_[getUid(feature)];\n  }\n}\n\n\n/**\n * Handles the {@link module:ol/MapBrowserEvent map browser event} and may change the\n * selected state of features.\n * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Map browser event.\n * @return {boolean} `false` to stop event propagation.\n * @this {Select}\n */\nfunction handleEvent(mapBrowserEvent) {\n  if (!this.condition_(mapBrowserEvent)) {\n    return true;\n  }\n  const add = this.addCondition_(mapBrowserEvent);\n  const remove = this.removeCondition_(mapBrowserEvent);\n  const toggle = this.toggleCondition_(mapBrowserEvent);\n  const set = !add && !remove && !toggle;\n  const map = mapBrowserEvent.map;\n  const features = this.getFeatures();\n  const deselected = [];\n  const selected = [];\n  if (set) {\n    // Replace the currently selected feature(s) with the feature(s) at the\n    // pixel, or clear the selected feature(s) if there is no feature at\n    // the pixel.\n    clear(this.featureLayerAssociation_);\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n         * @param {import(\"../layer/Layer.js\").default} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            selected.push(feature);\n            this.addFeatureLayerAssociation_(feature, layer);\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let i = features.getLength() - 1; i >= 0; --i) {\n      const feature = features.item(i);\n      const index = selected.indexOf(feature);\n      if (index > -1) {\n        // feature is already selected\n        selected.splice(index, 1);\n      } else {\n        features.remove(feature);\n        deselected.push(feature);\n      }\n    }\n    if (selected.length !== 0) {\n      features.extend(selected);\n    }\n  } else {\n    // Modify the currently selected feature(s).\n    map.forEachFeatureAtPixel(mapBrowserEvent.pixel,\n      (\n        /**\n         * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n         * @param {import(\"../layer/Layer.js\").default} layer Layer.\n         * @return {boolean|undefined} Continue to iterate over the features.\n         */\n        function(feature, layer) {\n          if (this.filter_(feature, layer)) {\n            if ((add || toggle) && !includes(features.getArray(), feature)) {\n              selected.push(feature);\n              this.addFeatureLayerAssociation_(feature, layer);\n            } else if ((remove || toggle) && includes(features.getArray(), feature)) {\n              deselected.push(feature);\n              this.removeFeatureLayerAssociation_(feature);\n            }\n            return !this.multi_;\n          }\n        }).bind(this), {\n        layerFilter: this.layerFilter_,\n        hitTolerance: this.hitTolerance_\n      });\n    for (let j = deselected.length - 1; j >= 0; --j) {\n      features.remove(deselected[j]);\n    }\n    features.extend(selected);\n  }\n  if (selected.length > 0 || deselected.length > 0) {\n    this.dispatchEvent(\n      new SelectEvent(SelectEventType.SELECT,\n        selected, deselected, mapBrowserEvent));\n  }\n  return pointerMove(mapBrowserEvent);\n}\n\n\n/**\n * @return {import(\"../style/Style.js\").StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const styles = createEditingStyle();\n  extend(styles[GeometryType.POLYGON], styles[GeometryType.LINE_STRING]);\n  extend(styles[GeometryType.GEOMETRY_COLLECTION], styles[GeometryType.LINE_STRING]);\n\n  return function(feature) {\n    if (!feature.getGeometry()) {\n      return null;\n    }\n    return styles[feature.getGeometry().getType()];\n  };\n}\n\n\nexport default Select;\n","/**\n * @module ol/render/EventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered before a layer is rendered.\n   * @event module:ol/render/Event~RenderEvent#prerender\n   * @api\n   */\n  PRERENDER: 'prerender',\n\n  /**\n   * Triggered after a layer is rendered.\n   * @event module:ol/render/Event~RenderEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered before layers are rendered.\n   * @event module:ol/render/Event~RenderEvent#precompose\n   * @api\n   */\n  PRECOMPOSE: 'precompose',\n\n  /**\n   * Triggered after all layers are rendered.\n   * @event module:ol/render/Event~RenderEvent#postcompose\n   * @api\n   */\n  POSTCOMPOSE: 'postcompose',\n\n  /**\n   * Triggered when rendering is complete, i.e. all sources and tiles have\n   * finished loading for the current viewport, and all tiles are faded in.\n   * @event module:ol/render/Event~RenderEvent#rendercomplete\n   * @api\n   */\n  RENDERCOMPLETE: 'rendercomplete'\n\n};\n","/**\n * @module ol/proj/transforms\n */\nimport {isEmpty} from '../obj.js';\n\n\n/**\n * @private\n * @type {!Object<string, Object<string, import(\"../proj.js\").TransformFunction>>}\n */\nlet transforms = {};\n\n\n/**\n * Clear the transform cache.\n */\nexport function clear() {\n  transforms = {};\n}\n\n\n/**\n * Registers a conversion function to convert coordinates from the source\n * projection to the destination projection.\n *\n * @param {import(\"./Projection.js\").default} source Source.\n * @param {import(\"./Projection.js\").default} destination Destination.\n * @param {import(\"../proj.js\").TransformFunction} transformFn Transform.\n */\nexport function add(source, destination, transformFn) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  if (!(sourceCode in transforms)) {\n    transforms[sourceCode] = {};\n  }\n  transforms[sourceCode][destinationCode] = transformFn;\n}\n\n\n/**\n * Unregisters the conversion function to convert coordinates from the source\n * projection to the destination projection.  This method is used to clean up\n * cached transforms during testing.\n *\n * @param {import(\"./Projection.js\").default} source Source projection.\n * @param {import(\"./Projection.js\").default} destination Destination projection.\n * @return {import(\"../proj.js\").TransformFunction} transformFn The unregistered transform.\n */\nexport function remove(source, destination) {\n  const sourceCode = source.getCode();\n  const destinationCode = destination.getCode();\n  const transform = transforms[sourceCode][destinationCode];\n  delete transforms[sourceCode][destinationCode];\n  if (isEmpty(transforms[sourceCode])) {\n    delete transforms[sourceCode];\n  }\n  return transform;\n}\n\n\n/**\n * Get a transform given a source code and a destination code.\n * @param {string} sourceCode The code for the source projection.\n * @param {string} destinationCode The code for the destination projection.\n * @return {import(\"../proj.js\").TransformFunction|undefined} The transform function (if found).\n */\nexport function get(sourceCode, destinationCode) {\n  let transform;\n  if (sourceCode in transforms && destinationCode in transforms[sourceCode]) {\n    transform = transforms[sourceCode][destinationCode];\n  }\n  return transform;\n}\n","/**\n * @module ol/style/RegularShape\n */\n\nimport {asArray} from '../color.js';\nimport {asColorLike} from '../colorlike.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport ImageState from '../ImageState.js';\nimport {defaultStrokeStyle, defaultFillStyle, defaultLineCap, defaultLineWidth, defaultLineJoin, defaultMiterLimit} from '../render/canvas.js';\nimport ImageStyle from './Image.js';\n\n\n/**\n * Specify radius for regular polygons, or radius1 and radius2 for stars.\n * @typedef {Object} Options\n * @property {import(\"./Fill.js\").default} [fill] Fill style.\n * @property {number} points Number of points for stars and regular polygons. In case of a polygon, the number of points\n * is the number of sides.\n * @property {number} [radius] Radius of a regular polygon.\n * @property {number} [radius1] Outer radius of a star.\n * @property {number} [radius2] Inner radius of a star.\n * @property {number} [angle=0] Shape's angle in radians. A value of 0 will have one of the shape's point facing up.\n * @property {import(\"./Stroke.js\").default} [stroke] Stroke style.\n * @property {number} [rotation=0] Rotation in radians (positive rotation clockwise).\n * @property {boolean} [rotateWithView=false] Whether to rotate the shape with the view.\n */\n\n\n/**\n * @typedef {Object} RenderOptions\n * @property {import(\"../colorlike.js\").ColorLike} [strokeStyle]\n * @property {number} strokeWidth\n * @property {number} size\n * @property {CanvasLineCap} lineCap\n * @property {Array<number>} lineDash\n * @property {number} lineDashOffset\n * @property {CanvasLineJoin} lineJoin\n * @property {number} miterLimit\n */\n\n\n/**\n * @classdesc\n * Set regular shape style for vector features. The resulting shape will be\n * a regular polygon when `radius` is provided, or a star when `radius1` and\n * `radius2` are provided.\n * @api\n */\nclass RegularShape extends ImageStyle {\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n    /**\n     * @type {boolean}\n     */\n    const rotateWithView = options.rotateWithView !== undefined ?\n      options.rotateWithView : false;\n\n    super({\n      opacity: 1,\n      rotateWithView: rotateWithView,\n      rotation: options.rotation !== undefined ? options.rotation : 0,\n      scale: 1\n    });\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.hitDetectionCanvas_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Fill.js\").default}\n     */\n    this.fill_ = options.fill !== undefined ? options.fill : null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.origin_ = [0, 0];\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.points_ = options.points;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.radius_ = /** @type {number} */ (options.radius !== undefined ?\n      options.radius : options.radius1);\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.radius2_ = options.radius2;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.angle_ = options.angle !== undefined ? options.angle : 0;\n\n    /**\n     * @private\n     * @type {import(\"./Stroke.js\").default}\n     */\n    this.stroke_ = options.stroke !== undefined ? options.stroke : null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.anchor_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.size_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.imageSize_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.hitDetectionImageSize_ = null;\n\n    this.render();\n\n  }\n\n  /**\n   * Clones the style.\n   * @return {RegularShape} The cloned style.\n   * @api\n   */\n  clone() {\n    const style = new RegularShape({\n      fill: this.getFill() ? this.getFill().clone() : undefined,\n      points: this.getPoints(),\n      radius: this.getRadius(),\n      radius2: this.getRadius2(),\n      angle: this.getAngle(),\n      stroke: this.getStroke() ? this.getStroke().clone() : undefined,\n      rotation: this.getRotation(),\n      rotateWithView: this.getRotateWithView()\n    });\n    style.setOpacity(this.getOpacity());\n    style.setScale(this.getScale());\n    return style;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getAnchor() {\n    return this.anchor_;\n  }\n\n  /**\n   * Get the angle used in generating the shape.\n   * @return {number} Shape's rotation in radians.\n   * @api\n   */\n  getAngle() {\n    return this.angle_;\n  }\n\n  /**\n   * Get the fill style for the shape.\n   * @return {import(\"./Fill.js\").default} Fill style.\n   * @api\n   */\n  getFill() {\n    return this.fill_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getHitDetectionImage(pixelRatio) {\n    return this.hitDetectionCanvas_;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getImage(pixelRatio) {\n    return this.canvas_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImageSize() {\n    return this.imageSize_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getHitDetectionImageSize() {\n    return this.hitDetectionImageSize_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImageState() {\n    return ImageState.LOADED;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getOrigin() {\n    return this.origin_;\n  }\n\n  /**\n   * Get the number of points for generating the shape.\n   * @return {number} Number of points for stars and regular polygons.\n   * @api\n   */\n  getPoints() {\n    return this.points_;\n  }\n\n  /**\n   * Get the (primary) radius for the shape.\n   * @return {number} Radius.\n   * @api\n   */\n  getRadius() {\n    return this.radius_;\n  }\n\n  /**\n   * Get the secondary radius for the shape.\n   * @return {number|undefined} Radius2.\n   * @api\n   */\n  getRadius2() {\n    return this.radius2_;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getSize() {\n    return this.size_;\n  }\n\n  /**\n   * Get the stroke style for the shape.\n   * @return {import(\"./Stroke.js\").default} Stroke style.\n   * @api\n   */\n  getStroke() {\n    return this.stroke_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  listenImageChange(listener) {}\n\n  /**\n   * @inheritDoc\n   */\n  load() {}\n\n  /**\n   * @inheritDoc\n   */\n  unlistenImageChange(listener) {}\n\n  /**\n   * @protected\n   */\n  render() {\n    let lineCap = defaultLineCap;\n    let lineJoin = defaultLineJoin;\n    let miterLimit = 0;\n    let lineDash = null;\n    let lineDashOffset = 0;\n    let strokeStyle;\n    let strokeWidth = 0;\n\n    if (this.stroke_) {\n      strokeStyle = this.stroke_.getColor();\n      if (strokeStyle === null) {\n        strokeStyle = defaultStrokeStyle;\n      }\n      strokeStyle = asColorLike(strokeStyle);\n      strokeWidth = this.stroke_.getWidth();\n      if (strokeWidth === undefined) {\n        strokeWidth = defaultLineWidth;\n      }\n      lineDash = this.stroke_.getLineDash();\n      lineDashOffset = this.stroke_.getLineDashOffset();\n      lineJoin = this.stroke_.getLineJoin();\n      if (lineJoin === undefined) {\n        lineJoin = defaultLineJoin;\n      }\n      lineCap = this.stroke_.getLineCap();\n      if (lineCap === undefined) {\n        lineCap = defaultLineCap;\n      }\n      miterLimit = this.stroke_.getMiterLimit();\n      if (miterLimit === undefined) {\n        miterLimit = defaultMiterLimit;\n      }\n    }\n\n    let size = 2 * (this.radius_ + strokeWidth) + 1;\n\n    const renderOptions = {\n      strokeStyle: strokeStyle,\n      strokeWidth: strokeWidth,\n      size: size,\n      lineCap: lineCap,\n      lineDash: lineDash,\n      lineDashOffset: lineDashOffset,\n      lineJoin: lineJoin,\n      miterLimit: miterLimit\n    };\n\n    const context = createCanvasContext2D(size, size);\n    this.canvas_ = context.canvas;\n\n    // canvas.width and height are rounded to the closest integer\n    size = this.canvas_.width;\n    const imageSize = size;\n\n    this.draw_(renderOptions, context, 0, 0);\n\n    this.createHitDetectionCanvas_(renderOptions);\n\n    this.anchor_ = [size / 2, size / 2];\n    this.size_ = [size, size];\n    this.imageSize_ = [imageSize, imageSize];\n  }\n\n  /**\n   * @private\n   * @param {RenderOptions} renderOptions Render options.\n   * @param {CanvasRenderingContext2D} context The rendering context.\n   * @param {number} x The origin for the symbol (x).\n   * @param {number} y The origin for the symbol (y).\n   */\n  draw_(renderOptions, context, x, y) {\n    let i, angle0, radiusC;\n    // reset transform\n    context.setTransform(1, 0, 0, 1, 0, 0);\n\n    // then move to (x, y)\n    context.translate(x, y);\n\n    context.beginPath();\n\n    let points = this.points_;\n    if (points === Infinity) {\n      context.arc(\n        renderOptions.size / 2, renderOptions.size / 2,\n        this.radius_, 0, 2 * Math.PI, true);\n    } else {\n      const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n        : this.radius_;\n      if (radius2 !== this.radius_) {\n        points = 2 * points;\n      }\n      for (i = 0; i <= points; i++) {\n        angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n        radiusC = i % 2 === 0 ? this.radius_ : radius2;\n        context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n          renderOptions.size / 2 + radiusC * Math.sin(angle0));\n      }\n    }\n\n\n    if (this.fill_) {\n      let color = this.fill_.getColor();\n      if (color === null) {\n        color = defaultFillStyle;\n      }\n      context.fillStyle = asColorLike(color);\n      context.fill();\n    }\n    if (this.stroke_) {\n      context.strokeStyle = renderOptions.strokeStyle;\n      context.lineWidth = renderOptions.strokeWidth;\n      if (context.setLineDash && renderOptions.lineDash) {\n        context.setLineDash(renderOptions.lineDash);\n        context.lineDashOffset = renderOptions.lineDashOffset;\n      }\n      context.lineCap = renderOptions.lineCap;\n      context.lineJoin = renderOptions.lineJoin;\n      context.miterLimit = renderOptions.miterLimit;\n      context.stroke();\n    }\n    context.closePath();\n  }\n\n  /**\n   * @private\n   * @param {RenderOptions} renderOptions Render options.\n   */\n  createHitDetectionCanvas_(renderOptions) {\n    this.hitDetectionImageSize_ = [renderOptions.size, renderOptions.size];\n    this.hitDetectionCanvas_ = this.canvas_;\n    if (this.fill_) {\n      let color = this.fill_.getColor();\n\n      // determine if fill is transparent (or pattern or gradient)\n      let opacity = 0;\n      if (typeof color === 'string') {\n        color = asArray(color);\n      }\n      if (color === null) {\n        opacity = 1;\n      } else if (Array.isArray(color)) {\n        opacity = color.length === 4 ? color[3] : 1;\n      }\n      if (opacity === 0) {\n\n        // if a transparent fill style is set, create an extra hit-detection image\n        // with a default fill style\n        const context = createCanvasContext2D(renderOptions.size, renderOptions.size);\n        this.hitDetectionCanvas_ = context.canvas;\n\n        this.drawHitDetectionCanvas_(renderOptions, context, 0, 0);\n      }\n    }\n\n  }\n\n  /**\n   * @private\n   * @param {RenderOptions} renderOptions Render options.\n   * @param {CanvasRenderingContext2D} context The context.\n   * @param {number} x The origin for the symbol (x).\n   * @param {number} y The origin for the symbol (y).\n   */\n  drawHitDetectionCanvas_(renderOptions, context, x, y) {\n    // reset transform\n    context.setTransform(1, 0, 0, 1, 0, 0);\n\n    // then move to (x, y)\n    context.translate(x, y);\n\n    context.beginPath();\n\n    let points = this.points_;\n    if (points === Infinity) {\n      context.arc(\n        renderOptions.size / 2, renderOptions.size / 2,\n        this.radius_, 0, 2 * Math.PI, true);\n    } else {\n      const radius2 = (this.radius2_ !== undefined) ? this.radius2_\n        : this.radius_;\n      if (radius2 !== this.radius_) {\n        points = 2 * points;\n      }\n      let i, radiusC, angle0;\n      for (i = 0; i <= points; i++) {\n        angle0 = i * 2 * Math.PI / points - Math.PI / 2 + this.angle_;\n        radiusC = i % 2 === 0 ? this.radius_ : radius2;\n        context.lineTo(renderOptions.size / 2 + radiusC * Math.cos(angle0),\n          renderOptions.size / 2 + radiusC * Math.sin(angle0));\n      }\n    }\n\n    context.fillStyle = defaultFillStyle;\n    context.fill();\n    if (this.stroke_) {\n      context.strokeStyle = renderOptions.strokeStyle;\n      context.lineWidth = renderOptions.strokeWidth;\n      if (renderOptions.lineDash) {\n        context.setLineDash(renderOptions.lineDash);\n        context.lineDashOffset = renderOptions.lineDashOffset;\n      }\n      context.stroke();\n    }\n    context.closePath();\n  }\n\n}\n\n\nexport default RegularShape;\n","/**\n * @module ol/render/canvas/Builder\n */\nimport {equals, reverseSubArray} from '../../array.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {buffer, clone, coordinateRelationship} from '../../extent.js';\nimport Relationship from '../../extent/Relationship.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {inflateCoordinates, inflateCoordinatesArray, inflateMultiCoordinatesArray} from '../../geom/flat/inflate.js';\nimport VectorContext from '../VectorContext.js';\nimport {defaultFillStyle, defaultStrokeStyle,\n  defaultMiterLimit, defaultLineWidth, defaultLineJoin, defaultLineDashOffset,\n  defaultLineDash, defaultLineCap} from '../canvas.js';\nimport CanvasInstruction from './Instruction.js';\n\n\n/**\n * @typedef {Object} SerializableInstructions\n * @property {Array<*>} instructions The rendering instructions.\n * @property {Array<*>} hitDetectionInstructions The rendering hit detection instructions.\n * @property {Array<number>} coordinates The array of all coordinates.\n * @property {!Object<string, import(\"../canvas.js\").TextState>} [textStates] The text states (decluttering).\n * @property {!Object<string, import(\"../canvas.js\").FillState>} [fillStates] The fill states (decluttering).\n * @property {!Object<string, import(\"../canvas.js\").StrokeState>} [strokeStates] The stroke states (decluttering).\n */\n\n\nclass CanvasBuilder extends VectorContext {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n  constructor(tolerance, maxExtent, resolution, pixelRatio) {\n    super();\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.tolerance = tolerance;\n\n    /**\n     * @protected\n     * @const\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.maxExtent = maxExtent;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.pixelRatio = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.maxLineWidth = 0;\n\n    /**\n     * @protected\n     * @const\n     * @type {number}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @private\n     * @type {Array<*>}\n     */\n    this.beginGeometryInstruction1_ = null;\n\n    /**\n     * @private\n     * @type {Array<*>}\n     */\n    this.beginGeometryInstruction2_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.bufferedMaxExtent_ = null;\n\n    /**\n     * @protected\n     * @type {Array<*>}\n     */\n    this.instructions = [];\n\n    /**\n     * @protected\n     * @type {Array<number>}\n     */\n    this.coordinates = [];\n\n    /**\n     * @private\n     * @type {import(\"../../coordinate.js\").Coordinate}\n     */\n    this.tmpCoordinate_ = [];\n\n    /**\n     * @protected\n     * @type {Array<*>}\n     */\n    this.hitDetectionInstructions = [];\n\n    /**\n     * @protected\n     * @type {import(\"../canvas.js\").FillStrokeState}\n     */\n    this.state = /** @type {import(\"../canvas.js\").FillStrokeState} */ ({});\n\n  }\n\n  /**\n   * @protected\n   * @param {Array<number>} dashArray Dash array.\n   * @return {Array<number>} Dash array with pixel ratio applied\n   */\n  applyPixelRatio(dashArray) {\n    const pixelRatio = this.pixelRatio;\n    return pixelRatio == 1 ? dashArray : dashArray.map(function(dash) {\n      return dash * pixelRatio;\n    });\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @param {boolean} closed Last input coordinate equals first.\n   * @param {boolean} skipFirst Skip first coordinate.\n   * @protected\n   * @return {number} My end.\n   */\n  appendFlatCoordinates(flatCoordinates, offset, end, stride, closed, skipFirst) {\n\n    let myEnd = this.coordinates.length;\n    const extent = this.getBufferedMaxExtent();\n    if (skipFirst) {\n      offset += stride;\n    }\n    let lastXCoord = flatCoordinates[offset];\n    let lastYCoord = flatCoordinates[offset + 1];\n    const nextCoord = this.tmpCoordinate_;\n    let skipped = true;\n\n    let i, lastRel, nextRel;\n    for (i = offset + stride; i < end; i += stride) {\n      nextCoord[0] = flatCoordinates[i];\n      nextCoord[1] = flatCoordinates[i + 1];\n      nextRel = coordinateRelationship(extent, nextCoord);\n      if (nextRel !== lastRel) {\n        if (skipped) {\n          this.coordinates[myEnd++] = lastXCoord;\n          this.coordinates[myEnd++] = lastYCoord;\n        }\n        this.coordinates[myEnd++] = nextCoord[0];\n        this.coordinates[myEnd++] = nextCoord[1];\n        skipped = false;\n      } else if (nextRel === Relationship.INTERSECTING) {\n        this.coordinates[myEnd++] = nextCoord[0];\n        this.coordinates[myEnd++] = nextCoord[1];\n        skipped = false;\n      } else {\n        skipped = true;\n      }\n      lastXCoord = nextCoord[0];\n      lastYCoord = nextCoord[1];\n      lastRel = nextRel;\n    }\n\n    // Last coordinate equals first or only one point to append:\n    if ((closed && skipped) || i === offset + stride) {\n      this.coordinates[myEnd++] = lastXCoord;\n      this.coordinates[myEnd++] = lastYCoord;\n    }\n    return myEnd;\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @param {Array<number>} builderEnds Builder ends.\n   * @return {number} Offset.\n   */\n  drawCustomCoordinates_(flatCoordinates, offset, ends, stride, builderEnds) {\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      const end = ends[i];\n      const builderEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n      builderEnds.push(builderEnd);\n      offset = end;\n    }\n    return offset;\n  }\n\n  /**\n   * @inheritDoc.\n   */\n  drawCustom(geometry, feature, renderer) {\n    this.beginGeometry(geometry, feature);\n    const type = geometry.getType();\n    const stride = geometry.getStride();\n    const builderBegin = this.coordinates.length;\n    let flatCoordinates, builderEnd, builderEnds, builderEndss;\n    let offset;\n    if (type == GeometryType.MULTI_POLYGON) {\n      geometry = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry);\n      flatCoordinates = geometry.getOrientedFlatCoordinates();\n      builderEndss = [];\n      const endss = geometry.getEndss();\n      offset = 0;\n      for (let i = 0, ii = endss.length; i < ii; ++i) {\n        const myEnds = [];\n        offset = this.drawCustomCoordinates_(flatCoordinates, offset, endss[i], stride, myEnds);\n        builderEndss.push(myEnds);\n      }\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        builderBegin, builderEndss, geometry, renderer, inflateMultiCoordinatesArray]);\n    } else if (type == GeometryType.POLYGON || type == GeometryType.MULTI_LINE_STRING) {\n      builderEnds = [];\n      flatCoordinates = (type == GeometryType.POLYGON) ?\n        /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry).getOrientedFlatCoordinates() :\n        geometry.getFlatCoordinates();\n      offset = this.drawCustomCoordinates_(flatCoordinates, 0,\n        /** @type {import(\"../../geom/Polygon.js\").default|import(\"../../geom/MultiLineString.js\").default} */ (geometry).getEnds(),\n        stride, builderEnds);\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        builderBegin, builderEnds, geometry, renderer, inflateCoordinatesArray]);\n    } else if (type == GeometryType.LINE_STRING || type == GeometryType.MULTI_POINT) {\n      flatCoordinates = geometry.getFlatCoordinates();\n      builderEnd = this.appendFlatCoordinates(\n        flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        builderBegin, builderEnd, geometry, renderer, inflateCoordinates]);\n    } else if (type == GeometryType.POINT) {\n      flatCoordinates = geometry.getFlatCoordinates();\n      this.coordinates.push(flatCoordinates[0], flatCoordinates[1]);\n      builderEnd = this.coordinates.length;\n      this.instructions.push([CanvasInstruction.CUSTOM,\n        builderBegin, builderEnd, geometry, renderer]);\n    }\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @protected\n   * @param {import(\"../../geom/Geometry\").default|import(\"../Feature.js\").default} geometry The geometry.\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   */\n  beginGeometry(geometry, feature) {\n    const extent = geometry.getExtent();\n    this.beginGeometryInstruction1_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0, extent];\n    this.instructions.push(this.beginGeometryInstruction1_);\n    this.beginGeometryInstruction2_ = [CanvasInstruction.BEGIN_GEOMETRY, feature, 0, extent];\n    this.hitDetectionInstructions.push(this.beginGeometryInstruction2_);\n  }\n\n  /**\n   * @return {SerializableInstructions} the serializable instructions.\n   */\n  finish() {\n    return {\n      instructions: this.instructions,\n      hitDetectionInstructions: this.hitDetectionInstructions,\n      coordinates: this.coordinates\n    };\n  }\n\n  /**\n   * Reverse the hit detection instructions.\n   */\n  reverseHitDetectionInstructions() {\n    const hitDetectionInstructions = this.hitDetectionInstructions;\n    // step 1 - reverse array\n    hitDetectionInstructions.reverse();\n    // step 2 - reverse instructions within geometry blocks\n    let i;\n    const n = hitDetectionInstructions.length;\n    let instruction;\n    let type;\n    let begin = -1;\n    for (i = 0; i < n; ++i) {\n      instruction = hitDetectionInstructions[i];\n      type = /** @type {CanvasInstruction} */ (instruction[0]);\n      if (type == CanvasInstruction.END_GEOMETRY) {\n        begin = i;\n      } else if (type == CanvasInstruction.BEGIN_GEOMETRY) {\n        instruction[2] = i;\n        reverseSubArray(this.hitDetectionInstructions, begin, i);\n        begin = -1;\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {\n    const state = this.state;\n    if (fillStyle) {\n      const fillStyleColor = fillStyle.getColor();\n      state.fillStyle = asColorLike(fillStyleColor ?\n        fillStyleColor : defaultFillStyle);\n    } else {\n      state.fillStyle = undefined;\n    }\n    if (strokeStyle) {\n      const strokeStyleColor = strokeStyle.getColor();\n      state.strokeStyle = asColorLike(strokeStyleColor ?\n        strokeStyleColor : defaultStrokeStyle);\n      const strokeStyleLineCap = strokeStyle.getLineCap();\n      state.lineCap = strokeStyleLineCap !== undefined ?\n        strokeStyleLineCap : defaultLineCap;\n      const strokeStyleLineDash = strokeStyle.getLineDash();\n      state.lineDash = strokeStyleLineDash ?\n        strokeStyleLineDash.slice() : defaultLineDash;\n      const strokeStyleLineDashOffset = strokeStyle.getLineDashOffset();\n      state.lineDashOffset = strokeStyleLineDashOffset ?\n        strokeStyleLineDashOffset : defaultLineDashOffset;\n      const strokeStyleLineJoin = strokeStyle.getLineJoin();\n      state.lineJoin = strokeStyleLineJoin !== undefined ?\n        strokeStyleLineJoin : defaultLineJoin;\n      const strokeStyleWidth = strokeStyle.getWidth();\n      state.lineWidth = strokeStyleWidth !== undefined ?\n        strokeStyleWidth : defaultLineWidth;\n      const strokeStyleMiterLimit = strokeStyle.getMiterLimit();\n      state.miterLimit = strokeStyleMiterLimit !== undefined ?\n        strokeStyleMiterLimit : defaultMiterLimit;\n\n      if (state.lineWidth > this.maxLineWidth) {\n        this.maxLineWidth = state.lineWidth;\n        // invalidate the buffered max extent cache\n        this.bufferedMaxExtent_ = null;\n      }\n    } else {\n      state.strokeStyle = undefined;\n      state.lineCap = undefined;\n      state.lineDash = null;\n      state.lineDashOffset = undefined;\n      state.lineJoin = undefined;\n      state.lineWidth = undefined;\n      state.miterLimit = undefined;\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @return {Array<*>} Fill instruction.\n   */\n  createFill(state) {\n    const fillStyle = state.fillStyle;\n    /** @type {Array<*>} */\n    const fillInstruction = [CanvasInstruction.SET_FILL_STYLE, fillStyle];\n    if (typeof fillStyle !== 'string') {\n      // Fill is a pattern or gradient - align it!\n      fillInstruction.push(true);\n    }\n    return fillInstruction;\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   */\n  applyStroke(state) {\n    this.instructions.push(this.createStroke(state));\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @return {Array<*>} Stroke instruction.\n   */\n  createStroke(state) {\n    return [\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth * this.pixelRatio, state.lineCap,\n      state.lineJoin, state.miterLimit,\n      this.applyPixelRatio(state.lineDash), state.lineDashOffset * this.pixelRatio\n    ];\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @param {function(this:CanvasBuilder, import(\"../canvas.js\").FillStrokeState):Array<*>} createFill Create fill.\n   */\n  updateFillStyle(state, createFill) {\n    const fillStyle = state.fillStyle;\n    if (typeof fillStyle !== 'string' || state.currentFillStyle != fillStyle) {\n      if (fillStyle !== undefined) {\n        this.instructions.push(createFill.call(this, state));\n      }\n      state.currentFillStyle = fillStyle;\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").FillStrokeState} state State.\n   * @param {function(this:CanvasBuilder, import(\"../canvas.js\").FillStrokeState): void} applyStroke Apply stroke.\n   */\n  updateStrokeStyle(state, applyStroke) {\n    const strokeStyle = state.strokeStyle;\n    const lineCap = state.lineCap;\n    const lineDash = state.lineDash;\n    const lineDashOffset = state.lineDashOffset;\n    const lineJoin = state.lineJoin;\n    const lineWidth = state.lineWidth;\n    const miterLimit = state.miterLimit;\n    if (state.currentStrokeStyle != strokeStyle ||\n        state.currentLineCap != lineCap ||\n        (lineDash != state.currentLineDash && !equals(state.currentLineDash, lineDash)) ||\n        state.currentLineDashOffset != lineDashOffset ||\n        state.currentLineJoin != lineJoin ||\n        state.currentLineWidth != lineWidth ||\n        state.currentMiterLimit != miterLimit) {\n      if (strokeStyle !== undefined) {\n        applyStroke.call(this, state);\n      }\n      state.currentStrokeStyle = strokeStyle;\n      state.currentLineCap = lineCap;\n      state.currentLineDash = lineDash;\n      state.currentLineDashOffset = lineDashOffset;\n      state.currentLineJoin = lineJoin;\n      state.currentLineWidth = lineWidth;\n      state.currentMiterLimit = miterLimit;\n    }\n  }\n\n  /**\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   */\n  endGeometry(feature) {\n    this.beginGeometryInstruction1_[2] = this.instructions.length;\n    this.beginGeometryInstruction1_ = null;\n    this.beginGeometryInstruction2_[2] = this.hitDetectionInstructions.length;\n    this.beginGeometryInstruction2_ = null;\n    const endGeometryInstruction = [CanvasInstruction.END_GEOMETRY, feature];\n    this.instructions.push(endGeometryInstruction);\n    this.hitDetectionInstructions.push(endGeometryInstruction);\n  }\n\n  /**\n   * Get the buffered rendering extent.  Rendering will be clipped to the extent\n   * provided to the constructor.  To account for symbolizers that may intersect\n   * this extent, we calculate a buffered extent (e.g. based on stroke width).\n   * @return {import(\"../../extent.js\").Extent} The buffered rendering extent.\n   * @protected\n   */\n  getBufferedMaxExtent() {\n    if (!this.bufferedMaxExtent_) {\n      this.bufferedMaxExtent_ = clone(this.maxExtent);\n      if (this.maxLineWidth > 0) {\n        const width = this.resolution * (this.maxLineWidth + 1) / 2;\n        buffer(this.bufferedMaxExtent_, width, this.bufferedMaxExtent_);\n      }\n    }\n    return this.bufferedMaxExtent_;\n  }\n}\n\n\nexport default CanvasBuilder;\n","/**\n * @module ol/format/MVT\n */\n//FIXME Implement projection handling\n\nimport {assert} from '../asserts.js';\nimport PBF from 'pbf';\nimport FeatureFormat, {transformGeometryWithOptions} from './Feature.js';\nimport FormatType from './FormatType.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {linearRingIsClockwise} from '../geom/flat/orient.js';\nimport Projection from '../proj/Projection.js';\nimport Units from '../proj/Units.js';\nimport RenderFeature from '../render/Feature.js';\nimport {get} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../Feature.js\").FeatureClass} [featureClass] Class for features returned by\n * {@link module:ol/format/MVT#readFeatures}. Set to {@link module:ol/Feature~Feature} to get full editing and geometry\n * support at the cost of decreased rendering performance. The default is\n * {@link module:ol/render/Feature~RenderFeature}, which is optimized for rendering and hit detection.\n * @property {string} [geometryName='geometry'] Geometry name to use when creating features.\n * @property {string} [layerName='layer'] Name of the feature attribute that holds the layer name.\n * @property {Array<string>} [layers] Layers to read features from. If not provided, features will be read from all\n * @property {string} [idProperty] Optional property that will be assigned as the feature id and removed from the properties.\n * layers.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading data in the Mapbox MVT format.\n *\n * @param {Options=} opt_options Options.\n * @api\n */\nclass MVT extends FeatureFormat {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @type {Projection}\n     */\n    this.dataProjection = new Projection({\n      code: '',\n      units: Units.TILE_PIXELS\n    });\n\n    /**\n     * @private\n     * @type {import(\"../Feature.js\").FeatureClass}\n     */\n    this.featureClass_ = options.featureClass ? options.featureClass : RenderFeature;\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.geometryName_ = options.geometryName;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.layerName_ = options.layerName ? options.layerName : 'layer';\n\n    /**\n     * @private\n     * @type {Array<string>}\n     */\n    this.layers_ = options.layers ? options.layers : null;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.idProperty_ = options.idProperty;\n\n  }\n\n  /**\n   * Read the raw geometry from the pbf offset stored in a raw feature's geometry\n   * property.\n   * @param {PBF} pbf PBF.\n   * @param {Object} feature Raw feature.\n   * @param {Array<number>} flatCoordinates Array to store flat coordinates in.\n   * @param {Array<number>} ends Array to store ends in.\n   * @private\n   */\n  readRawGeometry_(pbf, feature, flatCoordinates, ends) {\n    pbf.pos = feature.geometry;\n\n    const end = pbf.readVarint() + pbf.pos;\n    let cmd = 1;\n    let length = 0;\n    let x = 0;\n    let y = 0;\n    let coordsLen = 0;\n    let currentEnd = 0;\n\n    while (pbf.pos < end) {\n      if (!length) {\n        const cmdLen = pbf.readVarint();\n        cmd = cmdLen & 0x7;\n        length = cmdLen >> 3;\n      }\n\n      length--;\n\n      if (cmd === 1 || cmd === 2) {\n        x += pbf.readSVarint();\n        y += pbf.readSVarint();\n\n        if (cmd === 1) { // moveTo\n          if (coordsLen > currentEnd) {\n            ends.push(coordsLen);\n            currentEnd = coordsLen;\n          }\n        }\n\n        flatCoordinates.push(x, y);\n        coordsLen += 2;\n\n      } else if (cmd === 7) {\n\n        if (coordsLen > currentEnd) {\n          // close polygon\n          flatCoordinates.push(\n            flatCoordinates[currentEnd], flatCoordinates[currentEnd + 1]);\n          coordsLen += 2;\n        }\n\n      } else {\n        assert(false, 59); // Invalid command found in the PBF\n      }\n    }\n\n    if (coordsLen > currentEnd) {\n      ends.push(coordsLen);\n      currentEnd = coordsLen;\n    }\n\n  }\n\n  /**\n   * @private\n   * @param {PBF} pbf PBF\n   * @param {Object} rawFeature Raw Mapbox feature.\n   * @param {import(\"./Feature.js\").ReadOptions} options Read options.\n   * @return {import(\"../Feature.js\").FeatureLike} Feature.\n   */\n  createFeature_(pbf, rawFeature, options) {\n    const type = rawFeature.type;\n    if (type === 0) {\n      return null;\n    }\n\n    let feature;\n    const values = rawFeature.properties;\n\n    let id;\n    if (!this.idProperty_) {\n      id = rawFeature.id;\n    } else {\n      id = values[this.idProperty_];\n      delete values[this.idProperty_];\n    }\n\n    values[this.layerName_] = rawFeature.layer.name;\n\n    const flatCoordinates = [];\n    const ends = [];\n    this.readRawGeometry_(pbf, rawFeature, flatCoordinates, ends);\n\n    const geometryType = getGeometryType(type, ends.length);\n\n    if (this.featureClass_ === RenderFeature) {\n      feature = new this.featureClass_(geometryType, flatCoordinates, ends, values, id);\n      feature.transform(options.dataProjection, options.featureProjection);\n    } else {\n      let geom;\n      if (geometryType == GeometryType.POLYGON) {\n        const endss = [];\n        let offset = 0;\n        let prevEndIndex = 0;\n        for (let i = 0, ii = ends.length; i < ii; ++i) {\n          const end = ends[i];\n          if (!linearRingIsClockwise(flatCoordinates, offset, end, 2)) {\n            endss.push(ends.slice(prevEndIndex, i));\n            prevEndIndex = i;\n          }\n          offset = end;\n        }\n        if (endss.length > 1) {\n          geom = new MultiPolygon(flatCoordinates, GeometryLayout.XY, endss);\n        } else {\n          geom = new Polygon(flatCoordinates, GeometryLayout.XY, ends);\n        }\n      } else {\n        geom = geometryType === GeometryType.POINT ? new Point(flatCoordinates, GeometryLayout.XY) :\n          geometryType === GeometryType.LINE_STRING ? new LineString(flatCoordinates, GeometryLayout.XY) :\n            geometryType === GeometryType.POLYGON ? new Polygon(flatCoordinates, GeometryLayout.XY, ends) :\n              geometryType === GeometryType.MULTI_POINT ? new MultiPoint(flatCoordinates, GeometryLayout.XY) :\n                geometryType === GeometryType.MULTI_LINE_STRING ? new MultiLineString(flatCoordinates, GeometryLayout.XY, ends) :\n                  null;\n      }\n      const ctor = /** @type {typeof import(\"../Feature.js\").default} */ (this.featureClass_);\n      feature = new ctor();\n      if (this.geometryName_) {\n        feature.setGeometryName(this.geometryName_);\n      }\n      const geometry = transformGeometryWithOptions(geom, false, options);\n      feature.setGeometry(geometry);\n      feature.setId(id);\n      feature.setProperties(values, true);\n    }\n\n    return feature;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getType() {\n    return FormatType.ARRAY_BUFFER;\n  }\n\n  /**\n   * Read all features.\n   *\n   * @param {ArrayBuffer} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {Array<import(\"../Feature.js\").FeatureLike>} Features.\n   * @api\n   */\n  readFeatures(source, opt_options) {\n    const layers = this.layers_;\n    const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (this.adaptOptions(opt_options));\n    const dataProjection = get(options.dataProjection);\n    dataProjection.setWorldExtent(options.extent);\n    options.dataProjection = dataProjection;\n\n    const pbf = new PBF(/** @type {ArrayBuffer} */ (source));\n    const pbfLayers = pbf.readFields(layersPBFReader, {});\n    const features = [];\n    for (const name in pbfLayers) {\n      if (layers && layers.indexOf(name) == -1) {\n        continue;\n      }\n      const pbfLayer = pbfLayers[name];\n\n      const extent = pbfLayer ? [0, 0, pbfLayer.extent, pbfLayer.extent] : null;\n      dataProjection.setExtent(extent);\n\n      for (let i = 0, ii = pbfLayer.length; i < ii; ++i) {\n        const rawFeature = readRawFeature(pbf, pbfLayer, i);\n        features.push(this.createFeature_(pbf, rawFeature, options));\n      }\n    }\n\n    return features;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  readProjection(source) {\n    return this.dataProjection;\n  }\n\n  /**\n   * Sets the layers that features will be read from.\n   * @param {Array<string>} layers Layers.\n   * @api\n   */\n  setLayers(layers) {\n    this.layers_ = layers;\n  }\n\n}\n\n\n/**\n * Reader callback for parsing layers.\n * @param {number} tag The tag.\n * @param {Object} layers The layers object.\n * @param {PBF} pbf The PBF.\n */\nfunction layersPBFReader(tag, layers, pbf) {\n  if (tag === 3) {\n    const layer = {\n      keys: [],\n      values: [],\n      features: []\n    };\n    const end = pbf.readVarint() + pbf.pos;\n    pbf.readFields(layerPBFReader, layer, end);\n    layer.length = layer.features.length;\n    if (layer.length) {\n      layers[layer.name] = layer;\n    }\n  }\n}\n\n/**\n * Reader callback for parsing layer.\n * @param {number} tag The tag.\n * @param {Object} layer The layer object.\n * @param {PBF} pbf The PBF.\n */\nfunction layerPBFReader(tag, layer, pbf) {\n  if (tag === 15) {\n    layer.version = pbf.readVarint();\n  } else if (tag === 1) {\n    layer.name = pbf.readString();\n  } else if (tag === 5) {\n    layer.extent = pbf.readVarint();\n  } else if (tag === 2) {\n    layer.features.push(pbf.pos);\n  } else if (tag === 3) {\n    layer.keys.push(pbf.readString());\n  } else if (tag === 4) {\n    let value = null;\n    const end = pbf.readVarint() + pbf.pos;\n    while (pbf.pos < end) {\n      tag = pbf.readVarint() >> 3;\n      value = tag === 1 ? pbf.readString() :\n        tag === 2 ? pbf.readFloat() :\n          tag === 3 ? pbf.readDouble() :\n            tag === 4 ? pbf.readVarint64() :\n              tag === 5 ? pbf.readVarint() :\n                tag === 6 ? pbf.readSVarint() :\n                  tag === 7 ? pbf.readBoolean() : null;\n    }\n    layer.values.push(value);\n  }\n}\n\n/**\n * Reader callback for parsing feature.\n * @param {number} tag The tag.\n * @param {Object} feature The feature object.\n * @param {PBF} pbf The PBF.\n */\nfunction featurePBFReader(tag, feature, pbf) {\n  if (tag == 1) {\n    feature.id = pbf.readVarint();\n  } else if (tag == 2) {\n    const end = pbf.readVarint() + pbf.pos;\n    while (pbf.pos < end) {\n      const key = feature.layer.keys[pbf.readVarint()];\n      const value = feature.layer.values[pbf.readVarint()];\n      feature.properties[key] = value;\n    }\n  } else if (tag == 3) {\n    feature.type = pbf.readVarint();\n  } else if (tag == 4) {\n    feature.geometry = pbf.pos;\n  }\n}\n\n\n/**\n * Read a raw feature from the pbf offset stored at index `i` in the raw layer.\n * @param {PBF} pbf PBF.\n * @param {Object} layer Raw layer.\n * @param {number} i Index of the feature in the raw layer's `features` array.\n * @return {Object} Raw feature.\n */\nfunction readRawFeature(pbf, layer, i) {\n  pbf.pos = layer.features[i];\n  const end = pbf.readVarint() + pbf.pos;\n\n  const feature = {\n    layer: layer,\n    type: 0,\n    properties: {}\n  };\n  pbf.readFields(featurePBFReader, feature, end);\n  return feature;\n}\n\n\n/**\n * @param {number} type The raw feature's geometry type\n * @param {number} numEnds Number of ends of the flat coordinates of the\n * geometry.\n * @return {GeometryType} The geometry type.\n */\nfunction getGeometryType(type, numEnds) {\n  /** @type {GeometryType} */\n  let geometryType;\n  if (type === 1) {\n    geometryType = numEnds === 1 ?\n      GeometryType.POINT : GeometryType.MULTI_POINT;\n  } else if (type === 2) {\n    geometryType = numEnds === 1 ?\n      GeometryType.LINE_STRING :\n      GeometryType.MULTI_LINE_STRING;\n  } else if (type === 3) {\n    geometryType = GeometryType.POLYGON;\n    // MultiPolygon not relevant for rendering - winding order determines\n    // outer rings of polygons.\n  }\n  return geometryType;\n}\n\nexport default MVT;\n","/**\n * @module ol/MapEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered after a map frame is rendered.\n   * @event module:ol/MapEvent~MapEvent#postrender\n   * @api\n   */\n  POSTRENDER: 'postrender',\n\n  /**\n   * Triggered when the map starts moving.\n   * @event module:ol/MapEvent~MapEvent#movestart\n   * @api\n   */\n  MOVESTART: 'movestart',\n\n  /**\n   * Triggered after the map is moved.\n   * @event module:ol/MapEvent~MapEvent#moveend\n   * @api\n   */\n  MOVEEND: 'moveend'\n\n};\n","/**\n * @module ol/geom/LinearRing\n */\nimport {closestSquaredDistanceXY} from '../extent.js';\nimport GeometryLayout from './GeometryLayout.js';\nimport GeometryType from './GeometryType.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {linearRing as linearRingArea} from './flat/area.js';\nimport {assignClosestPoint, maxSquaredDelta} from './flat/closest.js';\nimport {deflateCoordinates} from './flat/deflate.js';\nimport {inflateCoordinates} from './flat/inflate.js';\nimport {douglasPeucker} from './flat/simplify.js';\n\n/**\n * @classdesc\n * Linear ring geometry. Only used as part of polygon; cannot be rendered\n * on its own.\n *\n * @api\n */\nclass LinearRing extends SimpleGeometry {\n\n  /**\n   * @param {Array<import(\"../coordinate.js\").Coordinate>|Array<number>} coordinates Coordinates.\n   *     For internal use, flat coordinates in combination with `opt_layout` are also accepted.\n   * @param {GeometryLayout=} opt_layout Layout.\n   */\n  constructor(coordinates, opt_layout) {\n\n    super();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDelta_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.maxDeltaRevision_ = -1;\n\n    if (opt_layout !== undefined && !Array.isArray(coordinates[0])) {\n      this.setFlatCoordinates(opt_layout, /** @type {Array<number>} */ (coordinates));\n    } else {\n      this.setCoordinates(/** @type {Array<import(\"../coordinate.js\").Coordinate>} */ (coordinates), opt_layout);\n    }\n\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!LinearRing} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    return new LinearRing(this.flatCoordinates.slice(), this.layout);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    if (this.maxDeltaRevision_ != this.getRevision()) {\n      this.maxDelta_ = Math.sqrt(maxSquaredDelta(\n        this.flatCoordinates, 0, this.flatCoordinates.length, this.stride, 0));\n      this.maxDeltaRevision_ = this.getRevision();\n    }\n    return assignClosestPoint(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n      this.maxDelta_, true, x, y, closestPoint, minSquaredDistance);\n  }\n\n  /**\n   * Return the area of the linear ring on projected plane.\n   * @return {number} Area (on projected plane).\n   * @api\n   */\n  getArea() {\n    return linearRingArea(this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n  }\n\n  /**\n   * Return the coordinates of the linear ring.\n   * @return {Array<import(\"../coordinate.js\").Coordinate>} Coordinates.\n   * @override\n   * @api\n   */\n  getCoordinates() {\n    return inflateCoordinates(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometryInternal(squaredTolerance) {\n    const simplifiedFlatCoordinates = [];\n    simplifiedFlatCoordinates.length = douglasPeucker(\n      this.flatCoordinates, 0, this.flatCoordinates.length, this.stride,\n      squaredTolerance, simplifiedFlatCoordinates, 0);\n    return new LinearRing(simplifiedFlatCoordinates, GeometryLayout.XY);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.LINEAR_RING;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  intersectsExtent(extent) {\n    return false;\n  }\n\n  /**\n   * Set the coordinates of the linear ring.\n   * @param {!Array<import(\"../coordinate.js\").Coordinate>} coordinates Coordinates.\n   * @param {GeometryLayout=} opt_layout Layout.\n   * @override\n   * @api\n   */\n  setCoordinates(coordinates, opt_layout) {\n    this.setLayout(opt_layout, coordinates, 1);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    this.flatCoordinates.length = deflateCoordinates(\n      this.flatCoordinates, 0, coordinates, this.stride);\n    this.changed();\n  }\n}\n\n\nexport default LinearRing;\n","/**\n * @module ol/reproj\n */\nimport {createCanvasContext2D} from './dom.js';\nimport {containsCoordinate, createEmpty, extend, getHeight, getTopLeft, getWidth} from './extent.js';\nimport {solveLinearSystem} from './math.js';\nimport {getPointResolution, transform} from './proj.js';\n\n\n/**\n * Calculates ideal resolution to use from the source in order to achieve\n * pixel mapping as close as possible to 1:1 during reprojection.\n * The resolution is calculated regardless of what resolutions\n * are actually available in the dataset (TileGrid, Image, ...).\n *\n * @param {import(\"./proj/Projection.js\").default} sourceProj Source projection.\n * @param {import(\"./proj/Projection.js\").default} targetProj Target projection.\n * @param {import(\"./coordinate.js\").Coordinate} targetCenter Target center.\n * @param {number} targetResolution Target resolution.\n * @return {number} The best resolution to use. Can be +-Infinity, NaN or 0.\n */\nexport function calculateSourceResolution(sourceProj, targetProj,\n  targetCenter, targetResolution) {\n\n  const sourceCenter = transform(targetCenter, targetProj, sourceProj);\n\n  // calculate the ideal resolution of the source data\n  let sourceResolution = getPointResolution(targetProj, targetResolution, targetCenter);\n\n  const targetMetersPerUnit = targetProj.getMetersPerUnit();\n  if (targetMetersPerUnit !== undefined) {\n    sourceResolution *= targetMetersPerUnit;\n  }\n  const sourceMetersPerUnit = sourceProj.getMetersPerUnit();\n  if (sourceMetersPerUnit !== undefined) {\n    sourceResolution /= sourceMetersPerUnit;\n  }\n\n  // Based on the projection properties, the point resolution at the specified\n  // coordinates may be slightly different. We need to reverse-compensate this\n  // in order to achieve optimal results.\n\n  const sourceExtent = sourceProj.getExtent();\n  if (!sourceExtent || containsCoordinate(sourceExtent, sourceCenter)) {\n    const compensationFactor = getPointResolution(sourceProj, sourceResolution, sourceCenter) /\n        sourceResolution;\n    if (isFinite(compensationFactor) && compensationFactor > 0) {\n      sourceResolution /= compensationFactor;\n    }\n  }\n\n  return sourceResolution;\n}\n\n\n/**\n * Enlarge the clipping triangle point by 1 pixel to ensure the edges overlap\n * in order to mask gaps caused by antialiasing.\n *\n * @param {number} centroidX Centroid of the triangle (x coordinate in pixels).\n * @param {number} centroidY Centroid of the triangle (y coordinate in pixels).\n * @param {number} x X coordinate of the point (in pixels).\n * @param {number} y Y coordinate of the point (in pixels).\n * @return {import(\"./coordinate.js\").Coordinate} New point 1 px farther from the centroid.\n */\nfunction enlargeClipPoint(centroidX, centroidY, x, y) {\n  const dX = x - centroidX;\n  const dY = y - centroidY;\n  const distance = Math.sqrt(dX * dX + dY * dY);\n  return [Math.round(x + dX / distance), Math.round(y + dY / distance)];\n}\n\n\n/**\n * Renders the source data into new canvas based on the triangulation.\n *\n * @param {number} width Width of the canvas.\n * @param {number} height Height of the canvas.\n * @param {number} pixelRatio Pixel ratio.\n * @param {number} sourceResolution Source resolution.\n * @param {import(\"./extent.js\").Extent} sourceExtent Extent of the data source.\n * @param {number} targetResolution Target resolution.\n * @param {import(\"./extent.js\").Extent} targetExtent Target extent.\n * @param {import(\"./reproj/Triangulation.js\").default} triangulation\n * Calculated triangulation.\n * @param {Array<{extent: import(\"./extent.js\").Extent,\n *                 image: (HTMLCanvasElement|HTMLImageElement|HTMLVideoElement)}>} sources\n * Array of sources.\n * @param {number} gutter Gutter of the sources.\n * @param {boolean=} opt_renderEdges Render reprojection edges.\n * @return {HTMLCanvasElement} Canvas with reprojected data.\n */\nexport function render(width, height, pixelRatio,\n  sourceResolution, sourceExtent, targetResolution, targetExtent,\n  triangulation, sources, gutter, opt_renderEdges) {\n\n  const context = createCanvasContext2D(Math.round(pixelRatio * width),\n    Math.round(pixelRatio * height));\n\n  if (sources.length === 0) {\n    return context.canvas;\n  }\n\n  context.scale(pixelRatio, pixelRatio);\n\n  const sourceDataExtent = createEmpty();\n  sources.forEach(function(src, i, arr) {\n    extend(sourceDataExtent, src.extent);\n  });\n\n  const canvasWidthInUnits = getWidth(sourceDataExtent);\n  const canvasHeightInUnits = getHeight(sourceDataExtent);\n  const stitchContext = createCanvasContext2D(\n    Math.round(pixelRatio * canvasWidthInUnits / sourceResolution),\n    Math.round(pixelRatio * canvasHeightInUnits / sourceResolution));\n\n  const stitchScale = pixelRatio / sourceResolution;\n\n  sources.forEach(function(src, i, arr) {\n    const xPos = src.extent[0] - sourceDataExtent[0];\n    const yPos = -(src.extent[3] - sourceDataExtent[3]);\n    const srcWidth = getWidth(src.extent);\n    const srcHeight = getHeight(src.extent);\n\n    stitchContext.drawImage(\n      src.image,\n      gutter, gutter,\n      src.image.width - 2 * gutter, src.image.height - 2 * gutter,\n      xPos * stitchScale, yPos * stitchScale,\n      srcWidth * stitchScale, srcHeight * stitchScale);\n  });\n\n  const targetTopLeft = getTopLeft(targetExtent);\n\n  triangulation.getTriangles().forEach(function(triangle, i, arr) {\n    /* Calculate affine transform (src -> dst)\n     * Resulting matrix can be used to transform coordinate\n     * from `sourceProjection` to destination pixels.\n     *\n     * To optimize number of context calls and increase numerical stability,\n     * we also do the following operations:\n     * trans(-topLeftExtentCorner), scale(1 / targetResolution), scale(1, -1)\n     * here before solving the linear system so [ui, vi] are pixel coordinates.\n     *\n     * Src points: xi, yi\n     * Dst points: ui, vi\n     * Affine coefficients: aij\n     *\n     * | x0 y0 1  0  0 0 |   |a00|   |u0|\n     * | x1 y1 1  0  0 0 |   |a01|   |u1|\n     * | x2 y2 1  0  0 0 | x |a02| = |u2|\n     * |  0  0 0 x0 y0 1 |   |a10|   |v0|\n     * |  0  0 0 x1 y1 1 |   |a11|   |v1|\n     * |  0  0 0 x2 y2 1 |   |a12|   |v2|\n     */\n    const source = triangle.source;\n    const target = triangle.target;\n    let x0 = source[0][0], y0 = source[0][1];\n    let x1 = source[1][0], y1 = source[1][1];\n    let x2 = source[2][0], y2 = source[2][1];\n    const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n    const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n    const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n    const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n    const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n    const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n    // Shift all the source points to improve numerical stability\n    // of all the subsequent calculations. The [x0, y0] is used here.\n    // This is also used to simplify the linear system.\n    const sourceNumericalShiftX = x0;\n    const sourceNumericalShiftY = y0;\n    x0 = 0;\n    y0 = 0;\n    x1 -= sourceNumericalShiftX;\n    y1 -= sourceNumericalShiftY;\n    x2 -= sourceNumericalShiftX;\n    y2 -= sourceNumericalShiftY;\n\n    const augmentedMatrix = [\n      [x1, y1, 0, 0, u1 - u0],\n      [x2, y2, 0, 0, u2 - u0],\n      [0, 0, x1, y1, v1 - v0],\n      [0, 0, x2, y2, v2 - v0]\n    ];\n    const affineCoefs = solveLinearSystem(augmentedMatrix);\n    if (!affineCoefs) {\n      return;\n    }\n\n    context.save();\n    context.beginPath();\n    const centroidX = (u0 + u1 + u2) / 3;\n    const centroidY = (v0 + v1 + v2) / 3;\n    const p0 = enlargeClipPoint(centroidX, centroidY, u0, v0);\n    const p1 = enlargeClipPoint(centroidX, centroidY, u1, v1);\n    const p2 = enlargeClipPoint(centroidX, centroidY, u2, v2);\n\n    context.moveTo(p1[0], p1[1]);\n    context.lineTo(p0[0], p0[1]);\n    context.lineTo(p2[0], p2[1]);\n    context.clip();\n\n    context.transform(\n      affineCoefs[0], affineCoefs[2], affineCoefs[1], affineCoefs[3], u0, v0);\n\n    context.translate(sourceDataExtent[0] - sourceNumericalShiftX,\n      sourceDataExtent[3] - sourceNumericalShiftY);\n\n    context.scale(sourceResolution / pixelRatio,\n      -sourceResolution / pixelRatio);\n\n    context.drawImage(stitchContext.canvas, 0, 0);\n    context.restore();\n  });\n\n  if (opt_renderEdges) {\n    context.save();\n\n    context.strokeStyle = 'black';\n    context.lineWidth = 1;\n\n    triangulation.getTriangles().forEach(function(triangle, i, arr) {\n      const target = triangle.target;\n      const u0 = (target[0][0] - targetTopLeft[0]) / targetResolution;\n      const v0 = -(target[0][1] - targetTopLeft[1]) / targetResolution;\n      const u1 = (target[1][0] - targetTopLeft[0]) / targetResolution;\n      const v1 = -(target[1][1] - targetTopLeft[1]) / targetResolution;\n      const u2 = (target[2][0] - targetTopLeft[0]) / targetResolution;\n      const v2 = -(target[2][1] - targetTopLeft[1]) / targetResolution;\n\n      context.beginPath();\n      context.moveTo(u1, v1);\n      context.lineTo(u0, v0);\n      context.lineTo(u2, v2);\n      context.closePath();\n      context.stroke();\n    });\n\n    context.restore();\n  }\n  return context.canvas;\n}\n","/**\n * @module ol/rotationconstraint\n */\nimport {toRadians} from './math.js';\n\n\n/**\n * @typedef {function((number|undefined), boolean=): (number|undefined)} Type\n */\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @return {number|undefined} Rotation.\n */\nexport function disable(rotation) {\n  if (rotation !== undefined) {\n    return 0;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number|undefined} rotation Rotation.\n * @return {number|undefined} Rotation.\n */\nexport function none(rotation) {\n  if (rotation !== undefined) {\n    return rotation;\n  } else {\n    return undefined;\n  }\n}\n\n\n/**\n * @param {number} n N.\n * @return {Type} Rotation constraint.\n */\nexport function createSnapToN(n) {\n  const theta = 2 * Math.PI / n;\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {boolean=} opt_isMoving True if an interaction or animation is in progress.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, opt_isMoving) {\n      if (opt_isMoving) {\n        return rotation;\n      }\n\n      if (rotation !== undefined) {\n        rotation = Math.floor(rotation / theta + 0.5) * theta;\n        return rotation;\n      } else {\n        return undefined;\n      }\n    });\n}\n\n\n/**\n * @param {number=} opt_tolerance Tolerance.\n * @return {Type} Rotation constraint.\n */\nexport function createSnapToZero(opt_tolerance) {\n  const tolerance = opt_tolerance || toRadians(5);\n  return (\n    /**\n     * @param {number|undefined} rotation Rotation.\n     * @param {boolean} opt_isMoving True if an interaction or animation is in progress.\n     * @return {number|undefined} Rotation.\n     */\n    function(rotation, opt_isMoving) {\n      if (opt_isMoving) {\n        return rotation;\n      }\n\n      if (rotation !== undefined) {\n        if (Math.abs(rotation) <= tolerance) {\n          return 0;\n        } else {\n          return rotation;\n        }\n      } else {\n        return undefined;\n      }\n    });\n}\n","/**\n * @module ol/MapBrowserPointerEvent\n */\nimport MapBrowserEvent from './MapBrowserEvent.js';\n\nclass MapBrowserPointerEvent extends MapBrowserEvent {\n\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./PluggableMap.js\").default} map Map.\n   * @param {PointerEvent} pointerEvent Pointer event.\n   * @param {boolean=} opt_dragging Is the map currently being dragged?\n   * @param {?import(\"./PluggableMap.js\").FrameState=} opt_frameState Frame state.\n   */\n  constructor(type, map, pointerEvent, opt_dragging, opt_frameState) {\n\n    super(type, map, pointerEvent, opt_dragging, opt_frameState);\n\n    /**\n     * @const\n     * @type {PointerEvent}\n     */\n    this.pointerEvent = pointerEvent;\n\n  }\n\n}\n\nexport default MapBrowserPointerEvent;\n","/**\n * @module ol/layer/TileProperty\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  PRELOAD: 'preload',\n  USE_INTERIM_TILES_ON_ERROR: 'useInterimTilesOnError'\n};\n","/**\n * @module ol/source/common\n */\n\n/**\n * Default WMS version.\n * @type {string}\n */\nexport const DEFAULT_WMS_VERSION = '1.3.0';\n","/**\n * @module ol/source/WMSServerType\n */\n\n/**\n * Available server types: `'carmentaserver'`, `'geoserver'`, `'mapserver'`,\n *     `'qgis'`. These are servers that have vendor parameters beyond the WMS\n *     specification that OpenLayers can make use of.\n * @enum {string}\n */\nexport default {\n  /**\n   * HiDPI support for [Carmenta Server](https://www.carmenta.com/en/products/carmenta-server)\n   * @api\n   */\n  CARMENTA_SERVER: 'carmentaserver',\n  /**\n   * HiDPI support for [GeoServer](https://geoserver.org/)\n   * @api\n   */\n  GEOSERVER: 'geoserver',\n  /**\n   * HiDPI support for [MapServer](https://mapserver.org/)\n   * @api\n   */\n  MAPSERVER: 'mapserver',\n  /**\n   * HiDPI support for [QGIS](https://qgis.org/)\n   * @api\n   */\n  QGIS: 'qgis'\n};\n","/**\n * @module ol/source/Source\n */\nimport {abstract} from '../util.js';\nimport BaseObject from '../Object.js';\nimport {get as getProjection} from '../proj.js';\nimport SourceState from './State.js';\n\n\n/**\n * A function that returns a string or an array of strings representing source\n * attributions.\n *\n * @typedef {function(import(\"../PluggableMap.js\").FrameState): (string|Array<string>)} Attribution\n */\n\n\n/**\n * A type that can be used to provide attribution information for data sources.\n *\n * It represents either\n * * a simple string (e.g. `'© Acme Inc.'`)\n * * an array of simple strings (e.g. `['© Acme Inc.', '© Bacme Inc.']`)\n * * a function that returns a string or array of strings ({@link module:ol/source/Source~Attribution})\n *\n * @typedef {string|Array<string>|Attribution} AttributionLike\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {AttributionLike} [attributions]\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {SourceState} [state='ready']\n * @property {boolean} [wrapX=false]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for {@link module:ol/layer/Layer~Layer} sources.\n *\n * A generic `change` event is triggered when the state of the source changes.\n * @abstract\n * @api\n */\nclass Source extends BaseObject {\n  /**\n   * @param {Options} options Source options.\n   */\n  constructor(options) {\n\n    super();\n\n    /**\n     * @private\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.projection_ = getProjection(options.projection);\n\n    /**\n     * @private\n     * @type {?Attribution}\n     */\n    this.attributions_ = adaptAttributions(options.attributions);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.attributionsCollapsible_ = options.attributionsCollapsible !== undefined ?\n      options.attributionsCollapsible : true;\n\n    /**\n     * This source is currently loading data. Sources that defer loading to the\n     * map's tile queue never set this to `true`.\n     * @type {boolean}\n     */\n    this.loading = false;\n\n    /**\n     * @private\n     * @type {SourceState}\n     */\n    this.state_ = options.state !== undefined ?\n      options.state : SourceState.READY;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.wrapX_ = options.wrapX !== undefined ? options.wrapX : false;\n\n  }\n\n  /**\n   * Get the attribution function for the source.\n   * @return {?Attribution} Attribution function.\n   */\n  getAttributions() {\n    return this.attributions_;\n  }\n\n  /**\n   * @return {boolean} Attributions are collapsible.\n   */\n  getAttributionsCollapsible() {\n    return this.attributionsCollapsible_;\n  }\n\n  /**\n   * Get the projection of the source.\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   * @api\n   */\n  getProjection() {\n    return this.projection_;\n  }\n\n  /**\n   * @abstract\n   * @return {Array<number>|undefined} Resolutions.\n   */\n  getResolutions() {\n    return abstract();\n  }\n\n  /**\n   * Get the state of the source, see {@link module:ol/source/State~State} for possible states.\n   * @return {SourceState} State.\n   * @api\n   */\n  getState() {\n    return this.state_;\n  }\n\n  /**\n   * @return {boolean|undefined} Wrap X.\n   */\n  getWrapX() {\n    return this.wrapX_;\n  }\n\n  /**\n   * Refreshes the source. The source will be cleared, and data from the server will be reloaded.\n   * @api\n   */\n  refresh() {\n    this.changed();\n  }\n\n  /**\n   * Set the attributions of the source.\n   * @param {AttributionLike|undefined} attributions Attributions.\n   *     Can be passed as `string`, `Array<string>`, {@link module:ol/source/Source~Attribution},\n   *     or `undefined`.\n   * @api\n   */\n  setAttributions(attributions) {\n    this.attributions_ = adaptAttributions(attributions);\n    this.changed();\n  }\n\n  /**\n   * Set the state of the source.\n   * @param {SourceState} state State.\n   * @protected\n   */\n  setState(state) {\n    this.state_ = state;\n    this.changed();\n  }\n}\n\n\n/**\n * Turns the attributions option into an attributions function.\n * @param {AttributionLike|undefined} attributionLike The attribution option.\n * @return {?Attribution} An attribution function (or null).\n */\nfunction adaptAttributions(attributionLike) {\n  if (!attributionLike) {\n    return null;\n  }\n  if (Array.isArray(attributionLike)) {\n    return function(frameState) {\n      return attributionLike;\n    };\n  }\n\n  if (typeof attributionLike === 'function') {\n    return attributionLike;\n  }\n\n  return function(frameState) {\n    return [attributionLike];\n  };\n}\n\n\nexport default Source;\n","/**\n * @module ol/geom/GeometryCollection\n */\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {createOrUpdateEmpty, closestSquaredDistanceXY, extend, getCenter} from '../extent.js';\nimport Geometry from './Geometry.js';\nimport GeometryType from './GeometryType.js';\n\n/**\n * @classdesc\n * An array of {@link module:ol/geom/Geometry} objects.\n *\n * @api\n */\nclass GeometryCollection extends Geometry {\n\n  /**\n   * @param {Array<Geometry>=} opt_geometries Geometries.\n   */\n  constructor(opt_geometries) {\n\n    super();\n\n    /**\n     * @private\n     * @type {Array<Geometry>}\n     */\n    this.geometries_ = opt_geometries ? opt_geometries : null;\n\n    /**\n     * @type {Array<import(\"../events.js\").EventsKey>}\n     */\n    this.changeEventsKeys_ = [];\n\n    this.listenGeometriesChange_();\n  }\n\n  /**\n   * @private\n   */\n  unlistenGeometriesChange_() {\n    this.changeEventsKeys_.forEach(unlistenByKey);\n    this.changeEventsKeys_.length = 0;\n  }\n\n  /**\n   * @private\n   */\n  listenGeometriesChange_() {\n    if (!this.geometries_) {\n      return;\n    }\n    for (let i = 0, ii = this.geometries_.length; i < ii; ++i) {\n      this.changeEventsKeys_.push(listen(\n        this.geometries_[i], EventType.CHANGE,\n        this.changed, this));\n    }\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!GeometryCollection} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    const geometryCollection = new GeometryCollection(null);\n    geometryCollection.setGeometries(this.geometries_);\n    return geometryCollection;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    if (minSquaredDistance < closestSquaredDistanceXY(this.getExtent(), x, y)) {\n      return minSquaredDistance;\n    }\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      minSquaredDistance = geometries[i].closestPointXY(\n        x, y, closestPoint, minSquaredDistance);\n    }\n    return minSquaredDistance;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  containsXY(x, y) {\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      if (geometries[i].containsXY(x, y)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  computeExtent(extent) {\n    createOrUpdateEmpty(extent);\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      extend(extent, geometries[i].getExtent());\n    }\n    return extent;\n  }\n\n  /**\n   * Return the geometries that make up this geometry collection.\n   * @return {Array<Geometry>} Geometries.\n   * @api\n   */\n  getGeometries() {\n    return cloneGeometries(this.geometries_);\n  }\n\n  /**\n   * @return {Array<Geometry>} Geometries.\n   */\n  getGeometriesArray() {\n    return this.geometries_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSimplifiedGeometry(squaredTolerance) {\n    if (this.simplifiedGeometryRevision !== this.getRevision()) {\n      this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n      this.simplifiedGeometryRevision = this.getRevision();\n    }\n    if (squaredTolerance < 0 ||\n        (this.simplifiedGeometryMaxMinSquaredTolerance !== 0 &&\n         squaredTolerance < this.simplifiedGeometryMaxMinSquaredTolerance)) {\n      return this;\n    }\n\n    const simplifiedGeometries = [];\n    const geometries = this.geometries_;\n    let simplified = false;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      const geometry = geometries[i];\n      const simplifiedGeometry = geometry.getSimplifiedGeometry(squaredTolerance);\n      simplifiedGeometries.push(simplifiedGeometry);\n      if (simplifiedGeometry !== geometry) {\n        simplified = true;\n      }\n    }\n    if (simplified) {\n      const simplifiedGeometryCollection = new GeometryCollection(null);\n      simplifiedGeometryCollection.setGeometriesArray(simplifiedGeometries);\n      return simplifiedGeometryCollection;\n    } else {\n      this.simplifiedGeometryMaxMinSquaredTolerance = squaredTolerance;\n      return this;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.GEOMETRY_COLLECTION;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      if (geometries[i].intersectsExtent(extent)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * @return {boolean} Is empty.\n   */\n  isEmpty() {\n    return this.geometries_.length === 0;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  rotate(angle, anchor) {\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      geometries[i].rotate(angle, anchor);\n    }\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  scale(sx, opt_sy, opt_anchor) {\n    let anchor = opt_anchor;\n    if (!anchor) {\n      anchor = getCenter(this.getExtent());\n    }\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      geometries[i].scale(sx, opt_sy, anchor);\n    }\n    this.changed();\n  }\n\n  /**\n   * Set the geometries that make up this geometry collection.\n   * @param {Array<Geometry>} geometries Geometries.\n   * @api\n   */\n  setGeometries(geometries) {\n    this.setGeometriesArray(cloneGeometries(geometries));\n  }\n\n  /**\n   * @param {Array<Geometry>} geometries Geometries.\n   */\n  setGeometriesArray(geometries) {\n    this.unlistenGeometriesChange_();\n    this.geometries_ = geometries;\n    this.listenGeometriesChange_();\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  applyTransform(transformFn) {\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      geometries[i].applyTransform(transformFn);\n    }\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  translate(deltaX, deltaY) {\n    const geometries = this.geometries_;\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      geometries[i].translate(deltaX, deltaY);\n    }\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.unlistenGeometriesChange_();\n    super.disposeInternal();\n  }\n}\n\n\n/**\n * @param {Array<Geometry>} geometries Geometries.\n * @return {Array<Geometry>} Cloned geometries.\n */\nfunction cloneGeometries(geometries) {\n  const clonedGeometries = [];\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    clonedGeometries.push(geometries[i].clone());\n  }\n  return clonedGeometries;\n}\n\n\nexport default GeometryCollection;\n","/**\n * @module ol/geom/flat/interpolate\n */\nimport {binarySearch} from '../../array.js';\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} fraction Fraction.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Destination.\n */\nexport function interpolatePoint(flatCoordinates, offset, end, stride, fraction, opt_dest) {\n  let pointX = NaN;\n  let pointY = NaN;\n  const n = (end - offset) / stride;\n  if (n === 1) {\n    pointX = flatCoordinates[offset];\n    pointY = flatCoordinates[offset + 1];\n  } else if (n == 2) {\n    pointX = (1 - fraction) * flatCoordinates[offset] +\n        fraction * flatCoordinates[offset + stride];\n    pointY = (1 - fraction) * flatCoordinates[offset + 1] +\n        fraction * flatCoordinates[offset + stride + 1];\n  } else if (n !== 0) {\n    let x1 = flatCoordinates[offset];\n    let y1 = flatCoordinates[offset + 1];\n    let length = 0;\n    const cumulativeLengths = [0];\n    for (let i = offset + stride; i < end; i += stride) {\n      const x2 = flatCoordinates[i];\n      const y2 = flatCoordinates[i + 1];\n      length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n      cumulativeLengths.push(length);\n      x1 = x2;\n      y1 = y2;\n    }\n    const target = fraction * length;\n    const index = binarySearch(cumulativeLengths, target);\n    if (index < 0) {\n      const t = (target - cumulativeLengths[-index - 2]) /\n          (cumulativeLengths[-index - 1] - cumulativeLengths[-index - 2]);\n      const o = offset + (-index - 2) * stride;\n      pointX = lerp(\n        flatCoordinates[o], flatCoordinates[o + stride], t);\n      pointY = lerp(\n        flatCoordinates[o + 1], flatCoordinates[o + stride + 1], t);\n    } else {\n      pointX = flatCoordinates[offset + index * stride];\n      pointY = flatCoordinates[offset + index * stride + 1];\n    }\n  }\n  if (opt_dest) {\n    opt_dest[0] = pointX;\n    opt_dest[1] = pointY;\n    return opt_dest;\n  } else {\n    return [pointX, pointY];\n  }\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @return {import(\"../../coordinate.js\").Coordinate} Coordinate.\n */\nexport function lineStringCoordinateAtM(flatCoordinates, offset, end, stride, m, extrapolate) {\n  if (end == offset) {\n    return null;\n  }\n  let coordinate;\n  if (m < flatCoordinates[offset + stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(offset, offset + stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  } else if (flatCoordinates[end - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(end - stride, end);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  // FIXME use O(1) search\n  if (m == flatCoordinates[offset + stride - 1]) {\n    return flatCoordinates.slice(offset, offset + stride);\n  }\n  let lo = offset / stride;\n  let hi = end / stride;\n  while (lo < hi) {\n    const mid = (lo + hi) >> 1;\n    if (m < flatCoordinates[(mid + 1) * stride - 1]) {\n      hi = mid;\n    } else {\n      lo = mid + 1;\n    }\n  }\n  const m0 = flatCoordinates[lo * stride - 1];\n  if (m == m0) {\n    return flatCoordinates.slice((lo - 1) * stride, (lo - 1) * stride + stride);\n  }\n  const m1 = flatCoordinates[(lo + 1) * stride - 1];\n  const t = (m - m0) / (m1 - m0);\n  coordinate = [];\n  for (let i = 0; i < stride - 1; ++i) {\n    coordinate.push(lerp(flatCoordinates[(lo - 1) * stride + i],\n      flatCoordinates[lo * stride + i], t));\n  }\n  coordinate.push(m);\n  return coordinate;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {number} m M.\n * @param {boolean} extrapolate Extrapolate.\n * @param {boolean} interpolate Interpolate.\n * @return {import(\"../../coordinate.js\").Coordinate} Coordinate.\n */\nexport function lineStringsCoordinateAtM(\n  flatCoordinates, offset, ends, stride, m, extrapolate, interpolate) {\n  if (interpolate) {\n    return lineStringCoordinateAtM(\n      flatCoordinates, offset, ends[ends.length - 1], stride, m, extrapolate);\n  }\n  let coordinate;\n  if (m < flatCoordinates[stride - 1]) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(0, stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  if (flatCoordinates[flatCoordinates.length - 1] < m) {\n    if (extrapolate) {\n      coordinate = flatCoordinates.slice(flatCoordinates.length - stride);\n      coordinate[stride - 1] = m;\n      return coordinate;\n    } else {\n      return null;\n    }\n  }\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    if (offset == end) {\n      continue;\n    }\n    if (m < flatCoordinates[offset + stride - 1]) {\n      return null;\n    } else if (m <= flatCoordinates[end - 1]) {\n      return lineStringCoordinateAtM(\n        flatCoordinates, offset, end, stride, m, false);\n    }\n    offset = end;\n  }\n  return null;\n}\n","/**\n * @module ol/format/XLink\n */\n\n\n/**\n * @const\n * @type {string}\n */\nconst NAMESPACE_URI = 'http://www.w3.org/1999/xlink';\n\n\n/**\n * @param {Element} node Node.\n * @return {string|undefined} href.\n */\nexport function readHref(node) {\n  return node.getAttributeNS(NAMESPACE_URI, 'href');\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar WOFF = 'application/font-woff';\nvar JPEG = 'image/jpeg';\nvar mimes = {\n    woff: WOFF,\n    woff2: WOFF,\n    ttf: 'application/font-truetype',\n    eot: 'application/vnd.ms-fontobject',\n    png: 'image/png',\n    jpg: JPEG,\n    jpeg: JPEG,\n    gif: 'image/gif',\n    tiff: 'image/tiff',\n    svg: 'image/svg+xml',\n};\nexports.uuid = (function uuid() {\n    // generate uuid for className of pseudo elements.\n    // We should not use GUIDs, otherwise pseudo elements sometimes cannot be captured.\n    var counter = 0;\n    // ref: http://stackoverflow.com/a/6248722/2519373\n    var randomFourChars = function () {\n        return (\"0000\" + (Math.random() * (Math.pow(36, 4)) << 0).toString(36)).slice(-4);\n    };\n    return function () {\n        counter += 1;\n        return \"u\" + randomFourChars() + counter;\n    };\n}());\nfunction parseExtension(url) {\n    var match = /\\.([^./]*?)$/g.exec(url);\n    if (match)\n        return match[1];\n    return '';\n}\nexports.parseExtension = parseExtension;\nfunction getMimeType(url) {\n    var ext = parseExtension(url).toLowerCase();\n    return mimes[ext] || '';\n}\nexports.getMimeType = getMimeType;\nfunction delay(ms) {\n    return function (args) { return new Promise((function (resolve) {\n        setTimeout(function () {\n            resolve(args);\n        }, ms);\n    })); };\n}\nexports.delay = delay;\nfunction createImage(url) {\n    return new Promise((function (resolve, reject) {\n        var image = new Image();\n        image.onload = function () {\n            resolve(image);\n        };\n        image.onerror = reject;\n        image.crossOrigin = 'anonymous';\n        image.src = url;\n    }));\n}\nexports.createImage = createImage;\nfunction isDataUrl(url) {\n    return url.search(/^(data:)/) !== -1;\n}\nexports.isDataUrl = isDataUrl;\nfunction toDataURL(content, mimeType) {\n    return \"data:\" + mimeType + \";base64,\" + content;\n}\nexports.toDataURL = toDataURL;\nfunction getDataURLContent(dataURL) {\n    return dataURL.split(/,/)[1];\n}\nexports.getDataURLContent = getDataURLContent;\nfunction toBlob(canvas) {\n    return new Promise((function (resolve) {\n        var binaryString = window.atob(canvas.toDataURL().split(',')[1]);\n        var len = binaryString.length;\n        var binaryArray = new Uint8Array(len);\n        for (var i = 0; i < len; i += 1) {\n            binaryArray[i] = binaryString.charCodeAt(i);\n        }\n        resolve(new Blob([binaryArray], {\n            type: 'image/png',\n        }));\n    }));\n}\nfunction canvasToBlob(canvas) {\n    if (canvas.toBlob) {\n        return new Promise((function (resolve) {\n            canvas.toBlob(resolve);\n        }));\n    }\n    return toBlob(canvas);\n}\nexports.canvasToBlob = canvasToBlob;\nfunction toArray(arrayLike) {\n    var arr = [];\n    for (var i = 0, l = arrayLike.length; i < l; i += 1) {\n        arr.push(arrayLike[i]);\n    }\n    return arr;\n}\nexports.toArray = toArray;\nfunction px(node, styleProperty) {\n    var value = window.getComputedStyle(node).getPropertyValue(styleProperty);\n    return parseFloat(value.replace('px', ''));\n}\nfunction getNodeWidth(node) {\n    var leftBorder = px(node, 'border-left-width');\n    var rightBorder = px(node, 'border-right-width');\n    return node.scrollWidth + leftBorder + rightBorder;\n}\nexports.getNodeWidth = getNodeWidth;\nfunction getNodeHeight(node) {\n    var topBorder = px(node, 'border-top-width');\n    var bottomBorder = px(node, 'border-bottom-width');\n    return node.scrollHeight + topBorder + bottomBorder;\n}\nexports.getNodeHeight = getNodeHeight;\nfunction getPixelRatio() {\n    return (window.devicePixelRatio || 1);\n}\nexports.getPixelRatio = getPixelRatio;\nfunction svgToDataURL(svg) {\n    return Promise.resolve()\n        .then(function () { return new XMLSerializer().serializeToString(svg); })\n        .then(encodeURIComponent)\n        .then(function (html) { return \"data:image/svg+xml;charset=utf-8,\" + html; });\n}\nexports.svgToDataURL = svgToDataURL;\nfunction getBlobFromImageURL(url) {\n    return createImage(url).then(function (image) {\n        var width = image.width, height = image.height;\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        var ratio = getPixelRatio();\n        canvas.width = width * ratio;\n        canvas.height = height * ratio;\n        canvas.style.width = \"\" + width;\n        canvas.style.height = \"\" + height;\n        context.scale(ratio, ratio);\n        context.drawImage(image, 0, 0);\n        var dataURL = canvas.toDataURL(getMimeType(url));\n        return getDataURLContent(dataURL);\n    });\n}\nexports.getBlobFromImageURL = getBlobFromImageURL;\n","/**\n * @module ol/geom/flat/intersectsextent\n */\nimport {containsExtent, createEmpty, extendFlatCoordinates, intersects, intersectsSegment} from '../../extent.js';\nimport {linearRingContainsXY, linearRingContainsExtent} from './contains.js';\nimport {forEach as forEachSegment} from './segments.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineString(flatCoordinates, offset, end, stride, extent) {\n  const coordinatesExtent = extendFlatCoordinates(\n    createEmpty(), flatCoordinates, offset, end, stride);\n  if (!intersects(extent, coordinatesExtent)) {\n    return false;\n  }\n  if (containsExtent(extent, coordinatesExtent)) {\n    return true;\n  }\n  if (coordinatesExtent[0] >= extent[0] &&\n      coordinatesExtent[2] <= extent[2]) {\n    return true;\n  }\n  if (coordinatesExtent[1] >= extent[1] &&\n      coordinatesExtent[3] <= extent[3]) {\n    return true;\n  }\n  return forEachSegment(flatCoordinates, offset, end, stride,\n    /**\n     * @param {import(\"../../coordinate.js\").Coordinate} point1 Start point.\n     * @param {import(\"../../coordinate.js\").Coordinate} point2 End point.\n     * @return {boolean} `true` if the segment and the extent intersect,\n     *     `false` otherwise.\n     */\n    function(point1, point2) {\n      return intersectsSegment(extent, point1, point2);\n    });\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLineStringArray(flatCoordinates, offset, ends, stride, extent) {\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    if (intersectsLineString(\n      flatCoordinates, offset, ends[i], stride, extent)) {\n      return true;\n    }\n    offset = ends[i];\n  }\n  return false;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRing(flatCoordinates, offset, end, stride, extent) {\n  if (intersectsLineString(\n    flatCoordinates, offset, end, stride, extent)) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[0], extent[3])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[1])) {\n    return true;\n  }\n  if (linearRingContainsXY(flatCoordinates, offset, end, stride, extent[2], extent[3])) {\n    return true;\n  }\n  return false;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingArray(flatCoordinates, offset, ends, stride, extent) {\n  if (!intersectsLinearRing(\n    flatCoordinates, offset, ends[0], stride, extent)) {\n    return false;\n  }\n  if (ends.length === 1) {\n    return true;\n  }\n  for (let i = 1, ii = ends.length; i < ii; ++i) {\n    if (linearRingContainsExtent(flatCoordinates, ends[i - 1], ends[i], stride, extent)) {\n      if (!intersectsLineString(flatCoordinates, ends[i - 1], ends[i], stride, extent)) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {import(\"../../extent.js\").Extent} extent Extent.\n * @return {boolean} True if the geometry and the extent intersect.\n */\nexport function intersectsLinearRingMultiArray(flatCoordinates, offset, endss, stride, extent) {\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    if (intersectsLinearRingArray(\n      flatCoordinates, offset, ends, stride, extent)) {\n      return true;\n    }\n    offset = ends[ends.length - 1];\n  }\n  return false;\n}\n","/**\n * @module ol/tilegrid/WMTS\n */\n\nimport {find} from '../array.js';\nimport {get as getProjection} from '../proj.js';\nimport TileGrid from './TileGrid.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../extent.js\").Extent} [extent] Extent for the tile grid. No tiles\n * outside this extent will be requested by {@link module:ol/source/Tile} sources.\n * When no `origin` or `origins` are configured, the `origin` will be set to the\n * top-left corner of the extent.\n * @property {import(\"../coordinate.js\").Coordinate} [origin] The tile grid origin, i.e.\n * where the `x` and `y` axes meet (`[z, 0, 0]`). Tile coordinates increase left\n * to right and upwards. If not specified, `extent` or `origins` must be provided.\n * @property {Array<import(\"../coordinate.js\").Coordinate>} [origins] Tile grid origins,\n * i.e. where the `x` and `y` axes meet (`[z, 0, 0]`), for each zoom level. If\n * given, the array length should match the length of the `resolutions` array, i.e.\n * each resolution can have a different origin. Tile coordinates increase left to\n * right and upwards. If not specified, `extent` or `origin` must be provided.\n * @property {!Array<number>} resolutions Resolutions. The array index of each\n * resolution needs to match the zoom level. This means that even if a `minZoom`\n * is configured, the resolutions array will have a length of `maxZoom + 1`\n * @property {!Array<string>} matrixIds matrix IDs. The length of this array needs\n * to match the length of the `resolutions` array.\n * @property {Array<import(\"../size.js\").Size>} [sizes] Number of tile rows and columns\n * of the grid for each zoom level. The values here are the `TileMatrixWidth` and\n * `TileMatrixHeight` advertised in the GetCapabilities response of the WMTS, and\n * define the grid's extent together with the `origin`.\n * An `extent` can be configured in addition, and will further limit the extent for\n * which tile requests are made by sources. If the bottom-left corner of\n * the `extent` is used as `origin` or `origins`, then the `y` value must be\n * negative because OpenLayers tile coordinates use the top left as the origin.\n * @property {number|import(\"../size.js\").Size} [tileSize] Tile size.\n * @property {Array<import(\"../size.js\").Size>} [tileSizes] Tile sizes. The length of\n * this array needs to match the length of the `resolutions` array.\n * @property {Array<number>} [widths] Number of tile columns that cover the grid's\n * extent for each zoom level. Only required when used with a source that has `wrapX`\n * set to `true`, and only when the grid's origin differs from the one of the\n * projection's extent. The array length has to match the length of the `resolutions`\n * array, i.e. each resolution will have a matching entry here.\n */\n\n\n/**\n * @classdesc\n * Set the grid pattern for sources accessing WMTS tiled-image servers.\n * @api\n */\nclass WMTSTileGrid extends TileGrid {\n  /**\n   * @param {Options} options WMTS options.\n   */\n  constructor(options) {\n    super({\n      extent: options.extent,\n      origin: options.origin,\n      origins: options.origins,\n      resolutions: options.resolutions,\n      tileSize: options.tileSize,\n      tileSizes: options.tileSizes,\n      sizes: options.sizes\n    });\n\n    /**\n     * @private\n     * @type {!Array<string>}\n     */\n    this.matrixIds_ = options.matrixIds;\n  }\n\n  /**\n   * @param {number} z Z.\n   * @return {string} MatrixId..\n   */\n  getMatrixId(z) {\n    return this.matrixIds_[z];\n  }\n\n  /**\n   * Get the list of matrix identifiers.\n   * @return {Array<string>} MatrixIds.\n   * @api\n   */\n  getMatrixIds() {\n    return this.matrixIds_;\n  }\n}\n\n\nexport default WMTSTileGrid;\n\n/**\n * Create a tile grid from a WMTS capabilities matrix set and an\n * optional TileMatrixSetLimits.\n * @param {Object} matrixSet An object representing a matrixSet in the\n *     capabilities document.\n * @param {import(\"../extent.js\").Extent=} opt_extent An optional extent to restrict the tile\n *     ranges the server provides.\n * @param {Array<Object>=} opt_matrixLimits An optional object representing\n *     the available matrices for tileGrid.\n * @return {WMTSTileGrid} WMTS tileGrid instance.\n * @api\n */\nexport function createFromCapabilitiesMatrixSet(matrixSet, opt_extent, opt_matrixLimits) {\n\n  /** @type {!Array<number>} */\n  const resolutions = [];\n  /** @type {!Array<string>} */\n  const matrixIds = [];\n  /** @type {!Array<import(\"../coordinate.js\").Coordinate>} */\n  const origins = [];\n  /** @type {!Array<import(\"../size.js\").Size>} */\n  const tileSizes = [];\n  /** @type {!Array<import(\"../size.js\").Size>} */\n  const sizes = [];\n\n  const matrixLimits = opt_matrixLimits !== undefined ? opt_matrixLimits : [];\n\n  const supportedCRSPropName = 'SupportedCRS';\n  const matrixIdsPropName = 'TileMatrix';\n  const identifierPropName = 'Identifier';\n  const scaleDenominatorPropName = 'ScaleDenominator';\n  const topLeftCornerPropName = 'TopLeftCorner';\n  const tileWidthPropName = 'TileWidth';\n  const tileHeightPropName = 'TileHeight';\n\n  const code = matrixSet[supportedCRSPropName];\n  const projection = getProjection(code.replace(/urn:ogc:def:crs:(\\w+):(.*:)?(\\w+)$/, '$1:$3')) ||\n      getProjection(code);\n  const metersPerUnit = projection.getMetersPerUnit();\n  // swap origin x and y coordinates if axis orientation is lat/long\n  const switchOriginXY = projection.getAxisOrientation().substr(0, 2) == 'ne';\n\n  matrixSet[matrixIdsPropName].sort(function(a, b) {\n    return b[scaleDenominatorPropName] - a[scaleDenominatorPropName];\n  });\n\n  matrixSet[matrixIdsPropName].forEach(function(elt) {\n\n    let matrixAvailable;\n    // use of matrixLimits to filter TileMatrices from GetCapabilities\n    // TileMatrixSet from unavailable matrix levels.\n    if (matrixLimits.length > 0) {\n      matrixAvailable = find(matrixLimits, function(elt_ml) {\n        if (elt[identifierPropName] == elt_ml[matrixIdsPropName]) {\n          return true;\n        }\n        // Fallback for tileMatrix identifiers that don't get prefixed\n        // by their tileMatrixSet identifiers.\n        if (elt[identifierPropName].indexOf(':') === -1) {\n          return matrixSet[identifierPropName] + ':' + elt[identifierPropName] === elt_ml[matrixIdsPropName];\n        }\n        return false;\n      });\n    } else {\n      matrixAvailable = true;\n    }\n\n    if (matrixAvailable) {\n      matrixIds.push(elt[identifierPropName]);\n      const resolution = elt[scaleDenominatorPropName] * 0.28E-3 / metersPerUnit;\n      const tileWidth = elt[tileWidthPropName];\n      const tileHeight = elt[tileHeightPropName];\n      if (switchOriginXY) {\n        origins.push([elt[topLeftCornerPropName][1],\n          elt[topLeftCornerPropName][0]]);\n      } else {\n        origins.push(elt[topLeftCornerPropName]);\n      }\n      resolutions.push(resolution);\n      tileSizes.push(tileWidth == tileHeight ?\n        tileWidth : [tileWidth, tileHeight]);\n      sizes.push([elt['MatrixWidth'], elt['MatrixHeight']]);\n    }\n  });\n\n  return new WMTSTileGrid({\n    extent: opt_extent,\n    origins: origins,\n    resolutions: resolutions,\n    matrixIds: matrixIds,\n    tileSizes: tileSizes,\n    sizes: sizes\n  });\n}\n","/**\n * @module ol/webgl\n */\n\n\n/**\n * Constants taken from goog.webgl\n */\n\n/**\n * Used by {@link module:ol/webgl/Helper~WebGLHelper} for buffers containing vertices data, such as\n * position, color, texture coordinate, etc. These vertices are then referenced by an index buffer\n * to be drawn on screen (see {@link module:ol/webgl.ELEMENT_ARRAY_BUFFER}).\n * @const\n * @type {number}\n * @api\n */\nexport const ARRAY_BUFFER = 0x8892;\n\n\n/**\n * Used by {@link module:ol/webgl/Helper~WebGLHelper} for buffers containing indices data.\n * Index buffers are essentially lists of references to vertices defined in a vertex buffer\n * (see {@link module:ol/webgl.ARRAY_BUFFER}), and define the primitives (triangles) to be drawn.\n * @const\n * @type {number}\n * @api\n */\nexport const ELEMENT_ARRAY_BUFFER = 0x8893;\n\n\n/**\n * Used by {link module:ol/webgl/Buffer~WebGLArrayBuffer}.\n * @const\n * @type {number}\n * @api\n */\nexport const STREAM_DRAW = 0x88E0;\n\n\n/**\n * Used by {link module:ol/webgl/Buffer~WebGLArrayBuffer}.\n * @const\n * @type {number}\n * @api\n */\nexport const STATIC_DRAW = 0x88E4;\n\n\n/**\n * Used by {link module:ol/webgl/Buffer~WebGLArrayBuffer}.\n * @const\n * @type {number}\n * @api\n */\nexport const DYNAMIC_DRAW = 0x88E8;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_BYTE = 0x1401;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_SHORT = 0x1403;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const UNSIGNED_INT = 0x1405;\n\n\n/**\n * @const\n * @type {number}\n */\nexport const FLOAT = 0x1406;\n\n/** end of goog.webgl constants\n */\n\n\n/**\n * @const\n * @type {Array<string>}\n */\nconst CONTEXT_IDS = [\n  'experimental-webgl',\n  'webgl',\n  'webkit-3d',\n  'moz-webgl'\n];\n\n\n/**\n * @param {HTMLCanvasElement} canvas Canvas.\n * @param {Object=} opt_attributes Attributes.\n * @return {WebGLRenderingContext} WebGL rendering context.\n */\nexport function getContext(canvas, opt_attributes) {\n  const ii = CONTEXT_IDS.length;\n  for (let i = 0; i < ii; ++i) {\n    try {\n      const context = canvas.getContext(CONTEXT_IDS[i], opt_attributes);\n      if (context) {\n        return /** @type {!WebGLRenderingContext} */ (context);\n      }\n    } catch (e) {\n      // pass\n    }\n  }\n  return null;\n}\n\n/**\n * @type {Array<string>}\n */\nlet supportedExtensions;\n\n/**\n * @return {Array<string>} List of supported WebGL extensions.\n */\nexport function getSupportedExtensions() {\n  if (!supportedExtensions) {\n    const canvas = document.createElement('canvas');\n    const gl = getContext(canvas);\n    if (gl) {\n      supportedExtensions = gl.getSupportedExtensions();\n    }\n  }\n  return supportedExtensions;\n}\n","/**\n * @module ol/webgl/Buffer\n */\nimport {STATIC_DRAW, STREAM_DRAW, DYNAMIC_DRAW} from '../webgl.js';\nimport {ARRAY_BUFFER, ELEMENT_ARRAY_BUFFER} from '../webgl.js';\nimport {assert} from '../asserts.js';\n\n/**\n * Used to describe the intended usage for the data: `STATIC_DRAW`, `STREAM_DRAW`\n * or `DYNAMIC_DRAW`.\n * @enum {number}\n */\nexport const BufferUsage = {\n  STATIC_DRAW: STATIC_DRAW,\n  STREAM_DRAW: STREAM_DRAW,\n  DYNAMIC_DRAW: DYNAMIC_DRAW\n};\n\n/**\n * @classdesc\n * Object used to store an array of data as well as usage information for that data.\n * Stores typed arrays internally, either Float32Array or Uint16/32Array depending on\n * the buffer type (ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER) and available extensions.\n *\n * To populate the array, you can either use:\n * * A size using `#ofSize(buffer)`\n * * An `ArrayBuffer` object using `#fromArrayBuffer(buffer)`\n * * A plain array using `#fromArray(array)`\n *\n * Note:\n * See the documentation of [WebGLRenderingContext.bufferData](https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/bufferData)\n * for more info on buffer usage.\n * @api\n */\nclass WebGLArrayBuffer {\n\n  /**\n   * @param {number} type Buffer type, either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER.\n   * @param {number=} opt_usage Intended usage, either `STATIC_DRAW`, `STREAM_DRAW` or `DYNAMIC_DRAW`.\n   * Default is `DYNAMIC_DRAW`.\n   */\n  constructor(type, opt_usage) {\n\n    /**\n     * @private\n     * @type {Float32Array|Uint32Array}\n     */\n    this.array = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.type = type;\n\n    assert(type === ARRAY_BUFFER || type === ELEMENT_ARRAY_BUFFER, 62);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.usage = opt_usage !== undefined ? opt_usage : BufferUsage.STATIC_DRAW;\n  }\n\n  /**\n   * Populates the buffer with an array of the given size (all values will be zeroes).\n   * @param {number} size Array size\n   */\n  ofSize(size) {\n    this.array = new (getArrayClassForType(this.type))(size);\n  }\n\n  /**\n   * Populates the buffer with an array of the given size (all values will be zeroes).\n   * @param {Array<number>} array Numerical array\n   */\n  fromArray(array) {\n    this.array = (getArrayClassForType(this.type)).from(array);\n  }\n\n  /**\n   * Populates the buffer with a raw binary array buffer.\n   * @param {ArrayBuffer} buffer Raw binary buffer to populate the array with. Note that this buffer must have been\n   * initialized for the same typed array class.\n   */\n  fromArrayBuffer(buffer) {\n    this.array = new (getArrayClassForType(this.type))(buffer);\n  }\n\n  /**\n   * @return {number} Buffer type.\n   */\n  getType() {\n    return this.type;\n  }\n\n  /**\n   * Will return null if the buffer was not initialized\n   * @return {Float32Array|Uint32Array} Array.\n   */\n  getArray() {\n    return this.array;\n  }\n\n  /**\n   * @return {number} Usage.\n   */\n  getUsage() {\n    return this.usage;\n  }\n\n  /**\n   * Will return 0 if the buffer is not initialized\n   * @return {number} Array size\n   */\n  getSize() {\n    return this.array ? this.array.length : 0;\n  }\n}\n\n/**\n * Returns a typed array constructor based on the given buffer type\n * @param {number} type Buffer type, either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER.\n * @returns {Float32ArrayConstructor|Uint32ArrayConstructor} The typed array class to use for this buffer.\n */\nexport function getArrayClassForType(type) {\n  switch (type) {\n    case ARRAY_BUFFER:\n      return Float32Array;\n    case ELEMENT_ARRAY_BUFFER:\n      return Uint32Array;\n    default:\n      return Float32Array;\n  }\n}\n\nexport default WebGLArrayBuffer;\n","/**\n * @module ol/webgl/ContextEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  LOST: 'webglcontextlost',\n  RESTORED: 'webglcontextrestored'\n};\n","/**\n * @module ol/vec/mat4\n */\n\n\n/**\n * @return {Array<number>} \"4x4 matrix representing a 3D identity transform.\"\n */\nexport function create() {\n  return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n}\n\n\n/**\n * @param {Array<number>} mat4 Flattened 4x4 matrix receiving the result.\n * @param {import(\"../transform.js\").Transform} transform Transformation matrix.\n * @return {Array<number>} \"2D transformation matrix as flattened 4x4 matrix.\"\n */\nexport function fromTransform(mat4, transform) {\n  mat4[0] = transform[0];\n  mat4[1] = transform[1];\n  mat4[4] = transform[2];\n  mat4[5] = transform[3];\n  mat4[12] = transform[4];\n  mat4[13] = transform[5];\n  return mat4;\n}\n","/**\n * @module ol/webgl/PostProcessingPass\n */\n\nconst DEFAULT_VERTEX_SHADER = `\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n`;\n\nconst DEFAULT_FRAGMENT_SHADER = `\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n`;\n\n/**\n * @typedef {Object} Options\n * @property {WebGLRenderingContext} webGlContext WebGL context; mandatory.\n * @property {number} [scaleRatio] Scale ratio; if < 1, the post process will render to a texture smaller than\n * the main canvas that will then be sampled up (useful for saving resource on blur steps).\n * @property {string} [vertexShader] Vertex shader source\n * @property {string} [fragmentShader] Fragment shader source\n * @property {Object.<string,import(\"./Helper\").UniformValue>} [uniforms] Uniform definitions for the post process step\n */\n\n/**\n * @typedef {Object} UniformInternalDescription\n * @property {import(\"./Helper\").UniformValue} value Value\n * @property {number} location Location\n * @property {WebGLTexture} [texture] Texture\n * @private\n */\n\n/**\n * @classdesc\n * This class is used to define Post Processing passes with custom shaders and uniforms.\n * This is used internally by {@link module:ol/webgl/Helper~WebGLHelper}.\n *\n * Please note that the final output on the DOM canvas is expected to have premultiplied alpha, which means that\n * a pixel which is 100% red with an opacity of 50% must have a color of (r=0.5, g=0, b=0, a=0.5).\n * Failing to provide pixel colors with premultiplied alpha will result in render anomalies.\n *\n * The default post-processing pass does *not* multiply color values with alpha value, it expects color values to be\n * premultiplied.\n *\n * Default shaders are shown hereafter:\n *\n * * Vertex shader:\n *\n *   ```\n *   precision mediump float;\n *\n *   attribute vec2 a_position;\n *   varying vec2 v_texCoord;\n *   varying vec2 v_screenCoord;\n *\n *   uniform vec2 u_screenSize;\n *\n *   void main() {\n *     v_texCoord = a_position * 0.5 + 0.5;\n *     v_screenCoord = v_texCoord * u_screenSize;\n *     gl_Position = vec4(a_position, 0.0, 1.0);\n *   }\n *   ```\n *\n * * Fragment shader:\n *\n *   ```\n *   precision mediump float;\n *\n *   uniform sampler2D u_image;\n *\n *   varying vec2 v_texCoord;\n *   varying vec2 v_screenCoord;\n *\n *   void main() {\n *     gl_FragColor = texture2D(u_image, v_texCoord);\n *   }\n *   ```\n *\n * @api\n */\nclass WebGLPostProcessingPass {\n\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n    this.gl_ = options.webGlContext;\n    const gl = this.gl_;\n\n    this.scaleRatio_ = options.scaleRatio || 1;\n\n    this.renderTargetTexture_ = gl.createTexture();\n    this.renderTargetTextureSize_ = null;\n\n    this.frameBuffer_ = gl.createFramebuffer();\n\n    // compile the program for the frame buffer\n    // TODO: make compilation errors show up\n    const vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertexShader, options.vertexShader || DEFAULT_VERTEX_SHADER);\n    gl.compileShader(vertexShader);\n    const fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, options.fragmentShader || DEFAULT_FRAGMENT_SHADER);\n    gl.compileShader(fragmentShader);\n    this.renderTargetProgram_ = gl.createProgram();\n    gl.attachShader(this.renderTargetProgram_, vertexShader);\n    gl.attachShader(this.renderTargetProgram_, fragmentShader);\n    gl.linkProgram(this.renderTargetProgram_);\n\n    // bind the vertices buffer for the frame buffer\n    this.renderTargetVerticesBuffer_ = gl.createBuffer();\n    const verticesArray = [\n      -1, -1,\n      1, -1,\n      -1, 1,\n      1, -1,\n      1, 1,\n      -1, 1\n    ];\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.renderTargetVerticesBuffer_);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(verticesArray), gl.STATIC_DRAW);\n\n    this.renderTargetAttribLocation_ = gl.getAttribLocation(this.renderTargetProgram_, 'a_position');\n    this.renderTargetUniformLocation_ = gl.getUniformLocation(this.renderTargetProgram_, 'u_screenSize');\n    this.renderTargetTextureLocation_ = gl.getUniformLocation(this.renderTargetProgram_, 'u_image');\n\n    /**\n     * Holds info about custom uniforms used in the post processing pass\n     * @type {Array<UniformInternalDescription>}\n     * @private\n     */\n    this.uniforms_ = [];\n    options.uniforms && Object.keys(options.uniforms).forEach(function(name) {\n      this.uniforms_.push({\n        value: options.uniforms[name],\n        location: gl.getUniformLocation(this.renderTargetProgram_, name)\n      });\n    }.bind(this));\n  }\n\n  /**\n   * Get the WebGL rendering context\n   * @return {WebGLRenderingContext} The rendering context.\n   * @api\n   */\n  getGL() {\n    return this.gl_;\n  }\n\n  /**\n   * Initialize the render target texture of the post process, make sure it is at the\n   * right size and bind it as a render target for the next draw calls.\n   * The last step to be initialized will be the one where the primitives are rendered.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @api\n   */\n  init(frameState) {\n    const gl = this.getGL();\n    const canvas = gl.canvas;\n    const size = frameState.size;\n\n    // rendering goes to my buffer\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.getFrameBuffer());\n    gl.viewport(0, 0, canvas.width * this.scaleRatio_, canvas.height * this.scaleRatio_);\n\n    // if size has changed: adjust canvas & render target texture\n    if (!this.renderTargetTextureSize_ ||\n      this.renderTargetTextureSize_[0] !== size[0] || this.renderTargetTextureSize_[1] !== size[1]) {\n      this.renderTargetTextureSize_ = size;\n\n      // create a new texture\n      const level = 0;\n      const internalFormat = gl.RGBA;\n      const border = 0;\n      const format = gl.RGBA;\n      const type = gl.UNSIGNED_BYTE;\n      const data = null;\n      gl.bindTexture(gl.TEXTURE_2D, this.renderTargetTexture_);\n      gl.texImage2D(gl.TEXTURE_2D, level, internalFormat,\n        canvas.width * this.scaleRatio_, canvas.height * this.scaleRatio_, border,\n        format, type, data);\n\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n      // bind the texture to the framebuffer\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.renderTargetTexture_, 0);\n    }\n  }\n\n  /**\n   * Render to the next postprocessing pass (or to the canvas if final pass).\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @param {WebGLPostProcessingPass} [nextPass] Next pass, optional\n   * @api\n   */\n  apply(frameState, nextPass) {\n    const gl = this.getGL();\n    const canvas = gl.canvas;\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, nextPass ? nextPass.getFrameBuffer() : null);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, this.renderTargetTexture_);\n\n    // render the frame buffer to the canvas\n    gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n    gl.viewport(0, 0, canvas.width, canvas.height);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.renderTargetVerticesBuffer_);\n\n    gl.useProgram(this.renderTargetProgram_);\n    gl.enableVertexAttribArray(this.renderTargetAttribLocation_);\n    gl.vertexAttribPointer(this.renderTargetAttribLocation_, 2, gl.FLOAT, false, 0, 0);\n    gl.uniform2f(this.renderTargetUniformLocation_, canvas.width, canvas.height);\n    gl.uniform1i(this.renderTargetTextureLocation_, 0);\n\n    this.applyUniforms(frameState);\n\n    gl.drawArrays(gl.TRIANGLES, 0, 6);\n  }\n\n  /**\n   * @returns {WebGLFramebuffer} Frame buffer\n   * @api\n   */\n  getFrameBuffer() {\n    return this.frameBuffer_;\n  }\n\n  /**\n   * Sets the custom uniforms based on what was given in the constructor.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  applyUniforms(frameState) {\n    const gl = this.getGL();\n\n    let value;\n    let textureSlot = 1;\n    this.uniforms_.forEach(function(uniform) {\n      value = typeof uniform.value === 'function' ? uniform.value(frameState) : uniform.value;\n\n      // apply value based on type\n      if (value instanceof HTMLCanvasElement || value instanceof ImageData) {\n        // create a texture & put data\n        if (!uniform.texture) {\n          uniform.texture = gl.createTexture();\n        }\n        gl.activeTexture(gl[`TEXTURE${textureSlot}`]);\n        gl.bindTexture(gl.TEXTURE_2D, uniform.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n        if (value instanceof ImageData) {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, value.width, value.height, 0,\n            gl.UNSIGNED_BYTE, new Uint8Array(value.data));\n        } else {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, value);\n        }\n\n        // fill texture slots\n        gl.uniform1i(uniform.location, textureSlot++);\n\n      } else if (Array.isArray(value)) {\n        switch (value.length) {\n          case 2:\n            gl.uniform2f(uniform.location, value[0], value[1]);\n            return;\n          case 3:\n            gl.uniform3f(uniform.location, value[0], value[1], value[2]);\n            return;\n          case 4:\n            gl.uniform4f(uniform.location, value[0], value[1], value[2], value[3]);\n            return;\n          default: return;\n        }\n      } else if (typeof value === 'number') {\n        gl.uniform1f(uniform.location, value);\n      }\n    });\n  }\n}\n\nexport default WebGLPostProcessingPass;\n","/**\n * @module ol/webgl/Helper\n */\nimport {getUid} from '../util.js';\nimport Disposable from '../Disposable.js';\nimport {clear} from '../obj.js';\nimport ContextEventType from '../webgl/ContextEventType.js';\nimport {\n  compose as composeTransform,\n  create as createTransform,\n  reset as resetTransform,\n  rotate as rotateTransform,\n  scale as scaleTransform\n} from '../transform.js';\nimport {create, fromTransform} from '../vec/mat4.js';\nimport WebGLPostProcessingPass from './PostProcessingPass.js';\nimport {FLOAT, getContext, getSupportedExtensions, UNSIGNED_BYTE, UNSIGNED_INT, UNSIGNED_SHORT} from '../webgl.js';\nimport {includes} from '../array.js';\nimport {assert} from '../asserts.js';\n\n\n/**\n * @typedef {Object} BufferCacheEntry\n * @property {import(\"./Buffer.js\").default} buffer\n * @property {WebGLBuffer} webGlBuffer\n */\n\n/**\n * Shader types, either `FRAGMENT_SHADER` or `VERTEX_SHADER`.\n * @enum {number}\n */\nexport const ShaderType = {\n  FRAGMENT_SHADER: 0x8B30,\n  VERTEX_SHADER: 0x8B31\n};\n\n/**\n * Uniform names used in the default shaders: `PROJECTION_MATRIX`, `OFFSET_SCALE_MATRIX`.\n * and `OFFSET_ROTATION_MATRIX`.\n * @enum {string}\n */\nexport const DefaultUniform = {\n  PROJECTION_MATRIX: 'u_projectionMatrix',\n  OFFSET_SCALE_MATRIX: 'u_offsetScaleMatrix',\n  OFFSET_ROTATION_MATRIX: 'u_offsetRotateMatrix'\n};\n\n/**\n * Attribute types, either `UNSIGNED_BYTE`, `UNSIGNED_SHORT`, `UNSIGNED_INT` or `FLOAT`\n * Note: an attribute stored in a `Float32Array` should be of type `FLOAT`.\n * @enum {number}\n */\nexport const AttributeType = {\n  UNSIGNED_BYTE: UNSIGNED_BYTE,\n  UNSIGNED_SHORT: UNSIGNED_SHORT,\n  UNSIGNED_INT: UNSIGNED_INT,\n  FLOAT: FLOAT\n};\n\n/**\n * Description of an attribute in a buffer\n * @typedef {Object} AttributeDescription\n * @property {string} name Attribute name to use in shaders\n * @property {number} size Number of components per attributes\n * @property {AttributeType} [type] Attribute type, i.e. number of bytes used to store the value. This is\n * determined by the class of typed array which the buffer uses (eg. `Float32Array` for a `FLOAT` attribute).\n * Default is `FLOAT`.\n */\n\n/**\n * @typedef {number|Array<number>|HTMLCanvasElement|HTMLImageElement|ImageData|import(\"../transform\").Transform} UniformLiteralValue\n */\n\n/**\n * Uniform value can be a number, array of numbers (2 to 4), canvas element or a callback returning\n * one of the previous types.\n * @typedef {UniformLiteralValue|function(import(\"../PluggableMap.js\").FrameState):UniformLiteralValue} UniformValue\n */\n\n/**\n * @typedef {Object} PostProcessesOptions\n * @property {number} [scaleRatio] Scale ratio; if < 1, the post process will render to a texture smaller than\n * the main canvas which will then be sampled up (useful for saving resource on blur steps).\n * @property {string} [vertexShader] Vertex shader source\n * @property {string} [fragmentShader] Fragment shader source\n * @property {Object.<string,UniformValue>} [uniforms] Uniform definitions for the post process step\n */\n\n/**\n * @typedef {Object} Options\n * @property {Object.<string,UniformValue>} [uniforms] Uniform definitions; property names must match the uniform\n * names in the provided or default shaders.\n * @property {Array<PostProcessesOptions>} [postProcesses] Post-processes definitions\n */\n\n/**\n * @typedef {Object} UniformInternalDescription\n * @property {string} name Name\n * @property {UniformValue=} value Value\n * @property {WebGLTexture} [texture] Texture\n * @private\n */\n\n/**\n * @classdesc\n * This class is intended to provide low-level functions related to WebGL rendering, so that accessing\n * directly the WebGL API should not be required anymore.\n *\n * Several operations are handled by the `WebGLHelper` class:\n *\n * ### Define custom shaders and uniforms\n *\n *   *Shaders* are low-level programs executed on the GPU and written in GLSL. There are two types of shaders:\n *\n *   Vertex shaders are used to manipulate the position and attribute of *vertices* of rendered primitives (ie. corners of a square).\n *   Outputs are:\n *\n *   * `gl_Position`: position of the vertex in screen space\n *\n *   * Varyings usually prefixed with `v_` are passed on to the fragment shader\n *\n *   Fragment shaders are used to control the actual color of the pixels drawn on screen. Their only output is `gl_FragColor`.\n *\n *   Both shaders can take *uniforms* or *attributes* as input. Attributes are explained later. Uniforms are common, read-only values that\n *   can be changed at every frame and can be of type float, arrays of float or images.\n *\n *   Shaders must be compiled and assembled into a program like so:\n *   ```js\n *   // here we simply create two shaders and assemble them in a program which is then used\n *   // for subsequent rendering calls\n *   const vertexShader = new WebGLVertex(VERTEX_SHADER);\n *   const fragmentShader = new WebGLFragment(FRAGMENT_SHADER);\n *   const program = this.context.getProgram(fragmentShader, vertexShader);\n *   helper.useProgram(this.program);\n *   ```\n *\n *   Uniforms are defined using the `uniforms` option and can either be explicit values or callbacks taking the frame state as argument.\n *   You can also change their value along the way like so:\n *   ```js\n *   helper.setUniformFloatValue('u_value', valueAsNumber);\n *   ```\n *\n * ### Defining post processing passes\n *\n *   *Post processing* describes the act of rendering primitives to a texture, and then rendering this texture to the final canvas\n *   while applying special effects in screen space.\n *   Typical uses are: blurring, color manipulation, depth of field, filtering...\n *\n *   The `WebGLHelper` class offers the possibility to define post processes at creation time using the `postProcesses` option.\n *   A post process step accepts the following options:\n *\n *   * `fragmentShader` and `vertexShader`: text literals in GLSL language that will be compiled and used in the post processing step.\n *   * `uniforms`: uniforms can be defined for the post processing steps just like for the main render.\n *   * `scaleRatio`: allows using an intermediate texture smaller or higher than the final canvas in the post processing step.\n *     This is typically used in blur steps to reduce the performance overhead by using an already downsampled texture as input.\n *\n *   The {@link module:ol/webgl/PostProcessingPass~WebGLPostProcessingPass} class is used internally, refer to its documentation for more info.\n *\n * ### Binding WebGL buffers and flushing data into them\n *\n *   Data that must be passed to the GPU has to be transferred using {@link module:ol/webgl/Buffer~WebGLArrayBuffer} objects.\n *   A buffer has to be created only once, but must be bound every time the buffer content will be used for rendering.\n *   This is done using {@link bindBuffer}.\n *   When the buffer's array content has changed, the new data has to be flushed to the GPU memory; this is done using\n *   {@link flushBufferData}. Note: this operation is expensive and should be done as infrequently as possible.\n *\n *   When binding an array buffer, a `target` parameter must be given: it should be either {@link module:ol/webgl.ARRAY_BUFFER}\n *   (if the buffer contains vertices data) or {@link module:ol/webgl.ELEMENT_ARRAY_BUFFER} (if the buffer contains indices data).\n *\n *   Examples below:\n *   ```js\n *   // at initialization phase\n *   const verticesBuffer = new WebGLArrayBuffer([], DYNAMIC_DRAW);\n *   const indicesBuffer = new WebGLArrayBuffer([], DYNAMIC_DRAW);\n *\n *   // when array values have changed\n *   helper.flushBufferData(ARRAY_BUFFER, this.verticesBuffer);\n *   helper.flushBufferData(ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n *\n *   // at rendering phase\n *   helper.bindBuffer(ARRAY_BUFFER, this.verticesBuffer);\n *   helper.bindBuffer(ELEMENT_ARRAY_BUFFER, this.indicesBuffer);\n *   ```\n *\n * ### Specifying attributes\n *\n *   The GPU only receives the data as arrays of numbers. These numbers must be handled differently depending on what it describes (position, texture coordinate...).\n *   Attributes are used to specify these uses. Use {@link enableAttributeArray_} and either\n *   the default attribute names in {@link module:ol/webgl/Helper.DefaultAttrib} or custom ones.\n *\n *   Please note that you will have to specify the type and offset of the attributes in the data array. You can refer to the documentation of [WebGLRenderingContext.vertexAttribPointer](https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer) for more explanation.\n *   ```js\n *   // here we indicate that the data array has the following structure:\n *   // [posX, posY, offsetX, offsetY, texCoordU, texCoordV, posX, posY, ...]\n *   helper.enableAttributes([\n *     {\n *        name: 'a_position',\n *        size: 2\n *     },\n *     {\n *       name: 'a_offset',\n *       size: 2\n *     },\n *     {\n *       name: 'a_texCoord',\n *       size: 2\n *     }\n *   ])\n *   ```\n *\n * ### Rendering primitives\n *\n *   Once all the steps above have been achieved, rendering primitives to the screen is done using {@link prepareDraw}, {@link drawElements} and {@link finalizeDraw}.\n *   ```js\n *   // frame preparation step\n *   helper.prepareDraw(frameState);\n *\n *   // call this for every data array that has to be rendered on screen\n *   helper.drawElements(0, this.indicesBuffer.getArray().length);\n *\n *   // finalize the rendering by applying post processes\n *   helper.finalizeDraw(frameState);\n *   ```\n *\n * For an example usage of this class, refer to {@link module:ol/renderer/webgl/PointsLayer~WebGLPointsLayerRenderer}.\n *\n *\n * @api\n */\nclass WebGLHelper extends Disposable {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n    const options = opt_options || {};\n\n    /** @private */\n    this.boundHandleWebGLContextLost_ = this.handleWebGLContextLost.bind(this);\n\n    /** @private */\n    this.boundHandleWebGLContextRestored_ = this.handleWebGLContextRestored.bind(this);\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = document.createElement('canvas');\n    this.canvas_.style.position = 'absolute';\n\n\n    /**\n     * @private\n     * @type {WebGLRenderingContext}\n     */\n    this.gl_ = getContext(this.canvas_);\n    const gl = this.getGL();\n\n    /**\n     * @private\n     * @type {!Object<string, BufferCacheEntry>}\n     */\n    this.bufferCache_ = {};\n\n    /**\n     * @private\n     * @type {!Array<WebGLShader>}\n     */\n    this.shaderCache_ = [];\n\n    /**\n     * @private\n     * @type {!Array<WebGLProgram>}\n     */\n    this.programCache_ = [];\n\n    /**\n     * @private\n     * @type {WebGLProgram}\n     */\n    this.currentProgram_ = null;\n\n    assert(includes(getSupportedExtensions(), 'OES_element_index_uint'), 63);\n    gl.getExtension('OES_element_index_uint');\n\n    this.canvas_.addEventListener(ContextEventType.LOST, this.boundHandleWebGLContextLost_);\n    this.canvas_.addEventListener(ContextEventType.RESTORED, this.boundHandleWebGLContextRestored_);\n\n    /**\n     * @private\n     * @type {import(\"../transform.js\").Transform}\n     */\n    this.offsetRotateMatrix_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"../transform.js\").Transform}\n     */\n    this.offsetScaleMatrix_ = createTransform();\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.tmpMat4_ = create();\n\n    /**\n     * @private\n     * @type {Object.<string, WebGLUniformLocation>}\n     */\n    this.uniformLocations_ = {};\n\n    /**\n     * @private\n     * @type {Object.<string, number>}\n     */\n    this.attribLocations_ = {};\n\n    /**\n     * Holds info about custom uniforms used in the post processing pass.\n     * If the uniform is a texture, the WebGL Texture object will be stored here.\n     * @type {Array<UniformInternalDescription>}\n     * @private\n     */\n    this.uniforms_ = [];\n    if (options.uniforms) {\n      for (const name in options.uniforms) {\n        this.uniforms_.push({\n          name: name,\n          value: options.uniforms[name]\n        });\n      }\n    }\n\n    /**\n     * An array of PostProcessingPass objects is kept in this variable, built from the steps provided in the\n     * options. If no post process was given, a default one is used (so as not to have to make an exception to\n     * the frame buffer logic).\n     * @type {Array<WebGLPostProcessingPass>}\n     * @private\n     */\n    this.postProcessPasses_ = options.postProcesses ? options.postProcesses.map(function(options) {\n      return new WebGLPostProcessingPass({\n        webGlContext: gl,\n        scaleRatio: options.scaleRatio,\n        vertexShader: options.vertexShader,\n        fragmentShader: options.fragmentShader,\n        uniforms: options.uniforms\n      });\n    }) : [new WebGLPostProcessingPass({webGlContext: gl})];\n\n    /**\n     * @type {string|null}\n     * @private\n     */\n    this.shaderCompileErrors_ = null;\n  }\n\n  /**\n   * Just bind the buffer if it's in the cache. Otherwise create\n   * the WebGL buffer, bind it, populate it, and add an entry to\n   * the cache.\n   * @param {import(\"./Buffer\").default} buffer Buffer.\n   * @api\n   */\n  bindBuffer(buffer) {\n    const gl = this.getGL();\n    const bufferKey = getUid(buffer);\n    let bufferCache = this.bufferCache_[bufferKey];\n    if (!bufferCache) {\n      const webGlBuffer = gl.createBuffer();\n      bufferCache = this.bufferCache_[bufferKey] = {\n        buffer: buffer,\n        webGlBuffer: webGlBuffer\n      };\n    }\n    gl.bindBuffer(buffer.getType(), bufferCache.webGlBuffer);\n  }\n\n  /**\n   * Update the data contained in the buffer array; this is required for the\n   * new data to be rendered\n   * @param {import(\"./Buffer\").default} buffer Buffer.\n   * @api\n   */\n  flushBufferData(buffer) {\n    const gl = this.getGL();\n    this.bindBuffer(buffer);\n    gl.bufferData(buffer.getType(), buffer.getArray(), buffer.getUsage());\n  }\n\n  /**\n   * @param {import(\"./Buffer.js\").default} buf Buffer.\n   */\n  deleteBuffer(buf) {\n    const gl = this.getGL();\n    const bufferKey = getUid(buf);\n    const bufferCacheEntry = this.bufferCache_[bufferKey];\n    if (!gl.isContextLost()) {\n      gl.deleteBuffer(bufferCacheEntry.buffer);\n    }\n    delete this.bufferCache_[bufferKey];\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.canvas_.removeEventListener(ContextEventType.LOST, this.boundHandleWebGLContextLost_);\n    this.canvas_.removeEventListener(ContextEventType.RESTORED, this.boundHandleWebGLContextRestored_);\n    const gl = this.getGL();\n    if (!gl.isContextLost()) {\n      for (const key in this.bufferCache_) {\n        gl.deleteBuffer(this.bufferCache_[key].buffer);\n      }\n      for (const key in this.programCache_) {\n        gl.deleteProgram(this.programCache_[key]);\n      }\n      for (const key in this.shaderCache_) {\n        gl.deleteShader(this.shaderCache_[key]);\n      }\n    }\n  }\n\n  /**\n   * Clear the buffer & set the viewport to draw.\n   * Post process passes will be initialized here, the first one being bound as a render target for\n   * subsequent draw calls.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @api\n   */\n  prepareDraw(frameState) {\n    const gl = this.getGL();\n    const canvas = this.getCanvas();\n    const size = frameState.size;\n    const pixelRatio = frameState.pixelRatio;\n\n    canvas.width = size[0] * pixelRatio;\n    canvas.height = size[1] * pixelRatio;\n    canvas.style.width = size[0] + 'px';\n    canvas.style.height = size[1] + 'px';\n\n    gl.useProgram(this.currentProgram_);\n\n    // loop backwards in post processes list\n    for (let i = this.postProcessPasses_.length - 1; i >= 0; i--) {\n      this.postProcessPasses_[i].init(frameState);\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n\n    gl.useProgram(this.currentProgram_);\n    this.applyFrameState(frameState);\n    this.applyUniforms(frameState);\n  }\n\n  /**\n   * Clear the render target & bind it for future draw operations.\n   * This is similar to `prepareDraw`, only post processes will not be applied.\n   * Note: the whole viewport will be drawn to the render target, regardless of its size.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @param {import(\"./RenderTarget.js\").default} renderTarget Render target to draw to\n   * @param {boolean} [opt_disableAlphaBlend] If true, no alpha blending will happen.\n   */\n  prepareDrawToRenderTarget(frameState, renderTarget, opt_disableAlphaBlend) {\n    const gl = this.getGL();\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, renderTarget.getFramebuffer());\n    gl.viewport(0, 0, frameState.size[0], frameState.size[1]);\n    gl.bindTexture(gl.TEXTURE_2D, renderTarget.getTexture());\n    gl.clearColor(0.0, 0.0, 0.0, 0.0);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    gl.enable(gl.BLEND);\n    gl.blendFunc(gl.ONE, opt_disableAlphaBlend ? gl.ZERO : gl.ONE_MINUS_SRC_ALPHA);\n\n    gl.useProgram(this.currentProgram_);\n    this.applyFrameState(frameState);\n    this.applyUniforms(frameState);\n  }\n\n  /**\n   * Execute a draw call based on the currently bound program, texture, buffers, attributes.\n   * @param {number} start Start index.\n   * @param {number} end End index.\n   * @api\n   */\n  drawElements(start, end) {\n    const gl = this.getGL();\n    const elementType = gl.UNSIGNED_INT;\n    const elementSize = 4;\n\n    const numItems = end - start;\n    const offsetInBytes = start * elementSize;\n    gl.drawElements(gl.TRIANGLES, numItems, elementType, offsetInBytes);\n  }\n\n  /**\n   * Apply the successive post process passes which will eventually render to the actual canvas.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState current frame state\n   * @api\n   */\n  finalizeDraw(frameState) {\n    // apply post processes using the next one as target\n    for (let i = 0; i < this.postProcessPasses_.length; i++) {\n      this.postProcessPasses_[i].apply(frameState, this.postProcessPasses_[i + 1] || null);\n    }\n  }\n\n  /**\n   * @return {HTMLCanvasElement} Canvas.\n   * @api\n   */\n  getCanvas() {\n    return this.canvas_;\n  }\n\n  /**\n   * Get the WebGL rendering context\n   * @return {WebGLRenderingContext} The rendering context.\n   * @api\n   */\n  getGL() {\n    return this.gl_;\n  }\n\n  /**\n   * Sets the default matrix uniforms for a given frame state. This is called internally in `prepareDraw`.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  applyFrameState(frameState) {\n    const size = frameState.size;\n    const rotation = frameState.viewState.rotation;\n\n    const offsetScaleMatrix = resetTransform(this.offsetScaleMatrix_);\n    scaleTransform(offsetScaleMatrix, 2 / size[0], 2 / size[1]);\n\n    const offsetRotateMatrix = resetTransform(this.offsetRotateMatrix_);\n    if (rotation !== 0) {\n      rotateTransform(offsetRotateMatrix, -rotation);\n    }\n\n    this.setUniformMatrixValue(DefaultUniform.OFFSET_SCALE_MATRIX, fromTransform(this.tmpMat4_, offsetScaleMatrix));\n    this.setUniformMatrixValue(DefaultUniform.OFFSET_ROTATION_MATRIX, fromTransform(this.tmpMat4_, offsetRotateMatrix));\n  }\n\n  /**\n   * Sets the custom uniforms based on what was given in the constructor. This is called internally in `prepareDraw`.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  applyUniforms(frameState) {\n    const gl = this.getGL();\n\n    let value;\n    let textureSlot = 0;\n    this.uniforms_.forEach(function(uniform) {\n      value = typeof uniform.value === 'function' ? uniform.value(frameState) : uniform.value;\n\n      // apply value based on type\n      if (value instanceof HTMLCanvasElement || value instanceof HTMLImageElement || value instanceof ImageData) {\n        // create a texture & put data\n        if (!uniform.texture) {\n          uniform.texture = gl.createTexture();\n        }\n        gl.activeTexture(gl[`TEXTURE${textureSlot}`]);\n        gl.bindTexture(gl.TEXTURE_2D, uniform.texture);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n        const imageReady = !(value instanceof HTMLImageElement) || /** @type {HTMLImageElement} */(value).complete;\n        if (imageReady) {\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, value);\n        }\n\n        // fill texture slots by increasing index\n        gl.uniform1i(this.getUniformLocation(uniform.name), textureSlot++);\n\n      } else if (Array.isArray(value) && value.length === 6) {\n        this.setUniformMatrixValue(uniform.name, fromTransform(this.tmpMat4_, value));\n      } else if (Array.isArray(value) && value.length <= 4) {\n        switch (value.length) {\n          case 2:\n            gl.uniform2f(this.getUniformLocation(uniform.name), value[0], value[1]);\n            return;\n          case 3:\n            gl.uniform3f(this.getUniformLocation(uniform.name), value[0], value[1], value[2]);\n            return;\n          case 4:\n            gl.uniform4f(this.getUniformLocation(uniform.name), value[0], value[1], value[2], value[3]);\n            return;\n          default:\n            return;\n        }\n      } else if (typeof value === 'number') {\n        gl.uniform1f(this.getUniformLocation(uniform.name), value);\n      }\n    }.bind(this));\n  }\n\n  /**\n   * Use a program.  If the program is already in use, this will return `false`.\n   * @param {WebGLProgram} program Program.\n   * @return {boolean} Changed.\n   * @api\n   */\n  useProgram(program) {\n    if (program == this.currentProgram_) {\n      return false;\n    } else {\n      const gl = this.getGL();\n      gl.useProgram(program);\n      this.currentProgram_ = program;\n      this.uniformLocations_ = {};\n      this.attribLocations_ = {};\n      return true;\n    }\n  }\n\n  /**\n   * Will attempt to compile a vertex or fragment shader based on source\n   * On error, the shader will be returned but\n   * `gl.getShaderParameter(shader, gl.COMPILE_STATUS)` will return `true`\n   * Use `gl.getShaderInfoLog(shader)` to have details\n   * @param {string} source Shader source\n   * @param {ShaderType} type VERTEX_SHADER or FRAGMENT_SHADER\n   * @return {WebGLShader} Shader object\n   */\n  compileShader(source, type) {\n    const gl = this.getGL();\n    const shader = gl.createShader(type);\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n    this.shaderCache_.push(shader);\n    return shader;\n  }\n\n  /**\n   * Create a program for a vertex and fragment shader. The shaders compilation may have failed:\n   * use `WebGLHelper.getShaderCompileErrors()`to have details if any.\n   * @param {string} fragmentShaderSource Fragment shader source.\n   * @param {string} vertexShaderSource Vertex shader source.\n   * @return {WebGLProgram} Program\n   * @api\n   */\n  getProgram(fragmentShaderSource, vertexShaderSource) {\n    const gl = this.getGL();\n\n    const fragmentShader = this.compileShader(fragmentShaderSource, gl.FRAGMENT_SHADER);\n    const vertexShader = this.compileShader(vertexShaderSource, gl.VERTEX_SHADER);\n    this.shaderCompileErrors_ = null;\n\n    if (gl.getShaderInfoLog(fragmentShader)) {\n      this.shaderCompileErrors_ =\n        `Fragment shader compilation failed:\\n${gl.getShaderInfoLog(fragmentShader)}`;\n    }\n    if (gl.getShaderInfoLog(vertexShader)) {\n      this.shaderCompileErrors_ = (this.shaderCompileErrors_ || '') +\n        `Vertex shader compilation failed:\\n${gl.getShaderInfoLog(vertexShader)}`;\n    }\n\n    const program = gl.createProgram();\n    gl.attachShader(program, fragmentShader);\n    gl.attachShader(program, vertexShader);\n    gl.linkProgram(program);\n    this.programCache_.push(program);\n    return program;\n  }\n\n  /**\n   * Will return the last shader compilation errors. If no error happened, will return null;\n   * @return {string|null} Errors description, or null if last compilation was successful\n   * @api\n   */\n  getShaderCompileErrors() {\n    return this.shaderCompileErrors_;\n  }\n\n  /**\n   * Will get the location from the shader or the cache\n   * @param {string} name Uniform name\n   * @return {WebGLUniformLocation} uniformLocation\n   * @api\n   */\n  getUniformLocation(name) {\n    if (this.uniformLocations_[name] === undefined) {\n      this.uniformLocations_[name] = this.getGL().getUniformLocation(this.currentProgram_, name);\n    }\n    return this.uniformLocations_[name];\n  }\n\n  /**\n   * Will get the location from the shader or the cache\n   * @param {string} name Attribute name\n   * @return {number} attribLocation\n   * @api\n   */\n  getAttributeLocation(name) {\n    if (this.attribLocations_[name] === undefined) {\n      this.attribLocations_[name] = this.getGL().getAttribLocation(this.currentProgram_, name);\n    }\n    return this.attribLocations_[name];\n  }\n\n  /**\n   * Modifies the given transform to apply the rotation/translation/scaling of the given frame state.\n   * The resulting transform can be used to convert world space coordinates to view coordinates.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../transform\").Transform} transform Transform to update.\n   * @return {import(\"../transform\").Transform} The updated transform object.\n   * @api\n   */\n  makeProjectionTransform(frameState, transform) {\n    const size = frameState.size;\n    const rotation = frameState.viewState.rotation;\n    const resolution = frameState.viewState.resolution;\n    const center = frameState.viewState.center;\n\n    resetTransform(transform);\n    composeTransform(transform,\n      0, 0,\n      2 / (resolution * size[0]), 2 / (resolution * size[1]),\n      -rotation,\n      -center[0], -center[1]\n    );\n    return transform;\n  }\n\n  /**\n   * Give a value for a standard float uniform\n   * @param {string} uniform Uniform name\n   * @param {number} value Value\n   * @api\n   */\n  setUniformFloatValue(uniform, value) {\n    this.getGL().uniform1f(this.getUniformLocation(uniform), value);\n  }\n\n  /**\n   * Give a value for a standard matrix4 uniform\n   * @param {string} uniform Uniform name\n   * @param {Array<number>} value Matrix value\n   * @api\n   */\n  setUniformMatrixValue(uniform, value) {\n    this.getGL().uniformMatrix4fv(this.getUniformLocation(uniform), false, value);\n  }\n\n  /**\n   * Will set the currently bound buffer to an attribute of the shader program. Used by `#enableAttributes`\n   * internally.\n   * @param {string} attribName Attribute name\n   * @param {number} size Number of components per attributes\n   * @param {number} type UNSIGNED_INT, UNSIGNED_BYTE, UNSIGNED_SHORT or FLOAT\n   * @param {number} stride Stride in bytes (0 means attribs are packed)\n   * @param {number} offset Offset in bytes\n   * @private\n   */\n  enableAttributeArray_(attribName, size, type, stride, offset) {\n    const location = this.getAttributeLocation(attribName);\n    // the attribute has not been found in the shaders; do not enable it\n    if (location < 0) {\n      return;\n    }\n    this.getGL().enableVertexAttribArray(location);\n    this.getGL().vertexAttribPointer(location, size, type,\n      false, stride, offset);\n  }\n\n  /**\n   * Will enable the following attributes to be read from the currently bound buffer,\n   * i.e. tell the GPU where to read the different attributes in the buffer. An error in the\n   * size/type/order of attributes will most likely break the rendering and throw a WebGL exception.\n   * @param {Array<AttributeDescription>} attributes Ordered list of attributes to read from the buffer\n   * @api\n   */\n  enableAttributes(attributes) {\n    const stride = computeAttributesStride(attributes);\n    let offset = 0;\n    for (let i = 0; i < attributes.length; i++) {\n      const attr = attributes[i];\n      this.enableAttributeArray_(attr.name, attr.size, attr.type || FLOAT, stride, offset);\n      offset += attr.size * getByteSizeFromType(attr.type);\n    }\n  }\n\n  /**\n   * WebGL context was lost\n   * @private\n   */\n  handleWebGLContextLost() {\n    clear(this.bufferCache_);\n    clear(this.shaderCache_);\n    clear(this.programCache_);\n    this.currentProgram_ = null;\n  }\n\n  /**\n   * WebGL context was restored\n   * @private\n   */\n  handleWebGLContextRestored() {\n  }\n\n  // TODO: shutdown program\n\n  /**\n   * Will create or reuse a given webgl texture and apply the given size. If no image data\n   * specified, the texture will be empty, otherwise image data will be used and the `size`\n   * parameter will be ignored.\n   * Note: wrap parameters are set to clamp to edge, min filter is set to linear.\n   * @param {Array<number>} size Expected size of the texture\n   * @param {ImageData|HTMLImageElement|HTMLCanvasElement} [opt_data] Image data/object to bind to the texture\n   * @param {WebGLTexture} [opt_texture] Existing texture to reuse\n   * @return {WebGLTexture} The generated texture\n   * @api\n   */\n  createTexture(size, opt_data, opt_texture) {\n    const gl = this.getGL();\n    const texture = opt_texture || gl.createTexture();\n\n    // set params & size\n    const level = 0;\n    const internalFormat = gl.RGBA;\n    const border = 0;\n    const format = gl.RGBA;\n    const type = gl.UNSIGNED_BYTE;\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    if (opt_data) {\n      gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, format, type, opt_data);\n    } else {\n      gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, size[0], size[1], border, format, type, null);\n    }\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n    return texture;\n  }\n}\n\n/**\n * Compute a stride in bytes based on a list of attributes\n * @param {Array<AttributeDescription>} attributes Ordered list of attributes\n * @returns {number} Stride, ie amount of values for each vertex in the vertex buffer\n * @api\n */\nexport function computeAttributesStride(attributes) {\n  let stride = 0;\n  for (let i = 0; i < attributes.length; i++) {\n    const attr = attributes[i];\n    stride += attr.size * getByteSizeFromType(attr.type);\n  }\n  return stride;\n}\n\n/**\n * Computes the size in byte of an attribute type.\n * @param {AttributeType} type Attribute type\n * @returns {number} The size in bytes\n */\nfunction getByteSizeFromType(type) {\n  switch (type) {\n    case AttributeType.UNSIGNED_BYTE: return Uint8Array.BYTES_PER_ELEMENT;\n    case AttributeType.UNSIGNED_SHORT: return Uint16Array.BYTES_PER_ELEMENT;\n    case AttributeType.UNSIGNED_INT: return Uint32Array.BYTES_PER_ELEMENT;\n    case AttributeType.FLOAT:\n    default: return Float32Array.BYTES_PER_ELEMENT;\n  }\n}\n\nexport default WebGLHelper;\n","/**\n * @module ol/renderer/webgl/Layer\n */\nimport LayerRenderer from '../Layer.js';\nimport WebGLHelper from '../../webgl/Helper.js';\n\n\n/**\n * @enum {string}\n */\nexport const WebGLWorkerMessageType = {\n  GENERATE_BUFFERS: 'GENERATE_BUFFERS'\n};\n\n/**\n * @typedef {Object} WebGLWorkerGenerateBuffersMessage\n * This message will trigger the generation of a vertex and an index buffer based on the given render instructions.\n * When the buffers are generated, the worked will send a message of the same type to the main thread, with\n * the generated buffers in it.\n * Note that any addition properties present in the message *will* be sent back to the main thread.\n * @property {WebGLWorkerMessageType} type Message type\n * @property {ArrayBuffer} renderInstructions Render instructions raw binary buffer.\n * @property {ArrayBuffer} [vertexBuffer] Vertices array raw binary buffer (sent by the worker).\n * @property {ArrayBuffer} [indexBuffer] Indices array raw binary buffer (sent by the worker).\n * @property {number} [customAttributesCount] Amount of custom attributes count in the render instructions.\n */\n\n/**\n * @typedef {Object} PostProcessesOptions\n * @property {number} [scaleRatio] Scale ratio; if < 1, the post process will render to a texture smaller than\n * the main canvas that will then be sampled up (useful for saving resource on blur steps).\n * @property {string} [vertexShader] Vertex shader source\n * @property {string} [fragmentShader] Fragment shader source\n * @property {Object.<string,import(\"../../webgl/Helper\").UniformValue>} [uniforms] Uniform definitions for the post process step\n */\n\n/**\n * @typedef {Object} Options\n * @property {Object.<string,import(\"../../webgl/Helper\").UniformValue>} [uniforms] Uniform definitions for the post process steps\n * @property {Array<PostProcessesOptions>} [postProcesses] Post-processes definitions\n */\n\n/**\n * @classdesc\n * Base WebGL renderer class.\n * Holds all logic related to data manipulation & some common rendering logic\n * @template {import(\"../../layer/Layer.js\").default} LayerType\n */\nclass WebGLLayerRenderer extends LayerRenderer {\n\n  /**\n   * @param {LayerType} layer Layer.\n   * @param {Options=} [opt_options] Options.\n   */\n  constructor(layer, opt_options) {\n    super(layer);\n\n    const options = opt_options || {};\n\n    /**\n     * @type {WebGLHelper}\n     * @protected\n     */\n    this.helper = new WebGLHelper({\n      postProcesses: options.postProcesses,\n      uniforms: options.uniforms\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.helper.disposeInternal();\n    super.disposeInternal();\n  }\n\n  /**\n   * Will return the last shader compilation errors. If no error happened, will return null;\n   * @return {string|null} Errors, or null if last compilation was successful\n   * @api\n   */\n  getShaderCompileErrors() {\n    return this.helper.getShaderCompileErrors();\n  }\n\n}\n\nconst tmpArray_ = [];\nconst bufferPositions_ = {vertexPosition: 0, indexPosition: 0};\n\nfunction writePointVertex(buffer, pos, x, y, index) {\n  buffer[pos + 0] = x;\n  buffer[pos + 1] = y;\n  buffer[pos + 2] = index;\n}\n\n/**\n * An object holding positions both in an index and a vertex buffer.\n * @typedef {Object} BufferPositions\n * @property {number} vertexPosition Position in the vertex buffer\n * @property {number} indexPosition Position in the index buffer\n */\n\n/**\n * Pushes a quad (two triangles) based on a point geometry\n * @param {Float32Array} instructions Array of render instructions for points.\n * @param {number} elementIndex Index from which render instructions will be read.\n * @param {Float32Array} vertexBuffer Buffer in the form of a typed array.\n * @param {Uint32Array} indexBuffer Buffer in the form of a typed array.\n * @param {number} customAttributesCount Amount of custom attributes for each element.\n * @param {BufferPositions} [bufferPositions] Buffer write positions; if not specified, positions will be set at 0.\n * @return {BufferPositions} New buffer positions where to write next\n * @property {number} vertexPosition New position in the vertex buffer where future writes should start.\n * @property {number} indexPosition New position in the index buffer where future writes should start.\n * @private\n */\nexport function writePointFeatureToBuffers(instructions, elementIndex, vertexBuffer, indexBuffer, customAttributesCount, bufferPositions) {\n  // This is for x, y and index\n  const baseVertexAttrsCount = 3;\n  const baseInstructionsCount = 2;\n  const stride = baseVertexAttrsCount + customAttributesCount;\n\n  const x = instructions[elementIndex + 0];\n  const y = instructions[elementIndex + 1];\n\n  // read custom numerical attributes on the feature\n  const customAttrs = tmpArray_;\n  customAttrs.length = customAttributesCount;\n  for (let i = 0; i < customAttrs.length; i++) {\n    customAttrs[i] = instructions[elementIndex + baseInstructionsCount + i];\n  }\n\n  let vPos = bufferPositions ? bufferPositions.vertexPosition : 0;\n  let iPos = bufferPositions ? bufferPositions.indexPosition : 0;\n  const baseIndex = vPos / stride;\n\n  // push vertices for each of the four quad corners (first standard then custom attributes)\n  writePointVertex(vertexBuffer, vPos, x, y, 0);\n  customAttrs.length && vertexBuffer.set(customAttrs, vPos + baseVertexAttrsCount);\n  vPos += stride;\n\n  writePointVertex(vertexBuffer, vPos, x, y, 1);\n  customAttrs.length && vertexBuffer.set(customAttrs, vPos + baseVertexAttrsCount);\n  vPos += stride;\n\n  writePointVertex(vertexBuffer, vPos, x, y, 2);\n  customAttrs.length && vertexBuffer.set(customAttrs, vPos + baseVertexAttrsCount);\n  vPos += stride;\n\n  writePointVertex(vertexBuffer, vPos, x, y, 3);\n  customAttrs.length && vertexBuffer.set(customAttrs, vPos + baseVertexAttrsCount);\n  vPos += stride;\n\n  indexBuffer[iPos++] = baseIndex; indexBuffer[iPos++] = baseIndex + 1; indexBuffer[iPos++] = baseIndex + 3;\n  indexBuffer[iPos++] = baseIndex + 1; indexBuffer[iPos++] = baseIndex + 2; indexBuffer[iPos++] = baseIndex + 3;\n\n  bufferPositions_.vertexPosition = vPos;\n  bufferPositions_.indexPosition = iPos;\n\n  return bufferPositions_;\n}\n\n/**\n * Returns a texture of 1x1 pixel, white\n * @private\n * @return {ImageData} Image data.\n */\nexport function getBlankImageData() {\n  const canvas = document.createElement('canvas');\n  const image = canvas.getContext('2d').createImageData(1, 1);\n  image.data[0] = image.data[1] = image.data[2] = image.data[3] = 255;\n  return image;\n}\n\n/**\n * Generates a color array based on a numerical id\n * Note: the range for each component is 0 to 1 with 256 steps\n * @param {number} id Id\n * @param {Array<number>} [opt_array] Reusable array\n * @return {Array<number>} Color array containing the encoded id\n */\nexport function colorEncodeId(id, opt_array) {\n  const array = opt_array || [];\n  const radix = 256;\n  const divide = radix - 1;\n  array[0] = Math.floor(id / radix / radix / radix) / divide;\n  array[1] = (Math.floor(id / radix / radix) % radix) / divide;\n  array[2] = (Math.floor(id / radix) % radix) / divide;\n  array[3] = (id % radix) / divide;\n  return array;\n}\n\n\n/**\n * Reads an id from a color-encoded array\n * Note: the expected range for each component is 0 to 1 with 256 steps.\n * @param {Array<number>} color Color array containing the encoded id\n * @return {number} Decoded id\n */\nexport function colorDecodeId(color) {\n  let id = 0;\n  const radix = 256;\n  const mult = radix - 1;\n  id += Math.round(color[0] * radix * radix * radix * mult);\n  id += Math.round(color[1] * radix * radix * mult);\n  id += Math.round(color[2] * radix * mult);\n  id += Math.round(color[3] * mult);\n  return id;\n}\n\nexport default WebGLLayerRenderer;\n","\n        const source = \"var e=\\\"function\\\"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError(\\\"Cannot convert undefined or null to object\\\");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t};var n=\\\"GENERATE_BUFFERS\\\",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,a){var u=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=a?a.vertexPosition:0,h=a?a.indexPosition:0,d=b/u;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=u,l,v,1),c.length&&i.set(c,b+3),o(i,b+=u,l,v,2),c.length&&i.set(c,b+3),o(i,b+=u,l,v,3),c.length&&i.set(c,b+3),b+=u,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,a=new Float32Array(r.renderInstructions),u=a.length/s,l=4*u*(o+3),v=new Uint32Array(6*u),c=new Float32Array(l),g=null,b=0;b<a.length;b+=s)g=i(a,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:a.buffer},r);f.postMessage(h,[c.buffer,v.buffer,a.buffer])}};\";\n        const blob = new Blob([source], {type: 'application/javascript'});\n        const url = URL.createObjectURL(blob);\n        export function create() {\n          return new Worker(url);\n        }\n      \n","/**\n * A wrapper class to simplify rendering to a texture instead of the final canvas\n * @module ol/webgl/RenderTarget\n */\nimport {equals} from '../array.js';\n\n// for pixel color reading\nconst tmpArray4 = new Uint8Array(4);\n\n/**\n * @classdesc\n * This class is a wrapper around the association of both a `WebGLTexture` and a `WebGLFramebuffer` instances,\n * simplifying initialization and binding for rendering.\n * @api\n */\nclass WebGLRenderTarget {\n\n  /**\n   * @param {import(\"./Helper.js\").default} helper WebGL helper; mandatory.\n   * @param {Array<number>} [opt_size] Expected size of the render target texture; note: this can be changed later on.\n   */\n  constructor(helper, opt_size) {\n    /**\n     * @private\n     * @type {import(\"./Helper.js\").default}\n     */\n    this.helper_ = helper;\n    const gl = helper.getGL();\n\n    /**\n     * @private\n     * @type {WebGLTexture}\n     */\n    this.texture_ = gl.createTexture();\n\n    /**\n     * @private\n     * @type {WebGLFramebuffer}\n     */\n    this.framebuffer_ = gl.createFramebuffer();\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.size_ = opt_size || [1, 1];\n\n    /**\n     * @type {Uint8Array}\n     * @private\n     */\n    this.data_ = new Uint8Array(0);\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dataCacheDirty_ = true;\n\n    this.updateSize_();\n  }\n\n  /**\n   * Changes the size of the render target texture. Note: will do nothing if the size\n   * is already the same.\n   * @param {Array<number>} size Expected size of the render target texture\n   * @api\n   */\n  setSize(size) {\n    if (equals(size, this.size_)) {\n      return;\n    }\n    this.size_[0] = size[0];\n    this.size_[1] = size[1];\n    this.updateSize_();\n  }\n\n  /**\n   * Returns the size of the render target texture\n   * @return {Array<number>} Size of the render target texture\n   * @api\n   */\n  getSize() {\n    return this.size_;\n  }\n\n  /**\n   * This will cause following calls to `#readAll` or `#readPixel` to download the content of the\n   * render target into memory, which is an expensive operation.\n   * This content will be kept in cache but should be cleared after each new render.\n   * @api\n   */\n  clearCachedData() {\n    this.dataCacheDirty_ = true;\n  }\n\n  /**\n   * Returns the full content of the frame buffer as a series of r, g, b, a components\n   * in the 0-255 range (unsigned byte).\n   * @return {Uint8Array} Integer array of color values\n   * @api\n   */\n  readAll() {\n    if (this.dataCacheDirty_) {\n      const size = this.size_;\n      const gl = this.helper_.getGL();\n\n      gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer_);\n      gl.readPixels(0, 0, size[0], size[1], gl.RGBA, gl.UNSIGNED_BYTE, this.data_);\n      this.dataCacheDirty_ = false;\n    }\n    return this.data_;\n  }\n\n  /**\n   * Reads one pixel of the frame buffer as an array of r, g, b, a components\n   * in the 0-255 range (unsigned byte).\n   * @param {number} x Pixel coordinate\n   * @param {number} y Pixel coordinate\n   * @returns {Uint8Array} Integer array with one color value (4 components)\n   * @api\n   */\n  readPixel(x, y) {\n    this.readAll();\n    const index = Math.floor(x) + (this.size_[1] - Math.floor(y) - 1) * this.size_[0];\n    tmpArray4[0] = this.data_[index * 4];\n    tmpArray4[1] = this.data_[index * 4 + 1];\n    tmpArray4[2] = this.data_[index * 4 + 2];\n    tmpArray4[3] = this.data_[index * 4 + 3];\n    return tmpArray4;\n  }\n\n  /**\n   * @return {WebGLTexture} Texture to render to\n   */\n  getTexture() {\n    return this.texture_;\n  }\n\n  /**\n   * @return {WebGLFramebuffer} Frame buffer of the render target\n   */\n  getFramebuffer() {\n    return this.framebuffer_;\n  }\n\n  /**\n   * @private\n   */\n  updateSize_() {\n    const size = this.size_;\n    const gl = this.helper_.getGL();\n\n    this.texture_ = this.helper_.createTexture(size, null, this.texture_);\n\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer_);\n    gl.viewport(0, 0, size[0], size[1]);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture_, 0);\n\n    this.data_ = new Uint8Array(size[0] * size[1] * 4);\n  }\n}\n\nexport default WebGLRenderTarget;\n","/**\n * @module ol/renderer/webgl/PointsLayer\n */\nimport WebGLArrayBuffer from '../../webgl/Buffer.js';\nimport {ARRAY_BUFFER, DYNAMIC_DRAW, ELEMENT_ARRAY_BUFFER} from '../../webgl.js';\nimport {AttributeType, DefaultUniform} from '../../webgl/Helper.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport WebGLLayerRenderer, {colorDecodeId, colorEncodeId, WebGLWorkerMessageType} from './Layer.js';\nimport ViewHint from '../../ViewHint.js';\nimport {createEmpty, equals} from '../../extent.js';\nimport {\n  apply as applyTransform,\n  create as createTransform,\n  makeInverse as makeInverseTransform,\n  multiply as multiplyTransform\n} from '../../transform.js';\nimport {create as createWebGLWorker} from '../../worker/webgl.js';\nimport {getUid} from '../../util.js';\nimport WebGLRenderTarget from '../../webgl/RenderTarget.js';\nimport {assert} from '../../asserts.js';\n\n/**\n * @typedef {Object} CustomAttribute A description of a custom attribute to be passed on to the GPU, with a value different\n * for each feature.\n * @property {string} name Attribute name.\n * @property {function(import(\"../../Feature\").default):number} callback This callback computes the numerical value of the\n * attribute for a given feature.\n */\n\n/**\n * @typedef {Object} Options\n * @property {Array<CustomAttribute>} [attributes] These attributes will be read from the features in the source and then\n * passed to the GPU. The `name` property of each attribute will serve as its identifier:\n *  * In the vertex shader as an `attribute` by prefixing it with `a_`\n *  * In the fragment shader as a `varying` by prefixing it with `v_`\n * Please note that these can only be numerical values.\n * @property {string} vertexShader Vertex shader source, mandatory.\n * @property {string} fragmentShader Fragment shader source, mandatory.\n * @property {string} [hitVertexShader] Vertex shader source for hit detection rendering.\n * @property {string} [hitFragmentShader] Fragment shader source for hit detection rendering.\n * @property {Object.<string,import(\"../../webgl/Helper\").UniformValue>} [uniforms] Uniform definitions for the post process steps\n * Please note that `u_texture` is reserved for the main texture slot.\n * @property {Array<import(\"./Layer\").PostProcessesOptions>} [postProcesses] Post-processes definitions\n */\n\n/**\n * @classdesc\n * WebGL vector renderer optimized for points.\n * All features will be rendered as quads (two triangles forming a square). New data will be flushed to the GPU\n * every time the vector source changes.\n *\n * You need to provide vertex and fragment shaders for rendering. This can be done using\n * {@link module:ol/webgl/ShaderBuilder} utilities. These shaders shall expect a `a_position` attribute\n * containing the screen-space projected center of the quad, as well as a `a_index` attribute\n * whose value (0, 1, 2 or 3) indicates which quad vertex is currently getting processed (see structure below).\n *\n * To include variable attributes in the shaders, you need to declare them using the `attributes` property of\n * the options object like so:\n * ```js\n * new WebGLPointsLayerRenderer(layer, {\n *   attributes: [\n *     {\n *       name: 'size',\n *       callback: function(feature) {\n *         // compute something with the feature\n *       }\n *     },\n *     {\n *       name: 'weight',\n *       callback: function(feature) {\n *         // compute something with the feature\n *       }\n *     },\n *   ],\n *   vertexShader:\n *     // shader using attribute a_weight and a_size\n *   fragmentShader:\n *     // shader using varying v_weight and v_size\n * ```\n *\n * To enable hit detection, you must as well provide dedicated shaders using the `hitVertexShader`\n * and `hitFragmentShader` properties. These shall expect the `a_hitColor` attribute to contain\n * the final color that will have to be output for hit detection to work.\n *\n * The following uniform is used for the main texture: `u_texture`.\n *\n * Please note that the main shader output should have premultiplied alpha, otherwise visual anomalies may occur.\n *\n * Points are rendered as quads with the following structure:\n *\n * ```\n *   (u0, v1)      (u1, v1)\n *  [3]----------[2]\n *   |`           |\n *   |  `         |\n *   |    `       |\n *   |      `     |\n *   |        `   |\n *   |          ` |\n *  [0]----------[1]\n *   (u0, v0)      (u1, v0)\n *  ```\n *\n * This uses {@link module:ol/webgl/Helper~WebGLHelper} internally.\n *\n * @api\n */\nclass WebGLPointsLayerRenderer extends WebGLLayerRenderer {\n\n  /**\n   * @param {import(\"../../layer/Layer.js\").default} layer Layer.\n   * @param {Options} options Options.\n   */\n  constructor(layer, options) {\n    const uniforms = options.uniforms || {};\n    const projectionMatrixTransform = createTransform();\n    uniforms[DefaultUniform.PROJECTION_MATRIX] = projectionMatrixTransform;\n\n    super(layer, {\n      uniforms: uniforms,\n      postProcesses: options.postProcesses\n    });\n\n    this.sourceRevision_ = -1;\n\n    this.verticesBuffer_ = new WebGLArrayBuffer(ARRAY_BUFFER, DYNAMIC_DRAW);\n    this.hitVerticesBuffer_ = new WebGLArrayBuffer(ARRAY_BUFFER, DYNAMIC_DRAW);\n    this.indicesBuffer_ = new WebGLArrayBuffer(ELEMENT_ARRAY_BUFFER, DYNAMIC_DRAW);\n\n    this.program_ = this.helper.getProgram(\n      options.fragmentShader,\n      options.vertexShader\n    );\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.hitDetectionEnabled_ = options.hitFragmentShader && options.hitVertexShader ? true : false;\n\n    this.hitProgram_ = this.hitDetectionEnabled_ && this.helper.getProgram(\n      options.hitFragmentShader,\n      options.hitVertexShader\n    );\n\n    const customAttributes = options.attributes ?\n      options.attributes.map(function(attribute) {\n        return {\n          name: 'a_' + attribute.name,\n          size: 1,\n          type: AttributeType.FLOAT\n        };\n      }) : [];\n\n    /**\n     * A list of attributes used by the renderer. By default only the position and\n     * index of the vertex (0 to 3) are required.\n     * @type {Array<import('../../webgl/Helper.js').AttributeDescription>}\n     */\n    this.attributes = [{\n      name: 'a_position',\n      size: 2,\n      type: AttributeType.FLOAT\n    }, {\n      name: 'a_index',\n      size: 1,\n      type: AttributeType.FLOAT\n    }].concat(customAttributes);\n\n    /**\n     * A list of attributes used for hit detection.\n     * @type {Array<import('../../webgl/Helper.js').AttributeDescription>}\n     */\n    this.hitDetectionAttributes = [{\n      name: 'a_position',\n      size: 2,\n      type: AttributeType.FLOAT\n    }, {\n      name: 'a_index',\n      size: 1,\n      type: AttributeType.FLOAT\n    }, {\n      name: 'a_hitColor',\n      size: 4,\n      type: AttributeType.FLOAT\n    }, {\n      name: 'a_featureUid',\n      size: 1,\n      type: AttributeType.FLOAT\n    }].concat(customAttributes);\n\n    this.customAttributes = options.attributes ? options.attributes : [];\n\n    this.previousExtent_ = createEmpty();\n\n    /**\n     * This transform is updated on every frame and is the composition of:\n     * - invert of the world->screen transform that was used when rebuilding buffers (see `this.renderTransform_`)\n     * - current world->screen transform\n     * @type {import(\"../../transform.js\").Transform}\n     * @private\n     */\n    this.currentTransform_ = projectionMatrixTransform;\n\n    /**\n     * This transform is updated when buffers are rebuilt and converts world space coordinates to screen space\n     * @type {import(\"../../transform.js\").Transform}\n     * @private\n     */\n    this.renderTransform_ = createTransform();\n\n    /**\n     * @type {import(\"../../transform.js\").Transform}\n     * @private\n     */\n    this.invertRenderTransform_ = createTransform();\n\n    /**\n     * @type {Float32Array}\n     * @private\n     */\n    this.renderInstructions_ = new Float32Array(0);\n\n    /**\n     * These instructions are used for hit detection\n     * @type {Float32Array}\n     * @private\n     */\n    this.hitRenderInstructions_ = new Float32Array(0);\n\n    /**\n     * @type {WebGLRenderTarget}\n     * @private\n     */\n    this.hitRenderTarget_ = this.hitDetectionEnabled_ && new WebGLRenderTarget(this.helper);\n\n    this.worker_ = createWebGLWorker();\n    this.worker_.addEventListener('message', function(event) {\n      const received = event.data;\n      if (received.type === WebGLWorkerMessageType.GENERATE_BUFFERS) {\n        const projectionTransform = received.projectionTransform;\n        if (received.hitDetection) {\n          this.hitVerticesBuffer_.fromArrayBuffer(received.vertexBuffer);\n          this.helper.flushBufferData(this.hitVerticesBuffer_);\n        } else {\n          this.verticesBuffer_.fromArrayBuffer(received.vertexBuffer);\n          this.helper.flushBufferData(this.verticesBuffer_);\n        }\n        this.indicesBuffer_.fromArrayBuffer(received.indexBuffer);\n        this.helper.flushBufferData(this.indicesBuffer_);\n\n        this.renderTransform_ = projectionTransform;\n        makeInverseTransform(this.invertRenderTransform_, this.renderTransform_);\n        if (received.hitDetection) {\n          this.hitRenderInstructions_ = new Float32Array(event.data.renderInstructions);\n        } else {\n          this.renderInstructions_ = new Float32Array(event.data.renderInstructions);\n        }\n\n        this.getLayer().changed();\n      }\n    }.bind(this));\n  }\n\n  /**\n   * @inheritDoc\n   */\n  renderFrame(frameState) {\n    const renderCount = this.indicesBuffer_.getSize();\n    this.helper.drawElements(0, renderCount);\n    this.helper.finalizeDraw(frameState);\n    const canvas = this.helper.getCanvas();\n\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    const opacity = layerState.opacity;\n    if (opacity !== parseFloat(canvas.style.opacity)) {\n      canvas.style.opacity = opacity;\n    }\n\n    if (this.hitDetectionEnabled_) {\n      this.renderHitDetection(frameState);\n      this.hitRenderTarget_.clearCachedData();\n    }\n\n    return canvas;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState) {\n    const layer = this.getLayer();\n    const vectorSource = layer.getSource();\n    const viewState = frameState.viewState;\n\n    // the source has changed: clear the feature cache & reload features\n    const sourceChanged = this.sourceRevision_ < vectorSource.getRevision();\n    if (sourceChanged) {\n      this.sourceRevision_ = vectorSource.getRevision();\n\n      const projection = viewState.projection;\n      const resolution = viewState.resolution;\n      vectorSource.loadFeatures([-Infinity, -Infinity, Infinity, Infinity], resolution, projection);\n    }\n\n    const viewNotMoving = !frameState.viewHints[ViewHint.ANIMATING] && !frameState.viewHints[ViewHint.INTERACTING];\n    const extentChanged = !equals(this.previousExtent_, frameState.extent);\n    if ((sourceChanged || extentChanged) && viewNotMoving) {\n      this.rebuildBuffers_(frameState);\n      this.previousExtent_ = frameState.extent.slice();\n    }\n\n    // apply the current projection transform with the invert of the one used to fill buffers\n    this.helper.makeProjectionTransform(frameState, this.currentTransform_);\n    multiplyTransform(this.currentTransform_, this.invertRenderTransform_);\n\n    this.helper.useProgram(this.program_);\n    this.helper.prepareDraw(frameState);\n\n    // write new data\n    this.helper.bindBuffer(this.verticesBuffer_);\n    this.helper.bindBuffer(this.indicesBuffer_);\n\n    this.helper.enableAttributes(this.attributes);\n\n    return true;\n  }\n\n  /**\n   * Rebuild internal webgl buffers based on current view extent; costly, should not be called too much\n   * @param {import(\"../../PluggableMap\").FrameState} frameState Frame state.\n   * @private\n   */\n  rebuildBuffers_(frameState) {\n    const layer = this.getLayer();\n    const vectorSource = layer.getSource();\n\n    // saves the projection transform for the current frame state\n    const projectionTransform = createTransform();\n    this.helper.makeProjectionTransform(frameState, projectionTransform);\n\n    const features = vectorSource.getFeatures();\n\n    // here we anticipate the amount of render instructions that we well generate\n    // this can be done since we know that for normal render we only have x, y as base instructions,\n    // and x, y, r, g, b, a and featureUid for hit render instructions\n    // and we also know the amount of custom attributes to append to these\n    const totalInstructionsCount = (2 + this.customAttributes.length) * features.length;\n    if (!this.renderInstructions_ || this.renderInstructions_.length !== totalInstructionsCount) {\n      this.renderInstructions_ = new Float32Array(totalInstructionsCount);\n    }\n    if (this.hitDetectionEnabled_) {\n      const totalHitInstructionsCount = (7 + this.customAttributes.length) * features.length;\n      if (!this.hitRenderInstructions_ || this.hitRenderInstructions_.length !== totalHitInstructionsCount) {\n        this.hitRenderInstructions_ = new Float32Array(totalHitInstructionsCount);\n      }\n    }\n\n    // loop on features to fill the buffer\n    let feature;\n    const tmpCoords = [];\n    const tmpColor = [];\n    let renderIndex = 0;\n    let hitIndex = 0;\n    let hitColor;\n    for (let i = 0; i < features.length; i++) {\n      feature = features[i];\n      if (!feature.getGeometry() || feature.getGeometry().getType() !== GeometryType.POINT) {\n        continue;\n      }\n\n      tmpCoords[0] = feature.getGeometry().getFlatCoordinates()[0];\n      tmpCoords[1] = feature.getGeometry().getFlatCoordinates()[1];\n      applyTransform(projectionTransform, tmpCoords);\n\n      hitColor = colorEncodeId(hitIndex + 6, tmpColor);\n\n      this.renderInstructions_[renderIndex++] = tmpCoords[0];\n      this.renderInstructions_[renderIndex++] = tmpCoords[1];\n\n      // for hit detection, the feature uid is saved in the opacity value\n      // and the index of the opacity value is encoded in the color values\n      if (this.hitDetectionEnabled_) {\n        this.hitRenderInstructions_[hitIndex++] = tmpCoords[0];\n        this.hitRenderInstructions_[hitIndex++] = tmpCoords[1];\n        this.hitRenderInstructions_[hitIndex++] = hitColor[0];\n        this.hitRenderInstructions_[hitIndex++] = hitColor[1];\n        this.hitRenderInstructions_[hitIndex++] = hitColor[2];\n        this.hitRenderInstructions_[hitIndex++] = hitColor[3];\n        this.hitRenderInstructions_[hitIndex++] = Number(getUid(feature));\n      }\n\n      // pushing custom attributes\n      let value;\n      for (let j = 0; j < this.customAttributes.length; j++) {\n        value = this.customAttributes[j].callback(feature);\n        this.renderInstructions_[renderIndex++] = value;\n        if (this.hitDetectionEnabled_) {\n          this.hitRenderInstructions_[hitIndex++] = value;\n        }\n      }\n    }\n\n    /** @type import('./Layer').WebGLWorkerGenerateBuffersMessage */\n    const message = {\n      type: WebGLWorkerMessageType.GENERATE_BUFFERS,\n      renderInstructions: this.renderInstructions_.buffer,\n      customAttributesCount: this.customAttributes.length\n    };\n    // additional properties will be sent back as-is by the worker\n    message['projectionTransform'] = projectionTransform;\n    this.worker_.postMessage(message, [this.renderInstructions_.buffer]);\n    this.renderInstructions_ = null;\n\n    /** @type import('./Layer').WebGLWorkerGenerateBuffersMessage */\n    if (this.hitDetectionEnabled_) {\n      const hitMessage = {\n        type: WebGLWorkerMessageType.GENERATE_BUFFERS,\n        renderInstructions: this.hitRenderInstructions_.buffer,\n        customAttributesCount: 5 + this.customAttributes.length\n      };\n      hitMessage['projectionTransform'] = projectionTransform;\n      hitMessage['hitDetection'] = true;\n      this.worker_.postMessage(hitMessage, [this.hitRenderInstructions_.buffer]);\n      this.hitRenderInstructions_ = null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures) {\n    assert(this.hitDetectionEnabled_, 66);\n    if (!this.hitRenderInstructions_) {\n      return;\n    }\n\n    const pixel = applyTransform(frameState.coordinateToPixelTransform, coordinate.slice());\n\n    const data = this.hitRenderTarget_.readPixel(pixel[0], pixel[1]);\n    const color = [\n      data[0] / 255,\n      data[1] / 255,\n      data[2] / 255,\n      data[3] / 255\n    ];\n    const index = colorDecodeId(color);\n    const opacity = this.hitRenderInstructions_[index];\n    const uid = Math.floor(opacity).toString();\n\n    const source = this.getLayer().getSource();\n    const feature = source.getFeatureByUid(uid);\n    if (feature) {\n      return callback(feature, this.getLayer());\n    }\n  }\n\n  /**\n   * Render the hit detection data to the corresponding render target\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState current frame state\n   */\n  renderHitDetection(frameState) {\n    // skip render entirely if vertex buffers not ready/generated yet\n    if (!this.hitVerticesBuffer_.getSize()) {\n      return;\n    }\n\n    this.hitRenderTarget_.setSize(frameState.size);\n\n    this.helper.useProgram(this.hitProgram_);\n    this.helper.prepareDrawToRenderTarget(frameState, this.hitRenderTarget_, true);\n\n    this.helper.bindBuffer(this.hitVerticesBuffer_);\n    this.helper.bindBuffer(this.indicesBuffer_);\n\n    this.helper.enableAttributes(this.hitDetectionAttributes);\n\n    const renderCount = this.indicesBuffer_.getSize();\n    this.helper.drawElements(0, renderCount);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.worker_.terminate();\n    super.disposeInternal();\n  }\n}\n\nexport default WebGLPointsLayerRenderer;\n","/**\n * @module ol/format/OWS\n */\nimport {readHref} from './XLink.js';\nimport XML from './XML.js';\nimport {readString} from './xsd.js';\nimport {makeObjectPropertyPusher, makeObjectPropertySetter, makeStructureNS, pushParseAndPop} from '../xml.js';\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [null, 'http://www.opengis.net/ows/1.1'];\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ServiceIdentification': makeObjectPropertySetter(readServiceIdentification),\n    'ServiceProvider': makeObjectPropertySetter(readServiceProvider),\n    'OperationsMetadata': makeObjectPropertySetter(readOperationsMetadata)\n  });\n\n\nclass OWS extends XML {\n  constructor() {\n    super();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFromDocument(doc) {\n    for (let n = doc.firstChild; n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readFromNode(n);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFromNode(node) {\n    const owsObject = pushParseAndPop({},\n      PARSERS, node, []);\n    return owsObject ? owsObject : null;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst ADDRESS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'DeliveryPoint': makeObjectPropertySetter(readString),\n    'City': makeObjectPropertySetter(readString),\n    'AdministrativeArea': makeObjectPropertySetter(readString),\n    'PostalCode': makeObjectPropertySetter(readString),\n    'Country': makeObjectPropertySetter(readString),\n    'ElectronicMailAddress': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst ALLOWED_VALUES_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Value': makeObjectPropertyPusher(readValue)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst CONSTRAINT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'AllowedValues': makeObjectPropertySetter(readAllowedValues)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst CONTACT_INFO_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Phone': makeObjectPropertySetter(readPhone),\n    'Address': makeObjectPropertySetter(readAddress)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst DCP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'HTTP': makeObjectPropertySetter(readHttp)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst HTTP_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Get': makeObjectPropertyPusher(readGet),\n    'Post': undefined // TODO\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst OPERATION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'DCP': makeObjectPropertySetter(readDcp)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst OPERATIONS_METADATA_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Operation': readOperation\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PHONE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Voice': makeObjectPropertySetter(readString),\n    'Facsimile': makeObjectPropertySetter(readString)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst REQUEST_METHOD_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Constraint': makeObjectPropertyPusher(readConstraint)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SERVICE_CONTACT_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'IndividualName': makeObjectPropertySetter(readString),\n        'PositionName': makeObjectPropertySetter(readString),\n        'ContactInfo': makeObjectPropertySetter(readContactInfo)\n      });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SERVICE_IDENTIFICATION_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'Abstract': makeObjectPropertySetter(readString),\n        'AccessConstraints': makeObjectPropertySetter(readString),\n        'Fees': makeObjectPropertySetter(readString),\n        'Title': makeObjectPropertySetter(readString),\n        'ServiceTypeVersion': makeObjectPropertySetter(readString),\n        'ServiceType': makeObjectPropertySetter(readString)\n      });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst SERVICE_PROVIDER_PARSERS =\n    makeStructureNS(\n      NAMESPACE_URIS, {\n        'ProviderName': makeObjectPropertySetter(readString),\n        'ProviderSite': makeObjectPropertySetter(readHref),\n        'ServiceContact': makeObjectPropertySetter(readServiceContact)\n      });\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The address.\n */\nfunction readAddress(node, objectStack) {\n  return pushParseAndPop({},\n    ADDRESS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The values.\n */\nfunction readAllowedValues(node, objectStack) {\n  return pushParseAndPop({},\n    ALLOWED_VALUES_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The constraint.\n */\nfunction readConstraint(node, objectStack) {\n  const name = node.getAttribute('name');\n  if (!name) {\n    return undefined;\n  }\n  return pushParseAndPop({'name': name},\n    CONSTRAINT_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The contact info.\n */\nfunction readContactInfo(node, objectStack) {\n  return pushParseAndPop({},\n    CONTACT_INFO_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The DCP.\n */\nfunction readDcp(node, objectStack) {\n  return pushParseAndPop({},\n    DCP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The GET object.\n */\nfunction readGet(node, objectStack) {\n  const href = readHref(node);\n  if (!href) {\n    return undefined;\n  }\n  return pushParseAndPop({'href': href},\n    REQUEST_METHOD_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The HTTP object.\n */\nfunction readHttp(node, objectStack) {\n  return pushParseAndPop({}, HTTP_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The operation.\n */\nfunction readOperation(node, objectStack) {\n  const name = node.getAttribute('name');\n  const value = pushParseAndPop({},\n    OPERATION_PARSERS, node, objectStack);\n  if (!value) {\n    return undefined;\n  }\n  const object = /** @type {Object} */\n      (objectStack[objectStack.length - 1]);\n  object[name] = value;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The operations metadata.\n */\nfunction readOperationsMetadata(node, objectStack) {\n  return pushParseAndPop({},\n    OPERATIONS_METADATA_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The phone.\n */\nfunction readPhone(node, objectStack) {\n  return pushParseAndPop({},\n    PHONE_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service identification.\n */\nfunction readServiceIdentification(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_IDENTIFICATION_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service contact.\n */\nfunction readServiceContact(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_CONTACT_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} The service provider.\n */\nfunction readServiceProvider(node, objectStack) {\n  return pushParseAndPop(\n    {}, SERVICE_PROVIDER_PARSERS, node,\n    objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {string|undefined} The value.\n */\nfunction readValue(node, objectStack) {\n  return readString(node);\n}\n\n\nexport default OWS;\n","/**\n * @module ol/format/WMTSCapabilities\n */\nimport {boundingExtent} from '../extent.js';\nimport OWS from './OWS.js';\nimport {readHref} from './XLink.js';\nimport XML from './XML.js';\nimport {readString, readNonNegativeInteger, readDecimal} from './xsd.js';\nimport {pushParseAndPop, makeStructureNS,\n  makeObjectPropertySetter, makeObjectPropertyPusher, makeArrayPusher} from '../xml.js';\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://www.opengis.net/wmts/1.0'\n];\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst OWS_NAMESPACE_URIS = [\n  null,\n  'http://www.opengis.net/ows/1.1'\n];\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Contents': makeObjectPropertySetter(readContents)\n  });\n\n\n/**\n * @classdesc\n * Format for reading WMTS capabilities data.\n *\n * @api\n */\nclass WMTSCapabilities extends XML {\n  constructor() {\n    super();\n\n    /**\n     * @type {OWS}\n     * @private\n     */\n    this.owsParser_ = new OWS();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFromDocument(doc) {\n    for (let n = doc.firstChild; n; n = n.nextSibling) {\n      if (n.nodeType == Node.ELEMENT_NODE) {\n        return this.readFromNode(n);\n      }\n    }\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFromNode(node) {\n    const version = node.getAttribute('version').trim();\n    let WMTSCapabilityObject = this.owsParser_.readFromNode(node);\n    if (!WMTSCapabilityObject) {\n      return null;\n    }\n    WMTSCapabilityObject['version'] = version;\n    WMTSCapabilityObject = pushParseAndPop(WMTSCapabilityObject, PARSERS, node, []);\n    return WMTSCapabilityObject ? WMTSCapabilityObject : null;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst CONTENTS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Layer': makeObjectPropertyPusher(readLayer),\n    'TileMatrixSet': makeObjectPropertyPusher(readTileMatrixSet)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LAYER_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Style': makeObjectPropertyPusher(readStyle),\n    'Format': makeObjectPropertyPusher(readString),\n    'TileMatrixSetLink': makeObjectPropertyPusher(readTileMatrixSetLink),\n    'Dimension': makeObjectPropertyPusher(readDimensions),\n    'ResourceURL': makeObjectPropertyPusher(readResourceUrl)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'Abstract': makeObjectPropertySetter(readString),\n    'WGS84BoundingBox': makeObjectPropertySetter(readWgs84BoundingBox),\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst STYLE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'LegendURL': makeObjectPropertyPusher(readLegendUrl)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Title': makeObjectPropertySetter(readString),\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_LINKS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TileMatrixSet': makeObjectPropertySetter(readString),\n    'TileMatrixSetLimits': makeObjectPropertySetter(readTileMatrixLimitsList)\n  });\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_LIMITS_LIST_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TileMatrixLimits': makeArrayPusher(readTileMatrixLimits)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_LIMITS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TileMatrix': makeObjectPropertySetter(readString),\n    'MinTileRow': makeObjectPropertySetter(readNonNegativeInteger),\n    'MaxTileRow': makeObjectPropertySetter(readNonNegativeInteger),\n    'MinTileCol': makeObjectPropertySetter(readNonNegativeInteger),\n    'MaxTileCol': makeObjectPropertySetter(readNonNegativeInteger)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst DIMENSION_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'Default': makeObjectPropertySetter(readString),\n    'Value': makeObjectPropertyPusher(readString)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst WGS84_BBOX_READERS = makeStructureNS(\n  OWS_NAMESPACE_URIS, {\n    'LowerCorner': makeArrayPusher(readCoordinates),\n    'UpperCorner': makeArrayPusher(readCoordinates)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TMS_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'WellKnownScaleSet': makeObjectPropertySetter(readString),\n    'TileMatrix': makeObjectPropertyPusher(readTileMatrix)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'SupportedCRS': makeObjectPropertySetter(readString),\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TM_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'TopLeftCorner': makeObjectPropertySetter(readCoordinates),\n    'ScaleDenominator': makeObjectPropertySetter(readDecimal),\n    'TileWidth': makeObjectPropertySetter(readNonNegativeInteger),\n    'TileHeight': makeObjectPropertySetter(readNonNegativeInteger),\n    'MatrixWidth': makeObjectPropertySetter(readNonNegativeInteger),\n    'MatrixHeight': makeObjectPropertySetter(readNonNegativeInteger)\n  }, makeStructureNS(OWS_NAMESPACE_URIS, {\n    'Identifier': makeObjectPropertySetter(readString)\n  }));\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Attribution object.\n */\nfunction readContents(node, objectStack) {\n  return pushParseAndPop({}, CONTENTS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Layers object.\n */\nfunction readLayer(node, objectStack) {\n  return pushParseAndPop({}, LAYER_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Tile Matrix Set object.\n */\nfunction readTileMatrixSet(node, objectStack) {\n  return pushParseAndPop({}, TMS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Style object.\n */\nfunction readStyle(node, objectStack) {\n  const style = pushParseAndPop({}, STYLE_PARSERS, node, objectStack);\n  if (!style) {\n    return undefined;\n  }\n  const isDefault = node.getAttribute('isDefault') === 'true';\n  style['isDefault'] = isDefault;\n  return style;\n\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Tile Matrix Set Link object.\n */\nfunction readTileMatrixSetLink(node, objectStack) {\n  return pushParseAndPop({}, TMS_LINKS_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Dimension object.\n */\nfunction readDimensions(node, objectStack) {\n  return pushParseAndPop({}, DIMENSION_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Resource URL object.\n */\nfunction readResourceUrl(node, objectStack) {\n  const format = node.getAttribute('format');\n  const template = node.getAttribute('template');\n  const resourceType = node.getAttribute('resourceType');\n  const resource = {};\n  if (format) {\n    resource['format'] = format;\n  }\n  if (template) {\n    resource['template'] = template;\n  }\n  if (resourceType) {\n    resource['resourceType'] = resourceType;\n  }\n  return resource;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} WGS84 BBox object.\n */\nfunction readWgs84BoundingBox(node, objectStack) {\n  const coordinates = pushParseAndPop([], WGS84_BBOX_READERS, node, objectStack);\n  if (coordinates.length != 2) {\n    return undefined;\n  }\n  return boundingExtent(coordinates);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Legend object.\n */\nfunction readLegendUrl(node, objectStack) {\n  const legend = {};\n  legend['format'] = node.getAttribute('format');\n  legend['href'] = readHref(node);\n  return legend;\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} Coordinates object.\n */\nfunction readCoordinates(node, objectStack) {\n  const coordinates = readString(node).split(/\\s+/);\n  if (!coordinates || coordinates.length != 2) {\n    return undefined;\n  }\n  const x = +coordinates[0];\n  const y = +coordinates[1];\n  if (isNaN(x) || isNaN(y)) {\n    return undefined;\n  }\n  return [x, y];\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrix object.\n */\nfunction readTileMatrix(node, objectStack) {\n  return pushParseAndPop({}, TM_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrixSetLimits Object.\n */\nfunction readTileMatrixLimitsList(node, objectStack) {\n  return pushParseAndPop([], TMS_LIMITS_LIST_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Object|undefined} TileMatrixLimits Array.\n */\nfunction readTileMatrixLimits(node, objectStack) {\n  return pushParseAndPop({}, TMS_LIMITS_PARSERS, node, objectStack);\n}\n\n\nexport default WMTSCapabilities;\n","/**\n * @license\n * Latitude/longitude spherical geodesy formulae taken from\n * http://www.movable-type.co.uk/scripts/latlong.html\n * Licensed under CC-BY-3.0.\n */\n\n/**\n * @module ol/sphere\n */\nimport {toRadians, toDegrees} from './math.js';\nimport GeometryType from './geom/GeometryType.js';\n\n\n/**\n * Object literal with options for the {@link getLength} or {@link getArea}\n * functions.\n * @typedef {Object} SphereMetricOptions\n * @property {import(\"./proj.js\").ProjectionLike} [projection='EPSG:3857']\n * Projection of the  geometry.  By default, the geometry is assumed to be in\n * Web Mercator.\n * @property {number} [radius=6371008.8] Sphere radius.  By default, the\n * [mean Earth radius](https://en.wikipedia.org/wiki/Earth_radius#Mean_radius)\n * for the WGS84 ellipsoid is used.\n */\n\n\n/**\n * The mean Earth radius (1/3 * (2a + b)) for the WGS84 ellipsoid.\n * https://en.wikipedia.org/wiki/Earth_radius#Mean_radius\n * @type {number}\n */\nexport const DEFAULT_RADIUS = 6371008.8;\n\n\n/**\n * Get the great circle distance (in meters) between two geographic coordinates.\n * @param {Array} c1 Starting coordinate.\n * @param {Array} c2 Ending coordinate.\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {number} The great circle distance between the points (in meters).\n * @api\n */\nexport function getDistance(c1, c2, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lat2 = toRadians(c2[1]);\n  const deltaLatBy2 = (lat2 - lat1) / 2;\n  const deltaLonBy2 = toRadians(c2[0] - c1[0]) / 2;\n  const a = Math.sin(deltaLatBy2) * Math.sin(deltaLatBy2) +\n      Math.sin(deltaLonBy2) * Math.sin(deltaLonBy2) *\n      Math.cos(lat1) * Math.cos(lat2);\n  return 2 * radius * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n}\n\n\n/**\n * Get the cumulative great circle length of linestring coordinates (geographic).\n * @param {Array} coordinates Linestring coordinates.\n * @param {number} radius The sphere radius to use.\n * @return {number} The length (in meters).\n */\nfunction getLengthInternal(coordinates, radius) {\n  let length = 0;\n  for (let i = 0, ii = coordinates.length; i < ii - 1; ++i) {\n    length += getDistance(coordinates[i], coordinates[i + 1], radius);\n  }\n  return length;\n}\n\n\n/**\n * Get the spherical length of a geometry.  This length is the sum of the\n * great circle distances between coordinates.  For polygons, the length is\n * the sum of all rings.  For points, the length is zero.  For multi-part\n * geometries, the length is the sum of the length of each part.\n * @param {import(\"./geom/Geometry.js\").default} geometry A geometry.\n * @param {SphereMetricOptions=} opt_options Options for the\n * length calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n * You can change this by providing a `projection` option.\n * @return {number} The spherical length (in meters).\n * @api\n */\nexport function getLength(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let length = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT: {\n      break;\n    }\n    case GeometryType.LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      coordinates = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (geometry).getCoordinates();\n      length = getLengthInternal(coordinates, radius);\n      break;\n    }\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        length += getLengthInternal(coordinates[i], radius);\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        for (j = 0, jj = coords.length; j < jj; ++j) {\n          length += getLengthInternal(coords[j], radius);\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {import(\"./geom/GeometryCollection.js\").default} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        length += getLength(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return length;\n}\n\n\n/**\n * Returns the spherical area for a list of coordinates.\n *\n * [Reference](https://trs-new.jpl.nasa.gov/handle/2014/40409)\n * Robert. G. Chamberlain and William H. Duquette, \"Some Algorithms for\n * Polygons on a Sphere\", JPL Publication 07-03, Jet Propulsion\n * Laboratory, Pasadena, CA, June 2007\n *\n * @param {Array<import(\"./coordinate.js\").Coordinate>} coordinates List of coordinates of a linear\n * ring. If the ring is oriented clockwise, the area will be positive,\n * otherwise it will be negative.\n * @param {number} radius The sphere radius.\n * @return {number} Area (in square meters).\n */\nfunction getAreaInternal(coordinates, radius) {\n  let area = 0;\n  const len = coordinates.length;\n  let x1 = coordinates[len - 1][0];\n  let y1 = coordinates[len - 1][1];\n  for (let i = 0; i < len; i++) {\n    const x2 = coordinates[i][0];\n    const y2 = coordinates[i][1];\n    area += toRadians(x2 - x1) *\n        (2 + Math.sin(toRadians(y1)) +\n        Math.sin(toRadians(y2)));\n    x1 = x2;\n    y1 = y2;\n  }\n  return area * radius * radius / 2.0;\n}\n\n\n/**\n * Get the spherical area of a geometry.  This is the area (in meters) assuming\n * that polygon edges are segments of great circles on a sphere.\n * @param {import(\"./geom/Geometry.js\").default} geometry A geometry.\n * @param {SphereMetricOptions=} opt_options Options for the area\n *     calculation.  By default, geometries are assumed to be in 'EPSG:3857'.\n *     You can change this by providing a `projection` option.\n * @return {number} The spherical area (in square meters).\n * @api\n */\nexport function getArea(geometry, opt_options) {\n  const options = opt_options || {};\n  const radius = options.radius || DEFAULT_RADIUS;\n  const projection = options.projection || 'EPSG:3857';\n  const type = geometry.getType();\n  if (type !== GeometryType.GEOMETRY_COLLECTION) {\n    geometry = geometry.clone().transform(projection, 'EPSG:4326');\n  }\n  let area = 0;\n  let coordinates, coords, i, ii, j, jj;\n  switch (type) {\n    case GeometryType.POINT:\n    case GeometryType.MULTI_POINT:\n    case GeometryType.LINE_STRING:\n    case GeometryType.MULTI_LINE_STRING:\n    case GeometryType.LINEAR_RING: {\n      break;\n    }\n    case GeometryType.POLYGON: {\n      coordinates = /** @type {import(\"./geom/Polygon.js\").default} */ (geometry).getCoordinates();\n      area = Math.abs(getAreaInternal(coordinates[0], radius));\n      for (i = 1, ii = coordinates.length; i < ii; ++i) {\n        area -= Math.abs(getAreaInternal(coordinates[i], radius));\n      }\n      break;\n    }\n    case GeometryType.MULTI_POLYGON: {\n      coordinates = /** @type {import(\"./geom/SimpleGeometry.js\").default} */ (geometry).getCoordinates();\n      for (i = 0, ii = coordinates.length; i < ii; ++i) {\n        coords = coordinates[i];\n        area += Math.abs(getAreaInternal(coords[0], radius));\n        for (j = 1, jj = coords.length; j < jj; ++j) {\n          area -= Math.abs(getAreaInternal(coords[j], radius));\n        }\n      }\n      break;\n    }\n    case GeometryType.GEOMETRY_COLLECTION: {\n      const geometries = /** @type {import(\"./geom/GeometryCollection.js\").default} */ (geometry).getGeometries();\n      for (i = 0, ii = geometries.length; i < ii; ++i) {\n        area += getArea(geometries[i], opt_options);\n      }\n      break;\n    }\n    default: {\n      throw new Error('Unsupported geometry type: ' + type);\n    }\n  }\n  return area;\n}\n\n\n/**\n * Returns the coordinate at the given distance and bearing from `c1`.\n *\n * @param {import(\"./coordinate.js\").Coordinate} c1 The origin point (`[lon, lat]` in degrees).\n * @param {number} distance The great-circle distance between the origin\n *     point and the target point.\n * @param {number} bearing The bearing (in radians).\n * @param {number=} opt_radius The sphere radius to use.  Defaults to the Earth's\n *     mean radius using the WGS84 ellipsoid.\n * @return {import(\"./coordinate.js\").Coordinate} The target point.\n */\nexport function offset(c1, distance, bearing, opt_radius) {\n  const radius = opt_radius || DEFAULT_RADIUS;\n  const lat1 = toRadians(c1[1]);\n  const lon1 = toRadians(c1[0]);\n  const dByR = distance / radius;\n  const lat = Math.asin(\n    Math.sin(lat1) * Math.cos(dByR) +\n      Math.cos(lat1) * Math.sin(dByR) * Math.cos(bearing));\n  const lon = lon1 + Math.atan2(\n    Math.sin(bearing) * Math.sin(dByR) * Math.cos(lat1),\n    Math.cos(dByR) - Math.sin(lat1) * Math.sin(lat));\n  return [toDegrees(lon), toDegrees(lat)];\n}\n","/**\n * @module ol/interaction/Modify\n */\nimport {getUid} from '../util.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport Feature from '../Feature.js';\nimport MapBrowserEventType from '../MapBrowserEventType.js';\nimport {equals} from '../array.js';\nimport {equals as coordinatesEqual, distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, squaredDistanceToSegment, closestOnSegment} from '../coordinate.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {always, primaryAction, altKeyOnly, singleClick} from '../events/condition.js';\nimport {boundingExtent, buffer as bufferExtent, createOrUpdateFromCoordinate as createExtent} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport Point from '../geom/Point.js';\nimport PointerInteraction from './Pointer.js';\nimport VectorLayer from '../layer/Vector.js';\nimport VectorSource from '../source/Vector.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\nimport {createEditingStyle} from '../style/Style.js';\nimport {fromUserExtent, toUserExtent, fromUserCoordinate, toUserCoordinate} from '../proj.js';\n\n\n/**\n * The segment index assigned to a circle's center when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CENTER_INDEX = 0;\n\n/**\n * The segment index assigned to a circle's circumference when\n * breaking up a circle into ModifySegmentDataType segments.\n * @type {number}\n */\nconst CIRCLE_CIRCUMFERENCE_INDEX = 1;\n\nconst tempExtent = [0, 0, 0, 0];\nconst tempSegment = [];\n\n/**\n * @enum {string}\n */\nconst ModifyEventType = {\n  /**\n   * Triggered upon feature modification start\n   * @event ModifyEvent#modifystart\n   * @api\n   */\n  MODIFYSTART: 'modifystart',\n  /**\n   * Triggered upon feature modification end\n   * @event ModifyEvent#modifyend\n   * @api\n   */\n  MODIFYEND: 'modifyend'\n};\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {Array<number>} [depth]\n * @property {Feature} feature\n * @property {import(\"../geom/SimpleGeometry.js\").default} geometry\n * @property {number} [index]\n * @property {Array<import(\"../extent.js\").Extent>} segment\n * @property {Array<SegmentData>} [featureSegments]\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event will be considered to add or move a\n * vertex to the sketch. Default is\n * {@link module:ol/events/condition~primaryAction}.\n * @property {import(\"../events/condition.js\").Condition} [deleteCondition] A function\n * that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled. By default,\n * {@link module:ol/events/condition~singleClick} with\n * {@link module:ol/events/condition~altKeyOnly} results in a vertex deletion.\n * @property {import(\"../events/condition.js\").Condition} [insertVertexCondition] A\n * function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and\n * returns a boolean to indicate whether a new vertex should be added to the sketch\n * features. Default is {@link module:ol/events/condition~always}.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the\n * pointer close enough to a segment or vertex for editing.\n * @property {import(\"../style/Style.js\").StyleLike} [style]\n * Style used for the features being modified. By default the default edit\n * style is used (see {@link module:ol/style}).\n * @property {VectorSource} [source] The vector source with\n * features to modify.  If a vector source is not provided, a feature collection\n * must be provided with the features option.\n * @property {Collection<Feature>} [features]\n * The features the interaction works on.  If a feature collection is not\n * provided, a vector source must be provided with the source option.\n * @property {boolean} [wrapX=false] Wrap the world horizontally on the sketch\n * overlay.\n */\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/Modify~Modify} instances are\n * instances of this type.\n */\nexport class ModifyEvent extends Event {\n  /**\n   * @param {ModifyEventType} type Type.\n   * @param {Collection<Feature>} features\n   * The features modified.\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} mapBrowserPointerEvent\n   * Associated {@link module:ol/MapBrowserPointerEvent}.\n   */\n  constructor(type, features, mapBrowserPointerEvent) {\n    super(type);\n\n    /**\n     * The features being modified.\n     * @type {Collection<Feature>}\n     * @api\n     */\n    this.features = features;\n\n    /**\n     * Associated {@link module:ol/MapBrowserEvent}.\n     * @type {import(\"../MapBrowserEvent.js\").default}\n     * @api\n     */\n    this.mapBrowserEvent = mapBrowserPointerEvent;\n\n  }\n\n}\n\n\n/**\n * @classdesc\n * Interaction for modifying feature geometries.  To modify features that have\n * been added to an existing source, construct the modify interaction with the\n * `source` option.  If you want to modify features in a collection (for example,\n * the collection used by a select interaction), construct the interaction with\n * the `features` option.  The interaction must be constructed with either a\n * `source` or `features` option.\n *\n * By default, the interaction will allow deletion of vertices when the `alt`\n * key is pressed.  To configure the interaction with a different condition\n * for deletion, use the `deleteCondition` option.\n * @fires ModifyEvent\n * @api\n */\nclass Modify extends PointerInteraction {\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n\n    super(/** @type {import(\"./Pointer.js\").Options} */ (options));\n\n    /** @private */\n    this.boundHandleFeatureChange_ = this.handleFeatureChange_.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : primaryAction;\n\n    /**\n     * @private\n     * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Browser event.\n     * @return {boolean} Combined condition result.\n     */\n    this.defaultDeleteCondition_ = function(mapBrowserEvent) {\n      return altKeyOnly(mapBrowserEvent) && singleClick(mapBrowserEvent);\n    };\n\n    /**\n     * @type {import(\"../events/condition.js\").Condition}\n     * @private\n     */\n    this.deleteCondition_ = options.deleteCondition ?\n      options.deleteCondition : this.defaultDeleteCondition_;\n\n    /**\n     * @type {import(\"../events/condition.js\").Condition}\n     * @private\n     */\n    this.insertVertexCondition_ = options.insertVertexCondition ?\n      options.insertVertexCondition : always;\n\n    /**\n     * Editing vertex.\n     * @type {Feature}\n     * @private\n     */\n    this.vertexFeature_ = null;\n\n    /**\n     * Segments intersecting {@link this.vertexFeature_} by segment uid.\n     * @type {Object<string, boolean>}\n     * @private\n     */\n    this.vertexSegments_ = null;\n\n    /**\n     * @type {import(\"../pixel.js\").Pixel}\n     * @private\n     */\n    this.lastPixel_ = [0, 0];\n\n    /**\n     * Tracks if the next `singleclick` event should be ignored to prevent\n     * accidental deletion right after vertex creation.\n     * @type {boolean}\n     * @private\n     */\n    this.ignoreNextSingleClick_ = false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.modified_ = false;\n\n    /**\n     * Segment RTree for each layer\n     * @type {RBush<SegmentData>}\n     * @private\n     */\n    this.rBush_ = new RBush();\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n      options.pixelTolerance : 10;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.snappedToVertex_ = false;\n\n    /**\n     * Indicate whether the interaction is currently changing a feature's\n     * coordinates.\n     * @type {boolean}\n     * @private\n     */\n    this.changingFeature_ = false;\n\n    /**\n     * @type {Array}\n     * @private\n     */\n    this.dragSegments_ = [];\n\n    /**\n     * Draw overlay where sketch features are drawn.\n     * @type {VectorLayer}\n     * @private\n     */\n    this.overlay_ = new VectorLayer({\n      source: new VectorSource({\n        useSpatialIndex: false,\n        wrapX: !!options.wrapX\n      }),\n      style: options.style ? options.style : getDefaultStyleFunction(),\n      updateWhileAnimating: true,\n      updateWhileInteracting: true\n    });\n\n    /**\n     * @const\n     * @private\n     * @type {!Object<string, function(Feature, import(\"../geom/Geometry.js\").default): void>}\n     */\n    this.SEGMENT_WRITERS_ = {\n      'Point': this.writePointGeometry_.bind(this),\n      'LineString': this.writeLineStringGeometry_.bind(this),\n      'LinearRing': this.writeLineStringGeometry_.bind(this),\n      'Polygon': this.writePolygonGeometry_.bind(this),\n      'MultiPoint': this.writeMultiPointGeometry_.bind(this),\n      'MultiLineString': this.writeMultiLineStringGeometry_.bind(this),\n      'MultiPolygon': this.writeMultiPolygonGeometry_.bind(this),\n      'Circle': this.writeCircleGeometry_.bind(this),\n      'GeometryCollection': this.writeGeometryCollectionGeometry_.bind(this)\n    };\n\n\n    /**\n     * @type {VectorSource}\n     * @private\n     */\n    this.source_ = null;\n\n    let features;\n    if (options.source) {\n      this.source_ = options.source;\n      features = new Collection(this.source_.getFeatures());\n      this.source_.addEventListener(VectorEventType.ADDFEATURE, this.handleSourceAdd_.bind(this));\n      this.source_.addEventListener(VectorEventType.REMOVEFEATURE, this.handleSourceRemove_.bind(this));\n    } else {\n      features = options.features;\n    }\n    if (!features) {\n      throw new Error('The modify interaction requires features or a source');\n    }\n\n    /**\n     * @type {Collection<Feature>}\n     * @private\n     */\n    this.features_ = features;\n\n    this.features_.forEach(this.addFeature_.bind(this));\n    this.features_.addEventListener(CollectionEventType.ADD, this.handleFeatureAdd_.bind(this));\n    this.features_.addEventListener(CollectionEventType.REMOVE, this.handleFeatureRemove_.bind(this));\n\n    /**\n     * @type {import(\"../MapBrowserPointerEvent.js\").default}\n     * @private\n     */\n    this.lastPointerEvent_ = null;\n\n  }\n\n  /**\n   * @param {Feature} feature Feature.\n   * @private\n   */\n  addFeature_(feature) {\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      const writer = this.SEGMENT_WRITERS_[geometry.getType()];\n      if (writer) {\n        writer(feature, geometry);\n      }\n    }\n    const map = this.getMap();\n    if (map && map.isRendered() && this.getActive()) {\n      this.handlePointerAtPixel_(this.lastPixel_, map);\n    }\n    feature.addEventListener(EventType.CHANGE, this.boundHandleFeatureChange_);\n  }\n\n  /**\n   * @param {import(\"../MapBrowserPointerEvent.js\").default} evt Map browser event\n   * @private\n   */\n  willModifyFeatures_(evt) {\n    if (!this.modified_) {\n      this.modified_ = true;\n      this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYSTART, this.features_, evt));\n    }\n  }\n\n  /**\n   * @param {Feature} feature Feature.\n   * @private\n   */\n  removeFeature_(feature) {\n    this.removeFeatureSegmentData_(feature);\n    // Remove the vertex feature if the collection of canditate features is empty.\n    if (this.vertexFeature_ && this.features_.getLength() === 0) {\n      this.overlay_.getSource().removeFeature(this.vertexFeature_);\n      this.vertexFeature_ = null;\n    }\n    feature.removeEventListener(EventType.CHANGE, this.boundHandleFeatureChange_);\n  }\n\n  /**\n   * @param {Feature} feature Feature.\n   * @private\n   */\n  removeFeatureSegmentData_(feature) {\n    const rBush = this.rBush_;\n    /** @type {Array<SegmentData>} */\n    const nodesToRemove = [];\n    rBush.forEach(\n      /**\n       * @param {SegmentData} node RTree node.\n       */\n      function(node) {\n        if (feature === node.feature) {\n          nodesToRemove.push(node);\n        }\n      });\n    for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n      const nodeToRemove = nodesToRemove[i];\n      for (let j = this.dragSegments_.length - 1; j >= 0; --j) {\n        if (this.dragSegments_[j][0] === nodeToRemove) {\n          this.dragSegments_.splice(j, 1);\n        }\n      }\n      rBush.remove(nodeToRemove);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setActive(active) {\n    if (this.vertexFeature_ && !active) {\n      this.overlay_.getSource().removeFeature(this.vertexFeature_);\n      this.vertexFeature_ = null;\n    }\n    super.setActive(active);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setMap(map) {\n    this.overlay_.setMap(map);\n    super.setMap(map);\n  }\n\n  /**\n   * Get the overlay layer that this interaction renders sketch features to.\n   * @return {VectorLayer} Overlay layer.\n   * @api\n   */\n  getOverlay() {\n    return this.overlay_;\n  }\n\n  /**\n   * @param {import(\"../source/Vector.js\").VectorSourceEvent} event Event.\n   * @private\n   */\n  handleSourceAdd_(event) {\n    if (event.feature) {\n      this.features_.push(event.feature);\n    }\n  }\n\n  /**\n   * @param {import(\"../source/Vector.js\").VectorSourceEvent} event Event.\n   * @private\n   */\n  handleSourceRemove_(event) {\n    if (event.feature) {\n      this.features_.remove(event.feature);\n    }\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent} evt Event.\n   * @private\n   */\n  handleFeatureAdd_(evt) {\n    this.addFeature_(/** @type {Feature} */ (evt.element));\n  }\n\n  /**\n   * @param {import(\"../events/Event.js\").default} evt Event.\n   * @private\n   */\n  handleFeatureChange_(evt) {\n    if (!this.changingFeature_) {\n      const feature = /** @type {Feature} */ (evt.target);\n      this.removeFeature_(feature);\n      this.addFeature_(feature);\n    }\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent} evt Event.\n   * @private\n   */\n  handleFeatureRemove_(evt) {\n    const feature = /** @type {Feature} */ (evt.element);\n    this.removeFeature_(feature);\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {Point} geometry Geometry.\n   * @private\n   */\n  writePointGeometry_(feature, geometry) {\n    const coordinates = geometry.getCoordinates();\n\n    /** @type {SegmentData} */\n    const segmentData = {\n      feature: feature,\n      geometry: geometry,\n      segment: [coordinates, coordinates]\n    };\n\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {import(\"../geom/MultiPoint.js\").default} geometry Geometry.\n   * @private\n   */\n  writeMultiPointGeometry_(feature, geometry) {\n    const points = geometry.getCoordinates();\n    for (let i = 0, ii = points.length; i < ii; ++i) {\n      const coordinates = points[i];\n\n      /** @type {SegmentData} */\n      const segmentData = {\n        feature: feature,\n        geometry: geometry,\n        depth: [i],\n        index: i,\n        segment: [coordinates, coordinates]\n      };\n\n      this.rBush_.insert(geometry.getExtent(), segmentData);\n    }\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {import(\"../geom/LineString.js\").default} geometry Geometry.\n   * @private\n   */\n  writeLineStringGeometry_(feature, geometry) {\n    const coordinates = geometry.getCoordinates();\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n\n      /** @type {SegmentData} */\n      const segmentData = {\n        feature: feature,\n        geometry: geometry,\n        index: i,\n        segment: segment\n      };\n\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {import(\"../geom/MultiLineString.js\").default} geometry Geometry.\n   * @private\n   */\n  writeMultiLineStringGeometry_(feature, geometry) {\n    const lines = geometry.getCoordinates();\n    for (let j = 0, jj = lines.length; j < jj; ++j) {\n      const coordinates = lines[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n\n        /** @type {SegmentData} */\n        const segmentData = {\n          feature: feature,\n          geometry: geometry,\n          depth: [j],\n          index: i,\n          segment: segment\n        };\n\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {import(\"../geom/Polygon.js\").default} geometry Geometry.\n   * @private\n   */\n  writePolygonGeometry_(feature, geometry) {\n    const rings = geometry.getCoordinates();\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n\n        /** @type {SegmentData} */\n        const segmentData = {\n          feature: feature,\n          geometry: geometry,\n          depth: [j],\n          index: i,\n          segment: segment\n        };\n\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n   * @private\n   */\n  writeMultiPolygonGeometry_(feature, geometry) {\n    const polygons = geometry.getCoordinates();\n    for (let k = 0, kk = polygons.length; k < kk; ++k) {\n      const rings = polygons[k];\n      for (let j = 0, jj = rings.length; j < jj; ++j) {\n        const coordinates = rings[j];\n        for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n          const segment = coordinates.slice(i, i + 2);\n\n          /** @type {SegmentData} */\n          const segmentData = {\n            feature: feature,\n            geometry: geometry,\n            depth: [j, k],\n            index: i,\n            segment: segment\n          };\n\n          this.rBush_.insert(boundingExtent(segment), segmentData);\n        }\n      }\n    }\n  }\n\n  /**\n   * We convert a circle into two segments.  The segment at index\n   * {@link CIRCLE_CENTER_INDEX} is the\n   * circle's center (a point).  The segment at index\n   * {@link CIRCLE_CIRCUMFERENCE_INDEX} is\n   * the circumference, and is not a line segment.\n   *\n   * @param {Feature} feature Feature.\n   * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n   * @private\n   */\n  writeCircleGeometry_(feature, geometry) {\n    const coordinates = geometry.getCenter();\n\n    /** @type {SegmentData} */\n    const centerSegmentData = {\n      feature: feature,\n      geometry: geometry,\n      index: CIRCLE_CENTER_INDEX,\n      segment: [coordinates, coordinates]\n    };\n\n    /** @type {SegmentData} */\n    const circumferenceSegmentData = {\n      feature: feature,\n      geometry: geometry,\n      index: CIRCLE_CIRCUMFERENCE_INDEX,\n      segment: [coordinates, coordinates]\n    };\n\n    const featureSegments = [centerSegmentData, circumferenceSegmentData];\n    centerSegmentData.featureSegments = circumferenceSegmentData.featureSegments = featureSegments;\n    this.rBush_.insert(createExtent(coordinates), centerSegmentData);\n    this.rBush_.insert(geometry.getExtent(), circumferenceSegmentData);\n  }\n\n  /**\n   * @param {Feature} feature Feature\n   * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n   * @private\n   */\n  writeGeometryCollectionGeometry_(feature, geometry) {\n    const geometries = geometry.getGeometriesArray();\n    for (let i = 0; i < geometries.length; ++i) {\n      const geometry = geometries[i];\n      const writer = this.SEGMENT_WRITERS_[geometry.getType()];\n      writer(feature, geometry);\n    }\n  }\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinates Coordinates.\n   * @return {Feature} Vertex feature.\n   * @private\n   */\n  createOrUpdateVertexFeature_(coordinates) {\n    let vertexFeature = this.vertexFeature_;\n    if (!vertexFeature) {\n      vertexFeature = new Feature(new Point(coordinates));\n      this.vertexFeature_ = vertexFeature;\n      this.overlay_.getSource().addFeature(vertexFeature);\n    } else {\n      const geometry = vertexFeature.getGeometry();\n      geometry.setCoordinates(coordinates);\n    }\n    return vertexFeature;\n  }\n\n  /**\n   * Handles the {@link module:ol/MapBrowserEvent map browser event} and may modify the geometry.\n   * @override\n   */\n  handleEvent(mapBrowserEvent) {\n    if (!(/** @type {import(\"../MapBrowserPointerEvent.js\").default} */ (mapBrowserEvent).pointerEvent)) {\n      return true;\n    }\n    this.lastPointerEvent_ = mapBrowserEvent;\n\n    let handled;\n    if (!mapBrowserEvent.map.getView().getInteracting() &&\n        mapBrowserEvent.type == MapBrowserEventType.POINTERMOVE &&\n        !this.handlingDownUpSequence) {\n      this.handlePointerMove_(mapBrowserEvent);\n    }\n    if (this.vertexFeature_ && this.deleteCondition_(mapBrowserEvent)) {\n      if (mapBrowserEvent.type != MapBrowserEventType.SINGLECLICK || !this.ignoreNextSingleClick_) {\n        handled = this.removePoint();\n      } else {\n        handled = true;\n      }\n    }\n\n    if (mapBrowserEvent.type == MapBrowserEventType.SINGLECLICK) {\n      this.ignoreNextSingleClick_ = false;\n    }\n\n    return super.handleEvent(mapBrowserEvent) && !handled;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(evt) {\n    this.ignoreNextSingleClick_ = false;\n    this.willModifyFeatures_(evt);\n\n    const vertex = evt.coordinate;\n    for (let i = 0, ii = this.dragSegments_.length; i < ii; ++i) {\n      const dragSegment = this.dragSegments_[i];\n      const segmentData = dragSegment[0];\n      const depth = segmentData.depth;\n      const geometry = segmentData.geometry;\n      let coordinates;\n      const segment = segmentData.segment;\n      const index = dragSegment[1];\n\n      while (vertex.length < geometry.getStride()) {\n        vertex.push(segment[index][vertex.length]);\n      }\n\n      switch (geometry.getType()) {\n        case GeometryType.POINT:\n          coordinates = vertex;\n          segment[0] = segment[1] = vertex;\n          break;\n        case GeometryType.MULTI_POINT:\n          coordinates = geometry.getCoordinates();\n          coordinates[segmentData.index] = vertex;\n          segment[0] = segment[1] = vertex;\n          break;\n        case GeometryType.LINE_STRING:\n          coordinates = geometry.getCoordinates();\n          coordinates[segmentData.index + index] = vertex;\n          segment[index] = vertex;\n          break;\n        case GeometryType.MULTI_LINE_STRING:\n          coordinates = geometry.getCoordinates();\n          coordinates[depth[0]][segmentData.index + index] = vertex;\n          segment[index] = vertex;\n          break;\n        case GeometryType.POLYGON:\n          coordinates = geometry.getCoordinates();\n          coordinates[depth[0]][segmentData.index + index] = vertex;\n          segment[index] = vertex;\n          break;\n        case GeometryType.MULTI_POLYGON:\n          coordinates = geometry.getCoordinates();\n          coordinates[depth[1]][depth[0]][segmentData.index + index] = vertex;\n          segment[index] = vertex;\n          break;\n        case GeometryType.CIRCLE:\n          segment[0] = segment[1] = vertex;\n          if (segmentData.index === CIRCLE_CENTER_INDEX) {\n            this.changingFeature_ = true;\n            geometry.setCenter(vertex);\n            this.changingFeature_ = false;\n          } else { // We're dragging the circle's circumference:\n            this.changingFeature_ = true;\n            geometry.setRadius(coordinateDistance(geometry.getCenter(), vertex));\n            this.changingFeature_ = false;\n          }\n          break;\n        default:\n          // pass\n      }\n\n      if (coordinates) {\n        this.setGeometryCoordinates_(geometry, coordinates);\n      }\n    }\n    this.createOrUpdateVertexFeature_(vertex);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(evt) {\n    if (!this.condition_(evt)) {\n      return false;\n    }\n    this.handlePointerAtPixel_(evt.pixel, evt.map);\n    const pixelCoordinate = evt.coordinate;\n    this.dragSegments_.length = 0;\n    this.modified_ = false;\n    const vertexFeature = this.vertexFeature_;\n    if (vertexFeature) {\n      const projection = evt.map.getView().getProjection();\n      const insertVertices = [];\n      const vertex = vertexFeature.getGeometry().getCoordinates();\n      const vertexExtent = boundingExtent([vertex]);\n      const segmentDataMatches = this.rBush_.getInExtent(vertexExtent);\n      const componentSegments = {};\n      segmentDataMatches.sort(compareIndexes);\n      for (let i = 0, ii = segmentDataMatches.length; i < ii; ++i) {\n        const segmentDataMatch = segmentDataMatches[i];\n        const segment = segmentDataMatch.segment;\n        let uid = getUid(segmentDataMatch.feature);\n        const depth = segmentDataMatch.depth;\n        if (depth) {\n          uid += '-' + depth.join('-'); // separate feature components\n        }\n        if (!componentSegments[uid]) {\n          componentSegments[uid] = new Array(2);\n        }\n\n        if (segmentDataMatch.geometry.getType() === GeometryType.CIRCLE && segmentDataMatch.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n          const closestVertex = closestOnSegmentData(pixelCoordinate, segmentDataMatch, projection);\n          if (coordinatesEqual(closestVertex, vertex) && !componentSegments[uid][0]) {\n            this.dragSegments_.push([segmentDataMatch, 0]);\n            componentSegments[uid][0] = segmentDataMatch;\n          }\n          continue;\n        }\n\n        if (coordinatesEqual(segment[0], vertex) && !componentSegments[uid][0]) {\n          this.dragSegments_.push([segmentDataMatch, 0]);\n          componentSegments[uid][0] = segmentDataMatch;\n          continue;\n        }\n\n        if (coordinatesEqual(segment[1], vertex) && !componentSegments[uid][1]) {\n          // prevent dragging closed linestrings by the connecting node\n          if ((segmentDataMatch.geometry.getType() ===\n              GeometryType.LINE_STRING ||\n              segmentDataMatch.geometry.getType() ===\n              GeometryType.MULTI_LINE_STRING) &&\n              componentSegments[uid][0] &&\n              componentSegments[uid][0].index === 0) {\n            continue;\n          }\n\n          this.dragSegments_.push([segmentDataMatch, 1]);\n          componentSegments[uid][1] = segmentDataMatch;\n          continue;\n        }\n\n        if (getUid(segment) in this.vertexSegments_ &&\n            (!componentSegments[uid][0] && !componentSegments[uid][1]) &&\n            this.insertVertexCondition_(evt)) {\n          insertVertices.push([segmentDataMatch, vertex]);\n        }\n      }\n\n      if (insertVertices.length) {\n        this.willModifyFeatures_(evt);\n      }\n\n      for (let j = insertVertices.length - 1; j >= 0; --j) {\n        this.insertVertex_.apply(this, insertVertices[j]);\n      }\n    }\n    return !!this.vertexFeature_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(evt) {\n    for (let i = this.dragSegments_.length - 1; i >= 0; --i) {\n      const segmentData = this.dragSegments_[i][0];\n      const geometry = segmentData.geometry;\n      if (geometry.getType() === GeometryType.CIRCLE) {\n        // Update a circle object in the R* bush:\n        const coordinates = geometry.getCenter();\n        const centerSegmentData = segmentData.featureSegments[0];\n        const circumferenceSegmentData = segmentData.featureSegments[1];\n        centerSegmentData.segment[0] = centerSegmentData.segment[1] = coordinates;\n        circumferenceSegmentData.segment[0] = circumferenceSegmentData.segment[1] = coordinates;\n        this.rBush_.update(createExtent(coordinates), centerSegmentData);\n        this.rBush_.update(geometry.getExtent(), circumferenceSegmentData);\n      } else {\n        this.rBush_.update(boundingExtent(segmentData.segment), segmentData);\n      }\n    }\n    if (this.modified_) {\n      this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n      this.modified_ = false;\n    }\n    return false;\n  }\n\n  /**\n   * @param {import(\"../MapBrowserEvent.js\").default} evt Event.\n   * @private\n   */\n  handlePointerMove_(evt) {\n    this.lastPixel_ = evt.pixel;\n    this.handlePointerAtPixel_(evt.pixel, evt.map);\n  }\n\n  /**\n   * @param {import(\"../pixel.js\").Pixel} pixel Pixel\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   * @private\n   */\n  handlePointerAtPixel_(pixel, map) {\n    const pixelCoordinate = map.getCoordinateFromPixel(pixel);\n    const projection = map.getView().getProjection();\n    const sortByDistance = function(a, b) {\n      return projectedDistanceToSegmentDataSquared(pixelCoordinate, a, projection) -\n          projectedDistanceToSegmentDataSquared(pixelCoordinate, b, projection);\n    };\n\n    const viewExtent = fromUserExtent(createExtent(pixelCoordinate, tempExtent), projection);\n    const buffer = map.getView().getResolution() * this.pixelTolerance_;\n    const box = toUserExtent(bufferExtent(viewExtent, buffer, tempExtent), projection);\n\n    const rBush = this.rBush_;\n    const nodes = rBush.getInExtent(box);\n    if (nodes.length > 0) {\n      nodes.sort(sortByDistance);\n      const node = nodes[0];\n      const closestSegment = node.segment;\n      let vertex = closestOnSegmentData(pixelCoordinate, node, projection);\n      const vertexPixel = map.getPixelFromCoordinate(vertex);\n      let dist = coordinateDistance(pixel, vertexPixel);\n      if (dist <= this.pixelTolerance_) {\n        /** @type {Object<string, boolean>} */\n        const vertexSegments = {};\n\n        if (node.geometry.getType() === GeometryType.CIRCLE && node.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n          this.snappedToVertex_ = true;\n          this.createOrUpdateVertexFeature_(vertex);\n        } else {\n          const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n          const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n          const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n          const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n          dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n          this.snappedToVertex_ = dist <= this.pixelTolerance_;\n          if (this.snappedToVertex_) {\n            vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n          }\n          this.createOrUpdateVertexFeature_(vertex);\n          for (let i = 1, ii = nodes.length; i < ii; ++i) {\n            const segment = nodes[i].segment;\n            if ((coordinatesEqual(closestSegment[0], segment[0]) &&\n                coordinatesEqual(closestSegment[1], segment[1]) ||\n                (coordinatesEqual(closestSegment[0], segment[1]) &&\n                coordinatesEqual(closestSegment[1], segment[0])))) {\n              vertexSegments[getUid(segment)] = true;\n            } else {\n              break;\n            }\n          }\n        }\n\n        vertexSegments[getUid(closestSegment)] = true;\n        this.vertexSegments_ = vertexSegments;\n        return;\n      }\n    }\n    if (this.vertexFeature_) {\n      this.overlay_.getSource().removeFeature(this.vertexFeature_);\n      this.vertexFeature_ = null;\n    }\n  }\n\n  /**\n   * @param {SegmentData} segmentData Segment data.\n   * @param {import(\"../coordinate.js\").Coordinate} vertex Vertex.\n   * @private\n   */\n  insertVertex_(segmentData, vertex) {\n    const segment = segmentData.segment;\n    const feature = segmentData.feature;\n    const geometry = segmentData.geometry;\n    const depth = segmentData.depth;\n    const index = segmentData.index;\n    let coordinates;\n\n    while (vertex.length < geometry.getStride()) {\n      vertex.push(0);\n    }\n\n    switch (geometry.getType()) {\n      case GeometryType.MULTI_LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]].splice(index + 1, 0, vertex);\n        break;\n      case GeometryType.POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[0]].splice(index + 1, 0, vertex);\n        break;\n      case GeometryType.MULTI_POLYGON:\n        coordinates = geometry.getCoordinates();\n        coordinates[depth[1]][depth[0]].splice(index + 1, 0, vertex);\n        break;\n      case GeometryType.LINE_STRING:\n        coordinates = geometry.getCoordinates();\n        coordinates.splice(index + 1, 0, vertex);\n        break;\n      default:\n        return;\n    }\n\n    this.setGeometryCoordinates_(geometry, coordinates);\n    const rTree = this.rBush_;\n    rTree.remove(segmentData);\n    this.updateSegmentIndices_(geometry, index, depth, 1);\n\n    /** @type {SegmentData} */\n    const newSegmentData = {\n      segment: [segment[0], vertex],\n      feature: feature,\n      geometry: geometry,\n      depth: depth,\n      index: index\n    };\n\n    rTree.insert(boundingExtent(newSegmentData.segment), newSegmentData);\n    this.dragSegments_.push([newSegmentData, 1]);\n\n    /** @type {SegmentData} */\n    const newSegmentData2 = {\n      segment: [vertex, segment[1]],\n      feature: feature,\n      geometry: geometry,\n      depth: depth,\n      index: index + 1\n    };\n\n    rTree.insert(boundingExtent(newSegmentData2.segment), newSegmentData2);\n    this.dragSegments_.push([newSegmentData2, 0]);\n    this.ignoreNextSingleClick_ = true;\n  }\n\n  /**\n   * Removes the vertex currently being pointed.\n   * @return {boolean} True when a vertex was removed.\n   * @api\n   */\n  removePoint() {\n    if (this.lastPointerEvent_ && this.lastPointerEvent_.type != MapBrowserEventType.POINTERDRAG) {\n      const evt = this.lastPointerEvent_;\n      this.willModifyFeatures_(evt);\n      const removed = this.removeVertex_();\n      this.dispatchEvent(new ModifyEvent(ModifyEventType.MODIFYEND, this.features_, evt));\n      this.modified_ = false;\n      return removed;\n    }\n    return false;\n  }\n\n  /**\n   * Removes a vertex from all matching features.\n   * @return {boolean} True when a vertex was removed.\n   * @private\n   */\n  removeVertex_() {\n    const dragSegments = this.dragSegments_;\n    const segmentsByFeature = {};\n    let deleted = false;\n    let component, coordinates, dragSegment, geometry, i, index, left;\n    let newIndex, right, segmentData, uid;\n    for (i = dragSegments.length - 1; i >= 0; --i) {\n      dragSegment = dragSegments[i];\n      segmentData = dragSegment[0];\n      uid = getUid(segmentData.feature);\n      if (segmentData.depth) {\n        // separate feature components\n        uid += '-' + segmentData.depth.join('-');\n      }\n      if (!(uid in segmentsByFeature)) {\n        segmentsByFeature[uid] = {};\n      }\n      if (dragSegment[1] === 0) {\n        segmentsByFeature[uid].right = segmentData;\n        segmentsByFeature[uid].index = segmentData.index;\n      } else if (dragSegment[1] == 1) {\n        segmentsByFeature[uid].left = segmentData;\n        segmentsByFeature[uid].index = segmentData.index + 1;\n      }\n\n    }\n    for (uid in segmentsByFeature) {\n      right = segmentsByFeature[uid].right;\n      left = segmentsByFeature[uid].left;\n      index = segmentsByFeature[uid].index;\n      newIndex = index - 1;\n      if (left !== undefined) {\n        segmentData = left;\n      } else {\n        segmentData = right;\n      }\n      if (newIndex < 0) {\n        newIndex = 0;\n      }\n      geometry = segmentData.geometry;\n      coordinates = geometry.getCoordinates();\n      component = coordinates;\n      deleted = false;\n      switch (geometry.getType()) {\n        case GeometryType.MULTI_LINE_STRING:\n          if (coordinates[segmentData.depth[0]].length > 2) {\n            coordinates[segmentData.depth[0]].splice(index, 1);\n            deleted = true;\n          }\n          break;\n        case GeometryType.LINE_STRING:\n          if (coordinates.length > 2) {\n            coordinates.splice(index, 1);\n            deleted = true;\n          }\n          break;\n        case GeometryType.MULTI_POLYGON:\n          component = component[segmentData.depth[1]];\n          /* falls through */\n        case GeometryType.POLYGON:\n          component = component[segmentData.depth[0]];\n          if (component.length > 4) {\n            if (index == component.length - 1) {\n              index = 0;\n            }\n            component.splice(index, 1);\n            deleted = true;\n            if (index === 0) {\n              // close the ring again\n              component.pop();\n              component.push(component[0]);\n              newIndex = component.length - 1;\n            }\n          }\n          break;\n        default:\n          // pass\n      }\n\n      if (deleted) {\n        this.setGeometryCoordinates_(geometry, coordinates);\n        const segments = [];\n        if (left !== undefined) {\n          this.rBush_.remove(left);\n          segments.push(left.segment[0]);\n        }\n        if (right !== undefined) {\n          this.rBush_.remove(right);\n          segments.push(right.segment[1]);\n        }\n        if (left !== undefined && right !== undefined) {\n\n          /** @type {SegmentData} */\n          const newSegmentData = {\n            depth: segmentData.depth,\n            feature: segmentData.feature,\n            geometry: segmentData.geometry,\n            index: newIndex,\n            segment: segments\n          };\n\n          this.rBush_.insert(boundingExtent(newSegmentData.segment), newSegmentData);\n        }\n        this.updateSegmentIndices_(geometry, index, segmentData.depth, -1);\n        if (this.vertexFeature_) {\n          this.overlay_.getSource().removeFeature(this.vertexFeature_);\n          this.vertexFeature_ = null;\n        }\n        dragSegments.length = 0;\n      }\n\n    }\n    return deleted;\n  }\n\n  /**\n   * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n   * @param {Array} coordinates Coordinates.\n   * @private\n   */\n  setGeometryCoordinates_(geometry, coordinates) {\n    this.changingFeature_ = true;\n    geometry.setCoordinates(coordinates);\n    this.changingFeature_ = false;\n  }\n\n  /**\n   * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n   * @param {number} index Index.\n   * @param {Array<number>|undefined} depth Depth.\n   * @param {number} delta Delta (1 or -1).\n   * @private\n   */\n  updateSegmentIndices_(geometry, index, depth, delta) {\n    this.rBush_.forEachInExtent(geometry.getExtent(), function(segmentDataMatch) {\n      if (segmentDataMatch.geometry === geometry &&\n          (depth === undefined || segmentDataMatch.depth === undefined ||\n          equals(segmentDataMatch.depth, depth)) &&\n          segmentDataMatch.index > index) {\n        segmentDataMatch.index += delta;\n      }\n    });\n  }\n}\n\n\n/**\n * @param {SegmentData} a The first segment data.\n * @param {SegmentData} b The second segment data.\n * @return {number} The difference in indexes.\n */\nfunction compareIndexes(a, b) {\n  return a.index - b.index;\n}\n\n\n/**\n * Returns the distance from a point to a line segment.\n *\n * @param {import(\"../coordinate.js\").Coordinate} pointCoordinates The coordinates of the point from\n *        which to calculate the distance.\n * @param {SegmentData} segmentData The object describing the line\n *        segment we are calculating the distance to.\n * @param {import(\"../proj/Projection.js\").default} projection The view projection.\n * @return {number} The square of the distance between a point and a line segment.\n */\nfunction projectedDistanceToSegmentDataSquared(pointCoordinates, segmentData, projection) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE) {\n    const circleGeometry = /** @type {import(\"../geom/Circle.js\").default} */ (geometry);\n\n    if (segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n      const distanceToCenterSquared =\n            squaredCoordinateDistance(circleGeometry.getCenter(), pointCoordinates);\n      const distanceToCircumference =\n            Math.sqrt(distanceToCenterSquared) - circleGeometry.getRadius();\n      return distanceToCircumference * distanceToCircumference;\n    }\n  }\n\n  const coordinate = fromUserCoordinate(pointCoordinates, projection);\n  tempSegment[0] = fromUserCoordinate(segmentData.segment[0], projection);\n  tempSegment[1] = fromUserCoordinate(segmentData.segment[1], projection);\n  return squaredDistanceToSegment(coordinate, tempSegment);\n}\n\n/**\n * Returns the point closest to a given line segment.\n *\n * @param {import(\"../coordinate.js\").Coordinate} pointCoordinates The point to which a closest point\n *        should be found.\n * @param {SegmentData} segmentData The object describing the line\n *        segment which should contain the closest point.\n * @param {import(\"../proj/Projection.js\").default} projection The view projection.\n * @return {import(\"../coordinate.js\").Coordinate} The point closest to the specified line segment.\n */\nfunction closestOnSegmentData(pointCoordinates, segmentData, projection) {\n  const geometry = segmentData.geometry;\n\n  if (geometry.getType() === GeometryType.CIRCLE && segmentData.index === CIRCLE_CIRCUMFERENCE_INDEX) {\n    return geometry.getClosestPoint(pointCoordinates);\n  }\n  const coordinate = fromUserCoordinate(pointCoordinates, projection);\n  tempSegment[0] = fromUserCoordinate(segmentData.segment[0], projection);\n  tempSegment[1] = fromUserCoordinate(segmentData.segment[1], projection);\n  return toUserCoordinate(closestOnSegment(coordinate, tempSegment), projection);\n}\n\n\n/**\n * @return {import(\"../style/Style.js\").StyleFunction} Styles.\n */\nfunction getDefaultStyleFunction() {\n  const style = createEditingStyle();\n  return function(feature, resolution) {\n    return style[GeometryType.POINT];\n  };\n}\n\n\nexport default Modify;\n","/**\n * @module ol/control/ScaleLine\n */\nimport {getChangeEventType} from '../Object.js';\nimport {assert} from '../asserts.js';\nimport Control from './Control.js';\nimport {CLASS_UNSELECTABLE} from '../css.js';\nimport {getPointResolution, METERS_PER_UNIT} from '../proj.js';\nimport ProjUnits from '../proj/Units.js';\n\n\n/**\n * @type {string}\n */\nconst UNITS_PROP = 'units';\n\n/**\n * Units for the scale line. Supported values are `'degrees'`, `'imperial'`,\n * `'nautical'`, `'metric'`, `'us'`.\n * @enum {string}\n */\nexport const Units = {\n  DEGREES: 'degrees',\n  IMPERIAL: 'imperial',\n  NAUTICAL: 'nautical',\n  METRIC: 'metric',\n  US: 'us'\n};\n\n\n/**\n * @const\n * @type {Array<number>}\n */\nconst LEADING_DIGITS = [1, 2, 5];\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-scale-line'] CSS Class name.\n * @property {number} [minWidth=64] Minimum width in pixels.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {HTMLElement|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {Units|string} [units='metric'] Units.\n * @property {boolean} [bar=false] Render scalebars instead of a line.\n * @property {number} [steps=4] Number of steps the scalebar should use. Use even numbers\n * for best results. Only applies when `bar` is `true`.\n * @property {boolean} [text=false] Render the text scale above of the scalebar. Only applies\n * when `bar` is `true`.\n */\n\n\n/**\n * @classdesc\n * A control displaying rough y-axis distances, calculated for the center of the\n * viewport. For conformal projections (e.g. EPSG:3857, the default view\n * projection in OpenLayers), the scale is valid for all directions.\n * No scale line will be shown when the y-axis distance of a pixel at the\n * viewport center cannot be calculated in the view projection.\n * By default the scale line will show in the bottom left portion of the map,\n * but this can be changed by using the css selector `.ol-scale-line`.\n * When specifying `bar` as `true`, a scalebar will be rendered instead\n * of a scaleline.\n *\n * @api\n */\nclass ScaleLine extends Control {\n\n  /**\n   * @param {Options=} opt_options Scale line options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    const className = options.className !== undefined ? options.className :\n      options.bar ? 'ol-scale-bar' : 'ol-scale-line';\n\n    super({\n      element: document.createElement('div'),\n      render: options.render || render,\n      target: options.target\n    });\n\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this.innerElement_ = document.createElement('div');\n    this.innerElement_.className = className + '-inner';\n\n    this.element.className = className + ' ' + CLASS_UNSELECTABLE;\n    this.element.appendChild(this.innerElement_);\n\n    /**\n     * @private\n     * @type {?import(\"../View.js\").State}\n     */\n    this.viewState_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.minWidth_ = options.minWidth !== undefined ? options.minWidth : 64;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderedVisible_ = false;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.renderedWidth_ = undefined;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.renderedHTML_ = '';\n\n    this.addEventListener(getChangeEventType(UNITS_PROP), this.handleUnitsChanged_);\n\n    this.setUnits(/** @type {Units} */ (options.units) || Units.METRIC);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.scaleBar_ = options.bar || false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.scaleBarSteps_ = options.steps || 4;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.scaleBarText_ = options.text || false;\n\n  }\n\n  /**\n   * Return the units to use in the scale line.\n   * @return {Units} The units\n   * to use in the scale line.\n   * @observable\n   * @api\n   */\n  getUnits() {\n    return this.get(UNITS_PROP);\n  }\n\n  /**\n   * @private\n   */\n  handleUnitsChanged_() {\n    this.updateElement_();\n  }\n\n  /**\n   * Set the units to use in the scale line.\n   * @param {Units} units The units to use in the scale line.\n   * @observable\n   * @api\n   */\n  setUnits(units) {\n    this.set(UNITS_PROP, units);\n  }\n\n  /**\n   * @private\n   */\n  updateElement_() {\n    const viewState = this.viewState_;\n\n    if (!viewState) {\n      if (this.renderedVisible_) {\n        this.element.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n      return;\n    }\n\n    const center = viewState.center;\n    const projection = viewState.projection;\n    const units = this.getUnits();\n    const pointResolutionUnits = units == Units.DEGREES ?\n      ProjUnits.DEGREES :\n      ProjUnits.METERS;\n    let pointResolution =\n        getPointResolution(projection, viewState.resolution, center, pointResolutionUnits);\n\n    let nominalCount = this.minWidth_ * pointResolution;\n    let suffix = '';\n    if (units == Units.DEGREES) {\n      const metersPerDegree = METERS_PER_UNIT[ProjUnits.DEGREES];\n      nominalCount *= metersPerDegree;\n      if (nominalCount < metersPerDegree / 60) {\n        suffix = '\\u2033'; // seconds\n        pointResolution *= 3600;\n      } else if (nominalCount < metersPerDegree) {\n        suffix = '\\u2032'; // minutes\n        pointResolution *= 60;\n      } else {\n        suffix = '\\u00b0'; // degrees\n      }\n    } else if (units == Units.IMPERIAL) {\n      if (nominalCount < 0.9144) {\n        suffix = 'in';\n        pointResolution /= 0.0254;\n      } else if (nominalCount < 1609.344) {\n        suffix = 'ft';\n        pointResolution /= 0.3048;\n      } else {\n        suffix = 'mi';\n        pointResolution /= 1609.344;\n      }\n    } else if (units == Units.NAUTICAL) {\n      pointResolution /= 1852;\n      suffix = 'nm';\n    } else if (units == Units.METRIC) {\n      if (nominalCount < 0.001) {\n        suffix = 'μm';\n        pointResolution *= 1000000;\n      } else if (nominalCount < 1) {\n        suffix = 'mm';\n        pointResolution *= 1000;\n      } else if (nominalCount < 1000) {\n        suffix = 'm';\n      } else {\n        suffix = 'km';\n        pointResolution /= 1000;\n      }\n    } else if (units == Units.US) {\n      if (nominalCount < 0.9144) {\n        suffix = 'in';\n        pointResolution *= 39.37;\n      } else if (nominalCount < 1609.344) {\n        suffix = 'ft';\n        pointResolution /= 0.30480061;\n      } else {\n        suffix = 'mi';\n        pointResolution /= 1609.3472;\n      }\n    } else {\n      assert(false, 33); // Invalid units\n    }\n\n    let i = 3 * Math.floor(\n      Math.log(this.minWidth_ * pointResolution) / Math.log(10));\n    let count, width, decimalCount;\n    while (true) {\n      decimalCount = Math.floor(i / 3);\n      const decimal = Math.pow(10, decimalCount);\n      count = LEADING_DIGITS[((i % 3) + 3) % 3] * decimal;\n      width = Math.round(count / pointResolution);\n      if (isNaN(width)) {\n        this.element.style.display = 'none';\n        this.renderedVisible_ = false;\n        return;\n      } else if (width >= this.minWidth_) {\n        break;\n      }\n      ++i;\n    }\n    let html;\n    if (this.scaleBar_) {\n      html = this.createScaleBar(width, count, suffix);\n    } else {\n      html = count.toFixed(decimalCount < 0 ? -decimalCount : 0) + ' ' + suffix;\n    }\n\n    if (this.renderedHTML_ != html) {\n      this.innerElement_.innerHTML = html;\n      this.renderedHTML_ = html;\n    }\n\n    if (this.renderedWidth_ != width) {\n      this.innerElement_.style.width = width + 'px';\n      this.renderedWidth_ = width;\n    }\n\n    if (!this.renderedVisible_) {\n      this.element.style.display = '';\n      this.renderedVisible_ = true;\n    }\n\n  }\n\n  /**\n   * @private\n   * @param {number} width The current width of the scalebar.\n   * @param {number} scale The current scale.\n   * @param {string} suffix The suffix to append to the scale text.\n   * @returns {string} The stringified HTML of the scalebar.\n   */\n  createScaleBar(width, scale, suffix) {\n    const mapScale = '1 : ' + Math.round(this.getScaleForResolution()).toLocaleString();\n    const scaleSteps = [];\n    const stepWidth = width / this.scaleBarSteps_;\n    let backgroundColor = '#ffffff';\n    for (let i = 0; i < this.scaleBarSteps_; i++) {\n      if (i === 0) {\n        // create the first marker at position 0\n        scaleSteps.push(this.createMarker('absolute', i));\n      }\n      scaleSteps.push(\n        '<div>' +\n          '<div ' +\n            'class=\"ol-scale-singlebar\" ' +\n            'style=' +\n              '\"width: ' + stepWidth + 'px;' +\n              'background-color: ' + backgroundColor + ';\"' +\n          '>' +\n          '</div>' +\n          this.createMarker('relative', i) +\n          /*render text every second step, except when only 2 steps */\n          (i % 2 === 0 || this.scaleBarSteps_ === 2 ?\n            this.createStepText(i, width, false, scale, suffix) :\n            ''\n          ) +\n        '</div>'\n      );\n      if (i === this.scaleBarSteps_ - 1) {\n        {/*render text at the end */}\n        scaleSteps.push(this.createStepText(i + 1, width, true, scale, suffix));\n      }\n      // switch colors of steps between black and white\n      if (backgroundColor === '#ffffff') {\n        backgroundColor = '#000000';\n      } else {\n        backgroundColor = '#ffffff';\n      }\n    }\n\n    let scaleBarText;\n    if (this.scaleBarText_) {\n      scaleBarText = '<div ' +\n      'class=\"ol-scale-text\" ' +\n      'style=\"width: ' + width + 'px;\">' +\n      mapScale +\n    '</div>';\n    } else {\n      scaleBarText = '';\n    }\n    const container = '<div ' +\n      'style=\"display: flex;\">' +\n      scaleBarText +\n      scaleSteps.join('') +\n    '</div>';\n    return container;\n  }\n\n  /**\n   * Creates a marker at given position\n   * @param {string} position - The position, absolute or relative\n   * @param {number} i - The iterator\n   * @returns {string} The stringified div containing the marker\n   */\n  createMarker(position, i) {\n    const top = position === 'absolute' ? 3 : -10;\n    return '<div ' +\n        'class=\"ol-scale-step-marker\" ' +\n        'style=\"position: ' + position + ';' +\n          'top: ' + top + 'px;\"' +\n      '></div>';\n  }\n\n  /**\n   * Creates the label for a marker marker at given position\n   * @param {number} i - The iterator\n   * @param {number} width - The width the scalebar will currently use\n   * @param {boolean} isLast - Flag indicating if we add the last step text\n   * @param {number} scale - The current scale for the whole scalebar\n   * @param {string} suffix - The suffix for the scale\n   * @returns {string} The stringified div containing the step text\n   */\n  createStepText(i, width, isLast, scale, suffix) {\n    const length = i === 0 ? 0 : Math.round((scale / this.scaleBarSteps_ * i) * 100) / 100;\n    const lengthString = length + (i === 0 ? '' : ' ' + suffix);\n    const margin = i === 0 ? -3 : width / this.scaleBarSteps_ * -1;\n    const minWidth = i === 0 ? 0 : width / this.scaleBarSteps_ * 2;\n    return '<div ' +\n      'class=\"ol-scale-step-text\" ' +\n      'style=\"' +\n        'margin-left: ' + margin + 'px;' +\n        'text-align: ' + (i === 0 ? 'left' : 'center') + '; ' +\n        'min-width: ' + minWidth + 'px;' +\n        'left: ' + (isLast ? width + 'px' : 'unset') + ';\"' +\n      '>' +\n      lengthString +\n    '</div>';\n  }\n\n  /**\n   * Returns the appropriate scale for the given resolution and units.\n   * @return {number} The appropriate scale.\n   */\n  getScaleForResolution() {\n    const resolution = this.getMap().getView().getResolution();\n    const dpi = 25.4 / 0.28;\n    const mpu = this.viewState_.projection.getMetersPerUnit();\n    const inchesPerMeter = 39.37;\n    return parseFloat(resolution.toString()) * mpu * inchesPerMeter * dpi;\n  }\n}\n\n/**\n * Update the scale line element.\n * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n * @this {ScaleLine}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    this.viewState_ = null;\n  } else {\n    this.viewState_ = frameState.viewState;\n  }\n  this.updateElement_();\n}\n\n\nexport default ScaleLine;\n","/**\n * @module ol/interaction/Property\n */\n\n/**\n * @enum {string}\n */\nexport default {\n  ACTIVE: 'active'\n};\n","/**\n * @module ol/geom/flat/interiorpoint\n */\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {linearRingsContainsXY} from './contains.js';\n\n\n/**\n * Calculates a point that is likely to lie in the interior of the linear rings.\n * Inspired by JTS's com.vividsolutions.jts.geom.Geometry#getInteriorPoint.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @param {Array<number>} flatCenters Flat centers.\n * @param {number} flatCentersOffset Flat center offset.\n * @param {Array<number>=} opt_dest Destination.\n * @return {Array<number>} Destination point as XYM coordinate, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointOfArray(flatCoordinates, offset,\n  ends, stride, flatCenters, flatCentersOffset, opt_dest) {\n  let i, ii, x, x1, x2, y1, y2;\n  const y = flatCenters[flatCentersOffset + 1];\n  /** @type {Array<number>} */\n  const intersections = [];\n  // Calculate intersections with the horizontal line\n  for (let r = 0, rr = ends.length; r < rr; ++r) {\n    const end = ends[r];\n    x1 = flatCoordinates[end - stride];\n    y1 = flatCoordinates[end - stride + 1];\n    for (i = offset; i < end; i += stride) {\n      x2 = flatCoordinates[i];\n      y2 = flatCoordinates[i + 1];\n      if ((y <= y1 && y2 <= y) || (y1 <= y && y <= y2)) {\n        x = (y - y1) / (y2 - y1) * (x2 - x1) + x1;\n        intersections.push(x);\n      }\n      x1 = x2;\n      y1 = y2;\n    }\n  }\n  // Find the longest segment of the horizontal line that has its center point\n  // inside the linear ring.\n  let pointX = NaN;\n  let maxSegmentLength = -Infinity;\n  intersections.sort(numberSafeCompareFunction);\n  x1 = intersections[0];\n  for (i = 1, ii = intersections.length; i < ii; ++i) {\n    x2 = intersections[i];\n    const segmentLength = Math.abs(x2 - x1);\n    if (segmentLength > maxSegmentLength) {\n      x = (x1 + x2) / 2;\n      if (linearRingsContainsXY(flatCoordinates, offset, ends, stride, x, y)) {\n        pointX = x;\n        maxSegmentLength = segmentLength;\n      }\n    }\n    x1 = x2;\n  }\n  if (isNaN(pointX)) {\n    // There is no horizontal line that has its center point inside the linear\n    // ring.  Use the center of the the linear ring's extent.\n    pointX = flatCenters[flatCentersOffset];\n  }\n  if (opt_dest) {\n    opt_dest.push(pointX, y, maxSegmentLength);\n    return opt_dest;\n  } else {\n    return [pointX, y, maxSegmentLength];\n  }\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @param {Array<number>} flatCenters Flat centers.\n * @return {Array<number>} Interior points as XYM coordinates, where M is the\n * length of the horizontal intersection that the point belongs to.\n */\nexport function getInteriorPointsOfMultiArray(flatCoordinates, offset, endss, stride, flatCenters) {\n  let interiorPoints = [];\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    interiorPoints = getInteriorPointOfArray(flatCoordinates,\n      offset, ends, stride, flatCenters, 2 * i, interiorPoints);\n    offset = ends[ends.length - 1];\n  }\n  return interiorPoints;\n}\n","/**\n * @module ol/source/Tile\n */\nimport {abstract} from '../util.js';\nimport TileCache from '../TileCache.js';\nimport TileState from '../TileState.js';\nimport Event from '../events/Event.js';\nimport {equivalent} from '../proj.js';\nimport {toSize, scale as scaleSize} from '../size.js';\nimport Source from './Source.js';\nimport {getKeyZXY, withinExtentAndZ} from '../tilecoord.js';\nimport {wrapX, getForProjection as getTileGridForProjection} from '../tilegrid.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions]\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize]\n * @property {boolean} [opaque]\n * @property {number} [tilePixelRatio]\n * @property {import(\"../proj.js\").ProjectionLike} [projection]\n * @property {import(\"./State.js\").default} [state]\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid]\n * @property {boolean} [wrapX=true]\n * @property {number} [transition]\n * @property {string} [key]\n * @property {number} [zDirection=0]\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for sources providing images divided into a tile grid.\n * @abstract\n * @api\n */\nclass TileSource extends Source {\n  /**\n   * @param {Options} options SourceTile source options.\n   */\n  constructor(options) {\n\n    super({\n      attributions: options.attributions,\n      attributionsCollapsible: options.attributionsCollapsible,\n      projection: options.projection,\n      state: options.state,\n      wrapX: options.wrapX\n    });\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.opaque_ = options.opaque !== undefined ? options.opaque : false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilePixelRatio_ = options.tilePixelRatio !== undefined ?\n      options.tilePixelRatio : 1;\n\n    /**\n     * @protected\n     * @type {import(\"../tilegrid/TileGrid.js\").default}\n     */\n    this.tileGrid = options.tileGrid !== undefined ? options.tileGrid : null;\n\n    let cacheSize = options.cacheSize;\n    if (cacheSize === undefined) {\n      const tileSize = [256, 256];\n      const tileGrid = options.tileGrid;\n      if (tileGrid) {\n        toSize(tileGrid.getTileSize(tileGrid.getMinZoom()), tileSize);\n      }\n      const canUseScreen = typeof screen !== 'undefined';\n      const width = canUseScreen ? (screen.availWidth || screen.width) : 1920;\n      const height = canUseScreen ? (screen.availHeight || screen.height) : 1080;\n      cacheSize = 4 * Math.ceil(width / tileSize[0]) * Math.ceil(height / tileSize[1]);\n    }\n\n    /**\n     * @protected\n     * @type {import(\"../TileCache.js\").default}\n     */\n    this.tileCache = new TileCache(cacheSize);\n\n    /**\n     * @protected\n     * @type {import(\"../size.js\").Size}\n     */\n    this.tmpSize = [0, 0];\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.key_ = options.key || '';\n\n    /**\n     * @protected\n     * @type {import(\"../Tile.js\").Options}\n     */\n    this.tileOptions = {transition: options.transition};\n\n    /**\n     * zDirection hint, read by the renderer. Indicates which resolution should be used\n     * by a renderer if the views resolution does not match any resolution of the tile source.\n     * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n     * will be used. If -1, the nearest higher resolution will be used.\n     * @type {number}\n     */\n    this.zDirection = options.zDirection ? options.zDirection : 0;\n  }\n\n  /**\n   * @return {boolean} Can expire cache.\n   */\n  canExpireCache() {\n    return this.tileCache.canExpireCache();\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {!Object<string, import(\"../TileRange.js\").default>} usedTiles Used tiles.\n   */\n  expireCache(projection, usedTiles) {\n    const tileCache = this.getTileCacheForProjection(projection);\n    if (tileCache) {\n      tileCache.expireCache(usedTiles);\n    }\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @param {number} z Zoom level.\n   * @param {import(\"../TileRange.js\").default} tileRange Tile range.\n   * @param {function(import(\"../Tile.js\").default):(boolean|void)} callback Called with each\n   *     loaded tile.  If the callback returns `false`, the tile will not be\n   *     considered loaded.\n   * @return {boolean} The tile range is fully covered with loaded tiles.\n   */\n  forEachLoadedTile(projection, z, tileRange, callback) {\n    const tileCache = this.getTileCacheForProjection(projection);\n    if (!tileCache) {\n      return false;\n    }\n\n    let covered = true;\n    let tile, tileCoordKey, loaded;\n    for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        tileCoordKey = getKeyZXY(z, x, y);\n        loaded = false;\n        if (tileCache.containsKey(tileCoordKey)) {\n          tile = /** @type {!import(\"../Tile.js\").default} */ (tileCache.get(tileCoordKey));\n          loaded = tile.getState() === TileState.LOADED;\n          if (loaded) {\n            loaded = (callback(tile) !== false);\n          }\n        }\n        if (!loaded) {\n          covered = false;\n        }\n      }\n    }\n    return covered;\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {number} Gutter.\n   */\n  getGutterForProjection(projection) {\n    return 0;\n  }\n\n  /**\n   * Return the key to be used for all tiles in the source.\n   * @return {string} The key for all tiles.\n   * @protected\n   */\n  getKey() {\n    return this.key_;\n  }\n\n  /**\n   * Set the value to be used as the key for all tiles in the source.\n   * @param {string} key The key for tiles.\n   * @protected\n   */\n  setKey(key) {\n    if (this.key_ !== key) {\n      this.key_ = key;\n      this.changed();\n    }\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {boolean} Opaque.\n   */\n  getOpaque(projection) {\n    return this.opaque_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getResolutions() {\n    return this.tileGrid.getResolutions();\n  }\n\n  /**\n   * @abstract\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {!import(\"../Tile.js\").default} Tile.\n   */\n  getTile(z, x, y, pixelRatio, projection) {\n    return abstract();\n  }\n\n  /**\n   * Return the tile grid of the tile source.\n   * @return {import(\"../tilegrid/TileGrid.js\").default} Tile grid.\n   * @api\n   */\n  getTileGrid() {\n    return this.tileGrid;\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {!import(\"../tilegrid/TileGrid.js\").default} Tile grid.\n   */\n  getTileGridForProjection(projection) {\n    if (!this.tileGrid) {\n      return getTileGridForProjection(projection);\n    } else {\n      return this.tileGrid;\n    }\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../TileCache.js\").default} Tile cache.\n   * @protected\n   */\n  getTileCacheForProjection(projection) {\n    const thisProj = this.getProjection();\n    if (thisProj && !equivalent(thisProj, projection)) {\n      return null;\n    } else {\n      return this.tileCache;\n    }\n  }\n\n  /**\n   * Get the tile pixel ratio for this source. Subclasses may override this\n   * method, which is meant to return a supported pixel ratio that matches the\n   * provided `pixelRatio` as close as possible.\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {number} Tile pixel ratio.\n   */\n  getTilePixelRatio(pixelRatio) {\n    return this.tilePixelRatio_;\n  }\n\n  /**\n   * @param {number} z Z.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @return {import(\"../size.js\").Size} Tile size.\n   */\n  getTilePixelSize(z, pixelRatio, projection) {\n    const tileGrid = this.getTileGridForProjection(projection);\n    const tilePixelRatio = this.getTilePixelRatio(pixelRatio);\n    const tileSize = toSize(tileGrid.getTileSize(z), this.tmpSize);\n    if (tilePixelRatio == 1) {\n      return tileSize;\n    } else {\n      return scaleSize(tileSize, tilePixelRatio, this.tmpSize);\n    }\n  }\n\n  /**\n   * Returns a tile coordinate wrapped around the x-axis. When the tile coordinate\n   * is outside the resolution and extent range of the tile grid, `null` will be\n   * returned.\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {import(\"../proj/Projection.js\").default=} opt_projection Projection.\n   * @return {import(\"../tilecoord.js\").TileCoord} Tile coordinate to be passed to the tileUrlFunction or\n   *     null if no tile URL should be created for the passed `tileCoord`.\n   */\n  getTileCoordForTileUrlFunction(tileCoord, opt_projection) {\n    const projection = opt_projection !== undefined ?\n      opt_projection : this.getProjection();\n    const tileGrid = this.getTileGridForProjection(projection);\n    if (this.getWrapX() && projection.isGlobal()) {\n      tileCoord = wrapX(tileGrid, tileCoord, projection);\n    }\n    return withinExtentAndZ(tileCoord, tileGrid) ? tileCoord : null;\n  }\n\n  /**\n   * Remove all cached tiles from the source. The next render cycle will fetch new tiles.\n   * @api\n   */\n  clear() {\n    this.tileCache.clear();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  refresh() {\n    this.clear();\n    super.refresh();\n  }\n\n  /**\n   * Marks a tile coord as being used, without triggering a load.\n   * @abstract\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   */\n  useTile(z, x, y, projection) {}\n\n}\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Tile~TileSource} instances are instances of this\n * type.\n */\nexport class TileSourceEvent extends Event {\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../Tile.js\").default} tile The tile.\n   */\n  constructor(type, tile) {\n\n    super(type);\n\n    /**\n     * The tile related to the event.\n     * @type {import(\"../Tile.js\").default}\n     * @api\n     */\n    this.tile = tile;\n\n  }\n\n}\n\nexport default TileSource;\n","/**\n * @module ol/net\n */\nimport {getUid} from './util.js';\n\n\n/**\n * Simple JSONP helper. Supports error callbacks and a custom callback param.\n * The error callback will be called when no JSONP is executed after 10 seconds.\n *\n * @param {string} url Request url. A 'callback' query parameter will be\n *     appended.\n * @param {Function} callback Callback on success.\n * @param {function()=} opt_errback Callback on error.\n * @param {string=} opt_callbackParam Custom query parameter for the JSONP\n *     callback. Default is 'callback'.\n */\nexport function jsonp(url, callback, opt_errback, opt_callbackParam) {\n  const script = document.createElement('script');\n  const key = 'olc_' + getUid(callback);\n  function cleanup() {\n    delete window[key];\n    script.parentNode.removeChild(script);\n  }\n  script.async = true;\n  script.src = url + (url.indexOf('?') == -1 ? '?' : '&') +\n      (opt_callbackParam || 'callback') + '=' + key;\n  const timer = setTimeout(function() {\n    cleanup();\n    if (opt_errback) {\n      opt_errback();\n    }\n  }, 10000);\n  window[key] = function(data) {\n    clearTimeout(timer);\n    cleanup();\n    callback(data);\n  };\n  document.getElementsByTagName('head')[0].appendChild(script);\n}\n","/**\n * @module ol/structs/RBush\n */\nimport {getUid} from '../util.js';\nimport RBush_ from 'rbush';\nimport {createOrUpdate, equals} from '../extent.js';\nimport {isEmpty} from '../obj.js';\n\n/**\n * @typedef {Object} Entry\n * @property {number} minX\n * @property {number} minY\n * @property {number} maxX\n * @property {number} maxY\n * @property {Object} [value]\n */\n\n/**\n * @classdesc\n * Wrapper around the RBush by Vladimir Agafonkin.\n * See https://github.com/mourner/rbush.\n *\n * @template T\n */\nclass RBush {\n  /**\n   * @param {number=} opt_maxEntries Max entries.\n   */\n  constructor(opt_maxEntries) {\n\n    /**\n     * @private\n     */\n    this.rbush_ = new RBush_(opt_maxEntries);\n\n    /**\n     * A mapping between the objects added to this rbush wrapper\n     * and the objects that are actually added to the internal rbush.\n     * @private\n     * @type {Object<string, Entry>}\n     */\n    this.items_ = {};\n\n  }\n\n  /**\n   * Insert a value into the RBush.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {T} value Value.\n   */\n  insert(extent, value) {\n    /** @type {Entry} */\n    const item = {\n      minX: extent[0],\n      minY: extent[1],\n      maxX: extent[2],\n      maxY: extent[3],\n      value: value\n    };\n\n    this.rbush_.insert(item);\n    this.items_[getUid(value)] = item;\n  }\n\n\n  /**\n   * Bulk-insert values into the RBush.\n   * @param {Array<import(\"../extent.js\").Extent>} extents Extents.\n   * @param {Array<T>} values Values.\n   */\n  load(extents, values) {\n    const items = new Array(values.length);\n    for (let i = 0, l = values.length; i < l; i++) {\n      const extent = extents[i];\n      const value = values[i];\n\n      /** @type {Entry} */\n      const item = {\n        minX: extent[0],\n        minY: extent[1],\n        maxX: extent[2],\n        maxY: extent[3],\n        value: value\n      };\n      items[i] = item;\n      this.items_[getUid(value)] = item;\n    }\n    this.rbush_.load(items);\n  }\n\n\n  /**\n   * Remove a value from the RBush.\n   * @param {T} value Value.\n   * @return {boolean} Removed.\n   */\n  remove(value) {\n    const uid = getUid(value);\n\n    // get the object in which the value was wrapped when adding to the\n    // internal rbush. then use that object to do the removal.\n    const item = this.items_[uid];\n    delete this.items_[uid];\n    return this.rbush_.remove(item) !== null;\n  }\n\n\n  /**\n   * Update the extent of a value in the RBush.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {T} value Value.\n   */\n  update(extent, value) {\n    const item = this.items_[getUid(value)];\n    const bbox = [item.minX, item.minY, item.maxX, item.maxY];\n    if (!equals(bbox, extent)) {\n      this.remove(value);\n      this.insert(extent, value);\n    }\n  }\n\n\n  /**\n   * Return all values in the RBush.\n   * @return {Array<T>} All.\n   */\n  getAll() {\n    const items = this.rbush_.all();\n    return items.map(function(item) {\n      return item.value;\n    });\n  }\n\n\n  /**\n   * Return all values in the given extent.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @return {Array<T>} All in extent.\n   */\n  getInExtent(extent) {\n    /** @type {Entry} */\n    const bbox = {\n      minX: extent[0],\n      minY: extent[1],\n      maxX: extent[2],\n      maxY: extent[3]\n    };\n    const items = this.rbush_.search(bbox);\n    return items.map(function(item) {\n      return item.value;\n    });\n  }\n\n\n  /**\n   * Calls a callback function with each value in the tree.\n   * If the callback returns a truthy value, this value is returned without\n   * checking the rest of the tree.\n   * @param {function(T): *} callback Callback.\n   * @return {*} Callback return value.\n   */\n  forEach(callback) {\n    return this.forEach_(this.getAll(), callback);\n  }\n\n\n  /**\n   * Calls a callback function with each value in the provided extent.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {function(T): *} callback Callback.\n   * @return {*} Callback return value.\n   */\n  forEachInExtent(extent, callback) {\n    return this.forEach_(this.getInExtent(extent), callback);\n  }\n\n\n  /**\n   * @param {Array<T>} values Values.\n   * @param {function(T): *} callback Callback.\n   * @private\n   * @return {*} Callback return value.\n   */\n  forEach_(values, callback) {\n    let result;\n    for (let i = 0, l = values.length; i < l; i++) {\n      result = callback(values[i]);\n      if (result) {\n        return result;\n      }\n    }\n    return result;\n  }\n\n\n  /**\n   * @return {boolean} Is empty.\n   */\n  isEmpty() {\n    return isEmpty(this.items_);\n  }\n\n\n  /**\n   * Remove all values from the RBush.\n   */\n  clear() {\n    this.rbush_.clear();\n    this.items_ = {};\n  }\n\n\n  /**\n   * @param {import(\"../extent.js\").Extent=} opt_extent Extent.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   */\n  getExtent(opt_extent) {\n    const data = this.rbush_.toJSON();\n    return createOrUpdate(data.minX, data.minY, data.maxX, data.maxY, opt_extent);\n  }\n\n\n  /**\n   * @param {RBush} rbush R-Tree.\n   */\n  concat(rbush) {\n    this.rbush_.load(rbush.rbush_.all());\n    for (const i in rbush.items_) {\n      this.items_[i] = rbush.items_[i];\n    }\n  }\n\n}\n\n\nexport default RBush;\n","/**\n * @module ol/extent/Corner\n */\n\n/**\n * Extent corner.\n * @enum {string}\n */\nexport default {\n  BOTTOM_LEFT: 'bottom-left',\n  BOTTOM_RIGHT: 'bottom-right',\n  TOP_LEFT: 'top-left',\n  TOP_RIGHT: 'top-right'\n};\n","/**\n * @module ol/TileRange\n */\n\n/**\n * A representation of a contiguous block of tiles.  A tile range is specified\n * by its min/max tile coordinates and is inclusive of coordinates.\n */\nclass TileRange {\n\n  /**\n   * @param {number} minX Minimum X.\n   * @param {number} maxX Maximum X.\n   * @param {number} minY Minimum Y.\n   * @param {number} maxY Maximum Y.\n   */\n  constructor(minX, maxX, minY, maxY) {\n\n    /**\n     * @type {number}\n     */\n    this.minX = minX;\n\n    /**\n     * @type {number}\n     */\n    this.maxX = maxX;\n\n    /**\n     * @type {number}\n     */\n    this.minY = minY;\n\n    /**\n     * @type {number}\n     */\n    this.maxY = maxY;\n\n  }\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @return {boolean} Contains tile coordinate.\n   */\n  contains(tileCoord) {\n    return this.containsXY(tileCoord[1], tileCoord[2]);\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Contains.\n   */\n  containsTileRange(tileRange) {\n    return this.minX <= tileRange.minX && tileRange.maxX <= this.maxX &&\n       this.minY <= tileRange.minY && tileRange.maxY <= this.maxY;\n  }\n\n  /**\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @return {boolean} Contains coordinate.\n   */\n  containsXY(x, y) {\n    return this.minX <= x && x <= this.maxX && this.minY <= y && y <= this.maxY;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Equals.\n   */\n  equals(tileRange) {\n    return this.minX == tileRange.minX && this.minY == tileRange.minY &&\n       this.maxX == tileRange.maxX && this.maxY == tileRange.maxY;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   */\n  extend(tileRange) {\n    if (tileRange.minX < this.minX) {\n      this.minX = tileRange.minX;\n    }\n    if (tileRange.maxX > this.maxX) {\n      this.maxX = tileRange.maxX;\n    }\n    if (tileRange.minY < this.minY) {\n      this.minY = tileRange.minY;\n    }\n    if (tileRange.maxY > this.maxY) {\n      this.maxY = tileRange.maxY;\n    }\n  }\n\n  /**\n   * @return {number} Height.\n   */\n  getHeight() {\n    return this.maxY - this.minY + 1;\n  }\n\n  /**\n   * @return {import(\"./size.js\").Size} Size.\n   */\n  getSize() {\n    return [this.getWidth(), this.getHeight()];\n  }\n\n  /**\n   * @return {number} Width.\n   */\n  getWidth() {\n    return this.maxX - this.minX + 1;\n  }\n\n  /**\n   * @param {TileRange} tileRange Tile range.\n   * @return {boolean} Intersects.\n   */\n  intersects(tileRange) {\n    return this.minX <= tileRange.maxX &&\n       this.maxX >= tileRange.minX &&\n       this.minY <= tileRange.maxY &&\n       this.maxY >= tileRange.minY;\n  }\n}\n\n\n/**\n * @param {number} minX Minimum X.\n * @param {number} maxX Maximum X.\n * @param {number} minY Minimum Y.\n * @param {number} maxY Maximum Y.\n * @param {TileRange=} tileRange TileRange.\n * @return {TileRange} Tile range.\n */\nexport function createOrUpdate(minX, maxX, minY, maxY, tileRange) {\n  if (tileRange !== undefined) {\n    tileRange.minX = minX;\n    tileRange.maxX = maxX;\n    tileRange.minY = minY;\n    tileRange.maxY = maxY;\n    return tileRange;\n  } else {\n    return new TileRange(minX, maxX, minY, maxY);\n  }\n}\n\n\nexport default TileRange;\n","/**\n * @module ol/source/Raster\n */\nimport ImageCanvas from '../ImageCanvas.js';\nimport TileQueue from '../TileQueue.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {Processor} from 'pixelworks/lib/index.js';\nimport {equals, getCenter, getHeight, getWidth} from '../extent.js';\nimport ImageLayer from '../layer/Image.js';\nimport TileLayer from '../layer/Tile.js';\nimport {assign} from '../obj.js';\nimport {create as createTransform} from '../transform.js';\nimport ImageSource from './Image.js';\nimport TileSource from './Tile.js';\nimport SourceState from './State.js';\nimport Source from './Source.js';\n\n\n/**\n * A function that takes an array of input data, performs some operation, and\n * returns an array of output data.\n * For `pixel` type operations, the function will be called with an array of\n * pixels, where each pixel is an array of four numbers (`[r, g, b, a]`) in the\n * range of 0 - 255. It should return a single pixel array.\n * For `'image'` type operations, functions will be called with an array of\n * {@link ImageData https://developer.mozilla.org/en-US/docs/Web/API/ImageData}\n * and should return a single {@link ImageData\n * https://developer.mozilla.org/en-US/docs/Web/API/ImageData}.  The operations\n * are called with a second \"data\" argument, which can be used for storage.  The\n * data object is accessible from raster events, where it can be initialized in\n * \"beforeoperations\" and accessed again in \"afteroperations\".\n *\n * @typedef {function((Array<Array<number>>|Array<ImageData>), Object):\n *     (Array<number>|ImageData)} Operation\n */\n\n\n/**\n * @enum {string}\n */\nconst RasterEventType = {\n  /**\n   * Triggered before operations are run.\n   * @event module:ol/source/Raster.RasterSourceEvent#beforeoperations\n   * @api\n   */\n  BEFOREOPERATIONS: 'beforeoperations',\n\n  /**\n   * Triggered after operations are run.\n   * @event module:ol/source/Raster.RasterSourceEvent#afteroperations\n   * @api\n   */\n  AFTEROPERATIONS: 'afteroperations'\n};\n\n\n/**\n * Raster operation type. Supported values are `'pixel'` and `'image'`.\n * @enum {string}\n */\nconst RasterOperationType = {\n  PIXEL: 'pixel',\n  IMAGE: 'image'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/source/Raster} instances are instances of this\n * type.\n */\nexport class RasterSourceEvent extends Event {\n  /**\n   * @param {string} type Type.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState The frame state.\n   * @param {Object} data An object made available to operations.\n   */\n  constructor(type, frameState, data) {\n    super(type);\n\n    /**\n     * The raster extent.\n     * @type {import(\"../extent.js\").Extent}\n     * @api\n     */\n    this.extent = frameState.extent;\n\n    /**\n     * The pixel resolution (map units per pixel).\n     * @type {number}\n     * @api\n     */\n    this.resolution = frameState.viewState.resolution / frameState.pixelRatio;\n\n    /**\n     * An object made available to all operations.  This can be used by operations\n     * as a storage object (e.g. for calculating statistics).\n     * @type {Object}\n     * @api\n     */\n    this.data = data;\n\n  }\n\n}\n\n/**\n * @typedef {Object} Options\n * @property {Array<import(\"./Source.js\").default|import(\"../layer/Layer.js\").default>} sources Input\n * sources or layers.  For vector data, use an VectorImage layer.\n * @property {Operation} [operation] Raster operation.\n * The operation will be called with data from input sources\n * and the output will be assigned to the raster source.\n * @property {Object} [lib] Functions that will be made available to operations run in a worker.\n * @property {number} [threads] By default, operations will be run in a single worker thread.\n * To avoid using workers altogether, set `threads: 0`.  For pixel operations, operations can\n * be run in multiple worker threads.  Note that there is additional overhead in\n * transferring data to multiple workers, and that depending on the user's\n * system, it may not be possible to parallelize the work.\n * @property {RasterOperationType} [operationType='pixel'] Operation type.\n * Supported values are `'pixel'` and `'image'`.  By default,\n * `'pixel'` operations are assumed, and operations will be called with an\n * array of pixels from input sources.  If set to `'image'`, operations will\n * be called with an array of ImageData objects from input sources.\n */\n\n\n/**\n * @classdesc\n * A source that transforms data from any number of input sources using an\n * {@link module:ol/source/Raster~Operation} function to transform input pixel values into\n * output pixel values.\n *\n * @fires module:ol/source/Raster.RasterSourceEvent\n * @api\n */\nclass RasterSource extends ImageSource {\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n    super({\n      projection: null\n    });\n\n    /**\n     * @private\n     * @type {*}\n     */\n    this.worker_ = null;\n\n    /**\n     * @private\n     * @type {RasterOperationType}\n     */\n    this.operationType_ = options.operationType !== undefined ?\n      options.operationType : RasterOperationType.PIXEL;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.threads_ = options.threads !== undefined ? options.threads : 1;\n\n    /**\n     * @private\n     * @type {Array<import(\"../layer/Layer.js\").default>}\n     */\n    this.layers_ = createLayers(options.sources);\n\n    const changed = this.changed.bind(this);\n    for (let i = 0, ii = this.layers_.length; i < ii; ++i) {\n      this.layers_[i].addEventListener(EventType.CHANGE, changed);\n    }\n\n    /**\n     * @private\n     * @type {import(\"../TileQueue.js\").default}\n     */\n    this.tileQueue_ = new TileQueue(function() {\n      return 1;\n    }, this.changed.bind(this));\n\n    /**\n     * The most recently requested frame state.\n     * @type {import(\"../PluggableMap.js\").FrameState}\n     * @private\n     */\n    this.requestedFrameState_;\n\n    /**\n     * The most recently rendered image canvas.\n     * @type {import(\"../ImageCanvas.js\").default}\n     * @private\n     */\n    this.renderedImageCanvas_ = null;\n\n    /**\n     * The most recently rendered revision.\n     * @type {number}\n     */\n    this.renderedRevision_;\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").FrameState}\n     */\n    this.frameState_ = {\n      animate: false,\n      coordinateToPixelTransform: createTransform(),\n      extent: null,\n      index: 0,\n      layerIndex: 0,\n      layerStatesArray: getLayerStatesArray(this.layers_),\n      pixelRatio: 1,\n      pixelToCoordinateTransform: createTransform(),\n      postRenderFunctions: [],\n      size: [0, 0],\n      tileQueue: this.tileQueue_,\n      time: Date.now(),\n      usedTiles: {},\n      viewState: /** @type {import(\"../View.js\").State} */ ({\n        rotation: 0\n      }),\n      viewHints: [],\n      wantedTiles: {},\n      declutterItems: []\n    };\n\n    this.setAttributions(function(frameState) {\n      const attributions = [];\n      for (let index = 0, iMax = options.sources.length; index < iMax; ++index) {\n        const sourceOrLayer = options.sources[index];\n        const source = sourceOrLayer instanceof Source ? sourceOrLayer : sourceOrLayer.getSource();\n        const attributionGetter = source.getAttributions();\n        if (typeof attributionGetter === 'function') {\n          const sourceAttribution = attributionGetter(frameState);\n          attributions.push.apply(attributions, sourceAttribution);\n        }\n      }\n      return attributions.length !== 0 ? attributions : null;\n    });\n\n    if (options.operation !== undefined) {\n      this.setOperation(options.operation, options.lib);\n    }\n\n  }\n\n  /**\n   * Set the operation.\n   * @param {Operation} operation New operation.\n   * @param {Object=} opt_lib Functions that will be available to operations run\n   *     in a worker.\n   * @api\n   */\n  setOperation(operation, opt_lib) {\n    this.worker_ = new Processor({\n      operation: operation,\n      imageOps: this.operationType_ === RasterOperationType.IMAGE,\n      queue: 1,\n      lib: opt_lib,\n      threads: this.threads_\n    });\n    this.changed();\n  }\n\n  /**\n   * Update the stored frame state.\n   * @param {import(\"../extent.js\").Extent} extent The view extent (in map units).\n   * @param {number} resolution The view resolution.\n   * @param {import(\"../proj/Projection.js\").default} projection The view projection.\n   * @return {import(\"../PluggableMap.js\").FrameState} The updated frame state.\n   * @private\n   */\n  updateFrameState_(extent, resolution, projection) {\n\n    const frameState = /** @type {import(\"../PluggableMap.js\").FrameState} */ (assign({}, this.frameState_));\n\n    frameState.viewState = /** @type {import(\"../View.js\").State} */ (assign({}, frameState.viewState));\n\n    const center = getCenter(extent);\n\n    frameState.extent = extent.slice();\n    frameState.size[0] = Math.round(getWidth(extent) / resolution);\n    frameState.size[1] = Math.round(getHeight(extent) / resolution);\n    frameState.time = Infinity;\n\n    const viewState = frameState.viewState;\n    viewState.center = center;\n    viewState.projection = projection;\n    viewState.resolution = resolution;\n    return frameState;\n  }\n\n  /**\n   * Determine if all sources are ready.\n   * @return {boolean} All sources are ready.\n   * @private\n   */\n  allSourcesReady_() {\n    let ready = true;\n    let source;\n    for (let i = 0, ii = this.layers_.length; i < ii; ++i) {\n      source = this.layers_[i].getSource();\n      if (source.getState() !== SourceState.READY) {\n        ready = false;\n        break;\n      }\n    }\n    return ready;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImage(extent, resolution, pixelRatio, projection) {\n    if (!this.allSourcesReady_()) {\n      return null;\n    }\n\n    const frameState = this.updateFrameState_(extent, resolution, projection);\n    this.requestedFrameState_ = frameState;\n\n    // check if we can't reuse the existing ol/ImageCanvas\n    if (this.renderedImageCanvas_) {\n      const renderedResolution = this.renderedImageCanvas_.getResolution();\n      const renderedExtent = this.renderedImageCanvas_.getExtent();\n      if (resolution !== renderedResolution || !equals(extent, renderedExtent)) {\n        this.renderedImageCanvas_ = null;\n      }\n    }\n\n    if (!this.renderedImageCanvas_ || this.getRevision() !== this.renderedRevision_) {\n      this.processSources_();\n    }\n\n    frameState.tileQueue.loadMoreTiles(16, 16);\n\n    if (frameState.animate) {\n      requestAnimationFrame(this.changed.bind(this));\n    }\n\n    return this.renderedImageCanvas_;\n  }\n\n  /**\n   * Start processing source data.\n   * @private\n   */\n  processSources_() {\n    const frameState = this.requestedFrameState_;\n    const len = this.layers_.length;\n    const imageDatas = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      frameState.layerIndex = i;\n      const imageData = getImageData(this.layers_[i], frameState);\n      if (imageData) {\n        imageDatas[i] = imageData;\n      } else {\n        return;\n      }\n    }\n\n    const data = {};\n    this.dispatchEvent(new RasterSourceEvent(RasterEventType.BEFOREOPERATIONS, frameState, data));\n    this.worker_.process(imageDatas, data, this.onWorkerComplete_.bind(this, frameState));\n  }\n\n  /**\n   * Called when pixel processing is complete.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState The frame state.\n   * @param {Error} err Any error during processing.\n   * @param {ImageData} output The output image data.\n   * @param {Object} data The user data.\n   * @private\n   */\n  onWorkerComplete_(frameState, err, output, data) {\n    if (err || !output) {\n      return;\n    }\n\n    // do nothing if extent or resolution changed\n    const extent = frameState.extent;\n    const resolution = frameState.viewState.resolution;\n    if (resolution !== this.requestedFrameState_.viewState.resolution ||\n        !equals(extent, this.requestedFrameState_.extent)) {\n      return;\n    }\n\n    let context;\n    if (this.renderedImageCanvas_) {\n      context = this.renderedImageCanvas_.getImage().getContext('2d');\n    } else {\n      const width = Math.round(getWidth(extent) / resolution);\n      const height = Math.round(getHeight(extent) / resolution);\n      context = createCanvasContext2D(width, height);\n      this.renderedImageCanvas_ = new ImageCanvas(extent, resolution, 1, context.canvas);\n    }\n    context.putImageData(output, 0, 0);\n\n    this.changed();\n    this.renderedRevision_ = this.getRevision();\n\n    this.dispatchEvent(new RasterSourceEvent(RasterEventType.AFTEROPERATIONS, frameState, data));\n  }\n\n  /**\n   * @override\n   */\n  getImageInternal() {\n    return null; // not implemented\n  }\n}\n\n\n/**\n * A reusable canvas context.\n * @type {CanvasRenderingContext2D}\n * @private\n */\nlet sharedContext = null;\n\n\n/**\n * Get image data from a layer.\n * @param {import(\"../layer/Layer.js\").default} layer Layer to render.\n * @param {import(\"../PluggableMap.js\").FrameState} frameState The frame state.\n * @return {ImageData} The image data.\n */\nfunction getImageData(layer, frameState) {\n  const renderer = layer.getRenderer();\n  if (!renderer) {\n    throw new Error('Unsupported layer type: ' + layer);\n  }\n\n  if (!renderer.prepareFrame(frameState)) {\n    return null;\n  }\n  const width = frameState.size[0];\n  const height = frameState.size[1];\n  const container = renderer.renderFrame(frameState, null);\n  let element;\n  if (container) {\n    element = container.firstElementChild;\n  }\n  if (!(element instanceof HTMLCanvasElement)) {\n    throw new Error('Unsupported rendered element: ' + element);\n  }\n  if (element.width === width && element.height === height) {\n    const context = element.getContext('2d');\n    return context.getImageData(0, 0, width, height);\n  }\n\n  if (!sharedContext) {\n    sharedContext = createCanvasContext2D(width, height);\n  } else {\n    const canvas = sharedContext.canvas;\n    if (canvas.width !== width || canvas.height !== height) {\n      sharedContext = createCanvasContext2D(width, height);\n    } else {\n      sharedContext.clearRect(0, 0, width, height);\n    }\n  }\n  sharedContext.drawImage(element, 0, 0, width, height);\n  return sharedContext.getImageData(0, 0, width, height);\n}\n\n\n/**\n * Get a list of layer states from a list of layers.\n * @param {Array<import(\"../layer/Layer.js\").default>} layers Layers.\n * @return {Array<import(\"../layer/Layer.js\").State>} The layer states.\n */\nfunction getLayerStatesArray(layers) {\n  return layers.map(function(layer) {\n    return layer.getLayerState();\n  });\n}\n\n\n/**\n * Create layers for all sources.\n * @param {Array<import(\"./Source.js\").default|import(\"../layer/Layer.js\").default>} sources The sources.\n * @return {Array<import(\"../layer/Layer.js\").default>} Array of layers.\n */\nfunction createLayers(sources) {\n  const len = sources.length;\n  const layers = new Array(len);\n  for (let i = 0; i < len; ++i) {\n    layers[i] = createLayer(sources[i]);\n  }\n  return layers;\n}\n\n\n/**\n * Create a layer for the provided source.\n * @param {import(\"./Source.js\").default|import(\"../layer/Layer.js\").default} layerOrSource The layer or source.\n * @return {import(\"../layer/Layer.js\").default} The layer.\n */\nfunction createLayer(layerOrSource) {\n  // @type {import(\"../layer/Layer.js\").default}\n  let layer;\n  if (layerOrSource instanceof Source) {\n    if (layerOrSource instanceof TileSource) {\n      layer = new TileLayer({source: layerOrSource});\n    } else if (layerOrSource instanceof ImageSource) {\n      layer = new ImageLayer({source: layerOrSource});\n    }\n  } else {\n    layer = layerOrSource;\n  }\n  return layer;\n}\n\n\nexport default RasterSource;\n","/**\n * @module ol/source/Zoomify\n */\nimport {DEFAULT_TILE_SIZE} from '../tilegrid/common.js';\n\nimport ImageTile from '../ImageTile.js';\nimport TileState from '../TileState.js';\nimport {expandUrl, createFromTileUrlFunctions} from '../tileurlfunction.js';\nimport {assert} from '../asserts.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport {getTopLeft} from '../extent.js';\nimport {toSize} from '../size.js';\nimport TileImage from './TileImage.js';\nimport TileGrid from '../tilegrid/TileGrid.js';\n\n\n/**\n * @enum {string}\n */\nconst TierSizeCalculation = {\n  DEFAULT: 'default',\n  TRUNCATED: 'truncated'\n};\n\n\nexport class CustomTile extends ImageTile {\n\n  /**\n   * @param {number} tilePixelRatio Tile pixel ratio to display the tile\n   * @param {import(\"../tilegrid/TileGrid.js\").default} tileGrid TileGrid that the tile belongs to.\n   * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {TileState} state State.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {import(\"../Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @param {import(\"../Tile.js\").Options=} opt_options Tile options.\n   */\n  constructor(tilePixelRatio, tileGrid, tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n    super(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options);\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement}\n     */\n    this.zoomifyImage_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.tileSize_ = toSize(tileGrid.getTileSize(tileCoord[0])).map(\n      function(x) {\n        return x * tilePixelRatio;\n      }\n    );\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImage() {\n    if (this.zoomifyImage_) {\n      return this.zoomifyImage_;\n    }\n    const image = super.getImage();\n    if (this.state == TileState.LOADED) {\n      const tileSize = this.tileSize_;\n      if (image.width == tileSize[0] && image.height == tileSize[1]) {\n        this.zoomifyImage_ = image;\n        return image;\n      } else {\n        const context = createCanvasContext2D(tileSize[0], tileSize[1]);\n        context.drawImage(image, 0, 0);\n        this.zoomifyImage_ = context.canvas;\n        return context.canvas;\n      }\n    } else {\n      return image;\n    }\n  }\n\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Tile cache size. The default depends on the screen size. Will increase if too small.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value  you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection.\n * @property {number} [tilePixelRatio] The pixel ratio used by the tile service. For example, if the tile service advertizes 256px by 256px tiles but actually sends 512px by 512px images (for retina/hidpi devices) then `tilePixelRatio` should be set to `2`\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {string} [url] URL template or base URL of the Zoomify service.\n * A base URL is the fixed part\n * of the URL, excluding the tile group, z, x, and y folder structure, e.g.\n * `http://my.zoomify.info/IMAGE.TIF/`. A URL template must include\n * `{TileGroup}`, `{x}`, `{y}`, and `{z}` placeholders, e.g.\n * `http://my.zoomify.info/IMAGE.TIF/{TileGroup}/{z}-{x}-{y}.jpg`.\n * Internet Imaging Protocol (IIP) with JTL extension can be also used with\n * `{tileIndex}` and `{z}` placeholders, e.g.\n * `http://my.zoomify.info?FIF=IMAGE.TIF&JTL={z},{tileIndex}`.\n * A `{?-?}` template pattern, for example `subdomain{a-f}.domain.com`, may be\n * used instead of defining each one separately in the `urls` option.\n * @property {string} [tierSizeCalculation] Tier size calculation method: `default` or `truncated`.\n * @property {import(\"../size.js\").Size} [size] Size of the image.\n * @property {import(\"../extent.js\").Extent} [extent] Extent for the TileGrid that is created.\n * Default sets the TileGrid in the\n * fourth quadrant, meaning extent is `[0, -height, width, 0]`. To change the\n * extent to the first quadrant (the default for OpenLayers 2) set the extent\n * as `[0, 0, width, height]`.\n * @property {number} [transition] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {number} [tileSize=256] Tile size. Same tile size is used for all zoom levels.\n * @property {number} [zDirection=0] Indicate which resolution should be used\n * by a renderer if the view resolution does not match any resolution of the tile source.\n * If 0, the nearest resolution will be used. If 1, the nearest lower resolution\n * will be used. If -1, the nearest higher resolution will be used.\n */\n\n\n/**\n * @classdesc\n * Layer source for tile data in Zoomify format (both Zoomify and Internet\n * Imaging Protocol are supported).\n * @api\n */\nclass Zoomify extends TileImage {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n\n    const size = options.size;\n    const tierSizeCalculation = options.tierSizeCalculation !== undefined ?\n      options.tierSizeCalculation :\n      TierSizeCalculation.DEFAULT;\n\n    const imageWidth = size[0];\n    const imageHeight = size[1];\n    const extent = options.extent || [0, -size[1], size[0], 0];\n    const tierSizeInTiles = [];\n    const tileSize = options.tileSize || DEFAULT_TILE_SIZE;\n    const tilePixelRatio = options.tilePixelRatio || 1;\n    let tileSizeForTierSizeCalculation = tileSize;\n\n    switch (tierSizeCalculation) {\n      case TierSizeCalculation.DEFAULT:\n        while (imageWidth > tileSizeForTierSizeCalculation || imageHeight > tileSizeForTierSizeCalculation) {\n          tierSizeInTiles.push([\n            Math.ceil(imageWidth / tileSizeForTierSizeCalculation),\n            Math.ceil(imageHeight / tileSizeForTierSizeCalculation)\n          ]);\n          tileSizeForTierSizeCalculation += tileSizeForTierSizeCalculation;\n        }\n        break;\n      case TierSizeCalculation.TRUNCATED:\n        let width = imageWidth;\n        let height = imageHeight;\n        while (width > tileSizeForTierSizeCalculation || height > tileSizeForTierSizeCalculation) {\n          tierSizeInTiles.push([\n            Math.ceil(width / tileSizeForTierSizeCalculation),\n            Math.ceil(height / tileSizeForTierSizeCalculation)\n          ]);\n          width >>= 1;\n          height >>= 1;\n        }\n        break;\n      default:\n        assert(false, 53); // Unknown `tierSizeCalculation` configured\n        break;\n    }\n\n    tierSizeInTiles.push([1, 1]);\n    tierSizeInTiles.reverse();\n\n    const resolutions = [1];\n    const tileCountUpToTier = [0];\n    for (let i = 1, ii = tierSizeInTiles.length; i < ii; i++) {\n      resolutions.push(1 << i);\n      tileCountUpToTier.push(\n        tierSizeInTiles[i - 1][0] * tierSizeInTiles[i - 1][1] +\n          tileCountUpToTier[i - 1]\n      );\n    }\n    resolutions.reverse();\n\n    const tileGrid = new TileGrid({\n      tileSize: tileSize,\n      extent: extent,\n      origin: getTopLeft(extent),\n      resolutions: resolutions\n    });\n\n    let url = options.url;\n    if (url && url.indexOf('{TileGroup}') == -1 && url.indexOf('{tileIndex}') == -1) {\n      url += '{TileGroup}/{z}-{x}-{y}.jpg';\n    }\n    const urls = expandUrl(url);\n\n    /**\n     * @param {string} template Template.\n     * @return {import(\"../Tile.js\").UrlFunction} Tile URL function.\n     */\n    function createFromTemplate(template) {\n\n      return (\n        /**\n         * @param {import(\"../tilecoord.js\").TileCoord} tileCoord Tile Coordinate.\n         * @param {number} pixelRatio Pixel ratio.\n         * @param {import(\"../proj/Projection.js\").default} projection Projection.\n         * @return {string|undefined} Tile URL.\n         */\n        function(tileCoord, pixelRatio, projection) {\n          if (!tileCoord) {\n            return undefined;\n          } else {\n            const tileCoordZ = tileCoord[0];\n            const tileCoordX = tileCoord[1];\n            const tileCoordY = tileCoord[2];\n            const tileIndex =\n                tileCoordX +\n                tileCoordY * tierSizeInTiles[tileCoordZ][0];\n            const tileSize = tileGrid.getTileSize(tileCoordZ);\n            const tileWidth = Array.isArray(tileSize) ? tileSize[0] : tileSize;\n            const tileGroup = ((tileIndex + tileCountUpToTier[tileCoordZ]) / tileWidth) | 0;\n            const localContext = {\n              'z': tileCoordZ,\n              'x': tileCoordX,\n              'y': tileCoordY,\n              'tileIndex': tileIndex,\n              'TileGroup': 'TileGroup' + tileGroup\n            };\n            return template.replace(/\\{(\\w+?)\\}/g, function(m, p) {\n              return localContext[p];\n            });\n          }\n        }\n      );\n    }\n\n    const tileUrlFunction = createFromTileUrlFunctions(urls.map(createFromTemplate));\n\n    const ZoomifyTileClass = CustomTile.bind(null, tilePixelRatio, tileGrid);\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      crossOrigin: options.crossOrigin,\n      projection: options.projection,\n      tilePixelRatio: tilePixelRatio,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileClass: ZoomifyTileClass,\n      tileGrid: tileGrid,\n      tileUrlFunction: tileUrlFunction,\n      transition: options.transition\n    });\n\n    /**\n     * @inheritDoc\n     */\n    this.zDirection = options.zDirection;\n\n  }\n\n}\n\nexport default Zoomify;\n","/**\n * @module ol/geom/flat/straightchunk\n */\n\n\n/**\n * @param {number} maxAngle Maximum acceptable angle delta between segments.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {Array<number>} Start and end of the first suitable chunk of the\n * given `flatCoordinates`.\n */\nexport function matchingChunk(maxAngle, flatCoordinates, offset, end, stride) {\n  let chunkStart = offset;\n  let chunkEnd = offset;\n  let chunkM = 0;\n  let m = 0;\n  let start = offset;\n  let acos, i, m12, m23, x1, y1, x12, y12, x23, y23;\n  for (i = offset; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    if (x1 !== undefined) {\n      x23 = x2 - x1;\n      y23 = y2 - y1;\n      m23 = Math.sqrt(x23 * x23 + y23 * y23);\n      if (x12 !== undefined) {\n        m += m12;\n        acos = Math.acos((x12 * x23 + y12 * y23) / (m12 * m23));\n        if (acos > maxAngle) {\n          if (m > chunkM) {\n            chunkM = m;\n            chunkStart = start;\n            chunkEnd = i;\n          }\n          m = 0;\n          start = i - stride;\n        }\n      }\n      m12 = m23;\n      x12 = x23;\n      y12 = y23;\n    }\n    x1 = x2;\n    y1 = y2;\n  }\n  m += m23;\n  return m > chunkM ? [start, i] : [chunkStart, chunkEnd];\n}\n","/**\n * @module ol/render/canvas/TextBuilder\n */\nimport {getUid} from '../../util.js';\nimport {asColorLike} from '../../colorlike.js';\nimport {intersects} from '../../extent.js';\nimport {matchingChunk} from '../../geom/flat/straightchunk.js';\nimport GeometryType from '../../geom/GeometryType.js';\nimport {labelCache, defaultTextAlign, defaultPadding, defaultLineCap, defaultLineDashOffset, defaultLineDash, defaultLineJoin, defaultFillStyle, checkFont, defaultFont, defaultLineWidth, defaultMiterLimit, defaultStrokeStyle, defaultTextBaseline} from '../canvas.js';\nimport CanvasInstruction from './Instruction.js';\nimport CanvasBuilder from './Builder.js';\nimport TextPlacement from '../../style/TextPlacement.js';\n/**\n * @const\n * @enum {number}\n */\nexport const TEXT_ALIGN = {\n  'left': 0,\n  'end': 0,\n  'center': 0.5,\n  'right': 1,\n  'start': 1,\n  'top': 0,\n  'middle': 0.5,\n  'hanging': 0.2,\n  'alphabetic': 0.8,\n  'ideographic': 0.8,\n  'bottom': 1\n};\n\n\nclass CanvasTextBuilder extends CanvasBuilder {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n  constructor(tolerance, maxExtent, resolution, pixelRatio) {\n    super(tolerance, maxExtent, resolution, pixelRatio);\n\n    /**\n     * @private\n     * @type {import(\"../canvas.js\").DeclutterGroups}\n     */\n    this.declutterGroups_;\n\n    /**\n     * @private\n     * @type {Array<HTMLCanvasElement>}\n     */\n    this.labels_ = null;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.text_ = '';\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetX_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textOffsetY_ = 0;\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.textRotateWithView_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.textRotation_ = 0;\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").FillState}\n     */\n    this.textFillState_ = null;\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").FillState>}\n     */\n    this.fillStates = {};\n\n    /**\n     * @private\n     * @type {?import(\"../canvas.js\").StrokeState}\n     */\n    this.textStrokeState_ = null;\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").StrokeState>}\n     */\n    this.strokeStates = {};\n\n    /**\n     * @private\n     * @type {import(\"../canvas.js\").TextState}\n     */\n    this.textState_ = /** @type {import(\"../canvas.js\").TextState} */ ({});\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").TextState>}\n     */\n    this.textStates = {};\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.textKey_ = '';\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.fillKey_ = '';\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.strokeKey_ = '';\n\n    labelCache.prune();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  finish() {\n    const instructions = super.finish();\n    instructions.textStates = this.textStates;\n    instructions.fillStates = this.fillStates;\n    instructions.strokeStates = this.strokeStates;\n    return instructions;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawText(geometry, feature) {\n    const fillState = this.textFillState_;\n    const strokeState = this.textStrokeState_;\n    const textState = this.textState_;\n    if (this.text_ === '' || !textState || (!fillState && !strokeState)) {\n      return;\n    }\n\n    let begin = this.coordinates.length;\n\n    const geometryType = geometry.getType();\n    let flatCoordinates = null;\n    let end = 2;\n    let stride = 2;\n    let i, ii;\n\n    if (textState.placement === TextPlacement.LINE) {\n      if (!intersects(this.getBufferedMaxExtent(), geometry.getExtent())) {\n        return;\n      }\n      let ends;\n      flatCoordinates = geometry.getFlatCoordinates();\n      stride = geometry.getStride();\n      if (geometryType == GeometryType.LINE_STRING) {\n        ends = [flatCoordinates.length];\n      } else if (geometryType == GeometryType.MULTI_LINE_STRING) {\n        ends = geometry.getEnds();\n      } else if (geometryType == GeometryType.POLYGON) {\n        ends = geometry.getEnds().slice(0, 1);\n      } else if (geometryType == GeometryType.MULTI_POLYGON) {\n        const endss = geometry.getEndss();\n        ends = [];\n        for (i = 0, ii = endss.length; i < ii; ++i) {\n          ends.push(endss[i][0]);\n        }\n      }\n      this.beginGeometry(geometry, feature);\n      const textAlign = textState.textAlign;\n      let flatOffset = 0;\n      let flatEnd;\n      for (let o = 0, oo = ends.length; o < oo; ++o) {\n        if (textAlign == undefined) {\n          const range = matchingChunk(textState.maxAngle, flatCoordinates, flatOffset, ends[o], stride);\n          flatOffset = range[0];\n          flatEnd = range[1];\n        } else {\n          flatEnd = ends[o];\n        }\n        for (i = flatOffset; i < flatEnd; i += stride) {\n          this.coordinates.push(flatCoordinates[i], flatCoordinates[i + 1]);\n        }\n        end = this.coordinates.length;\n        flatOffset = ends[o];\n        const declutterGroup = this.declutterGroups_ ?\n          (o === 0 ? this.declutterGroups_[0] : [].concat(this.declutterGroups_[0])) :\n          null;\n        this.drawChars_(begin, end, declutterGroup);\n        begin = end;\n      }\n      this.endGeometry(feature);\n\n    } else {\n\n      let geometryWidths = null;\n      if (!textState.overflow) {\n        geometryWidths = [];\n      }\n      switch (geometryType) {\n        case GeometryType.POINT:\n        case GeometryType.MULTI_POINT:\n          flatCoordinates = geometry.getFlatCoordinates();\n          end = flatCoordinates.length;\n          break;\n        case GeometryType.LINE_STRING:\n          flatCoordinates = /** @type {import(\"../../geom/LineString.js\").default} */ (geometry).getFlatMidpoint();\n          break;\n        case GeometryType.CIRCLE:\n          flatCoordinates = /** @type {import(\"../../geom/Circle.js\").default} */ (geometry).getCenter();\n          break;\n        case GeometryType.MULTI_LINE_STRING:\n          flatCoordinates = /** @type {import(\"../../geom/MultiLineString.js\").default} */ (geometry).getFlatMidpoints();\n          end = flatCoordinates.length;\n          break;\n        case GeometryType.POLYGON:\n          flatCoordinates = /** @type {import(\"../../geom/Polygon.js\").default} */ (geometry).getFlatInteriorPoint();\n          if (!textState.overflow) {\n            geometryWidths.push(flatCoordinates[2] / this.resolution);\n          }\n          stride = 3;\n          break;\n        case GeometryType.MULTI_POLYGON:\n          const interiorPoints = /** @type {import(\"../../geom/MultiPolygon.js\").default} */ (geometry).getFlatInteriorPoints();\n          flatCoordinates = [];\n          for (i = 0, ii = interiorPoints.length; i < ii; i += 3) {\n            if (!textState.overflow) {\n              geometryWidths.push(interiorPoints[i + 2] / this.resolution);\n            }\n            flatCoordinates.push(interiorPoints[i], interiorPoints[i + 1]);\n          }\n          end = flatCoordinates.length;\n          if (end == 0) {\n            return;\n          }\n          break;\n        default:\n      }\n      end = this.appendFlatCoordinates(flatCoordinates, 0, end, stride, false, false);\n\n      this.saveTextStates_();\n\n      if (textState.backgroundFill || textState.backgroundStroke) {\n        this.setFillStrokeStyle(textState.backgroundFill, textState.backgroundStroke);\n        if (textState.backgroundFill) {\n          this.updateFillStyle(this.state, this.createFill);\n          this.hitDetectionInstructions.push(this.createFill(this.state));\n        }\n        if (textState.backgroundStroke) {\n          this.updateStrokeStyle(this.state, this.applyStroke);\n          this.hitDetectionInstructions.push(this.createStroke(this.state));\n        }\n      }\n\n      this.beginGeometry(geometry, feature);\n\n      // The image is unknown at this stage so we pass null; it will be computed at render time.\n      // For clarity, we pass NaN for offsetX, offsetY, width and height, which will be computed at\n      // render time.\n      const pixelRatio = this.pixelRatio;\n      this.instructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n        null, NaN, NaN, this.declutterGroups_, NaN, 1, 0, 0,\n        this.textRotateWithView_, this.textRotation_, 1, NaN,\n        textState.padding == defaultPadding ?\n          defaultPadding : textState.padding.map(function(p) {\n            return p * pixelRatio;\n          }),\n        !!textState.backgroundFill, !!textState.backgroundStroke,\n        this.text_, this.textKey_, this.strokeKey_, this.fillKey_,\n        this.textOffsetX_, this.textOffsetY_, geometryWidths\n      ]);\n      this.hitDetectionInstructions.push([CanvasInstruction.DRAW_IMAGE, begin, end,\n        null, NaN, NaN, this.declutterGroups_, NaN, 1, 0, 0,\n        this.textRotateWithView_, this.textRotation_, 1 / this.pixelRatio, NaN,\n        textState.padding,\n        !!textState.backgroundFill, !!textState.backgroundStroke,\n        this.text_, this.textKey_, this.strokeKey_, this.fillKey_,\n        this.textOffsetX_, this.textOffsetY_, geometryWidths\n      ]);\n\n      this.endGeometry(feature);\n    }\n  }\n\n  /**\n   * @private\n   */\n  saveTextStates_() {\n    const strokeState = this.textStrokeState_;\n    const textState = this.textState_;\n    const fillState = this.textFillState_;\n\n    const strokeKey = this.strokeKey_;\n    if (strokeState) {\n      if (!(strokeKey in this.strokeStates)) {\n        this.strokeStates[strokeKey] = {\n          strokeStyle: strokeState.strokeStyle,\n          lineCap: strokeState.lineCap,\n          lineDashOffset: strokeState.lineDashOffset,\n          lineWidth: strokeState.lineWidth,\n          lineJoin: strokeState.lineJoin,\n          miterLimit: strokeState.miterLimit,\n          lineDash: strokeState.lineDash\n        };\n      }\n    }\n    const textKey = this.textKey_;\n    if (!(textKey in this.textStates)) {\n      this.textStates[textKey] = {\n        font: textState.font,\n        textAlign: textState.textAlign || defaultTextAlign,\n        textBaseline: textState.textBaseline || defaultTextBaseline,\n        scale: textState.scale\n      };\n    }\n    const fillKey = this.fillKey_;\n    if (fillState) {\n      if (!(fillKey in this.fillStates)) {\n        this.fillStates[fillKey] = {\n          fillStyle: fillState.fillStyle\n        };\n      }\n    }\n  }\n\n  /**\n   * @private\n   * @param {number} begin Begin.\n   * @param {number} end End.\n   * @param {import(\"../canvas.js\").DeclutterGroup} declutterGroup Declutter group.\n   */\n  drawChars_(begin, end, declutterGroup) {\n    const strokeState = this.textStrokeState_;\n    const textState = this.textState_;\n\n    const strokeKey = this.strokeKey_;\n    const textKey = this.textKey_;\n    const fillKey = this.fillKey_;\n    this.saveTextStates_();\n\n\n    const pixelRatio = this.pixelRatio;\n    const baseline = TEXT_ALIGN[textState.textBaseline];\n\n    const offsetY = this.textOffsetY_ * pixelRatio;\n    const text = this.text_;\n    const textScale = textState.scale;\n    const strokeWidth = strokeState ? strokeState.lineWidth * textScale / 2 : 0;\n\n    this.instructions.push([CanvasInstruction.DRAW_CHARS,\n      begin, end, baseline, declutterGroup,\n      textState.overflow, fillKey, textState.maxAngle,\n      pixelRatio,\n      offsetY, strokeKey, strokeWidth * pixelRatio, text, textKey, 1\n    ]);\n    this.hitDetectionInstructions.push([CanvasInstruction.DRAW_CHARS,\n      begin, end, baseline, declutterGroup,\n      textState.overflow, fillKey, textState.maxAngle,\n      1,\n      offsetY, strokeKey, strokeWidth, text, textKey, 1 / pixelRatio\n    ]);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setTextStyle(textStyle, declutterGroups) {\n    let textState, fillState, strokeState;\n    if (!textStyle) {\n      this.text_ = '';\n    } else {\n      this.declutterGroups_ = /** @type {import(\"../canvas.js\").DeclutterGroups} */ (declutterGroups);\n\n      const textFillStyle = textStyle.getFill();\n      if (!textFillStyle) {\n        fillState = this.textFillState_ = null;\n      } else {\n        fillState = this.textFillState_;\n        if (!fillState) {\n          fillState = this.textFillState_ = /** @type {import(\"../canvas.js\").FillState} */ ({});\n        }\n        fillState.fillStyle = asColorLike(\n          textFillStyle.getColor() || defaultFillStyle);\n      }\n\n      const textStrokeStyle = textStyle.getStroke();\n      if (!textStrokeStyle) {\n        strokeState = this.textStrokeState_ = null;\n      } else {\n        strokeState = this.textStrokeState_;\n        if (!strokeState) {\n          strokeState = this.textStrokeState_ = /** @type {import(\"../canvas.js\").StrokeState} */ ({});\n        }\n        const lineDash = textStrokeStyle.getLineDash();\n        const lineDashOffset = textStrokeStyle.getLineDashOffset();\n        const lineWidth = textStrokeStyle.getWidth();\n        const miterLimit = textStrokeStyle.getMiterLimit();\n        strokeState.lineCap = textStrokeStyle.getLineCap() || defaultLineCap;\n        strokeState.lineDash = lineDash ? lineDash.slice() : defaultLineDash;\n        strokeState.lineDashOffset =\n            lineDashOffset === undefined ? defaultLineDashOffset : lineDashOffset;\n        strokeState.lineJoin = textStrokeStyle.getLineJoin() || defaultLineJoin;\n        strokeState.lineWidth =\n            lineWidth === undefined ? defaultLineWidth : lineWidth;\n        strokeState.miterLimit =\n            miterLimit === undefined ? defaultMiterLimit : miterLimit;\n        strokeState.strokeStyle = asColorLike(\n          textStrokeStyle.getColor() || defaultStrokeStyle);\n      }\n\n      textState = this.textState_;\n      const font = textStyle.getFont() || defaultFont;\n      checkFont(font);\n      const textScale = textStyle.getScale();\n      textState.overflow = textStyle.getOverflow();\n      textState.font = font;\n      textState.maxAngle = textStyle.getMaxAngle();\n      textState.placement = textStyle.getPlacement();\n      textState.textAlign = textStyle.getTextAlign();\n      textState.textBaseline = textStyle.getTextBaseline() || defaultTextBaseline;\n      textState.backgroundFill = textStyle.getBackgroundFill();\n      textState.backgroundStroke = textStyle.getBackgroundStroke();\n      textState.padding = textStyle.getPadding() || defaultPadding;\n      textState.scale = textScale === undefined ? 1 : textScale;\n\n      const textOffsetX = textStyle.getOffsetX();\n      const textOffsetY = textStyle.getOffsetY();\n      const textRotateWithView = textStyle.getRotateWithView();\n      const textRotation = textStyle.getRotation();\n      this.text_ = textStyle.getText() || '';\n      this.textOffsetX_ = textOffsetX === undefined ? 0 : textOffsetX;\n      this.textOffsetY_ = textOffsetY === undefined ? 0 : textOffsetY;\n      this.textRotateWithView_ = textRotateWithView === undefined ? false : textRotateWithView;\n      this.textRotation_ = textRotation === undefined ? 0 : textRotation;\n\n      this.strokeKey_ = strokeState ?\n        (typeof strokeState.strokeStyle == 'string' ? strokeState.strokeStyle : getUid(strokeState.strokeStyle)) +\n        strokeState.lineCap + strokeState.lineDashOffset + '|' + strokeState.lineWidth +\n        strokeState.lineJoin + strokeState.miterLimit + '[' + strokeState.lineDash.join() + ']' :\n        '';\n      this.textKey_ = textState.font + textState.scale + (textState.textAlign || '?');\n      this.fillKey_ = fillState ?\n        (typeof fillState.fillStyle == 'string' ? fillState.fillStyle : ('|' + getUid(fillState.fillStyle))) :\n        '';\n    }\n  }\n}\n\n\nexport default CanvasTextBuilder;\n","/**\n * @module ol/control/MousePosition\n */\nimport {listen} from '../events.js';\nimport EventType from '../pointer/EventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport Control from './Control.js';\nimport {getTransformFromProjections, identityTransform, get as getProjection, getUserProjection} from '../proj.js';\nimport '@openlayers/pepjs';\n\n\n/**\n * @type {string}\n */\nconst PROJECTION = 'projection';\n\n/**\n * @type {string}\n */\nconst COORDINATE_FORMAT = 'coordinateFormat';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-mouse-position'] CSS class name.\n * @property {import(\"../coordinate.js\").CoordinateFormat} [coordinateFormat] Coordinate format.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Projection. Default is the view projection.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when the\n * control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n * @property {HTMLElement|string} [target] Specify a target if you want the\n * control to be rendered outside of the map's viewport.\n * @property {string} [undefinedHTML='&#160;'] Markup to show when coordinates are not\n * available (e.g. when the pointer leaves the map viewport).  By default, the last position\n * will be replaced with `'&#160;'` (`&nbsp;`) when the pointer leaves the viewport.  To\n * retain the last rendered position, set this option to something falsey (like an empty\n * string `''`).\n */\n\n\n/**\n * @classdesc\n * A control to show the 2D coordinates of the mouse cursor. By default, these\n * are in the view projection, but can be in any supported projection.\n * By default the control is shown in the top right corner of the map, but this\n * can be changed by using the css selector `.ol-mouse-position`.\n *\n * On touch devices, which usually do not have a mouse cursor, the coordinates\n * of the currently touched position are shown.\n *\n * @api\n */\nclass MousePosition extends Control {\n\n  /**\n   * @param {Options=} opt_options Mouse position options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    const element = document.createElement('div');\n    element.className = options.className !== undefined ? options.className : 'ol-mouse-position';\n\n    super({\n      element: element,\n      render: options.render || render,\n      target: options.target\n    });\n\n    this.addEventListener(getChangeEventType(PROJECTION), this.handleProjectionChanged_);\n\n    if (options.coordinateFormat) {\n      this.setCoordinateFormat(options.coordinateFormat);\n    }\n    if (options.projection) {\n      this.setProjection(options.projection);\n    }\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.undefinedHTML_ = options.undefinedHTML !== undefined ? options.undefinedHTML : '&#160;';\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderOnMouseOut_ = !!this.undefinedHTML_;\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.renderedHTML_ = element.innerHTML;\n\n    /**\n     * @private\n     * @type {?import(\"../proj/Projection.js\").default}\n     */\n    this.mapProjection_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"../proj.js\").TransformFunction}\n     */\n    this.transform_ = null;\n\n  }\n\n  /**\n   * @private\n   */\n  handleProjectionChanged_() {\n    this.transform_ = null;\n  }\n\n  /**\n   * Return the coordinate format type used to render the current position or\n   * undefined.\n   * @return {import(\"../coordinate.js\").CoordinateFormat|undefined} The format to render the current\n   *     position in.\n   * @observable\n   * @api\n   */\n  getCoordinateFormat() {\n    return (\n      /** @type {import(\"../coordinate.js\").CoordinateFormat|undefined} */ (this.get(COORDINATE_FORMAT))\n    );\n  }\n\n  /**\n   * Return the projection that is used to report the mouse position.\n   * @return {import(\"../proj/Projection.js\").default|undefined} The projection to report mouse\n   *     position in.\n   * @observable\n   * @api\n   */\n  getProjection() {\n    return (\n      /** @type {import(\"../proj/Projection.js\").default|undefined} */ (this.get(PROJECTION))\n    );\n  }\n\n  /**\n   * @param {Event} event Browser event.\n   * @protected\n   */\n  handleMouseMove(event) {\n    const map = this.getMap();\n    this.updateHTML_(map.getEventPixel(event));\n  }\n\n  /**\n   * @param {Event} event Browser event.\n   * @protected\n   */\n  handleMouseOut(event) {\n    this.updateHTML_(null);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  setMap(map) {\n    super.setMap(map);\n    if (map) {\n      const viewport = map.getViewport();\n      this.listenerKeys.push(\n        listen(viewport, EventType.POINTERMOVE, this.handleMouseMove, this)\n      );\n      if (this.renderOnMouseOut_) {\n        this.listenerKeys.push(\n          listen(viewport, EventType.POINTEROUT, this.handleMouseOut, this)\n        );\n      }\n    }\n  }\n\n  /**\n   * Set the coordinate format type used to render the current position.\n   * @param {import(\"../coordinate.js\").CoordinateFormat} format The format to render the current\n   *     position in.\n   * @observable\n   * @api\n   */\n  setCoordinateFormat(format) {\n    this.set(COORDINATE_FORMAT, format);\n  }\n\n  /**\n   * Set the projection that is used to report the mouse position.\n   * @param {import(\"../proj.js\").ProjectionLike} projection The projection to report mouse\n   *     position in.\n   * @observable\n   * @api\n   */\n  setProjection(projection) {\n    this.set(PROJECTION, getProjection(projection));\n  }\n\n  /**\n   * @param {?import(\"../pixel.js\").Pixel} pixel Pixel.\n   * @private\n   */\n  updateHTML_(pixel) {\n    let html = this.undefinedHTML_;\n    if (pixel && this.mapProjection_) {\n      if (!this.transform_) {\n        const projection = this.getProjection();\n        if (projection) {\n          this.transform_ = getTransformFromProjections(\n            this.mapProjection_, projection);\n        } else {\n          this.transform_ = identityTransform;\n        }\n      }\n      const map = this.getMap();\n      const coordinate = map.getCoordinateFromPixelInternal(pixel);\n      if (coordinate) {\n        const userProjection = getUserProjection();\n        if (userProjection) {\n          this.transform_ = getTransformFromProjections(\n            this.mapProjection_, userProjection);\n        }\n        this.transform_(coordinate, coordinate);\n        const coordinateFormat = this.getCoordinateFormat();\n        if (coordinateFormat) {\n          html = coordinateFormat(coordinate);\n        } else {\n          html = coordinate.toString();\n        }\n      }\n    }\n    if (!this.renderedHTML_ || html !== this.renderedHTML_) {\n      this.element.innerHTML = html;\n      this.renderedHTML_ = html;\n    }\n  }\n}\n\n\n/**\n * Update the projection. Rendering of the coordinates is done in\n * `handleMouseMove` and `handleMouseUp`.\n * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n * @this {MousePosition}\n * @api\n */\nexport function render(mapEvent) {\n  const frameState = mapEvent.frameState;\n  if (!frameState) {\n    this.mapProjection_ = null;\n  } else {\n    if (this.mapProjection_ != frameState.viewState.projection) {\n      this.mapProjection_ = frameState.viewState.projection;\n      this.transform_ = null;\n    }\n  }\n}\n\n\nexport default MousePosition;\n","/**\n * @module ol/geom/flat/area\n */\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRing(flatCoordinates, offset, end, stride) {\n  let twiceArea = 0;\n  let x1 = flatCoordinates[end - stride];\n  let y1 = flatCoordinates[end - stride + 1];\n  for (; offset < end; offset += stride) {\n    const x2 = flatCoordinates[offset];\n    const y2 = flatCoordinates[offset + 1];\n    twiceArea += y1 * x2 - x1 * y2;\n    x1 = x2;\n    y1 = y2;\n  }\n  return twiceArea / 2;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<number>} ends Ends.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRings(flatCoordinates, offset, ends, stride) {\n  let area = 0;\n  for (let i = 0, ii = ends.length; i < ii; ++i) {\n    const end = ends[i];\n    area += linearRing(flatCoordinates, offset, end, stride);\n    offset = end;\n  }\n  return area;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {number} Area.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  let area = 0;\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    area += linearRings(flatCoordinates, offset, ends, stride);\n    offset = ends[ends.length - 1];\n  }\n  return area;\n}\n","/**\n * @module ol/renderer/canvas/Layer\n */\nimport {getBottomLeft, getBottomRight, getTopLeft, getTopRight} from '../../extent.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport RenderEvent from '../../render/Event.js';\nimport RenderEventType from '../../render/EventType.js';\nimport {rotateAtOffset} from '../../render/canvas.js';\nimport LayerRenderer from '../Layer.js';\nimport {create as createTransform, apply as applyTransform, compose as composeTransform, toString as transformToString} from '../../transform.js';\n\n/**\n * @abstract\n * @template {import(\"../../layer/Layer.js\").default} LayerType\n */\nclass CanvasLayerRenderer extends LayerRenderer {\n\n  /**\n   * @param {LayerType} layer Layer.\n   */\n  constructor(layer) {\n\n    super(layer);\n\n    /**\n     * @protected\n     * @type {HTMLElement}\n     */\n    this.container = null;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.renderedResolution;\n\n    /**\n     * A temporary transform.  The values in this transform should only be used in a\n     * function that sets the values.\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.tempTransform_ = createTransform();\n\n    /**\n     * The transform for rendered pixels to viewport CSS pixels.  This transform must\n     * be set when rendering a frame and may be used by other functions after rendering.\n     * @protected\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.pixelTransform = createTransform();\n\n    /**\n     * The transform for viewport CSS pixels to rendered pixels.  This transform must\n     * be set when rendering a frame and may be used by other functions after rendering.\n     * @protected\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.inversePixelTransform = createTransform();\n\n    /**\n     * @protected\n     * @type {CanvasRenderingContext2D}\n     */\n    this.context = null;\n\n    /**\n     * @type {boolean}\n     */\n    this.containerReused = false;\n\n  }\n\n  /**\n   * Get a rendering container from an existing target, if compatible.\n   * @param {HTMLElement} target Potential render target.\n   * @param {import(\"../../transform\").Transform} transform Transform.\n   * @param {number} opacity Opacity.\n   */\n  useContainer(target, transform, opacity) {\n    const layerClassName = this.getLayer().getClassName();\n    let container, context;\n    if (target && target.style.opacity === '' && target.className === layerClassName) {\n      const canvas = target.firstElementChild;\n      if (canvas instanceof HTMLCanvasElement) {\n        context = canvas.getContext('2d');\n      }\n    }\n    if (context && context.canvas.style.transform === transformToString(transform)) {\n      // Container of the previous layer renderer can be used.\n      this.container = target;\n      this.context = context;\n      this.containerReused = true;\n    } else if (this.containerReused) {\n      // Previously reused container cannot be used any more.\n      this.container = null;\n      this.context = null;\n      this.containerReused = false;\n    }\n    if (!this.container) {\n      container = document.createElement('div');\n      container.className = layerClassName;\n      let style = container.style;\n      style.position = 'absolute';\n      style.width = '100%';\n      style.height = '100%';\n      context = createCanvasContext2D();\n      const canvas = context.canvas;\n      container.appendChild(canvas);\n      style = canvas.style;\n      style.position = 'absolute';\n      style.transformOrigin = 'top left';\n      this.container = container;\n      this.context = context;\n    }\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../extent.js\").Extent} extent Clip extent.\n   * @protected\n   */\n  clip(context, frameState, extent) {\n    const pixelRatio = frameState.pixelRatio;\n    const halfWidth = (frameState.size[0] * pixelRatio) / 2;\n    const halfHeight = (frameState.size[1] * pixelRatio) / 2;\n    const rotation = frameState.viewState.rotation;\n    const topLeft = getTopLeft(extent);\n    const topRight = getTopRight(extent);\n    const bottomRight = getBottomRight(extent);\n    const bottomLeft = getBottomLeft(extent);\n\n    applyTransform(frameState.coordinateToPixelTransform, topLeft);\n    applyTransform(frameState.coordinateToPixelTransform, topRight);\n    applyTransform(frameState.coordinateToPixelTransform, bottomRight);\n    applyTransform(frameState.coordinateToPixelTransform, bottomLeft);\n\n    context.save();\n    rotateAtOffset(context, -rotation, halfWidth, halfHeight);\n    context.beginPath();\n    context.moveTo(topLeft[0] * pixelRatio, topLeft[1] * pixelRatio);\n    context.lineTo(topRight[0] * pixelRatio, topRight[1] * pixelRatio);\n    context.lineTo(bottomRight[0] * pixelRatio, bottomRight[1] * pixelRatio);\n    context.lineTo(bottomLeft[0] * pixelRatio, bottomLeft[1] * pixelRatio);\n    context.clip();\n    rotateAtOffset(context, rotation, halfWidth, halfHeight);\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../extent.js\").Extent} extent Clip extent.\n   * @protected\n   */\n  clipUnrotated(context, frameState, extent) {\n    const topLeft = getTopLeft(extent);\n    const topRight = getTopRight(extent);\n    const bottomRight = getBottomRight(extent);\n    const bottomLeft = getBottomLeft(extent);\n\n    applyTransform(frameState.coordinateToPixelTransform, topLeft);\n    applyTransform(frameState.coordinateToPixelTransform, topRight);\n    applyTransform(frameState.coordinateToPixelTransform, bottomRight);\n    applyTransform(frameState.coordinateToPixelTransform, bottomLeft);\n\n    const inverted = this.inversePixelTransform;\n    applyTransform(inverted, topLeft);\n    applyTransform(inverted, topRight);\n    applyTransform(inverted, bottomRight);\n    applyTransform(inverted, bottomLeft);\n\n    context.save();\n    context.beginPath();\n    context.moveTo(Math.round(topLeft[0]), Math.round(topLeft[1]));\n    context.lineTo(Math.round(topRight[0]), Math.round(topRight[1]));\n    context.lineTo(Math.round(bottomRight[0]), Math.round(bottomRight[1]));\n    context.lineTo(Math.round(bottomLeft[0]), Math.round(bottomLeft[1]));\n    context.clip();\n  }\n\n  /**\n   * @param {import(\"../../render/EventType.js\").default} type Event type.\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @private\n   */\n  dispatchRenderEvent_(type, context, frameState) {\n    const layer = this.getLayer();\n    if (layer.hasListener(type)) {\n      const event = new RenderEvent(type, this.inversePixelTransform, frameState, context);\n      layer.dispatchEvent(event);\n    }\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @protected\n   */\n  preRender(context, frameState) {\n    this.dispatchRenderEvent_(RenderEventType.PRERENDER, context, frameState);\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @protected\n   */\n  postRender(context, frameState) {\n    this.dispatchRenderEvent_(RenderEventType.POSTRENDER, context, frameState);\n  }\n\n  /**\n   * Creates a transform for rendering to an element that will be rotated after rendering.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {number} width Width of the rendered element (in pixels).\n   * @param {number} height Height of the rendered element (in pixels).\n   * @param {number} offsetX Offset on the x-axis in view coordinates.\n   * @protected\n   * @return {!import(\"../../transform.js\").Transform} Transform.\n   */\n  getRenderTransform(frameState, width, height, offsetX) {\n    const viewState = frameState.viewState;\n    const pixelRatio = frameState.pixelRatio;\n    const dx1 = width / 2;\n    const dy1 = height / 2;\n    const sx = pixelRatio / viewState.resolution;\n    const sy = -sx;\n    const dx2 = -viewState.center[0] + offsetX;\n    const dy2 = -viewState.center[1];\n    return composeTransform(this.tempTransform_, dx1, dy1, sx, sy, -viewState.rotation, dx2, dy2);\n  }\n\n  /**\n   * @param {import(\"../../pixel.js\").Pixel} pixel Pixel.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @return {Uint8ClampedArray|Uint8Array} The result.  If there is no data at the pixel\n   *    location, null will be returned.  If there is data, but pixel values cannot be\n   *    returned, and empty array will be returned.\n   */\n  getDataAtPixel(pixel, frameState, hitTolerance) {\n    const renderPixel = applyTransform(this.inversePixelTransform, pixel.slice());\n    const context = this.context;\n\n    let data;\n    try {\n      data = context.getImageData(Math.round(renderPixel[0]), Math.round(renderPixel[1]), 1, 1).data;\n    } catch (err) {\n      if (err.name === 'SecurityError') {\n        // tainted canvas, we assume there is data at the given pixel (although there might not be)\n        return new Uint8Array();\n      }\n      return data;\n    }\n\n    if (data[3] === 0) {\n      return null;\n    }\n    return data;\n  }\n\n}\n\nexport default CanvasLayerRenderer;\n","/**\n * @module ol/ImageBase\n */\nimport {abstract} from './util.js';\nimport EventTarget from './events/Target.js';\nimport EventType from './events/EventType.js';\n\n/**\n * @abstract\n */\nclass ImageBase extends EventTarget {\n\n  /**\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {number|undefined} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"./ImageState.js\").default} state State.\n   */\n  constructor(extent, resolution, pixelRatio, state) {\n\n    super();\n\n    /**\n     * @protected\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.extent = extent;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @protected\n     * @type {number|undefined}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @protected\n     * @type {import(\"./ImageState.js\").default}\n     */\n    this.state = state;\n\n  }\n\n  /**\n   * @protected\n   */\n  changed() {\n    this.dispatchEvent(EventType.CHANGE);\n  }\n\n  /**\n   * @return {import(\"./extent.js\").Extent} Extent.\n   */\n  getExtent() {\n    return this.extent;\n  }\n\n  /**\n   * @abstract\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   */\n  getImage() {\n    return abstract();\n  }\n\n  /**\n   * @return {number} PixelRatio.\n   */\n  getPixelRatio() {\n    return this.pixelRatio_;\n  }\n\n  /**\n   * @return {number} Resolution.\n   */\n  getResolution() {\n    return /** @type {number} */ (this.resolution);\n  }\n\n  /**\n   * @return {import(\"./ImageState.js\").default} State.\n   */\n  getState() {\n    return this.state;\n  }\n\n  /**\n   * Load not yet loaded URI.\n   * @abstract\n   */\n  load() {\n    abstract();\n  }\n}\n\n\nexport default ImageBase;\n","/**\n * @module ol/format/JSONFeature\n */\nimport {abstract} from '../util.js';\nimport FeatureFormat from './Feature.js';\nimport FormatType from './FormatType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for JSON feature formats.\n *\n * @abstract\n */\nclass JSONFeature extends FeatureFormat {\n  constructor() {\n    super();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getType() {\n    return FormatType.JSON;\n  }\n\n  /**\n   * Read a feature.  Only works for a single feature. Use `readFeatures` to\n   * read a feature collection.\n   *\n   * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   * @api\n   */\n  readFeature(source, opt_options) {\n    return this.readFeatureFromObject(\n      getObject(source), this.getReadOptions(source, opt_options));\n  }\n\n  /**\n   * Read all features.  Works with both a single feature and a feature\n   * collection.\n   *\n   * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   * @api\n   */\n  readFeatures(source, opt_options) {\n    return this.readFeaturesFromObject(\n      getObject(source), this.getReadOptions(source, opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @protected\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n  readFeatureFromObject(object, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @protected\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n  readFeaturesFromObject(object, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read a geometry.\n   *\n   * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   * @api\n   */\n  readGeometry(source, opt_options) {\n    return this.readGeometryFromObject(\n      getObject(source), this.getReadOptions(source, opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @protected\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometryFromObject(object, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read the projection.\n   *\n   * @param {ArrayBuffer|Document|Node|Object|string} source Source.\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   * @api\n   */\n  readProjection(source) {\n    return this.readProjectionFromObject(getObject(source));\n  }\n\n  /**\n   * @abstract\n   * @param {Object} object Object.\n   * @protected\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjectionFromObject(object) {\n    return abstract();\n  }\n\n  /**\n   * Encode a feature as string.\n   *\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Encoded feature.\n   * @api\n   */\n  writeFeature(feature, opt_options) {\n    return JSON.stringify(this.writeFeatureObject(feature, opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {Object} Object.\n   */\n  writeFeatureObject(feature, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Encode an array of features as string.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Encoded features.\n   * @api\n   */\n  writeFeatures(features, opt_options) {\n    return JSON.stringify(this.writeFeaturesObject(features, opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {Object} Object.\n   */\n  writeFeaturesObject(features, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Encode a geometry as string.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Encoded geometry.\n   * @api\n   */\n  writeGeometry(geometry, opt_options) {\n    return JSON.stringify(this.writeGeometryObject(geometry, opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {Object} Object.\n   */\n  writeGeometryObject(geometry, opt_options) {\n    return abstract();\n  }\n}\n\n\n/**\n * @param {Document|Node|Object|string} source Source.\n * @return {Object} Object.\n */\nfunction getObject(source) {\n  if (typeof source === 'string') {\n    const object = JSON.parse(source);\n    return object ? /** @type {Object} */ (object) : null;\n  } else if (source !== null) {\n    return source;\n  } else {\n    return null;\n  }\n}\n\n\nexport default JSONFeature;\n","/**\n * @module ol/layer/BaseVector\n */\nimport Layer from './Layer.js';\nimport {assign} from '../obj.js';\nimport {createDefaultStyle, toFunction as toStyleFunction} from '../style/Style.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {import(\"../render.js\").OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the viewport extent used by the\n * renderer when getting features from the vector source for the rendering or hit-detection.\n * Recommended value: the size of the largest symbol, line width or label.\n * @property {import(\"../source/Vector.js\").default} [source] Source.\n * @property {import(\"../PluggableMap.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text. Decluttering is applied to all\n * image and text styles of all Vector and VectorTile layers that have set this to `true`. The priority\n * is defined by the z-index of the layer, the `zIndex` of the style and the render order of features.\n * Higher z-index means higher priority. Within the same z-index, a feature rendered before another has\n * higher priority.\n * @property {import(\"../style/Style.js\").StyleLike} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [updateWhileAnimating=false] When set to `true`, feature batches will\n * be recreated during animations. This means that no vectors will be shown clipped, but the\n * setting will have a performance impact for large amounts of vector data. When set to `false`,\n * batches will be recreated when no animation is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true`, feature batches will\n * be recreated during interactions. See also `updateWhileAnimating`.\n */\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  RENDER_ORDER: 'renderOrder'\n};\n\n\n/**\n * @classdesc\n * Vector data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @template {import(\"../source/Vector.js\").default|import(\"../source/VectorTile.js\").default} VectorSourceType\n * @extends {Layer<VectorSourceType>}\n * @api\n */\nclass BaseVectorLayer extends Layer {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const baseOptions = assign({}, options);\n\n    delete baseOptions.style;\n    delete baseOptions.renderBuffer;\n    delete baseOptions.updateWhileAnimating;\n    delete baseOptions.updateWhileInteracting;\n    super(baseOptions);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.declutter_ = options.declutter !== undefined ? options.declutter : false;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.renderBuffer_ = options.renderBuffer !== undefined ?\n      options.renderBuffer : 100;\n\n    /**\n     * User provided style.\n     * @type {import(\"../style/Style.js\").StyleLike}\n     * @private\n     */\n    this.style_ = null;\n\n    /**\n     * Style function for use within the library.\n     * @type {import(\"../style/Style.js\").StyleFunction|undefined}\n     * @private\n     */\n    this.styleFunction_ = undefined;\n\n    this.setStyle(options.style);\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.updateWhileAnimating_ = options.updateWhileAnimating !== undefined ?\n      options.updateWhileAnimating : false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.updateWhileInteracting_ = options.updateWhileInteracting !== undefined ?\n      options.updateWhileInteracting : false;\n\n  }\n\n  /**\n   * @return {boolean} Declutter.\n   */\n  getDeclutter() {\n    return this.declutter_;\n  }\n\n  /**\n   * @return {number|undefined} Render buffer.\n   */\n  getRenderBuffer() {\n    return this.renderBuffer_;\n  }\n\n  /**\n   * @return {function(import(\"../Feature.js\").default, import(\"../Feature.js\").default): number|null|undefined} Render\n   *     order.\n   */\n  getRenderOrder() {\n    return (\n    /** @type {import(\"../render.js\").OrderFunction|null|undefined} */ (this.get(Property.RENDER_ORDER))\n    );\n  }\n\n  /**\n   * Get the style for features.  This returns whatever was passed to the `style`\n   * option at construction or to the `setStyle` method.\n   * @return {import(\"../style/Style.js\").StyleLike}\n   *     Layer style.\n   * @api\n   */\n  getStyle() {\n    return this.style_;\n  }\n\n  /**\n   * Get the style function.\n   * @return {import(\"../style/Style.js\").StyleFunction|undefined} Layer style function.\n   * @api\n   */\n  getStyleFunction() {\n    return this.styleFunction_;\n  }\n\n  /**\n   * @return {boolean} Whether the rendered layer should be updated while\n   *     animating.\n   */\n  getUpdateWhileAnimating() {\n    return this.updateWhileAnimating_;\n  }\n\n  /**\n   * @return {boolean} Whether the rendered layer should be updated while\n   *     interacting.\n   */\n  getUpdateWhileInteracting() {\n    return this.updateWhileInteracting_;\n  }\n\n  /**\n   * @param {import(\"../render.js\").OrderFunction|null|undefined} renderOrder\n   *     Render order.\n   */\n  setRenderOrder(renderOrder) {\n    this.set(Property.RENDER_ORDER, renderOrder);\n  }\n\n  /**\n   * Set the style for features.  This can be a single style object, an array\n   * of styles, or a function that takes a feature and resolution and returns\n   * an array of styles. If it is `undefined` the default style is used. If\n   * it is `null` the layer has no style (a `null` style), so only features\n   * that have their own styles will be rendered in the layer. See\n   * {@link module:ol/style} for information on the default style.\n   * @param {import(\"../style/Style.js\").default|Array<import(\"../style/Style.js\").default>|import(\"../style/Style.js\").StyleFunction|null|undefined} style Layer style.\n   * @api\n   */\n  setStyle(style) {\n    this.style_ = style !== undefined ? style : createDefaultStyle;\n    this.styleFunction_ = style === null ?\n      undefined : toStyleFunction(this.style_);\n    this.changed();\n  }\n\n}\n\n\nexport default BaseVectorLayer;\n","/**\n * @module ol/format/TextFeature\n */\nimport {abstract} from '../util.js';\nimport FeatureFormat from '../format/Feature.js';\nimport FormatType from '../format/FormatType.js';\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for text feature formats.\n *\n * @abstract\n */\nclass TextFeature extends FeatureFormat {\n  constructor() {\n    super();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getType() {\n    return FormatType.TEXT;\n  }\n\n  /**\n   * Read the feature from the source.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {import(\"../Feature.js\").default} Feature.\n   * @api\n   */\n  readFeature(source, opt_options) {\n    return this.readFeatureFromText(getText(source), this.adaptOptions(opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {string} text Text.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @protected\n   * @return {import(\"../Feature.js\").default} Feature.\n   */\n  readFeatureFromText(text, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read the features from the source.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   * @api\n   */\n  readFeatures(source, opt_options) {\n    return this.readFeaturesFromText(getText(source), this.adaptOptions(opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {string} text Text.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @protected\n   * @return {Array<import(\"../Feature.js\").default>} Features.\n   */\n  readFeaturesFromText(text, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read the geometry from the source.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   * @api\n   */\n  readGeometry(source, opt_options) {\n    return this.readGeometryFromText(getText(source), this.adaptOptions(opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {string} text Text.\n   * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n   * @protected\n   * @return {import(\"../geom/Geometry.js\").default} Geometry.\n   */\n  readGeometryFromText(text, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Read the projection from the source.\n   *\n   * @param {Document|Node|Object|string} source Source.\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   * @api\n   */\n  readProjection(source) {\n    return this.readProjectionFromText(getText(source));\n  }\n\n  /**\n   * @param {string} text Text.\n   * @protected\n   * @return {import(\"../proj/Projection.js\").default} Projection.\n   */\n  readProjectionFromText(text) {\n    return this.dataProjection;\n  }\n\n  /**\n   * Encode a feature as a string.\n   *\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Encoded feature.\n   * @api\n   */\n  writeFeature(feature, opt_options) {\n    return this.writeFeatureText(feature, this.adaptOptions(opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../Feature.js\").default} feature Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @protected\n   * @return {string} Text.\n   */\n  writeFeatureText(feature, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Encode an array of features as string.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Encoded features.\n   * @api\n   */\n  writeFeatures(features, opt_options) {\n    return this.writeFeaturesText(features, this.adaptOptions(opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @protected\n   * @return {string} Text.\n   */\n  writeFeaturesText(features, opt_options) {\n    return abstract();\n  }\n\n  /**\n   * Write a single geometry.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {string} Geometry.\n   * @api\n   */\n  writeGeometry(geometry, opt_options) {\n    return this.writeGeometryText(geometry, this.adaptOptions(opt_options));\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @protected\n   * @return {string} Text.\n   */\n  writeGeometryText(geometry, opt_options) {\n    return abstract();\n  }\n}\n\n\n/**\n * @param {Document|Node|Object|string} source Source.\n * @return {string} Text.\n */\nfunction getText(source) {\n  if (typeof source === 'string') {\n    return source;\n  } else {\n    return '';\n  }\n}\n\n\nexport default TextFeature;\n","/**\n * @module ol/Geolocation\n */\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport BaseEvent from './events/Event.js';\nimport EventType from './events/EventType.js';\nimport {circular as circularPolygon} from './geom/Polygon.js';\nimport {toRadians} from './math.js';\nimport {get as getProjection, getTransformFromProjections, identityTransform} from './proj.js';\n\n\n/**\n * @enum {string}\n */\nconst Property = {\n  ACCURACY: 'accuracy',\n  ACCURACY_GEOMETRY: 'accuracyGeometry',\n  ALTITUDE: 'altitude',\n  ALTITUDE_ACCURACY: 'altitudeAccuracy',\n  HEADING: 'heading',\n  POSITION: 'position',\n  PROJECTION: 'projection',\n  SPEED: 'speed',\n  TRACKING: 'tracking',\n  TRACKING_OPTIONS: 'trackingOptions'\n};\n\n\n/**\n * @classdesc\n * Events emitted on Geolocation error.\n */\nclass GeolocationError extends BaseEvent {\n  /**\n   * @param {PositionError} error error object.\n   */\n  constructor(error) {\n    super(EventType.ERROR);\n\n    /**\n     * @type {number}\n     */\n    this.code = error.code;\n\n    /**\n     * @type {string}\n     */\n    this.message = error.message;\n  }\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [tracking=false] Start Tracking right after\n * instantiation.\n * @property {PositionOptions} [trackingOptions] Tracking options.\n * See http://www.w3.org/TR/geolocation-API/#position_options_interface.\n * @property {import(\"./proj.js\").ProjectionLike} [projection] The projection the position\n * is reported in.\n */\n\n\n/**\n * @classdesc\n * Helper class for providing HTML5 Geolocation capabilities.\n * The [Geolocation API](http://www.w3.org/TR/geolocation-API/)\n * is used to locate a user's position.\n *\n * To get notified of position changes, register a listener for the generic\n * `change` event on your instance of {@link module:ol/Geolocation~Geolocation}.\n *\n * Example:\n *\n *     var geolocation = new Geolocation({\n *       // take the projection to use from the map's view\n *       projection: view.getProjection()\n *     });\n *     // listen to changes in position\n *     geolocation.on('change', function(evt) {\n *       window.console.log(geolocation.getPosition());\n *     });\n *\n * @fires module:ol/events/Event~BaseEvent#event:error\n * @api\n */\nclass Geolocation extends BaseObject {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    super();\n\n    const options = opt_options || {};\n\n    /**\n     * The unprojected (EPSG:4326) device position.\n     * @private\n     * @type {?import(\"./coordinate.js\").Coordinate}\n     */\n    this.position_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./proj.js\").TransformFunction}\n     */\n    this.transform_ = identityTransform;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.watchId_ = undefined;\n\n    this.addEventListener(getChangeEventType(Property.PROJECTION), this.handleProjectionChanged_);\n    this.addEventListener(getChangeEventType(Property.TRACKING), this.handleTrackingChanged_);\n\n    if (options.projection !== undefined) {\n      this.setProjection(options.projection);\n    }\n    if (options.trackingOptions !== undefined) {\n      this.setTrackingOptions(options.trackingOptions);\n    }\n\n    this.setTracking(options.tracking !== undefined ? options.tracking : false);\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.setTracking(false);\n    super.disposeInternal();\n  }\n\n  /**\n   * @private\n   */\n  handleProjectionChanged_() {\n    const projection = this.getProjection();\n    if (projection) {\n      this.transform_ = getTransformFromProjections(\n        getProjection('EPSG:4326'), projection);\n      if (this.position_) {\n        this.set(Property.POSITION, this.transform_(this.position_));\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  handleTrackingChanged_() {\n    if ('geolocation' in navigator) {\n      const tracking = this.getTracking();\n      if (tracking && this.watchId_ === undefined) {\n        this.watchId_ = navigator.geolocation.watchPosition(\n          this.positionChange_.bind(this),\n          this.positionError_.bind(this),\n          this.getTrackingOptions());\n      } else if (!tracking && this.watchId_ !== undefined) {\n        navigator.geolocation.clearWatch(this.watchId_);\n        this.watchId_ = undefined;\n      }\n    }\n  }\n\n  /**\n   * @private\n   * @param {Position} position position event.\n   */\n  positionChange_(position) {\n    const coords = position.coords;\n    this.set(Property.ACCURACY, coords.accuracy);\n    this.set(Property.ALTITUDE,\n      coords.altitude === null ? undefined : coords.altitude);\n    this.set(Property.ALTITUDE_ACCURACY,\n      coords.altitudeAccuracy === null ?\n        undefined : coords.altitudeAccuracy);\n    this.set(Property.HEADING, coords.heading === null ?\n      undefined : toRadians(coords.heading));\n    if (!this.position_) {\n      this.position_ = [coords.longitude, coords.latitude];\n    } else {\n      this.position_[0] = coords.longitude;\n      this.position_[1] = coords.latitude;\n    }\n    const projectedPosition = this.transform_(this.position_);\n    this.set(Property.POSITION, projectedPosition);\n    this.set(Property.SPEED,\n      coords.speed === null ? undefined : coords.speed);\n    const geometry = circularPolygon(this.position_, coords.accuracy);\n    geometry.applyTransform(this.transform_);\n    this.set(Property.ACCURACY_GEOMETRY, geometry);\n    this.changed();\n  }\n\n  /**\n   * @private\n   * @param {PositionError} error error object.\n   */\n  positionError_(error) {\n    this.setTracking(false);\n    this.dispatchEvent(new GeolocationError(error));\n  }\n\n  /**\n   * Get the accuracy of the position in meters.\n   * @return {number|undefined} The accuracy of the position measurement in\n   *     meters.\n   * @observable\n   * @api\n   */\n  getAccuracy() {\n    return /** @type {number|undefined} */ (this.get(Property.ACCURACY));\n  }\n\n  /**\n   * Get a geometry of the position accuracy.\n   * @return {?import(\"./geom/Polygon.js\").default} A geometry of the position accuracy.\n   * @observable\n   * @api\n   */\n  getAccuracyGeometry() {\n    return (\n      /** @type {?import(\"./geom/Polygon.js\").default} */ (this.get(Property.ACCURACY_GEOMETRY) || null)\n    );\n  }\n\n  /**\n   * Get the altitude associated with the position.\n   * @return {number|undefined} The altitude of the position in meters above mean\n   *     sea level.\n   * @observable\n   * @api\n   */\n  getAltitude() {\n    return /** @type {number|undefined} */ (this.get(Property.ALTITUDE));\n  }\n\n  /**\n   * Get the altitude accuracy of the position.\n   * @return {number|undefined} The accuracy of the altitude measurement in\n   *     meters.\n   * @observable\n   * @api\n   */\n  getAltitudeAccuracy() {\n    return /** @type {number|undefined} */ (this.get(Property.ALTITUDE_ACCURACY));\n  }\n\n  /**\n   * Get the heading as radians clockwise from North.\n   * Note: depending on the browser, the heading is only defined if the `enableHighAccuracy`\n   * is set to `true` in the tracking options.\n   * @return {number|undefined} The heading of the device in radians from north.\n   * @observable\n   * @api\n   */\n  getHeading() {\n    return /** @type {number|undefined} */ (this.get(Property.HEADING));\n  }\n\n  /**\n   * Get the position of the device.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The current position of the device reported\n   *     in the current projection.\n   * @observable\n   * @api\n   */\n  getPosition() {\n    return (\n      /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (this.get(Property.POSITION))\n    );\n  }\n\n  /**\n   * Get the projection associated with the position.\n   * @return {import(\"./proj/Projection.js\").default|undefined} The projection the position is\n   *     reported in.\n   * @observable\n   * @api\n   */\n  getProjection() {\n    return (\n      /** @type {import(\"./proj/Projection.js\").default|undefined} */ (this.get(Property.PROJECTION))\n    );\n  }\n\n  /**\n   * Get the speed in meters per second.\n   * @return {number|undefined} The instantaneous speed of the device in meters\n   *     per second.\n   * @observable\n   * @api\n   */\n  getSpeed() {\n    return /** @type {number|undefined} */ (this.get(Property.SPEED));\n  }\n\n  /**\n   * Determine if the device location is being tracked.\n   * @return {boolean} The device location is being tracked.\n   * @observable\n   * @api\n   */\n  getTracking() {\n    return /** @type {boolean} */ (this.get(Property.TRACKING));\n  }\n\n  /**\n   * Get the tracking options.\n   * See http://www.w3.org/TR/geolocation-API/#position-options.\n   * @return {PositionOptions|undefined} PositionOptions as defined by\n   *     the [HTML5 Geolocation spec\n   *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n   * @observable\n   * @api\n   */\n  getTrackingOptions() {\n    return /** @type {PositionOptions|undefined} */ (this.get(Property.TRACKING_OPTIONS));\n  }\n\n  /**\n   * Set the projection to use for transforming the coordinates.\n   * @param {import(\"./proj.js\").ProjectionLike} projection The projection the position is\n   *     reported in.\n   * @observable\n   * @api\n   */\n  setProjection(projection) {\n    this.set(Property.PROJECTION, getProjection(projection));\n  }\n\n  /**\n   * Enable or disable tracking.\n   * @param {boolean} tracking Enable tracking.\n   * @observable\n   * @api\n   */\n  setTracking(tracking) {\n    this.set(Property.TRACKING, tracking);\n  }\n\n  /**\n   * Set the tracking options.\n   * See http://www.w3.org/TR/geolocation-API/#position-options.\n   * @param {PositionOptions} options PositionOptions as defined by the\n   *     [HTML5 Geolocation spec\n   *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n   * @observable\n   * @api\n   */\n  setTrackingOptions(options) {\n    this.set(Property.TRACKING_OPTIONS, options);\n  }\n}\n\n\nexport default Geolocation;\n","/**\n * @module ol/format/XML\n */\nimport {isDocument, parse} from '../xml.js';\n\n/**\n * @classdesc\n * Generic format for reading non-feature XML data\n *\n * @abstract\n */\nclass XML {\n  /**\n   * Read the source document.\n   *\n   * @param {Document|Element|string} source The XML source.\n   * @return {Object} An object representing the source.\n   * @api\n   */\n  read(source) {\n    if (!source) {\n      return null;\n    } else if (typeof source === 'string') {\n      const doc = parse(source);\n      return this.readFromDocument(doc);\n    } else if (isDocument(source)) {\n      return this.readFromDocument(/** @type {Document} */ (source));\n    } else {\n      return this.readFromNode(/** @type {Element} */ (source));\n    }\n  }\n\n  /**\n   * @abstract\n   * @param {Document} doc Document.\n   * @return {Object} Object\n   */\n  readFromDocument(doc) {}\n\n  /**\n   * @abstract\n   * @param {Element} node Node.\n   * @return {Object} Object\n   */\n  readFromNode(node) {}\n}\n\nexport default XML;\n","/**\n * @module ol/style/IconImageCache\n */\nimport {asString} from '../color.js';\n\n/**\n * @classdesc\n * Singleton class. Available through {@link module:ol/style/IconImageCache~shared}.\n */\nclass IconImageCache {\n  constructor() {\n\n    /**\n    * @type {!Object<string, import(\"./IconImage.js\").default>}\n    * @private\n    */\n    this.cache_ = {};\n\n    /**\n    * @type {number}\n    * @private\n    */\n    this.cacheSize_ = 0;\n\n    /**\n    * @type {number}\n    * @private\n    */\n    this.maxCacheSize_ = 32;\n  }\n\n  /**\n  * FIXME empty description for jsdoc\n  */\n  clear() {\n    this.cache_ = {};\n    this.cacheSize_ = 0;\n  }\n\n  /**\n   * @return {boolean} Can expire cache.\n   */\n  canExpireCache() {\n    return this.cacheSize_ > this.maxCacheSize_;\n  }\n\n  /**\n  * FIXME empty description for jsdoc\n  */\n  expire() {\n    if (this.canExpireCache()) {\n      let i = 0;\n      for (const key in this.cache_) {\n        const iconImage = this.cache_[key];\n        if ((i++ & 3) === 0 && !iconImage.hasListener()) {\n          delete this.cache_[key];\n          --this.cacheSize_;\n        }\n      }\n    }\n  }\n\n  /**\n  * @param {string} src Src.\n  * @param {?string} crossOrigin Cross origin.\n  * @param {import(\"../color.js\").Color} color Color.\n  * @return {import(\"./IconImage.js\").default} Icon image.\n  */\n  get(src, crossOrigin, color) {\n    const key = getKey(src, crossOrigin, color);\n    return key in this.cache_ ? this.cache_[key] : null;\n  }\n\n  /**\n  * @param {string} src Src.\n  * @param {?string} crossOrigin Cross origin.\n  * @param {import(\"../color.js\").Color} color Color.\n  * @param {import(\"./IconImage.js\").default} iconImage Icon image.\n  */\n  set(src, crossOrigin, color, iconImage) {\n    const key = getKey(src, crossOrigin, color);\n    this.cache_[key] = iconImage;\n    ++this.cacheSize_;\n  }\n\n  /**\n  * Set the cache size of the icon cache. Default is `32`. Change this value when\n  * your map uses more than 32 different icon images and you are not caching icon\n  * styles on the application level.\n  * @param {number} maxCacheSize Cache max size.\n  * @api\n  */\n  setSize(maxCacheSize) {\n    this.maxCacheSize_ = maxCacheSize;\n    this.expire();\n  }\n}\n\n\n/**\n * @param {string} src Src.\n * @param {?string} crossOrigin Cross origin.\n * @param {import(\"../color.js\").Color} color Color.\n * @return {string} Cache key.\n */\nfunction getKey(src, crossOrigin, color) {\n  const colorString = color ? asString(color) : 'null';\n  return crossOrigin + ':' + src + ':' + colorString;\n}\n\n\nexport default IconImageCache;\n\n\n/**\n * The {@link module:ol/style/IconImageCache~IconImageCache} for\n * {@link module:ol/style/Icon~Icon} images.\n * @api\n */\nexport const shared = new IconImageCache();\n","/**\n * @module ol/MapEvent\n */\nimport Event from './events/Event.js';\n\n/**\n * @classdesc\n * Events emitted as map events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map event.\n */\nclass MapEvent extends Event {\n\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./PluggableMap.js\").default} map Map.\n   * @param {?import(\"./PluggableMap.js\").FrameState=} opt_frameState Frame state.\n   */\n  constructor(type, map, opt_frameState) {\n\n    super(type);\n\n    /**\n     * The map where the event occurred.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @api\n     */\n    this.map = map;\n\n    /**\n     * The frame state at the time of the event.\n     * @type {?import(\"./PluggableMap.js\").FrameState}\n     * @api\n     */\n    this.frameState = opt_frameState !== undefined ? opt_frameState : null;\n\n  }\n\n}\n\nexport default MapEvent;\n","/**\n * @module ol/format/TopoJSON\n */\nimport Feature from '../Feature.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport JSONFeature from './JSONFeature.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {get as getProjection} from '../proj.js';\n\n/**\n * @typedef {import(\"topojson-specification\").Topology} TopoJSONTopology\n * @typedef {import(\"topojson-specification\").GeometryCollection} TopoJSONGeometryCollection\n * @typedef {import(\"topojson-specification\").GeometryObject} TopoJSONGeometry\n * @typedef {import(\"topojson-specification\").Point} TopoJSONPoint\n * @typedef {import(\"topojson-specification\").MultiPoint} TopoJSONMultiPoint\n * @typedef {import(\"topojson-specification\").LineString} TopoJSONLineString\n * @typedef {import(\"topojson-specification\").MultiLineString} TopoJSONMultiLineString\n * @typedef {import(\"topojson-specification\").Polygon} TopoJSONPolygon\n * @typedef {import(\"topojson-specification\").MultiPolygon} TopoJSONMultiPolygon\n */\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../proj.js\").ProjectionLike} [dataProjection='EPSG:4326'] Default data projection.\n * @property {string} [layerName] Set the name of the TopoJSON topology\n * `objects`'s children as feature property with the specified name. This means\n * that when set to `'layer'`, a topology like\n * ```\n * {\n *   \"type\": \"Topology\",\n *   \"objects\": {\n *     \"example\": {\n *       \"type\": \"GeometryCollection\",\n *       \"geometries\": []\n *     }\n *   }\n * }\n * ```\n * will result in features that have a property `'layer'` set to `'example'`.\n * When not set, no property will be added to features.\n * @property {Array<string>} [layers] Names of the TopoJSON topology's\n * `objects`'s children to read features from.  If not provided, features will\n * be read from all children.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading data in the TopoJSON format.\n *\n * @api\n */\nclass TopoJSON extends JSONFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @private\n     * @type {string|undefined}\n     */\n    this.layerName_ = options.layerName;\n\n    /**\n     * @private\n     * @type {?Array<string>}\n     */\n    this.layers_ = options.layers ? options.layers : null;\n\n    /**\n     * @inheritDoc\n     */\n    this.dataProjection = getProjection(\n      options.dataProjection ?\n        options.dataProjection : 'EPSG:4326');\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromObject(object, opt_options) {\n    if (object.type == 'Topology') {\n      const topoJSONTopology = /** @type {TopoJSONTopology} */ (object);\n      let transform, scale = null, translate = null;\n      if (topoJSONTopology['transform']) {\n        transform = topoJSONTopology['transform'];\n        scale = transform['scale'];\n        translate = transform['translate'];\n      }\n      const arcs = topoJSONTopology['arcs'];\n      if (transform) {\n        transformArcs(arcs, scale, translate);\n      }\n      /** @type {Array<Feature>} */\n      const features = [];\n      const topoJSONFeatures = topoJSONTopology['objects'];\n      const property = this.layerName_;\n      let feature;\n      for (const objectName in topoJSONFeatures) {\n        if (this.layers_ && this.layers_.indexOf(objectName) == -1) {\n          continue;\n        }\n        if (topoJSONFeatures[objectName].type === 'GeometryCollection') {\n          feature = /** @type {TopoJSONGeometryCollection} */ (topoJSONFeatures[objectName]);\n          features.push.apply(features, readFeaturesFromGeometryCollection(\n            feature, arcs, scale, translate, property, objectName, opt_options));\n        } else {\n          feature = /** @type {TopoJSONGeometry} */ (topoJSONFeatures[objectName]);\n          features.push(readFeatureFromGeometry(\n            feature, arcs, scale, translate, property, objectName, opt_options));\n        }\n      }\n      return features;\n    } else {\n      return [];\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readProjectionFromObject(object) {\n    return this.dataProjection;\n  }\n\n}\n\n\n/**\n * @const\n * @type {Object<string, function(TopoJSONGeometry, Array, ...Array=): import(\"../geom/Geometry.js\").default>}\n */\nconst GEOMETRY_READERS = {\n  'Point': readPointGeometry,\n  'LineString': readLineStringGeometry,\n  'Polygon': readPolygonGeometry,\n  'MultiPoint': readMultiPointGeometry,\n  'MultiLineString': readMultiLineStringGeometry,\n  'MultiPolygon': readMultiPolygonGeometry\n};\n\n\n/**\n * Concatenate arcs into a coordinate array.\n * @param {Array<number>} indices Indices of arcs to concatenate.  Negative\n *     values indicate arcs need to be reversed.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs (already\n *     transformed).\n * @return {Array<import(\"../coordinate.js\").Coordinate>} Coordinates array.\n */\nfunction concatenateArcs(indices, arcs) {\n  /** @type {Array<import(\"../coordinate.js\").Coordinate>} */\n  const coordinates = [];\n  let index, arc;\n  for (let i = 0, ii = indices.length; i < ii; ++i) {\n    index = indices[i];\n    if (i > 0) {\n      // splicing together arcs, discard last point\n      coordinates.pop();\n    }\n    if (index >= 0) {\n      // forward arc\n      arc = arcs[index];\n    } else {\n      // reverse arc\n      arc = arcs[~index].slice().reverse();\n    }\n    coordinates.push.apply(coordinates, arc);\n  }\n  // provide fresh copies of coordinate arrays\n  for (let j = 0, jj = coordinates.length; j < jj; ++j) {\n    coordinates[j] = coordinates[j].slice();\n  }\n  return coordinates;\n}\n\n\n/**\n * Create a point from a TopoJSON geometry object.\n *\n * @param {TopoJSONPoint} object TopoJSON object.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n * @return {Point} Geometry.\n */\nfunction readPointGeometry(object, scale, translate) {\n  const coordinates = object['coordinates'];\n  if (scale && translate) {\n    transformVertex(coordinates, scale, translate);\n  }\n  return new Point(coordinates);\n}\n\n\n/**\n * Create a multi-point from a TopoJSON geometry object.\n *\n * @param {TopoJSONMultiPoint} object TopoJSON object.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n * @return {MultiPoint} Geometry.\n */\nfunction readMultiPointGeometry(object, scale, translate) {\n  const coordinates = object['coordinates'];\n  if (scale && translate) {\n    for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n      transformVertex(coordinates[i], scale, translate);\n    }\n  }\n  return new MultiPoint(coordinates);\n}\n\n\n/**\n * Create a linestring from a TopoJSON geometry object.\n *\n * @param {TopoJSONLineString} object TopoJSON object.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @return {LineString} Geometry.\n */\nfunction readLineStringGeometry(object, arcs) {\n  const coordinates = concatenateArcs(object['arcs'], arcs);\n  return new LineString(coordinates);\n}\n\n\n/**\n * Create a multi-linestring from a TopoJSON geometry object.\n *\n * @param {TopoJSONMultiLineString} object TopoJSON object.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @return {MultiLineString} Geometry.\n */\nfunction readMultiLineStringGeometry(object, arcs) {\n  const coordinates = [];\n  for (let i = 0, ii = object['arcs'].length; i < ii; ++i) {\n    coordinates[i] = concatenateArcs(object['arcs'][i], arcs);\n  }\n  return new MultiLineString(coordinates);\n}\n\n\n/**\n * Create a polygon from a TopoJSON geometry object.\n *\n * @param {TopoJSONPolygon} object TopoJSON object.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @return {Polygon} Geometry.\n */\nfunction readPolygonGeometry(object, arcs) {\n  const coordinates = [];\n  for (let i = 0, ii = object['arcs'].length; i < ii; ++i) {\n    coordinates[i] = concatenateArcs(object['arcs'][i], arcs);\n  }\n  return new Polygon(coordinates);\n}\n\n\n/**\n * Create a multi-polygon from a TopoJSON geometry object.\n *\n * @param {TopoJSONMultiPolygon} object TopoJSON object.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @return {MultiPolygon} Geometry.\n */\nfunction readMultiPolygonGeometry(object, arcs) {\n  const coordinates = [];\n  for (let i = 0, ii = object['arcs'].length; i < ii; ++i) {\n    // for each polygon\n    const polyArray = object['arcs'][i];\n    const ringCoords = [];\n    for (let j = 0, jj = polyArray.length; j < jj; ++j) {\n      // for each ring\n      ringCoords[j] = concatenateArcs(polyArray[j], arcs);\n    }\n    coordinates[i] = ringCoords;\n  }\n  return new MultiPolygon(coordinates);\n}\n\n\n/**\n * Create features from a TopoJSON GeometryCollection object.\n *\n * @param {TopoJSONGeometryCollection} collection TopoJSON Geometry\n *     object.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n * @param {string|undefined} property Property to set the `GeometryCollection`'s parent\n *     object to.\n * @param {string} name Name of the `Topology`'s child object.\n * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n * @return {Array<Feature>} Array of features.\n */\nfunction readFeaturesFromGeometryCollection(collection, arcs, scale, translate, property, name, opt_options) {\n  const geometries = collection['geometries'];\n  const features = [];\n  for (let i = 0, ii = geometries.length; i < ii; ++i) {\n    features[i] = readFeatureFromGeometry(\n      geometries[i], arcs, scale, translate, property, name, opt_options);\n  }\n  return features;\n}\n\n\n/**\n * Create a feature from a TopoJSON geometry object.\n *\n * @param {TopoJSONGeometry} object TopoJSON geometry object.\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n * @param {string|undefined} property Property to set the `GeometryCollection`'s parent\n *     object to.\n * @param {string} name Name of the `Topology`'s child object.\n * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n * @return {Feature} Feature.\n */\nfunction readFeatureFromGeometry(object, arcs, scale, translate, property, name, opt_options) {\n  let geometry;\n  const type = object.type;\n  const geometryReader = GEOMETRY_READERS[type];\n  if ((type === 'Point') || (type === 'MultiPoint')) {\n    geometry = geometryReader(object, scale, translate);\n  } else {\n    geometry = geometryReader(object, arcs);\n  }\n  const feature = new Feature();\n  feature.setGeometry(transformGeometryWithOptions(geometry, false, opt_options));\n  if (object.id !== undefined) {\n    feature.setId(object.id);\n  }\n  let properties = object.properties;\n  if (property) {\n    if (!properties) {\n      properties = {};\n    }\n    properties[property] = name;\n  }\n  if (properties) {\n    feature.setProperties(properties, true);\n  }\n  return feature;\n}\n\n\n/**\n * Apply a linear transform to array of arcs.  The provided array of arcs is\n * modified in place.\n *\n * @param {Array<Array<import(\"../coordinate.js\").Coordinate>>} arcs Array of arcs.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n */\nfunction transformArcs(arcs, scale, translate) {\n  for (let i = 0, ii = arcs.length; i < ii; ++i) {\n    transformArc(arcs[i], scale, translate);\n  }\n}\n\n\n/**\n * Apply a linear transform to an arc.  The provided arc is modified in place.\n *\n * @param {Array<import(\"../coordinate.js\").Coordinate>} arc Arc.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n */\nfunction transformArc(arc, scale, translate) {\n  let x = 0;\n  let y = 0;\n  for (let i = 0, ii = arc.length; i < ii; ++i) {\n    const vertex = arc[i];\n    x += vertex[0];\n    y += vertex[1];\n    vertex[0] = x;\n    vertex[1] = y;\n    transformVertex(vertex, scale, translate);\n  }\n}\n\n\n/**\n * Apply a linear transform to a vertex.  The provided vertex is modified in\n * place.\n *\n * @param {import(\"../coordinate.js\").Coordinate} vertex Vertex.\n * @param {Array<number>} scale Scale for each dimension.\n * @param {Array<number>} translate Translation for each dimension.\n */\nfunction transformVertex(vertex, scale, translate) {\n  vertex[0] = vertex[0] * scale[0] + translate[0];\n  vertex[1] = vertex[1] * scale[1] + translate[1];\n}\n\n\nexport default TopoJSON;\n","/**\n * @module ol/interaction/Snap\n */\nimport {getUid} from '../util.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {distance as coordinateDistance, squaredDistance as squaredCoordinateDistance, closestOnCircle, closestOnSegment, squaredDistanceToSegment} from '../coordinate.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {boundingExtent, createEmpty} from '../extent.js';\nimport {TRUE, FALSE} from '../functions.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {fromCircle} from '../geom/Polygon.js';\nimport PointerInteraction from './Pointer.js';\nimport {getValues} from '../obj.js';\nimport VectorEventType from '../source/VectorEventType.js';\nimport RBush from '../structs/RBush.js';\nimport {fromUserCoordinate, toUserCoordinate} from '../proj.js';\n\n\n/**\n * @typedef {Object} Result\n * @property {boolean} snapped\n * @property {import(\"../coordinate.js\").Coordinate|null} vertex\n * @property {import(\"../pixel.js\").Pixel|null} vertexPixel\n */\n\n\n/**\n * @typedef {Object} SegmentData\n * @property {import(\"../Feature.js\").default} feature\n * @property {Array<import(\"../coordinate.js\").Coordinate>} segment\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../Collection.js\").default<import(\"../Feature.js\").default>} [features] Snap to these features. Either this option or source should be provided.\n * @property {boolean} [edge=true] Snap to edges.\n * @property {boolean} [vertex=true] Snap to vertices.\n * @property {number} [pixelTolerance=10] Pixel tolerance for considering the pointer close enough to a segment or\n * vertex for snapping.\n * @property {import(\"../source/Vector.js\").default} [source] Snap to features from this source. Either this option or features should be provided\n */\n\n\n/**\n * @param  {import(\"../source/Vector.js\").VectorSourceEvent|import(\"../Collection.js\").CollectionEvent} evt Event.\n * @return {import(\"../Feature.js\").default} Feature.\n */\nfunction getFeatureFromEvent(evt) {\n  if (/** @type {import(\"../source/Vector.js\").VectorSourceEvent} */ (evt).feature) {\n    return /** @type {import(\"../source/Vector.js\").VectorSourceEvent} */ (evt).feature;\n  } else if (/** @type {import(\"../Collection.js\").CollectionEvent} */ (evt).element) {\n    return /** @type {import(\"../Feature.js\").default} */ (/** @type {import(\"../Collection.js\").CollectionEvent} */ (evt).element);\n  }\n}\n\nconst tempSegment = [];\n\n/**\n * @classdesc\n * Handles snapping of vector features while modifying or drawing them.  The\n * features can come from a {@link module:ol/source/Vector} or {@link module:ol/Collection~Collection}\n * Any interaction object that allows the user to interact\n * with the features using the mouse can benefit from the snapping, as long\n * as it is added before.\n *\n * The snap interaction modifies map browser event `coordinate` and `pixel`\n * properties to force the snap to occur to any interaction that them.\n *\n * Example:\n *\n *     import Snap from 'ol/interaction/Snap';\n *\n *     const snap = new Snap({\n *       source: source\n *     });\n *\n *     map.addInteraction(snap);\n *\n * @api\n */\nclass Snap extends PointerInteraction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    const pointerOptions = /** @type {import(\"./Pointer.js\").Options} */ (options);\n\n    if (!pointerOptions.handleDownEvent) {\n      pointerOptions.handleDownEvent = TRUE;\n    }\n\n    if (!pointerOptions.stopDown) {\n      pointerOptions.stopDown = FALSE;\n    }\n\n    super(pointerOptions);\n\n    /**\n     * @type {import(\"../source/Vector.js\").default}\n     * @private\n     */\n    this.source_ = options.source ? options.source : null;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.vertex_ = options.vertex !== undefined ? options.vertex : true;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.edge_ = options.edge !== undefined ? options.edge : true;\n\n    /**\n     * @type {import(\"../Collection.js\").default<import(\"../Feature.js\").default>}\n     * @private\n     */\n    this.features_ = options.features ? options.features : null;\n\n    /**\n     * @type {Array<import(\"../events.js\").EventsKey>}\n     * @private\n     */\n    this.featuresListenerKeys_ = [];\n\n    /**\n     * @type {Object<string, import(\"../events.js\").EventsKey>}\n     * @private\n     */\n    this.featureChangeListenerKeys_ = {};\n\n    /**\n     * Extents are preserved so indexed segment can be quickly removed\n     * when its feature geometry changes\n     * @type {Object<string, import(\"../extent.js\").Extent>}\n     * @private\n     */\n    this.indexedFeaturesExtents_ = {};\n\n    /**\n     * If a feature geometry changes while a pointer drag|move event occurs, the\n     * feature doesn't get updated right away.  It will be at the next 'pointerup'\n     * event fired.\n     * @type {!Object<string, import(\"../Feature.js\").default>}\n     * @private\n     */\n    this.pendingFeatures_ = {};\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.pixelTolerance_ = options.pixelTolerance !== undefined ?\n      options.pixelTolerance : 10;\n\n    /**\n    * Segment RTree for each layer\n    * @type {import(\"../structs/RBush.js\").default<SegmentData>}\n    * @private\n    */\n    this.rBush_ = new RBush();\n\n    /**\n    * @const\n    * @private\n    * @type {Object<string, function(import(\"../Feature.js\").default, import(\"../geom/Geometry.js\").default): void>}\n    */\n    this.SEGMENT_WRITERS_ = {\n      'Point': this.writePointGeometry_.bind(this),\n      'LineString': this.writeLineStringGeometry_.bind(this),\n      'LinearRing': this.writeLineStringGeometry_.bind(this),\n      'Polygon': this.writePolygonGeometry_.bind(this),\n      'MultiPoint': this.writeMultiPointGeometry_.bind(this),\n      'MultiLineString': this.writeMultiLineStringGeometry_.bind(this),\n      'MultiPolygon': this.writeMultiPolygonGeometry_.bind(this),\n      'GeometryCollection': this.writeGeometryCollectionGeometry_.bind(this),\n      'Circle': this.writeCircleGeometry_.bind(this)\n    };\n  }\n\n  /**\n   * Add a feature to the collection of features that we may snap to.\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {boolean=} opt_listen Whether to listen to the feature change or not\n   *     Defaults to `true`.\n   * @api\n   */\n  addFeature(feature, opt_listen) {\n    const register = opt_listen !== undefined ? opt_listen : true;\n    const feature_uid = getUid(feature);\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      const segmentWriter = this.SEGMENT_WRITERS_[geometry.getType()];\n      if (segmentWriter) {\n        this.indexedFeaturesExtents_[feature_uid] = geometry.getExtent(createEmpty());\n        segmentWriter(feature, geometry);\n      }\n    }\n\n    if (register) {\n      this.featureChangeListenerKeys_[feature_uid] = listen(\n        feature,\n        EventType.CHANGE,\n        this.handleFeatureChange_, this);\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @private\n   */\n  forEachFeatureAdd_(feature) {\n    this.addFeature(feature);\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @private\n   */\n  forEachFeatureRemove_(feature) {\n    this.removeFeature(feature);\n  }\n\n  /**\n   * @return {import(\"../Collection.js\").default<import(\"../Feature.js\").default>|Array<import(\"../Feature.js\").default>} Features.\n   * @private\n   */\n  getFeatures_() {\n    let features;\n    if (this.features_) {\n      features = this.features_;\n    } else if (this.source_) {\n      features = this.source_.getFeatures();\n    }\n    return features;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleEvent(evt) {\n    const result = this.snapTo(evt.pixel, evt.coordinate, evt.map);\n    if (result.snapped) {\n      evt.coordinate = result.vertex.slice(0, 2);\n      evt.pixel = result.vertexPixel;\n    }\n    return super.handleEvent(evt);\n  }\n\n  /**\n   * @param {import(\"../source/Vector.js\").VectorSourceEvent|import(\"../Collection.js\").CollectionEvent} evt Event.\n   * @private\n   */\n  handleFeatureAdd_(evt) {\n    const feature = getFeatureFromEvent(evt);\n    this.addFeature(feature);\n  }\n\n  /**\n   * @param {import(\"../source/Vector.js\").VectorSourceEvent|import(\"../Collection.js\").CollectionEvent} evt Event.\n   * @private\n   */\n  handleFeatureRemove_(evt) {\n    const feature = getFeatureFromEvent(evt);\n    this.removeFeature(feature);\n  }\n\n  /**\n   * @param {import(\"../events/Event.js\").default} evt Event.\n   * @private\n   */\n  handleFeatureChange_(evt) {\n    const feature = /** @type {import(\"../Feature.js\").default} */ (evt.target);\n    if (this.handlingDownUpSequence) {\n      const uid = getUid(feature);\n      if (!(uid in this.pendingFeatures_)) {\n        this.pendingFeatures_[uid] = feature;\n      }\n    } else {\n      this.updateFeature_(feature);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(evt) {\n    const featuresToUpdate = getValues(this.pendingFeatures_);\n    if (featuresToUpdate.length) {\n      featuresToUpdate.forEach(this.updateFeature_.bind(this));\n      this.pendingFeatures_ = {};\n    }\n    return false;\n  }\n\n  /**\n   * Remove a feature from the collection of features that we may snap to.\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {boolean=} opt_unlisten Whether to unlisten to the feature change\n   *     or not. Defaults to `true`.\n   * @api\n   */\n  removeFeature(feature, opt_unlisten) {\n    const unregister = opt_unlisten !== undefined ? opt_unlisten : true;\n    const feature_uid = getUid(feature);\n    const extent = this.indexedFeaturesExtents_[feature_uid];\n    if (extent) {\n      const rBush = this.rBush_;\n      const nodesToRemove = [];\n      rBush.forEachInExtent(extent, function(node) {\n        if (feature === node.feature) {\n          nodesToRemove.push(node);\n        }\n      });\n      for (let i = nodesToRemove.length - 1; i >= 0; --i) {\n        rBush.remove(nodesToRemove[i]);\n      }\n    }\n\n    if (unregister) {\n      unlistenByKey(this.featureChangeListenerKeys_[feature_uid]);\n      delete this.featureChangeListenerKeys_[feature_uid];\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setMap(map) {\n    const currentMap = this.getMap();\n    const keys = this.featuresListenerKeys_;\n    const features = /** @type {Array<import(\"../Feature.js\").default>} */ (this.getFeatures_());\n\n    if (currentMap) {\n      keys.forEach(unlistenByKey);\n      keys.length = 0;\n      features.forEach(this.forEachFeatureRemove_.bind(this));\n    }\n    super.setMap(map);\n\n    if (map) {\n      if (this.features_) {\n        keys.push(\n          listen(this.features_, CollectionEventType.ADD,\n            this.handleFeatureAdd_, this),\n          listen(this.features_, CollectionEventType.REMOVE,\n            this.handleFeatureRemove_, this)\n        );\n      } else if (this.source_) {\n        keys.push(\n          listen(this.source_, VectorEventType.ADDFEATURE,\n            this.handleFeatureAdd_, this),\n          listen(this.source_, VectorEventType.REMOVEFEATURE,\n            this.handleFeatureRemove_, this)\n        );\n      }\n      features.forEach(this.forEachFeatureAdd_.bind(this));\n    }\n  }\n\n  /**\n   * @param {import(\"../pixel.js\").Pixel} pixel Pixel\n   * @param {import(\"../coordinate.js\").Coordinate} pixelCoordinate Coordinate\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   * @return {Result} Snap result\n   */\n  snapTo(pixel, pixelCoordinate, map) {\n    const lowerLeft = map.getCoordinateFromPixel(\n      [pixel[0] - this.pixelTolerance_, pixel[1] + this.pixelTolerance_]);\n    const upperRight = map.getCoordinateFromPixel(\n      [pixel[0] + this.pixelTolerance_, pixel[1] - this.pixelTolerance_]);\n    const box = boundingExtent([lowerLeft, upperRight]);\n\n    let segments = this.rBush_.getInExtent(box);\n\n    // If snapping on vertices only, don't consider circles\n    if (this.vertex_ && !this.edge_) {\n      segments = segments.filter(function(segment) {\n        return segment.feature.getGeometry().getType() !==\n            GeometryType.CIRCLE;\n      });\n    }\n\n    let snapped = false;\n    let vertex = null;\n    let vertexPixel = null;\n\n    if (segments.length === 0) {\n      return {\n        snapped: snapped,\n        vertex: vertex,\n        vertexPixel: vertexPixel\n      };\n    }\n\n    const projection = map.getView().getProjection();\n    const projectedCoordinate = fromUserCoordinate(pixelCoordinate, projection);\n\n    let closestSegmentData;\n    let minSquaredDistance = Infinity;\n    for (let i = 0; i < segments.length; ++i) {\n      const segmentData = segments[i];\n      tempSegment[0] = fromUserCoordinate(segmentData.segment[0], projection);\n      tempSegment[1] = fromUserCoordinate(segmentData.segment[1], projection);\n      const delta = squaredDistanceToSegment(projectedCoordinate, tempSegment);\n      if (delta < minSquaredDistance) {\n        closestSegmentData = segmentData;\n        minSquaredDistance = delta;\n      }\n    }\n    const closestSegment = closestSegmentData.segment;\n\n    if (this.vertex_ && !this.edge_) {\n      const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n      const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n      const squaredDist1 = squaredCoordinateDistance(pixel, pixel1);\n      const squaredDist2 = squaredCoordinateDistance(pixel, pixel2);\n      const dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n      if (dist <= this.pixelTolerance_) {\n        snapped = true;\n        vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n        vertexPixel = map.getPixelFromCoordinate(vertex);\n      }\n    } else if (this.edge_) {\n      const isCircle = closestSegmentData.feature.getGeometry().getType() === GeometryType.CIRCLE;\n      if (isCircle) {\n        vertex = closestOnCircle(pixelCoordinate,\n          /** @type {import(\"../geom/Circle.js\").default} */ (closestSegmentData.feature.getGeometry()));\n      } else {\n        tempSegment[0] = fromUserCoordinate(closestSegment[0], projection);\n        tempSegment[1] = fromUserCoordinate(closestSegment[1], projection);\n        vertex = toUserCoordinate(closestOnSegment(projectedCoordinate, tempSegment), projection);\n      }\n      vertexPixel = map.getPixelFromCoordinate(vertex);\n\n      if (coordinateDistance(pixel, vertexPixel) <= this.pixelTolerance_) {\n        snapped = true;\n        if (this.vertex_ && !isCircle) {\n          const pixel1 = map.getPixelFromCoordinate(closestSegment[0]);\n          const pixel2 = map.getPixelFromCoordinate(closestSegment[1]);\n          const squaredDist1 = squaredCoordinateDistance(vertexPixel, pixel1);\n          const squaredDist2 = squaredCoordinateDistance(vertexPixel, pixel2);\n          const dist = Math.sqrt(Math.min(squaredDist1, squaredDist2));\n          if (dist <= this.pixelTolerance_) {\n            vertex = squaredDist1 > squaredDist2 ? closestSegment[1] : closestSegment[0];\n            vertexPixel = map.getPixelFromCoordinate(vertex);\n          }\n        }\n      }\n    }\n\n    if (snapped) {\n      vertexPixel = [Math.round(vertexPixel[0]), Math.round(vertexPixel[1])];\n    }\n\n    return {\n      snapped: snapped,\n      vertex: vertex,\n      vertexPixel: vertexPixel\n    };\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @private\n   */\n  updateFeature_(feature) {\n    this.removeFeature(feature, false);\n    this.addFeature(feature, false);\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/Circle.js\").default} geometry Geometry.\n   * @private\n   */\n  writeCircleGeometry_(feature, geometry) {\n    const polygon = fromCircle(geometry);\n    const coordinates = polygon.getCoordinates()[0];\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = {\n        feature: feature,\n        segment: segment\n      };\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/GeometryCollection.js\").default} geometry Geometry.\n   * @private\n   */\n  writeGeometryCollectionGeometry_(feature, geometry) {\n    const geometries = geometry.getGeometriesArray();\n    for (let i = 0; i < geometries.length; ++i) {\n      const segmentWriter = this.SEGMENT_WRITERS_[geometries[i].getType()];\n      if (segmentWriter) {\n        segmentWriter(feature, geometries[i]);\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/LineString.js\").default} geometry Geometry.\n   * @private\n   */\n  writeLineStringGeometry_(feature, geometry) {\n    const coordinates = geometry.getCoordinates();\n    for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n      const segment = coordinates.slice(i, i + 2);\n      const segmentData = {\n        feature: feature,\n        segment: segment\n      };\n      this.rBush_.insert(boundingExtent(segment), segmentData);\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/MultiLineString.js\").default} geometry Geometry.\n   * @private\n   */\n  writeMultiLineStringGeometry_(feature, geometry) {\n    const lines = geometry.getCoordinates();\n    for (let j = 0, jj = lines.length; j < jj; ++j) {\n      const coordinates = lines[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = {\n          feature: feature,\n          segment: segment\n        };\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/MultiPoint.js\").default} geometry Geometry.\n   * @private\n   */\n  writeMultiPointGeometry_(feature, geometry) {\n    const points = geometry.getCoordinates();\n    for (let i = 0, ii = points.length; i < ii; ++i) {\n      const coordinates = points[i];\n      const segmentData = {\n        feature: feature,\n        segment: [coordinates, coordinates]\n      };\n      this.rBush_.insert(geometry.getExtent(), segmentData);\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n   * @private\n   */\n  writeMultiPolygonGeometry_(feature, geometry) {\n    const polygons = geometry.getCoordinates();\n    for (let k = 0, kk = polygons.length; k < kk; ++k) {\n      const rings = polygons[k];\n      for (let j = 0, jj = rings.length; j < jj; ++j) {\n        const coordinates = rings[j];\n        for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n          const segment = coordinates.slice(i, i + 2);\n          const segmentData = {\n            feature: feature,\n            segment: segment\n          };\n          this.rBush_.insert(boundingExtent(segment), segmentData);\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/Point.js\").default} geometry Geometry.\n   * @private\n   */\n  writePointGeometry_(feature, geometry) {\n    const coordinates = geometry.getCoordinates();\n    const segmentData = {\n      feature: feature,\n      segment: [coordinates, coordinates]\n    };\n    this.rBush_.insert(geometry.getExtent(), segmentData);\n  }\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature\n   * @param {import(\"../geom/Polygon.js\").default} geometry Geometry.\n   * @private\n   */\n  writePolygonGeometry_(feature, geometry) {\n    const rings = geometry.getCoordinates();\n    for (let j = 0, jj = rings.length; j < jj; ++j) {\n      const coordinates = rings[j];\n      for (let i = 0, ii = coordinates.length - 1; i < ii; ++i) {\n        const segment = coordinates.slice(i, i + 2);\n        const segmentData = {\n          feature: feature,\n          segment: segment\n        };\n        this.rBush_.insert(boundingExtent(segment), segmentData);\n      }\n    }\n  }\n}\n\n\nexport default Snap;\n","/**\n * @module ol/geom/flat/textpath\n */\nimport {lerp} from '../../math.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Path to put text on.\n * @param {number} offset Start offset of the `flatCoordinates`.\n * @param {number} end End offset of the `flatCoordinates`.\n * @param {number} stride Stride.\n * @param {string} text Text to place on the path.\n * @param {number} startM m along the path where the text starts.\n * @param {number} maxAngle Max angle between adjacent chars in radians.\n * @param {number} scale The product of the text scale and the device pixel ratio.\n * @param {function(string, string, Object<string, number>):number} measureAndCacheTextWidth Measure and cache text width.\n * @param {string} font The font.\n * @param {Object<string, number>} cache A cache of measured widths.\n * @return {Array<Array<*>>} The result array (or null if `maxAngle` was\n * exceeded). Entries of the array are x, y, anchorX, angle, chunk.\n */\nexport function drawTextOnPath(\n  flatCoordinates, offset, end, stride, text, startM, maxAngle, scale, measureAndCacheTextWidth, font, cache) {\n  const result = [];\n\n  // Keep text upright\n  const reverse = flatCoordinates[offset] > flatCoordinates[end - stride];\n\n  const numChars = text.length;\n\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  offset += stride;\n  let x2 = flatCoordinates[offset];\n  let y2 = flatCoordinates[offset + 1];\n  let segmentM = 0;\n  let segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n  let angleChanged = false;\n\n  let index, previousAngle;\n  for (let i = 0; i < numChars; ++i) {\n    index = reverse ? numChars - i - 1 : i;\n    const char = text[index];\n    const charLength = scale * measureAndCacheTextWidth(font, char, cache);\n    const charM = startM + charLength / 2;\n    while (offset < end - stride && segmentM + segmentLength < charM) {\n      x1 = x2;\n      y1 = y2;\n      offset += stride;\n      x2 = flatCoordinates[offset];\n      y2 = flatCoordinates[offset + 1];\n      segmentM += segmentLength;\n      segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\n    }\n    const segmentPos = charM - segmentM;\n    let angle = Math.atan2(y2 - y1, x2 - x1);\n    if (reverse) {\n      angle += angle > 0 ? -Math.PI : Math.PI;\n    }\n    if (previousAngle !== undefined) {\n      let delta = angle - previousAngle;\n      angleChanged = angleChanged || delta !== 0;\n      delta += (delta > Math.PI) ? -2 * Math.PI : (delta < -Math.PI) ? 2 * Math.PI : 0;\n      if (Math.abs(delta) > maxAngle) {\n        return null;\n      }\n    }\n    previousAngle = angle;\n    const interpolate = segmentPos / segmentLength;\n    const x = lerp(x1, x2, interpolate);\n    const y = lerp(y1, y2, interpolate);\n    result[index] = [x, y, charLength / 2, angle, char];\n    startM += charLength;\n  }\n  return angleChanged ? result : [[result[0][0], result[0][1], result[0][2], result[0][3], text]];\n}\n","/**\n * @module ol/render/canvas/Executor\n */\nimport {equals} from '../../array.js';\nimport {createEmpty, createOrUpdate,\n  createOrUpdateEmpty, extend, intersects} from '../../extent.js';\nimport {lineStringLength} from '../../geom/flat/length.js';\nimport {drawTextOnPath} from '../../geom/flat/textpath.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {drawImage, defaultPadding, defaultTextBaseline} from '../canvas.js';\nimport CanvasInstruction from './Instruction.js';\nimport {TEXT_ALIGN} from './TextBuilder.js';\nimport {\n  create as createTransform,\n  compose as composeTransform,\n  apply as applyTransform,\n  setFromArray as transformSetFromArray\n} from '../../transform.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {labelCache, defaultTextAlign, measureTextHeight, measureAndCacheTextWidth, measureTextWidths} from '../canvas.js';\nimport Disposable from '../../Disposable.js';\nimport RBush from 'rbush';\n\n\n/**\n * @typedef {Object} SerializableInstructions\n * @property {Array<*>} instructions The rendering instructions.\n * @property {Array<*>} hitDetectionInstructions The rendering hit detection instructions.\n * @property {Array<number>} coordinates The array of all coordinates.\n * @property {!Object<string, import(\"../canvas.js\").TextState>} textStates The text states (decluttering).\n * @property {!Object<string, import(\"../canvas.js\").FillState>} fillStates The fill states (decluttering).\n * @property {!Object<string, import(\"../canvas.js\").StrokeState>} strokeStates The stroke states (decluttering).\n */\n\n/**\n * @type {import(\"../../extent.js\").Extent}\n */\nconst tmpExtent = createEmpty();\n\n/**\n * @type {!import(\"../../transform.js\").Transform}\n */\nconst tmpTransform = createTransform();\n\n/** @type {import(\"../../coordinate.js\").Coordinate} */\nconst p1 = [];\n/** @type {import(\"../../coordinate.js\").Coordinate} */\nconst p2 = [];\n/** @type {import(\"../../coordinate.js\").Coordinate} */\nconst p3 = [];\n/** @type {import(\"../../coordinate.js\").Coordinate} */\nconst p4 = [];\n\n\nclass Executor extends Disposable {\n  /**\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {boolean} overlaps The replay can have overlapping geometries.\n   * @param {SerializableInstructions} instructions The serializable instructions\n   */\n  constructor(resolution, pixelRatio, overlaps, instructions) {\n    super();\n\n    /**\n     * @protected\n     * @type {boolean}\n     */\n    this.overlaps = overlaps;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.pixelRatio = pixelRatio;\n\n    /**\n     * @protected\n     * @const\n     * @type {number}\n     */\n    this.resolution = resolution;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.alignFill_;\n\n    /**\n     * @type {Array<*>}\n     */\n    this.declutterItems = [];\n\n    /**\n     * @protected\n     * @type {Array<*>}\n     */\n    this.instructions = instructions.instructions;\n\n    /**\n     * @protected\n     * @type {Array<number>}\n     */\n    this.coordinates = instructions.coordinates;\n\n    /**\n     * @private\n     * @type {!Object<number,import(\"../../coordinate.js\").Coordinate|Array<import(\"../../coordinate.js\").Coordinate>|Array<Array<import(\"../../coordinate.js\").Coordinate>>>}\n     */\n    this.coordinateCache_ = {};\n\n    /**\n     * @private\n     * @type {!import(\"../../transform.js\").Transform}\n     */\n    this.renderedTransform_ = createTransform();\n\n    /**\n     * @protected\n     * @type {Array<*>}\n     */\n    this.hitDetectionInstructions = instructions.hitDetectionInstructions;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.pixelCoordinates_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.viewRotation_ = 0;\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").FillState>}\n     */\n    this.fillStates = instructions.fillStates || {};\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").StrokeState>}\n     */\n    this.strokeStates = instructions.strokeStates || {};\n\n    /**\n     * @type {!Object<string, import(\"../canvas.js\").TextState>}\n     */\n    this.textStates = instructions.textStates || {};\n\n    /**\n     * @private\n     * @type {Object<string, Object<string, number>>}\n     */\n    this.widths_ = {};\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    labelCache.release(this);\n    super.disposeInternal();\n  }\n\n\n  /**\n   * @param {string} text Text.\n   * @param {string} textKey Text style key.\n   * @param {string} fillKey Fill style key.\n   * @param {string} strokeKey Stroke style key.\n   * @return {HTMLCanvasElement} Image.\n   */\n  getTextImage(text, textKey, fillKey, strokeKey) {\n    let label;\n    const key = strokeKey + textKey + text + fillKey + this.pixelRatio;\n\n    if (!labelCache.containsKey(key)) {\n      const strokeState = strokeKey ? this.strokeStates[strokeKey] : null;\n      const fillState = fillKey ? this.fillStates[fillKey] : null;\n      const textState = this.textStates[textKey];\n      const pixelRatio = this.pixelRatio;\n      const scale = textState.scale * pixelRatio;\n      const align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n      const strokeWidth = strokeKey && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n      const lines = text.split('\\n');\n      const numLines = lines.length;\n      const widths = [];\n      const width = measureTextWidths(textState.font, lines, widths);\n      const lineHeight = measureTextHeight(textState.font);\n      const height = lineHeight * numLines;\n      const renderWidth = width + strokeWidth;\n      const context = createCanvasContext2D(\n        // make canvas 2 pixels wider to account for italic text width measurement errors\n        Math.ceil((renderWidth + 2) * scale),\n        Math.ceil((height + strokeWidth) * scale));\n      label = context.canvas;\n      labelCache.set(key, label);\n      if (scale != 1) {\n        context.scale(scale, scale);\n      }\n      context.font = textState.font;\n      if (strokeKey) {\n        context.strokeStyle = strokeState.strokeStyle;\n        context.lineWidth = strokeWidth;\n        context.lineCap = strokeState.lineCap;\n        context.lineJoin = strokeState.lineJoin;\n        context.miterLimit = strokeState.miterLimit;\n        if (context.setLineDash && strokeState.lineDash.length) {\n          context.setLineDash(strokeState.lineDash);\n          context.lineDashOffset = strokeState.lineDashOffset;\n        }\n      }\n      if (fillKey) {\n        context.fillStyle = fillState.fillStyle;\n      }\n      context.textBaseline = 'middle';\n      context.textAlign = 'center';\n      const leftRight = (0.5 - align);\n      const x = align * renderWidth + leftRight * strokeWidth;\n      let i;\n      if (strokeKey) {\n        for (i = 0; i < numLines; ++i) {\n          context.strokeText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n        }\n      }\n      if (fillKey) {\n        for (i = 0; i < numLines; ++i) {\n          context.fillText(lines[i], x + leftRight * widths[i], 0.5 * (strokeWidth + lineHeight) + i * lineHeight);\n        }\n      }\n    }\n    return labelCache.get(key, this);\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../coordinate.js\").Coordinate} p1 1st point of the background box.\n   * @param {import(\"../../coordinate.js\").Coordinate} p2 2nd point of the background box.\n   * @param {import(\"../../coordinate.js\").Coordinate} p3 3rd point of the background box.\n   * @param {import(\"../../coordinate.js\").Coordinate} p4 4th point of the background box.\n   * @param {Array<*>} fillInstruction Fill instruction.\n   * @param {Array<*>} strokeInstruction Stroke instruction.\n   */\n  replayTextBackground_(context, p1, p2, p3, p4, fillInstruction, strokeInstruction) {\n    context.beginPath();\n    context.moveTo.apply(context, p1);\n    context.lineTo.apply(context, p2);\n    context.lineTo.apply(context, p3);\n    context.lineTo.apply(context, p4);\n    context.lineTo.apply(context, p1);\n    if (fillInstruction) {\n      this.alignFill_ = /** @type {boolean} */ (fillInstruction[2]);\n      this.fill_(context);\n    }\n    if (strokeInstruction) {\n      this.setStrokeStyle_(context, /** @type {Array<*>} */ (strokeInstruction));\n      context.stroke();\n    }\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @param {HTMLImageElement|HTMLCanvasElement|HTMLVideoElement} image Image.\n   * @param {number} anchorX Anchor X.\n   * @param {number} anchorY Anchor Y.\n   * @param {import(\"../canvas.js\").DeclutterGroup} declutterGroup Declutter group.\n   * @param {number} height Height.\n   * @param {number} opacity Opacity.\n   * @param {number} originX Origin X.\n   * @param {number} originY Origin Y.\n   * @param {number} rotation Rotation.\n   * @param {number} scale Scale.\n   * @param {boolean} snapToPixel Snap to pixel.\n   * @param {number} width Width.\n   * @param {Array<number>} padding Padding.\n   * @param {Array<*>} fillInstruction Fill instruction.\n   * @param {Array<*>} strokeInstruction Stroke instruction.\n   */\n  replayImage_(\n    context,\n    x,\n    y,\n    image,\n    anchorX,\n    anchorY,\n    declutterGroup,\n    height,\n    opacity,\n    originX,\n    originY,\n    rotation,\n    scale,\n    snapToPixel,\n    width,\n    padding,\n    fillInstruction,\n    strokeInstruction\n  ) {\n    const fillStroke = fillInstruction || strokeInstruction;\n    anchorX *= scale;\n    anchorY *= scale;\n    x -= anchorX;\n    y -= anchorY;\n\n    const w = (width + originX > image.width) ? image.width - originX : width;\n    const h = (height + originY > image.height) ? image.height - originY : height;\n    const boxW = padding[3] + w * scale + padding[1];\n    const boxH = padding[0] + h * scale + padding[2];\n    const boxX = x - padding[3];\n    const boxY = y - padding[0];\n\n    if (fillStroke || rotation !== 0) {\n      p1[0] = p4[0] = boxX;\n      p1[1] = p2[1] = boxY;\n      p2[0] = p3[0] = boxX + boxW;\n      p3[1] = p4[1] = boxY + boxH;\n    }\n\n    let transform = null;\n    if (rotation !== 0) {\n      const centerX = x + anchorX;\n      const centerY = y + anchorY;\n      transform = composeTransform(tmpTransform, centerX, centerY, 1, 1, rotation, -centerX, -centerY);\n\n      applyTransform(tmpTransform, p1);\n      applyTransform(tmpTransform, p2);\n      applyTransform(tmpTransform, p3);\n      applyTransform(tmpTransform, p4);\n      createOrUpdate(\n        Math.min(p1[0], p2[0], p3[0], p4[0]),\n        Math.min(p1[1], p2[1], p3[1], p4[1]),\n        Math.max(p1[0], p2[0], p3[0], p4[0]),\n        Math.max(p1[1], p2[1], p3[1], p4[1]),\n        tmpExtent\n      );\n    } else {\n      createOrUpdate(boxX, boxY, boxX + boxW, boxY + boxH, tmpExtent);\n    }\n    const canvas = context.canvas;\n    const strokePadding = strokeInstruction ? (strokeInstruction[2] * scale / 2) : 0;\n    const intersects =\n        tmpExtent[0] - strokePadding <= canvas.width && tmpExtent[2] + strokePadding >= 0 &&\n        tmpExtent[1] - strokePadding <= canvas.height && tmpExtent[3] + strokePadding >= 0;\n\n    if (snapToPixel) {\n      x = Math.round(x);\n      y = Math.round(y);\n    }\n\n    if (declutterGroup) {\n      if (!intersects && declutterGroup[4] == 1) {\n        return;\n      }\n      extend(declutterGroup, tmpExtent);\n      const declutterArgs = intersects ?\n        [context, transform ? transform.slice(0) : null, opacity, image, originX, originY, w, h, x, y, scale] :\n        null;\n      if (declutterArgs) {\n        if (fillStroke) {\n          declutterArgs.push(fillInstruction, strokeInstruction, p1, p2, p3, p4);\n        }\n        declutterGroup.push(declutterArgs);\n      }\n    } else if (intersects) {\n      if (fillStroke) {\n        this.replayTextBackground_(context, p1, p2, p3, p4,\n          /** @type {Array<*>} */ (fillInstruction),\n          /** @type {Array<*>} */ (strokeInstruction));\n      }\n      drawImage(context, transform, opacity, image, originX, originY, w, h, x, y, scale);\n    }\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} context Context.\n   */\n  fill_(context) {\n    if (this.alignFill_) {\n      const origin = applyTransform(this.renderedTransform_, [0, 0]);\n      const repeatSize = 512 * this.pixelRatio;\n      context.save();\n      context.translate(origin[0] % repeatSize, origin[1] % repeatSize);\n      context.rotate(this.viewRotation_);\n    }\n    context.fill();\n    if (this.alignFill_) {\n      context.restore();\n    }\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {Array<*>} instruction Instruction.\n   */\n  setStrokeStyle_(context, instruction) {\n    context.strokeStyle = /** @type {import(\"../../colorlike.js\").ColorLike} */ (instruction[1]);\n    context.lineWidth = /** @type {number} */ (instruction[2]);\n    context.lineCap = /** @type {CanvasLineCap} */ (instruction[3]);\n    context.lineJoin = /** @type {CanvasLineJoin} */ (instruction[4]);\n    context.miterLimit = /** @type {number} */ (instruction[5]);\n    if (context.setLineDash) {\n      context.lineDashOffset = /** @type {number} */ (instruction[7]);\n      context.setLineDash(/** @type {Array<number>} */ (instruction[6]));\n    }\n  }\n\n  /**\n   * @param {import(\"../canvas.js\").DeclutterGroup} declutterGroup Declutter group.\n   * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n   * @param {number} opacity Layer opacity.\n   * @param {?} declutterTree Declutter tree.\n   * @return {?} Declutter tree.\n   */\n  renderDeclutter(declutterGroup, feature, opacity, declutterTree) {\n    if (declutterGroup && declutterGroup.length > 5) {\n      const groupCount = declutterGroup[4];\n      if (groupCount == 1 || groupCount == declutterGroup.length - 5) {\n        /** @type {import(\"../../structs/RBush.js\").Entry} */\n        const box = {\n          minX: /** @type {number} */ (declutterGroup[0]),\n          minY: /** @type {number} */ (declutterGroup[1]),\n          maxX: /** @type {number} */ (declutterGroup[2]),\n          maxY: /** @type {number} */ (declutterGroup[3]),\n          value: feature\n        };\n        if (!declutterTree) {\n          declutterTree = new RBush(9);\n        }\n        if (!declutterTree.collides(box)) {\n          declutterTree.insert(box);\n          for (let j = 5, jj = declutterGroup.length; j < jj; ++j) {\n            const declutterData = /** @type {Array} */ (declutterGroup[j]);\n            const context = declutterData[0];\n            const currentAlpha = context.globalAlpha;\n            if (currentAlpha !== opacity) {\n              context.globalAlpha = opacity;\n            }\n            if (declutterData.length > 11) {\n              this.replayTextBackground_(declutterData[0],\n                declutterData[13], declutterData[14], declutterData[15], declutterData[16],\n                declutterData[11], declutterData[12]);\n            }\n            drawImage.apply(undefined, declutterData);\n            if (currentAlpha !== opacity) {\n              context.globalAlpha = currentAlpha;\n            }\n          }\n        }\n        declutterGroup.length = 5;\n        createOrUpdateEmpty(declutterGroup);\n      }\n    }\n    return declutterTree;\n  }\n\n  /**\n   * @private\n   * @param {string} text The text to draw.\n   * @param {string} textKey The key of the text state.\n   * @param {string} strokeKey The key for the stroke state.\n   * @param {string} fillKey The key for the fill state.\n   * @return {{label: HTMLCanvasElement, anchorX: number, anchorY: number}} The text image and its anchor.\n   */\n  drawTextImageWithPointPlacement_(text, textKey, strokeKey, fillKey) {\n    const textState = this.textStates[textKey];\n\n    const label = this.getTextImage(text, textKey, fillKey, strokeKey);\n\n    const strokeState = this.strokeStates[strokeKey];\n    const pixelRatio = this.pixelRatio;\n    const align = TEXT_ALIGN[textState.textAlign || defaultTextAlign];\n    const baseline = TEXT_ALIGN[textState.textBaseline || defaultTextBaseline];\n    const strokeWidth = strokeState && strokeState.lineWidth ? strokeState.lineWidth : 0;\n\n    // Remove the 2 pixels we added in getTextImage() for the anchor\n    const width = label.width / pixelRatio - 2 * textState.scale;\n    const anchorX = align * width + 2 * (0.5 - align) * strokeWidth;\n    const anchorY = baseline * label.height / pixelRatio + 2 * (0.5 - baseline) * strokeWidth;\n\n    return {\n      label: label,\n      anchorX: anchorX,\n      anchorY: anchorY\n    };\n  }\n\n  /**\n   * @private\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {Array<*>} instructions Instructions array.\n   * @param {boolean} snapToPixel Snap point symbols and text to integer pixels.\n   * @param {function(import(\"../../Feature.js\").FeatureLike): T|undefined} featureCallback Feature callback.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Only check features that intersect this\n   *     extent.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  execute_(\n    context,\n    transform,\n    instructions,\n    snapToPixel,\n    featureCallback,\n    opt_hitExtent\n  ) {\n    this.declutterItems.length = 0;\n    /** @type {Array<number>} */\n    let pixelCoordinates;\n    if (this.pixelCoordinates_ && equals(transform, this.renderedTransform_)) {\n      pixelCoordinates = this.pixelCoordinates_;\n    } else {\n      if (!this.pixelCoordinates_) {\n        this.pixelCoordinates_ = [];\n      }\n      pixelCoordinates = transform2D(\n        this.coordinates, 0, this.coordinates.length, 2,\n        transform, this.pixelCoordinates_);\n      transformSetFromArray(this.renderedTransform_, transform);\n    }\n    let i = 0; // instruction index\n    const ii = instructions.length; // end of instructions\n    let d = 0; // data index\n    let dd; // end of per-instruction data\n    let anchorX, anchorY, prevX, prevY, roundX, roundY, declutterGroup, declutterGroups, image, text, textKey;\n    let strokeKey, fillKey;\n    let pendingFill = 0;\n    let pendingStroke = 0;\n    let lastFillInstruction = null;\n    let lastStrokeInstruction = null;\n    const coordinateCache = this.coordinateCache_;\n    const viewRotation = this.viewRotation_;\n\n    const state = /** @type {import(\"../../render.js\").State} */ ({\n      context: context,\n      pixelRatio: this.pixelRatio,\n      resolution: this.resolution,\n      rotation: viewRotation\n    });\n\n    // When the batch size gets too big, performance decreases. 200 is a good\n    // balance between batch size and number of fill/stroke instructions.\n    const batchSize = this.instructions != instructions || this.overlaps ? 0 : 200;\n    let /** @type {import(\"../../Feature.js\").FeatureLike} */ feature;\n    let x, y;\n    while (i < ii) {\n      const instruction = instructions[i];\n      const type = /** @type {CanvasInstruction} */ (instruction[0]);\n      switch (type) {\n        case CanvasInstruction.BEGIN_GEOMETRY:\n          feature = /** @type {import(\"../../Feature.js\").FeatureLike} */ (instruction[1]);\n          if (!feature.getGeometry()) {\n            i = /** @type {number} */ (instruction[2]);\n          } else if (opt_hitExtent !== undefined && !intersects(opt_hitExtent, instruction[3])) {\n            i = /** @type {number} */ (instruction[2]) + 1;\n          } else {\n            ++i;\n          }\n          break;\n        case CanvasInstruction.BEGIN_PATH:\n          if (pendingFill > batchSize) {\n            this.fill_(context);\n            pendingFill = 0;\n          }\n          if (pendingStroke > batchSize) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n          if (!pendingFill && !pendingStroke) {\n            context.beginPath();\n            prevX = prevY = NaN;\n          }\n          ++i;\n          break;\n        case CanvasInstruction.CIRCLE:\n          d = /** @type {number} */ (instruction[1]);\n          const x1 = pixelCoordinates[d];\n          const y1 = pixelCoordinates[d + 1];\n          const x2 = pixelCoordinates[d + 2];\n          const y2 = pixelCoordinates[d + 3];\n          const dx = x2 - x1;\n          const dy = y2 - y1;\n          const r = Math.sqrt(dx * dx + dy * dy);\n          context.moveTo(x1 + r, y1);\n          context.arc(x1, y1, r, 0, 2 * Math.PI, true);\n          ++i;\n          break;\n        case CanvasInstruction.CLOSE_PATH:\n          context.closePath();\n          ++i;\n          break;\n        case CanvasInstruction.CUSTOM:\n          d = /** @type {number} */ (instruction[1]);\n          dd = instruction[2];\n          const geometry = /** @type {import(\"../../geom/SimpleGeometry.js\").default} */ (instruction[3]);\n          const renderer = instruction[4];\n          const fn = instruction.length == 6 ? instruction[5] : undefined;\n          state.geometry = geometry;\n          state.feature = feature;\n          if (!(i in coordinateCache)) {\n            coordinateCache[i] = [];\n          }\n          const coords = coordinateCache[i];\n          if (fn) {\n            fn(pixelCoordinates, d, dd, 2, coords);\n          } else {\n            coords[0] = pixelCoordinates[d];\n            coords[1] = pixelCoordinates[d + 1];\n            coords.length = 2;\n          }\n          renderer(coords, state);\n          ++i;\n          break;\n        case CanvasInstruction.DRAW_IMAGE:\n          d = /** @type {number} */ (instruction[1]);\n          dd = /** @type {number} */ (instruction[2]);\n          image = /** @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement} */ (instruction[3]);\n\n          // Remaining arguments in DRAW_IMAGE are in alphabetical order\n          anchorX = /** @type {number} */ (instruction[4]);\n          anchorY = /** @type {number} */ (instruction[5]);\n          declutterGroups = featureCallback ? null : instruction[6];\n          let height = /** @type {number} */ (instruction[7]);\n          const opacity = /** @type {number} */ (instruction[8]);\n          const originX = /** @type {number} */ (instruction[9]);\n          const originY = /** @type {number} */ (instruction[10]);\n          const rotateWithView = /** @type {boolean} */ (instruction[11]);\n          let rotation = /** @type {number} */ (instruction[12]);\n          const scale = /** @type {number} */ (instruction[13]);\n          let width = /** @type {number} */ (instruction[14]);\n\n          if (!image && instruction.length >= 19) {\n            // create label images\n            text = /** @type {string} */ (instruction[18]);\n            textKey = /** @type {string} */ (instruction[19]);\n            strokeKey = /** @type {string} */ (instruction[20]);\n            fillKey = /** @type {string} */ (instruction[21]);\n            const labelWithAnchor = this.drawTextImageWithPointPlacement_(text, textKey, strokeKey, fillKey);\n            image = instruction[3] = labelWithAnchor.label;\n            const textOffsetX = /** @type {number} */ (instruction[22]);\n            anchorX = instruction[4] = (labelWithAnchor.anchorX - textOffsetX) * this.pixelRatio;\n            const textOffsetY = /** @type {number} */ (instruction[23]);\n            anchorY = instruction[5] = (labelWithAnchor.anchorY - textOffsetY) * this.pixelRatio;\n            height = instruction[7] = image.height;\n            width = instruction[14] = image.width;\n          }\n\n          let geometryWidths;\n          if (instruction.length > 24) {\n            geometryWidths = /** @type {number} */ (instruction[24]);\n          }\n\n          let padding, backgroundFill, backgroundStroke;\n          if (instruction.length > 16) {\n            padding = /** @type {Array<number>} */ (instruction[15]);\n            backgroundFill = /** @type {boolean} */ (instruction[16]);\n            backgroundStroke = /** @type {boolean} */ (instruction[17]);\n          } else {\n            padding = defaultPadding;\n            backgroundFill = backgroundStroke = false;\n          }\n\n          if (rotateWithView) {\n            rotation += viewRotation;\n          }\n          let widthIndex = 0;\n          let declutterGroupIndex = 0;\n          for (; d < dd; d += 2) {\n            if (geometryWidths && geometryWidths[widthIndex++] < width / this.pixelRatio) {\n              continue;\n            }\n            if (declutterGroups) {\n              const index = Math.floor(declutterGroupIndex);\n              if (declutterGroups.length < index + 1) {\n                declutterGroup = createEmpty();\n                declutterGroup.push(declutterGroups[0][4]);\n                declutterGroups.push(declutterGroup);\n              }\n              declutterGroup = declutterGroups[index];\n            }\n            this.replayImage_(context,\n              pixelCoordinates[d], pixelCoordinates[d + 1], image, anchorX, anchorY,\n              declutterGroup, height, opacity, originX, originY, rotation, scale,\n              snapToPixel, width, padding,\n              backgroundFill ? /** @type {Array<*>} */ (lastFillInstruction) : null,\n              backgroundStroke ? /** @type {Array<*>} */ (lastStrokeInstruction) : null);\n            if (declutterGroup) {\n              if (declutterGroupIndex === Math.floor(declutterGroupIndex)) {\n                this.declutterItems.push(this, declutterGroup, feature);\n              }\n              declutterGroupIndex += 1 / declutterGroup[4];\n\n            }\n          }\n          ++i;\n          break;\n        case CanvasInstruction.DRAW_CHARS:\n          const begin = /** @type {number} */ (instruction[1]);\n          const end = /** @type {number} */ (instruction[2]);\n          const baseline = /** @type {number} */ (instruction[3]);\n          declutterGroup = featureCallback ? null : instruction[4];\n          const overflow = /** @type {number} */ (instruction[5]);\n          fillKey = /** @type {string} */ (instruction[6]);\n          const maxAngle = /** @type {number} */ (instruction[7]);\n          const measurePixelRatio = /** @type {number} */ (instruction[8]);\n          const offsetY = /** @type {number} */ (instruction[9]);\n          strokeKey = /** @type {string} */ (instruction[10]);\n          const strokeWidth = /** @type {number} */ (instruction[11]);\n          text = /** @type {string} */ (instruction[12]);\n          textKey = /** @type {string} */ (instruction[13]);\n          const pixelRatioScale = /** @type {number} */ (instruction[14]);\n\n          const textState = this.textStates[textKey];\n          const font = textState.font;\n          const textScale = textState.scale * measurePixelRatio;\n\n          let cachedWidths;\n          if (font in this.widths_) {\n            cachedWidths = this.widths_[font];\n          } else {\n            cachedWidths = this.widths_[font] = {};\n          }\n\n          const pathLength = lineStringLength(pixelCoordinates, begin, end, 2);\n          const textLength = textScale * measureAndCacheTextWidth(font, text, cachedWidths);\n          if (overflow || textLength <= pathLength) {\n            const textAlign = this.textStates[textKey].textAlign;\n            const startM = (pathLength - textLength) * TEXT_ALIGN[textAlign];\n            const parts = drawTextOnPath(\n              pixelCoordinates, begin, end, 2, text, startM, maxAngle, textScale, measureAndCacheTextWidth, font, cachedWidths);\n            if (parts) {\n              let c, cc, chars, label, part;\n              if (strokeKey) {\n                for (c = 0, cc = parts.length; c < cc; ++c) {\n                  part = parts[c]; // x, y, anchorX, rotation, chunk\n                  chars = /** @type {string} */ (part[4]);\n                  label = this.getTextImage(chars, textKey, '', strokeKey);\n                  anchorX = /** @type {number} */ (part[2]) + strokeWidth;\n                  anchorY = baseline * label.height + (0.5 - baseline) * 2 * strokeWidth - offsetY;\n                  this.replayImage_(context,\n                    /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                    anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                    /** @type {number} */ (part[3]), pixelRatioScale, false, label.width,\n                    defaultPadding, null, null);\n                }\n              }\n              if (fillKey) {\n                for (c = 0, cc = parts.length; c < cc; ++c) {\n                  part = parts[c]; // x, y, anchorX, rotation, chunk\n                  chars = /** @type {string} */ (part[4]);\n                  label = this.getTextImage(chars, textKey, fillKey, '');\n                  anchorX = /** @type {number} */ (part[2]);\n                  anchorY = baseline * label.height - offsetY;\n                  this.replayImage_(context,\n                    /** @type {number} */ (part[0]), /** @type {number} */ (part[1]), label,\n                    anchorX, anchorY, declutterGroup, label.height, 1, 0, 0,\n                    /** @type {number} */ (part[3]), pixelRatioScale, false, label.width,\n                    defaultPadding, null, null);\n                }\n              }\n            }\n          }\n          this.declutterItems.push(this, declutterGroup, feature);\n          ++i;\n          break;\n        case CanvasInstruction.END_GEOMETRY:\n          if (featureCallback !== undefined) {\n            feature = /** @type {import(\"../../Feature.js\").FeatureLike} */ (instruction[1]);\n            const result = featureCallback(feature);\n            if (result) {\n              return result;\n            }\n          }\n          ++i;\n          break;\n        case CanvasInstruction.FILL:\n          if (batchSize) {\n            pendingFill++;\n          } else {\n            this.fill_(context);\n          }\n          ++i;\n          break;\n        case CanvasInstruction.MOVE_TO_LINE_TO:\n          d = /** @type {number} */ (instruction[1]);\n          dd = /** @type {number} */ (instruction[2]);\n          x = pixelCoordinates[d];\n          y = pixelCoordinates[d + 1];\n          roundX = (x + 0.5) | 0;\n          roundY = (y + 0.5) | 0;\n          if (roundX !== prevX || roundY !== prevY) {\n            context.moveTo(x, y);\n            prevX = roundX;\n            prevY = roundY;\n          }\n          for (d += 2; d < dd; d += 2) {\n            x = pixelCoordinates[d];\n            y = pixelCoordinates[d + 1];\n            roundX = (x + 0.5) | 0;\n            roundY = (y + 0.5) | 0;\n            if (d == dd - 2 || roundX !== prevX || roundY !== prevY) {\n              context.lineTo(x, y);\n              prevX = roundX;\n              prevY = roundY;\n            }\n          }\n          ++i;\n          break;\n        case CanvasInstruction.SET_FILL_STYLE:\n          lastFillInstruction = instruction;\n          this.alignFill_ = instruction[2];\n\n          if (pendingFill) {\n            this.fill_(context);\n            pendingFill = 0;\n            if (pendingStroke) {\n              context.stroke();\n              pendingStroke = 0;\n            }\n          }\n\n          context.fillStyle = /** @type {import(\"../../colorlike.js\").ColorLike} */ (instruction[1]);\n          ++i;\n          break;\n        case CanvasInstruction.SET_STROKE_STYLE:\n          lastStrokeInstruction = instruction;\n          if (pendingStroke) {\n            context.stroke();\n            pendingStroke = 0;\n          }\n          this.setStrokeStyle_(context, /** @type {Array<*>} */ (instruction));\n          ++i;\n          break;\n        case CanvasInstruction.STROKE:\n          if (batchSize) {\n            pendingStroke++;\n          } else {\n            context.stroke();\n          }\n          ++i;\n          break;\n        default:\n          ++i; // consume the instruction anyway, to avoid an infinite loop\n          break;\n      }\n    }\n    if (pendingFill) {\n      this.fill_(context);\n    }\n    if (pendingStroke) {\n      context.stroke();\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {boolean} snapToPixel Snap point symbols and text to integer pixels.\n   */\n  execute(context, transform, viewRotation, snapToPixel) {\n    this.viewRotation_ = viewRotation;\n    this.execute_(context, transform, this.instructions, snapToPixel, undefined, undefined);\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {function(import(\"../../Feature.js\").FeatureLike): T=} opt_featureCallback\n   *     Feature callback.\n   * @param {import(\"../../extent.js\").Extent=} opt_hitExtent Only check features that intersect this\n   *     extent.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  executeHitDetection(\n    context,\n    transform,\n    viewRotation,\n    opt_featureCallback,\n    opt_hitExtent\n  ) {\n    this.viewRotation_ = viewRotation;\n    return this.execute_(context, transform,\n      this.hitDetectionInstructions, true, opt_featureCallback, opt_hitExtent);\n  }\n}\n\n\nexport default Executor;\n","/**\n * @module ol/render/canvas/ExecutorGroup\n */\n\nimport {numberSafeCompareFunction} from '../../array.js';\nimport {createCanvasContext2D} from '../../dom.js';\nimport {buffer, createEmpty, extendCoordinate} from '../../extent.js';\nimport {transform2D} from '../../geom/flat/transform.js';\nimport {isEmpty} from '../../obj.js';\nimport BuilderType from './BuilderType.js';\nimport {create as createTransform, compose as composeTransform} from '../../transform.js';\nimport Executor from './Executor.js';\nimport Disposable from '../../Disposable.js';\n\n/**\n * @const\n * @type {Array<BuilderType>}\n */\nconst ORDER = [\n  BuilderType.POLYGON,\n  BuilderType.CIRCLE,\n  BuilderType.LINE_STRING,\n  BuilderType.IMAGE,\n  BuilderType.TEXT,\n  BuilderType.DEFAULT\n];\n\n\nclass ExecutorGroup extends Disposable {\n  /**\n   * @param {import(\"../../extent.js\").Extent} maxExtent Max extent for clipping. When a\n   * `maxExtent` was set on the Buillder for this executor group, the same `maxExtent`\n   * should be set here, unless the target context does not exceet that extent (which\n   * can be the case when rendering to tiles).\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {boolean} overlaps The executor group can have overlapping geometries.\n   * @param {!Object<string, !Object<BuilderType, import(\"./Builder.js\").SerializableInstructions>>} allInstructions\n   * The serializable instructions.\n   * @param {number=} opt_renderBuffer Optional rendering buffer.\n   */\n  constructor(maxExtent, resolution, pixelRatio, overlaps, allInstructions, opt_renderBuffer) {\n    super();\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.maxExtent_ = maxExtent;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.overlaps_ = overlaps;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.resolution_ = resolution;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.renderBuffer_ = opt_renderBuffer;\n\n    /**\n     * @private\n     * @type {!Object<string, !Object<BuilderType, import(\"./Executor\").default>>}\n     */\n    this.executorsByZIndex_ = {};\n\n    /**\n     * @private\n     * @type {CanvasRenderingContext2D}\n     */\n    this.hitDetectionContext_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../transform.js\").Transform}\n     */\n    this.hitDetectionTransform_ = createTransform();\n\n    this.createExecutors_(allInstructions);\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   */\n  clip(context, transform) {\n    const flatClipCoords = this.getClipCoords(transform);\n    context.beginPath();\n    context.moveTo(flatClipCoords[0], flatClipCoords[1]);\n    context.lineTo(flatClipCoords[2], flatClipCoords[3]);\n    context.lineTo(flatClipCoords[4], flatClipCoords[5]);\n    context.lineTo(flatClipCoords[6], flatClipCoords[7]);\n    context.clip();\n  }\n\n  /**\n   * Create executors and populate them using the provided instructions.\n   * @private\n   * @param {!Object<string, !Object<BuilderType, import(\"./Builder.js\").SerializableInstructions>>} allInstructions The serializable instructions\n   */\n  createExecutors_(allInstructions) {\n    for (const zIndex in allInstructions) {\n      let executors = this.executorsByZIndex_[zIndex];\n      if (executors === undefined) {\n        this.executorsByZIndex_[zIndex] = executors = {};\n      }\n      const instructionByZindex = allInstructions[zIndex];\n      for (const builderType in instructionByZindex) {\n        const instructions = instructionByZindex[builderType];\n        executors[builderType] = new Executor(\n          this.resolution_, this.pixelRatio_, this.overlaps_, instructions);\n      }\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    for (const z in this.executorsByZIndex_) {\n      const executors = this.executorsByZIndex_[z];\n      for (const key in executors) {\n        executors[key].disposeInternal();\n      }\n    }\n    if (this.hitDetectionContext_) {\n      const canvas = this.hitDetectionContext_.canvas;\n      canvas.width = canvas.height = 0;\n    }\n\n    super.disposeInternal();\n  }\n\n  /**\n   * @param {Array<BuilderType>} executors Executors.\n   * @return {boolean} Has executors of the provided types.\n   */\n  hasExecutors(executors) {\n    for (const zIndex in this.executorsByZIndex_) {\n      const candidates = this.executorsByZIndex_[zIndex];\n      for (let i = 0, ii = executors.length; i < ii; ++i) {\n        if (executors[i] in candidates) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n\n  /**\n   * @param {import(\"../../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {number} resolution Resolution.\n   * @param {number} rotation Rotation.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(import(\"../../Feature.js\").FeatureLike): T} callback Feature callback.\n   * @param {Array<import(\"../../Feature.js\").FeatureLike>} declutteredFeatures Decluttered features.\n   * @return {T|undefined} Callback result.\n   * @template T\n   */\n  forEachFeatureAtCoordinate(\n    coordinate,\n    resolution,\n    rotation,\n    hitTolerance,\n    callback,\n    declutteredFeatures\n  ) {\n\n    hitTolerance = Math.round(hitTolerance);\n    const contextSize = hitTolerance * 2 + 1;\n    const transform = composeTransform(this.hitDetectionTransform_,\n      hitTolerance + 0.5, hitTolerance + 0.5,\n      1 / resolution, -1 / resolution,\n      -rotation,\n      -coordinate[0], -coordinate[1]);\n\n    if (!this.hitDetectionContext_) {\n      this.hitDetectionContext_ = createCanvasContext2D(contextSize, contextSize);\n    }\n    const context = this.hitDetectionContext_;\n\n    if (context.canvas.width !== contextSize || context.canvas.height !== contextSize) {\n      context.canvas.width = contextSize;\n      context.canvas.height = contextSize;\n    } else {\n      context.clearRect(0, 0, contextSize, contextSize);\n    }\n\n    /**\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    let hitExtent;\n    if (this.renderBuffer_ !== undefined) {\n      hitExtent = createEmpty();\n      extendCoordinate(hitExtent, coordinate);\n      buffer(hitExtent, resolution * (this.renderBuffer_ + hitTolerance), hitExtent);\n    }\n\n    const mask = getCircleArray(hitTolerance);\n\n    let builderType;\n\n    /**\n     * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n     * @return {?} Callback result.\n     */\n    function featureCallback(feature) {\n      const imageData = context.getImageData(0, 0, contextSize, contextSize).data;\n      for (let i = 0; i < contextSize; i++) {\n        for (let j = 0; j < contextSize; j++) {\n          if (mask[i][j]) {\n            if (imageData[(j * contextSize + i) * 4 + 3] > 0) {\n              let result;\n              if (!(declutteredFeatures && (builderType == BuilderType.IMAGE || builderType == BuilderType.TEXT)) ||\n                  declutteredFeatures.indexOf(feature) !== -1) {\n                result = callback(feature);\n              }\n              if (result) {\n                return result;\n              } else {\n                context.clearRect(0, 0, contextSize, contextSize);\n                return undefined;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    /** @type {Array<number>} */\n    const zs = Object.keys(this.executorsByZIndex_).map(Number);\n    zs.sort(numberSafeCompareFunction);\n\n    let i, j, executors, executor, result;\n    for (i = zs.length - 1; i >= 0; --i) {\n      const zIndexKey = zs[i].toString();\n      executors = this.executorsByZIndex_[zIndexKey];\n      for (j = ORDER.length - 1; j >= 0; --j) {\n        builderType = ORDER[j];\n        executor = executors[builderType];\n        if (executor !== undefined) {\n          result = executor.executeHitDetection(context, transform, rotation, featureCallback, hitExtent);\n          if (result) {\n            return result;\n          }\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @return {Array<number>} Clip coordinates.\n   */\n  getClipCoords(transform) {\n    const maxExtent = this.maxExtent_;\n    if (!maxExtent) {\n      return null;\n    }\n    const minX = maxExtent[0];\n    const minY = maxExtent[1];\n    const maxX = maxExtent[2];\n    const maxY = maxExtent[3];\n    const flatClipCoords = [minX, minY, minX, maxY, maxX, maxY, maxX, minY];\n    transform2D(\n      flatClipCoords, 0, 8, 2, transform, flatClipCoords);\n    return flatClipCoords;\n  }\n\n  /**\n   * @return {boolean} Is empty.\n   */\n  isEmpty() {\n    return isEmpty(this.executorsByZIndex_);\n  }\n\n  /**\n   * @param {CanvasRenderingContext2D} context Context.\n   * @param {import(\"../../transform.js\").Transform} transform Transform.\n   * @param {number} viewRotation View rotation.\n   * @param {boolean} snapToPixel Snap point symbols and test to integer pixel.\n   * @param {Array<BuilderType>=} opt_builderTypes Ordered replay types to replay.\n   *     Default is {@link module:ol/render/replay~ORDER}\n   * @param {Object<string, import(\"../canvas.js\").DeclutterGroup>=} opt_declutterReplays Declutter replays.\n   */\n  execute(context, transform, viewRotation, snapToPixel, opt_builderTypes, opt_declutterReplays) {\n\n    /** @type {Array<number>} */\n    const zs = Object.keys(this.executorsByZIndex_).map(Number);\n    zs.sort(numberSafeCompareFunction);\n\n    // setup clipping so that the parts of over-simplified geometries are not\n    // visible outside the current extent when panning\n    if (this.maxExtent_) {\n      context.save();\n      this.clip(context, transform);\n    }\n\n    const builderTypes = opt_builderTypes ? opt_builderTypes : ORDER;\n    let i, ii, j, jj, replays, replay;\n    for (i = 0, ii = zs.length; i < ii; ++i) {\n      const zIndexKey = zs[i].toString();\n      replays = this.executorsByZIndex_[zIndexKey];\n      for (j = 0, jj = builderTypes.length; j < jj; ++j) {\n        const builderType = builderTypes[j];\n        replay = replays[builderType];\n        if (replay !== undefined) {\n          if (opt_declutterReplays &&\n              (builderType == BuilderType.IMAGE || builderType == BuilderType.TEXT)) {\n            const declutter = opt_declutterReplays[zIndexKey];\n            if (!declutter) {\n              opt_declutterReplays[zIndexKey] = [replay, transform.slice(0)];\n            } else {\n              declutter.push(replay, transform.slice(0));\n            }\n          } else {\n            replay.execute(context, transform, viewRotation, snapToPixel);\n          }\n        }\n      }\n    }\n\n    if (this.maxExtent_) {\n      context.restore();\n    }\n  }\n}\n\n\n/**\n * This cache is used for storing calculated pixel circles for increasing performance.\n * It is a static property to allow each Replaygroup to access it.\n * @type {Object<number, Array<Array<(boolean|undefined)>>>}\n */\nconst circleArrayCache = {\n  0: [[true]]\n};\n\n\n/**\n * This method fills a row in the array from the given coordinate to the\n * middle with `true`.\n * @param {Array<Array<(boolean|undefined)>>} array The array that will be altered.\n * @param {number} x X coordinate.\n * @param {number} y Y coordinate.\n */\nfunction fillCircleArrayRowToMiddle(array, x, y) {\n  let i;\n  const radius = Math.floor(array.length / 2);\n  if (x >= radius) {\n    for (i = radius; i < x; i++) {\n      array[i][y] = true;\n    }\n  } else if (x < radius) {\n    for (i = x + 1; i < radius; i++) {\n      array[i][y] = true;\n    }\n  }\n}\n\n\n/**\n * This methods creates a circle inside a fitting array. Points inside the\n * circle are marked by true, points on the outside are undefined.\n * It uses the midpoint circle algorithm.\n * A cache is used to increase performance.\n * @param {number} radius Radius.\n * @returns {Array<Array<(boolean|undefined)>>} An array with marked circle points.\n */\nexport function getCircleArray(radius) {\n  if (circleArrayCache[radius] !== undefined) {\n    return circleArrayCache[radius];\n  }\n\n  const arraySize = radius * 2 + 1;\n  const arr = new Array(arraySize);\n  for (let i = 0; i < arraySize; i++) {\n    arr[i] = new Array(arraySize);\n  }\n\n  let x = radius;\n  let y = 0;\n  let error = 0;\n\n  while (x >= y) {\n    fillCircleArrayRowToMiddle(arr, radius + x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius + x);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius + y);\n    fillCircleArrayRowToMiddle(arr, radius - x, radius - y);\n    fillCircleArrayRowToMiddle(arr, radius - y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + y, radius - x);\n    fillCircleArrayRowToMiddle(arr, radius + x, radius - y);\n\n    y++;\n    error += 1 + 2 * y;\n    if (2 * (error - x) + 1 > 0) {\n      x -= 1;\n      error += 1 - 2 * x;\n    }\n  }\n\n  circleArrayCache[radius] = arr;\n  return arr;\n}\n\n\n/**\n * @param {!Object<string, Array<*>>} declutterReplays Declutter replays.\n * @param {CanvasRenderingContext2D} context Context.\n * @param {number} rotation Rotation.\n * @param {number} opacity Opacity.\n * @param {boolean} snapToPixel Snap point symbols and text to integer pixels.\n * @param {Array<import(\"../../PluggableMap.js\").DeclutterItems>} declutterItems Declutter items.\n */\nexport function replayDeclutter(declutterReplays, context, rotation, opacity, snapToPixel, declutterItems) {\n  const zs = Object.keys(declutterReplays).map(Number).sort(numberSafeCompareFunction);\n  for (let z = 0, zz = zs.length; z < zz; ++z) {\n    const executorData = declutterReplays[zs[z].toString()];\n    let currentExecutor;\n    for (let i = 0, ii = executorData.length; i < ii;) {\n      const executor = executorData[i++];\n      if (executor !== currentExecutor) {\n        currentExecutor = executor;\n        declutterItems.push({\n          items: executor.declutterItems,\n          opacity: opacity\n        });\n      }\n      const transform = executorData[i++];\n      executor.execute(context, transform, rotation, snapToPixel);\n    }\n  }\n}\n\n\nexport default ExecutorGroup;\n","/**\n * @module ol/control/Attribution\n */\nimport {equals} from '../array.js';\nimport Control from './Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {removeChildren, replaceNode} from '../dom.js';\nimport EventType from '../events/EventType.js';\nimport {inView} from '../layer/Layer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-attribution'] CSS class name.\n * @property {HTMLElement|string} [target] Specify a target if you\n * want the control to be rendered outside of the map's\n * viewport.\n * @property {boolean} [collapsible] Specify if attributions can\n * be collapsed. If not specified, sources control this behavior with their\n * `attributionsCollapsible` setting.\n * @property {boolean} [collapsed=true] Specify if attributions should\n * be collapsed at startup.\n * @property {string} [tipLabel='Attributions'] Text label to use for the button tip.\n * @property {string} [label='i'] Text label to use for the\n * collapsed attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|HTMLElement} [collapseLabel='»'] Text label to use\n * for the expanded attributions button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when\n * the control should be re-rendered. This is called in a `requestAnimationFrame`\n * callback.\n */\n\n\n/**\n * @classdesc\n * Control to show all the attributions associated with the layer sources\n * in the map. This control is one of the default controls included in maps.\n * By default it will show in the bottom right portion of the map, but this can\n * be changed by using a css selector for `.ol-attribution`.\n *\n * @api\n */\nclass Attribution extends Control {\n\n  /**\n   * @param {Options=} opt_options Attribution options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      element: document.createElement('div'),\n      render: options.render || render,\n      target: options.target\n    });\n\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this.ulElement_ = document.createElement('ul');\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.overrideCollapsible_ = options.collapsible !== undefined;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.collapsible_ = options.collapsible !== undefined ?\n      options.collapsible : true;\n\n    if (!this.collapsible_) {\n      this.collapsed_ = false;\n    }\n\n    const className = options.className !== undefined ? options.className : 'ol-attribution';\n\n    const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Attributions';\n\n    const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00BB';\n\n    if (typeof collapseLabel === 'string') {\n      /**\n       * @private\n       * @type {HTMLElement}\n       */\n      this.collapseLabel_ = document.createElement('span');\n      this.collapseLabel_.textContent = collapseLabel;\n    } else {\n      this.collapseLabel_ = collapseLabel;\n    }\n\n    const label = options.label !== undefined ? options.label : 'i';\n\n    if (typeof label === 'string') {\n      /**\n       * @private\n       * @type {HTMLElement}\n       */\n      this.label_ = document.createElement('span');\n      this.label_.textContent = label;\n    } else {\n      this.label_ = label;\n    }\n\n\n    const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n      this.collapseLabel_ : this.label_;\n    const button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.title = tipLabel;\n    button.appendChild(activeLabel);\n\n    button.addEventListener(EventType.CLICK, this.handleClick_.bind(this), false);\n\n    const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n        (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n        (this.collapsible_ ? '' : ' ol-uncollapsible');\n    const element = this.element;\n    element.className = cssClasses;\n    element.appendChild(this.ulElement_);\n    element.appendChild(button);\n\n    /**\n     * A list of currently rendered resolutions.\n     * @type {Array<string>}\n     * @private\n     */\n    this.renderedAttributions_ = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderedVisible_ = true;\n\n  }\n\n  /**\n   * Collect a list of visible attributions and set the collapsible state.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {Array<string>} Attributions.\n   * @private\n   */\n  collectSourceAttributions_(frameState) {\n    /**\n     * Used to determine if an attribution already exists.\n     * @type {!Object<string, boolean>}\n     */\n    const lookup = {};\n\n    /**\n     * A list of visible attributions.\n     * @type {Array<string>}\n     */\n    const visibleAttributions = [];\n\n    const layerStatesArray = frameState.layerStatesArray;\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const layerState = layerStatesArray[i];\n      if (!inView(layerState, frameState.viewState)) {\n        continue;\n      }\n\n      const source = /** @type {import(\"../layer/Layer.js\").default} */ (layerState.layer).getSource();\n      if (!source) {\n        continue;\n      }\n\n      const attributionGetter = source.getAttributions();\n      if (!attributionGetter) {\n        continue;\n      }\n\n      const attributions = attributionGetter(frameState);\n      if (!attributions) {\n        continue;\n      }\n\n      if (!this.overrideCollapsible_ && source.getAttributionsCollapsible() === false) {\n        this.setCollapsible(false);\n      }\n\n      if (Array.isArray(attributions)) {\n        for (let j = 0, jj = attributions.length; j < jj; ++j) {\n          if (!(attributions[j] in lookup)) {\n            visibleAttributions.push(attributions[j]);\n            lookup[attributions[j]] = true;\n          }\n        }\n      } else {\n        if (!(attributions in lookup)) {\n          visibleAttributions.push(attributions);\n          lookup[attributions] = true;\n        }\n      }\n    }\n    return visibleAttributions;\n  }\n\n  /**\n   * @private\n   * @param {?import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  updateElement_(frameState) {\n    if (!frameState) {\n      if (this.renderedVisible_) {\n        this.element.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n      return;\n    }\n\n    const attributions = this.collectSourceAttributions_(frameState);\n\n    const visible = attributions.length > 0;\n    if (this.renderedVisible_ != visible) {\n      this.element.style.display = visible ? '' : 'none';\n      this.renderedVisible_ = visible;\n    }\n\n    if (equals(attributions, this.renderedAttributions_)) {\n      return;\n    }\n\n    removeChildren(this.ulElement_);\n\n    // append the attributions\n    for (let i = 0, ii = attributions.length; i < ii; ++i) {\n      const element = document.createElement('li');\n      element.innerHTML = attributions[i];\n      this.ulElement_.appendChild(element);\n    }\n\n    this.renderedAttributions_ = attributions;\n  }\n\n  /**\n   * @param {MouseEvent} event The event to handle\n   * @private\n   */\n  handleClick_(event) {\n    event.preventDefault();\n    this.handleToggle_();\n  }\n\n  /**\n   * @private\n   */\n  handleToggle_() {\n    this.element.classList.toggle(CLASS_COLLAPSED);\n    if (this.collapsed_) {\n      replaceNode(this.collapseLabel_, this.label_);\n    } else {\n      replaceNode(this.label_, this.collapseLabel_);\n    }\n    this.collapsed_ = !this.collapsed_;\n  }\n\n  /**\n   * Return `true` if the attribution is collapsible, `false` otherwise.\n   * @return {boolean} True if the widget is collapsible.\n   * @api\n   */\n  getCollapsible() {\n    return this.collapsible_;\n  }\n\n  /**\n   * Set whether the attribution should be collapsible.\n   * @param {boolean} collapsible True if the widget is collapsible.\n   * @api\n   */\n  setCollapsible(collapsible) {\n    if (this.collapsible_ === collapsible) {\n      return;\n    }\n    this.collapsible_ = collapsible;\n    this.element.classList.toggle('ol-uncollapsible');\n    if (!collapsible && this.collapsed_) {\n      this.handleToggle_();\n    }\n  }\n\n  /**\n   * Collapse or expand the attribution according to the passed parameter. Will\n   * not do anything if the attribution isn't collapsible or if the current\n   * collapsed state is already the one requested.\n   * @param {boolean} collapsed True if the widget is collapsed.\n   * @api\n   */\n  setCollapsed(collapsed) {\n    if (!this.collapsible_ || this.collapsed_ === collapsed) {\n      return;\n    }\n    this.handleToggle_();\n  }\n\n  /**\n   * Return `true` when the attribution is currently collapsed or `false`\n   * otherwise.\n   * @return {boolean} True if the widget is collapsed.\n   * @api\n   */\n  getCollapsed() {\n    return this.collapsed_;\n  }\n}\n\n\n/**\n * Update the attribution element.\n * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n * @this {Attribution}\n * @api\n */\nexport function render(mapEvent) {\n  this.updateElement_(mapEvent.frameState);\n}\n\n\nexport default Attribution;\n","/**\n * @module ol/interaction/PinchZoom\n */\nimport {FALSE} from '../functions.js';\nimport PointerInteraction, {centroid as centroidFromPointers} from './Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [duration=400] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom the map by pinching with two fingers\n * on a touch screen.\n * @api\n */\nclass PinchZoom extends PointerInteraction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    const pointerOptions = /** @type {import(\"./Pointer.js\").Options} */ (options);\n\n    if (!pointerOptions.stopDown) {\n      pointerOptions.stopDown = FALSE;\n    }\n\n    super(pointerOptions);\n\n    /**\n     * @private\n     * @type {import(\"../coordinate.js\").Coordinate}\n     */\n    this.anchor_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastDistance_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.lastScaleDelta_ = 1;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(mapBrowserEvent) {\n    let scaleDelta = 1.0;\n\n    const touch0 = this.targetPointers[0];\n    const touch1 = this.targetPointers[1];\n    const dx = touch0.clientX - touch1.clientX;\n    const dy = touch0.clientY - touch1.clientY;\n\n    // distance between touches\n    const distance = Math.sqrt(dx * dx + dy * dy);\n\n    if (this.lastDistance_ !== undefined) {\n      scaleDelta = this.lastDistance_ / distance;\n    }\n    this.lastDistance_ = distance;\n\n\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n\n    if (scaleDelta != 1.0) {\n      this.lastScaleDelta_ = scaleDelta;\n    }\n\n    // scale anchor point.\n    const viewportPosition = map.getViewport().getBoundingClientRect();\n    const centroid = centroidFromPointers(this.targetPointers);\n    centroid[0] -= viewportPosition.left;\n    centroid[1] -= viewportPosition.top;\n    this.anchor_ = map.getCoordinateFromPixelInternal(centroid);\n\n    // scale, bypass the resolution constraint\n    map.render();\n    view.adjustResolutionInternal(scaleDelta, this.anchor_);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(mapBrowserEvent) {\n    if (this.targetPointers.length < 2) {\n      const map = mapBrowserEvent.map;\n      const view = map.getView();\n      const direction = this.lastScaleDelta_ > 1 ? 1 : -1;\n      view.endInteraction(this.duration_, direction);\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (this.targetPointers.length >= 2) {\n      const map = mapBrowserEvent.map;\n      this.anchor_ = null;\n      this.lastDistance_ = undefined;\n      this.lastScaleDelta_ = 1;\n      if (!this.handlingDownUpSequence) {\n        map.getView().beginInteraction();\n      }\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nexport default PinchZoom;\n","/**\n * @module ol/control/ZoomSlider\n */\nimport Control from './Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE} from '../css.js';\nimport {easeOut} from '../easing.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport {stopPropagation} from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport {clamp} from '../math.js';\nimport PointerEventType from '../pointer/EventType.js';\nimport '@openlayers/pepjs';\n\n\n/**\n * The enum for available directions.\n *\n * @enum {number}\n */\nconst Direction = {\n  VERTICAL: 0,\n  HORIZONTAL: 1\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-zoomslider'] CSS class name.\n * @property {number} [duration=200] Animation duration in milliseconds.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n */\n\n\n/**\n * @classdesc\n * A slider type of control for zooming.\n *\n * Example:\n *\n *     map.addControl(new ZoomSlider());\n *\n * @api\n */\nclass ZoomSlider extends Control {\n\n  /**\n   * @param {Options=} opt_options Zoom slider options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      element: document.createElement('div'),\n      render: options.render || render\n    });\n\n    /**\n      * @type {!Array.<import(\"../events.js\").EventsKey>}\n      * @private\n      */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * Will hold the current resolution of the view.\n     *\n     * @type {number|undefined}\n     * @private\n     */\n    this.currentResolution_ = undefined;\n\n    /**\n     * The direction of the slider. Will be determined from actual display of the\n     * container and defaults to Direction.VERTICAL.\n     *\n     * @type {Direction}\n     * @private\n     */\n    this.direction_ = Direction.VERTICAL;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.heightLimit_ = 0;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.widthLimit_ = 0;\n\n    /**\n     * @type {number|undefined}\n     * @private\n     */\n    this.startX_;\n\n    /**\n     * @type {number|undefined}\n     * @private\n     */\n    this.startY_;\n\n    /**\n     * The calculated thumb size (border box plus margins).  Set when initSlider_\n     * is called.\n     * @type {import(\"../size.js\").Size}\n     * @private\n     */\n    this.thumbSize_ = null;\n\n    /**\n     * Whether the slider is initialized.\n     * @type {boolean}\n     * @private\n     */\n    this.sliderInitialized_ = false;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 200;\n\n    const className = options.className !== undefined ? options.className : 'ol-zoomslider';\n    const thumbElement = document.createElement('button');\n    thumbElement.setAttribute('type', 'button');\n    thumbElement.className = className + '-thumb ' + CLASS_UNSELECTABLE;\n    const containerElement = this.element;\n    containerElement.setAttribute('touch-action', 'none');\n    containerElement.className = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL;\n    containerElement.appendChild(thumbElement);\n\n    containerElement.addEventListener(PointerEventType.POINTERDOWN, this.handleDraggerStart_.bind(this), false);\n    containerElement.addEventListener(PointerEventType.POINTERMOVE, this.handleDraggerDrag_.bind(this), false);\n    containerElement.addEventListener(PointerEventType.POINTERUP, this.handleDraggerEnd_.bind(this), false);\n\n    containerElement.addEventListener(EventType.CLICK, this.handleContainerClick_.bind(this), false);\n    thumbElement.addEventListener(EventType.CLICK, stopPropagation, false);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setMap(map) {\n    super.setMap(map);\n    if (map) {\n      map.render();\n    }\n  }\n\n  /**\n   * Initializes the slider element. This will determine and set this controls\n   * direction_ and also constrain the dragging of the thumb to always be within\n   * the bounds of the container.\n   *\n   * @private\n   */\n  initSlider_() {\n    const container = this.element;\n    const containerSize = {\n      width: container.offsetWidth, height: container.offsetHeight\n    };\n\n    const thumb = /** @type {HTMLElement} */ (container.firstElementChild);\n    const computedStyle = getComputedStyle(thumb);\n    const thumbWidth = thumb.offsetWidth +\n        parseFloat(computedStyle['marginRight']) +\n        parseFloat(computedStyle['marginLeft']);\n    const thumbHeight = thumb.offsetHeight +\n        parseFloat(computedStyle['marginTop']) +\n        parseFloat(computedStyle['marginBottom']);\n    this.thumbSize_ = [thumbWidth, thumbHeight];\n\n    if (containerSize.width > containerSize.height) {\n      this.direction_ = Direction.HORIZONTAL;\n      this.widthLimit_ = containerSize.width - thumbWidth;\n    } else {\n      this.direction_ = Direction.VERTICAL;\n      this.heightLimit_ = containerSize.height - thumbHeight;\n    }\n    this.sliderInitialized_ = true;\n  }\n\n  /**\n   * @param {PointerEvent} event The browser event to handle.\n   * @private\n   */\n  handleContainerClick_(event) {\n    const view = this.getMap().getView();\n\n    const relativePosition = this.getRelativePosition_(\n      event.offsetX - this.thumbSize_[0] / 2,\n      event.offsetY - this.thumbSize_[1] / 2);\n\n    const resolution = this.getResolutionForPosition_(relativePosition);\n    const zoom = view.getConstrainedZoom(view.getZoomForResolution(resolution));\n\n    view.animateInternal({\n      zoom: zoom,\n      duration: this.duration_,\n      easing: easeOut\n    });\n  }\n\n  /**\n   * Handle dragger start events.\n   * @param {PointerEvent} event The drag event.\n   * @private\n   */\n  handleDraggerStart_(event) {\n    if (!this.dragging_ && event.target === this.element.firstElementChild) {\n      const element = /** @type {HTMLElement} */ (this.element.firstElementChild);\n      this.getMap().getView().beginInteraction();\n      this.startX_ = event.clientX - parseFloat(element.style.left);\n      this.startY_ = event.clientY - parseFloat(element.style.top);\n      this.dragging_ = true;\n\n      if (this.dragListenerKeys_.length === 0) {\n        const drag = this.handleDraggerDrag_;\n        const end = this.handleDraggerEnd_;\n        this.dragListenerKeys_.push(\n          listen(document, PointerEventType.POINTERMOVE, drag, this),\n          listen(document, PointerEventType.POINTERUP, end, this)\n        );\n      }\n    }\n  }\n\n  /**\n   * Handle dragger drag events.\n   *\n   * @param {PointerEvent} event The drag event.\n   * @private\n   */\n  handleDraggerDrag_(event) {\n    if (this.dragging_) {\n      const deltaX = event.clientX - this.startX_;\n      const deltaY = event.clientY - this.startY_;\n      const relativePosition = this.getRelativePosition_(deltaX, deltaY);\n      this.currentResolution_ = this.getResolutionForPosition_(relativePosition);\n      this.getMap().getView().setResolution(this.currentResolution_);\n    }\n  }\n\n  /**\n   * Handle dragger end events.\n   * @param {PointerEvent} event The drag event.\n   * @private\n   */\n  handleDraggerEnd_(event) {\n    if (this.dragging_) {\n      const view = this.getMap().getView();\n      view.endInteraction();\n\n      this.dragging_ = false;\n      this.startX_ = undefined;\n      this.startY_ = undefined;\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n    }\n  }\n\n  /**\n   * Positions the thumb inside its container according to the given resolution.\n   *\n   * @param {number} res The res.\n   * @private\n   */\n  setThumbPosition_(res) {\n    const position = this.getPositionForResolution_(res);\n    const thumb = /** @type {HTMLElement} */ (this.element.firstElementChild);\n\n    if (this.direction_ == Direction.HORIZONTAL) {\n      thumb.style.left = this.widthLimit_ * position + 'px';\n    } else {\n      thumb.style.top = this.heightLimit_ * position + 'px';\n    }\n  }\n\n  /**\n   * Calculates the relative position of the thumb given x and y offsets.  The\n   * relative position scales from 0 to 1.  The x and y offsets are assumed to be\n   * in pixel units within the dragger limits.\n   *\n   * @param {number} x Pixel position relative to the left of the slider.\n   * @param {number} y Pixel position relative to the top of the slider.\n   * @return {number} The relative position of the thumb.\n   * @private\n   */\n  getRelativePosition_(x, y) {\n    let amount;\n    if (this.direction_ === Direction.HORIZONTAL) {\n      amount = x / this.widthLimit_;\n    } else {\n      amount = y / this.heightLimit_;\n    }\n    return clamp(amount, 0, 1);\n  }\n\n  /**\n   * Calculates the corresponding resolution of the thumb given its relative\n   * position (where 0 is the minimum and 1 is the maximum).\n   *\n   * @param {number} position The relative position of the thumb.\n   * @return {number} The corresponding resolution.\n   * @private\n   */\n  getResolutionForPosition_(position) {\n    const fn = this.getMap().getView().getResolutionForValueFunction();\n    return fn(1 - position);\n  }\n\n  /**\n   * Determines the relative position of the slider for the given resolution.  A\n   * relative position of 0 corresponds to the minimum view resolution.  A\n   * relative position of 1 corresponds to the maximum view resolution.\n   *\n   * @param {number} res The resolution.\n   * @return {number} The relative position value (between 0 and 1).\n   * @private\n   */\n  getPositionForResolution_(res) {\n    const fn = this.getMap().getView().getValueForResolutionFunction();\n    return clamp(1 - fn(res), 0, 1);\n  }\n}\n\n\n/**\n * Update the zoomslider element.\n * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n * @this {ZoomSlider}\n * @api\n */\nexport function render(mapEvent) {\n  if (!mapEvent.frameState) {\n    return;\n  }\n  if (!this.sliderInitialized_) {\n    this.initSlider_();\n  }\n  const res = mapEvent.frameState.viewState.resolution;\n  this.currentResolution_ = res;\n  this.setThumbPosition_(res);\n}\n\n\nexport default ZoomSlider;\n","/**\n * @module ol/render/Box\n */\n\nimport Disposable from '../Disposable.js';\nimport Polygon from '../geom/Polygon.js';\n\nclass RenderBox extends Disposable {\n  /**\n   * @param {string} className CSS class name.\n   */\n  constructor(className) {\n    super();\n\n    /**\n     * @type {import(\"../geom/Polygon.js\").default}\n     * @private\n     */\n    this.geometry_ = null;\n\n    /**\n     * @type {HTMLDivElement}\n     * @private\n     */\n    this.element_ = document.createElement('div');\n    this.element_.style.position = 'absolute';\n    this.element_.className = 'ol-box ' + className;\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").default}\n     */\n    this.map_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../pixel.js\").Pixel}\n     */\n    this.startPixel_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../pixel.js\").Pixel}\n     */\n    this.endPixel_ = null;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.setMap(null);\n  }\n\n  /**\n   * @private\n   */\n  render_() {\n    const startPixel = this.startPixel_;\n    const endPixel = this.endPixel_;\n    const px = 'px';\n    const style = this.element_.style;\n    style.left = Math.min(startPixel[0], endPixel[0]) + px;\n    style.top = Math.min(startPixel[1], endPixel[1]) + px;\n    style.width = Math.abs(endPixel[0] - startPixel[0]) + px;\n    style.height = Math.abs(endPixel[1] - startPixel[1]) + px;\n  }\n\n  /**\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n  setMap(map) {\n    if (this.map_) {\n      this.map_.getOverlayContainer().removeChild(this.element_);\n      const style = this.element_.style;\n      style.left = style.top = style.width = style.height = 'inherit';\n    }\n    this.map_ = map;\n    if (this.map_) {\n      this.map_.getOverlayContainer().appendChild(this.element_);\n    }\n  }\n\n  /**\n   * @param {import(\"../pixel.js\").Pixel} startPixel Start pixel.\n   * @param {import(\"../pixel.js\").Pixel} endPixel End pixel.\n   */\n  setPixels(startPixel, endPixel) {\n    this.startPixel_ = startPixel;\n    this.endPixel_ = endPixel;\n    this.createOrUpdateGeometry();\n    this.render_();\n  }\n\n  /**\n   * Creates or updates the cached geometry.\n   */\n  createOrUpdateGeometry() {\n    const startPixel = this.startPixel_;\n    const endPixel = this.endPixel_;\n    const pixels = [\n      startPixel,\n      [startPixel[0], endPixel[1]],\n      endPixel,\n      [endPixel[0], startPixel[1]]\n    ];\n    const coordinates = pixels.map(this.map_.getCoordinateFromPixelInternal, this.map_);\n    // close the polygon\n    coordinates[4] = coordinates[0].slice();\n    if (!this.geometry_) {\n      this.geometry_ = new Polygon([coordinates]);\n    } else {\n      this.geometry_.setCoordinates([coordinates]);\n    }\n  }\n\n  /**\n   * @return {import(\"../geom/Polygon.js\").default} Geometry.\n   */\n  getGeometry() {\n    return this.geometry_;\n  }\n}\n\n\nexport default RenderBox;\n","/**\n * @module ol/interaction/DragBox\n */\n// FIXME draw drag box\nimport Event from '../events/Event.js';\nimport {always, mouseOnly, mouseActionButton} from '../events/condition.js';\nimport {VOID} from '../functions.js';\nimport PointerInteraction from './Pointer.js';\nimport RenderBox from '../render/Box.js';\n\n\n/**\n * A function that takes a {@link module:ol/MapBrowserEvent} and two\n * {@link module:ol/pixel~Pixel}s and returns a `{boolean}`. If the condition is met,\n * true should be returned.\n * @typedef {function(this: ?, import(\"../MapBrowserEvent.js\").default, import(\"../pixel.js\").Pixel, import(\"../pixel.js\").Pixel):boolean} EndCondition\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-dragbox'] CSS class name for styling the box.\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a boolean\n * to indicate whether that event should be handled.\n * Default is {@link ol/events/condition~always}.\n * @property {number} [minArea=64] The minimum area of the box in pixel, this value is used by the default\n * `boxEndCondition` function.\n * @property {EndCondition} [boxEndCondition] A function that takes a {@link module:ol/MapBrowserEvent~MapBrowserEvent} and two\n * {@link module:ol/pixel~Pixel}s to indicate whether a `boxend` event should be fired.\n * Default is `true` if the area of the box is bigger than the `minArea` option.\n * @property {function(this:DragBox, import(\"../MapBrowserEvent.js\").default)} [onBoxEnd] Code to execute just\n * before `boxend` is fired.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragBoxEventType = {\n  /**\n   * Triggered upon drag box start.\n   * @event DragBoxEvent#boxstart\n   * @api\n   */\n  BOXSTART: 'boxstart',\n\n  /**\n   * Triggered on drag when box is active.\n   * @event DragBoxEvent#boxdrag\n   * @api\n   */\n  BOXDRAG: 'boxdrag',\n\n  /**\n   * Triggered upon drag box end.\n   * @event DragBoxEvent#boxend\n   * @api\n   */\n  BOXEND: 'boxend'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragBox~DragBox} instances are instances of\n * this type.\n */\nclass DragBoxEvent extends Event {\n\n  /**\n   * @param {string} type The event type.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate The event coordinate.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Originating event.\n   */\n  constructor(type, coordinate, mapBrowserEvent) {\n    super(type);\n\n    /**\n     * The coordinate of the drag event.\n     * @const\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @api\n     */\n    this.coordinate = coordinate;\n\n    /**\n     * @const\n     * @type {import(\"../MapBrowserEvent.js\").default}\n     * @api\n     */\n    this.mapBrowserEvent = mapBrowserEvent;\n\n  }\n\n}\n\n\n/**\n * @classdesc\n * Allows the user to draw a vector box by clicking and dragging on the map,\n * normally combined with an {@link module:ol/events/condition} that limits\n * it to when the shift or other key is held down. This is used, for example,\n * for zooming to a specific area of the map\n * (see {@link module:ol/interaction/DragZoom~DragZoom} and\n * {@link module:ol/interaction/DragRotateAndZoom}).\n *\n * This interaction is only supported for mouse devices.\n *\n * @fires DragBoxEvent\n * @api\n */\nclass DragBox extends PointerInteraction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @type {import(\"../render/Box.js\").default}\n     * @private\n     */\n    this.box_ = new RenderBox(options.className || 'ol-dragbox');\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.minArea_ = options.minArea !== undefined ? options.minArea : 64;\n\n    /**\n     * Function to execute just before `onboxend` is fired\n     * @type {function(this:DragBox, import(\"../MapBrowserEvent.js\").default): void}\n     * @private\n     */\n    this.onBoxEnd_ = options.onBoxEnd ? options.onBoxEnd : VOID;\n\n    /**\n     * @type {import(\"../pixel.js\").Pixel}\n     * @private\n     */\n    this.startPixel_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : always;\n\n    /**\n     * @private\n     * @type {EndCondition}\n     */\n    this.boxEndCondition_ = options.boxEndCondition ?\n      options.boxEndCondition : this.defaultBoxEndCondition;\n  }\n\n  /**\n   * The default condition for determining whether the boxend event\n   * should fire.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent The originating MapBrowserEvent\n   *     leading to the box end.\n   * @param {import(\"../pixel.js\").Pixel} startPixel The starting pixel of the box.\n   * @param {import(\"../pixel.js\").Pixel} endPixel The end pixel of the box.\n   * @return {boolean} Whether or not the boxend condition should be fired.\n   */\n  defaultBoxEndCondition(mapBrowserEvent, startPixel, endPixel) {\n    const width = endPixel[0] - startPixel[0];\n    const height = endPixel[1] - startPixel[1];\n    return width * width + height * height >= this.minArea_;\n  }\n\n  /**\n   * Returns geometry of last drawn box.\n   * @return {import(\"../geom/Polygon.js\").default} Geometry.\n   * @api\n   */\n  getGeometry() {\n    return this.box_.getGeometry();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return;\n    }\n\n    this.box_.setPixels(this.startPixel_, mapBrowserEvent.pixel);\n\n    this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXDRAG,\n      mapBrowserEvent.coordinate, mapBrowserEvent));\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return true;\n    }\n\n    this.box_.setMap(null);\n\n    if (this.boxEndCondition_(mapBrowserEvent, this.startPixel_, mapBrowserEvent.pixel)) {\n      this.onBoxEnd_(mapBrowserEvent);\n      this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXEND,\n        mapBrowserEvent.coordinate, mapBrowserEvent));\n    }\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return false;\n    }\n\n    if (mouseActionButton(mapBrowserEvent) &&\n        this.condition_(mapBrowserEvent)) {\n      this.startPixel_ = mapBrowserEvent.pixel;\n      this.box_.setMap(mapBrowserEvent.map);\n      this.box_.setPixels(this.startPixel_, this.startPixel_);\n      this.dispatchEvent(new DragBoxEvent(DragBoxEventType.BOXSTART,\n        mapBrowserEvent.coordinate, mapBrowserEvent));\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\n\nexport default DragBox;\n","/**\n * @module ol/structs/PriorityQueue\n */\nimport {assert} from '../asserts.js';\nimport {clear} from '../obj.js';\n\n\n/**\n * @type {number}\n */\nexport const DROP = Infinity;\n\n\n/**\n * @classdesc\n * Priority queue.\n *\n * The implementation is inspired from the Closure Library's Heap class and\n * Python's heapq module.\n *\n * See http://closure-library.googlecode.com/svn/docs/closure_goog_structs_heap.js.source.html\n * and http://hg.python.org/cpython/file/2.7/Lib/heapq.py.\n *\n * @template T\n */\nclass PriorityQueue {\n\n  /**\n   * @param {function(T): number} priorityFunction Priority function.\n   * @param {function(T): string} keyFunction Key function.\n   */\n  constructor(priorityFunction, keyFunction) {\n\n    /**\n     * @type {function(T): number}\n     * @private\n     */\n    this.priorityFunction_ = priorityFunction;\n\n    /**\n     * @type {function(T): string}\n     * @private\n     */\n    this.keyFunction_ = keyFunction;\n\n    /**\n     * @type {Array<T>}\n     * @private\n     */\n    this.elements_ = [];\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.priorities_ = [];\n\n    /**\n     * @type {!Object<string, boolean>}\n     * @private\n     */\n    this.queuedElements_ = {};\n\n  }\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  clear() {\n    this.elements_.length = 0;\n    this.priorities_.length = 0;\n    clear(this.queuedElements_);\n  }\n\n\n  /**\n   * Remove and return the highest-priority element. O(log N).\n   * @return {T} Element.\n   */\n  dequeue() {\n    const elements = this.elements_;\n    const priorities = this.priorities_;\n    const element = elements[0];\n    if (elements.length == 1) {\n      elements.length = 0;\n      priorities.length = 0;\n    } else {\n      elements[0] = elements.pop();\n      priorities[0] = priorities.pop();\n      this.siftUp_(0);\n    }\n    const elementKey = this.keyFunction_(element);\n    delete this.queuedElements_[elementKey];\n    return element;\n  }\n\n\n  /**\n   * Enqueue an element. O(log N).\n   * @param {T} element Element.\n   * @return {boolean} The element was added to the queue.\n   */\n  enqueue(element) {\n    assert(!(this.keyFunction_(element) in this.queuedElements_),\n      31); // Tried to enqueue an `element` that was already added to the queue\n    const priority = this.priorityFunction_(element);\n    if (priority != DROP) {\n      this.elements_.push(element);\n      this.priorities_.push(priority);\n      this.queuedElements_[this.keyFunction_(element)] = true;\n      this.siftDown_(0, this.elements_.length - 1);\n      return true;\n    }\n    return false;\n  }\n\n\n  /**\n   * @return {number} Count.\n   */\n  getCount() {\n    return this.elements_.length;\n  }\n\n\n  /**\n   * Gets the index of the left child of the node at the given index.\n   * @param {number} index The index of the node to get the left child for.\n   * @return {number} The index of the left child.\n   * @private\n   */\n  getLeftChildIndex_(index) {\n    return index * 2 + 1;\n  }\n\n\n  /**\n   * Gets the index of the right child of the node at the given index.\n   * @param {number} index The index of the node to get the right child for.\n   * @return {number} The index of the right child.\n   * @private\n   */\n  getRightChildIndex_(index) {\n    return index * 2 + 2;\n  }\n\n\n  /**\n   * Gets the index of the parent of the node at the given index.\n   * @param {number} index The index of the node to get the parent for.\n   * @return {number} The index of the parent.\n   * @private\n   */\n  getParentIndex_(index) {\n    return (index - 1) >> 1;\n  }\n\n\n  /**\n   * Make this a heap. O(N).\n   * @private\n   */\n  heapify_() {\n    let i;\n    for (i = (this.elements_.length >> 1) - 1; i >= 0; i--) {\n      this.siftUp_(i);\n    }\n  }\n\n\n  /**\n   * @return {boolean} Is empty.\n   */\n  isEmpty() {\n    return this.elements_.length === 0;\n  }\n\n\n  /**\n   * @param {string} key Key.\n   * @return {boolean} Is key queued.\n   */\n  isKeyQueued(key) {\n    return key in this.queuedElements_;\n  }\n\n\n  /**\n   * @param {T} element Element.\n   * @return {boolean} Is queued.\n   */\n  isQueued(element) {\n    return this.isKeyQueued(this.keyFunction_(element));\n  }\n\n\n  /**\n   * @param {number} index The index of the node to move down.\n   * @private\n   */\n  siftUp_(index) {\n    const elements = this.elements_;\n    const priorities = this.priorities_;\n    const count = elements.length;\n    const element = elements[index];\n    const priority = priorities[index];\n    const startIndex = index;\n\n    while (index < (count >> 1)) {\n      const lIndex = this.getLeftChildIndex_(index);\n      const rIndex = this.getRightChildIndex_(index);\n\n      const smallerChildIndex = rIndex < count &&\n          priorities[rIndex] < priorities[lIndex] ?\n        rIndex : lIndex;\n\n      elements[index] = elements[smallerChildIndex];\n      priorities[index] = priorities[smallerChildIndex];\n      index = smallerChildIndex;\n    }\n\n    elements[index] = element;\n    priorities[index] = priority;\n    this.siftDown_(startIndex, index);\n  }\n\n\n  /**\n   * @param {number} startIndex The index of the root.\n   * @param {number} index The index of the node to move up.\n   * @private\n   */\n  siftDown_(startIndex, index) {\n    const elements = this.elements_;\n    const priorities = this.priorities_;\n    const element = elements[index];\n    const priority = priorities[index];\n\n    while (index > startIndex) {\n      const parentIndex = this.getParentIndex_(index);\n      if (priorities[parentIndex] > priority) {\n        elements[index] = elements[parentIndex];\n        priorities[index] = priorities[parentIndex];\n        index = parentIndex;\n      } else {\n        break;\n      }\n    }\n    elements[index] = element;\n    priorities[index] = priority;\n  }\n\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  reprioritize() {\n    const priorityFunction = this.priorityFunction_;\n    const elements = this.elements_;\n    const priorities = this.priorities_;\n    let index = 0;\n    const n = elements.length;\n    let element, i, priority;\n    for (i = 0; i < n; ++i) {\n      element = elements[i];\n      priority = priorityFunction(element);\n      if (priority == DROP) {\n        delete this.queuedElements_[this.keyFunction_(element)];\n      } else {\n        priorities[index] = priority;\n        elements[index++] = element;\n      }\n    }\n    elements.length = index;\n    priorities.length = index;\n    this.heapify_();\n  }\n\n}\n\n\nexport default PriorityQueue;\n","/**\n * @module ol/featureloader\n */\nimport {VOID} from './functions.js';\nimport FormatType from './format/FormatType.js';\n\n/**\n *\n * @type {boolean}\n * @private\n */\nlet withCredentials = false;\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * load features.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area to be loaded,\n * a `{number}` representing the resolution (map units per pixel) and an\n * {@link module:ol/proj/Projection} for the projection  as\n * arguments. `this` within the function is bound to the\n * {@link module:ol/source/Vector} it's called from.\n *\n * The function is responsible for loading the features and adding them to the\n * source.\n * @typedef {function(this:(import(\"./source/Vector\").default|import(\"./VectorTile.js\").default), import(\"./extent.js\").Extent, number,\n *                    import(\"./proj/Projection.js\").default): void} FeatureLoader\n * @api\n */\n\n\n/**\n * {@link module:ol/source/Vector} sources use a function of this type to\n * get the url to load features from.\n *\n * This function takes an {@link module:ol/extent~Extent} representing the area\n * to be loaded, a `{number}` representing the resolution (map units per pixel)\n * and an {@link module:ol/proj/Projection} for the projection  as\n * arguments and returns a `{string}` representing the URL.\n * @typedef {function(import(\"./extent.js\").Extent, number, import(\"./proj/Projection.js\").default): string} FeatureUrlFunction\n * @api\n */\n\n\n/**\n * @param {string|FeatureUrlFunction} url Feature URL service.\n * @param {import(\"./format/Feature.js\").default} format Feature format.\n * @param {function(this:import(\"./VectorTile.js\").default, Array<import(\"./Feature.js\").default>, import(\"./proj/Projection.js\").default, import(\"./extent.js\").Extent): void|function(this:import(\"./source/Vector\").default, Array<import(\"./Feature.js\").default>): void} success\n *     Function called with the loaded features and optionally with the data\n *     projection. Called with the vector tile or source as `this`.\n * @param {function(this:import(\"./VectorTile.js\").default): void|function(this:import(\"./source/Vector\").default): void} failure\n *     Function called when loading failed. Called with the vector tile or\n *     source as `this`.\n * @return {FeatureLoader} The feature loader.\n */\nexport function loadFeaturesXhr(url, format, success, failure) {\n  return (\n    /**\n     * @param {import(\"./extent.js\").Extent} extent Extent.\n     * @param {number} resolution Resolution.\n     * @param {import(\"./proj/Projection.js\").default} projection Projection.\n     * @this {import(\"./source/Vector\").default|import(\"./VectorTile.js\").default}\n     */\n    function(extent, resolution, projection) {\n      const xhr = new XMLHttpRequest();\n      xhr.open('GET',\n        typeof url === 'function' ? url(extent, resolution, projection) : url,\n        true);\n      if (format.getType() == FormatType.ARRAY_BUFFER) {\n        xhr.responseType = 'arraybuffer';\n      }\n      xhr.withCredentials = withCredentials;\n      /**\n       * @param {Event} event Event.\n       * @private\n       */\n      xhr.onload = function(event) {\n        // status will be 0 for file:// urls\n        if (!xhr.status || xhr.status >= 200 && xhr.status < 300) {\n          const type = format.getType();\n          /** @type {Document|Node|Object|string|undefined} */\n          let source;\n          if (type == FormatType.JSON || type == FormatType.TEXT) {\n            source = xhr.responseText;\n          } else if (type == FormatType.XML) {\n            source = xhr.responseXML;\n            if (!source) {\n              source = new DOMParser().parseFromString(xhr.responseText, 'application/xml');\n            }\n          } else if (type == FormatType.ARRAY_BUFFER) {\n            source = /** @type {ArrayBuffer} */ (xhr.response);\n          }\n          if (source) {\n            success.call(this, format.readFeatures(source, {\n              extent: extent,\n              featureProjection: projection\n            }),\n            format.readProjection(source));\n          } else {\n            failure.call(this);\n          }\n        } else {\n          failure.call(this);\n        }\n      }.bind(this);\n      /**\n       * @private\n       */\n      xhr.onerror = function() {\n        failure.call(this);\n      }.bind(this);\n      xhr.send();\n    }\n  );\n}\n\n\n/**\n * Create an XHR feature loader for a `url` and `format`. The feature loader\n * loads features (with XHR), parses the features, and adds them to the\n * vector source.\n * @param {string|FeatureUrlFunction} url Feature URL service.\n * @param {import(\"./format/Feature.js\").default} format Feature format.\n * @return {FeatureLoader} The feature loader.\n * @api\n */\nexport function xhr(url, format) {\n  return loadFeaturesXhr(url, format,\n    /**\n     * @param {Array<import(\"./Feature.js\").default>} features The loaded features.\n     * @param {import(\"./proj/Projection.js\").default} dataProjection Data\n     * projection.\n     * @this {import(\"./source/Vector\").default|import(\"./VectorTile.js\").default}\n     */\n    function(features, dataProjection) {\n      const sourceOrTile = /** @type {?} */ (this);\n      if (typeof sourceOrTile.addFeatures === 'function') {\n        /** @type {import(\"./source/Vector\").default} */ (sourceOrTile).addFeatures(features);\n      }\n    }, /* FIXME handle error */ VOID);\n}\n\n/**\n * Setter for the withCredentials configuration for the XHR.\n *\n * @param {boolean} xhrWithCredentials The value of withCredentials to set.\n * Compare https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/\n * @api\n */\nexport function setWithCredentials(xhrWithCredentials) {\n  withCredentials = xhrWithCredentials;\n}\n","/**\n * @module ol/geom/Circle\n */\nimport {createOrUpdate, forEachCorner, intersects} from '../extent.js';\nimport GeometryType from './GeometryType.js';\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {deflateCoordinate} from './flat/deflate.js';\nimport {rotate, translate} from './flat/transform.js';\n\n\n/**\n * @classdesc\n * Circle geometry.\n *\n * @api\n */\nclass Circle extends SimpleGeometry {\n\n  /**\n   * @param {!import(\"../coordinate.js\").Coordinate} center Center.\n   *     For internal use, flat coordinates in combination with `opt_layout` and no\n   *     `opt_radius` are also accepted.\n   * @param {number=} opt_radius Radius.\n   * @param {import(\"./GeometryLayout.js\").default=} opt_layout Layout.\n   */\n  constructor(center, opt_radius, opt_layout) {\n    super();\n    if (opt_layout !== undefined && opt_radius === undefined) {\n      this.setFlatCoordinates(opt_layout, center);\n    } else {\n      const radius = opt_radius ? opt_radius : 0;\n      this.setCenterAndRadius(center, radius, opt_layout);\n    }\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!Circle} Clone.\n   * @override\n   * @api\n   */\n  clone() {\n    return new Circle(this.flatCoordinates.slice(), undefined, this.layout);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    const flatCoordinates = this.flatCoordinates;\n    const dx = x - flatCoordinates[0];\n    const dy = y - flatCoordinates[1];\n    const squaredDistance = dx * dx + dy * dy;\n    if (squaredDistance < minSquaredDistance) {\n      if (squaredDistance === 0) {\n        for (let i = 0; i < this.stride; ++i) {\n          closestPoint[i] = flatCoordinates[i];\n        }\n      } else {\n        const delta = this.getRadius() / Math.sqrt(squaredDistance);\n        closestPoint[0] = flatCoordinates[0] + delta * dx;\n        closestPoint[1] = flatCoordinates[1] + delta * dy;\n        for (let i = 2; i < this.stride; ++i) {\n          closestPoint[i] = flatCoordinates[i];\n        }\n      }\n      closestPoint.length = this.stride;\n      return squaredDistance;\n    } else {\n      return minSquaredDistance;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  containsXY(x, y) {\n    const flatCoordinates = this.flatCoordinates;\n    const dx = x - flatCoordinates[0];\n    const dy = y - flatCoordinates[1];\n    return dx * dx + dy * dy <= this.getRadiusSquared_();\n  }\n\n  /**\n   * Return the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n   * @return {import(\"../coordinate.js\").Coordinate} Center.\n   * @api\n   */\n  getCenter() {\n    return this.flatCoordinates.slice(0, this.stride);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  computeExtent(extent) {\n    const flatCoordinates = this.flatCoordinates;\n    const radius = flatCoordinates[this.stride] - flatCoordinates[0];\n    return createOrUpdate(\n      flatCoordinates[0] - radius, flatCoordinates[1] - radius,\n      flatCoordinates[0] + radius, flatCoordinates[1] + radius,\n      extent);\n  }\n\n  /**\n   * Return the radius of the circle.\n   * @return {number} Radius.\n   * @api\n   */\n  getRadius() {\n    return Math.sqrt(this.getRadiusSquared_());\n  }\n\n  /**\n   * @private\n   * @return {number} Radius squared.\n   */\n  getRadiusSquared_() {\n    const dx = this.flatCoordinates[this.stride] - this.flatCoordinates[0];\n    const dy = this.flatCoordinates[this.stride + 1] - this.flatCoordinates[1];\n    return dx * dx + dy * dy;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  getType() {\n    return GeometryType.CIRCLE;\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  intersectsExtent(extent) {\n    const circleExtent = this.getExtent();\n    if (intersects(extent, circleExtent)) {\n      const center = this.getCenter();\n\n      if (extent[0] <= center[0] && extent[2] >= center[0]) {\n        return true;\n      }\n      if (extent[1] <= center[1] && extent[3] >= center[1]) {\n        return true;\n      }\n\n      return forEachCorner(extent, this.intersectsCoordinate.bind(this));\n    }\n    return false;\n\n  }\n\n  /**\n   * Set the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n   * @param {import(\"../coordinate.js\").Coordinate} center Center.\n   * @api\n   */\n  setCenter(center) {\n    const stride = this.stride;\n    const radius = this.flatCoordinates[stride] - this.flatCoordinates[0];\n    const flatCoordinates = center.slice();\n    flatCoordinates[stride] = flatCoordinates[0] + radius;\n    for (let i = 1; i < stride; ++i) {\n      flatCoordinates[stride + i] = center[i];\n    }\n    this.setFlatCoordinates(this.layout, flatCoordinates);\n    this.changed();\n  }\n\n  /**\n   * Set the center (as {@link module:ol/coordinate~Coordinate coordinate}) and the radius (as\n   * number) of the circle.\n   * @param {!import(\"../coordinate.js\").Coordinate} center Center.\n   * @param {number} radius Radius.\n   * @param {import(\"./GeometryLayout.js\").default=} opt_layout Layout.\n   * @api\n   */\n  setCenterAndRadius(center, radius, opt_layout) {\n    this.setLayout(opt_layout, center, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    /** @type {Array<number>} */\n    const flatCoordinates = this.flatCoordinates;\n    let offset = deflateCoordinate(\n      flatCoordinates, 0, center, this.stride);\n    flatCoordinates[offset++] = flatCoordinates[0] + radius;\n    for (let i = 1, ii = this.stride; i < ii; ++i) {\n      flatCoordinates[offset++] = flatCoordinates[i];\n    }\n    flatCoordinates.length = offset;\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getCoordinates() {\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setCoordinates(coordinates, opt_layout) {}\n\n  /**\n   * Set the radius of the circle. The radius is in the units of the projection.\n   * @param {number} radius Radius.\n   * @api\n   */\n  setRadius(radius) {\n    this.flatCoordinates[this.stride] = this.flatCoordinates[0] + radius;\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  rotate(angle, anchor) {\n    const center = this.getCenter();\n    const stride = this.getStride();\n    this.setCenter(rotate(center, 0, center.length, stride, angle, anchor, center));\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  translate(deltaX, deltaY) {\n    const center = this.getCenter();\n    const stride = this.getStride();\n    this.setCenter(translate(center, 0, center.length, stride, deltaX, deltaY, center));\n    this.changed();\n  }\n\n}\n\n\n/**\n * Transform each coordinate of the circle from one coordinate reference system\n * to another. The geometry is modified in place.\n * If you do not want the geometry modified in place, first clone() it and\n * then use this function on the clone.\n *\n * Internally a circle is currently represented by two points: the center of\n * the circle `[cx, cy]`, and the point to the right of the circle\n * `[cx + r, cy]`. This `transform` function just transforms these two points.\n * So the resulting geometry is also a circle, and that circle does not\n * correspond to the shape that would be obtained by transforming every point\n * of the original circle.\n *\n * @param {import(\"../proj.js\").ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {import(\"../proj.js\").ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {Circle} This geometry.  Note that original geometry is\n *     modified in place.\n * @function\n * @api\n */\nCircle.prototype.transform;\nexport default Circle;\n","/**\n * @module ol/interaction/DragRotateAndZoom\n */\nimport {shiftKeyOnly, mouseOnly} from '../events/condition.js';\nimport PointerInteraction from './Pointer.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition~shiftKeyOnly}.\n * @property {number} [duration=400] Animation duration in milliseconds.\n */\n\n\n/**\n * @classdesc\n * Allows the user to zoom and rotate the map by clicking and dragging\n * on the map.  By default, this interaction is limited to when the shift\n * key is held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * And this interaction is not included in the default interactions.\n * @api\n */\nclass DragRotateAndZoom extends PointerInteraction {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super(/** @type {import(\"./Pointer.js\").Options} */ (options));\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : shiftKeyOnly;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastAngle_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastMagnitude_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.lastScaleDelta_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 400;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDragEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return;\n    }\n\n    const map = mapBrowserEvent.map;\n    const size = map.getSize();\n    const offset = mapBrowserEvent.pixel;\n    const deltaX = offset[0] - size[0] / 2;\n    const deltaY = size[1] / 2 - offset[1];\n    const theta = Math.atan2(deltaY, deltaX);\n    const magnitude = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n    const view = map.getView();\n    if (this.lastAngle_ !== undefined) {\n      const angleDelta = this.lastAngle_ - theta;\n      view.adjustRotationInternal(angleDelta);\n    }\n    this.lastAngle_ = theta;\n    if (this.lastMagnitude_ !== undefined) {\n      view.adjustResolutionInternal(this.lastMagnitude_ / magnitude);\n    }\n    if (this.lastMagnitude_ !== undefined) {\n      this.lastScaleDelta_ = this.lastMagnitude_ / magnitude;\n    }\n    this.lastMagnitude_ = magnitude;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleUpEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return true;\n    }\n\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    const direction = this.lastScaleDelta_ > 1 ? 1 : -1;\n    view.endInteraction(this.duration_, direction);\n    this.lastScaleDelta_ = 0;\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return false;\n    }\n\n    if (this.condition_(mapBrowserEvent)) {\n      mapBrowserEvent.map.getView().beginInteraction();\n      this.lastAngle_ = undefined;\n      this.lastMagnitude_ = undefined;\n      return true;\n    } else {\n      return false;\n    }\n  }\n}\n\nexport default DragRotateAndZoom;\n","/**\n * @module ol/control/FullScreen\n */\nimport Control from './Control.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_UNSUPPORTED} from '../css.js';\nimport {replaceNode} from '../dom.js';\nimport {listen} from '../events.js';\nimport EventType from '../events/EventType.js';\n\nconst events = ['fullscreenchange', 'webkitfullscreenchange', 'MSFullscreenChange'];\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-full-screen'] CSS class name.\n * @property {string|Text} [label='\\u2922'] Text label to use for the button.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string|Text} [labelActive='\\u00d7'] Text label to use for the\n * button when full-screen is active.\n * Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {string} [tipLabel='Toggle full-screen'] Text label to use for the button tip.\n * @property {boolean} [keys=false] Full keyboard access.\n * @property {HTMLElement|string} [target] Specify a target if you want the\n * control to be rendered outside of the map's viewport.\n * @property {HTMLElement|string} [source] The element to be displayed\n * fullscreen. When not provided, the element containing the map viewport will\n * be displayed fullscreen.\n */\n\n\n/**\n * @classdesc\n * Provides a button that when clicked fills up the full screen with the map.\n * The full screen source element is by default the element containing the map viewport unless\n * overridden by providing the `source` option. In which case, the dom\n * element introduced using this parameter will be displayed in full screen.\n *\n * When in full screen mode, a close button is shown to exit full screen mode.\n * The [Fullscreen API](http://www.w3.org/TR/fullscreen/) is used to\n * toggle the map in full screen mode.\n *\n * @api\n */\nclass FullScreen extends Control {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      element: document.createElement('div'),\n      target: options.target\n    });\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.cssClassName_ = options.className !== undefined ? options.className :\n      'ol-full-screen';\n\n    const label = options.label !== undefined ? options.label : '\\u2922';\n\n    /**\n     * @private\n     * @type {Text}\n     */\n    this.labelNode_ = typeof label === 'string' ?\n      document.createTextNode(label) : label;\n\n    const labelActive = options.labelActive !== undefined ? options.labelActive : '\\u00d7';\n\n    /**\n     * @private\n     * @type {Text}\n     */\n    this.labelActiveNode_ = typeof labelActive === 'string' ?\n      document.createTextNode(labelActive) : labelActive;\n\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this.button_ = document.createElement('button');\n\n    const tipLabel = options.tipLabel ? options.tipLabel : 'Toggle full-screen';\n    this.setClassName_(this.button_, isFullScreen());\n    this.button_.setAttribute('type', 'button');\n    this.button_.title = tipLabel;\n    this.button_.appendChild(this.labelNode_);\n\n    this.button_.addEventListener(EventType.CLICK, this.handleClick_.bind(this), false);\n\n    const cssClasses = this.cssClassName_ + ' ' + CLASS_UNSELECTABLE +\n        ' ' + CLASS_CONTROL + ' ' +\n        (!isFullScreenSupported() ? CLASS_UNSUPPORTED : '');\n    const element = this.element;\n    element.className = cssClasses;\n    element.appendChild(this.button_);\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.keys_ = options.keys !== undefined ? options.keys : false;\n\n    /**\n     * @private\n     * @type {HTMLElement|string|undefined}\n     */\n    this.source_ = options.source;\n\n  }\n\n  /**\n   * @param {MouseEvent} event The event to handle\n   * @private\n   */\n  handleClick_(event) {\n    event.preventDefault();\n    this.handleFullScreen_();\n  }\n\n  /**\n   * @private\n   */\n  handleFullScreen_() {\n    if (!isFullScreenSupported()) {\n      return;\n    }\n    const map = this.getMap();\n    if (!map) {\n      return;\n    }\n    if (isFullScreen()) {\n      exitFullScreen();\n    } else {\n      let element;\n      if (this.source_) {\n        element = typeof this.source_ === 'string' ?\n          document.getElementById(this.source_) :\n          this.source_;\n      } else {\n        element = map.getTargetElement();\n      }\n      if (this.keys_) {\n        requestFullScreenWithKeys(element);\n\n      } else {\n        requestFullScreen(element);\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  handleFullScreenChange_() {\n    const map = this.getMap();\n    if (isFullScreen()) {\n      this.setClassName_(this.button_, true);\n      replaceNode(this.labelActiveNode_, this.labelNode_);\n    } else {\n      this.setClassName_(this.button_, false);\n      replaceNode(this.labelNode_, this.labelActiveNode_);\n    }\n    if (map) {\n      map.updateSize();\n    }\n  }\n\n  /**\n   * @param {HTMLElement} element Target element\n   * @param {boolean} fullscreen True if fullscreen class name should be active\n   * @private\n   */\n  setClassName_(element, fullscreen) {\n    const activeClassName = this.cssClassName_ + '-true';\n    const inactiveClassName = this.cssClassName_ + '-false';\n    const nextClassName = fullscreen ? activeClassName : inactiveClassName;\n    element.classList.remove(activeClassName);\n    element.classList.remove(inactiveClassName);\n    element.classList.add(nextClassName);\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  setMap(map) {\n    super.setMap(map);\n    if (map) {\n      for (let i = 0, ii = events.length; i < ii; ++i) {\n        this.listenerKeys.push(\n          listen(document, events[i], this.handleFullScreenChange_, this));\n      }\n    }\n  }\n}\n\n\n/**\n * @return {boolean} Fullscreen is supported by the current platform.\n */\nfunction isFullScreenSupported() {\n  const body = document.body;\n  return !!(\n    body.webkitRequestFullscreen ||\n    (body.msRequestFullscreen && document.msFullscreenEnabled) ||\n    (body.requestFullscreen && document.fullscreenEnabled)\n  );\n}\n\n/**\n * @return {boolean} Element is currently in fullscreen.\n */\nfunction isFullScreen() {\n  return !!(\n    document.webkitIsFullScreen || document.msFullscreenElement || document.fullscreenElement\n  );\n}\n\n/**\n * Request to fullscreen an element.\n * @param {HTMLElement} element Element to request fullscreen\n */\nfunction requestFullScreen(element) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  }\n}\n\n/**\n * Request to fullscreen an element with keyboard input.\n * @param {HTMLElement} element Element to request fullscreen\n */\nfunction requestFullScreenWithKeys(element) {\n  if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else {\n    requestFullScreen(element);\n  }\n}\n\n/**\n * Exit fullscreen.\n */\nfunction exitFullScreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  }\n}\n\nexport default FullScreen;\n","/**\n * @module ol/format/GML2\n */\nimport {createOrUpdate} from '../extent.js';\nimport {transformExtentWithOptions, transformGeometryWithOptions} from './Feature.js';\nimport GMLBase, {GMLNS} from './GMLBase.js';\nimport {writeStringTextNode} from './xsd.js';\nimport {assign} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\nimport {createElementNS, getAllTextContent, makeArrayPusher, makeChildAppender,\n  makeReplacer, makeSimpleNodeFactory, OBJECT_PROPERTY_NODE_FACTORY, pushParseAndPop, pushSerializeAndPop} from '../xml.js';\n\n\n/**\n * @const\n * @type {string}\n */\nconst schemaLocation = GMLNS + ' http://schemas.opengis.net/gml/2.1.2/feature.xsd';\n\n\n/**\n * @const\n * @type {Object<string, string>}\n */\nconst MULTIGEOMETRY_TO_MEMBER_NODENAME = {\n  'MultiLineString': 'lineStringMember',\n  'MultiCurve': 'curveMember',\n  'MultiPolygon': 'polygonMember',\n  'MultiSurface': 'surfaceMember'\n};\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GML format,\n * version 2.1.2.\n *\n * @api\n */\nclass GML2 extends GMLBase {\n\n  /**\n   * @param {import(\"./GMLBase.js\").Options=} opt_options Optional configuration object.\n   */\n  constructor(opt_options) {\n    const options = /** @type {import(\"./GMLBase.js\").Options} */\n        (opt_options ? opt_options : {});\n\n    super(options);\n\n    this.FEATURE_COLLECTION_PARSERS[GMLNS][\n      'featureMember'] =\n        makeArrayPusher(this.readFeaturesInternal);\n\n    /**\n     * @inheritDoc\n     */\n    this.schemaLocation = options.schemaLocation ?\n      options.schemaLocation : schemaLocation;\n\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {Array<number>|undefined} Flat coordinates.\n   */\n  readFlatCoordinates_(node, objectStack) {\n    const s = getAllTextContent(node, false).replace(/^\\s*|\\s*$/g, '');\n    const context = /** @type {import(\"../xml.js\").NodeStackItem} */ (objectStack[0]);\n    const containerSrs = context['srsName'];\n    let axisOrientation = 'enu';\n    if (containerSrs) {\n      const proj = getProjection(containerSrs);\n      if (proj) {\n        axisOrientation = proj.getAxisOrientation();\n      }\n    }\n    const coordsGroups = s.trim().split(/\\s+/);\n    const flatCoordinates = [];\n    for (let i = 0, ii = coordsGroups.length; i < ii; i++) {\n      const coords = coordsGroups[i].split(/,+/);\n      const x = parseFloat(coords[0]);\n      const y = parseFloat(coords[1]);\n      const z = (coords.length === 3) ? parseFloat(coords[2]) : 0;\n      if (axisOrientation.substr(0, 2) === 'en') {\n        flatCoordinates.push(x, y, z);\n      } else {\n        flatCoordinates.push(y, x, z);\n      }\n    }\n    return flatCoordinates;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   * @return {import(\"../extent.js\").Extent|undefined} Envelope.\n   */\n  readBox_(node, objectStack) {\n    /** @type {Array<number>} */\n    const flatCoordinates = pushParseAndPop([null],\n      this.BOX_PARSERS_, node, objectStack, this);\n    return createOrUpdate(flatCoordinates[1][0],\n      flatCoordinates[1][1], flatCoordinates[1][3],\n      flatCoordinates[1][4]);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  innerBoundaryIsParser_(node, objectStack) {\n    /** @type {Array<number>|undefined} */\n    const flatLinearRing = pushParseAndPop(undefined,\n      this.RING_PARSERS, node, objectStack, this);\n    if (flatLinearRing) {\n      const flatLinearRings = /** @type {Array<Array<number>>} */\n          (objectStack[objectStack.length - 1]);\n      flatLinearRings.push(flatLinearRing);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {Array<*>} objectStack Object stack.\n   * @private\n   */\n  outerBoundaryIsParser_(node, objectStack) {\n    /** @type {Array<number>|undefined} */\n    const flatLinearRing = pushParseAndPop(undefined,\n      this.RING_PARSERS, node, objectStack, this);\n    if (flatLinearRing) {\n      const flatLinearRings = /** @type {Array<Array<number>>} */\n          (objectStack[objectStack.length - 1]);\n      flatLinearRings[0] = flatLinearRing;\n    }\n  }\n\n  /**\n   * @const\n   * @param {*} value Value.\n   * @param {Array<*>} objectStack Object stack.\n   * @param {string=} opt_nodeName Node name.\n   * @return {Element|undefined} Node.\n   * @private\n   */\n  GEOMETRY_NODE_FACTORY_(value, objectStack, opt_nodeName) {\n    const context = objectStack[objectStack.length - 1];\n    const multiSurface = context['multiSurface'];\n    const surface = context['surface'];\n    const multiCurve = context['multiCurve'];\n    let nodeName;\n    if (!Array.isArray(value)) {\n      nodeName = /** @type {import(\"../geom/Geometry.js\").default} */ (value).getType();\n      if (nodeName === 'MultiPolygon' && multiSurface === true) {\n        nodeName = 'MultiSurface';\n      } else if (nodeName === 'Polygon' && surface === true) {\n        nodeName = 'Surface';\n      } else if (nodeName === 'MultiLineString' && multiCurve === true) {\n        nodeName = 'MultiCurve';\n      }\n    } else {\n      nodeName = 'Envelope';\n    }\n    return createElementNS('http://www.opengis.net/gml',\n      nodeName);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {Array<*>} objectStack Node stack.\n   */\n  writeFeatureElement(node, feature, objectStack) {\n    const fid = feature.getId();\n    if (fid) {\n      node.setAttribute('fid', /** @type {string} */ (fid));\n    }\n    const context = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n    const featureNS = context['featureNS'];\n    const geometryName = feature.getGeometryName();\n    if (!context.serializers) {\n      context.serializers = {};\n      context.serializers[featureNS] = {};\n    }\n    const properties = feature.getProperties();\n    const keys = [];\n    const values = [];\n    for (const key in properties) {\n      const value = properties[key];\n      if (value !== null) {\n        keys.push(key);\n        values.push(value);\n        if (key == geometryName || typeof /** @type {?} */ (value).getSimplifiedGeometry === 'function') {\n          if (!(key in context.serializers[featureNS])) {\n            context.serializers[featureNS][key] = makeChildAppender(\n              this.writeGeometryElement, this);\n          }\n        } else {\n          if (!(key in context.serializers[featureNS])) {\n            context.serializers[featureNS][key] = makeChildAppender(writeStringTextNode);\n          }\n        }\n      }\n    }\n    const item = assign({}, context);\n    item.node = node;\n    pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */\n      (item), context.serializers,\n      makeSimpleNodeFactory(undefined, featureNS),\n      values,\n      objectStack, keys);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/LineString.js\").default} geometry LineString geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeCurveOrLineString_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const srsName = context['srsName'];\n    if (node.nodeName !== 'LineStringSegment' && srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    if (node.nodeName === 'LineString' ||\n        node.nodeName === 'LineStringSegment') {\n      const coordinates = this.createCoordinatesNode_(node.namespaceURI);\n      node.appendChild(coordinates);\n      this.writeCoordinates_(coordinates, geometry, objectStack);\n    } else if (node.nodeName === 'Curve') {\n      const segments = createElementNS(node.namespaceURI, 'segments');\n      node.appendChild(segments);\n      this.writeCurveSegments_(segments,\n        geometry, objectStack);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/LineString.js\").default} line LineString geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeLineStringOrCurveMember_(node, line, objectStack) {\n    const child = this.GEOMETRY_NODE_FACTORY_(line, objectStack);\n    if (child) {\n      node.appendChild(child);\n      this.writeCurveOrLineString_(child, line, objectStack);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/MultiLineString.js\").default} geometry MultiLineString geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeMultiCurveOrLineString_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const hasZ = context['hasZ'];\n    const srsName = context['srsName'];\n    const curve = context['curve'];\n    if (srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    const lines = geometry.getLineStrings();\n    pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName, curve: curve},\n      this.LINESTRINGORCURVEMEMBER_SERIALIZERS_,\n      this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_, lines,\n      objectStack, undefined, this);\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/Geometry.js\").default|import(\"../extent.js\").Extent} geometry Geometry.\n   * @param {Array<*>} objectStack Node stack.\n   */\n  writeGeometryElement(node, geometry, objectStack) {\n    const context = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[objectStack.length - 1]);\n    const item = assign({}, context);\n    item['node'] = node;\n    let value;\n    if (Array.isArray(geometry)) {\n      value = transformExtentWithOptions(/** @type {import(\"../extent.js\").Extent} */ (geometry), context);\n    } else {\n      value = transformGeometryWithOptions(/** @type {import(\"../geom/Geometry.js\").default} */ (geometry), true, context);\n    }\n    pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */\n      (item), this.GEOMETRY_SERIALIZERS_,\n      this.GEOMETRY_NODE_FACTORY_, [value],\n      objectStack, undefined, this);\n  }\n\n  /**\n   * @param {string} namespaceURI XML namespace.\n   * @returns {Element} coordinates node.\n   * @private\n   */\n  createCoordinatesNode_(namespaceURI) {\n    const coordinates = createElementNS(namespaceURI, 'coordinates');\n    coordinates.setAttribute('decimal', '.');\n    coordinates.setAttribute('cs', ',');\n    coordinates.setAttribute('ts', ' ');\n\n    return coordinates;\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/LineString.js\").default|import(\"../geom/LinearRing.js\").default} value Geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeCoordinates_(node, value, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const hasZ = context['hasZ'];\n    const srsName = context['srsName'];\n    // only 2d for simple features profile\n    const points = value.getCoordinates();\n    const len = points.length;\n    const parts = new Array(len);\n    for (let i = 0; i < len; ++i) {\n      const point = points[i];\n      parts[i] = this.getCoords_(point, srsName, hasZ);\n    }\n    writeStringTextNode(node, parts.join(' '));\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/LineString.js\").default} line LineString geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeCurveSegments_(node, line, objectStack) {\n    const child = createElementNS(node.namespaceURI, 'LineStringSegment');\n    node.appendChild(child);\n    this.writeCurveOrLineString_(child, line, objectStack);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/Polygon.js\").default} geometry Polygon geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeSurfaceOrPolygon_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const hasZ = context['hasZ'];\n    const srsName = context['srsName'];\n    if (node.nodeName !== 'PolygonPatch' && srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    if (node.nodeName === 'Polygon' || node.nodeName === 'PolygonPatch') {\n      const rings = geometry.getLinearRings();\n      pushSerializeAndPop(\n        {node: node, hasZ: hasZ, srsName: srsName},\n        this.RING_SERIALIZERS_,\n        this.RING_NODE_FACTORY_,\n        rings, objectStack, undefined, this);\n    } else if (node.nodeName === 'Surface') {\n      const patches = createElementNS(node.namespaceURI, 'patches');\n      node.appendChild(patches);\n      this.writeSurfacePatches_(\n        patches, geometry, objectStack);\n    }\n  }\n\n  /**\n   * @param {*} value Value.\n   * @param {Array<*>} objectStack Object stack.\n   * @param {string=} opt_nodeName Node name.\n   * @return {Node} Node.\n   * @private\n   */\n  RING_NODE_FACTORY_(value, objectStack, opt_nodeName) {\n    const context = objectStack[objectStack.length - 1];\n    const parentNode = context.node;\n    const exteriorWritten = context['exteriorWritten'];\n    if (exteriorWritten === undefined) {\n      context['exteriorWritten'] = true;\n    }\n    return createElementNS(parentNode.namespaceURI,\n      exteriorWritten !== undefined ? 'innerBoundaryIs' : 'outerBoundaryIs');\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/Polygon.js\").default} polygon Polygon geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeSurfacePatches_(node, polygon, objectStack) {\n    const child = createElementNS(node.namespaceURI, 'PolygonPatch');\n    node.appendChild(child);\n    this.writeSurfaceOrPolygon_(child, polygon, objectStack);\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/LinearRing.js\").default} ring LinearRing geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeRing_(node, ring, objectStack) {\n    const linearRing = createElementNS(node.namespaceURI, 'LinearRing');\n    node.appendChild(linearRing);\n    this.writeLinearRing_(linearRing, ring, objectStack);\n  }\n\n  /**\n   * @param {Array<number>} point Point geometry.\n   * @param {string=} opt_srsName Optional srsName\n   * @param {boolean=} opt_hasZ whether the geometry has a Z coordinate (is 3D) or not.\n   * @return {string} The coords string.\n   * @private\n   */\n  getCoords_(point, opt_srsName, opt_hasZ) {\n    let axisOrientation = 'enu';\n    if (opt_srsName) {\n      axisOrientation = getProjection(opt_srsName).getAxisOrientation();\n    }\n    let coords = ((axisOrientation.substr(0, 2) === 'en') ?\n      point[0] + ',' + point[1] :\n      point[1] + ',' + point[0]);\n    if (opt_hasZ) {\n      // For newly created points, Z can be undefined.\n      const z = point[2] || 0;\n      coords += ',' + z;\n    }\n\n    return coords;\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/Point.js\").default} geometry Point geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writePoint_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const hasZ = context['hasZ'];\n    const srsName = context['srsName'];\n    if (srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    const coordinates = this.createCoordinatesNode_(node.namespaceURI);\n    node.appendChild(coordinates);\n    const point = geometry.getCoordinates();\n    const coord = this.getCoords_(point, srsName, hasZ);\n    writeStringTextNode(coordinates, coord);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/MultiPoint.js\").default} geometry MultiPoint geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeMultiPoint_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const hasZ = context['hasZ'];\n    const srsName = context['srsName'];\n    if (srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    const points = geometry.getPoints();\n    pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName},\n      this.POINTMEMBER_SERIALIZERS_,\n      makeSimpleNodeFactory('pointMember'), points,\n      objectStack, undefined, this);\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/Point.js\").default} point Point geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writePointMember_(node, point, objectStack) {\n    const child = createElementNS(node.namespaceURI, 'Point');\n    node.appendChild(child);\n    this.writePoint_(child, point, objectStack);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/LinearRing.js\").default} geometry LinearRing geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeLinearRing_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const srsName = context['srsName'];\n    if (srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    const coordinates = this.createCoordinatesNode_(node.namespaceURI);\n    node.appendChild(coordinates);\n    this.writeCoordinates_(coordinates, geometry, objectStack);\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../geom/MultiPolygon.js\").default} geometry MultiPolygon geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeMultiSurfaceOrPolygon_(node, geometry, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const hasZ = context['hasZ'];\n    const srsName = context['srsName'];\n    const surface = context['surface'];\n    if (srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    const polygons = geometry.getPolygons();\n    pushSerializeAndPop({node: node, hasZ: hasZ, srsName: srsName, surface: surface},\n      this.SURFACEORPOLYGONMEMBER_SERIALIZERS_,\n      this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_, polygons,\n      objectStack, undefined, this);\n  }\n\n  /**\n   * @param {Node} node Node.\n   * @param {import(\"../geom/Polygon.js\").default} polygon Polygon geometry.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeSurfaceOrPolygonMember_(node, polygon, objectStack) {\n    const child = this.GEOMETRY_NODE_FACTORY_(\n      polygon, objectStack);\n    if (child) {\n      node.appendChild(child);\n      this.writeSurfaceOrPolygon_(child, polygon, objectStack);\n    }\n  }\n\n  /**\n   * @param {Element} node Node.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {Array<*>} objectStack Node stack.\n   * @private\n   */\n  writeEnvelope(node, extent, objectStack) {\n    const context = objectStack[objectStack.length - 1];\n    const srsName = context['srsName'];\n    if (srsName) {\n      node.setAttribute('srsName', srsName);\n    }\n    const keys = ['lowerCorner', 'upperCorner'];\n    const values = [extent[0] + ' ' + extent[1], extent[2] + ' ' + extent[3]];\n    pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */\n      ({node: node}), this.ENVELOPE_SERIALIZERS_,\n      OBJECT_PROPERTY_NODE_FACTORY,\n      values,\n      objectStack, keys, this);\n  }\n\n  /**\n   * @const\n   * @param {*} value Value.\n   * @param {Array<*>} objectStack Object stack.\n   * @param {string=} opt_nodeName Node name.\n   * @return {Node|undefined} Node.\n   * @private\n   */\n  MULTIGEOMETRY_MEMBER_NODE_FACTORY_(value, objectStack, opt_nodeName) {\n    const parentNode = objectStack[objectStack.length - 1].node;\n    return createElementNS('http://www.opengis.net/gml',\n      MULTIGEOMETRY_TO_MEMBER_NODENAME[parentNode.nodeName]);\n  }\n}\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGML2.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'coordinates': makeReplacer(GML2.prototype.readFlatCoordinates_)\n  }\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGML2.prototype.FLAT_LINEAR_RINGS_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'innerBoundaryIs': GML2.prototype.innerBoundaryIsParser_,\n    'outerBoundaryIs': GML2.prototype.outerBoundaryIsParser_\n  }\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @private\n */\nGML2.prototype.BOX_PARSERS_ = {\n  'http://www.opengis.net/gml': {\n    'coordinates': makeArrayPusher(\n      GML2.prototype.readFlatCoordinates_)\n  }\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n * @protected\n */\nGML2.prototype.GEOMETRY_PARSERS = {\n  'http://www.opengis.net/gml': {\n    'Point': makeReplacer(GMLBase.prototype.readPoint),\n    'MultiPoint': makeReplacer(\n      GMLBase.prototype.readMultiPoint),\n    'LineString': makeReplacer(\n      GMLBase.prototype.readLineString),\n    'MultiLineString': makeReplacer(\n      GMLBase.prototype.readMultiLineString),\n    'LinearRing': makeReplacer(\n      GMLBase.prototype.readLinearRing),\n    'Polygon': makeReplacer(GMLBase.prototype.readPolygon),\n    'MultiPolygon': makeReplacer(\n      GMLBase.prototype.readMultiPolygon),\n    'Box': makeReplacer(GML2.prototype.readBox_)\n  }\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n * @private\n */\nGML2.prototype.GEOMETRY_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'Curve': makeChildAppender(\n      GML2.prototype.writeCurveOrLineString_),\n    'MultiCurve': makeChildAppender(\n      GML2.prototype.writeMultiCurveOrLineString_),\n    'Point': makeChildAppender(GML2.prototype.writePoint_),\n    'MultiPoint': makeChildAppender(\n      GML2.prototype.writeMultiPoint_),\n    'LineString': makeChildAppender(\n      GML2.prototype.writeCurveOrLineString_),\n    'MultiLineString': makeChildAppender(\n      GML2.prototype.writeMultiCurveOrLineString_),\n    'LinearRing': makeChildAppender(\n      GML2.prototype.writeLinearRing_),\n    'Polygon': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygon_),\n    'MultiPolygon': makeChildAppender(\n      GML2.prototype.writeMultiSurfaceOrPolygon_),\n    'Surface': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygon_),\n    'MultiSurface': makeChildAppender(\n      GML2.prototype.writeMultiSurfaceOrPolygon_),\n    'Envelope': makeChildAppender(\n      GML2.prototype.writeEnvelope)\n  }\n};\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n * @private\n */\nGML2.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'lineStringMember': makeChildAppender(\n      GML2.prototype.writeLineStringOrCurveMember_),\n    'curveMember': makeChildAppender(\n      GML2.prototype.writeLineStringOrCurveMember_)\n  }\n};\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n * @private\n */\nGML2.prototype.RING_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'outerBoundaryIs': makeChildAppender(GML2.prototype.writeRing_),\n    'innerBoundaryIs': makeChildAppender(GML2.prototype.writeRing_)\n  }\n};\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n * @private\n */\nGML2.prototype.POINTMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'pointMember': makeChildAppender(\n      GML2.prototype.writePointMember_)\n  }\n};\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n * @private\n */\nGML2.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'surfaceMember': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygonMember_),\n    'polygonMember': makeChildAppender(\n      GML2.prototype.writeSurfaceOrPolygonMember_)\n  }\n};\n\n/**\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n * @private\n */\nGML2.prototype.ENVELOPE_SERIALIZERS_ = {\n  'http://www.opengis.net/gml': {\n    'lowerCorner': makeChildAppender(writeStringTextNode),\n    'upperCorner': makeChildAppender(writeStringTextNode)\n  }\n};\n\nexport default GML2;\n","/**\n * @module ol/render/Feature\n */\nimport {extend} from '../array.js';\nimport {createOrUpdateFromCoordinate, createOrUpdateFromFlatCoordinates, getCenter, getHeight} from '../extent.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {linearRingss as linearRingssCenter} from '../geom/flat/center.js';\nimport {getInteriorPointOfArray, getInteriorPointsOfMultiArray} from '../geom/flat/interiorpoint.js';\nimport {interpolatePoint} from '../geom/flat/interpolate.js';\nimport {get as getProjection} from '../proj.js';\nimport {transform2D} from '../geom/flat/transform.js';\nimport {create as createTransform, compose as composeTransform} from '../transform.js';\n\n\n/**\n * @type {import(\"../transform.js\").Transform}\n */\nconst tmpTransform = createTransform();\n\n\n/**\n * Lightweight, read-only, {@link module:ol/Feature~Feature} and {@link module:ol/geom/Geometry~Geometry} like\n * structure, optimized for vector tile rendering and styling. Geometry access\n * through the API is limited to getting the type and extent of the geometry.\n */\nclass RenderFeature {\n  /**\n   * @param {GeometryType} type Geometry type.\n   * @param {Array<number>} flatCoordinates Flat coordinates. These always need\n   *     to be right-handed for polygons.\n   * @param {Array<number>|Array<Array<number>>} ends Ends or Endss.\n   * @param {Object<string, *>} properties Properties.\n   * @param {number|string|undefined} id Feature id.\n   */\n  constructor(type, flatCoordinates, ends, properties, id) {\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent|undefined}\n     */\n    this.extent_;\n\n    /**\n     * @private\n     * @type {number|string|undefined}\n     */\n    this.id_ = id;\n\n    /**\n     * @private\n     * @type {GeometryType}\n     */\n    this.type_ = type;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatCoordinates_ = flatCoordinates;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatInteriorPoints_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>}\n     */\n    this.flatMidpoints_ = null;\n\n    /**\n     * @private\n     * @type {Array<number>|Array<Array<number>>}\n     */\n    this.ends_ = ends;\n\n    /**\n     * @private\n     * @type {Object<string, *>}\n     */\n    this.properties_ = properties;\n\n  }\n\n  /**\n   * Get a feature property by its key.\n   * @param {string} key Key\n   * @return {*} Value for the requested key.\n   * @api\n   */\n  get(key) {\n    return this.properties_[key];\n  }\n\n  /**\n   * Get the extent of this feature's geometry.\n   * @return {import(\"../extent.js\").Extent} Extent.\n   * @api\n   */\n  getExtent() {\n    if (!this.extent_) {\n      this.extent_ = this.type_ === GeometryType.POINT ?\n        createOrUpdateFromCoordinate(this.flatCoordinates_) :\n        createOrUpdateFromFlatCoordinates(\n          this.flatCoordinates_, 0, this.flatCoordinates_.length, 2);\n\n    }\n    return this.extent_;\n  }\n\n  /**\n   * @return {Array<number>} Flat interior points.\n   */\n  getFlatInteriorPoint() {\n    if (!this.flatInteriorPoints_) {\n      const flatCenter = getCenter(this.getExtent());\n      this.flatInteriorPoints_ = getInteriorPointOfArray(\n        this.flatCoordinates_, 0, /** @type {Array<number>} */ (this.ends_), 2, flatCenter, 0);\n    }\n    return this.flatInteriorPoints_;\n  }\n\n  /**\n   * @return {Array<number>} Flat interior points.\n   */\n  getFlatInteriorPoints() {\n    if (!this.flatInteriorPoints_) {\n      const flatCenters = linearRingssCenter(\n        this.flatCoordinates_, 0, /** @type {Array<Array<number>>} */ (this.ends_), 2);\n      this.flatInteriorPoints_ = getInteriorPointsOfMultiArray(\n        this.flatCoordinates_, 0, /** @type {Array<Array<number>>} */ (this.ends_), 2, flatCenters);\n    }\n    return this.flatInteriorPoints_;\n  }\n\n  /**\n   * @return {Array<number>} Flat midpoint.\n   */\n  getFlatMidpoint() {\n    if (!this.flatMidpoints_) {\n      this.flatMidpoints_ = interpolatePoint(\n        this.flatCoordinates_, 0, this.flatCoordinates_.length, 2, 0.5);\n    }\n    return this.flatMidpoints_;\n  }\n\n  /**\n   * @return {Array<number>} Flat midpoints.\n   */\n  getFlatMidpoints() {\n    if (!this.flatMidpoints_) {\n      this.flatMidpoints_ = [];\n      const flatCoordinates = this.flatCoordinates_;\n      let offset = 0;\n      const ends = /** @type {Array<number>} */ (this.ends_);\n      for (let i = 0, ii = ends.length; i < ii; ++i) {\n        const end = ends[i];\n        const midpoint = interpolatePoint(\n          flatCoordinates, offset, end, 2, 0.5);\n        extend(this.flatMidpoints_, midpoint);\n        offset = end;\n      }\n    }\n    return this.flatMidpoints_;\n  }\n\n  /**\n   * Get the feature identifier.  This is a stable identifier for the feature and\n   * is set when reading data from a remote source.\n   * @return {number|string|undefined} Id.\n   * @api\n   */\n  getId() {\n    return this.id_;\n  }\n\n  /**\n   * @return {Array<number>} Flat coordinates.\n   */\n  getOrientedFlatCoordinates() {\n    return this.flatCoordinates_;\n  }\n\n  /**\n   * For API compatibility with {@link module:ol/Feature~Feature}, this method is useful when\n   * determining the geometry type in style function (see {@link #getType}).\n   * @return {RenderFeature} Feature.\n   * @api\n   */\n  getGeometry() {\n    return this;\n  }\n\n  /**\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {RenderFeature} Simplified geometry.\n   */\n  getSimplifiedGeometry(squaredTolerance) {\n    return this;\n  }\n\n  /**\n   * Get a transformed and simplified version of the geometry.\n   * @abstract\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../proj.js\").TransformFunction} [opt_transform] Optional transform function.\n   * @return {RenderFeature} Simplified geometry.\n   */\n  simplifyTransformed(squaredTolerance, opt_transform) {\n    return this;\n  }\n\n  /**\n   * Get the feature properties.\n   * @return {Object<string, *>} Feature properties.\n   * @api\n   */\n  getProperties() {\n    return this.properties_;\n  }\n\n  /**\n   * @return {number} Stride.\n   */\n  getStride() {\n    return 2;\n  }\n\n  /**\n   * @return {undefined}\n   */\n  getStyleFunction() {\n    return undefined;\n  }\n\n  /**\n   * Get the type of this feature's geometry.\n   * @return {GeometryType} Geometry type.\n   * @api\n   */\n  getType() {\n    return this.type_;\n  }\n\n  /**\n   * Transform geometry coordinates from tile pixel space to projected.\n   * The SRS of the source and destination are expected to be the same.\n   *\n   * @param {import(\"../proj.js\").ProjectionLike} source The current projection\n   * @param {import(\"../proj.js\").ProjectionLike} destination The desired projection.\n   */\n  transform(source, destination) {\n    source = getProjection(source);\n    const pixelExtent = source.getExtent();\n    const projectedExtent = source.getWorldExtent();\n    const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n    composeTransform(tmpTransform,\n      projectedExtent[0], projectedExtent[3],\n      scale, -scale, 0,\n      0, 0);\n    transform2D(this.flatCoordinates_, 0, this.flatCoordinates_.length, 2,\n      tmpTransform, this.flatCoordinates_);\n  }\n}\n\n\n/**\n * @return {Array<number>|Array<Array<number>>} Ends or endss.\n */\nRenderFeature.prototype.getEnds =\nRenderFeature.prototype.getEndss = function() {\n  return this.ends_;\n};\n\n\n/**\n * @return {Array<number>} Flat coordinates.\n */\nRenderFeature.prototype.getFlatCoordinates =\n    RenderFeature.prototype.getOrientedFlatCoordinates;\n\n\nexport default RenderFeature;\n","/**\n * @module ol/AssertionError\n */\nimport {VERSION} from './util.js';\n\n/**\n * Error object thrown when an assertion failed. This is an ECMA-262 Error,\n * extended with a `code` property.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error.\n */\nclass AssertionError extends Error {\n\n  /**\n   * @param {number} code Error code.\n   */\n  constructor(code) {\n    const path = VERSION === 'latest' ? VERSION : 'v' + VERSION.split('-')[0];\n    const message = 'Assertion failed. See https://openlayers.org/en/' + path +\n    '/doc/errors/#' + code + ' for details.';\n\n    super(message);\n\n    /**\n     * Error code. The meaning of the code can be found on\n     * https://openlayers.org/en/latest/doc/errors/ (replace `latest` with\n     * the version found in the OpenLayers script's header comment if a version\n     * other than the latest is used).\n     * @type {number}\n     * @api\n     */\n    this.code = code;\n\n    /**\n     * @type {string}\n     */\n    this.name = 'AssertionError';\n\n    // Re-assign message, see https://github.com/Rich-Harris/buble/issues/40\n    this.message = message;\n  }\n\n}\n\nexport default AssertionError;\n","/**\n * @module ol/layer/Base\n */\nimport {abstract} from '../util.js';\nimport BaseObject from '../Object.js';\nimport LayerProperty from './Property.js';\nimport {clamp} from '../math.js';\nimport {assign} from '../obj.js';\nimport {assert} from '../asserts.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [minZoom] The minimum view zoom level (exclusive) above which this layer will be\n * visible.\n * @property {number} [maxZoom] The maximum view zoom level (inclusive) at which this layer will\n * be visible.\n */\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Note that with {@link module:ol/layer/Base} and all its subclasses, any property set in\n * the options is set as a {@link module:ol/Object} property on the layer object, so\n * is observable, and has get/set accessors.\n *\n * @api\n */\nclass BaseLayer extends BaseObject {\n  /**\n   * @param {Options} options Layer options.\n   */\n  constructor(options) {\n\n    super();\n\n    /**\n     * @type {Object<string, *>}\n     */\n    const properties = assign({}, options);\n\n    properties[LayerProperty.OPACITY] =\n        options.opacity !== undefined ? options.opacity : 1;\n    assert(typeof properties[LayerProperty.OPACITY] === 'number', 64); // Layer opacity must be a number\n\n    properties[LayerProperty.VISIBLE] =\n       options.visible !== undefined ? options.visible : true;\n    properties[LayerProperty.Z_INDEX] = options.zIndex;\n    properties[LayerProperty.MAX_RESOLUTION] =\n       options.maxResolution !== undefined ? options.maxResolution : Infinity;\n    properties[LayerProperty.MIN_RESOLUTION] =\n       options.minResolution !== undefined ? options.minResolution : 0;\n    properties[LayerProperty.MIN_ZOOM] =\n       options.minZoom !== undefined ? options.minZoom : -Infinity;\n    properties[LayerProperty.MAX_ZOOM] =\n       options.maxZoom !== undefined ? options.maxZoom : Infinity;\n\n    /**\n     * @type {string}\n     * @private\n     */\n    this.className_ = properties.className !== undefined ? options.className : 'ol-layer';\n    delete properties.className;\n\n    this.setProperties(properties);\n\n    /**\n     * @type {import(\"./Layer.js\").State}\n     * @private\n     */\n    this.state_ = null;\n\n  }\n\n  /**\n   * @return {string} CSS class name.\n   */\n  getClassName() {\n    return this.className_;\n  }\n\n  /**\n   * This method is not meant to be called by layers or layer renderers because the state\n   * is incorrect if the layer is included in a layer group.\n   *\n   * @param {boolean=} opt_managed Layer is managed.\n   * @return {import(\"./Layer.js\").State} Layer state.\n   */\n  getLayerState(opt_managed) {\n    /** @type {import(\"./Layer.js\").State} */\n    const state = this.state_ || /** @type {?} */ ({\n      layer: this,\n      managed: opt_managed === undefined ? true : opt_managed,\n      hasOverlay: false\n    });\n    state.opacity = clamp(Math.round(this.getOpacity() * 100) / 100, 0, 1);\n    state.sourceState = this.getSourceState();\n    state.visible = this.getVisible();\n    state.extent = this.getExtent();\n    state.zIndex = this.getZIndex() || (state.managed === false ? Infinity : 0);\n    state.maxResolution = this.getMaxResolution();\n    state.minResolution = Math.max(this.getMinResolution(), 0);\n    state.minZoom = this.getMinZoom();\n    state.maxZoom = this.getMaxZoom();\n    this.state_ = state;\n\n    return state;\n  }\n\n  /**\n   * @abstract\n   * @param {Array<import(\"./Layer.js\").default>=} opt_array Array of layers (to be\n   *     modified in place).\n   * @return {Array<import(\"./Layer.js\").default>} Array of layers.\n   */\n  getLayersArray(opt_array) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {Array<import(\"./Layer.js\").State>=} opt_states Optional list of layer\n   *     states (to be modified in place).\n   * @return {Array<import(\"./Layer.js\").State>} List of layer states.\n   */\n  getLayerStatesArray(opt_states) {\n    return abstract();\n  }\n\n  /**\n   * Return the {@link module:ol/extent~Extent extent} of the layer or `undefined` if it\n   * will be visible regardless of extent.\n   * @return {import(\"../extent.js\").Extent|undefined} The layer extent.\n   * @observable\n   * @api\n   */\n  getExtent() {\n    return (\n      /** @type {import(\"../extent.js\").Extent|undefined} */ (this.get(LayerProperty.EXTENT))\n    );\n  }\n\n  /**\n   * Return the maximum resolution of the layer.\n   * @return {number} The maximum resolution of the layer.\n   * @observable\n   * @api\n   */\n  getMaxResolution() {\n    return /** @type {number} */ (this.get(LayerProperty.MAX_RESOLUTION));\n  }\n\n  /**\n   * Return the minimum resolution of the layer.\n   * @return {number} The minimum resolution of the layer.\n   * @observable\n   * @api\n   */\n  getMinResolution() {\n    return /** @type {number} */ (this.get(LayerProperty.MIN_RESOLUTION));\n  }\n\n  /**\n   * Return the minimum zoom level of the layer.\n   * @return {number} The minimum zoom level of the layer.\n   * @observable\n   * @api\n   */\n  getMinZoom() {\n    return /** @type {number} */ (this.get(LayerProperty.MIN_ZOOM));\n  }\n\n  /**\n   * Return the maximum zoom level of the layer.\n   * @return {number} The maximum zoom level of the layer.\n   * @observable\n   * @api\n   */\n  getMaxZoom() {\n    return /** @type {number} */ (this.get(LayerProperty.MAX_ZOOM));\n  }\n\n  /**\n   * Return the opacity of the layer (between 0 and 1).\n   * @return {number} The opacity of the layer.\n   * @observable\n   * @api\n   */\n  getOpacity() {\n    return /** @type {number} */ (this.get(LayerProperty.OPACITY));\n  }\n\n  /**\n   * @abstract\n   * @return {import(\"../source/State.js\").default} Source state.\n   */\n  getSourceState() {\n    return abstract();\n  }\n\n  /**\n   * Return the visibility of the layer (`true` or `false`).\n   * @return {boolean} The visibility of the layer.\n   * @observable\n   * @api\n   */\n  getVisible() {\n    return /** @type {boolean} */ (this.get(LayerProperty.VISIBLE));\n  }\n\n  /**\n   * Return the Z-index of the layer, which is used to order layers before\n   * rendering. The default Z-index is 0.\n   * @return {number} The Z-index of the layer.\n   * @observable\n   * @api\n   */\n  getZIndex() {\n    return /** @type {number} */ (this.get(LayerProperty.Z_INDEX));\n  }\n\n  /**\n   * Set the extent at which the layer is visible.  If `undefined`, the layer\n   * will be visible at all extents.\n   * @param {import(\"../extent.js\").Extent|undefined} extent The extent of the layer.\n   * @observable\n   * @api\n   */\n  setExtent(extent) {\n    this.set(LayerProperty.EXTENT, extent);\n  }\n\n  /**\n   * Set the maximum resolution at which the layer is visible.\n   * @param {number} maxResolution The maximum resolution of the layer.\n   * @observable\n   * @api\n   */\n  setMaxResolution(maxResolution) {\n    this.set(LayerProperty.MAX_RESOLUTION, maxResolution);\n  }\n\n  /**\n   * Set the minimum resolution at which the layer is visible.\n   * @param {number} minResolution The minimum resolution of the layer.\n   * @observable\n   * @api\n   */\n  setMinResolution(minResolution) {\n    this.set(LayerProperty.MIN_RESOLUTION, minResolution);\n  }\n\n  /**\n   * Set the maximum zoom (exclusive) at which the layer is visible.\n   * Note that the zoom levels for layer visibility are based on the\n   * view zoom level, which may be different from a tile source zoom level.\n   * @param {number} maxZoom The maximum zoom of the layer.\n   * @observable\n   * @api\n   */\n  setMaxZoom(maxZoom) {\n    this.set(LayerProperty.MAX_ZOOM, maxZoom);\n  }\n\n  /**\n   * Set the minimum zoom (inclusive) at which the layer is visible.\n   * Note that the zoom levels for layer visibility are based on the\n   * view zoom level, which may be different from a tile source zoom level.\n   * @param {number} minZoom The minimum zoom of the layer.\n   * @observable\n   * @api\n   */\n  setMinZoom(minZoom) {\n    this.set(LayerProperty.MIN_ZOOM, minZoom);\n  }\n\n  /**\n   * Set the opacity of the layer, allowed values range from 0 to 1.\n   * @param {number} opacity The opacity of the layer.\n   * @observable\n   * @api\n   */\n  setOpacity(opacity) {\n    assert(typeof opacity === 'number', 64); // Layer opacity must be a number\n    this.set(LayerProperty.OPACITY, opacity);\n  }\n\n  /**\n   * Set the visibility of the layer (`true` or `false`).\n   * @param {boolean} visible The visibility of the layer.\n   * @observable\n   * @api\n   */\n  setVisible(visible) {\n    this.set(LayerProperty.VISIBLE, visible);\n  }\n\n  /**\n   * Set Z-index of the layer, which is used to order layers before rendering.\n   * The default Z-index is 0.\n   * @param {number} zindex The z-index of the layer.\n   * @observable\n   * @api\n   */\n  setZIndex(zindex) {\n    this.set(LayerProperty.Z_INDEX, zindex);\n  }\n}\n\n\nexport default BaseLayer;\n","/**\n * @module ol/geom/Geometry\n */\nimport {abstract} from '../util.js';\nimport BaseObject from '../Object.js';\nimport {createEmpty, getHeight, returnOrUpdate} from '../extent.js';\nimport {transform2D} from './flat/transform.js';\nimport {get as getProjection, getTransform} from '../proj.js';\nimport Units from '../proj/Units.js';\nimport {create as createTransform, compose as composeTransform} from '../transform.js';\nimport {memoizeOne} from '../functions.js';\n\n/**\n * @type {import(\"../transform.js\").Transform}\n */\nconst tmpTransform = createTransform();\n\n\n/**\n * @classdesc\n * Abstract base class; normally only used for creating subclasses and not\n * instantiated in apps.\n * Base class for vector geometries.\n *\n * To get notified of changes to the geometry, register a listener for the\n * generic `change` event on your geometry instance.\n *\n * @abstract\n * @api\n */\nclass Geometry extends BaseObject {\n  constructor() {\n\n    super();\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.extent_ = createEmpty();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.extentRevision_ = -1;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.simplifiedGeometryMaxMinSquaredTolerance = 0;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.simplifiedGeometryRevision = 0;\n\n    /**\n     * Get a transformed and simplified version of the geometry.\n     * @abstract\n     * @param {number} revision The geometry revision.\n     * @param {number} squaredTolerance Squared tolerance.\n     * @param {import(\"../proj.js\").TransformFunction} [opt_transform] Optional transform function.\n     * @return {Geometry} Simplified geometry.\n     */\n    this.simplifyTransformedInternal = memoizeOne(function(revision, squaredTolerance, opt_transform) {\n      if (!opt_transform) {\n        return this.getSimplifiedGeometry(squaredTolerance);\n      }\n      const clone = this.clone();\n      clone.applyTransform(opt_transform);\n      return clone.getSimplifiedGeometry(squaredTolerance);\n    });\n\n  }\n\n  /**\n   * Get a transformed and simplified version of the geometry.\n   * @abstract\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../proj.js\").TransformFunction} [opt_transform] Optional transform function.\n   * @return {Geometry} Simplified geometry.\n   */\n  simplifyTransformed(squaredTolerance, opt_transform) {\n    return this.simplifyTransformedInternal(this.getRevision(), squaredTolerance, opt_transform);\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @abstract\n   * @return {!Geometry} Clone.\n   */\n  clone() {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @param {import(\"../coordinate.js\").Coordinate} closestPoint Closest point.\n   * @param {number} minSquaredDistance Minimum squared distance.\n   * @return {number} Minimum squared distance.\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    return abstract();\n  }\n\n  /**\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @return {boolean} Contains (x, y).\n   */\n  containsXY(x, y) {\n    const coord = this.getClosestPoint([x, y]);\n    return coord[0] === x && coord[1] === y;\n  }\n\n  /**\n   * Return the closest point of the geometry to the passed point as\n   * {@link module:ol/coordinate~Coordinate coordinate}.\n   * @param {import(\"../coordinate.js\").Coordinate} point Point.\n   * @param {import(\"../coordinate.js\").Coordinate=} opt_closestPoint Closest point.\n   * @return {import(\"../coordinate.js\").Coordinate} Closest point.\n   * @api\n   */\n  getClosestPoint(point, opt_closestPoint) {\n    const closestPoint = opt_closestPoint ? opt_closestPoint : [NaN, NaN];\n    this.closestPointXY(point[0], point[1], closestPoint, Infinity);\n    return closestPoint;\n  }\n\n  /**\n   * Returns true if this geometry includes the specified coordinate. If the\n   * coordinate is on the boundary of the geometry, returns false.\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @return {boolean} Contains coordinate.\n   * @api\n   */\n  intersectsCoordinate(coordinate) {\n    return this.containsXY(coordinate[0], coordinate[1]);\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @protected\n   * @return {import(\"../extent.js\").Extent} extent Extent.\n   */\n  computeExtent(extent) {\n    return abstract();\n  }\n\n  /**\n   * Get the extent of the geometry.\n   * @param {import(\"../extent.js\").Extent=} opt_extent Extent.\n   * @return {import(\"../extent.js\").Extent} extent Extent.\n   * @api\n   */\n  getExtent(opt_extent) {\n    if (this.extentRevision_ != this.getRevision()) {\n      this.extent_ = this.computeExtent(this.extent_);\n      this.extentRevision_ = this.getRevision();\n    }\n    return returnOrUpdate(this.extent_, opt_extent);\n  }\n\n  /**\n   * Rotate the geometry around a given coordinate. This modifies the geometry\n   * coordinates in place.\n   * @abstract\n   * @param {number} angle Rotation angle in radians.\n   * @param {import(\"../coordinate.js\").Coordinate} anchor The rotation center.\n   * @api\n   */\n  rotate(angle, anchor) {\n    abstract();\n  }\n\n  /**\n   * Scale the geometry (with an optional origin).  This modifies the geometry\n   * coordinates in place.\n   * @abstract\n   * @param {number} sx The scaling factor in the x-direction.\n   * @param {number=} opt_sy The scaling factor in the y-direction (defaults to\n   *     sx).\n   * @param {import(\"../coordinate.js\").Coordinate=} opt_anchor The scale origin (defaults to the center\n   *     of the geometry extent).\n   * @api\n   */\n  scale(sx, opt_sy, opt_anchor) {\n    abstract();\n  }\n\n  /**\n   * Create a simplified version of this geometry.  For linestrings, this uses\n   * the [Douglas Peucker](https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm)\n   * algorithm.  For polygons, a quantization-based\n   * simplification is used to preserve topology.\n   * @param {number} tolerance The tolerance distance for simplification.\n   * @return {Geometry} A new, simplified version of the original geometry.\n   * @api\n   */\n  simplify(tolerance) {\n    return this.getSimplifiedGeometry(tolerance * tolerance);\n  }\n\n  /**\n   * Create a simplified version of this geometry using the Douglas Peucker\n   * algorithm.\n   * See https://en.wikipedia.org/wiki/Ramer-Douglas-Peucker_algorithm.\n   * @abstract\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {Geometry} Simplified geometry.\n   */\n  getSimplifiedGeometry(squaredTolerance) {\n    return abstract();\n  }\n\n  /**\n   * Get the type of this geometry.\n   * @abstract\n   * @return {import(\"./GeometryType.js\").default} Geometry type.\n   */\n  getType() {\n    return abstract();\n  }\n\n  /**\n   * Apply a transform function to each coordinate of the geometry.\n   * The geometry is modified in place.\n   * If you do not want the geometry modified in place, first `clone()` it and\n   * then use this function on the clone.\n   * @abstract\n   * @param {import(\"../proj.js\").TransformFunction} transformFn Transform.\n   */\n  applyTransform(transformFn) {\n    abstract();\n  }\n\n  /**\n   * Test if the geometry and the passed extent intersect.\n   * @abstract\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @return {boolean} `true` if the geometry and the extent intersect.\n   */\n  intersectsExtent(extent) {\n    return abstract();\n  }\n\n  /**\n   * Translate the geometry.  This modifies the geometry coordinates in place.  If\n   * instead you want a new geometry, first `clone()` this geometry.\n   * @abstract\n   * @param {number} deltaX Delta X.\n   * @param {number} deltaY Delta Y.\n   * @api\n   */\n  translate(deltaX, deltaY) {\n    abstract();\n  }\n\n  /**\n   * Transform each coordinate of the geometry from one coordinate reference\n   * system to another. The geometry is modified in place.\n   * For example, a line will be transformed to a line and a circle to a circle.\n   * If you do not want the geometry modified in place, first `clone()` it and\n   * then use this function on the clone.\n   *\n   * @param {import(\"../proj.js\").ProjectionLike} source The current projection.  Can be a\n   *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n   * @param {import(\"../proj.js\").ProjectionLike} destination The desired projection.  Can be a\n   *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n   * @return {Geometry} This geometry.  Note that original geometry is\n   *     modified in place.\n   * @api\n   */\n  transform(source, destination) {\n    /** @type {import(\"../proj/Projection.js\").default} */\n    const sourceProj = getProjection(source);\n    const transformFn = sourceProj.getUnits() == Units.TILE_PIXELS ?\n      function(inCoordinates, outCoordinates, stride) {\n        const pixelExtent = sourceProj.getExtent();\n        const projectedExtent = sourceProj.getWorldExtent();\n        const scale = getHeight(projectedExtent) / getHeight(pixelExtent);\n        composeTransform(tmpTransform,\n          projectedExtent[0], projectedExtent[3],\n          scale, -scale, 0,\n          0, 0);\n        transform2D(inCoordinates, 0, inCoordinates.length, stride,\n          tmpTransform, outCoordinates);\n        return getTransform(sourceProj, destination)(inCoordinates, outCoordinates, stride);\n      } :\n      getTransform(sourceProj, destination);\n    this.applyTransform(transformFn);\n    return this;\n  }\n\n}\n\n\nexport default Geometry;\n","/**\n * @module ol/geom/flat/segments\n */\n\n\n/**\n * This function calls `callback` for each segment of the flat coordinates\n * array. If the callback returns a truthy value the function returns that\n * value immediately. Otherwise the function returns `false`.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @param {function(import(\"../../coordinate.js\").Coordinate, import(\"../../coordinate.js\").Coordinate): T} callback Function\n *     called for each segment.\n * @return {T|boolean} Value.\n * @template T\n */\nexport function forEach(flatCoordinates, offset, end, stride, callback) {\n  const point1 = [flatCoordinates[offset], flatCoordinates[offset + 1]];\n  const point2 = [];\n  let ret;\n  for (; (offset + stride) < end; offset += stride) {\n    point2[0] = flatCoordinates[offset + stride];\n    point2[1] = flatCoordinates[offset + stride + 1];\n    ret = callback(point1, point2);\n    if (ret) {\n      return ret;\n    }\n    point1[0] = point2[0];\n    point1[1] = point2[1];\n  }\n  return false;\n}\n","/**\n * @module ol/structs/LRUCache\n */\n\nimport {assert} from '../asserts.js';\nimport EventTarget from '../events/Target.js';\nimport EventType from '../events/EventType.js';\n\n\n/**\n * @typedef {Object} Entry\n * @property {string} key_\n * @property {Object} newer\n * @property {Object} older\n * @property {*} value_\n */\n\n\n/**\n * @classdesc\n * Implements a Least-Recently-Used cache where the keys do not conflict with\n * Object's properties (e.g. 'hasOwnProperty' is not allowed as a key). Expiring\n * items from the cache is the responsibility of the user.\n *\n * @fires import(\"../events/Event.js\").default\n * @template T\n */\nclass LRUCache extends EventTarget {\n\n  /**\n   * @param {number=} opt_highWaterMark High water mark.\n   */\n  constructor(opt_highWaterMark) {\n\n    super();\n\n    /**\n     * @type {number}\n     */\n    this.highWaterMark = opt_highWaterMark !== undefined ? opt_highWaterMark : 2048;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.count_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string, Entry>}\n     */\n    this.entries_ = {};\n\n    /**\n     * @private\n     * @type {?Entry}\n     */\n    this.oldest_ = null;\n\n    /**\n     * @private\n     * @type {?Entry}\n     */\n    this.newest_ = null;\n\n  }\n\n\n  /**\n   * @return {boolean} Can expire cache.\n   */\n  canExpireCache() {\n    return this.getCount() > this.highWaterMark;\n  }\n\n\n  /**\n   * FIXME empty description for jsdoc\n   */\n  clear() {\n    this.count_ = 0;\n    this.entries_ = {};\n    this.oldest_ = null;\n    this.newest_ = null;\n    this.dispatchEvent(EventType.CLEAR);\n  }\n\n\n  /**\n   * @param {string} key Key.\n   * @return {boolean} Contains key.\n   */\n  containsKey(key) {\n    return this.entries_.hasOwnProperty(key);\n  }\n\n\n  /**\n   * @param {function(T, string, LRUCache<T>): ?} f The function\n   *     to call for every entry from the oldest to the newer. This function takes\n   *     3 arguments (the entry value, the entry key and the LRUCache object).\n   *     The return value is ignored.\n   */\n  forEach(f) {\n    let entry = this.oldest_;\n    while (entry) {\n      f(entry.value_, entry.key_, this);\n      entry = entry.newer;\n    }\n  }\n\n\n  /**\n   * @param {string} key Key.\n   * @param {*=} opt_options Options (reserverd for subclasses).\n   * @return {T} Value.\n   */\n  get(key, opt_options) {\n    const entry = this.entries_[key];\n    assert(entry !== undefined,\n      15); // Tried to get a value for a key that does not exist in the cache\n    if (entry === this.newest_) {\n      return entry.value_;\n    } else if (entry === this.oldest_) {\n      this.oldest_ = /** @type {Entry} */ (this.oldest_.newer);\n      this.oldest_.older = null;\n    } else {\n      entry.newer.older = entry.older;\n      entry.older.newer = entry.newer;\n    }\n    entry.newer = null;\n    entry.older = this.newest_;\n    this.newest_.newer = entry;\n    this.newest_ = entry;\n    return entry.value_;\n  }\n\n\n  /**\n   * Remove an entry from the cache.\n   * @param {string} key The entry key.\n   * @return {T} The removed entry.\n   */\n  remove(key) {\n    const entry = this.entries_[key];\n    assert(entry !== undefined, 15); // Tried to get a value for a key that does not exist in the cache\n    if (entry === this.newest_) {\n      this.newest_ = /** @type {Entry} */ (entry.older);\n      if (this.newest_) {\n        this.newest_.newer = null;\n      }\n    } else if (entry === this.oldest_) {\n      this.oldest_ = /** @type {Entry} */ (entry.newer);\n      if (this.oldest_) {\n        this.oldest_.older = null;\n      }\n    } else {\n      entry.newer.older = entry.older;\n      entry.older.newer = entry.newer;\n    }\n    delete this.entries_[key];\n    --this.count_;\n    return entry.value_;\n  }\n\n\n  /**\n   * @return {number} Count.\n   */\n  getCount() {\n    return this.count_;\n  }\n\n\n  /**\n   * @return {Array<string>} Keys.\n   */\n  getKeys() {\n    const keys = new Array(this.count_);\n    let i = 0;\n    let entry;\n    for (entry = this.newest_; entry; entry = entry.older) {\n      keys[i++] = entry.key_;\n    }\n    return keys;\n  }\n\n\n  /**\n   * @return {Array<T>} Values.\n   */\n  getValues() {\n    const values = new Array(this.count_);\n    let i = 0;\n    let entry;\n    for (entry = this.newest_; entry; entry = entry.older) {\n      values[i++] = entry.value_;\n    }\n    return values;\n  }\n\n\n  /**\n   * @return {T} Last value.\n   */\n  peekLast() {\n    return this.oldest_.value_;\n  }\n\n\n  /**\n   * @return {string} Last key.\n   */\n  peekLastKey() {\n    return this.oldest_.key_;\n  }\n\n\n  /**\n   * Get the key of the newest item in the cache.  Throws if the cache is empty.\n   * @return {string} The newest key.\n   */\n  peekFirstKey() {\n    return this.newest_.key_;\n  }\n\n\n  /**\n   * @return {T} value Value.\n   */\n  pop() {\n    const entry = this.oldest_;\n    delete this.entries_[entry.key_];\n    if (entry.newer) {\n      entry.newer.older = null;\n    }\n    this.oldest_ = /** @type {Entry} */ (entry.newer);\n    if (!this.oldest_) {\n      this.newest_ = null;\n    }\n    --this.count_;\n    return entry.value_;\n  }\n\n\n  /**\n   * @param {string} key Key.\n   * @param {T} value Value.\n   */\n  replace(key, value) {\n    this.get(key); // update `newest_`\n    this.entries_[key].value_ = value;\n  }\n\n\n  /**\n   * @param {string} key Key.\n   * @param {T} value Value.\n   */\n  set(key, value) {\n    assert(!(key in this.entries_),\n      16); // Tried to set a value for a key that is used already\n    const entry = {\n      key_: key,\n      newer: null,\n      older: this.newest_,\n      value_: value\n    };\n    if (!this.newest_) {\n      this.oldest_ = entry;\n    } else {\n      this.newest_.newer = entry;\n    }\n    this.newest_ = entry;\n    this.entries_[key] = entry;\n    ++this.count_;\n  }\n\n\n  /**\n   * Set a maximum number of entries for the cache.\n   * @param {number} size Cache size.\n   * @api\n   */\n  setSize(size) {\n    this.highWaterMark = size;\n  }\n\n}\n\nexport default LRUCache;\n","/**\n * @module ol/render/Event\n */\n\nimport Event from '../events/Event.js';\n\nclass RenderEvent extends Event {\n\n  /**\n   * @param {import(\"./EventType.js\").default} type Type.\n   * @param {import(\"../transform.js\").Transform=} opt_inversePixelTransform Transform for\n   *     CSS pixels to rendered pixels.\n   * @param {import(\"../PluggableMap.js\").FrameState=} opt_frameState Frame state.\n   * @param {?CanvasRenderingContext2D=} opt_context Context.\n   */\n  constructor(type, opt_inversePixelTransform, opt_frameState, opt_context) {\n\n    super(type);\n\n    /**\n     * Transform from CSS pixels (relative to the top-left corner of the map viewport)\n     * to rendered pixels on this event's `context`.\n     * @type {import(\"../transform.js\").Transform|undefined}\n     * @api\n     */\n    this.inversePixelTransform = opt_inversePixelTransform;\n\n    /**\n     * An object representing the current render frame state.\n     * @type {import(\"../PluggableMap.js\").FrameState|undefined}\n     * @api\n     */\n    this.frameState = opt_frameState;\n\n    /**\n     * Canvas context. Only available when a Canvas renderer is used, null\n     * otherwise.\n     * @type {CanvasRenderingContext2D|null|undefined}\n     * @api\n     */\n    this.context = opt_context;\n\n  }\n\n}\n\nexport default RenderEvent;\n","/**\n * @module ol/render/VectorContext\n */\n\n/**\n * @classdesc\n * Context for drawing geometries.  A vector context is available on render\n * events and does not need to be constructed directly.\n * @api\n */\nclass VectorContext {\n  /**\n   * Render a geometry with a custom renderer.\n   *\n   * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   * @param {Function} renderer Renderer.\n   */\n  drawCustom(geometry, feature, renderer) {}\n\n  /**\n   * Render a geometry.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry The geometry to render.\n   */\n  drawGeometry(geometry) {}\n\n  /**\n   * Set the rendering style.\n   *\n   * @param {import(\"../style/Style.js\").default} style The rendering style.\n   */\n  setStyle(style) {}\n\n  /**\n   * @param {import(\"../geom/Circle.js\").default} circleGeometry Circle geometry.\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   */\n  drawCircle(circleGeometry, feature) {}\n\n  /**\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"../style/Style.js\").default} style Style.\n   */\n  drawFeature(feature, style) {}\n\n  /**\n   * @param {import(\"../geom/GeometryCollection.js\").default} geometryCollectionGeometry Geometry collection.\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   */\n  drawGeometryCollection(geometryCollectionGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/LineString.js\").default|import(\"./Feature.js\").default} lineStringGeometry Line string geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawLineString(lineStringGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/MultiLineString.js\").default|import(\"./Feature.js\").default} multiLineStringGeometry MultiLineString geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawMultiLineString(multiLineStringGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/MultiPoint.js\").default|import(\"./Feature.js\").default} multiPointGeometry MultiPoint geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawMultiPoint(multiPointGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/MultiPolygon.js\").default} multiPolygonGeometry MultiPolygon geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawMultiPolygon(multiPolygonGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/Point.js\").default|import(\"./Feature.js\").default} pointGeometry Point geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawPoint(pointGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/Polygon.js\").default|import(\"./Feature.js\").default} polygonGeometry Polygon geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawPolygon(polygonGeometry, feature) {}\n\n  /**\n   * @param {import(\"../geom/Geometry.js\").default|import(\"./Feature.js\").default} geometry Geometry.\n   * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n   */\n  drawText(geometry, feature) {}\n\n  /**\n   * @param {import(\"../style/Fill.js\").default} fillStyle Fill style.\n   * @param {import(\"../style/Stroke.js\").default} strokeStyle Stroke style.\n   */\n  setFillStrokeStyle(fillStyle, strokeStyle) {}\n\n  /**\n   * @param {import(\"../style/Image.js\").default} imageStyle Image style.\n   * @param {import(\"./canvas.js\").DeclutterGroup=} opt_declutterGroup Declutter.\n   */\n  setImageStyle(imageStyle, opt_declutterGroup) {}\n\n  /**\n   * @param {import(\"../style/Text.js\").default} textStyle Text style.\n   * @param {import(\"./canvas.js\").DeclutterGroups=} opt_declutterGroups Declutter.\n   */\n  setTextStyle(textStyle, opt_declutterGroups) {}\n}\n\nexport default VectorContext;\n","/**\n * @module ol/MapBrowserEvent\n */\nimport MapEvent from './MapEvent.js';\n\n/**\n * @classdesc\n * Events emitted as map browser events are instances of this type.\n * See {@link module:ol/PluggableMap~PluggableMap} for which events trigger a map browser event.\n */\nclass MapBrowserEvent extends MapEvent {\n\n  /**\n   * @param {string} type Event type.\n   * @param {import(\"./PluggableMap.js\").default} map Map.\n   * @param {Event} browserEvent Browser event.\n   * @param {boolean=} opt_dragging Is the map currently being dragged?\n   * @param {?import(\"./PluggableMap.js\").FrameState=} opt_frameState Frame state.\n   */\n  constructor(type, map, browserEvent, opt_dragging, opt_frameState) {\n\n    super(type, map, opt_frameState);\n\n    /**\n     * The original browser event.\n     * @const\n     * @type {Event}\n     * @api\n     */\n    this.originalEvent = browserEvent;\n\n    /**\n     * The map pixel relative to the viewport corresponding to the original browser event.\n     * @type {?import(\"./pixel.js\").Pixel}\n     */\n    this.pixel_ = null;\n\n    /**\n     * The coordinate in the user projection corresponding to the original browser event.\n     * @type {?import(\"./coordinate.js\").Coordinate}\n     */\n    this.coordinate_ = null;\n\n    /**\n     * Indicates if the map is currently being dragged. Only set for\n     * `POINTERDRAG` and `POINTERMOVE` events. Default is `false`.\n     *\n     * @type {boolean}\n     * @api\n     */\n    this.dragging = opt_dragging !== undefined ? opt_dragging : false;\n\n  }\n\n  /**\n   * The map pixel relative to the viewport corresponding to the original browser event.\n   * @type {import(\"./pixel.js\").Pixel}\n   * @api\n   */\n  get pixel() {\n    if (!this.pixel_) {\n      this.pixel_ = this.map.getEventPixel(this.originalEvent);\n    }\n    return this.pixel_;\n  }\n  set pixel(pixel) {\n    this.pixel_ = pixel;\n  }\n\n  /**\n   * The coordinate corresponding to the original browser event.  This will be in the user\n   * projection if one is set.  Otherwise it will be in the view projection.\n   * @type {import(\"./coordinate.js\").Coordinate}\n   * @api\n   */\n  get coordinate() {\n    if (!this.coordinate_) {\n      this.coordinate_ = this.map.getCoordinateFromPixel(this.pixel);\n    }\n    return this.coordinate_;\n  }\n  set coordinate(coordinate) {\n    this.coordinate_ = coordinate;\n  }\n\n  /**\n   * Prevents the default browser action.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.preventDefault.\n   * @override\n   * @api\n   */\n  preventDefault() {\n    super.preventDefault();\n    this.originalEvent.preventDefault();\n  }\n\n  /**\n   * Prevents further propagation of the current event.\n   * See https://developer.mozilla.org/en-US/docs/Web/API/event.stopPropagation.\n   * @override\n   * @api\n   */\n  stopPropagation() {\n    super.stopPropagation();\n    this.originalEvent.stopPropagation();\n  }\n}\n\n\nexport default MapBrowserEvent;\n","/**\n * @module ol/TileQueue\n */\nimport TileState from './TileState.js';\nimport EventType from './events/EventType.js';\nimport PriorityQueue from './structs/PriorityQueue.js';\n\n\n/**\n * @typedef {function(import(\"./Tile.js\").default, string, import(\"./coordinate.js\").Coordinate, number): number} PriorityFunction\n */\n\n\nclass TileQueue extends PriorityQueue {\n\n  /**\n   * @param {PriorityFunction} tilePriorityFunction Tile priority function.\n   * @param {function(): ?} tileChangeCallback Function called on each tile change event.\n   */\n  constructor(tilePriorityFunction, tileChangeCallback) {\n\n    super(\n      /**\n       * @param {Array} element Element.\n       * @return {number} Priority.\n       */\n      function(element) {\n        return tilePriorityFunction.apply(null, element);\n      },\n      /**\n       * @param {Array} element Element.\n       * @return {string} Key.\n       */\n      function(element) {\n        return (/** @type {import(\"./Tile.js\").default} */ (element[0]).getKey());\n      });\n\n    /** @private */\n    this.boundHandleTileChange_ = this.handleTileChange.bind(this);\n\n    /**\n     * @private\n     * @type {function(): ?}\n     */\n    this.tileChangeCallback_ = tileChangeCallback;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tilesLoading_ = 0;\n\n    /**\n     * @private\n     * @type {!Object<string,boolean>}\n     */\n    this.tilesLoadingKeys_ = {};\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  enqueue(element) {\n    const added = super.enqueue(element);\n    if (added) {\n      const tile = element[0];\n      tile.addEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n    }\n    return added;\n  }\n\n  /**\n   * @return {number} Number of tiles loading.\n   */\n  getTilesLoading() {\n    return this.tilesLoading_;\n  }\n\n  /**\n   * @param {import(\"./events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleTileChange(event) {\n    const tile = /** @type {import(\"./Tile.js\").default} */ (event.target);\n    const state = tile.getState();\n    if (tile.hifi && state === TileState.LOADED || state === TileState.ERROR ||\n        state === TileState.EMPTY || state === TileState.ABORT) {\n      tile.removeEventListener(EventType.CHANGE, this.boundHandleTileChange_);\n      const tileKey = tile.getKey();\n      if (tileKey in this.tilesLoadingKeys_) {\n        delete this.tilesLoadingKeys_[tileKey];\n        --this.tilesLoading_;\n      }\n      this.tileChangeCallback_();\n    }\n  }\n\n  /**\n   * @param {number} maxTotalLoading Maximum number tiles to load simultaneously.\n   * @param {number} maxNewLoads Maximum number of new tiles to load.\n   */\n  loadMoreTiles(maxTotalLoading, maxNewLoads) {\n    let newLoads = 0;\n    let abortedTiles = false;\n    let state, tile, tileKey;\n    while (this.tilesLoading_ < maxTotalLoading && newLoads < maxNewLoads &&\n           this.getCount() > 0) {\n      tile = /** @type {import(\"./Tile.js\").default} */ (this.dequeue()[0]);\n      tileKey = tile.getKey();\n      state = tile.getState();\n      if (state === TileState.ABORT) {\n        abortedTiles = true;\n      } else if (state === TileState.IDLE && !(tileKey in this.tilesLoadingKeys_)) {\n        this.tilesLoadingKeys_[tileKey] = true;\n        ++this.tilesLoading_;\n        ++newLoads;\n        tile.load();\n      }\n    }\n    if (newLoads === 0 && abortedTiles) {\n      // Do not stop the render loop when all wanted tiles were aborted due to\n      // a small, saturated tile cache.\n      this.tileChangeCallback_();\n    }\n  }\n}\n\n\nexport default TileQueue;\n","/**\n * @module ol/renderer/canvas/TileLayer\n */\nimport {getUid} from '../../util.js';\nimport {fromUserExtent} from '../../proj.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport {createEmpty, equals, getIntersection, getTopLeft} from '../../extent.js';\nimport CanvasLayerRenderer from './Layer.js';\nimport {apply as applyTransform, compose as composeTransform, makeInverse, toString as transformToString} from '../../transform.js';\nimport {numberSafeCompareFunction} from '../../array.js';\n\n/**\n * @classdesc\n * Canvas renderer for tile layers.\n * @api\n */\nclass CanvasTileLayerRenderer extends CanvasLayerRenderer {\n\n  /**\n   * @param {import(\"../../layer/Tile.js\").default|import(\"../../layer/VectorTile.js\").default} tileLayer Tile layer.\n   */\n  constructor(tileLayer) {\n    super(tileLayer);\n\n    /**\n     * Rendered extent has changed since the previous `renderFrame()` call\n     * @type {boolean}\n     */\n    this.extentChanged = true;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.renderedExtent_ = null;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.renderedRevision;\n\n    /**\n     * @protected\n     * @type {!Array<import(\"../../Tile.js\").default>}\n     */\n    this.renderedTiles = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.newTiles_ = false;\n\n    /**\n     * @protected\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.tmpExtent = createEmpty();\n\n    /**\n     * @private\n     * @type {import(\"../../TileRange.js\").default}\n     */\n    this.tmpTileRange_ = new TileRange(0, 0, 0, 0);\n  }\n\n  /**\n   * @protected\n   * @param {import(\"../../Tile.js\").default} tile Tile.\n   * @return {boolean} Tile is drawable.\n   */\n  isDrawableTile(tile) {\n    const tileLayer = this.getLayer();\n    const tileState = tile.getState();\n    const useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    return tileState == TileState.LOADED ||\n        tileState == TileState.EMPTY ||\n        tileState == TileState.ERROR && !useInterimTilesOnError;\n  }\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {!import(\"../../Tile.js\").default} Tile.\n   */\n  getTile(z, x, y, frameState) {\n    const pixelRatio = frameState.pixelRatio;\n    const projection = frameState.viewState.projection;\n    const tileLayer = this.getLayer();\n    const tileSource = tileLayer.getSource();\n    let tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n    if (tile.getState() == TileState.ERROR) {\n      if (!tileLayer.getUseInterimTilesOnError()) {\n        // When useInterimTilesOnError is false, we consider the error tile as loaded.\n        tile.setState(TileState.LOADED);\n      } else if (tileLayer.getPreload() > 0) {\n        // Preloaded tiles for lower resolutions might have finished loading.\n        this.newTiles_ = true;\n      }\n    }\n    if (!this.isDrawableTile(tile)) {\n      tile = tile.getInterimTile();\n    }\n    return tile;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  loadedTileCallback(tiles, zoom, tile) {\n    if (this.isDrawableTile(tile)) {\n      return super.loadedTileCallback(tiles, zoom, tile);\n    }\n    return false;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState) {\n    return !!this.getLayer().getSource();\n  }\n\n  /**\n   * TODO: File a TypeScript issue about inheritDoc not being followed\n   * all the way.  Without this explicit return type, the VectorTileLayer\n   * renderFrame function does not pass.\n   *\n   * @inheritDoc\n   * @returns {HTMLElement} The rendered element.\n   */\n  renderFrame(frameState, target) {\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    const viewState = frameState.viewState;\n    const projection = viewState.projection;\n    const viewResolution = viewState.resolution;\n    const viewCenter = viewState.center;\n    const rotation = viewState.rotation;\n    const pixelRatio = frameState.pixelRatio;\n\n    const tileLayer = this.getLayer();\n    const tileSource = tileLayer.getSource();\n    const sourceRevision = tileSource.getRevision();\n    const tileGrid = tileSource.getTileGridForProjection(projection);\n    const z = tileGrid.getZForResolution(viewResolution, tileSource.zDirection);\n    const tileResolution = tileGrid.getResolution(z);\n\n    let extent = frameState.extent;\n    const layerExtent = layerState.extent && fromUserExtent(layerState.extent, projection);\n    if (layerExtent) {\n      extent = getIntersection(extent, fromUserExtent(layerState.extent, projection));\n    }\n\n    const tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);\n\n    // desired dimensions of the canvas in pixels\n    let width = Math.round(frameState.size[0] * tilePixelRatio);\n    let height = Math.round(frameState.size[1] * tilePixelRatio);\n\n    if (rotation) {\n      const size = Math.round(Math.sqrt(width * width + height * height));\n      width = height = size;\n    }\n\n    const dx = tileResolution * width / 2 / tilePixelRatio;\n    const dy = tileResolution * height / 2 / tilePixelRatio;\n    const canvasExtent = [\n      viewCenter[0] - dx,\n      viewCenter[1] - dy,\n      viewCenter[0] + dx,\n      viewCenter[1] + dy\n    ];\n\n    const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n\n    /**\n     * @type {Object<number, Object<string, import(\"../../Tile.js\").default>>}\n     */\n    const tilesToDrawByZ = {};\n    tilesToDrawByZ[z] = {};\n\n    const findLoadedTiles = this.createLoadedTileFinder(tileSource, projection, tilesToDrawByZ);\n\n    const tmpExtent = this.tmpExtent;\n    const tmpTileRange = this.tmpTileRange_;\n    this.newTiles_ = false;\n    for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        const tile = this.getTile(z, x, y, frameState);\n        if (this.isDrawableTile(tile)) {\n          const uid = getUid(this);\n          if (tile.getState() == TileState.LOADED) {\n            tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n            const inTransition = tile.inTransition(uid);\n            if (!this.newTiles_ && (inTransition || this.renderedTiles.indexOf(tile) === -1)) {\n              this.newTiles_ = true;\n            }\n          }\n          if (tile.getAlpha(uid, frameState.time) === 1) {\n            // don't look for alt tiles if alpha is 1\n            continue;\n          }\n        }\n\n        const childTileRange = tileGrid.getTileCoordChildTileRange(tile.tileCoord, tmpTileRange, tmpExtent);\n\n        let covered = false;\n        if (childTileRange) {\n          covered = findLoadedTiles(z + 1, childTileRange);\n        }\n        if (!covered) {\n          tileGrid.forEachTileCoordParentTileRange(tile.tileCoord, findLoadedTiles, tmpTileRange, tmpExtent);\n        }\n\n      }\n    }\n\n\n    const canvasScale = tileResolution / viewResolution;\n\n    // set forward and inverse pixel transforms\n    composeTransform(this.pixelTransform,\n      frameState.size[0] / 2, frameState.size[1] / 2,\n      1 / tilePixelRatio, 1 / tilePixelRatio,\n      rotation,\n      -width / 2, -height / 2\n    );\n\n    this.useContainer(target, this.pixelTransform, layerState.opacity);\n    const context = this.context;\n    const canvas = context.canvas;\n\n    makeInverse(this.inversePixelTransform, this.pixelTransform);\n\n    // set scale transform for calculating tile positions on the canvas\n    composeTransform(this.tempTransform_,\n      width / 2, height / 2,\n      canvasScale, canvasScale,\n      0,\n      -width / 2, -height / 2\n    );\n\n    if (canvas.width != width || canvas.height != height) {\n      canvas.width = width;\n      canvas.height = height;\n    } else if (!this.containerReused) {\n      context.clearRect(0, 0, width, height);\n    }\n\n    if (layerExtent) {\n      this.clipUnrotated(context, frameState, layerExtent);\n    }\n\n    this.preRender(context, frameState);\n\n    this.renderedTiles.length = 0;\n    /** @type {Array<number>} */\n    let zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(numberSafeCompareFunction);\n\n    let clips, clipZs, currentClip;\n    if (layerState.opacity === 1 && (!this.containerReused || tileSource.getOpaque(frameState.viewState.projection))) {\n      zs = zs.reverse();\n    } else {\n      clips = [];\n      clipZs = [];\n    }\n    for (let i = zs.length - 1; i >= 0; --i) {\n      const currentZ = zs[i];\n      const currentTilePixelSize = tileSource.getTilePixelSize(currentZ, pixelRatio, projection);\n      const currentResolution = tileGrid.getResolution(currentZ);\n      const currentScale = currentResolution / tileResolution;\n      const dx = currentTilePixelSize[0] * currentScale * canvasScale;\n      const dy = currentTilePixelSize[1] * currentScale * canvasScale;\n      const originTileCoord = tileGrid.getTileCoordForCoordAndZ(getTopLeft(canvasExtent), currentZ);\n      const originTileExtent = tileGrid.getTileCoordExtent(originTileCoord);\n      const origin = applyTransform(this.tempTransform_, [\n        tilePixelRatio * (originTileExtent[0] - canvasExtent[0]) / tileResolution,\n        tilePixelRatio * (canvasExtent[3] - originTileExtent[3]) / tileResolution\n      ]);\n      const tileGutter = tilePixelRatio * tileSource.getGutterForProjection(projection);\n      const tilesToDraw = tilesToDrawByZ[currentZ];\n      for (const tileCoordKey in tilesToDraw) {\n        const tile = /** @type {import(\"../../ImageTile.js\").default} */ (tilesToDraw[tileCoordKey]);\n        const tileCoord = tile.tileCoord;\n\n        // Calculate integer positions and sizes so that tiles align\n        const floatX = (origin[0] - (originTileCoord[1] - tileCoord[1]) * dx);\n        const nextX = Math.round(floatX + dx);\n        const floatY = (origin[1] - (originTileCoord[2] - tileCoord[2]) * dy);\n        const nextY = Math.round(floatY + dy);\n        const x = Math.round(floatX);\n        const y = Math.round(floatY);\n        const w = nextX - x;\n        const h = nextY - y;\n        const transition = z === currentZ;\n\n        const inTransition = transition && tile.getAlpha(getUid(this), frameState.time) !== 1;\n        if (!inTransition) {\n          if (clips) {\n            // Clip mask for regions in this tile that already filled by a higher z tile\n            context.save();\n            currentClip = [x, y, x + w, y, x + w, y + h, x, y + h];\n            for (let i = 0, ii = clips.length; i < ii; ++i) {\n              if (z !== currentZ && currentZ < clipZs[i]) {\n                const clip = clips[i];\n                context.beginPath();\n                // counter-clockwise (outer ring) for current tile\n                context.moveTo(currentClip[0], currentClip[1]);\n                context.lineTo(currentClip[2], currentClip[3]);\n                context.lineTo(currentClip[4], currentClip[5]);\n                context.lineTo(currentClip[6], currentClip[7]);\n                // clockwise (inner ring) for higher z tile\n                context.moveTo(clip[6], clip[7]);\n                context.lineTo(clip[4], clip[5]);\n                context.lineTo(clip[2], clip[3]);\n                context.lineTo(clip[0], clip[1]);\n                context.clip();\n              }\n            }\n            clips.push(currentClip);\n            clipZs.push(currentZ);\n          } else {\n            context.clearRect(x, y, w, h);\n          }\n        }\n        this.drawTileImage(tile, frameState, x, y, w, h, tileGutter, transition, layerState.opacity);\n        if (clips && !inTransition) {\n          context.restore();\n        }\n        this.renderedTiles.push(tile);\n        this.updateUsedTiles(frameState.usedTiles, tileSource, tile);\n      }\n    }\n\n\n    this.renderedRevision = sourceRevision;\n    this.renderedResolution = tileResolution;\n    this.extentChanged = !this.renderedExtent_ || !equals(this.renderedExtent_, canvasExtent);\n    this.renderedExtent_ = canvasExtent;\n\n    this.manageTilePyramid(frameState, tileSource, tileGrid, pixelRatio,\n      projection, extent, z, tileLayer.getPreload());\n    this.updateCacheSize_(frameState, tileSource);\n    this.scheduleExpireCache(frameState, tileSource);\n\n    this.postRender(context, frameState);\n\n    if (layerState.extent) {\n      context.restore();\n    }\n\n    const canvasTransform = transformToString(this.pixelTransform);\n    if (canvasTransform !== canvas.style.transform) {\n      canvas.style.transform = canvasTransform;\n    }\n\n    return this.container;\n  }\n\n  /**\n   * @param {import(\"../../ImageTile.js\").default} tile Tile.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {number} x Left of the tile.\n   * @param {number} y Top of the tile.\n   * @param {number} w Width of the tile.\n   * @param {number} h Height of the tile.\n   * @param {number} gutter Tile gutter.\n   * @param {boolean} transition Apply an alpha transition.\n   * @param {number} opacity Opacity.\n   */\n  drawTileImage(tile, frameState, x, y, w, h, gutter, transition, opacity) {\n    const image = this.getTileImage(tile);\n    if (!image) {\n      return;\n    }\n    const uid = getUid(this);\n    const tileAlpha = transition ? tile.getAlpha(uid, frameState.time) : 1;\n    const alpha = opacity * tileAlpha;\n    const alphaChanged = alpha !== this.context.globalAlpha;\n    if (alphaChanged) {\n      this.context.save();\n      this.context.globalAlpha = alpha;\n    }\n    this.context.drawImage(image, gutter, gutter,\n      image.width - 2 * gutter, image.height - 2 * gutter, x, y, w, h);\n\n    if (alphaChanged) {\n      this.context.restore();\n    }\n    if (tileAlpha !== 1) {\n      frameState.animate = true;\n    } else if (transition) {\n      tile.endTransition(uid);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImage() {\n    const context = this.context;\n    return context ? context.canvas : null;\n  }\n\n  /**\n   * Get the image from a tile.\n   * @param {import(\"../../ImageTile.js\").default} tile Tile.\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @protected\n   */\n  getTileImage(tile) {\n    return tile.getImage();\n  }\n\n  /**\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @protected\n   */\n  scheduleExpireCache(frameState, tileSource) {\n    if (tileSource.canExpireCache()) {\n      /**\n       * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n       * @param {import(\"../../PluggableMap.js\").default} map Map.\n       * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n       */\n      const postRenderFunction = function(tileSource, map, frameState) {\n        const tileSourceKey = getUid(tileSource);\n        if (tileSourceKey in frameState.usedTiles) {\n          tileSource.expireCache(frameState.viewState.projection,\n            frameState.usedTiles[tileSourceKey]);\n        }\n      }.bind(null, tileSource);\n\n      frameState.postRenderFunctions.push(\n        /** @type {import(\"../../PluggableMap.js\").PostRenderFunction} */ (postRenderFunction)\n      );\n    }\n  }\n\n  /**\n   * @param {!Object<string, !Object<string, boolean>>} usedTiles Used tiles.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @param {import('../../Tile.js').default} tile Tile.\n   * @protected\n   */\n  updateUsedTiles(usedTiles, tileSource, tile) {\n    // FIXME should we use tilesToDrawByZ instead?\n    const tileSourceKey = getUid(tileSource);\n    if (!(tileSourceKey in usedTiles)) {\n      usedTiles[tileSourceKey] = {};\n    }\n    usedTiles[tileSourceKey][tile.getKey()] = true;\n  }\n\n  /**\n   * Check if the cache is big enough, and increase its size if necessary.\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @private\n   */\n  updateCacheSize_(frameState, tileSource) {\n    const tileSourceKey = getUid(tileSource);\n    let size = 0;\n    if (tileSourceKey in frameState.usedTiles) {\n      size += Object.keys(frameState.usedTiles[tileSourceKey]).length;\n    }\n    if (tileSourceKey in frameState.wantedTiles) {\n      size += Object.keys(frameState.wantedTiles[tileSourceKey]).length;\n    }\n    const tileCache = tileSource.tileCache;\n    if (tileCache.highWaterMark < size) {\n      tileCache.highWaterMark = size;\n    }\n  }\n\n  /**\n   * Manage tile pyramid.\n   * This function performs a number of functions related to the tiles at the\n   * current zoom and lower zoom levels:\n   * - registers idle tiles in frameState.wantedTiles so that they are not\n   *   discarded by the tile queue\n   * - enqueues missing tiles\n   * @param {import(\"../../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @param {import(\"../../tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {number} currentZ Current Z.\n   * @param {number} preload Load low resolution tiles up to 'preload' levels.\n   * @param {function(import(\"../../Tile.js\").default)=} opt_tileCallback Tile callback.\n   * @protected\n   */\n  manageTilePyramid(\n    frameState,\n    tileSource,\n    tileGrid,\n    pixelRatio,\n    projection,\n    extent,\n    currentZ,\n    preload,\n    opt_tileCallback\n  ) {\n    const tileSourceKey = getUid(tileSource);\n    if (!(tileSourceKey in frameState.wantedTiles)) {\n      frameState.wantedTiles[tileSourceKey] = {};\n    }\n    const wantedTiles = frameState.wantedTiles[tileSourceKey];\n    const tileQueue = frameState.tileQueue;\n    const minZoom = tileGrid.getMinZoom();\n    let tile, tileRange, tileResolution, x, y, z;\n    for (z = minZoom; z <= currentZ; ++z) {\n      tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);\n      tileResolution = tileGrid.getResolution(z);\n      for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n        for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n          if (currentZ - z <= preload) {\n            tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n            if (tile.getState() == TileState.IDLE) {\n              wantedTiles[tile.getKey()] = true;\n              if (!tileQueue.isKeyQueued(tile.getKey())) {\n                tileQueue.enqueue([tile, tileSourceKey,\n                  tileGrid.getTileCoordCenter(tile.tileCoord), tileResolution]);\n              }\n            }\n            if (opt_tileCallback !== undefined) {\n              opt_tileCallback(tile);\n            }\n          } else {\n            tileSource.useTile(z, x, y, projection);\n          }\n        }\n      }\n    }\n  }\n\n}\n\n\n/**\n * @function\n * @return {import(\"../../layer/Tile.js\").default|import(\"../../layer/VectorTile.js\").default}\n */\nCanvasTileLayerRenderer.prototype.getLayer;\n\n\nexport default CanvasTileLayerRenderer;\n","/**\n * @module ol/renderer/Layer\n */\nimport {abstract} from '../util.js';\nimport ImageState from '../ImageState.js';\nimport Observable from '../Observable.js';\nimport EventType from '../events/EventType.js';\nimport SourceState from '../source/State.js';\n\n/**\n * @template {import(\"../layer/Layer.js\").default} LayerType\n */\nclass LayerRenderer extends Observable {\n\n  /**\n   * @param {LayerType} layer Layer.\n   */\n  constructor(layer) {\n\n    super();\n\n    /** @private */\n    this.boundHandleImageChange_ = this.handleImageChange_.bind(this);\n\n    /**\n     * @private\n     * @type {LayerType}\n     */\n    this.layer_ = layer;\n\n  }\n\n  /**\n   * Determine whether render should be called.\n   * @abstract\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @return {boolean} Layer is ready to be rendered.\n   */\n  prepareFrame(frameState) {\n    return abstract();\n  }\n\n  /**\n   * Render the layer.\n   * @abstract\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {HTMLElement} target Target that may be used to render content to.\n   * @return {HTMLElement} The rendered element.\n   */\n  renderFrame(frameState, target) {\n    return abstract();\n  }\n\n  /**\n   * @param {Object<number, Object<string, import(\"../Tile.js\").default>>} tiles Lookup of loaded tiles by zoom level.\n   * @param {number} zoom Zoom level.\n   * @param {import(\"../Tile.js\").default} tile Tile.\n   */\n  loadedTileCallback(tiles, zoom, tile) {\n    if (!tiles[zoom]) {\n      tiles[zoom] = {};\n    }\n    tiles[zoom][tile.tileCoord.toString()] = tile;\n  }\n\n  /**\n   * Create a function that adds loaded tiles to the tile lookup.\n   * @param {import(\"../source/Tile.js\").default} source Tile source.\n   * @param {import(\"../proj/Projection.js\").default} projection Projection of the tiles.\n   * @param {Object<number, Object<string, import(\"../Tile.js\").default>>} tiles Lookup of loaded tiles by zoom level.\n   * @return {function(number, import(\"../TileRange.js\").default):boolean} A function that can be\n   *     called with a zoom level and a tile range to add loaded tiles to the lookup.\n   * @protected\n   */\n  createLoadedTileFinder(source, projection, tiles) {\n    return (\n      /**\n       * @param {number} zoom Zoom level.\n       * @param {import(\"../TileRange.js\").default} tileRange Tile range.\n       * @return {boolean} The tile range is fully loaded.\n       * @this {LayerRenderer}\n       */\n      function(zoom, tileRange) {\n        const callback = this.loadedTileCallback.bind(this, tiles, zoom);\n        return source.forEachLoadedTile(projection, zoom, tileRange, callback);\n      }\n    ).bind(this);\n  }\n  /**\n   * @abstract\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(import(\"../Feature.js\").FeatureLike, import(\"../layer/Layer.js\").default): T} callback Feature callback.\n   * @param {Array<import(\"../Feature.js\").FeatureLike>} declutteredFeatures Decluttered features.\n   * @return {T|void} Callback result.\n   * @template T\n   */\n  forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures) {}\n\n  /**\n   * @abstract\n   * @param {import(\"../pixel.js\").Pixel} pixel Pixel.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @return {Uint8ClampedArray|Uint8Array} The result.  If there is no data at the pixel\n   *    location, null will be returned.  If there is data, but pixel values cannot be\n   *    returned, and empty array will be returned.\n   */\n  getDataAtPixel(pixel, frameState, hitTolerance) {\n    return abstract();\n  }\n\n  /**\n   * @return {LayerType} Layer.\n   */\n  getLayer() {\n    return this.layer_;\n  }\n\n  /**\n   * Perform action necessary to get the layer rendered after new fonts have loaded\n   * @abstract\n   */\n  handleFontsChanged() {}\n\n  /**\n   * Handle changes in image state.\n   * @param {import(\"../events/Event.js\").default} event Image change event.\n   * @private\n   */\n  handleImageChange_(event) {\n    const image = /** @type {import(\"../Image.js\").default} */ (event.target);\n    if (image.getState() === ImageState.LOADED) {\n      this.renderIfReadyAndVisible();\n    }\n  }\n\n  /**\n   * Load the image if not already loaded, and register the image change\n   * listener if needed.\n   * @param {import(\"../ImageBase.js\").default} image Image.\n   * @return {boolean} `true` if the image is already loaded, `false` otherwise.\n   * @protected\n   */\n  loadImage(image) {\n    let imageState = image.getState();\n    if (imageState != ImageState.LOADED && imageState != ImageState.ERROR) {\n      image.addEventListener(EventType.CHANGE, this.boundHandleImageChange_);\n    }\n    if (imageState == ImageState.IDLE) {\n      image.load();\n      imageState = image.getState();\n    }\n    return imageState == ImageState.LOADED;\n  }\n\n  /**\n   * @protected\n   */\n  renderIfReadyAndVisible() {\n    const layer = this.getLayer();\n    if (layer.getVisible() && layer.getSourceState() == SourceState.READY) {\n      layer.changed();\n    }\n  }\n\n}\n\nexport default LayerRenderer;\n","/**\n * @module ol/ImageTile\n */\nimport Tile from './Tile.js';\nimport TileState from './TileState.js';\nimport {createCanvasContext2D} from './dom.js';\nimport {listenImage} from './Image.js';\n\n\nclass ImageTile extends Tile {\n\n  /**\n   * @param {import(\"./tilecoord.js\").TileCoord} tileCoord Tile coordinate.\n   * @param {TileState} state State.\n   * @param {string} src Image source URI.\n   * @param {?string} crossOrigin Cross origin.\n   * @param {import(\"./Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @param {import(\"./Tile.js\").Options=} opt_options Tile options.\n   */\n  constructor(tileCoord, state, src, crossOrigin, tileLoadFunction, opt_options) {\n\n    super(tileCoord, state, opt_options);\n\n    /**\n     * @private\n     * @type {?string}\n     */\n    this.crossOrigin_ = crossOrigin;\n\n    /**\n     * Image URI\n     *\n     * @private\n     * @type {string}\n     */\n    this.src_ = src;\n\n    /**\n     * @private\n     * @type {HTMLImageElement|HTMLCanvasElement}\n     */\n    this.image_ = new Image();\n    if (crossOrigin !== null) {\n      this.image_.crossOrigin = crossOrigin;\n    }\n\n    /**\n     * @private\n     * @type {?function():void}\n     */\n    this.unlisten_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction_ = tileLoadFunction;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    if (this.state == TileState.LOADING) {\n      this.unlistenImage_();\n      this.image_ = getBlankImage();\n    }\n    if (this.interimTile) {\n      this.interimTile.dispose();\n    }\n    this.state = TileState.ABORT;\n    this.changed();\n    super.disposeInternal();\n  }\n\n  /**\n   * Get the HTML image element for this tile (may be a Canvas, Image, or Video).\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @api\n   */\n  getImage() {\n    return this.image_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getKey() {\n    return this.src_;\n  }\n\n  /**\n   * Tracks loading or read errors.\n   *\n   * @private\n   */\n  handleImageError_() {\n    this.state = TileState.ERROR;\n    this.unlistenImage_();\n    this.image_ = getBlankImage();\n    this.changed();\n  }\n\n  /**\n   * Tracks successful image load.\n   *\n   * @private\n   */\n  handleImageLoad_() {\n    const image = /** @type {HTMLImageElement} */ (this.image_);\n    if (image.naturalWidth && image.naturalHeight) {\n      this.state = TileState.LOADED;\n    } else {\n      this.state = TileState.EMPTY;\n    }\n    this.unlistenImage_();\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  load() {\n    if (this.state == TileState.ERROR) {\n      this.state = TileState.IDLE;\n      this.image_ = new Image();\n      if (this.crossOrigin_ !== null) {\n        this.image_.crossOrigin = this.crossOrigin_;\n      }\n    }\n    if (this.state == TileState.IDLE) {\n      this.state = TileState.LOADING;\n      this.changed();\n      this.tileLoadFunction_(this, this.src_);\n      this.unlisten_ = listenImage(\n        this.image_,\n        this.handleImageLoad_.bind(this),\n        this.handleImageError_.bind(this)\n      );\n    }\n  }\n\n  /**\n   * Discards event handlers which listen for load completion or errors.\n   *\n   * @private\n   */\n  unlistenImage_() {\n    if (this.unlisten_) {\n      this.unlisten_();\n      this.unlisten_ = null;\n    }\n  }\n}\n\n\n/**\n * Get a 1-pixel blank image.\n * @return {HTMLCanvasElement} Blank image.\n */\nfunction getBlankImage() {\n  const ctx = createCanvasContext2D(1, 1);\n  ctx.fillStyle = 'rgba(0,0,0,0)';\n  ctx.fillRect(0, 0, 1, 1);\n  return ctx.canvas;\n}\n\nexport default ImageTile;\n","/**\n * @module ol/TileCache\n */\nimport LRUCache from './structs/LRUCache.js';\nimport {fromKey, getKey} from './tilecoord.js';\n\nclass TileCache extends LRUCache {\n\n  /**\n   * @param {number=} opt_highWaterMark High water mark.\n   */\n  constructor(opt_highWaterMark) {\n\n    super(opt_highWaterMark);\n\n  }\n\n  /**\n   * @param {!Object<string, import(\"./TileRange.js\").default>} usedTiles Used tiles.\n   */\n  expireCache(usedTiles) {\n    while (this.canExpireCache()) {\n      const tile = this.peekLast();\n      if (tile.getKey() in usedTiles) {\n        break;\n      } else {\n        this.pop().dispose();\n      }\n    }\n  }\n\n  /**\n   * Prune all tiles from the cache that don't have the same z as the newest tile.\n   */\n  pruneExceptNewestZ() {\n    if (this.getCount() === 0) {\n      return;\n    }\n    const key = this.peekFirstKey();\n    const tileCoord = fromKey(key);\n    const z = tileCoord[0];\n    this.forEach(function(tile) {\n      if (tile.tileCoord[0] !== z) {\n        this.remove(getKey(tile.tileCoord));\n        tile.dispose();\n      }\n    }.bind(this));\n  }\n}\n\n\nexport default TileCache;\n","/**\n * @module ol/reproj/Triangulation\n */\nimport {boundingExtent, createEmpty, extendCoordinate, getBottomLeft, getBottomRight,\n  getTopLeft, getTopRight, getWidth, intersects} from '../extent.js';\nimport {modulo} from '../math.js';\nimport {getTransform} from '../proj.js';\n\n\n/**\n * Single triangle; consists of 3 source points and 3 target points.\n * @typedef {Object} Triangle\n * @property {Array<import(\"../coordinate.js\").Coordinate>} source\n * @property {Array<import(\"../coordinate.js\").Coordinate>} target\n */\n\n\n/**\n * Maximum number of subdivision steps during raster reprojection triangulation.\n * Prevents high memory usage and large number of proj4 calls (for certain\n * transformations and areas). At most `2*(2^this)` triangles are created for\n * each triangulated extent (tile/image).\n * @type {number}\n */\nconst MAX_SUBDIVISION = 10;\n\n\n/**\n * Maximum allowed size of triangle relative to world width. When transforming\n * corners of world extent between certain projections, the resulting\n * triangulation seems to have zero error and no subdivision is performed. If\n * the triangle width is more than this (relative to world width; 0-1),\n * subdivison is forced (up to `MAX_SUBDIVISION`). Default is `0.25`.\n * @type {number}\n */\nconst MAX_TRIANGLE_WIDTH = 0.25;\n\n\n/**\n * @classdesc\n * Class containing triangulation of the given target extent.\n * Used for determining source data and the reprojection itself.\n */\nclass Triangulation {\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} sourceProj Source projection.\n   * @param {import(\"../proj/Projection.js\").default} targetProj Target projection.\n   * @param {import(\"../extent.js\").Extent} targetExtent Target extent to triangulate.\n   * @param {import(\"../extent.js\").Extent} maxSourceExtent Maximal source extent that can be used.\n   * @param {number} errorThreshold Acceptable error (in source units).\n   */\n  constructor(sourceProj, targetProj, targetExtent, maxSourceExtent, errorThreshold) {\n\n    /**\n     * @type {import(\"../proj/Projection.js\").default}\n     * @private\n     */\n    this.sourceProj_ = sourceProj;\n\n    /**\n     * @type {import(\"../proj/Projection.js\").default}\n     * @private\n     */\n    this.targetProj_ = targetProj;\n\n    /** @type {!Object<string, import(\"../coordinate.js\").Coordinate>} */\n    let transformInvCache = {};\n    const transformInv = getTransform(this.targetProj_, this.sourceProj_);\n\n    /**\n     * @param {import(\"../coordinate.js\").Coordinate} c A coordinate.\n     * @return {import(\"../coordinate.js\").Coordinate} Transformed coordinate.\n     * @private\n     */\n    this.transformInv_ = function(c) {\n      const key = c[0] + '/' + c[1];\n      if (!transformInvCache[key]) {\n        transformInvCache[key] = transformInv(c);\n      }\n      return transformInvCache[key];\n    };\n\n    /**\n     * @type {import(\"../extent.js\").Extent}\n     * @private\n     */\n    this.maxSourceExtent_ = maxSourceExtent;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.errorThresholdSquared_ = errorThreshold * errorThreshold;\n\n    /**\n     * @type {Array<Triangle>}\n     * @private\n     */\n    this.triangles_ = [];\n\n    /**\n     * Indicates that the triangulation crosses edge of the source projection.\n     * @type {boolean}\n     * @private\n     */\n    this.wrapsXInSource_ = false;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.canWrapXInSource_ = this.sourceProj_.canWrapX() &&\n        !!maxSourceExtent &&\n        !!this.sourceProj_.getExtent() &&\n        (getWidth(maxSourceExtent) == getWidth(this.sourceProj_.getExtent()));\n\n    /**\n     * @type {?number}\n     * @private\n     */\n    this.sourceWorldWidth_ = this.sourceProj_.getExtent() ?\n      getWidth(this.sourceProj_.getExtent()) : null;\n\n    /**\n     * @type {?number}\n     * @private\n     */\n    this.targetWorldWidth_ = this.targetProj_.getExtent() ?\n      getWidth(this.targetProj_.getExtent()) : null;\n\n    const destinationTopLeft = getTopLeft(targetExtent);\n    const destinationTopRight = getTopRight(targetExtent);\n    const destinationBottomRight = getBottomRight(targetExtent);\n    const destinationBottomLeft = getBottomLeft(targetExtent);\n    const sourceTopLeft = this.transformInv_(destinationTopLeft);\n    const sourceTopRight = this.transformInv_(destinationTopRight);\n    const sourceBottomRight = this.transformInv_(destinationBottomRight);\n    const sourceBottomLeft = this.transformInv_(destinationBottomLeft);\n\n    this.addQuad_(\n      destinationTopLeft, destinationTopRight,\n      destinationBottomRight, destinationBottomLeft,\n      sourceTopLeft, sourceTopRight, sourceBottomRight, sourceBottomLeft,\n      MAX_SUBDIVISION);\n\n    if (this.wrapsXInSource_) {\n      let leftBound = Infinity;\n      this.triangles_.forEach(function(triangle, i, arr) {\n        leftBound = Math.min(leftBound,\n          triangle.source[0][0], triangle.source[1][0], triangle.source[2][0]);\n      });\n\n      // Shift triangles to be as close to `leftBound` as possible\n      // (if the distance is more than `worldWidth / 2` it can be closer.\n      this.triangles_.forEach(function(triangle) {\n        if (Math.max(triangle.source[0][0], triangle.source[1][0],\n          triangle.source[2][0]) - leftBound > this.sourceWorldWidth_ / 2) {\n          const newTriangle = [[triangle.source[0][0], triangle.source[0][1]],\n            [triangle.source[1][0], triangle.source[1][1]],\n            [triangle.source[2][0], triangle.source[2][1]]];\n          if ((newTriangle[0][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n            newTriangle[0][0] -= this.sourceWorldWidth_;\n          }\n          if ((newTriangle[1][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n            newTriangle[1][0] -= this.sourceWorldWidth_;\n          }\n          if ((newTriangle[2][0] - leftBound) > this.sourceWorldWidth_ / 2) {\n            newTriangle[2][0] -= this.sourceWorldWidth_;\n          }\n\n          // Rarely (if the extent contains both the dateline and prime meridian)\n          // the shift can in turn break some triangles.\n          // Detect this here and don't shift in such cases.\n          const minX = Math.min(\n            newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n          const maxX = Math.max(\n            newTriangle[0][0], newTriangle[1][0], newTriangle[2][0]);\n          if ((maxX - minX) < this.sourceWorldWidth_ / 2) {\n            triangle.source = newTriangle;\n          }\n        }\n      }.bind(this));\n    }\n\n    transformInvCache = {};\n  }\n\n  /**\n   * Adds triangle to the triangulation.\n   * @param {import(\"../coordinate.js\").Coordinate} a The target a coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} b The target b coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} c The target c coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} aSrc The source a coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} bSrc The source b coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} cSrc The source c coordinate.\n   * @private\n   */\n  addTriangle_(a, b, c, aSrc, bSrc, cSrc) {\n    this.triangles_.push({\n      source: [aSrc, bSrc, cSrc],\n      target: [a, b, c]\n    });\n  }\n\n  /**\n   * Adds quad (points in clock-wise order) to the triangulation\n   * (and reprojects the vertices) if valid.\n   * Performs quad subdivision if needed to increase precision.\n   *\n   * @param {import(\"../coordinate.js\").Coordinate} a The target a coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} b The target b coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} c The target c coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} d The target d coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} aSrc The source a coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} bSrc The source b coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} cSrc The source c coordinate.\n   * @param {import(\"../coordinate.js\").Coordinate} dSrc The source d coordinate.\n   * @param {number} maxSubdivision Maximal allowed subdivision of the quad.\n   * @private\n   */\n  addQuad_(a, b, c, d, aSrc, bSrc, cSrc, dSrc, maxSubdivision) {\n\n    const sourceQuadExtent = boundingExtent([aSrc, bSrc, cSrc, dSrc]);\n    const sourceCoverageX = this.sourceWorldWidth_ ?\n      getWidth(sourceQuadExtent) / this.sourceWorldWidth_ : null;\n    const sourceWorldWidth = /** @type {number} */ (this.sourceWorldWidth_);\n\n    // when the quad is wrapped in the source projection\n    // it covers most of the projection extent, but not fully\n    const wrapsX = this.sourceProj_.canWrapX() &&\n                 sourceCoverageX > 0.5 && sourceCoverageX < 1;\n\n    let needsSubdivision = false;\n\n    if (maxSubdivision > 0) {\n      if (this.targetProj_.isGlobal() && this.targetWorldWidth_) {\n        const targetQuadExtent = boundingExtent([a, b, c, d]);\n        const targetCoverageX = getWidth(targetQuadExtent) / this.targetWorldWidth_;\n        needsSubdivision = targetCoverageX > MAX_TRIANGLE_WIDTH ||\n          needsSubdivision;\n      }\n      if (!wrapsX && this.sourceProj_.isGlobal() && sourceCoverageX) {\n        needsSubdivision = sourceCoverageX > MAX_TRIANGLE_WIDTH ||\n            needsSubdivision;\n      }\n    }\n\n    if (!needsSubdivision && this.maxSourceExtent_) {\n      if (!intersects(sourceQuadExtent, this.maxSourceExtent_)) {\n        // whole quad outside source projection extent -> ignore\n        return;\n      }\n    }\n\n    if (!needsSubdivision) {\n      if (!isFinite(aSrc[0]) || !isFinite(aSrc[1]) ||\n          !isFinite(bSrc[0]) || !isFinite(bSrc[1]) ||\n          !isFinite(cSrc[0]) || !isFinite(cSrc[1]) ||\n          !isFinite(dSrc[0]) || !isFinite(dSrc[1])) {\n        if (maxSubdivision > 0) {\n          needsSubdivision = true;\n        } else {\n          return;\n        }\n      }\n    }\n\n    if (maxSubdivision > 0) {\n      if (!needsSubdivision) {\n        const center = [(a[0] + c[0]) / 2, (a[1] + c[1]) / 2];\n        const centerSrc = this.transformInv_(center);\n\n        let dx;\n        if (wrapsX) {\n          const centerSrcEstimX =\n              (modulo(aSrc[0], sourceWorldWidth) +\n               modulo(cSrc[0], sourceWorldWidth)) / 2;\n          dx = centerSrcEstimX -\n              modulo(centerSrc[0], sourceWorldWidth);\n        } else {\n          dx = (aSrc[0] + cSrc[0]) / 2 - centerSrc[0];\n        }\n        const dy = (aSrc[1] + cSrc[1]) / 2 - centerSrc[1];\n        const centerSrcErrorSquared = dx * dx + dy * dy;\n        needsSubdivision = centerSrcErrorSquared > this.errorThresholdSquared_;\n      }\n      if (needsSubdivision) {\n        if (Math.abs(a[0] - c[0]) <= Math.abs(a[1] - c[1])) {\n          // split horizontally (top & bottom)\n          const bc = [(b[0] + c[0]) / 2, (b[1] + c[1]) / 2];\n          const bcSrc = this.transformInv_(bc);\n          const da = [(d[0] + a[0]) / 2, (d[1] + a[1]) / 2];\n          const daSrc = this.transformInv_(da);\n\n          this.addQuad_(\n            a, b, bc, da, aSrc, bSrc, bcSrc, daSrc, maxSubdivision - 1);\n          this.addQuad_(\n            da, bc, c, d, daSrc, bcSrc, cSrc, dSrc, maxSubdivision - 1);\n        } else {\n          // split vertically (left & right)\n          const ab = [(a[0] + b[0]) / 2, (a[1] + b[1]) / 2];\n          const abSrc = this.transformInv_(ab);\n          const cd = [(c[0] + d[0]) / 2, (c[1] + d[1]) / 2];\n          const cdSrc = this.transformInv_(cd);\n\n          this.addQuad_(\n            a, ab, cd, d, aSrc, abSrc, cdSrc, dSrc, maxSubdivision - 1);\n          this.addQuad_(\n            ab, b, c, cd, abSrc, bSrc, cSrc, cdSrc, maxSubdivision - 1);\n        }\n        return;\n      }\n    }\n\n    if (wrapsX) {\n      if (!this.canWrapXInSource_) {\n        return;\n      }\n      this.wrapsXInSource_ = true;\n    }\n\n    this.addTriangle_(a, c, d, aSrc, cSrc, dSrc);\n    this.addTriangle_(a, b, c, aSrc, bSrc, cSrc);\n  }\n\n  /**\n   * Calculates extent of the 'source' coordinates from all the triangles.\n   *\n   * @return {import(\"../extent.js\").Extent} Calculated extent.\n   */\n  calculateSourceExtent() {\n    const extent = createEmpty();\n\n    this.triangles_.forEach(function(triangle, i, arr) {\n      const src = triangle.source;\n      extendCoordinate(extent, src[0]);\n      extendCoordinate(extent, src[1]);\n      extendCoordinate(extent, src[2]);\n    });\n\n    return extent;\n  }\n\n  /**\n   * @return {Array<Triangle>} Array of the calculated triangles.\n   */\n  getTriangles() {\n    return this.triangles_;\n  }\n}\n\nexport default Triangulation;\n","/**\n * @module ol/renderer/canvas/ImageLayer\n */\nimport {ENABLE_RASTER_REPROJECTION} from '../../reproj/common.js';\nimport ViewHint from '../../ViewHint.js';\nimport {containsExtent, intersects} from '../../extent.js';\nimport {fromUserExtent} from '../../proj.js';\nimport {getIntersection, isEmpty} from '../../extent.js';\nimport CanvasLayerRenderer from './Layer.js';\nimport {compose as composeTransform, makeInverse, toString as transformToString} from '../../transform.js';\n\n/**\n * @classdesc\n * Canvas renderer for image layers.\n * @api\n */\nclass CanvasImageLayerRenderer extends CanvasLayerRenderer {\n\n  /**\n   * @param {import(\"../../layer/Image.js\").default} imageLayer Image layer.\n   */\n  constructor(imageLayer) {\n    super(imageLayer);\n\n    /**\n     * @protected\n     * @type {?import(\"../../ImageBase.js\").default}\n     */\n    this.image_ = null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImage() {\n    return !this.image_ ? null : this.image_.getImage();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState) {\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const viewResolution = viewState.resolution;\n\n    const imageSource = this.getLayer().getSource();\n\n    const hints = frameState.viewHints;\n\n    let renderedExtent = frameState.extent;\n    if (layerState.extent !== undefined) {\n      renderedExtent = getIntersection(renderedExtent, fromUserExtent(layerState.extent, viewState.projection));\n    }\n\n    if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] && !isEmpty(renderedExtent)) {\n      let projection = viewState.projection;\n      if (!ENABLE_RASTER_REPROJECTION) {\n        const sourceProjection = imageSource.getProjection();\n        if (sourceProjection) {\n          projection = sourceProjection;\n        }\n      }\n      const image = imageSource.getImage(renderedExtent, viewResolution, pixelRatio, projection);\n      if (image && this.loadImage(image)) {\n        this.image_ = image;\n      }\n    }\n\n    return !!this.image_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  renderFrame(frameState, target) {\n    const image = this.image_;\n    const imageExtent = image.getExtent();\n    const imageResolution = image.getResolution();\n    const imagePixelRatio = image.getPixelRatio();\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const viewCenter = viewState.center;\n    const viewResolution = viewState.resolution;\n    const size = frameState.size;\n    const scale = pixelRatio * imageResolution / (viewResolution * imagePixelRatio);\n\n    let width = Math.round(size[0] * pixelRatio);\n    let height = Math.round(size[1] * pixelRatio);\n    const rotation = viewState.rotation;\n    if (rotation) {\n      const size = Math.round(Math.sqrt(width * width + height * height));\n      width = height = size;\n    }\n\n    // set forward and inverse pixel transforms\n    composeTransform(this.pixelTransform,\n      frameState.size[0] / 2, frameState.size[1] / 2,\n      1 / pixelRatio, 1 / pixelRatio,\n      rotation,\n      -width / 2, -height / 2\n    );\n    makeInverse(this.inversePixelTransform, this.pixelTransform);\n\n    this.useContainer(target, this.pixelTransform, layerState.opacity);\n\n    const context = this.context;\n    const canvas = context.canvas;\n\n    if (canvas.width != width || canvas.height != height) {\n      canvas.width = width;\n      canvas.height = height;\n    } else if (!this.containerReused) {\n      context.clearRect(0, 0, width, height);\n    }\n\n    // clipped rendering if layer extent is set\n    let clipped = false;\n    if (layerState.extent) {\n      const layerExtent = fromUserExtent(layerState.extent, viewState.projection);\n      clipped = !containsExtent(layerExtent, frameState.extent) && intersects(layerExtent, frameState.extent);\n      if (clipped) {\n        this.clipUnrotated(context, frameState, layerExtent);\n      }\n    }\n\n    const img = image.getImage();\n\n    const transform = composeTransform(this.tempTransform_,\n      width / 2, height / 2,\n      scale, scale,\n      0,\n      imagePixelRatio * (imageExtent[0] - viewCenter[0]) / imageResolution,\n      imagePixelRatio * (viewCenter[1] - imageExtent[3]) / imageResolution);\n\n    this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;\n\n    const dx = transform[4];\n    const dy = transform[5];\n    const dw = img.width * transform[0];\n    const dh = img.height * transform[3];\n\n    this.preRender(context, frameState);\n    if (dw >= 0.5 && dh >= 0.5) {\n      const opacity = layerState.opacity;\n      let previousAlpha;\n      if (opacity !== 1) {\n        previousAlpha = this.context.globalAlpha;\n        this.context.globalAlpha = opacity;\n      }\n      this.context.drawImage(img, 0, 0, +img.width, +img.height,\n        Math.round(dx), Math.round(dy), Math.round(dw), Math.round(dh));\n      if (opacity !== 1) {\n        this.context.globalAlpha = previousAlpha;\n      }\n    }\n    this.postRender(context, frameState);\n\n    if (clipped) {\n      context.restore();\n    }\n\n    const canvasTransform = transformToString(this.pixelTransform);\n    if (canvasTransform !== canvas.style.transform) {\n      canvas.style.transform = canvasTransform;\n    }\n\n    return this.container;\n\n  }\n\n}\n\n\nexport default CanvasImageLayerRenderer;\n","!function(t,i){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=i():\"function\"==typeof define&&define.amd?define(i):(t=t||self).RBush=i()}(this,function(){\"use strict\";function t(t,r,e,a,h){!function t(n,r,e,a,h){for(;a>e;){if(a-e>600){var o=a-e+1,s=r-e+1,l=Math.log(o),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(o-f)/o)*(s-o/2<0?-1:1),m=Math.max(e,Math.floor(r-s*f/o+u)),c=Math.min(a,Math.floor(r+(o-s)*f/o+u));t(n,r,m,c,h)}var p=n[r],d=e,x=a;for(i(n,e,r),h(n[a],p)>0&&i(n,e,a);d<x;){for(i(n,d,x),d++,x--;h(n[d],p)<0;)d++;for(;h(n[x],p)>0;)x--}0===h(n[e],p)?i(n,e,x):i(n,++x,a),x<=r&&(e=x+1),r<=x&&(a=x-1)}}(t,r,e||0,a||t.length-1,h||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var h=t.children[a];o(e,t.leaf?r(h):h)}return e}function o(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function c(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var h=[n,r];h.length;)if(!((r=h.pop())-(n=h.pop())<=e)){var o=n+Math.ceil((r-n)/e/2)*e;t(i,o,n,r,a),h.push(n,o,o,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!c(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var h=i.children[a],o=i.leaf?r(h):h;c(t,o)&&(i.leaf?n.push(h):m(t,o)?this._all(h,n):e.push(h))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!c(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(c(t,a)){if(i.leaf||m(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,h=this.data,o=this.toBBox(t),s=[],l=[];h||s.length;){if(h||(h=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),h.leaf){var f=e(t,h.children,i);if(-1!==f)return h.children.splice(f,1),s.push(h),this._condense(s),this}a||h.leaf||!m(h,o)?r?(n++,h=r.children[n],a=!1):h=null:(s.push(h),l.push(n),n=0,r=h,h=h.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,h=n-i+1,o=this._maxEntries;if(h<=o)return a(e=p(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(h)/Math.log(o)),o=Math.ceil(h/Math.pow(o,r-1))),(e=p([])).leaf=!1,e.height=r;var s=Math.ceil(h/o),l=s*Math.ceil(Math.sqrt(o));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var m=f;m<=u;m+=s){var c=Math.min(m+s-1,u);e.children.push(this._build(t,m,c,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,h=void 0,o=0;o<i.children.length;o++){var s=i.children[o],l=f(s),u=(m=t,c=s,(Math.max(c.maxX,m.maxX)-Math.min(c.minX,m.minX))*(Math.max(c.maxY,m.maxY)-Math.min(c.minY,m.minY))-l);u<a?(a=u,e=l<e?l:e,h=s):u===a&&l<e&&(e=l,h=s)}i=h||i.children[0]}var m,c;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),o(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var h=this._chooseSplitIndex(n,e,r),o=p(n.children.splice(h,n.children.length-h));o.height=n.height,o.leaf=n.leaf,a(n,this.toBBox),a(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},r.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,o,s,l,u,m=1/0,c=1/0,p=i;p<=n-i;p++){var d=h(t,0,p,this.toBBox),x=h(t,p,n,this.toBBox),v=(e=d,a=x,o=void 0,s=void 0,l=void 0,u=void 0,o=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),u=Math.min(e.maxY,a.maxY),Math.max(0,l-o)*Math.max(0,u-s)),M=f(d)+f(x);v<m?(m=v,r=p,c=M<c?M:c):v===m&&M<c&&(c=M,r=p)}return r},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=h(t,0,i,e),s=h(t,n-i,n,e),l=u(a)+u(s),f=i;f<n-i;f++){var m=t.children[f];o(a,t.leaf?e(m):m),l+=u(a)}for(var c=n-i-1;c>=i;c--){var p=t.children[c];o(s,t.leaf?e(p):p),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)o(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r});\n","/**\n * @module ol/geom/flat/length\n */\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Length.\n */\nexport function lineStringLength(flatCoordinates, offset, end, stride) {\n  let x1 = flatCoordinates[offset];\n  let y1 = flatCoordinates[offset + 1];\n  let length = 0;\n  for (let i = offset + stride; i < end; i += stride) {\n    const x2 = flatCoordinates[i];\n    const y2 = flatCoordinates[i + 1];\n    length += Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n    x1 = x2;\n    y1 = y2;\n  }\n  return length;\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {number} end End.\n * @param {number} stride Stride.\n * @return {number} Perimeter.\n */\nexport function linearRingLength(flatCoordinates, offset, end, stride) {\n  let perimeter = lineStringLength(flatCoordinates, offset, end, stride);\n  const dx = flatCoordinates[end - stride] - flatCoordinates[offset];\n  const dy = flatCoordinates[end - stride + 1] - flatCoordinates[offset + 1];\n  perimeter += Math.sqrt(dx * dx + dy * dy);\n  return perimeter;\n}\n","/**\n * @module ol/geom/flat/center\n */\nimport {createEmpty, createOrUpdateFromFlatCoordinates} from '../../extent.js';\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {number} offset Offset.\n * @param {Array<Array<number>>} endss Endss.\n * @param {number} stride Stride.\n * @return {Array<number>} Flat centers.\n */\nexport function linearRingss(flatCoordinates, offset, endss, stride) {\n  const flatCenters = [];\n  let extent = createEmpty();\n  for (let i = 0, ii = endss.length; i < ii; ++i) {\n    const ends = endss[i];\n    extent = createOrUpdateFromFlatCoordinates(flatCoordinates, offset, ends[0], stride);\n    flatCenters.push((extent[0] + extent[2]) / 2, (extent[1] + extent[3]) / 2);\n    offset = ends[ends.length - 1];\n  }\n  return flatCenters;\n}\n","/**\n * @module ol/renderer/canvas/VectorLayer\n */\nimport {getUid} from '../../util.js';\nimport ViewHint from '../../ViewHint.js';\nimport {buffer, createEmpty, containsExtent, getWidth, intersects as intersectsExtent} from '../../extent.js';\nimport {fromUserExtent, toUserExtent, getUserProjection, getTransformFromProjections} from '../../proj.js';\nimport CanvasBuilderGroup from '../../render/canvas/BuilderGroup.js';\nimport ExecutorGroup, {replayDeclutter} from '../../render/canvas/ExecutorGroup.js';\nimport CanvasLayerRenderer from './Layer.js';\nimport {defaultOrder as defaultRenderOrder, getTolerance as getRenderTolerance, getSquaredTolerance as getSquaredRenderTolerance, renderFeature} from '../vector.js';\nimport {toString as transformToString, makeScale, makeInverse} from '../../transform.js';\n\n/**\n * @classdesc\n * Canvas renderer for vector layers.\n * @api\n */\nclass CanvasVectorLayerRenderer extends CanvasLayerRenderer {\n\n  /**\n   * @param {import(\"../../layer/Vector.js\").default} vectorLayer Vector layer.\n   */\n  constructor(vectorLayer) {\n\n    super(vectorLayer);\n\n    /** @private */\n    this.boundHandleStyleImageChange_ = this.handleStyleImageChange_.bind(this);\n\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.dirty_ = false;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedRevision_ = -1;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.renderedResolution_ = NaN;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.renderedExtent_ = createEmpty();\n\n    /**\n     * @private\n     * @type {function(import(\"../../Feature.js\").default, import(\"../../Feature.js\").default): number|null}\n     */\n    this.renderedRenderOrder_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../../render/canvas/ExecutorGroup\").default}\n     */\n    this.replayGroup_ = null;\n\n    /**\n     * A new replay group had to be created by `prepareFrame()`\n     * @type {boolean}\n     */\n    this.replayGroupChanged = true;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  useContainer(target, transform, opacity) {\n    if (opacity < 1) {\n      target = null;\n    }\n    super.useContainer(target, transform, opacity);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  renderFrame(frameState, target) {\n\n    const pixelRatio = frameState.pixelRatio;\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n\n    // set forward and inverse pixel transforms\n    makeScale(this.pixelTransform, 1 / pixelRatio, 1 / pixelRatio);\n    makeInverse(this.inversePixelTransform, this.pixelTransform);\n\n    this.useContainer(target, this.pixelTransform, layerState.opacity);\n    const context = this.context;\n    const canvas = context.canvas;\n\n    const replayGroup = this.replayGroup_;\n    if (!replayGroup || replayGroup.isEmpty()) {\n      if (!this.containerReused && canvas.width > 0) {\n        canvas.width = 0;\n      }\n      return this.container;\n    }\n\n    // resize and clear\n    const width = Math.round(frameState.size[0] * pixelRatio);\n    const height = Math.round(frameState.size[1] * pixelRatio);\n    if (canvas.width != width || canvas.height != height) {\n      canvas.width = width;\n      canvas.height = height;\n      const canvasTransform = transformToString(this.pixelTransform);\n      if (canvas.style.transform !== canvasTransform) {\n        canvas.style.transform = canvasTransform;\n      }\n    } else if (!this.containerReused) {\n      context.clearRect(0, 0, width, height);\n    }\n\n    this.preRender(context, frameState);\n\n    const extent = frameState.extent;\n    const viewState = frameState.viewState;\n    const projection = viewState.projection;\n    const rotation = viewState.rotation;\n    const projectionExtent = projection.getExtent();\n    const vectorSource = this.getLayer().getSource();\n\n    // clipped rendering if layer extent is set\n    let clipped = false;\n    if (layerState.extent) {\n      const layerExtent = fromUserExtent(layerState.extent, projection);\n      clipped = !containsExtent(layerExtent, frameState.extent) && intersectsExtent(layerExtent, frameState.extent);\n      if (clipped) {\n        this.clip(context, frameState, layerExtent);\n      }\n    }\n\n\n    const viewHints = frameState.viewHints;\n    const snapToPixel = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n\n    const transform = this.getRenderTransform(frameState, width, height, 0);\n    const declutterReplays = this.getLayer().getDeclutter() ? {} : null;\n    replayGroup.execute(context, transform, rotation, snapToPixel, undefined, declutterReplays);\n\n    if (vectorSource.getWrapX() && projection.canWrapX() && !containsExtent(projectionExtent, extent)) {\n      let startX = extent[0];\n      const worldWidth = getWidth(projectionExtent);\n      let world = 0;\n      let offsetX;\n      while (startX < projectionExtent[0]) {\n        --world;\n        offsetX = worldWidth * world;\n        const transform = this.getRenderTransform(frameState, width, height, offsetX);\n        replayGroup.execute(context, transform, rotation, snapToPixel, undefined, declutterReplays);\n        startX += worldWidth;\n      }\n      world = 0;\n      startX = extent[2];\n      while (startX > projectionExtent[2]) {\n        ++world;\n        offsetX = worldWidth * world;\n        const transform = this.getRenderTransform(frameState, width, height, offsetX);\n        replayGroup.execute(context, transform, rotation, snapToPixel, undefined, declutterReplays);\n        startX -= worldWidth;\n      }\n    }\n    if (declutterReplays) {\n      const viewHints = frameState.viewHints;\n      const hifi = !(viewHints[ViewHint.ANIMATING] || viewHints[ViewHint.INTERACTING]);\n      replayDeclutter(declutterReplays, context, rotation, 1, hifi, frameState.declutterItems);\n    }\n\n    if (clipped) {\n      context.restore();\n    }\n\n    this.postRender(context, frameState);\n\n    const opacity = layerState.opacity;\n    const container = this.container;\n    if (opacity !== parseFloat(container.style.opacity)) {\n      container.style.opacity = opacity === 1 ? '' : opacity;\n    }\n\n    return this.container;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures) {\n    if (!this.replayGroup_) {\n      return undefined;\n    } else {\n      const resolution = frameState.viewState.resolution;\n      const rotation = frameState.viewState.rotation;\n      const layer = this.getLayer();\n      /** @type {!Object<string, boolean>} */\n      const features = {};\n\n      const result = this.replayGroup_.forEachFeatureAtCoordinate(coordinate, resolution, rotation, hitTolerance,\n        /**\n         * @param {import(\"../../Feature.js\").FeatureLike} feature Feature.\n         * @return {?} Callback result.\n         */\n        function(feature) {\n          const key = getUid(feature);\n          if (!(key in features)) {\n            features[key] = true;\n            return callback(feature, layer);\n          }\n        }, layer.getDeclutter() ? declutteredFeatures : null);\n\n      return result;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleFontsChanged() {\n    const layer = this.getLayer();\n    if (layer.getVisible() && this.replayGroup_) {\n      layer.changed();\n    }\n  }\n\n  /**\n   * Handle changes in image style state.\n   * @param {import(\"../../events/Event.js\").default} event Image style change event.\n   * @private\n   */\n  handleStyleImageChange_(event) {\n    this.renderIfReadyAndVisible();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState) {\n    const vectorLayer = this.getLayer();\n    const vectorSource = vectorLayer.getSource();\n\n    const animating = frameState.viewHints[ViewHint.ANIMATING];\n    const interacting = frameState.viewHints[ViewHint.INTERACTING];\n    const updateWhileAnimating = vectorLayer.getUpdateWhileAnimating();\n    const updateWhileInteracting = vectorLayer.getUpdateWhileInteracting();\n\n    if (!this.dirty_ && (!updateWhileAnimating && animating) ||\n        (!updateWhileInteracting && interacting)) {\n      return true;\n    }\n\n    const frameStateExtent = frameState.extent;\n    const viewState = frameState.viewState;\n    const projection = viewState.projection;\n    const resolution = viewState.resolution;\n    const pixelRatio = frameState.pixelRatio;\n    const vectorLayerRevision = vectorLayer.getRevision();\n    const vectorLayerRenderBuffer = vectorLayer.getRenderBuffer();\n    let vectorLayerRenderOrder = vectorLayer.getRenderOrder();\n\n    if (vectorLayerRenderOrder === undefined) {\n      vectorLayerRenderOrder = defaultRenderOrder;\n    }\n\n    const extent = buffer(frameStateExtent,\n      vectorLayerRenderBuffer * resolution);\n    const projectionExtent = viewState.projection.getExtent();\n\n    if (vectorSource.getWrapX() && viewState.projection.canWrapX() &&\n        !containsExtent(projectionExtent, frameState.extent)) {\n      // For the replay group, we need an extent that intersects the real world\n      // (-180° to +180°). To support geometries in a coordinate range from -540°\n      // to +540°, we add at least 1 world width on each side of the projection\n      // extent. If the viewport is wider than the world, we need to add half of\n      // the viewport width to make sure we cover the whole viewport.\n      const worldWidth = getWidth(projectionExtent);\n      const gutter = Math.max(getWidth(extent) / 2, worldWidth);\n      extent[0] = projectionExtent[0] - gutter;\n      extent[2] = projectionExtent[2] + gutter;\n    }\n\n    if (!this.dirty_ &&\n        this.renderedResolution_ == resolution &&\n        this.renderedRevision_ == vectorLayerRevision &&\n        this.renderedRenderOrder_ == vectorLayerRenderOrder &&\n        containsExtent(this.renderedExtent_, extent)) {\n      this.replayGroupChanged = false;\n      return true;\n    }\n\n    if (this.replayGroup_) {\n      this.replayGroup_.dispose();\n    }\n    this.replayGroup_ = null;\n\n    this.dirty_ = false;\n\n    const replayGroup = new CanvasBuilderGroup(\n      getRenderTolerance(resolution, pixelRatio), extent, resolution,\n      pixelRatio, vectorLayer.getDeclutter());\n\n    const userProjection = getUserProjection();\n    let userTransform;\n    if (userProjection) {\n      vectorSource.loadFeatures(toUserExtent(extent, projection), resolution, userProjection);\n      userTransform = getTransformFromProjections(userProjection, projection);\n    } else {\n      vectorSource.loadFeatures(extent, resolution, projection);\n    }\n\n    const squaredTolerance = getSquaredRenderTolerance(resolution, pixelRatio);\n\n    /**\n     * @param {import(\"../../Feature.js\").default} feature Feature.\n     * @this {CanvasVectorLayerRenderer}\n     */\n    const render = function(feature) {\n      let styles;\n      const styleFunction = feature.getStyleFunction() || vectorLayer.getStyleFunction();\n      if (styleFunction) {\n        styles = styleFunction(feature, resolution);\n      }\n      if (styles) {\n        const dirty = this.renderFeature(feature, squaredTolerance, styles, replayGroup, userTransform);\n        this.dirty_ = this.dirty_ || dirty;\n      }\n    }.bind(this);\n\n    const userExtent = toUserExtent(extent, projection);\n    if (vectorLayerRenderOrder) {\n      /** @type {Array<import(\"../../Feature.js\").default>} */\n      const features = [];\n      vectorSource.forEachFeatureInExtent(userExtent,\n        /**\n         * @param {import(\"../../Feature.js\").default} feature Feature.\n         */\n        function(feature) {\n          features.push(feature);\n        });\n      features.sort(vectorLayerRenderOrder);\n      for (let i = 0, ii = features.length; i < ii; ++i) {\n        render(features[i]);\n      }\n    } else {\n      vectorSource.forEachFeatureInExtent(userExtent, render);\n    }\n\n    const replayGroupInstructions = replayGroup.finish();\n    const executorGroup = new ExecutorGroup(extent, resolution,\n      pixelRatio, vectorSource.getOverlaps(),\n      replayGroupInstructions, vectorLayer.getRenderBuffer());\n\n    this.renderedResolution_ = resolution;\n    this.renderedRevision_ = vectorLayerRevision;\n    this.renderedRenderOrder_ = vectorLayerRenderOrder;\n    this.renderedExtent_ = extent;\n    this.replayGroup_ = executorGroup;\n\n    this.replayGroupChanged = true;\n    return true;\n  }\n\n  /**\n   * @param {import(\"../../Feature.js\").default} feature Feature.\n   * @param {number} squaredTolerance Squared render tolerance.\n   * @param {import(\"../../style/Style.js\").default|Array<import(\"../../style/Style.js\").default>} styles The style or array of styles.\n   * @param {import(\"../../render/canvas/BuilderGroup.js\").default} builderGroup Builder group.\n   * @param {import(\"../../proj.js\").TransformFunction} opt_transform Transform from user to view projection.\n   * @return {boolean} `true` if an image is loading.\n   */\n  renderFeature(feature, squaredTolerance, styles, builderGroup, opt_transform) {\n    if (!styles) {\n      return false;\n    }\n    let loading = false;\n    if (Array.isArray(styles)) {\n      for (let i = 0, ii = styles.length; i < ii; ++i) {\n        loading = renderFeature(\n          builderGroup, feature, styles[i], squaredTolerance,\n          this.boundHandleStyleImageChange_, opt_transform) || loading;\n      }\n    } else {\n      loading = renderFeature(\n        builderGroup, feature, styles, squaredTolerance,\n        this.boundHandleStyleImageChange_, opt_transform);\n    }\n    return loading;\n  }\n}\n\n\nexport default CanvasVectorLayerRenderer;\n","/**\n * @module ol/style/TextPlacement\n */\n\n/**\n * Text placement. One of `'point'`, `'line'`. Default is `'point'`. Note that\n * `'line'` requires the underlying geometry to be a {@link module:ol/geom/LineString~LineString},\n * {@link module:ol/geom/Polygon~Polygon}, {@link module:ol/geom/MultiLineString~MultiLineString} or\n * {@link module:ol/geom/MultiPolygon~MultiPolygon}.\n * @enum {string}\n */\nexport default {\n  POINT: 'point',\n  LINE: 'line'\n};\n","/**\n * @module ol/style/Image\n */\nimport {abstract} from '../util.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} opacity\n * @property {boolean} rotateWithView\n * @property {number} rotation\n * @property {number} scale\n */\n\n\n/**\n * @classdesc\n * A base class used for creating subclasses and not instantiated in\n * apps. Base class for {@link module:ol/style/Icon~Icon}, {@link module:ol/style/Circle~CircleStyle} and\n * {@link module:ol/style/RegularShape~RegularShape}.\n * @abstract\n * @api\n */\nclass ImageStyle {\n  /**\n   * @param {Options} options Options.\n   */\n  constructor(options) {\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.opacity_ = options.opacity;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.rotateWithView_ = options.rotateWithView;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.rotation_ = options.rotation;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.scale_ = options.scale;\n\n  }\n\n  /**\n   * Clones the style.\n   * @return {ImageStyle} The cloned style.\n   * @api\n   */\n  clone() {\n    return new ImageStyle({\n      opacity: this.getOpacity(),\n      scale: this.getScale(),\n      rotation: this.getRotation(),\n      rotateWithView: this.getRotateWithView()\n    });\n  }\n\n  /**\n   * Get the symbolizer opacity.\n   * @return {number} Opacity.\n   * @api\n   */\n  getOpacity() {\n    return this.opacity_;\n  }\n\n  /**\n   * Determine whether the symbolizer rotates with the map.\n   * @return {boolean} Rotate with map.\n   * @api\n   */\n  getRotateWithView() {\n    return this.rotateWithView_;\n  }\n\n  /**\n   * Get the symoblizer rotation.\n   * @return {number} Rotation.\n   * @api\n   */\n  getRotation() {\n    return this.rotation_;\n  }\n\n  /**\n   * Get the symbolizer scale.\n   * @return {number} Scale.\n   * @api\n   */\n  getScale() {\n    return this.scale_;\n  }\n\n  /**\n   * Get the anchor point in pixels. The anchor determines the center point for the\n   * symbolizer.\n   * @abstract\n   * @return {Array<number>} Anchor.\n   */\n  getAnchor() {\n    return abstract();\n  }\n\n  /**\n   * Get the image element for the symbolizer.\n   * @abstract\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement} Image element.\n   */\n  getImage(pixelRatio) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {number} pixelRatio Pixel ratio.\n   * @return {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement} Image element.\n   */\n  getHitDetectionImage(pixelRatio) {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @return {import(\"../ImageState.js\").default} Image state.\n   */\n  getImageState() {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @return {import(\"../size.js\").Size} Image size.\n   */\n  getImageSize() {\n    return abstract();\n  }\n\n  /**\n   * @abstract\n   * @return {import(\"../size.js\").Size} Size of the hit-detection image.\n   */\n  getHitDetectionImageSize() {\n    return abstract();\n  }\n\n  /**\n   * Get the origin of the symbolizer.\n   * @abstract\n   * @return {Array<number>} Origin.\n   */\n  getOrigin() {\n    return abstract();\n  }\n\n  /**\n   * Get the size of the symbolizer (in pixels).\n   * @abstract\n   * @return {import(\"../size.js\").Size} Size.\n   */\n  getSize() {\n    return abstract();\n  }\n\n  /**\n   * Set the opacity.\n   *\n   * @param {number} opacity Opacity.\n   * @api\n   */\n  setOpacity(opacity) {\n    this.opacity_ = opacity;\n  }\n\n  /**\n   * Set whether to rotate the style with the view.\n   *\n   * @param {boolean} rotateWithView Rotate with map.\n   * @api\n   */\n  setRotateWithView(rotateWithView) {\n    this.rotateWithView_ = rotateWithView;\n  }\n\n  /**\n   * Set the rotation.\n   *\n   * @param {number} rotation Rotation.\n   * @api\n   */\n  setRotation(rotation) {\n    this.rotation_ = rotation;\n  }\n  /**\n   * Set the scale.\n   *\n   * @param {number} scale Scale.\n   * @api\n   */\n  setScale(scale) {\n    this.scale_ = scale;\n  }\n\n  /**\n   * @abstract\n   * @param {function(import(\"../events/Event.js\").default): void} listener Listener function.\n   * @template T\n   */\n  listenImageChange(listener) {\n    abstract();\n  }\n\n  /**\n   * Load not yet loaded URI.\n   * @abstract\n   */\n  load() {\n    abstract();\n  }\n\n  /**\n   * @abstract\n   * @param {function(import(\"../events/Event.js\").default): void} listener Listener function.\n   * @template T\n   */\n  unlistenImageChange(listener) {\n    abstract();\n  }\n}\n\nexport default ImageStyle;\n","/**\n * @module ol/ImageCanvas\n */\nimport ImageBase from './ImageBase.js';\nimport ImageState from './ImageState.js';\n\n\n/**\n * A function that is called to trigger asynchronous canvas drawing.  It is\n * called with a \"done\" callback that should be called when drawing is done.\n * If any error occurs during drawing, the \"done\" callback should be called with\n * that error.\n *\n * @typedef {function(function(Error=): void): void} Loader\n */\n\n\nclass ImageCanvas extends ImageBase {\n\n  /**\n   * @param {import(\"./extent.js\").Extent} extent Extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {HTMLCanvasElement} canvas Canvas.\n   * @param {Loader=} opt_loader Optional loader function to\n   *     support asynchronous canvas drawing.\n   */\n  constructor(extent, resolution, pixelRatio, canvas, opt_loader) {\n\n    const state = opt_loader !== undefined ? ImageState.IDLE : ImageState.LOADED;\n\n    super(extent, resolution, pixelRatio, state);\n\n    /**\n     * Optional canvas loader function.\n     * @type {?Loader}\n     * @private\n     */\n    this.loader_ = opt_loader !== undefined ? opt_loader : null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement}\n     */\n    this.canvas_ = canvas;\n\n    /**\n     * @private\n     * @type {Error}\n     */\n    this.error_ = null;\n\n  }\n\n  /**\n   * Get any error associated with asynchronous rendering.\n   * @return {Error} Any error that occurred during rendering.\n   */\n  getError() {\n    return this.error_;\n  }\n\n  /**\n   * Handle async drawing complete.\n   * @param {Error=} err Any error during drawing.\n   * @private\n   */\n  handleLoad_(err) {\n    if (err) {\n      this.error_ = err;\n      this.state = ImageState.ERROR;\n    } else {\n      this.state = ImageState.LOADED;\n    }\n    this.changed();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  load() {\n    if (this.state == ImageState.IDLE) {\n      this.state = ImageState.LOADING;\n      this.changed();\n      this.loader_(this.handleLoad_.bind(this));\n    }\n  }\n\n  /**\n   * @return {HTMLCanvasElement} Canvas element.\n   */\n  getImage() {\n    return this.canvas_;\n  }\n}\n\n\nexport default ImageCanvas;\n","/**\n * @module ol/interaction/DragAndDrop\n */\n// FIXME should handle all geo-referenced data, not just vector data\n\nimport {TRUE} from '../functions.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport Event from '../events/Event.js';\nimport EventType from '../events/EventType.js';\nimport Interaction from './Interaction.js';\nimport {get as getProjection} from '../proj.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {Array<typeof import(\"../format/Feature.js\").default>} [formatConstructors] Format constructors.\n * @property {import(\"../source/Vector.js\").default} [source] Optional vector source where features will be added.  If a source is provided\n * all existing features will be removed and new features will be added when\n * they are dropped on the target.  If you want to add features to a vector\n * source without removing the existing features (append only), instead of\n * providing the source option listen for the \"addfeatures\" event.\n * @property {import(\"../proj.js\").ProjectionLike} [projection] Target projection. By default, the map's view's projection is used.\n * @property {HTMLElement} [target] The element that is used as the drop target, default is the viewport element.\n */\n\n\n/**\n * @enum {string}\n */\nconst DragAndDropEventType = {\n  /**\n   * Triggered when features are added\n   * @event DragAndDropEvent#addfeatures\n   * @api\n   */\n  ADD_FEATURES: 'addfeatures'\n};\n\n\n/**\n * @classdesc\n * Events emitted by {@link module:ol/interaction/DragAndDrop~DragAndDrop} instances are instances\n * of this type.\n */\nclass DragAndDropEvent extends Event {\n\n  /**\n   * @param {DragAndDropEventType} type Type.\n   * @param {File} file File.\n   * @param {Array<import(\"../Feature.js\").default>=} opt_features Features.\n   * @param {import(\"../proj/Projection.js\").default=} opt_projection Projection.\n   */\n  constructor(type, file, opt_features, opt_projection) {\n\n    super(type);\n\n    /**\n     * The features parsed from dropped data.\n     * @type {Array<import(\"../Feature.js\").FeatureLike>|undefined}\n     * @api\n     */\n    this.features = opt_features;\n\n    /**\n     * The dropped file.\n     * @type {File}\n     * @api\n     */\n    this.file = file;\n\n    /**\n     * The feature projection.\n     * @type {import(\"../proj/Projection.js\").default|undefined}\n     * @api\n     */\n    this.projection = opt_projection;\n\n  }\n\n}\n\n\n/**\n * @classdesc\n * Handles input of vector data by drag and drop.\n * @api\n *\n * @fires DragAndDropEvent\n */\nclass DragAndDrop extends Interaction {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      handleEvent: TRUE\n    });\n\n    /**\n     * @private\n     * @type {Array<typeof import(\"../format/Feature.js\").default>}\n     */\n    this.formatConstructors_ = options.formatConstructors ?\n      options.formatConstructors : [];\n\n    /**\n     * @private\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.projection_ = options.projection ?\n      getProjection(options.projection) : null;\n\n    /**\n     * @private\n     * @type {?Array<import(\"../events.js\").EventsKey>}\n     */\n    this.dropListenKeys_ = null;\n\n    /**\n     * @private\n     * @type {import(\"../source/Vector.js\").default}\n     */\n    this.source_ = options.source || null;\n\n    /**\n     * @private\n     * @type {HTMLElement}\n     */\n    this.target = options.target ? options.target : null;\n\n  }\n\n  /**\n   * @param {File} file File.\n   * @param {Event} event Load event.\n   * @private\n   */\n  handleResult_(file, event) {\n    const result = event.target.result;\n    const map = this.getMap();\n    let projection = this.projection_;\n    if (!projection) {\n      const view = map.getView();\n      projection = view.getProjection();\n    }\n\n    const formatConstructors = this.formatConstructors_;\n    let features = [];\n    for (let i = 0, ii = formatConstructors.length; i < ii; ++i) {\n      const format = new formatConstructors[i]();\n      features = this.tryReadFeatures_(format, result, {\n        featureProjection: projection\n      });\n      if (features && features.length > 0) {\n        break;\n      }\n    }\n    if (this.source_) {\n      this.source_.clear();\n      this.source_.addFeatures(features);\n    }\n    this.dispatchEvent(\n      new DragAndDropEvent(\n        DragAndDropEventType.ADD_FEATURES, file,\n        features, projection));\n  }\n\n  /**\n   * @private\n   */\n  registerListeners_() {\n    const map = this.getMap();\n    if (map) {\n      const dropArea = this.target ? this.target : map.getViewport();\n      this.dropListenKeys_ = [\n        listen(dropArea, EventType.DROP, handleDrop, this),\n        listen(dropArea, EventType.DRAGENTER, handleStop, this),\n        listen(dropArea, EventType.DRAGOVER, handleStop, this),\n        listen(dropArea, EventType.DROP, handleStop, this)\n      ];\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setActive(active) {\n    if (!this.getActive() && active) {\n      this.registerListeners_();\n    }\n    if (this.getActive() && !active) {\n      this.unregisterListeners_();\n    }\n    super.setActive(active);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setMap(map) {\n    this.unregisterListeners_();\n    super.setMap(map);\n    if (this.getActive()) {\n      this.registerListeners_();\n    }\n  }\n\n  /**\n   * @param {import(\"../format/Feature.js\").default} format Format.\n   * @param {string} text Text.\n   * @param {import(\"../format/Feature.js\").ReadOptions} options Read options.\n   * @private\n   * @return {Array<import(\"../Feature.js\").FeatureLike>} Features.\n   */\n  tryReadFeatures_(format, text, options) {\n    try {\n      return format.readFeatures(text, options);\n    } catch (e) {\n      return null;\n    }\n  }\n\n  /**\n   * @private\n   */\n  unregisterListeners_() {\n    if (this.dropListenKeys_) {\n      this.dropListenKeys_.forEach(unlistenByKey);\n      this.dropListenKeys_ = null;\n    }\n  }\n}\n\n\n/**\n * @param {DragEvent} event Event.\n * @this {DragAndDrop}\n */\nfunction handleDrop(event) {\n  const files = event.dataTransfer.files;\n  for (let i = 0, ii = files.length; i < ii; ++i) {\n    const file = files.item(i);\n    const reader = new FileReader();\n    reader.addEventListener(EventType.LOAD, this.handleResult_.bind(this, file));\n    reader.readAsText(file);\n  }\n}\n\n\n/**\n * @param {DragEvent} event Event.\n */\nfunction handleStop(event) {\n  event.stopPropagation();\n  event.preventDefault();\n  event.dataTransfer.dropEffect = 'copy';\n}\n\n\nexport default DragAndDrop;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar cloneNode_1 = __importDefault(require(\"./cloneNode\"));\nvar embedWebFonts_1 = __importDefault(require(\"./embedWebFonts\"));\nvar embedImages_1 = __importDefault(require(\"./embedImages\"));\nvar createSvgDataURL_1 = __importDefault(require(\"./createSvgDataURL\"));\nvar applyStyleWithOptions_1 = __importDefault(require(\"./applyStyleWithOptions\"));\nvar utils_1 = require(\"./utils\");\nfunction getImageSize(domNode, options) {\n    if (options === void 0) { options = {}; }\n    var width = options.width || utils_1.getNodeWidth(domNode);\n    var height = options.height || utils_1.getNodeHeight(domNode);\n    return { width: width, height: height };\n}\nfunction toSvgDataURL(domNode, options) {\n    if (options === void 0) { options = {}; }\n    var _a = getImageSize(domNode, options), width = _a.width, height = _a.height;\n    return cloneNode_1.default(domNode, options.filter, true)\n        .then(function (clonedNode) { return embedWebFonts_1.default(clonedNode, options); })\n        .then(function (clonedNode) { return embedImages_1.default(clonedNode, options); })\n        .then(function (clonedNode) { return applyStyleWithOptions_1.default(clonedNode, options); })\n        .then(function (clonedNode) { return createSvgDataURL_1.default(clonedNode, width, height); });\n}\nexports.toSvgDataURL = toSvgDataURL;\nfunction toCanvas(domNode, options) {\n    if (options === void 0) { options = {}; }\n    return toSvgDataURL(domNode, options)\n        .then(utils_1.createImage)\n        .then(utils_1.delay(100))\n        .then(function (image) {\n        var canvas = document.createElement('canvas');\n        var context = canvas.getContext('2d');\n        var ratio = utils_1.getPixelRatio();\n        var _a = getImageSize(domNode, options), width = _a.width, height = _a.height;\n        canvas.width = width * ratio;\n        canvas.height = height * ratio;\n        canvas.style.width = \"\" + width;\n        canvas.style.height = \"\" + height;\n        context.scale(ratio, ratio);\n        if (options.backgroundColor) {\n            context.fillStyle = options.backgroundColor;\n            context.fillRect(0, 0, canvas.width, canvas.height);\n        }\n        context.drawImage(image, 0, 0);\n        return canvas;\n    });\n}\nexports.toCanvas = toCanvas;\nfunction toPixelData(domNode, options) {\n    if (options === void 0) { options = {}; }\n    var _a = getImageSize(domNode, options), width = _a.width, height = _a.height;\n    return toCanvas(domNode, options)\n        .then(function (canvas) { return (canvas.getContext('2d').getImageData(0, 0, width, height).data); });\n}\nexports.toPixelData = toPixelData;\nfunction toPng(domNode, options) {\n    if (options === void 0) { options = {}; }\n    return toCanvas(domNode, options).then(function (canvas) { return (canvas.toDataURL()); });\n}\nexports.toPng = toPng;\nfunction toJpeg(domNode, options) {\n    if (options === void 0) { options = {}; }\n    return toCanvas(domNode, options).then(function (canvas) { return (canvas.toDataURL('image/jpeg', options.quality || 1)); });\n}\nexports.toJpeg = toJpeg;\nfunction toBlob(domNode, options) {\n    if (options === void 0) { options = {}; }\n    return toCanvas(domNode, options).then(utils_1.canvasToBlob);\n}\nexports.toBlob = toBlob;\n","/**\n * @module ol/format/WKT\n */\nimport Feature from '../Feature.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport TextFeature from './TextFeature.js';\nimport GeometryCollection from '../geom/GeometryCollection.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\n\n\n/**\n * Geometry constructors\n * @enum {function (new:import(\"../geom/Geometry.js\").default, Array, GeometryLayout)}\n */\nconst GeometryConstructor = {\n  'POINT': Point,\n  'LINESTRING': LineString,\n  'POLYGON': Polygon,\n  'MULTIPOINT': MultiPoint,\n  'MULTILINESTRING': MultiLineString,\n  'MULTIPOLYGON': MultiPolygon\n};\n\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [splitCollection=false] Whether to split GeometryCollections into\n * multiple features on reading.\n */\n\n/**\n * @typedef {Object} Token\n * @property {number} type\n * @property {number|string} [value]\n * @property {number} position\n */\n\n/**\n * @const\n * @type {string}\n */\nconst EMPTY = 'EMPTY';\n\n\n/**\n * @const\n * @type {string}\n */\nconst Z = 'Z';\n\n\n/**\n * @const\n * @type {string}\n */\nconst M = 'M';\n\n\n/**\n * @const\n * @type {string}\n */\nconst ZM = 'ZM';\n\n\n/**\n * @const\n * @enum {number}\n */\nconst TokenType = {\n  TEXT: 1,\n  LEFT_PAREN: 2,\n  RIGHT_PAREN: 3,\n  NUMBER: 4,\n  COMMA: 5,\n  EOF: 6\n};\n\n/**\n * @const\n * @type {Object<string, string>}\n */\nconst WKTGeometryType = {};\nfor (const type in GeometryType) {\n  WKTGeometryType[type] = GeometryType[type].toUpperCase();\n}\n\n\n/**\n * Class to tokenize a WKT string.\n */\nclass Lexer {\n\n  /**\n   * @param {string} wkt WKT string.\n   */\n  constructor(wkt) {\n\n    /**\n     * @type {string}\n     */\n    this.wkt = wkt;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.index_ = -1;\n  }\n\n  /**\n   * @param {string} c Character.\n   * @return {boolean} Whether the character is alphabetic.\n   * @private\n   */\n  isAlpha_(c) {\n    return c >= 'a' && c <= 'z' || c >= 'A' && c <= 'Z';\n  }\n\n  /**\n   * @param {string} c Character.\n   * @param {boolean=} opt_decimal Whether the string number\n   *     contains a dot, i.e. is a decimal number.\n   * @return {boolean} Whether the character is numeric.\n   * @private\n   */\n  isNumeric_(c, opt_decimal) {\n    const decimal = opt_decimal !== undefined ? opt_decimal : false;\n    return c >= '0' && c <= '9' || c == '.' && !decimal;\n  }\n\n  /**\n   * @param {string} c Character.\n   * @return {boolean} Whether the character is whitespace.\n   * @private\n   */\n  isWhiteSpace_(c) {\n    return c == ' ' || c == '\\t' || c == '\\r' || c == '\\n';\n  }\n\n  /**\n   * @return {string} Next string character.\n   * @private\n   */\n  nextChar_() {\n    return this.wkt.charAt(++this.index_);\n  }\n\n  /**\n   * Fetch and return the next token.\n   * @return {!Token} Next string token.\n   */\n  nextToken() {\n    const c = this.nextChar_();\n    const position = this.index_;\n    /** @type {number|string} */\n    let value = c;\n    let type;\n\n    if (c == '(') {\n      type = TokenType.LEFT_PAREN;\n    } else if (c == ',') {\n      type = TokenType.COMMA;\n    } else if (c == ')') {\n      type = TokenType.RIGHT_PAREN;\n    } else if (this.isNumeric_(c) || c == '-') {\n      type = TokenType.NUMBER;\n      value = this.readNumber_();\n    } else if (this.isAlpha_(c)) {\n      type = TokenType.TEXT;\n      value = this.readText_();\n    } else if (this.isWhiteSpace_(c)) {\n      return this.nextToken();\n    } else if (c === '') {\n      type = TokenType.EOF;\n    } else {\n      throw new Error('Unexpected character: ' + c);\n    }\n\n    return {position: position, value: value, type: type};\n  }\n\n  /**\n   * @return {number} Numeric token value.\n   * @private\n   */\n  readNumber_() {\n    let c;\n    const index = this.index_;\n    let decimal = false;\n    let scientificNotation = false;\n    do {\n      if (c == '.') {\n        decimal = true;\n      } else if (c == 'e' || c == 'E') {\n        scientificNotation = true;\n      }\n      c = this.nextChar_();\n    } while (\n      this.isNumeric_(c, decimal) ||\n        // if we haven't detected a scientific number before, 'e' or 'E'\n        // hint that we should continue to read\n        !scientificNotation && (c == 'e' || c == 'E') ||\n        // once we know that we have a scientific number, both '-' and '+'\n        // are allowed\n        scientificNotation && (c == '-' || c == '+')\n    );\n    return parseFloat(this.wkt.substring(index, this.index_--));\n  }\n\n  /**\n   * @return {string} String token value.\n   * @private\n   */\n  readText_() {\n    let c;\n    const index = this.index_;\n    do {\n      c = this.nextChar_();\n    } while (this.isAlpha_(c));\n    return this.wkt.substring(index, this.index_--).toUpperCase();\n  }\n}\n\n/**\n * Class to parse the tokens from the WKT string.\n */\nclass Parser {\n\n  /**\n   * @param {Lexer} lexer The lexer.\n   */\n  constructor(lexer) {\n\n    /**\n     * @type {Lexer}\n     * @private\n     */\n    this.lexer_ = lexer;\n\n    /**\n     * @type {Token}\n     * @private\n     */\n    this.token_;\n\n    /**\n     * @type {GeometryLayout}\n     * @private\n     */\n    this.layout_ = GeometryLayout.XY;\n  }\n\n  /**\n   * Fetch the next token form the lexer and replace the active token.\n   * @private\n   */\n  consume_() {\n    this.token_ = this.lexer_.nextToken();\n  }\n\n  /**\n   * Tests if the given type matches the type of the current token.\n   * @param {TokenType} type Token type.\n   * @return {boolean} Whether the token matches the given type.\n   */\n  isTokenType(type) {\n    const isMatch = this.token_.type == type;\n    return isMatch;\n  }\n\n  /**\n   * If the given type matches the current token, consume it.\n   * @param {TokenType} type Token type.\n   * @return {boolean} Whether the token matches the given type.\n   */\n  match(type) {\n    const isMatch = this.isTokenType(type);\n    if (isMatch) {\n      this.consume_();\n    }\n    return isMatch;\n  }\n\n  /**\n   * Try to parse the tokens provided by the lexer.\n   * @return {import(\"../geom/Geometry.js\").default} The geometry.\n   */\n  parse() {\n    this.consume_();\n    const geometry = this.parseGeometry_();\n    return geometry;\n  }\n\n  /**\n   * Try to parse the dimensional info.\n   * @return {GeometryLayout} The layout.\n   * @private\n   */\n  parseGeometryLayout_() {\n    let layout = GeometryLayout.XY;\n    const dimToken = this.token_;\n    if (this.isTokenType(TokenType.TEXT)) {\n      const dimInfo = dimToken.value;\n      if (dimInfo === Z) {\n        layout = GeometryLayout.XYZ;\n      } else if (dimInfo === M) {\n        layout = GeometryLayout.XYM;\n      } else if (dimInfo === ZM) {\n        layout = GeometryLayout.XYZM;\n      }\n      if (layout !== GeometryLayout.XY) {\n        this.consume_();\n      }\n    }\n    return layout;\n  }\n\n  /**\n   * @return {!Array<import(\"../geom/Geometry.js\").default>} A collection of geometries.\n   * @private\n   */\n  parseGeometryCollectionText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      const geometries = [];\n      do {\n        geometries.push(this.parseGeometry_());\n      } while (this.match(TokenType.COMMA));\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return geometries;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return [];\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {Array<number>} All values in a point.\n   * @private\n   */\n  parsePointText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      const coordinates = this.parsePoint_();\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return coordinates;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return null;\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<!Array<number>>} All points in a linestring.\n   * @private\n   */\n  parseLineStringText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      const coordinates = this.parsePointList_();\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return coordinates;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return [];\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<!Array<!Array<number>>>} All points in a polygon.\n   * @private\n   */\n  parsePolygonText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      const coordinates = this.parseLineStringTextList_();\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return coordinates;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return [];\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<!Array<number>>} All points in a multipoint.\n   * @private\n   */\n  parseMultiPointText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      let coordinates;\n      if (this.token_.type == TokenType.LEFT_PAREN) {\n        coordinates = this.parsePointTextList_();\n      } else {\n        coordinates = this.parsePointList_();\n      }\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return coordinates;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return [];\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<!Array<!Array<number>>>} All linestring points\n   *                                          in a multilinestring.\n   * @private\n   */\n  parseMultiLineStringText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      const coordinates = this.parseLineStringTextList_();\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return coordinates;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return [];\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<!Array<!Array<!Array<number>>>>} All polygon points in a multipolygon.\n   * @private\n   */\n  parseMultiPolygonText_() {\n    if (this.match(TokenType.LEFT_PAREN)) {\n      const coordinates = this.parsePolygonTextList_();\n      if (this.match(TokenType.RIGHT_PAREN)) {\n        return coordinates;\n      }\n    } else if (this.isEmptyGeometry_()) {\n      return [];\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<number>} A point.\n   * @private\n   */\n  parsePoint_() {\n    const coordinates = [];\n    const dimensions = this.layout_.length;\n    for (let i = 0; i < dimensions; ++i) {\n      const token = this.token_;\n      if (this.match(TokenType.NUMBER)) {\n        coordinates.push(/** @type {number} */ (token.value));\n      } else {\n        break;\n      }\n    }\n    if (coordinates.length == dimensions) {\n      return coordinates;\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n\n  /**\n   * @return {!Array<!Array<number>>} An array of points.\n   * @private\n   */\n  parsePointList_() {\n    const coordinates = [this.parsePoint_()];\n    while (this.match(TokenType.COMMA)) {\n      coordinates.push(this.parsePoint_());\n    }\n    return coordinates;\n  }\n\n  /**\n   * @return {!Array<!Array<number>>} An array of points.\n   * @private\n   */\n  parsePointTextList_() {\n    const coordinates = [this.parsePointText_()];\n    while (this.match(TokenType.COMMA)) {\n      coordinates.push(this.parsePointText_());\n    }\n    return coordinates;\n  }\n\n  /**\n   * @return {!Array<!Array<!Array<number>>>} An array of points.\n   * @private\n   */\n  parseLineStringTextList_() {\n    const coordinates = [this.parseLineStringText_()];\n    while (this.match(TokenType.COMMA)) {\n      coordinates.push(this.parseLineStringText_());\n    }\n    return coordinates;\n  }\n\n  /**\n   * @return {!Array<!Array<!Array<!Array<number>>>>} An array of points.\n   * @private\n   */\n  parsePolygonTextList_() {\n    const coordinates = [this.parsePolygonText_()];\n    while (this.match(TokenType.COMMA)) {\n      coordinates.push(this.parsePolygonText_());\n    }\n    return coordinates;\n  }\n\n  /**\n   * @return {boolean} Whether the token implies an empty geometry.\n   * @private\n   */\n  isEmptyGeometry_() {\n    const isEmpty = this.isTokenType(TokenType.TEXT) &&\n        this.token_.value == EMPTY;\n    if (isEmpty) {\n      this.consume_();\n    }\n    return isEmpty;\n  }\n\n  /**\n   * Create an error message for an unexpected token error.\n   * @return {string} Error message.\n   * @private\n   */\n  formatErrorMessage_() {\n    return 'Unexpected `' + this.token_.value + '` at position ' +\n        this.token_.position + ' in `' + this.lexer_.wkt + '`';\n  }\n\n  /**\n   * @return {!import(\"../geom/Geometry.js\").default} The geometry.\n   * @private\n   */\n  parseGeometry_() {\n    const token = this.token_;\n    if (this.match(TokenType.TEXT)) {\n      const geomType = token.value;\n      this.layout_ = this.parseGeometryLayout_();\n      if (geomType == 'GEOMETRYCOLLECTION') {\n        const geometries = this.parseGeometryCollectionText_();\n        return new GeometryCollection(geometries);\n      } else {\n        const ctor = GeometryConstructor[geomType];\n        if (!ctor) {\n          throw new Error('Invalid geometry type: ' + geomType);\n        }\n\n        let coordinates;\n        switch (geomType) {\n          case 'POINT': {\n            coordinates = this.parsePointText_();\n            break;\n          }\n          case 'LINESTRING': {\n            coordinates = this.parseLineStringText_();\n            break;\n          }\n          case 'POLYGON': {\n            coordinates = this.parsePolygonText_();\n            break;\n          }\n          case 'MULTIPOINT': {\n            coordinates = this.parseMultiPointText_();\n            break;\n          }\n          case 'MULTILINESTRING': {\n            coordinates = this.parseMultiLineStringText_();\n            break;\n          }\n          case 'MULTIPOLYGON': {\n            coordinates = this.parseMultiPolygonText_();\n            break;\n          }\n          default: {\n            throw new Error('Invalid geometry type: ' + geomType);\n          }\n        }\n\n        if (!coordinates) {\n          if (ctor === GeometryConstructor['POINT']) {\n            coordinates = [NaN, NaN];\n          } else {\n            coordinates = [];\n          }\n        }\n        return new ctor(coordinates, this.layout_);\n      }\n    }\n    throw new Error(this.formatErrorMessage_());\n  }\n}\n\n\n/**\n * @classdesc\n * Geometry format for reading and writing data in the `WellKnownText` (WKT)\n * format.\n *\n * @api\n */\nclass WKT extends TextFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n\n    /**\n     * Split GeometryCollection into multiple features.\n     * @type {boolean}\n     * @private\n     */\n    this.splitCollection_ = options.splitCollection !== undefined ?\n      options.splitCollection : false;\n\n  }\n\n  /**\n   * Parse a WKT string.\n   * @param {string} wkt WKT string.\n   * @return {import(\"../geom/Geometry.js\").default|undefined}\n   *     The geometry created.\n   * @private\n   */\n  parse_(wkt) {\n    const lexer = new Lexer(wkt);\n    const parser = new Parser(lexer);\n    return parser.parse();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromText(text, opt_options) {\n    const geom = this.readGeometryFromText(text, opt_options);\n    if (geom) {\n      const feature = new Feature();\n      feature.setGeometry(geom);\n      return feature;\n    }\n    return null;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromText(text, opt_options) {\n    let geometries = [];\n    const geometry = this.readGeometryFromText(text, opt_options);\n    if (this.splitCollection_ &&\n        geometry.getType() == GeometryType.GEOMETRY_COLLECTION) {\n      geometries = (/** @type {GeometryCollection} */ (geometry))\n        .getGeometriesArray();\n    } else {\n      geometries = [geometry];\n    }\n    const features = [];\n    for (let i = 0, ii = geometries.length; i < ii; ++i) {\n      const feature = new Feature();\n      feature.setGeometry(geometries[i]);\n      features.push(feature);\n    }\n    return features;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readGeometryFromText(text, opt_options) {\n    const geometry = this.parse_(text);\n    if (geometry) {\n      return transformGeometryWithOptions(geometry, false, opt_options);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  writeFeatureText(feature, opt_options) {\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      return this.writeGeometryText(geometry, opt_options);\n    }\n    return '';\n  }\n\n  /**\n   * @inheritDoc\n   */\n  writeFeaturesText(features, opt_options) {\n    if (features.length == 1) {\n      return this.writeFeatureText(features[0], opt_options);\n    }\n    const geometries = [];\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      geometries.push(features[i].getGeometry());\n    }\n    const collection = new GeometryCollection(geometries);\n    return this.writeGeometryText(collection, opt_options);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  writeGeometryText(geometry, opt_options) {\n    return encode(transformGeometryWithOptions(geometry, true, opt_options));\n  }\n}\n\n\n/**\n * @param {Point} geom Point geometry.\n * @return {string} Coordinates part of Point as WKT.\n */\nfunction encodePointGeometry(geom) {\n  const coordinates = geom.getCoordinates();\n  if (coordinates.length === 0) {\n    return '';\n  }\n  return coordinates.join(' ');\n}\n\n\n/**\n * @param {MultiPoint} geom MultiPoint geometry.\n * @return {string} Coordinates part of MultiPoint as WKT.\n */\nfunction encodeMultiPointGeometry(geom) {\n  const array = [];\n  const components = geom.getPoints();\n  for (let i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + encodePointGeometry(components[i]) + ')');\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {GeometryCollection} geom GeometryCollection geometry.\n * @return {string} Coordinates part of GeometryCollection as WKT.\n */\nfunction encodeGeometryCollectionGeometry(geom) {\n  const array = [];\n  const geoms = geom.getGeometries();\n  for (let i = 0, ii = geoms.length; i < ii; ++i) {\n    array.push(encode(geoms[i]));\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {LineString|import(\"../geom/LinearRing.js\").default} geom LineString geometry.\n * @return {string} Coordinates part of LineString as WKT.\n */\nfunction encodeLineStringGeometry(geom) {\n  const coordinates = geom.getCoordinates();\n  const array = [];\n  for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n    array.push(coordinates[i].join(' '));\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {MultiLineString} geom MultiLineString geometry.\n * @return {string} Coordinates part of MultiLineString as WKT.\n */\nfunction encodeMultiLineStringGeometry(geom) {\n  const array = [];\n  const components = geom.getLineStrings();\n  for (let i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + encodeLineStringGeometry(components[i]) + ')');\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {Polygon} geom Polygon geometry.\n * @return {string} Coordinates part of Polygon as WKT.\n */\nfunction encodePolygonGeometry(geom) {\n  const array = [];\n  const rings = geom.getLinearRings();\n  for (let i = 0, ii = rings.length; i < ii; ++i) {\n    array.push('(' + encodeLineStringGeometry(rings[i]) + ')');\n  }\n  return array.join(',');\n}\n\n\n/**\n * @param {MultiPolygon} geom MultiPolygon geometry.\n * @return {string} Coordinates part of MultiPolygon as WKT.\n */\nfunction encodeMultiPolygonGeometry(geom) {\n  const array = [];\n  const components = geom.getPolygons();\n  for (let i = 0, ii = components.length; i < ii; ++i) {\n    array.push('(' + encodePolygonGeometry(components[i]) + ')');\n  }\n  return array.join(',');\n}\n\n/**\n * @param {import(\"../geom/SimpleGeometry.js\").default} geom SimpleGeometry geometry.\n * @return {string} Potential dimensional information for WKT type.\n */\nfunction encodeGeometryLayout(geom) {\n  const layout = geom.getLayout();\n  let dimInfo = '';\n  if (layout === GeometryLayout.XYZ || layout === GeometryLayout.XYZM) {\n    dimInfo += Z;\n  }\n  if (layout === GeometryLayout.XYM || layout === GeometryLayout.XYZM) {\n    dimInfo += M;\n  }\n  return dimInfo;\n}\n\n\n/**\n * @const\n * @type {Object<string, function(import(\"../geom/Geometry.js\").default): string>}\n */\nconst GeometryEncoder = {\n  'Point': encodePointGeometry,\n  'LineString': encodeLineStringGeometry,\n  'Polygon': encodePolygonGeometry,\n  'MultiPoint': encodeMultiPointGeometry,\n  'MultiLineString': encodeMultiLineStringGeometry,\n  'MultiPolygon': encodeMultiPolygonGeometry,\n  'GeometryCollection': encodeGeometryCollectionGeometry\n};\n\n\n/**\n * Encode a geometry as WKT.\n * @param {!import(\"../geom/Geometry.js\").default} geom The geometry to encode.\n * @return {string} WKT string for the geometry.\n */\nfunction encode(geom) {\n  let type = geom.getType();\n  const geometryEncoder = GeometryEncoder[type];\n  const enc = geometryEncoder(geom);\n  type = type.toUpperCase();\n  if (typeof /** @type {?} */ (geom).getFlatCoordinates === 'function') {\n    const dimInfo = encodeGeometryLayout(/** @type {import(\"../geom/SimpleGeometry.js\").default} */ (geom));\n    if (dimInfo.length > 0) {\n      type += ' ' + dimInfo;\n    }\n  }\n  if (enc.length === 0) {\n    return type + ' ' + EMPTY;\n  }\n  return type + '(' + enc + ')';\n}\n\n\nexport default WKT;\n","/**\n * @module ol/control/OverviewMap\n */\nimport PluggableMap from '../PluggableMap.js';\nimport CompositeMapRenderer from '../renderer/Composite.js';\nimport MapEventType from '../MapEventType.js';\nimport MapProperty from '../MapProperty.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport Overlay from '../Overlay.js';\nimport OverlayPositioning from '../OverlayPositioning.js';\nimport ViewProperty from '../ViewProperty.js';\nimport Control from './Control.js';\nimport {fromExtent as polygonFromExtent} from '../geom/Polygon.js';\nimport {CLASS_CONTROL, CLASS_UNSELECTABLE, CLASS_COLLAPSED} from '../css.js';\nimport {replaceNode} from '../dom.js';\nimport {listen, listenOnce} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {containsExtent, equals as equalsExtent, getBottomRight, getTopLeft, scaleFromCenter} from '../extent.js';\n\n\n/**\n * Maximum width and/or height extent ratio that determines when the overview\n * map should be zoomed out.\n * @type {number}\n */\nconst MAX_RATIO = 0.75;\n\n\n/**\n * Minimum width and/or height extent ratio that determines when the overview\n * map should be zoomed in.\n * @type {number}\n */\nconst MIN_RATIO = 0.1;\n\n\nclass ControlledMap extends PluggableMap {\n  createRenderer() {\n    return new CompositeMapRenderer(this);\n  }\n}\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-overviewmap'] CSS class name.\n * @property {boolean} [collapsed=true] Whether the control should start collapsed or not (expanded).\n * @property {string|HTMLElement} [collapseLabel='«'] Text label to use for the\n * expanded overviewmap button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {boolean} [collapsible=true] Whether the control can be collapsed or not.\n * @property {string|HTMLElement} [label='»'] Text label to use for the collapsed\n * overviewmap button. Instead of text, also an element (e.g. a `span` element) can be used.\n * @property {Array<import(\"../layer/Layer.js\").default>|import(\"../Collection.js\").default<import(\"../layer/Layer.js\").default>} [layers]\n * Layers for the overview map.\n * @property {function(import(\"../MapEvent.js\").default)} [render] Function called when the control\n * should be re-rendered. This is called in a `requestAnimationFrame` callback.\n * @property {boolean} [rotateWithView=false] Whether the control view should rotate with the main map view.\n * @property {HTMLElement|string} [target] Specify a target if you want the control\n * to be rendered outside of the map's viewport.\n * @property {string} [tipLabel='Overview map'] Text label to use for the button tip.\n * @property {import(\"../View.js\").default} [view] Custom view for the overview map. If not provided,\n * a default view with an EPSG:3857 projection will be used.\n */\n\n\n/**\n * Create a new control with a map acting as an overview map for another\n * defined map.\n *\n * @api\n */\nclass OverviewMap extends Control {\n\n  /**\n   * @param {Options=} opt_options OverviewMap options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super({\n      element: document.createElement('div'),\n      render: options.render || render,\n      target: options.target\n    });\n\n    /**\n     * @private\n     */\n    this.boundHandleRotationChanged_ = this.handleRotationChanged_.bind(this);\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.collapsed_ = options.collapsed !== undefined ? options.collapsed : true;\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.collapsible_ = options.collapsible !== undefined ?\n      options.collapsible : true;\n\n    if (!this.collapsible_) {\n      this.collapsed_ = false;\n    }\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.rotateWithView_ = options.rotateWithView !== undefined ?\n      options.rotateWithView : false;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent|undefined}\n     */\n    this.viewExtent_ = undefined;\n\n    const className = options.className !== undefined ? options.className : 'ol-overviewmap';\n\n    const tipLabel = options.tipLabel !== undefined ? options.tipLabel : 'Overview map';\n\n    const collapseLabel = options.collapseLabel !== undefined ? options.collapseLabel : '\\u00AB';\n\n    if (typeof collapseLabel === 'string') {\n      /**\n       * @private\n       * @type {HTMLElement}\n       */\n      this.collapseLabel_ = document.createElement('span');\n      this.collapseLabel_.textContent = collapseLabel;\n    } else {\n      this.collapseLabel_ = collapseLabel;\n    }\n\n    const label = options.label !== undefined ? options.label : '\\u00BB';\n\n\n    if (typeof label === 'string') {\n      /**\n       * @private\n       * @type {HTMLElement}\n       */\n      this.label_ = document.createElement('span');\n      this.label_.textContent = label;\n    } else {\n      this.label_ = label;\n    }\n\n    const activeLabel = (this.collapsible_ && !this.collapsed_) ?\n      this.collapseLabel_ : this.label_;\n    const button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.title = tipLabel;\n    button.appendChild(activeLabel);\n\n    button.addEventListener(EventType.CLICK, this.handleClick_.bind(this), false);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     */\n    this.ovmapDiv_ = document.createElement('div');\n    this.ovmapDiv_.className = 'ol-overviewmap-map';\n\n    /**\n     * @type {ControlledMap}\n     * @private\n     */\n    this.ovmap_ = new ControlledMap({\n      view: options.view\n    });\n    const ovmap = this.ovmap_;\n\n    if (options.layers) {\n      options.layers.forEach(function(layer) {\n        ovmap.addLayer(layer);\n      });\n    }\n\n    const box = document.createElement('div');\n    box.className = 'ol-overviewmap-box';\n    box.style.boxSizing = 'border-box';\n\n    /**\n     * @type {import(\"../Overlay.js\").default}\n     * @private\n     */\n    this.boxOverlay_ = new Overlay({\n      position: [0, 0],\n      positioning: OverlayPositioning.CENTER_CENTER,\n      element: box\n    });\n    this.ovmap_.addOverlay(this.boxOverlay_);\n\n    const cssClasses = className + ' ' + CLASS_UNSELECTABLE + ' ' + CLASS_CONTROL +\n        (this.collapsed_ && this.collapsible_ ? ' ' + CLASS_COLLAPSED : '') +\n        (this.collapsible_ ? '' : ' ol-uncollapsible');\n    const element = this.element;\n    element.className = cssClasses;\n    element.appendChild(this.ovmapDiv_);\n    element.appendChild(button);\n\n    /* Interactive map */\n\n    const scope = this;\n\n    const overlay = this.boxOverlay_;\n    const overlayBox = this.boxOverlay_.getElement();\n\n    /* Functions definition */\n\n    const computeDesiredMousePosition = function(mousePosition) {\n      return {\n        clientX: mousePosition.clientX - (overlayBox.offsetWidth / 2),\n        clientY: mousePosition.clientY + (overlayBox.offsetHeight / 2)\n      };\n    };\n\n    const move = function(event) {\n      const position = /** @type {?} */ (computeDesiredMousePosition(event));\n      const coordinates = ovmap.getEventCoordinateInternal(/** @type {Event} */ (position));\n\n      overlay.setPosition(coordinates);\n    };\n\n    const endMoving = function(event) {\n      const coordinates = ovmap.getEventCoordinateInternal(event);\n\n      scope.getMap().getView().setCenterInternal(coordinates);\n\n      window.removeEventListener('mousemove', move);\n      window.removeEventListener('mouseup', endMoving);\n    };\n\n    /* Binding */\n\n    overlayBox.addEventListener('mousedown', function() {\n      window.addEventListener('mousemove', move);\n      window.addEventListener('mouseup', endMoving);\n    });\n\n  }\n\n  /**\n   * @inheritDoc\n   * @api\n   */\n  setMap(map) {\n    const oldMap = this.getMap();\n    if (map === oldMap) {\n      return;\n    }\n    if (oldMap) {\n      const oldView = oldMap.getView();\n      if (oldView) {\n        this.unbindView_(oldView);\n      }\n      this.ovmap_.setTarget(null);\n    }\n    super.setMap(map);\n\n    if (map) {\n      this.ovmap_.setTarget(this.ovmapDiv_);\n      this.listenerKeys.push(listen(\n        map, ObjectEventType.PROPERTYCHANGE,\n        this.handleMapPropertyChange_, this));\n\n      const view = map.getView();\n      if (view) {\n        this.bindView_(view);\n        if (view.isDef()) {\n          this.ovmap_.updateSize();\n          this.resetExtent_();\n        }\n      }\n    }\n  }\n\n  /**\n   * Handle map property changes.  This only deals with changes to the map's view.\n   * @param {import(\"../Object.js\").ObjectEvent} event The propertychange event.\n   * @private\n   */\n  handleMapPropertyChange_(event) {\n    if (event.key === MapProperty.VIEW) {\n      const oldView = /** @type {import(\"../View.js\").default} */ (event.oldValue);\n      if (oldView) {\n        this.unbindView_(oldView);\n      }\n      const newView = this.getMap().getView();\n      this.bindView_(newView);\n    }\n  }\n\n  /**\n   * Register listeners for view property changes.\n   * @param {import(\"../View.js\").default} view The view.\n   * @private\n   */\n  bindView_(view) {\n    view.addEventListener(getChangeEventType(ViewProperty.ROTATION), this.boundHandleRotationChanged_);\n  }\n\n  /**\n   * Unregister listeners for view property changes.\n   * @param {import(\"../View.js\").default} view The view.\n   * @private\n   */\n  unbindView_(view) {\n    view.removeEventListener(getChangeEventType(ViewProperty.ROTATION), this.boundHandleRotationChanged_);\n  }\n\n  /**\n   * Handle rotation changes to the main map.\n   * @private\n   */\n  handleRotationChanged_() {\n    if (this.rotateWithView_) {\n      this.ovmap_.getView().setRotation(this.getMap().getView().getRotation());\n    }\n  }\n\n  /**\n   * Reset the overview map extent if the box size (width or\n   * height) is less than the size of the overview map size times minRatio\n   * or is greater than the size of the overview size times maxRatio.\n   *\n   * If the map extent was not reset, the box size can fits in the defined\n   * ratio sizes. This method then checks if is contained inside the overview\n   * map current extent. If not, recenter the overview map to the current\n   * main map center location.\n   * @private\n   */\n  validateExtent_() {\n    const map = this.getMap();\n    const ovmap = this.ovmap_;\n\n    if (!map.isRendered() || !ovmap.isRendered()) {\n      return;\n    }\n\n    const mapSize = /** @type {import(\"../size.js\").Size} */ (map.getSize());\n\n    const view = map.getView();\n    const extent = view.calculateExtentInternal(mapSize);\n\n    if (this.viewExtent_ && equalsExtent(extent, this.viewExtent_)) {\n      // repeats of the same extent may indicate constraint conflicts leading to an endless cycle\n      return;\n    }\n    this.viewExtent_ = extent;\n\n    const ovmapSize = /** @type {import(\"../size.js\").Size} */ (ovmap.getSize());\n\n    const ovview = ovmap.getView();\n    const ovextent = ovview.calculateExtentInternal(ovmapSize);\n\n    const topLeftPixel =\n        ovmap.getPixelFromCoordinateInternal(getTopLeft(extent));\n    const bottomRightPixel =\n        ovmap.getPixelFromCoordinateInternal(getBottomRight(extent));\n\n    const boxWidth = Math.abs(topLeftPixel[0] - bottomRightPixel[0]);\n    const boxHeight = Math.abs(topLeftPixel[1] - bottomRightPixel[1]);\n\n    const ovmapWidth = ovmapSize[0];\n    const ovmapHeight = ovmapSize[1];\n\n    if (boxWidth < ovmapWidth * MIN_RATIO ||\n        boxHeight < ovmapHeight * MIN_RATIO ||\n        boxWidth > ovmapWidth * MAX_RATIO ||\n        boxHeight > ovmapHeight * MAX_RATIO) {\n      this.resetExtent_();\n    } else if (!containsExtent(ovextent, extent)) {\n      this.recenter_();\n    }\n  }\n\n  /**\n   * Reset the overview map extent to half calculated min and max ratio times\n   * the extent of the main map.\n   * @private\n   */\n  resetExtent_() {\n    if (MAX_RATIO === 0 || MIN_RATIO === 0) {\n      return;\n    }\n\n    const map = this.getMap();\n    const ovmap = this.ovmap_;\n\n    const mapSize = /** @type {import(\"../size.js\").Size} */ (map.getSize());\n\n    const view = map.getView();\n    const extent = view.calculateExtentInternal(mapSize);\n\n    const ovview = ovmap.getView();\n\n    // get how many times the current map overview could hold different\n    // box sizes using the min and max ratio, pick the step in the middle used\n    // to calculate the extent from the main map to set it to the overview map,\n    const steps = Math.log(\n      MAX_RATIO / MIN_RATIO) / Math.LN2;\n    const ratio = 1 / (Math.pow(2, steps / 2) * MIN_RATIO);\n    scaleFromCenter(extent, ratio);\n    ovview.fitInternal(polygonFromExtent(extent));\n  }\n\n  /**\n   * Set the center of the overview map to the map center without changing its\n   * resolution.\n   * @private\n   */\n  recenter_() {\n    const map = this.getMap();\n    const ovmap = this.ovmap_;\n\n    const view = map.getView();\n\n    const ovview = ovmap.getView();\n\n    ovview.setCenterInternal(view.getCenterInternal());\n  }\n\n  /**\n   * Update the box using the main map extent\n   * @private\n   */\n  updateBox_() {\n    const map = this.getMap();\n    const ovmap = this.ovmap_;\n\n    if (!map.isRendered() || !ovmap.isRendered()) {\n      return;\n    }\n\n    const mapSize = /** @type {import(\"../size.js\").Size} */ (map.getSize());\n\n    const view = map.getView();\n\n    const ovview = ovmap.getView();\n\n    const rotation = this.rotateWithView_ ? 0 : -view.getRotation();\n\n    const overlay = this.boxOverlay_;\n    const box = this.boxOverlay_.getElement();\n    const center = view.getCenterInternal();\n    const resolution = view.getResolution();\n    const ovresolution = ovview.getResolution();\n    const width = mapSize[0] * resolution / ovresolution;\n    const height = mapSize[1] * resolution / ovresolution;\n\n    // set position using center coordinates\n    overlay.setPosition(center);\n\n    // set box size calculated from map extent size and overview map resolution\n    if (box) {\n      box.style.width = width + 'px';\n      box.style.height = height + 'px';\n      const transform = 'rotate(' + rotation + 'rad)';\n      box.style.transform = transform;\n    }\n  }\n\n  /**\n   * @param {MouseEvent} event The event to handle\n   * @private\n   */\n  handleClick_(event) {\n    event.preventDefault();\n    this.handleToggle_();\n  }\n\n  /**\n   * @private\n   */\n  handleToggle_() {\n    this.element.classList.toggle(CLASS_COLLAPSED);\n    if (this.collapsed_) {\n      replaceNode(this.collapseLabel_, this.label_);\n    } else {\n      replaceNode(this.label_, this.collapseLabel_);\n    }\n    this.collapsed_ = !this.collapsed_;\n\n    // manage overview map if it had not been rendered before and control\n    // is expanded\n    const ovmap = this.ovmap_;\n    if (!this.collapsed_) {\n      if (ovmap.isRendered()) {\n        this.viewExtent_ = undefined;\n        ovmap.render();\n        return;\n      }\n      ovmap.updateSize();\n      this.resetExtent_();\n      listenOnce(ovmap, MapEventType.POSTRENDER,\n        function(event) {\n          this.updateBox_();\n        },\n        this);\n    }\n  }\n\n  /**\n   * Return `true` if the overview map is collapsible, `false` otherwise.\n   * @return {boolean} True if the widget is collapsible.\n   * @api\n   */\n  getCollapsible() {\n    return this.collapsible_;\n  }\n\n  /**\n   * Set whether the overview map should be collapsible.\n   * @param {boolean} collapsible True if the widget is collapsible.\n   * @api\n   */\n  setCollapsible(collapsible) {\n    if (this.collapsible_ === collapsible) {\n      return;\n    }\n    this.collapsible_ = collapsible;\n    this.element.classList.toggle('ol-uncollapsible');\n    if (!collapsible && this.collapsed_) {\n      this.handleToggle_();\n    }\n  }\n\n  /**\n   * Collapse or expand the overview map according to the passed parameter. Will\n   * not do anything if the overview map isn't collapsible or if the current\n   * collapsed state is already the one requested.\n   * @param {boolean} collapsed True if the widget is collapsed.\n   * @api\n   */\n  setCollapsed(collapsed) {\n    if (!this.collapsible_ || this.collapsed_ === collapsed) {\n      return;\n    }\n    this.handleToggle_();\n  }\n\n  /**\n   * Determine if the overview map is collapsed.\n   * @return {boolean} The overview map is collapsed.\n   * @api\n   */\n  getCollapsed() {\n    return this.collapsed_;\n  }\n\n  /**\n   * Return `true` if the overview map view can rotate, `false` otherwise.\n   * @return {boolean} True if the control view can rotate.\n   * @api\n   */\n  getRotateWithView() {\n    return this.rotateWithView_;\n  }\n\n  /**\n   * Set whether the overview map view should rotate with the main map view.\n   * @param {boolean} rotateWithView True if the control view should rotate.\n   * @api\n   */\n  setRotateWithView(rotateWithView) {\n    if (this.rotateWithView_ === rotateWithView) {\n      return;\n    }\n    this.rotateWithView_ = rotateWithView;\n    if (this.getMap().getView().getRotation() !== 0) {\n      if (this.rotateWithView_) {\n        this.handleRotationChanged_();\n      } else {\n        this.ovmap_.getView().setRotation(0);\n      }\n      this.viewExtent_ = undefined;\n      this.validateExtent_();\n      this.updateBox_();\n    }\n  }\n\n  /**\n   * Return the overview map.\n   * @return {import(\"../PluggableMap.js\").default} Overview map.\n   * @api\n   */\n  getOverviewMap() {\n    return this.ovmap_;\n  }\n}\n\n\n/**\n * Update the overview map element.\n * @param {import(\"../MapEvent.js\").default} mapEvent Map event.\n * @this {OverviewMap}\n * @api\n */\nexport function render(mapEvent) {\n  this.validateExtent_();\n  this.updateBox_();\n}\n\n\nexport default OverviewMap;\n","/**\n * @module ol/source/ImageStatic\n */\n\nimport ImageWrapper from '../Image.js';\nimport ImageState from '../ImageState.js';\nimport {createCanvasContext2D} from '../dom.js';\nimport EventType from '../events/EventType.js';\nimport {intersects, getHeight, getWidth} from '../extent.js';\nimport {get as getProjection} from '../proj.js';\nimport ImageSource, {defaultImageLoadFunction} from './Image.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {null|string} [crossOrigin] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {import(\"../extent.js\").Extent} [imageExtent] Extent of the image in map coordinates.\n * This is the [left, bottom, right, top] map coordinates of your image.\n * @property {import(\"../Image.js\").LoadFunction} [imageLoadFunction] Optional function to load an image given a URL.\n * @property {import(\"../proj.js\").ProjectionLike} projection Projection.\n * @property {import(\"../size.js\").Size} [imageSize] Size of the image in pixels. Usually the image size is auto-detected, so this\n * only needs to be set if auto-detection fails for some reason.\n * @property {string} url Image URL.\n */\n\n\n/**\n * @classdesc\n * A layer source for displaying a single, static image.\n * @api\n */\nclass Static extends ImageSource {\n  /**\n   * @param {Options} options ImageStatic options.\n   */\n  constructor(options) {\n    const crossOrigin = options.crossOrigin !== undefined ?\n      options.crossOrigin : null;\n\n    const /** @type {import(\"../Image.js\").LoadFunction} */ imageLoadFunction =\n        options.imageLoadFunction !== undefined ?\n          options.imageLoadFunction : defaultImageLoadFunction;\n\n    super({\n      attributions: options.attributions,\n      projection: getProjection(options.projection)\n    });\n\n    /**\n     * @private\n     * @type {string}\n     */\n    this.url_ = options.url;\n\n    /**\n     * @private\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.imageExtent_ = options.imageExtent;\n\n    /**\n     * @private\n     * @type {import(\"../Image.js\").default}\n     */\n    this.image_ = new ImageWrapper(this.imageExtent_, undefined, 1, this.url_, crossOrigin, imageLoadFunction);\n\n    /**\n     * @private\n     * @type {import(\"../size.js\").Size}\n     */\n    this.imageSize_ = options.imageSize ? options.imageSize : null;\n\n    this.image_.addEventListener(EventType.CHANGE, this.handleImageChange.bind(this));\n\n  }\n\n  /**\n   * Returns the image extent\n   * @return {import(\"../extent.js\").Extent} image extent.\n   * @api\n   */\n  getImageExtent() {\n    return this.imageExtent_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getImageInternal(extent, resolution, pixelRatio, projection) {\n    if (intersects(extent, this.image_.getExtent())) {\n      return this.image_;\n    }\n    return null;\n  }\n\n  /**\n   * Return the URL used for this image source.\n   * @return {string} URL.\n   * @api\n   */\n  getUrl() {\n    return this.url_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleImageChange(evt) {\n    if (this.image_.getState() == ImageState.LOADED) {\n      const imageExtent = this.image_.getExtent();\n      const image = this.image_.getImage();\n      let imageWidth, imageHeight;\n      if (this.imageSize_) {\n        imageWidth = this.imageSize_[0];\n        imageHeight = this.imageSize_[1];\n      } else {\n        imageWidth = image.width;\n        imageHeight = image.height;\n      }\n      const resolution = getHeight(imageExtent) / imageHeight;\n      const targetWidth = Math.ceil(getWidth(imageExtent) / resolution);\n      if (targetWidth != imageWidth) {\n        const context = createCanvasContext2D(targetWidth, imageHeight);\n        const canvas = context.canvas;\n        context.drawImage(image, 0, 0, imageWidth, imageHeight,\n          0, 0, canvas.width, canvas.height);\n        this.image_.setImage(canvas);\n      }\n    }\n    super.handleImageChange(evt);\n  }\n}\n\n\nexport default Static;\n","/**\n * @module ol/format/EsriJSON\n */\nimport Feature from '../Feature.js';\nimport {assert} from '../asserts.js';\nimport {containsExtent} from '../extent.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport JSONFeature from './JSONFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport LinearRing from '../geom/LinearRing.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport MultiPoint from '../geom/MultiPoint.js';\nimport MultiPolygon from '../geom/MultiPolygon.js';\nimport Point from '../geom/Point.js';\nimport Polygon from '../geom/Polygon.js';\nimport {deflateCoordinates} from '../geom/flat/deflate.js';\nimport {linearRingIsClockwise} from '../geom/flat/orient.js';\nimport {isEmpty} from '../obj.js';\nimport {get as getProjection} from '../proj.js';\n\n/**\n * @typedef {import(\"arcgis-rest-api\").Feature} EsriJSONFeature\n * @typedef {import(\"arcgis-rest-api\").FeatureSet} EsriJSONFeatureSet\n * @typedef {import(\"arcgis-rest-api\").Geometry} EsriJSONGeometry\n * @typedef {import(\"arcgis-rest-api\").Point} EsriJSONPoint\n * @typedef {import(\"arcgis-rest-api\").Polyline} EsriJSONPolyline\n * @typedef {import(\"arcgis-rest-api\").Polygon} EsriJSONPolygon\n * @typedef {import(\"arcgis-rest-api\").Multipoint} EsriJSONMultipoint\n * @typedef {import(\"arcgis-rest-api\").HasZM} EsriJSONHasZM\n * @typedef {import(\"arcgis-rest-api\").Position} EsriJSONPosition\n * @typedef {import(\"arcgis-rest-api\").SpatialReferenceWkid} EsriJSONSpatialReferenceWkid\n */\n\n\n/**\n * @typedef {Object} EsriJSONMultiPolygon\n * @property {Array<Array<Array<Array<number>>>>} rings Rings for the MultiPolygon.\n * @property {boolean} [hasM] If the polygon coordinates have an M value.\n * @property {boolean} [hasZ] If the polygon coordinates have a Z value.\n * @property {EsriJSONSpatialReferenceWkid} [spatialReference] The coordinate reference system.\n */\n\n\n/**\n * @const\n * @type {Object<import(\"../geom/GeometryType.js\").default, function(EsriJSONGeometry): import(\"../geom/Geometry.js\").default>}\n */\nconst GEOMETRY_READERS = {};\nGEOMETRY_READERS[GeometryType.POINT] = readPointGeometry;\nGEOMETRY_READERS[GeometryType.LINE_STRING] = readLineStringGeometry;\nGEOMETRY_READERS[GeometryType.POLYGON] = readPolygonGeometry;\nGEOMETRY_READERS[GeometryType.MULTI_POINT] = readMultiPointGeometry;\nGEOMETRY_READERS[GeometryType.MULTI_LINE_STRING] = readMultiLineStringGeometry;\nGEOMETRY_READERS[GeometryType.MULTI_POLYGON] = readMultiPolygonGeometry;\n\n\n/**\n * @const\n * @type {Object<string, function(import(\"../geom/Geometry.js\").default, import(\"./Feature.js\").WriteOptions=): (EsriJSONGeometry)>}\n */\nconst GEOMETRY_WRITERS = {};\nGEOMETRY_WRITERS[GeometryType.POINT] = writePointGeometry;\nGEOMETRY_WRITERS[GeometryType.LINE_STRING] = writeLineStringGeometry;\nGEOMETRY_WRITERS[GeometryType.POLYGON] = writePolygonGeometry;\nGEOMETRY_WRITERS[GeometryType.MULTI_POINT] = writeMultiPointGeometry;\nGEOMETRY_WRITERS[GeometryType.MULTI_LINE_STRING] = writeMultiLineStringGeometry;\nGEOMETRY_WRITERS[GeometryType.MULTI_POLYGON] = writeMultiPolygonGeometry;\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [geometryName] Geometry name to use when creating features.\n */\n\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the EsriJSON format.\n *\n * @api\n */\nclass EsriJSON extends JSONFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options ? opt_options : {};\n\n    super();\n\n    /**\n     * Name of the geometry attribute for features.\n     * @type {string|undefined}\n     * @private\n     */\n    this.geometryName_ = options.geometryName;\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromObject(object, opt_options) {\n    const esriJSONFeature = /** @type {EsriJSONFeature} */ (object);\n    const geometry = readGeometry(esriJSONFeature.geometry, opt_options);\n    const feature = new Feature();\n    if (this.geometryName_) {\n      feature.setGeometryName(this.geometryName_);\n    }\n    feature.setGeometry(geometry);\n    if (opt_options && opt_options.idField &&\n      esriJSONFeature.attributes[opt_options.idField]) {\n      feature.setId(/** @type {number} */(esriJSONFeature.attributes[opt_options.idField]));\n    }\n    if (esriJSONFeature.attributes) {\n      feature.setProperties(esriJSONFeature.attributes, true);\n    }\n    return feature;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromObject(object, opt_options) {\n    const options = opt_options ? opt_options : {};\n    if (object['features']) {\n      const esriJSONFeatureSet = /** @type {EsriJSONFeatureSet} */ (object);\n      /** @type {Array<import(\"../Feature.js\").default>} */\n      const features = [];\n      const esriJSONFeatures = esriJSONFeatureSet.features;\n      options.idField = object.objectIdFieldName;\n      for (let i = 0, ii = esriJSONFeatures.length; i < ii; ++i) {\n        features.push(this.readFeatureFromObject(esriJSONFeatures[i], options));\n      }\n      return features;\n    } else {\n      return [this.readFeatureFromObject(object, options)];\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readGeometryFromObject(object, opt_options) {\n    return readGeometry(/** @type {EsriJSONGeometry} */(object), opt_options);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readProjectionFromObject(object) {\n    if (object['spatialReference'] && object['spatialReference']['wkid'] !== undefined) {\n      const spatialReference = /** @type {EsriJSONSpatialReferenceWkid} */ (object['spatialReference']);\n      const crs = spatialReference.wkid;\n      return getProjection('EPSG:' + crs);\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Encode a geometry as a EsriJSON object.\n   *\n   * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {EsriJSONGeometry} Object.\n   * @override\n   * @api\n   */\n  writeGeometryObject(geometry, opt_options) {\n    return writeGeometry(geometry, this.adaptOptions(opt_options));\n  }\n\n  /**\n   * Encode a feature as a esriJSON Feature object.\n   *\n   * @param {import(\"../Feature.js\").default} feature Feature.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {Object} Object.\n   * @override\n   * @api\n   */\n  writeFeatureObject(feature, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n    const object = {};\n    const geometry = feature.getGeometry();\n    if (geometry) {\n      object['geometry'] = writeGeometry(geometry, opt_options);\n      if (opt_options && opt_options.featureProjection) {\n        object['geometry']['spatialReference'] = /** @type {EsriJSONSpatialReferenceWkid} */({\n          wkid: Number(getProjection(opt_options.featureProjection).getCode().split(':').pop())\n        });\n      }\n    }\n    const properties = feature.getProperties();\n    delete properties[feature.getGeometryName()];\n    if (!isEmpty(properties)) {\n      object['attributes'] = properties;\n    } else {\n      object['attributes'] = {};\n    }\n    return object;\n  }\n\n  /**\n   * Encode an array of features as a EsriJSON object.\n   *\n   * @param {Array<import(\"../Feature.js\").default>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n   * @return {EsriJSONFeatureSet} EsriJSON Object.\n   * @override\n   * @api\n   */\n  writeFeaturesObject(features, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n    const objects = [];\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      objects.push(this.writeFeatureObject(features[i], opt_options));\n    }\n    return {\n      'features': objects\n    };\n  }\n}\n\n\n/**\n * @param {EsriJSONGeometry} object Object.\n * @param {import(\"./Feature.js\").ReadOptions=} opt_options Read options.\n * @return {import(\"../geom/Geometry.js\").default} Geometry.\n */\nfunction readGeometry(object, opt_options) {\n  if (!object) {\n    return null;\n  }\n  /** @type {import(\"../geom/GeometryType.js\").default} */\n  let type;\n  if (typeof object['x'] === 'number' && typeof object['y'] === 'number') {\n    type = GeometryType.POINT;\n  } else if (object['points']) {\n    type = GeometryType.MULTI_POINT;\n  } else if (object['paths']) {\n    const esriJSONPolyline = /** @type {EsriJSONPolyline} */ (object);\n    if (esriJSONPolyline.paths.length === 1) {\n      type = GeometryType.LINE_STRING;\n    } else {\n      type = GeometryType.MULTI_LINE_STRING;\n    }\n  } else if (object['rings']) {\n    const esriJSONPolygon = /** @type {EsriJSONPolygon} */ (object);\n    const layout = getGeometryLayout(esriJSONPolygon);\n    const rings = convertRings(esriJSONPolygon.rings, layout);\n    if (rings.length === 1) {\n      type = GeometryType.POLYGON;\n      object = Object.assign({}, object, {['rings']: rings[0]});\n    } else {\n      type = GeometryType.MULTI_POLYGON;\n      object = Object.assign({}, object, {['rings']: rings});\n    }\n  }\n  const geometryReader = GEOMETRY_READERS[type];\n  return transformGeometryWithOptions(geometryReader(object), false, opt_options);\n}\n\n\n/**\n * Determines inner and outer rings.\n * Checks if any polygons in this array contain any other polygons in this\n * array. It is used for checking for holes.\n * Logic inspired by: https://github.com/Esri/terraformer-arcgis-parser\n * @param {Array<!Array<!Array<number>>>} rings Rings.\n * @param {import(\"../geom/GeometryLayout.js\").default} layout Geometry layout.\n * @return {Array<!Array<!Array<!Array<number>>>>} Transformed rings.\n */\nfunction convertRings(rings, layout) {\n  const flatRing = [];\n  const outerRings = [];\n  const holes = [];\n  let i, ii;\n  for (i = 0, ii = rings.length; i < ii; ++i) {\n    flatRing.length = 0;\n    deflateCoordinates(flatRing, 0, rings[i], layout.length);\n    // is this ring an outer ring? is it clockwise?\n    const clockwise = linearRingIsClockwise(flatRing, 0,\n      flatRing.length, layout.length);\n    if (clockwise) {\n      outerRings.push([rings[i]]);\n    } else {\n      holes.push(rings[i]);\n    }\n  }\n  while (holes.length) {\n    const hole = holes.shift();\n    let matched = false;\n    // loop over all outer rings and see if they contain our hole.\n    for (i = outerRings.length - 1; i >= 0; i--) {\n      const outerRing = outerRings[i][0];\n      const containsHole = containsExtent(\n        new LinearRing(outerRing).getExtent(),\n        new LinearRing(hole).getExtent()\n      );\n      if (containsHole) {\n        // the hole is contained push it into our polygon\n        outerRings[i].push(hole);\n        matched = true;\n        break;\n      }\n    }\n    if (!matched) {\n      // no outer rings contain this hole turn it into and outer\n      // ring (reverse it)\n      outerRings.push([hole.reverse()]);\n    }\n  }\n  return outerRings;\n}\n\n\n/**\n * @param {EsriJSONPoint} object Object.\n * @return {import(\"../geom/Geometry.js\").default} Point.\n */\nfunction readPointGeometry(object) {\n  let point;\n  if (object.m !== undefined && object.z !== undefined) {\n    point = new Point([object.x, object.y, object.z, object.m],\n      GeometryLayout.XYZM);\n  } else if (object.z !== undefined) {\n    point = new Point([object.x, object.y, object.z],\n      GeometryLayout.XYZ);\n  } else if (object.m !== undefined) {\n    point = new Point([object.x, object.y, object.m],\n      GeometryLayout.XYM);\n  } else {\n    point = new Point([object.x, object.y]);\n  }\n  return point;\n}\n\n\n/**\n * @param {EsriJSONPolyline} object Object.\n * @return {import(\"../geom/Geometry.js\").default} LineString.\n */\nfunction readLineStringGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new LineString(object.paths[0], layout);\n}\n\n\n/**\n * @param {EsriJSONPolyline} object Object.\n * @return {import(\"../geom/Geometry.js\").default} MultiLineString.\n */\nfunction readMultiLineStringGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiLineString(object.paths, layout);\n}\n\n\n/**\n * @param {EsriJSONHasZM} object Object.\n * @return {import(\"../geom/GeometryLayout.js\").default} The geometry layout to use.\n */\nfunction getGeometryLayout(object) {\n  let layout = GeometryLayout.XY;\n  if (object.hasZ === true && object.hasM === true) {\n    layout = GeometryLayout.XYZM;\n  } else if (object.hasZ === true) {\n    layout = GeometryLayout.XYZ;\n  } else if (object.hasM === true) {\n    layout = GeometryLayout.XYM;\n  }\n  return layout;\n}\n\n\n/**\n * @param {EsriJSONMultipoint} object Object.\n * @return {import(\"../geom/Geometry.js\").default} MultiPoint.\n */\nfunction readMultiPointGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiPoint(object.points, layout);\n}\n\n\n/**\n * @param {EsriJSONMultiPolygon} object Object.\n * @return {import(\"../geom/Geometry.js\").default} MultiPolygon.\n */\nfunction readMultiPolygonGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new MultiPolygon(object.rings, layout);\n}\n\n\n/**\n * @param {EsriJSONPolygon} object Object.\n * @return {import(\"../geom/Geometry.js\").default} Polygon.\n */\nfunction readPolygonGeometry(object) {\n  const layout = getGeometryLayout(object);\n  return new Polygon(object.rings, layout);\n}\n\n\n/**\n * @param {import(\"../geom/Point.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONPoint} EsriJSON geometry.\n */\nfunction writePointGeometry(geometry, opt_options) {\n  const coordinates = geometry.getCoordinates();\n  /** @type {EsriJSONPoint} */\n  let esriJSON;\n  const layout = geometry.getLayout();\n  if (layout === GeometryLayout.XYZ) {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n      z: coordinates[2]\n    };\n  } else if (layout === GeometryLayout.XYM) {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n      m: coordinates[2]\n    };\n  } else if (layout === GeometryLayout.XYZM) {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1],\n      z: coordinates[2],\n      m: coordinates[3]\n    };\n  } else if (layout === GeometryLayout.XY) {\n    esriJSON = {\n      x: coordinates[0],\n      y: coordinates[1]\n    };\n  } else {\n    assert(false, 34); // Invalid geometry layout\n  }\n  return esriJSON;\n}\n\n\n/**\n * @param {import(\"../geom/SimpleGeometry.js\").default} geometry Geometry.\n * @return {Object} Object with boolean hasZ and hasM keys.\n */\nfunction getHasZM(geometry) {\n  const layout = geometry.getLayout();\n  return {\n    hasZ: (layout === GeometryLayout.XYZ ||\n      layout === GeometryLayout.XYZM),\n    hasM: (layout === GeometryLayout.XYM ||\n      layout === GeometryLayout.XYZM)\n  };\n}\n\n\n/**\n * @param {import(\"../geom/LineString.js\").default} lineString Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolyline} EsriJSON geometry.\n */\nfunction writeLineStringGeometry(lineString, opt_options) {\n  const hasZM = getHasZM(lineString);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    paths: [\n      /** @type {Array<EsriJSONPosition>} */ (lineString.getCoordinates())\n    ]\n  };\n}\n\n\n/**\n * @param {import(\"../geom/Polygon.js\").default} polygon Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolygon} EsriJSON geometry.\n */\nfunction writePolygonGeometry(polygon, opt_options) {\n  // Esri geometries use the left-hand rule\n  const hasZM = getHasZM(polygon);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    rings: /** @type {Array<Array<EsriJSONPosition>>} */ (polygon.getCoordinates(false))\n  };\n}\n\n\n/**\n * @param {import(\"../geom/MultiLineString.js\").default} multiLineString Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolyline} EsriJSON geometry.\n */\nfunction writeMultiLineStringGeometry(multiLineString, opt_options) {\n  const hasZM = getHasZM(multiLineString);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    paths: /** @type {Array<Array<EsriJSONPosition>>} */ (multiLineString.getCoordinates())\n  };\n}\n\n\n/**\n * @param {import(\"../geom/MultiPoint.js\").default} multiPoint Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONMultipoint} EsriJSON geometry.\n */\nfunction writeMultiPointGeometry(multiPoint, opt_options) {\n  const hasZM = getHasZM(multiPoint);\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    points: /** @type {Array<EsriJSONPosition>} */ (multiPoint.getCoordinates())\n  };\n}\n\n\n/**\n * @param {import(\"../geom/MultiPolygon.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONPolygon} EsriJSON geometry.\n */\nfunction writeMultiPolygonGeometry(geometry, opt_options) {\n  const hasZM = getHasZM(geometry);\n  const coordinates = geometry.getCoordinates(false);\n  const output = [];\n  for (let i = 0; i < coordinates.length; i++) {\n    for (let x = coordinates[i].length - 1; x >= 0; x--) {\n      output.push(coordinates[i][x]);\n    }\n  }\n  return {\n    hasZ: hasZM.hasZ,\n    hasM: hasZM.hasM,\n    rings: /** @type {Array<Array<EsriJSONPosition>>} */ (output)\n  };\n}\n\n\n/**\n * @param {import(\"../geom/Geometry.js\").default} geometry Geometry.\n * @param {import(\"./Feature.js\").WriteOptions=} opt_options Write options.\n * @return {EsriJSONGeometry} EsriJSON geometry.\n */\nfunction writeGeometry(geometry, opt_options) {\n  const geometryWriter = GEOMETRY_WRITERS[geometry.getType()];\n  return geometryWriter(transformGeometryWithOptions(geometry, true, opt_options), opt_options);\n}\n\n\nexport default EsriJSON;\n","/**\n * @module ol/render/canvas/ImageBuilder\n */\nimport CanvasInstruction from './Instruction.js';\nimport CanvasBuilder from './Builder.js';\n\nclass CanvasImageBuilder extends CanvasBuilder {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n  constructor(tolerance, maxExtent, resolution, pixelRatio) {\n    super(tolerance, maxExtent, resolution, pixelRatio);\n\n    /**\n     * @private\n     * @type {import(\"../canvas.js\").DeclutterGroups}\n     */\n    this.declutterGroups_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.hitDetectionImage_ = null;\n\n    /**\n     * @private\n     * @type {HTMLCanvasElement|HTMLVideoElement|HTMLImageElement}\n     */\n    this.image_ = null;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.anchorX_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.anchorY_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.height_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.opacity_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.originX_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.originY_ = undefined;\n\n    /**\n     * @private\n     * @type {boolean|undefined}\n     */\n    this.rotateWithView_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.rotation_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.scale_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.width_ = undefined;\n\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} My end.\n   */\n  drawCoordinates_(flatCoordinates, offset, end, stride) {\n    return this.appendFlatCoordinates(flatCoordinates, offset, end, stride, false, false);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawPoint(pointGeometry, feature) {\n    if (!this.image_) {\n      return;\n    }\n    this.beginGeometry(pointGeometry, feature);\n    const flatCoordinates = pointGeometry.getFlatCoordinates();\n    const stride = pointGeometry.getStride();\n    const myBegin = this.coordinates.length;\n    const myEnd = this.drawCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n    this.instructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroups_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_ * this.pixelRatio, this.width_\n    ]);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroups_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_, this.width_\n    ]);\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawMultiPoint(multiPointGeometry, feature) {\n    if (!this.image_) {\n      return;\n    }\n    this.beginGeometry(multiPointGeometry, feature);\n    const flatCoordinates = multiPointGeometry.getFlatCoordinates();\n    const stride = multiPointGeometry.getStride();\n    const myBegin = this.coordinates.length;\n    const myEnd = this.drawCoordinates_(\n      flatCoordinates, 0, flatCoordinates.length, stride);\n    this.instructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.image_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroups_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_ * this.pixelRatio, this.width_\n    ]);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.DRAW_IMAGE, myBegin, myEnd, this.hitDetectionImage_,\n      // Remaining arguments to DRAW_IMAGE are in alphabetical order\n      this.anchorX_, this.anchorY_, this.declutterGroups_, this.height_, this.opacity_,\n      this.originX_, this.originY_, this.rotateWithView_, this.rotation_,\n      this.scale_, this.width_\n    ]);\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  finish() {\n    this.reverseHitDetectionInstructions();\n    // FIXME this doesn't really protect us against further calls to draw*Geometry\n    this.anchorX_ = undefined;\n    this.anchorY_ = undefined;\n    this.hitDetectionImage_ = null;\n    this.image_ = null;\n    this.height_ = undefined;\n    this.scale_ = undefined;\n    this.opacity_ = undefined;\n    this.originX_ = undefined;\n    this.originY_ = undefined;\n    this.rotateWithView_ = undefined;\n    this.rotation_ = undefined;\n    this.width_ = undefined;\n    return super.finish();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  setImageStyle(imageStyle, declutterGroups) {\n    const anchor = imageStyle.getAnchor();\n    const size = imageStyle.getSize();\n    const hitDetectionImage = imageStyle.getHitDetectionImage(1);\n    const image = imageStyle.getImage(1);\n    const origin = imageStyle.getOrigin();\n    this.anchorX_ = anchor[0];\n    this.anchorY_ = anchor[1];\n    this.declutterGroups_ = /** @type {import(\"../canvas.js\").DeclutterGroups} */ (declutterGroups);\n    this.hitDetectionImage_ = hitDetectionImage;\n    this.image_ = image;\n    this.height_ = size[1];\n    this.opacity_ = imageStyle.getOpacity();\n    this.originX_ = origin[0];\n    this.originY_ = origin[1];\n    this.rotateWithView_ = imageStyle.getRotateWithView();\n    this.rotation_ = imageStyle.getRotation();\n    this.scale_ = imageStyle.getScale();\n    this.width_ = size[0];\n  }\n}\n\n\nexport default CanvasImageBuilder;\n","/**\n * @module ol/render/canvas/LineStringBuilder\n */\nimport CanvasInstruction, {strokeInstruction, beginPathInstruction} from './Instruction.js';\nimport CanvasBuilder from './Builder.js';\n\nclass CanvasLineStringBuilder extends CanvasBuilder {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n  constructor(tolerance, maxExtent, resolution, pixelRatio) {\n    super(tolerance, maxExtent, resolution, pixelRatio);\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {number} end End.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} end.\n   */\n  drawFlatCoordinates_(flatCoordinates, offset, end, stride) {\n    const myBegin = this.coordinates.length;\n    const myEnd = this.appendFlatCoordinates(\n      flatCoordinates, offset, end, stride, false, false);\n    const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n    this.instructions.push(moveToLineToInstruction);\n    this.hitDetectionInstructions.push(moveToLineToInstruction);\n    return end;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawLineString(lineStringGeometry, feature) {\n    const state = this.state;\n    const strokeStyle = state.strokeStyle;\n    const lineWidth = state.lineWidth;\n    if (strokeStyle === undefined || lineWidth === undefined) {\n      return;\n    }\n    this.updateStrokeStyle(state, this.applyStroke);\n    this.beginGeometry(lineStringGeometry, feature);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ], beginPathInstruction);\n    const flatCoordinates = lineStringGeometry.getFlatCoordinates();\n    const stride = lineStringGeometry.getStride();\n    this.drawFlatCoordinates_(flatCoordinates, 0, flatCoordinates.length, stride);\n    this.hitDetectionInstructions.push(strokeInstruction);\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawMultiLineString(multiLineStringGeometry, feature) {\n    const state = this.state;\n    const strokeStyle = state.strokeStyle;\n    const lineWidth = state.lineWidth;\n    if (strokeStyle === undefined || lineWidth === undefined) {\n      return;\n    }\n    this.updateStrokeStyle(state, this.applyStroke);\n    this.beginGeometry(multiLineStringGeometry, feature);\n    this.hitDetectionInstructions.push([\n      CanvasInstruction.SET_STROKE_STYLE,\n      state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n      state.miterLimit, state.lineDash, state.lineDashOffset\n    ], beginPathInstruction);\n    const ends = multiLineStringGeometry.getEnds();\n    const flatCoordinates = multiLineStringGeometry.getFlatCoordinates();\n    const stride = multiLineStringGeometry.getStride();\n    let offset = 0;\n    for (let i = 0, ii = ends.length; i < ii; ++i) {\n      offset = this.drawFlatCoordinates_(flatCoordinates, offset, ends[i], stride);\n    }\n    this.hitDetectionInstructions.push(strokeInstruction);\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  finish() {\n    const state = this.state;\n    if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n      this.instructions.push(strokeInstruction);\n    }\n    this.reverseHitDetectionInstructions();\n    this.state = null;\n    return super.finish();\n  }\n\n  /**\n   * @inheritDoc.\n   */\n  applyStroke(state) {\n    if (state.lastStroke != undefined && state.lastStroke != this.coordinates.length) {\n      this.instructions.push(strokeInstruction);\n      state.lastStroke = this.coordinates.length;\n    }\n    state.lastStroke = 0;\n    super.applyStroke(state);\n    this.instructions.push(beginPathInstruction);\n  }\n}\n\n\nexport default CanvasLineStringBuilder;\n","/**\n * @module ol/render/canvas/PolygonBuilder\n */\nimport {snap} from '../../geom/flat/simplify.js';\nimport {defaultFillStyle} from '../canvas.js';\nimport CanvasInstruction, {\n  fillInstruction, strokeInstruction, beginPathInstruction, closePathInstruction\n} from './Instruction.js';\nimport CanvasBuilder from './Builder.js';\n\n\nclass CanvasPolygonBuilder extends CanvasBuilder {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Maximum extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   */\n  constructor(tolerance, maxExtent, resolution, pixelRatio) {\n    super(tolerance, maxExtent, resolution, pixelRatio);\n  }\n\n  /**\n   * @param {Array<number>} flatCoordinates Flat coordinates.\n   * @param {number} offset Offset.\n   * @param {Array<number>} ends Ends.\n   * @param {number} stride Stride.\n   * @private\n   * @return {number} End.\n   */\n  drawFlatCoordinatess_(flatCoordinates, offset, ends, stride) {\n    const state = this.state;\n    const fill = state.fillStyle !== undefined;\n    const stroke = state.strokeStyle !== undefined;\n    const numEnds = ends.length;\n    this.instructions.push(beginPathInstruction);\n    this.hitDetectionInstructions.push(beginPathInstruction);\n    for (let i = 0; i < numEnds; ++i) {\n      const end = ends[i];\n      const myBegin = this.coordinates.length;\n      const myEnd = this.appendFlatCoordinates(flatCoordinates, offset, end, stride, true, !stroke);\n      const moveToLineToInstruction = [CanvasInstruction.MOVE_TO_LINE_TO, myBegin, myEnd];\n      this.instructions.push(moveToLineToInstruction);\n      this.hitDetectionInstructions.push(moveToLineToInstruction);\n      if (stroke) {\n        // Performance optimization: only call closePath() when we have a stroke.\n        // Otherwise the ring is closed already (see appendFlatCoordinates above).\n        this.instructions.push(closePathInstruction);\n        this.hitDetectionInstructions.push(closePathInstruction);\n      }\n      offset = end;\n    }\n    if (fill) {\n      this.instructions.push(fillInstruction);\n      this.hitDetectionInstructions.push(fillInstruction);\n    }\n    if (stroke) {\n      this.instructions.push(strokeInstruction);\n      this.hitDetectionInstructions.push(strokeInstruction);\n    }\n    return offset;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawCircle(circleGeometry, feature) {\n    const state = this.state;\n    const fillStyle = state.fillStyle;\n    const strokeStyle = state.strokeStyle;\n    if (fillStyle === undefined && strokeStyle === undefined) {\n      return;\n    }\n    this.setFillStrokeStyles_();\n    this.beginGeometry(circleGeometry, feature);\n    if (state.fillStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_FILL_STYLE,\n        defaultFillStyle\n      ]);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_STROKE_STYLE,\n        state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n        state.miterLimit, state.lineDash, state.lineDashOffset\n      ]);\n    }\n    const flatCoordinates = circleGeometry.getFlatCoordinates();\n    const stride = circleGeometry.getStride();\n    const myBegin = this.coordinates.length;\n    this.appendFlatCoordinates(\n      flatCoordinates, 0, flatCoordinates.length, stride, false, false);\n    const circleInstruction = [CanvasInstruction.CIRCLE, myBegin];\n    this.instructions.push(beginPathInstruction, circleInstruction);\n    this.hitDetectionInstructions.push(beginPathInstruction, circleInstruction);\n    if (state.fillStyle !== undefined) {\n      this.instructions.push(fillInstruction);\n      this.hitDetectionInstructions.push(fillInstruction);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.instructions.push(strokeInstruction);\n      this.hitDetectionInstructions.push(strokeInstruction);\n    }\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawPolygon(polygonGeometry, feature) {\n    const state = this.state;\n    const fillStyle = state.fillStyle;\n    const strokeStyle = state.strokeStyle;\n    if (fillStyle === undefined && strokeStyle === undefined) {\n      return;\n    }\n    this.setFillStrokeStyles_();\n    this.beginGeometry(polygonGeometry, feature);\n    if (state.fillStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_FILL_STYLE,\n        defaultFillStyle\n      ]);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_STROKE_STYLE,\n        state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n        state.miterLimit, state.lineDash, state.lineDashOffset\n      ]);\n    }\n    const ends = polygonGeometry.getEnds();\n    const flatCoordinates = polygonGeometry.getOrientedFlatCoordinates();\n    const stride = polygonGeometry.getStride();\n    this.drawFlatCoordinatess_(flatCoordinates, 0, ends, stride);\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  drawMultiPolygon(multiPolygonGeometry, feature) {\n    const state = this.state;\n    const fillStyle = state.fillStyle;\n    const strokeStyle = state.strokeStyle;\n    if (fillStyle === undefined && strokeStyle === undefined) {\n      return;\n    }\n    this.setFillStrokeStyles_();\n    this.beginGeometry(multiPolygonGeometry, feature);\n    if (state.fillStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_FILL_STYLE,\n        defaultFillStyle\n      ]);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.hitDetectionInstructions.push([\n        CanvasInstruction.SET_STROKE_STYLE,\n        state.strokeStyle, state.lineWidth, state.lineCap, state.lineJoin,\n        state.miterLimit, state.lineDash, state.lineDashOffset\n      ]);\n    }\n    const endss = multiPolygonGeometry.getEndss();\n    const flatCoordinates = multiPolygonGeometry.getOrientedFlatCoordinates();\n    const stride = multiPolygonGeometry.getStride();\n    let offset = 0;\n    for (let i = 0, ii = endss.length; i < ii; ++i) {\n      offset = this.drawFlatCoordinatess_(flatCoordinates, offset, endss[i], stride);\n    }\n    this.endGeometry(feature);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  finish() {\n    this.reverseHitDetectionInstructions();\n    this.state = null;\n    // We want to preserve topology when drawing polygons.  Polygons are\n    // simplified using quantization and point elimination. However, we might\n    // have received a mix of quantized and non-quantized geometries, so ensure\n    // that all are quantized by quantizing all coordinates in the batch.\n    const tolerance = this.tolerance;\n    if (tolerance !== 0) {\n      const coordinates = this.coordinates;\n      for (let i = 0, ii = coordinates.length; i < ii; ++i) {\n        coordinates[i] = snap(coordinates[i], tolerance);\n      }\n    }\n    return super.finish();\n  }\n\n  /**\n   * @private\n   */\n  setFillStrokeStyles_() {\n    const state = this.state;\n    const fillStyle = state.fillStyle;\n    if (fillStyle !== undefined) {\n      this.updateFillStyle(state, this.createFill);\n    }\n    if (state.strokeStyle !== undefined) {\n      this.updateStrokeStyle(state, this.applyStroke);\n    }\n  }\n}\n\n\nexport default CanvasPolygonBuilder;\n","/**\n * @module ol/render/canvas/BuilderGroup\n */\n\nimport {createEmpty} from '../../extent.js';\nimport Builder from './Builder.js';\nimport ImageBuilder from './ImageBuilder.js';\nimport LineStringBuilder from './LineStringBuilder.js';\nimport PolygonBuilder from './PolygonBuilder.js';\nimport TextBuilder from './TextBuilder.js';\n\n\n/**\n * @type {Object<import(\"./BuilderType\").default, typeof Builder>}\n */\nconst BATCH_CONSTRUCTORS = {\n  'Circle': PolygonBuilder,\n  'Default': Builder,\n  'Image': ImageBuilder,\n  'LineString': LineStringBuilder,\n  'Polygon': PolygonBuilder,\n  'Text': TextBuilder\n};\n\n\nclass BuilderGroup {\n  /**\n   * @param {number} tolerance Tolerance.\n   * @param {import(\"../../extent.js\").Extent} maxExtent Max extent.\n   * @param {number} resolution Resolution.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {boolean} declutter Decluttering enabled.\n   */\n  constructor(tolerance, maxExtent, resolution, pixelRatio, declutter) {\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.declutter_ = declutter;\n\n    /**\n     * @type {import(\"../canvas.js\").DeclutterGroups}\n     * @private\n     */\n    this.declutterGroups_ = null;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.tolerance_ = tolerance;\n\n    /**\n     * @private\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.maxExtent_ = maxExtent;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = pixelRatio;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.resolution_ = resolution;\n\n    /**\n     * @private\n     * @type {!Object<string, !Object<import(\"./BuilderType\").default, Builder>>}\n     */\n    this.buildersByZIndex_ = {};\n  }\n\n  /**\n   * @param {boolean} group Group with previous builder.\n   * @return {import(\"../canvas\").DeclutterGroups} The resulting instruction groups.\n   */\n  addDeclutter(group) {\n    let declutter = null;\n    if (this.declutter_) {\n      if (group) {\n        declutter = this.declutterGroups_;\n        /** @type {number} */ (declutter[0][4])++;\n      } else {\n        declutter = this.declutterGroups_ = [createEmpty()];\n        declutter[0].push(1);\n      }\n    }\n    return declutter;\n  }\n\n  /**\n   * @return {!Object<string, !Object<import(\"./BuilderType\").default, import(\"./Builder.js\").SerializableInstructions>>} The serializable instructions\n   */\n  finish() {\n    const builderInstructions = {};\n    for (const zKey in this.buildersByZIndex_) {\n      builderInstructions[zKey] = builderInstructions[zKey] || {};\n      const builders = this.buildersByZIndex_[zKey];\n      for (const builderKey in builders) {\n        const builderInstruction = builders[builderKey].finish();\n        builderInstructions[zKey][builderKey] = builderInstruction;\n      }\n    }\n    return builderInstructions;\n  }\n\n  /**\n   * @param {number|undefined} zIndex Z index.\n   * @param {import(\"./BuilderType.js\").default} builderType Replay type.\n   * @return {import(\"../VectorContext.js\").default} Replay.\n   */\n  getBuilder(zIndex, builderType) {\n    const zIndexKey = zIndex !== undefined ? zIndex.toString() : '0';\n    let replays = this.buildersByZIndex_[zIndexKey];\n    if (replays === undefined) {\n      replays = {};\n      this.buildersByZIndex_[zIndexKey] = replays;\n    }\n    let replay = replays[builderType];\n    if (replay === undefined) {\n      const Constructor = BATCH_CONSTRUCTORS[builderType];\n      replay = new Constructor(this.tolerance_, this.maxExtent_,\n        this.resolution_, this.pixelRatio_);\n      replays[builderType] = replay;\n    }\n    return replay;\n  }\n}\n\nexport default BuilderGroup;\n","/**\n * @module ol/geom/flat/geodesic\n */\nimport {squaredSegmentDistance, toRadians, toDegrees} from '../../math.js';\nimport {get as getProjection, getTransform} from '../../proj.js';\n\n\n/**\n * @param {function(number): import(\"../../coordinate.js\").Coordinate} interpolate Interpolate function.\n * @param {import(\"../../proj.js\").TransformFunction} transform Transform from longitude/latitude to\n *     projected coordinates.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array<number>} Flat coordinates.\n */\nfunction line(interpolate, transform, squaredTolerance) {\n  // FIXME reduce garbage generation\n  // FIXME optimize stack operations\n\n  /** @type {Array<number>} */\n  const flatCoordinates = [];\n\n  let geoA = interpolate(0);\n  let geoB = interpolate(1);\n\n  let a = transform(geoA);\n  let b = transform(geoB);\n\n  /** @type {Array<import(\"../../coordinate.js\").Coordinate>} */\n  const geoStack = [geoB, geoA];\n  /** @type {Array<import(\"../../coordinate.js\").Coordinate>} */\n  const stack = [b, a];\n  /** @type {Array<number>} */\n  const fractionStack = [1, 0];\n\n  /** @type {!Object<string, boolean>} */\n  const fractions = {};\n\n  let maxIterations = 1e5;\n  let geoM, m, fracA, fracB, fracM, key;\n\n  while (--maxIterations > 0 && fractionStack.length > 0) {\n    // Pop the a coordinate off the stack\n    fracA = fractionStack.pop();\n    geoA = geoStack.pop();\n    a = stack.pop();\n    // Add the a coordinate if it has not been added yet\n    key = fracA.toString();\n    if (!(key in fractions)) {\n      flatCoordinates.push(a[0], a[1]);\n      fractions[key] = true;\n    }\n    // Pop the b coordinate off the stack\n    fracB = fractionStack.pop();\n    geoB = geoStack.pop();\n    b = stack.pop();\n    // Find the m point between the a and b coordinates\n    fracM = (fracA + fracB) / 2;\n    geoM = interpolate(fracM);\n    m = transform(geoM);\n    if (squaredSegmentDistance(m[0], m[1], a[0], a[1],\n      b[0], b[1]) < squaredTolerance) {\n      // If the m point is sufficiently close to the straight line, then we\n      // discard it.  Just use the b coordinate and move on to the next line\n      // segment.\n      flatCoordinates.push(b[0], b[1]);\n      key = fracB.toString();\n      fractions[key] = true;\n    } else {\n      // Otherwise, we need to subdivide the current line segment.  Split it\n      // into two and push the two line segments onto the stack.\n      fractionStack.push(fracB, fracM, fracM, fracA);\n      stack.push(b, m, m, a);\n      geoStack.push(geoB, geoM, geoM, geoA);\n    }\n  }\n\n  return flatCoordinates;\n}\n\n\n/**\n * Generate a great-circle arcs between two lat/lon points.\n * @param {number} lon1 Longitude 1 in degrees.\n * @param {number} lat1 Latitude 1 in degrees.\n * @param {number} lon2 Longitude 2 in degrees.\n * @param {number} lat2 Latitude 2 in degrees.\n * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array<number>} Flat coordinates.\n */\nexport function greatCircleArc(lon1, lat1, lon2, lat2, projection, squaredTolerance) {\n  const geoProjection = getProjection('EPSG:4326');\n\n  const cosLat1 = Math.cos(toRadians(lat1));\n  const sinLat1 = Math.sin(toRadians(lat1));\n  const cosLat2 = Math.cos(toRadians(lat2));\n  const sinLat2 = Math.sin(toRadians(lat2));\n  const cosDeltaLon = Math.cos(toRadians(lon2 - lon1));\n  const sinDeltaLon = Math.sin(toRadians(lon2 - lon1));\n  const d = sinLat1 * sinLat2 + cosLat1 * cosLat2 * cosDeltaLon;\n\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {import(\"../../coordinate.js\").Coordinate} Coordinate.\n     */\n    function(frac) {\n      if (1 <= d) {\n        return [lon2, lat2];\n      }\n      const D = frac * Math.acos(d);\n      const cosD = Math.cos(D);\n      const sinD = Math.sin(D);\n      const y = sinDeltaLon * cosLat2;\n      const x = cosLat1 * sinLat2 - sinLat1 * cosLat2 * cosDeltaLon;\n      const theta = Math.atan2(y, x);\n      const lat = Math.asin(sinLat1 * cosD + cosLat1 * sinD * Math.cos(theta));\n      const lon = toRadians(lon1) +\n            Math.atan2(Math.sin(theta) * sinD * cosLat1,\n              cosD - sinLat1 * Math.sin(lat));\n      return [toDegrees(lon), toDegrees(lat)];\n    }, getTransform(geoProjection, projection), squaredTolerance);\n}\n\n\n/**\n * Generate a meridian (line at constant longitude).\n * @param {number} lon Longitude.\n * @param {number} lat1 Latitude 1.\n * @param {number} lat2 Latitude 2.\n * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array<number>} Flat coordinates.\n */\nexport function meridian(lon, lat1, lat2, projection, squaredTolerance) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {import(\"../../coordinate.js\").Coordinate} Coordinate.\n     */\n    function(frac) {\n      return [lon, lat1 + ((lat2 - lat1) * frac)];\n    },\n    getTransform(epsg4326Projection, projection), squaredTolerance);\n}\n\n\n/**\n * Generate a parallel (line at constant latitude).\n * @param {number} lat Latitude.\n * @param {number} lon1 Longitude 1.\n * @param {number} lon2 Longitude 2.\n * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n * @param {number} squaredTolerance Squared tolerance.\n * @return {Array<number>} Flat coordinates.\n */\nexport function parallel(lat, lon1, lon2, projection, squaredTolerance) {\n  const epsg4326Projection = getProjection('EPSG:4326');\n  return line(\n    /**\n     * @param {number} frac Fraction.\n     * @return {import(\"../../coordinate.js\").Coordinate} Coordinate.\n     */\n    function(frac) {\n      return [lon1 + ((lon2 - lon1) * frac), lat];\n    },\n    getTransform(epsg4326Projection, projection), squaredTolerance);\n}\n","/**\n * @module ol/layer/Graticule\n */\nimport VectorLayer from './Vector.js';\nimport {assign} from '../obj.js';\nimport {degreesToStringHDMS} from '../coordinate.js';\nimport Text from '../style/Text.js';\nimport Fill from '../style/Fill.js';\nimport Stroke from '../style/Stroke.js';\nimport LineString from '../geom/LineString.js';\nimport VectorSource from '../source/Vector.js';\nimport {\n  equivalent as equivalentProjection,\n  get as getProjection,\n  getTransform,\n  transformExtent\n} from '../proj.js';\nimport {getCenter, intersects, equals, getIntersection, isEmpty} from '../extent.js';\nimport {clamp} from '../math.js';\nimport Style from '../style/Style.js';\nimport Feature from '../Feature.js';\nimport {bbox} from '../loadingstrategy.js';\nimport {meridian, parallel} from '../geom/flat/geodesic.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport Point from '../geom/Point.js';\nimport Collection from '../Collection.js';\n\n\n/**\n * @type {Stroke}\n * @private\n * @const\n */\nconst DEFAULT_STROKE_STYLE = new Stroke({\n  color: 'rgba(0,0,0,0.2)'\n});\n\n/**\n * @type {Array<number>}\n * @private\n */\nconst INTERVALS = [\n  90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001\n];\n\n/**\n * @typedef {Object} GraticuleLabelDataType\n * @property {Point} geom\n * @property {string} text\n */\n\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [maxLines=100] The maximum number of meridians and\n * parallels from the center of the map. The default value of 100 means that at\n * most 200 meridians and 200 parallels will be displayed. The default value is\n * appropriate for conformal projections like Spherical Mercator. If you\n * increase the value, more lines will be drawn and the drawing performance will\n * decrease.\n * @property {Stroke} [strokeStyle='rgba(0,0,0,0.2)'] The\n * stroke style to use for drawing the graticule. If not provided, a not fully\n * opaque black will be used.\n * @property {number} [targetSize=100] The target size of the graticule cells,\n * in pixels.\n * @property {boolean} [showLabels=false] Render a label with the respective\n * latitude/longitude for each graticule line.\n * @property {function(number):string} [lonLabelFormatter] Label formatter for\n * longitudes. This function is called with the longitude as argument, and\n * should return a formatted string representing the longitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {function(number):string} [latLabelFormatter] Label formatter for\n * latitudes. This function is called with the latitude as argument, and\n * should return a formatted string representing the latitude. By default,\n * labels are formatted as degrees, minutes, seconds and hemisphere.\n * @property {number} [lonLabelPosition=0] Longitude label position in fractions\n * (0..1) of view extent. 0 means at the bottom of the viewport, 1 means at the\n * top.\n * @property {number} [latLabelPosition=1] Latitude label position in fractions\n * (0..1) of view extent. 0 means at the left of the viewport, 1 means at the\n * right.\n * @property {Text} [lonLabelStyle] Longitude label text\n * style. If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textBaseline: 'bottom',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: new Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textBaseline` configuration will not work well for\n * `lonLabelPosition` configurations that position labels close to the top of\n * the viewport.\n * @property {Text} [latLabelStyle] Latitude label text style.\n * If not provided, the following style will be used:\n * ```js\n * new Text({\n *   font: '12px Calibri,sans-serif',\n *   textAlign: 'end',\n *   fill: new Fill({\n *     color: 'rgba(0,0,0,1)'\n *   }),\n *   stroke: Stroke({\n *     color: 'rgba(255,255,255,1)',\n *     width: 3\n *   })\n * });\n * ```\n * Note that the default's `textAlign` configuration will not work well for\n * `latLabelPosition` configurations that position labels close to the left of\n * the viewport.\n * @property {Array<number>} [intervals=[90, 45, 30, 20, 10, 5, 2, 1, 0.5, 0.2, 0.1, 0.05, 0.01, 0.005, 0.002, 0.001]]\n * Intervals (in degrees) for the graticule. Example to limit graticules to 30 and 10 degrees intervals:\n * ```js\n * [30, 10]\n * ```\n * @property {boolean} [wrapX=true] Whether to repeat the graticule horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer that renders a grid for a coordinate system.\n *\n * @fires import(\"../render/Event.js\").RenderEvent\n * @api\n */\nclass Graticule extends VectorLayer {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const baseOptions = assign({\n      updateWhileAnimating: true,\n      updateWhileInteracting: true,\n      renderBuffer: 0\n    }, options);\n\n    delete baseOptions.maxLines;\n    delete baseOptions.strokeStyle;\n    delete baseOptions.targetSize;\n    delete baseOptions.showLabels;\n    delete baseOptions.lonLabelFormatter;\n    delete baseOptions.latLabelFormatter;\n    delete baseOptions.lonLabelPosition;\n    delete baseOptions.latLabelPosition;\n    delete baseOptions.lonLabelStyle;\n    delete baseOptions.latLabelStyle;\n    delete baseOptions.intervals;\n    super(baseOptions);\n\n    /**\n     * @type {import(\"../proj/Projection.js\").default}\n     */\n    this.projection_ = null;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxLat_ = Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxLon_ = Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.minLat_ = -Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.minLon_ = -Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxLatP_ = Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxLonP_ = Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.minLatP_ = -Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.minLonP_ = -Infinity;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.targetSize_ = options.targetSize !== undefined ? options.targetSize : 100;\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxLines_ = options.maxLines !== undefined ? options.maxLines : 100;\n\n    /**\n     * @type {Array<LineString>}\n     * @private\n     */\n    this.meridians_ = [];\n\n    /**\n     * @type {Array<LineString>}\n     * @private\n     */\n    this.parallels_ = [];\n\n    /**\n     * @type {Stroke}\n     * @private\n     */\n    this.strokeStyle_ = options.strokeStyle !== undefined ? options.strokeStyle : DEFAULT_STROKE_STYLE;\n\n    /**\n     * @type {import(\"../proj.js\").TransformFunction|undefined}\n     * @private\n     */\n    this.fromLonLatTransform_ = undefined;\n\n    /**\n     * @type {import(\"../proj.js\").TransformFunction|undefined}\n     * @private\n     */\n    this.toLonLatTransform_ = undefined;\n\n    /**\n     * @type {import(\"../coordinate.js\").Coordinate}\n     * @private\n     */\n    this.projectionCenterLonLat_ = null;\n\n    /**\n     * @type {Array<GraticuleLabelDataType>}\n     * @private\n     */\n    this.meridiansLabels_ = null;\n\n    /**\n     * @type {Array<GraticuleLabelDataType>}\n     * @private\n     */\n    this.parallelsLabels_ = null;\n\n    if (options.showLabels) {\n\n      /**\n       * @type {null|function(number):string}\n       * @private\n       */\n      this.lonLabelFormatter_ = options.lonLabelFormatter == undefined ?\n        degreesToStringHDMS.bind(this, 'EW') : options.lonLabelFormatter;\n\n      /**\n       * @type {function(number):string}\n       * @private\n       */\n      this.latLabelFormatter_ = options.latLabelFormatter == undefined ?\n        degreesToStringHDMS.bind(this, 'NS') : options.latLabelFormatter;\n\n      /**\n       * Longitude label position in fractions (0..1) of view extent. 0 means\n       * bottom, 1 means top.\n       * @type {number}\n       * @private\n       */\n      this.lonLabelPosition_ = options.lonLabelPosition == undefined ? 0 :\n        options.lonLabelPosition;\n\n      /**\n       * Latitude Label position in fractions (0..1) of view extent. 0 means left, 1\n       * means right.\n       * @type {number}\n       * @private\n       */\n      this.latLabelPosition_ = options.latLabelPosition == undefined ? 1 :\n        options.latLabelPosition;\n\n      /**\n       * @type {Object.<string,Style>}\n       * @private\n       */\n      this.lonLabelStyleCache_ = {};\n\n      /**\n       * @private\n       * @param {import(\"../Feature\").default} feature Feature\n       * @return {Style} style\n       */\n      this.lonLabelStyle_ = function(feature) {\n        const label = feature.get('graticule_label');\n        if (!this.lonLabelStyleCache_[label]) {\n          this.lonLabelStyleCache_[label] = new Style({\n            text: options.lonLabelStyle !== undefined ? options.lonLabelStyle :\n              new Text({\n                text: label,\n                font: '12px Calibri,sans-serif',\n                textBaseline: 'bottom',\n                fill: new Fill({\n                  color: 'rgba(0,0,0,1)'\n                }),\n                stroke: new Stroke({\n                  color: 'rgba(255,255,255,1)',\n                  width: 3\n                })\n              })\n          });\n        }\n        return this.lonLabelStyleCache_[label];\n      }.bind(this);\n\n      /**\n       * @type {Object.<string,Style>}\n       * @private\n       */\n      this.latLabelStyleCache_ = {};\n\n      /**\n       * @private\n       * @param {import(\"../Feature\").default} feature Feature\n       * @return {Style} style\n       */\n      this.latLabelStyle_ = function(feature) {\n        const label = feature.get('graticule_label');\n        if (!this.latLabelStyleCache_[label]) {\n          this.latLabelStyleCache_[label] = new Style({\n            text: options.latLabelStyle !== undefined ? options.latLabelStyle :\n              new Text({\n                text: label,\n                font: '12px Calibri,sans-serif',\n                textAlign: 'right',\n                fill: new Fill({\n                  color: 'rgba(0,0,0,1)'\n                }),\n                stroke: new Stroke({\n                  color: 'rgba(255,255,255,1)',\n                  width: 3\n                })\n              })\n          });\n        }\n        return this.latLabelStyleCache_[label];\n      }.bind(this);\n\n      this.meridiansLabels_ = [];\n      this.parallelsLabels_ = [];\n    }\n\n    /**\n     * @type {Array<number>}\n     * @private\n     */\n    this.intervals_ = options.intervals !== undefined ? options.intervals : INTERVALS;\n\n    // use a source with a custom loader for lines & text\n    this.setSource(\n      new VectorSource({\n        loader: this.loaderFunction.bind(this),\n        strategy: bbox,\n        features: new Collection(),\n        overlaps: false,\n        useSpatialIndex: false,\n        wrapX: options.wrapX\n      })\n    );\n\n    /**\n     * feature pool to use when updating graticule\n     * @type {Array<Feature>}\n     * @private\n     */\n    this.featurePool_ = [];\n\n    /**\n     * @type {Style}\n     * @private\n     */\n    this.lineStyle_ = new Style({\n      stroke: this.strokeStyle_\n    });\n\n    /**\n     * @type {import(\"../extent.js\").Extent}\n     */\n    this.renderedExtent_ = null;\n\n    this.setRenderOrder(null);\n\n    this.tmpExtent_ = null;\n  }\n\n  /**\n   * Update geometries in the source based on current view\n   * @param {import(\"../extent\").Extent} extent Extent\n   * @param {number} resolution Resolution\n   * @param {import(\"../proj/Projection.js\").default} projection Projection\n   */\n  loaderFunction(extent, resolution, projection) {\n    const source = this.getSource();\n\n    // only consider the intersection between our own extent & the requested one\n    const layerExtent = this.getExtent() || [-Infinity, -Infinity, Infinity, Infinity];\n    const renderExtent = getIntersection(layerExtent, extent, this.tmpExtent_);\n\n    // we should not keep track of loaded extents\n    setTimeout(function() {\n      source.removeLoadedExtent(extent);\n    }, 0);\n\n    if (this.renderedExtent_ && equals(this.renderedExtent_, renderExtent)) {\n      return;\n    }\n    this.renderedExtent_ = renderExtent;\n\n    // bail out if nothing to render\n    if (isEmpty(renderExtent)) {\n      return;\n    }\n\n    // update projection info\n    const center = getCenter(renderExtent);\n    const squaredTolerance = resolution * resolution / 4;\n\n    const updateProjectionInfo = !this.projection_ ||\n      !equivalentProjection(this.projection_, projection);\n\n    if (updateProjectionInfo) {\n      this.updateProjectionInfo_(projection);\n    }\n\n    this.createGraticule_(renderExtent, center, resolution, squaredTolerance);\n\n    // first make sure we have enough features in the pool\n    let featureCount = this.meridians_.length + this.parallels_.length;\n    if (this.meridiansLabels_) {\n      featureCount += this.meridiansLabels_.length;\n    }\n    if (this.parallelsLabels_) {\n      featureCount += this.parallelsLabels_.length;\n    }\n\n    let feature;\n    while (featureCount > this.featurePool_.length) {\n      feature = new Feature();\n      this.featurePool_.push(feature);\n    }\n\n    const featuresColl = source.getFeaturesCollection();\n    featuresColl.clear();\n    let poolIndex = 0;\n\n    // add features for the lines & labels\n    let i, l;\n    for (i = 0, l = this.meridians_.length; i < l; ++i) {\n      feature = this.featurePool_[poolIndex++];\n      feature.setGeometry(this.meridians_[i]);\n      feature.setStyle(this.lineStyle_);\n      featuresColl.push(feature);\n    }\n    for (i = 0, l = this.parallels_.length; i < l; ++i) {\n      feature = this.featurePool_[poolIndex++];\n      feature.setGeometry(this.parallels_[i]);\n      feature.setStyle(this.lineStyle_);\n      featuresColl.push(feature);\n    }\n    let labelData;\n    if (this.meridiansLabels_) {\n      for (i = 0, l = this.meridiansLabels_.length; i < l; ++i) {\n        labelData = this.meridiansLabels_[i];\n        feature = this.featurePool_[poolIndex++];\n        feature.setGeometry(labelData.geom);\n        feature.setStyle(this.lonLabelStyle_);\n        feature.set('graticule_label', labelData.text);\n        featuresColl.push(feature);\n      }\n    }\n    if (this.parallelsLabels_) {\n      for (i = 0, l = this.parallelsLabels_.length; i < l; ++i) {\n        labelData = this.parallelsLabels_[i];\n        feature = this.featurePool_[poolIndex++];\n        feature.setGeometry(labelData.geom);\n        feature.setStyle(this.latLabelStyle_);\n        feature.set('graticule_label', labelData.text);\n        featuresColl.push(feature);\n      }\n    }\n  }\n\n  /**\n   * @param {number} lon Longitude.\n   * @param {number} minLat Minimal latitude.\n   * @param {number} maxLat Maximal latitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {number} Index.\n   * @private\n   */\n  addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, index) {\n    const lineString = this.getMeridian_(lon, minLat, maxLat, squaredTolerance, index);\n    if (intersects(lineString.getExtent(), extent)) {\n      if (this.meridiansLabels_) {\n        const textPoint = this.getMeridianPoint_(lineString, extent, index);\n        this.meridiansLabels_[index] = {\n          geom: textPoint,\n          text: this.lonLabelFormatter_(lon)\n        };\n      }\n      this.meridians_[index++] = lineString;\n    }\n    return index;\n  }\n\n  /**\n   * @param {number} lat Latitude.\n   * @param {number} minLon Minimal longitude.\n   * @param {number} maxLon Maximal longitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {number} Index.\n   * @private\n   */\n  addParallel_(lat, minLon, maxLon, squaredTolerance, extent, index) {\n    const lineString = this.getParallel_(lat, minLon, maxLon, squaredTolerance, index);\n    if (intersects(lineString.getExtent(), extent)) {\n      if (this.parallelsLabels_) {\n        const textPoint = this.getParallelPoint_(lineString, extent, index);\n        this.parallelsLabels_[index] = {\n          geom: textPoint,\n          text: this.latLabelFormatter_(lat)\n        };\n      }\n      this.parallels_[index++] = lineString;\n    }\n    return index;\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {import(\"../coordinate.js\").Coordinate} center Center.\n   * @param {number} resolution Resolution.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @private\n   */\n  createGraticule_(extent, center, resolution, squaredTolerance) {\n    const interval = this.getInterval_(resolution);\n    if (interval == -1) {\n      this.meridians_.length = this.parallels_.length = 0;\n      if (this.meridiansLabels_) {\n        this.meridiansLabels_.length = 0;\n      }\n      if (this.parallelsLabels_) {\n        this.parallelsLabels_.length = 0;\n      }\n      return;\n    }\n\n    const centerLonLat = this.toLonLatTransform_(center);\n    let centerLon = centerLonLat[0];\n    let centerLat = centerLonLat[1];\n    const maxLines = this.maxLines_;\n    let cnt, idx, lat, lon;\n\n    let validExtent = [\n      Math.max(extent[0], this.minLonP_),\n      Math.max(extent[1], this.minLatP_),\n      Math.min(extent[2], this.maxLonP_),\n      Math.min(extent[3], this.maxLatP_)\n    ];\n\n    validExtent = transformExtent(validExtent, this.projection_, 'EPSG:4326');\n    const maxLat = validExtent[3];\n    const maxLon = validExtent[2];\n    const minLat = validExtent[1];\n    const minLon = validExtent[0];\n\n    // Create meridians\n\n    centerLon = Math.floor(centerLon / interval) * interval;\n    lon = clamp(centerLon, this.minLon_, this.maxLon_);\n\n    idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, 0);\n\n    cnt = 0;\n    while (lon != this.minLon_ && cnt++ < maxLines) {\n      lon = Math.max(lon - interval, this.minLon_);\n      idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n    }\n\n    lon = clamp(centerLon, this.minLon_, this.maxLon_);\n\n    cnt = 0;\n    while (lon != this.maxLon_ && cnt++ < maxLines) {\n      lon = Math.min(lon + interval, this.maxLon_);\n      idx = this.addMeridian_(lon, minLat, maxLat, squaredTolerance, extent, idx);\n    }\n\n    this.meridians_.length = idx;\n    if (this.meridiansLabels_) {\n      this.meridiansLabels_.length = idx;\n    }\n\n    // Create parallels\n\n    centerLat = Math.floor(centerLat / interval) * interval;\n    lat = clamp(centerLat, this.minLat_, this.maxLat_);\n\n    idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, 0);\n\n    cnt = 0;\n    while (lat != this.minLat_ && cnt++ < maxLines) {\n      lat = Math.max(lat - interval, this.minLat_);\n      idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n    }\n\n    lat = clamp(centerLat, this.minLat_, this.maxLat_);\n\n    cnt = 0;\n    while (lat != this.maxLat_ && cnt++ < maxLines) {\n      lat = Math.min(lat + interval, this.maxLat_);\n      idx = this.addParallel_(lat, minLon, maxLon, squaredTolerance, extent, idx);\n    }\n\n    this.parallels_.length = idx;\n    if (this.parallelsLabels_) {\n      this.parallelsLabels_.length = idx;\n    }\n\n  }\n\n  /**\n   * @param {number} resolution Resolution.\n   * @return {number} The interval in degrees.\n   * @private\n   */\n  getInterval_(resolution) {\n    const centerLon = this.projectionCenterLonLat_[0];\n    const centerLat = this.projectionCenterLonLat_[1];\n    let interval = -1;\n    const target = Math.pow(this.targetSize_ * resolution, 2);\n    /** @type {Array<number>} **/\n    const p1 = [];\n    /** @type {Array<number>} **/\n    const p2 = [];\n    for (let i = 0, ii = this.intervals_.length; i < ii; ++i) {\n      const delta = this.intervals_[i] / 2;\n      p1[0] = centerLon - delta;\n      p1[1] = centerLat - delta;\n      p2[0] = centerLon + delta;\n      p2[1] = centerLat + delta;\n      this.fromLonLatTransform_(p1, p1);\n      this.fromLonLatTransform_(p2, p2);\n      const dist = Math.pow(p2[0] - p1[0], 2) + Math.pow(p2[1] - p1[1], 2);\n      if (dist <= target) {\n        break;\n      }\n      interval = this.intervals_[i];\n    }\n    return interval;\n  }\n\n  /**\n   * @param {number} lon Longitude.\n   * @param {number} minLat Minimal latitude.\n   * @param {number} maxLat Maximal latitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {LineString} The meridian line string.\n   * @param {number} index Index.\n   * @private\n   */\n  getMeridian_(lon, minLat, maxLat, squaredTolerance, index) {\n    const flatCoordinates = meridian(lon, minLat, maxLat, this.projection_, squaredTolerance);\n    let lineString = this.meridians_[index];\n    if (!lineString) {\n      lineString = this.meridians_[index] = new LineString(flatCoordinates, GeometryLayout.XY);\n    } else {\n      lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n      lineString.changed();\n    }\n    return lineString;\n  }\n\n  /**\n   * @param {LineString} lineString Meridian\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {Point} Meridian point.\n   * @private\n   */\n  getMeridianPoint_(lineString, extent, index) {\n    const flatCoordinates = lineString.getFlatCoordinates();\n    const clampedBottom = Math.max(extent[1], flatCoordinates[1]);\n    const clampedTop = Math.min(extent[3], flatCoordinates[flatCoordinates.length - 1]);\n    const lat = clamp(\n      extent[1] + Math.abs(extent[1] - extent[3]) * this.lonLabelPosition_,\n      clampedBottom, clampedTop);\n    const coordinate = [flatCoordinates[0], lat];\n    let point;\n    if (index in this.meridiansLabels_) {\n      point = this.meridiansLabels_[index].geom;\n      point.setCoordinates(coordinate);\n    } else {\n      point = new Point(coordinate);\n    }\n    return point;\n  }\n\n  /**\n   * Get the list of meridians.  Meridians are lines of equal longitude.\n   * @return {Array<LineString>} The meridians.\n   * @api\n   */\n  getMeridians() {\n    return this.meridians_;\n  }\n\n  /**\n   * @param {number} lat Latitude.\n   * @param {number} minLon Minimal longitude.\n   * @param {number} maxLon Maximal longitude.\n   * @param {number} squaredTolerance Squared tolerance.\n   * @return {LineString} The parallel line string.\n   * @param {number} index Index.\n   * @private\n   */\n  getParallel_(lat, minLon, maxLon, squaredTolerance, index) {\n    const flatCoordinates = parallel(lat, minLon, maxLon, this.projection_, squaredTolerance);\n    let lineString = this.parallels_[index];\n    if (!lineString) {\n      lineString = new LineString(flatCoordinates, GeometryLayout.XY);\n    } else {\n      lineString.setFlatCoordinates(GeometryLayout.XY, flatCoordinates);\n      lineString.changed();\n    }\n    return lineString;\n  }\n\n\n  /**\n   * @param {LineString} lineString Parallels.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @param {number} index Index.\n   * @return {Point} Parallel point.\n   * @private\n   */\n  getParallelPoint_(lineString, extent, index) {\n    const flatCoordinates = lineString.getFlatCoordinates();\n    const clampedLeft = Math.max(extent[0], flatCoordinates[0]);\n    const clampedRight = Math.min(extent[2], flatCoordinates[flatCoordinates.length - 2]);\n    const lon = clamp(\n      extent[0] + Math.abs(extent[0] - extent[2]) * this.latLabelPosition_,\n      clampedLeft, clampedRight);\n    const coordinate = [lon, flatCoordinates[1]];\n    let point;\n    if (index in this.parallelsLabels_) {\n      point = this.parallelsLabels_[index].geom;\n      point.setCoordinates(coordinate);\n    } else {\n      point = new Point(coordinate);\n    }\n    return point;\n  }\n\n  /**\n   * Get the list of parallels.  Parallels are lines of equal latitude.\n   * @return {Array<LineString>} The parallels.\n   * @api\n   */\n  getParallels() {\n    return this.parallels_;\n  }\n\n  /**\n   * @param {import(\"../proj/Projection.js\").default} projection Projection.\n   * @private\n   */\n  updateProjectionInfo_(projection) {\n    const epsg4326Projection = getProjection('EPSG:4326');\n\n    const worldExtent = projection.getWorldExtent();\n    const worldExtentP = transformExtent(worldExtent, epsg4326Projection, projection);\n\n    this.maxLat_ = worldExtent[3];\n    this.maxLon_ = worldExtent[2];\n    this.minLat_ = worldExtent[1];\n    this.minLon_ = worldExtent[0];\n\n    this.maxLatP_ = worldExtentP[3];\n    this.maxLonP_ = worldExtentP[2];\n    this.minLatP_ = worldExtentP[1];\n    this.minLonP_ = worldExtentP[0];\n\n    this.fromLonLatTransform_ = getTransform(epsg4326Projection, projection);\n\n    this.toLonLatTransform_ = getTransform(projection, epsg4326Projection);\n\n    this.projectionCenterLonLat_ = this.toLonLatTransform_(getCenter(projection.getExtent()));\n\n    this.projection_ = projection;\n  }\n}\n\n\nexport default Graticule;\n","/**\n * @module ol/MapBrowserEventHandler\n */\n\nimport '@openlayers/pepjs';\nimport {DEVICE_PIXEL_RATIO} from './has.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapBrowserPointerEvent from './MapBrowserPointerEvent.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventTarget from './events/Target.js';\nimport PointerEventType from './pointer/EventType.js';\n\nclass MapBrowserEventHandler extends EventTarget {\n\n  /**\n   * @param {import(\"./PluggableMap.js\").default} map The map with the viewport to listen to events on.\n   * @param {number=} moveTolerance The minimal distance the pointer must travel to trigger a move.\n   */\n  constructor(map, moveTolerance) {\n\n    super(map);\n\n    /**\n     * This is the element that we will listen to the real events on.\n     * @type {import(\"./PluggableMap.js\").default}\n     * @private\n     */\n    this.map_ = map;\n\n    /**\n     * @type {any}\n     * @private\n     */\n    this.clickTimeoutId_;\n\n    /**\n     * @type {boolean}\n     * @private\n     */\n    this.dragging_ = false;\n\n    /**\n     * @type {!Array<import(\"./events.js\").EventsKey>}\n     * @private\n     */\n    this.dragListenerKeys_ = [];\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.moveTolerance_ = moveTolerance ?\n      moveTolerance * DEVICE_PIXEL_RATIO : DEVICE_PIXEL_RATIO;\n\n    /**\n     * The most recent \"down\" type event (or null if none have occurred).\n     * Set on pointerdown.\n     * @type {PointerEvent}\n     * @private\n     */\n    this.down_ = null;\n\n    const element = this.map_.getViewport();\n    element.setAttribute('touch-action', 'none');\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.activePointers_ = 0;\n\n    /**\n     * @type {!Object<number, boolean>}\n     * @private\n     */\n    this.trackedTouches_ = {};\n\n    this.element_ = element;\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.pointerdownListenerKey_ = listen(element,\n      PointerEventType.POINTERDOWN,\n      this.handlePointerDown_, this);\n\n    /**\n     * @type {?import(\"./events.js\").EventsKey}\n     * @private\n     */\n    this.relayedListenerKey_ = listen(element,\n      PointerEventType.POINTERMOVE,\n      this.relayEvent_, this);\n\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  emulateClick_(pointerEvent) {\n    let newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.CLICK, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n    if (this.clickTimeoutId_ !== undefined) {\n      // double-click\n      clearTimeout(this.clickTimeoutId_);\n      this.clickTimeoutId_ = undefined;\n      newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.DBLCLICK, this.map_, pointerEvent);\n      this.dispatchEvent(newEvent);\n    } else {\n      // click\n      this.clickTimeoutId_ = setTimeout(function() {\n        this.clickTimeoutId_ = undefined;\n        const newEvent = new MapBrowserPointerEvent(\n          MapBrowserEventType.SINGLECLICK, this.map_, pointerEvent);\n        this.dispatchEvent(newEvent);\n      }.bind(this), 250);\n    }\n  }\n\n  /**\n   * Keeps track on how many pointers are currently active.\n   *\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  updateActivePointers_(pointerEvent) {\n    const event = pointerEvent;\n\n    if (event.type == MapBrowserEventType.POINTERUP ||\n        event.type == MapBrowserEventType.POINTERCANCEL) {\n      delete this.trackedTouches_[event.pointerId];\n    } else if (event.type == MapBrowserEventType.POINTERDOWN) {\n      this.trackedTouches_[event.pointerId] = true;\n    }\n    this.activePointers_ = Object.keys(this.trackedTouches_).length;\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerUp_(pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    const newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERUP, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    // We emulate click events on left mouse button click, touch contact, and pen\n    // contact. isMouseActionButton returns true in these cases (evt.button is set\n    // to 0).\n    // See http://www.w3.org/TR/pointerevents/#button-states\n    // We only fire click, singleclick, and doubleclick if nobody has called\n    // event.stopPropagation() or event.preventDefault().\n    if (!newEvent.propagationStopped && !this.dragging_ && this.isMouseActionButton_(pointerEvent)) {\n      this.emulateClick_(this.down_);\n    }\n\n    if (this.activePointers_ === 0) {\n      this.dragListenerKeys_.forEach(unlistenByKey);\n      this.dragListenerKeys_.length = 0;\n      this.dragging_ = false;\n      this.down_ = null;\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @return {boolean} If the left mouse button was pressed.\n   * @private\n   */\n  isMouseActionButton_(pointerEvent) {\n    return pointerEvent.button === 0;\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerDown_(pointerEvent) {\n    this.updateActivePointers_(pointerEvent);\n    const newEvent = new MapBrowserPointerEvent(\n      MapBrowserEventType.POINTERDOWN, this.map_, pointerEvent);\n    this.dispatchEvent(newEvent);\n\n    this.down_ = pointerEvent;\n\n    if (this.dragListenerKeys_.length === 0) {\n      this.dragListenerKeys_.push(\n        listen(document,\n          MapBrowserEventType.POINTERMOVE,\n          this.handlePointerMove_, this),\n        listen(document,\n          MapBrowserEventType.POINTERUP,\n          this.handlePointerUp_, this),\n        /* Note that the listener for `pointercancel is set up on\n         * `pointerEventHandler_` and not `documentPointerEventHandler_` like\n         * the `pointerup` and `pointermove` listeners.\n         *\n         * The reason for this is the following: `TouchSource.vacuumTouches_()`\n         * issues `pointercancel` events, when there was no `touchend` for a\n         * `touchstart`. Now, let's say a first `touchstart` is registered on\n         * `pointerEventHandler_`. The `documentPointerEventHandler_` is set up.\n         * But `documentPointerEventHandler_` doesn't know about the first\n         * `touchstart`. If there is no `touchend` for the `touchstart`, we can\n         * only receive a `touchcancel` from `pointerEventHandler_`, because it is\n         * only registered there.\n         */\n        listen(this.element_,\n          MapBrowserEventType.POINTERCANCEL,\n          this.handlePointerUp_, this)\n      );\n    }\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  handlePointerMove_(pointerEvent) {\n    // Between pointerdown and pointerup, pointermove events are triggered.\n    // To avoid a 'false' touchmove event to be dispatched, we test if the pointer\n    // moved a significant distance.\n    if (this.isMoving_(pointerEvent)) {\n      this.dragging_ = true;\n      const newEvent = new MapBrowserPointerEvent(\n        MapBrowserEventType.POINTERDRAG, this.map_, pointerEvent,\n        this.dragging_);\n      this.dispatchEvent(newEvent);\n    }\n  }\n\n  /**\n   * Wrap and relay a pointer event.  Note that this requires that the type\n   * string for the MapBrowserPointerEvent matches the PointerEvent type.\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @private\n   */\n  relayEvent_(pointerEvent) {\n    const dragging = !!(this.down_ && this.isMoving_(pointerEvent));\n    this.dispatchEvent(new MapBrowserPointerEvent(\n      pointerEvent.type, this.map_, pointerEvent, dragging));\n  }\n\n  /**\n   * @param {PointerEvent} pointerEvent Pointer\n   * event.\n   * @return {boolean} Is moving.\n   * @private\n   */\n  isMoving_(pointerEvent) {\n    return this.dragging_ ||\n        Math.abs(pointerEvent.clientX - this.down_.clientX) > this.moveTolerance_ ||\n        Math.abs(pointerEvent.clientY - this.down_.clientY) > this.moveTolerance_;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    if (this.relayedListenerKey_) {\n      unlistenByKey(this.relayedListenerKey_);\n      this.relayedListenerKey_ = null;\n    }\n    if (this.pointerdownListenerKey_) {\n      unlistenByKey(this.pointerdownListenerKey_);\n      this.pointerdownListenerKey_ = null;\n    }\n\n    this.dragListenerKeys_.forEach(unlistenByKey);\n    this.dragListenerKeys_.length = 0;\n\n    this.element_ = null;\n    super.disposeInternal();\n  }\n}\n\n\nexport default MapBrowserEventHandler;\n","/**\n * @module ol/PluggableMap\n */\nimport {getUid} from './util.js';\nimport Collection from './Collection.js';\nimport CollectionEventType from './CollectionEventType.js';\nimport MapBrowserEvent from './MapBrowserEvent.js';\nimport MapBrowserEventHandler from './MapBrowserEventHandler.js';\nimport MapBrowserEventType from './MapBrowserEventType.js';\nimport MapEvent from './MapEvent.js';\nimport MapEventType from './MapEventType.js';\nimport MapProperty from './MapProperty.js';\nimport RenderEventType from './render/EventType.js';\nimport BaseObject, {getChangeEventType} from './Object.js';\nimport ObjectEventType from './ObjectEventType.js';\nimport TileQueue from './TileQueue.js';\nimport View from './View.js';\nimport ViewHint from './ViewHint.js';\nimport {assert} from './asserts.js';\nimport {removeNode} from './dom.js';\nimport {listen, unlistenByKey} from './events.js';\nimport EventType from './events/EventType.js';\nimport {clone, createOrUpdateEmpty, equals, getForViewAndSize, isEmpty} from './extent.js';\nimport {TRUE} from './functions.js';\nimport {DEVICE_PIXEL_RATIO, IMAGE_DECODE} from './has.js';\nimport LayerGroup from './layer/Group.js';\nimport {hasArea} from './size.js';\nimport {DROP} from './structs/PriorityQueue.js';\nimport {create as createTransform, apply as applyTransform} from './transform.js';\nimport {toUserCoordinate, fromUserCoordinate} from './proj.js';\n\n\n/**\n * State of the current frame. Only `pixelRatio`, `time` and `viewState` should\n * be used in applications.\n * @typedef {Object} FrameState\n * @property {number} pixelRatio The pixel ratio of the frame.\n * @property {number} time The time when rendering of the frame was requested.\n * @property {import(\"./View.js\").State} viewState The state of the current view.\n * @property {boolean} animate\n * @property {import(\"./transform.js\").Transform} coordinateToPixelTransform\n * @property {null|import(\"./extent.js\").Extent} extent\n * @property {Array<DeclutterItems>} declutterItems\n * @property {number} index\n * @property {Array<import(\"./layer/Layer.js\").State>} layerStatesArray\n * @property {number} layerIndex\n * @property {import(\"./transform.js\").Transform} pixelToCoordinateTransform\n * @property {Array<PostRenderFunction>} postRenderFunctions\n * @property {import(\"./size.js\").Size} size\n * @property {TileQueue} tileQueue\n * @property {!Object<string, Object<string, boolean>>} usedTiles\n * @property {Array<number>} viewHints\n * @property {!Object<string, Object<string, boolean>>} wantedTiles\n */\n\n\n/**\n * @typedef {Object} DeclutterItems\n * @property {Array<*>} items Declutter items of an executor.\n * @property {number} opacity Layer opacity.\n */\n\n\n/**\n * @typedef {function(PluggableMap, ?FrameState): any} PostRenderFunction\n */\n\n\n/**\n * @typedef {Object} AtPixelOptions\n * @property {undefined|function(import(\"./layer/Layer.js\").default): boolean} [layerFilter] Layer filter\n * function. The filter function will receive one argument, the\n * {@link module:ol/layer/Layer layer-candidate} and it should return a boolean value.\n * Only layers which are visible and for which this function returns `true`\n * will be tested for features. By default, all visible layers will be tested.\n * @property {number} [hitTolerance=0] Hit-detection tolerance in pixels. Pixels\n * inside the radius around the given position will be checked for features.\n * @property {boolean} [checkWrapped=true] Check-Wrapped Will check for for wrapped geometries inside the range of\n *   +/- 1 world width. Works only if a projection is used that can be wrapped.\n */\n\n\n/**\n * @typedef {Object} MapOptionsInternal\n * @property {Collection<import(\"./control/Control.js\").default>} [controls]\n * @property {Collection<import(\"./interaction/Interaction.js\").default>} [interactions]\n * @property {HTMLElement|Document} keyboardEventTarget\n * @property {Collection<import(\"./Overlay.js\").default>} overlays\n * @property {Object<string, *>} values\n */\n\n\n/**\n * Object literal with config options for the map.\n * @typedef {Object} MapOptions\n * @property {Collection<import(\"./control/Control.js\").default>|Array<import(\"./control/Control.js\").default>} [controls]\n * Controls initially added to the map. If not specified,\n * {@link module:ol/control~defaults} is used.\n * @property {number} [pixelRatio=window.devicePixelRatio] The ratio between\n * physical pixels and device-independent pixels (dips) on the device.\n * @property {Collection<import(\"./interaction/Interaction.js\").default>|Array<import(\"./interaction/Interaction.js\").default>} [interactions]\n * Interactions that are initially added to the map. If not specified,\n * {@link module:ol/interaction~defaults} is used.\n * @property {HTMLElement|Document|string} [keyboardEventTarget] The element to\n * listen to keyboard events on. This determines when the `KeyboardPan` and\n * `KeyboardZoom` interactions trigger. For example, if this option is set to\n * `document` the keyboard interactions will always trigger. If this option is\n * not specified, the element the library listens to keyboard events on is the\n * map target (i.e. the user-provided div for the map). If this is not\n * `document`, the target element needs to be focused for key events to be\n * emitted, requiring that the target element has a `tabindex` attribute.\n * @property {Array<import(\"./layer/Base.js\").default>|Collection<import(\"./layer/Base.js\").default>|LayerGroup} [layers]\n * Layers. If this is not defined, a map with no layers will be rendered. Note\n * that layers are rendered in the order supplied, so if you want, for example,\n * a vector layer to appear on top of a tile layer, it must come after the tile\n * layer.\n * @property {number} [maxTilesLoading=16] Maximum number tiles to load\n * simultaneously.\n * @property {number} [moveTolerance=1] The minimum distance in pixels the\n * cursor must move to be detected as a map move event instead of a click.\n * Increasing this value can make it easier to click on the map.\n * @property {Collection<import(\"./Overlay.js\").default>|Array<import(\"./Overlay.js\").default>} [overlays]\n * Overlays initially added to the map. By default, no overlays are added.\n * @property {HTMLElement|string} [target] The container for the map, either the\n * element itself or the `id` of the element. If not specified at construction\n * time, {@link module:ol/Map~Map#setTarget} must be called for the map to be\n * rendered.\n * @property {View} [view] The map's view.  No layer sources will be\n * fetched unless this is specified at construction time or through\n * {@link module:ol/Map~Map#setView}.\n */\n\n\n/**\n * @fires import(\"./MapBrowserEvent.js\").MapBrowserEvent\n * @fires import(\"./MapEvent.js\").MapEvent\n * @fires import(\"./render/Event.js\").default#precompose\n * @fires import(\"./render/Event.js\").default#postcompose\n * @fires import(\"./render/Event.js\").default#rendercomplete\n * @api\n */\nclass PluggableMap extends BaseObject {\n\n  /**\n   * @param {MapOptions} options Map options.\n   */\n  constructor(options) {\n\n    super();\n\n    const optionsInternal = createOptionsInternal(options);\n\n    /** @private */\n    this.boundHandleBrowserEvent_ = this.handleBrowserEvent.bind(this);\n\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.maxTilesLoading_ = options.maxTilesLoading !== undefined ? options.maxTilesLoading : 16;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.pixelRatio_ = options.pixelRatio !== undefined ?\n      options.pixelRatio : DEVICE_PIXEL_RATIO;\n\n    /**\n     * @private\n     * @type {*}\n     */\n    this.postRenderTimeoutHandle_;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.animationDelayKey_;\n\n    /**\n     * @private\n     */\n    this.animationDelay_ = function() {\n      this.animationDelayKey_ = undefined;\n      this.renderFrame_(Date.now());\n    }.bind(this);\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.coordinateToPixelTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {import(\"./transform.js\").Transform}\n     */\n    this.pixelToCoordinateTransform_ = createTransform();\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.frameIndex_ = 0;\n\n    /**\n     * @private\n     * @type {?FrameState}\n     */\n    this.frameState_ = null;\n\n    /**\n     * The extent at the previous 'moveend' event.\n     * @private\n     * @type {import(\"./extent.js\").Extent}\n     */\n    this.previousExtent_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewPropertyListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?import(\"./events.js\").EventsKey}\n     */\n    this.viewChangeListenerKey_ = null;\n\n    /**\n     * @private\n     * @type {?Array<import(\"./events.js\").EventsKey>}\n     */\n    this.layerGroupPropertyListenerKeys_ = null;\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.viewport_ = document.createElement('div');\n    this.viewport_.className = 'ol-viewport' + ('ontouchstart' in window ? ' ol-touch' : '');\n    this.viewport_.style.position = 'relative';\n    this.viewport_.style.overflow = 'hidden';\n    this.viewport_.style.width = '100%';\n    this.viewport_.style.height = '100%';\n    // prevent page zoom on IE >= 10 browsers\n    this.viewport_.style.msTouchAction = 'none';\n    this.viewport_.style.touchAction = 'none';\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainer_ = document.createElement('div');\n    this.overlayContainer_.style.position = 'absolute';\n    this.overlayContainer_.style.zIndex = '0';\n    this.overlayContainer_.style.width = '100%';\n    this.overlayContainer_.style.height = '100%';\n    this.overlayContainer_.className = 'ol-overlaycontainer';\n    this.viewport_.appendChild(this.overlayContainer_);\n\n    /**\n     * @private\n     * @type {!HTMLElement}\n     */\n    this.overlayContainerStopEvent_ = document.createElement('div');\n    this.overlayContainerStopEvent_.style.position = 'absolute';\n    this.overlayContainerStopEvent_.style.zIndex = '0';\n    this.overlayContainerStopEvent_.style.width = '100%';\n    this.overlayContainerStopEvent_.style.height = '100%';\n    this.overlayContainerStopEvent_.className = 'ol-overlaycontainer-stopevent';\n    this.viewport_.appendChild(this.overlayContainerStopEvent_);\n\n    /**\n     * @private\n     * @type {MapBrowserEventHandler}\n     */\n    this.mapBrowserEventHandler_ = new MapBrowserEventHandler(this, options.moveTolerance);\n    const handleMapBrowserEvent = this.handleMapBrowserEvent.bind(this);\n    for (const key in MapBrowserEventType) {\n      this.mapBrowserEventHandler_.addEventListener(MapBrowserEventType[key], handleMapBrowserEvent);\n    }\n\n    /**\n     * @private\n     * @type {HTMLElement|Document}\n     */\n    this.keyboardEventTarget_ = optionsInternal.keyboardEventTarget;\n\n    /**\n     * @private\n     * @type {?Array<import(\"./events.js\").EventsKey>}\n     */\n    this.keyHandlerKeys_ = null;\n\n    const handleBrowserEvent = this.handleBrowserEvent.bind(this);\n    this.viewport_.addEventListener(EventType.CONTEXTMENU, handleBrowserEvent, false);\n    this.viewport_.addEventListener(EventType.WHEEL, handleBrowserEvent, false);\n\n    /**\n     * @type {Collection<import(\"./control/Control.js\").default>}\n     * @protected\n     */\n    this.controls = optionsInternal.controls || new Collection();\n\n    /**\n     * @type {Collection<import(\"./interaction/Interaction.js\").default>}\n     * @protected\n     */\n    this.interactions = optionsInternal.interactions || new Collection();\n\n    /**\n     * @type {import(\"./events/Target.js\").default}\n     */\n    this.labelCache_ = null;\n\n    /**\n     * @type {import(\"./events.js\").EventsKey}\n     */\n    this.labelCacheListenerKey_;\n\n    /**\n     * @type {Collection<import(\"./Overlay.js\").default>}\n     * @private\n     */\n    this.overlays_ = optionsInternal.overlays;\n\n    /**\n     * A lookup of overlays by id.\n     * @private\n     * @type {Object<string, import(\"./Overlay.js\").default>}\n     */\n    this.overlayIdIndex_ = {};\n\n    /**\n     * @type {import(\"./renderer/Map.js\").default}\n     * @private\n     */\n    this.renderer_ = null;\n\n    /**\n     * @type {function(Event): void|undefined}\n     * @private\n     */\n    this.handleResize_;\n\n    /**\n     * @private\n     * @type {!Array<PostRenderFunction>}\n     */\n    this.postRenderFunctions_ = [];\n\n    /**\n     * @private\n     * @type {TileQueue}\n     */\n    this.tileQueue_ = new TileQueue(\n      this.getTilePriority.bind(this),\n      this.handleTileChange_.bind(this));\n\n    this.addEventListener(getChangeEventType(MapProperty.LAYERGROUP), this.handleLayerGroupChanged_);\n    this.addEventListener(getChangeEventType(MapProperty.VIEW), this.handleViewChanged_);\n    this.addEventListener(getChangeEventType(MapProperty.SIZE), this.handleSizeChanged_);\n    this.addEventListener(getChangeEventType(MapProperty.TARGET), this.handleTargetChanged_);\n\n    // setProperties will trigger the rendering of the map if the map\n    // is \"defined\" already.\n    this.setProperties(optionsInternal.values);\n\n    this.controls.forEach(\n      /**\n       * @param {import(\"./control/Control.js\").default} control Control.\n       * @this {PluggableMap}\n       */\n      function(control) {\n        control.setMap(this);\n      }.bind(this));\n\n    this.controls.addEventListener(CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }.bind(this));\n\n    this.controls.addEventListener(CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }.bind(this));\n\n    this.interactions.forEach(\n      /**\n       * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction.\n       * @this {PluggableMap}\n       */\n      function(interaction) {\n        interaction.setMap(this);\n      }.bind(this));\n\n    this.interactions.addEventListener(CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(this);\n      }.bind(this));\n\n    this.interactions.addEventListener(CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        event.element.setMap(null);\n      }.bind(this));\n\n    this.overlays_.forEach(this.addOverlayInternal_.bind(this));\n\n    this.overlays_.addEventListener(CollectionEventType.ADD,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        this.addOverlayInternal_(/** @type {import(\"./Overlay.js\").default} */ (event.element));\n      }.bind(this));\n\n    this.overlays_.addEventListener(CollectionEventType.REMOVE,\n      /**\n       * @param {import(\"./Collection.js\").CollectionEvent} event CollectionEvent.\n       */\n      function(event) {\n        const overlay = /** @type {import(\"./Overlay.js\").default} */ (event.element);\n        const id = overlay.getId();\n        if (id !== undefined) {\n          delete this.overlayIdIndex_[id.toString()];\n        }\n        event.element.setMap(null);\n      }.bind(this));\n\n  }\n\n  /**\n   * @abstract\n   * @return {import(\"./renderer/Map.js\").default} The map renderer\n   */\n  createRenderer() {\n    throw new Error('Use a map type that has a createRenderer method');\n  }\n\n  /**\n   * Add the given control to the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @api\n   */\n  addControl(control) {\n    this.getControls().push(control);\n  }\n\n  /**\n   * Add the given interaction to the map. If you want to add an interaction\n   * at another point of the collection use `getInteraction()` and the methods\n   * available on {@link module:ol/Collection~Collection}. This can be used to\n   * stop the event propagation from the handleEvent function. The interactions\n   * get to handle the events in the reverse order of this collection.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to add.\n   * @api\n   */\n  addInteraction(interaction) {\n    this.getInteractions().push(interaction);\n  }\n\n  /**\n   * Adds the given layer to the top of this map. If you want to add a layer\n   * elsewhere in the stack, use `getLayers()` and the methods available on\n   * {@link module:ol/Collection~Collection}.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @api\n   */\n  addLayer(layer) {\n    const layers = this.getLayerGroup().getLayers();\n    layers.push(layer);\n  }\n\n  /**\n   * Add the given overlay to the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @api\n   */\n  addOverlay(overlay) {\n    this.getOverlays().push(overlay);\n  }\n\n  /**\n   * This deals with map's overlay collection changes.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @private\n   */\n  addOverlayInternal_(overlay) {\n    const id = overlay.getId();\n    if (id !== undefined) {\n      this.overlayIdIndex_[id.toString()] = overlay;\n    }\n    overlay.setMap(this);\n  }\n\n  /**\n   *\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.mapBrowserEventHandler_.dispose();\n    this.viewport_.removeEventListener(EventType.CONTEXTMENU, this.boundHandleBrowserEvent_);\n    this.viewport_.removeEventListener(EventType.WHEEL, this.boundHandleBrowserEvent_);\n    if (this.handleResize_ !== undefined) {\n      removeEventListener(EventType.RESIZE, this.handleResize_, false);\n      this.handleResize_ = undefined;\n    }\n    this.setTarget(null);\n    super.disposeInternal();\n  }\n\n  /**\n   * Detect features that intersect a pixel on the viewport, and execute a\n   * callback with each intersecting feature. Layers included in the detection can\n   * be configured through the `layerFilter` option in `opt_options`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./Feature.js\").FeatureLike,\n   *     import(\"./layer/Layer.js\").default): T} callback Feature callback. The callback will be\n   *     called with two arguments. The first argument is one\n   *     {@link module:ol/Feature feature} or\n   *     {@link module:ol/render/Feature render feature} at the pixel, the second is\n   *     the {@link module:ol/layer/Layer layer} of the feature and will be null for\n   *     unmanaged layers. To stop detection, callback functions can return a\n   *     truthy value.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  forEachFeatureAtPixel(pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    const coordinate = this.getCoordinateFromPixelInternal(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    const hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    const layerFilter = opt_options.layerFilter !== undefined ?\n      opt_options.layerFilter : TRUE;\n    const checkWrapped = opt_options.checkWrapped !== false;\n    return this.renderer_.forEachFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, checkWrapped, callback, null,\n      layerFilter, null);\n  }\n\n  /**\n   * Get all features that intersect a pixel on the viewport.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {Array<import(\"./Feature.js\").FeatureLike>} The detected features or\n   * an empty array if none were found.\n   * @api\n   */\n  getFeaturesAtPixel(pixel, opt_options) {\n    const features = [];\n    this.forEachFeatureAtPixel(pixel, function(feature) {\n      features.push(feature);\n    }, opt_options);\n    return features;\n  }\n\n  /**\n   * Detect layers that have a color value at a pixel on the viewport, and\n   * execute a callback with each matching layer. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   *\n   * Note: this may give false positives unless the map layers have had different `className`\n   * properties assigned to them.\n   *\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {function(this: S, import(\"./layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback\n   *     Layer callback. This callback will receive two arguments: first is the\n   *     {@link module:ol/layer/Layer layer}, second argument is an array representing\n   *     [R, G, B, A] pixel values (0 - 255) and will be `null` for layer types\n   *     that do not currently support this argument. To stop detection, callback\n   *     functions can return a truthy value.\n   * @param {AtPixelOptions=} opt_options Configuration options.\n   * @return {T|undefined} Callback result, i.e. the return value of last\n   * callback execution, or the first truthy callback return value.\n   * @template S,T\n   * @api\n   */\n  forEachLayerAtPixel(pixel, callback, opt_options) {\n    if (!this.frameState_) {\n      return;\n    }\n    const options = opt_options || /** @type {AtPixelOptions} */ ({});\n    const hitTolerance = options.hitTolerance !== undefined ?\n      options.hitTolerance * this.frameState_.pixelRatio : 0;\n    const layerFilter = options.layerFilter || TRUE;\n    return this.renderer_.forEachLayerAtPixel(pixel, this.frameState_, hitTolerance, callback, layerFilter);\n  }\n\n  /**\n   * Detect if features intersect a pixel on the viewport. Layers included in the\n   * detection can be configured through `opt_layerFilter`.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel.\n   * @param {AtPixelOptions=} opt_options Optional options.\n   * @return {boolean} Is there a feature at the given pixel?\n   * @api\n   */\n  hasFeatureAtPixel(pixel, opt_options) {\n    if (!this.frameState_) {\n      return false;\n    }\n    const coordinate = this.getCoordinateFromPixelInternal(pixel);\n    opt_options = opt_options !== undefined ? opt_options :\n      /** @type {AtPixelOptions} */ ({});\n    const layerFilter = opt_options.layerFilter !== undefined ? opt_options.layerFilter : TRUE;\n    const hitTolerance = opt_options.hitTolerance !== undefined ?\n      opt_options.hitTolerance * this.frameState_.pixelRatio : 0;\n    const checkWrapped = opt_options.checkWrapped !== false;\n    return this.renderer_.hasFeatureAtCoordinate(\n      coordinate, this.frameState_, hitTolerance, checkWrapped, layerFilter, null);\n  }\n\n  /**\n   * Returns the coordinate in user projection for a browser event.\n   * @param {Event} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   * @api\n   */\n  getEventCoordinate(event) {\n    return this.getCoordinateFromPixel(this.getEventPixel(event));\n  }\n\n  /**\n   * Returns the coordinate in view projection for a browser event.\n   * @param {Event} event Event.\n   * @return {import(\"./coordinate.js\").Coordinate} Coordinate.\n   */\n  getEventCoordinateInternal(event) {\n    return this.getCoordinateFromPixelInternal(this.getEventPixel(event));\n  }\n\n  /**\n   * Returns the map pixel position for a browser event relative to the viewport.\n   * @param {Event|TouchEvent} event Event.\n   * @return {import(\"./pixel.js\").Pixel} Pixel.\n   * @api\n   */\n  getEventPixel(event) {\n    const viewportPosition = this.viewport_.getBoundingClientRect();\n    const eventPosition = 'changedTouches' in event ?\n      /** @type {TouchEvent} */ (event).changedTouches[0] :\n      /** @type {MouseEvent} */ (event);\n\n    return [\n      eventPosition.clientX - viewportPosition.left,\n      eventPosition.clientY - viewportPosition.top\n    ];\n  }\n\n  /**\n   * Get the target in which this map is rendered.\n   * Note that this returns what is entered as an option or in setTarget:\n   * if that was an element, it returns an element; if a string, it returns that.\n   * @return {HTMLElement|string|undefined} The Element or id of the Element that the\n   *     map is rendered in.\n   * @observable\n   * @api\n   */\n  getTarget() {\n    return /** @type {HTMLElement|string|undefined} */ (this.get(MapProperty.TARGET));\n  }\n\n  /**\n   * Get the DOM element into which this map is rendered. In contrast to\n   * `getTarget` this method always return an `Element`, or `null` if the\n   * map has no target.\n   * @return {HTMLElement} The element that the map is rendered in.\n   * @api\n   */\n  getTargetElement() {\n    const target = this.getTarget();\n    if (target !== undefined) {\n      return typeof target === 'string' ? document.getElementById(target) : target;\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * user projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   * @api\n   */\n  getCoordinateFromPixel(pixel) {\n    return toUserCoordinate(this.getCoordinateFromPixelInternal(pixel), this.getView().getProjection());\n  }\n\n  /**\n   * Get the coordinate for a given pixel.  This returns a coordinate in the\n   * map view projection.\n   * @param {import(\"./pixel.js\").Pixel} pixel Pixel position in the map viewport.\n   * @return {import(\"./coordinate.js\").Coordinate} The coordinate for the pixel position.\n   */\n  getCoordinateFromPixelInternal(pixel) {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.pixelToCoordinateTransform, pixel.slice());\n    }\n  }\n\n  /**\n   * Get the map controls. Modifying this collection changes the controls\n   * associated with the map.\n   * @return {Collection<import(\"./control/Control.js\").default>} Controls.\n   * @api\n   */\n  getControls() {\n    return this.controls;\n  }\n\n  /**\n   * Get the map overlays. Modifying this collection changes the overlays\n   * associated with the map.\n   * @return {Collection<import(\"./Overlay.js\").default>} Overlays.\n   * @api\n   */\n  getOverlays() {\n    return this.overlays_;\n  }\n\n  /**\n   * Get an overlay by its identifier (the value returned by overlay.getId()).\n   * Note that the index treats string and numeric identifiers as the same. So\n   * `map.getOverlayById(2)` will return an overlay with id `'2'` or `2`.\n   * @param {string|number} id Overlay identifier.\n   * @return {import(\"./Overlay.js\").default} Overlay.\n   * @api\n   */\n  getOverlayById(id) {\n    const overlay = this.overlayIdIndex_[id.toString()];\n    return overlay !== undefined ? overlay : null;\n  }\n\n  /**\n   * Get the map interactions. Modifying this collection changes the interactions\n   * associated with the map.\n   *\n   * Interactions are used for e.g. pan, zoom and rotate.\n   * @return {Collection<import(\"./interaction/Interaction.js\").default>} Interactions.\n   * @api\n   */\n  getInteractions() {\n    return this.interactions;\n  }\n\n  /**\n   * Get the layergroup associated with this map.\n   * @return {LayerGroup} A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  getLayerGroup() {\n    return (\n      /** @type {LayerGroup} */ (this.get(MapProperty.LAYERGROUP))\n    );\n  }\n\n  /**\n   * Get the collection of layers associated with this map.\n   * @return {!Collection<import(\"./layer/Base.js\").default>} Layers.\n   * @api\n   */\n  getLayers() {\n    const layers = this.getLayerGroup().getLayers();\n    return layers;\n  }\n\n  /**\n   * @return {boolean} Layers have sources that are still loading.\n   */\n  getLoading() {\n    const layerStatesArray = this.getLayerGroup().getLayerStatesArray();\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const layer = layerStatesArray[i].layer;\n      const source = /** @type {import(\"./layer/Layer.js\").default} */ (layer).getSource();\n      if (source && source.loading) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the user\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   * @api\n   */\n  getPixelFromCoordinate(coordinate) {\n    const viewCoordinate = fromUserCoordinate(coordinate, this.getView().getProjection());\n    return this.getPixelFromCoordinateInternal(viewCoordinate);\n  }\n\n  /**\n   * Get the pixel for a coordinate.  This takes a coordinate in the map view\n   * projection and returns the corresponding pixel.\n   * @param {import(\"./coordinate.js\").Coordinate} coordinate A map coordinate.\n   * @return {import(\"./pixel.js\").Pixel} A pixel position in the map viewport.\n   */\n  getPixelFromCoordinateInternal(coordinate) {\n    const frameState = this.frameState_;\n    if (!frameState) {\n      return null;\n    } else {\n      return applyTransform(frameState.coordinateToPixelTransform, coordinate.slice(0, 2));\n    }\n  }\n\n  /**\n   * Get the map renderer.\n   * @return {import(\"./renderer/Map.js\").default} Renderer\n   */\n  getRenderer() {\n    return this.renderer_;\n  }\n\n  /**\n   * Get the size of this map.\n   * @return {import(\"./size.js\").Size|undefined} The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  getSize() {\n    return (\n      /** @type {import(\"./size.js\").Size|undefined} */ (this.get(MapProperty.SIZE))\n    );\n  }\n\n  /**\n   * Get the view associated with this map. A view manages properties such as\n   * center and resolution.\n   * @return {View} The view that controls this map.\n   * @observable\n   * @api\n   */\n  getView() {\n    return (\n      /** @type {View} */ (this.get(MapProperty.VIEW))\n    );\n  }\n\n  /**\n   * Get the element that serves as the map viewport.\n   * @return {HTMLElement} Viewport.\n   * @api\n   */\n  getViewport() {\n    return this.viewport_;\n  }\n\n  /**\n   * Get the element that serves as the container for overlays.  Elements added to\n   * this container will let mousedown and touchstart events through to the map,\n   * so clicks and gestures on an overlay will trigger {@link module:ol/MapBrowserEvent~MapBrowserEvent}\n   * events.\n   * @return {!HTMLElement} The map's overlay container.\n   */\n  getOverlayContainer() {\n    return this.overlayContainer_;\n  }\n\n  /**\n   * Get the element that serves as a container for overlays that don't allow\n   * event propagation. Elements added to this container won't let mousedown and\n   * touchstart events through to the map, so clicks and gestures on an overlay\n   * don't trigger any {@link module:ol/MapBrowserEvent~MapBrowserEvent}.\n   * @return {!HTMLElement} The map's overlay container that stops events.\n   */\n  getOverlayContainerStopEvent() {\n    return this.overlayContainerStopEvent_;\n  }\n\n  /**\n   * @param {import(\"./Tile.js\").default} tile Tile.\n   * @param {string} tileSourceKey Tile source key.\n   * @param {import(\"./coordinate.js\").Coordinate} tileCenter Tile center.\n   * @param {number} tileResolution Tile resolution.\n   * @return {number} Tile priority.\n   */\n  getTilePriority(tile, tileSourceKey, tileCenter, tileResolution) {\n    // Filter out tiles at higher zoom levels than the current zoom level, or that\n    // are outside the visible extent.\n    const frameState = this.frameState_;\n    if (!frameState || !(tileSourceKey in frameState.wantedTiles)) {\n      return DROP;\n    }\n    if (!frameState.wantedTiles[tileSourceKey][tile.getKey()]) {\n      return DROP;\n    }\n    // Prioritize the highest zoom level tiles closest to the focus.\n    // Tiles at higher zoom levels are prioritized using Math.log(tileResolution).\n    // Within a zoom level, tiles are prioritized by the distance in pixels between\n    // the center of the tile and the center of the viewport.  The factor of 65536\n    // means that the prioritization should behave as desired for tiles up to\n    // 65536 * Math.log(2) = 45426 pixels from the focus.\n    const center = frameState.viewState.center;\n    const deltaX = tileCenter[0] - center[0];\n    const deltaY = tileCenter[1] - center[1];\n    return 65536 * Math.log(tileResolution) +\n        Math.sqrt(deltaX * deltaX + deltaY * deltaY) / tileResolution;\n  }\n\n  /**\n   * @param {Event} browserEvent Browser event.\n   * @param {string=} opt_type Type.\n   */\n  handleBrowserEvent(browserEvent, opt_type) {\n    const type = opt_type || browserEvent.type;\n    const mapBrowserEvent = new MapBrowserEvent(type, this, browserEvent);\n    this.handleMapBrowserEvent(mapBrowserEvent);\n  }\n\n  /**\n   * @param {MapBrowserEvent} mapBrowserEvent The event to handle.\n   */\n  handleMapBrowserEvent(mapBrowserEvent) {\n    if (!this.frameState_) {\n      // With no view defined, we cannot translate pixels into geographical\n      // coordinates so interactions cannot be used.\n      return;\n    }\n    let target = mapBrowserEvent.originalEvent.target;\n    while (target instanceof HTMLElement) {\n      if (target.parentElement === this.overlayContainerStopEvent_) {\n        return;\n      }\n      target = target.parentElement;\n    }\n    mapBrowserEvent.frameState = this.frameState_;\n    const interactionsArray = this.getInteractions().getArray();\n    if (this.dispatchEvent(mapBrowserEvent) !== false) {\n      for (let i = interactionsArray.length - 1; i >= 0; i--) {\n        const interaction = interactionsArray[i];\n        if (!interaction.getActive()) {\n          continue;\n        }\n        const cont = interaction.handleEvent(mapBrowserEvent);\n        if (!cont) {\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * @protected\n   */\n  handlePostRender() {\n\n    const frameState = this.frameState_;\n\n    // Manage the tile queue\n    // Image loads are expensive and a limited resource, so try to use them\n    // efficiently:\n    // * When the view is static we allow a large number of parallel tile loads\n    //   to complete the frame as quickly as possible.\n    // * When animating or interacting, image loads can cause janks, so we reduce\n    //   the maximum number of loads per frame and limit the number of parallel\n    //   tile loads to remain reactive to view changes and to reduce the chance of\n    //   loading tiles that will quickly disappear from view.\n    const tileQueue = this.tileQueue_;\n    if (!tileQueue.isEmpty()) {\n      let maxTotalLoading = this.maxTilesLoading_;\n      let maxNewLoads = maxTotalLoading;\n      if (frameState) {\n        const hints = frameState.viewHints;\n        if (hints[ViewHint.ANIMATING] || hints[ViewHint.INTERACTING]) {\n          const lowOnFrameBudget = !IMAGE_DECODE && Date.now() - frameState.time > 8;\n          maxTotalLoading = lowOnFrameBudget ? 0 : 8;\n          maxNewLoads = lowOnFrameBudget ? 0 : 2;\n        }\n      }\n      if (tileQueue.getTilesLoading() < maxTotalLoading) {\n        tileQueue.reprioritize(); // FIXME only call if view has changed\n        tileQueue.loadMoreTiles(maxTotalLoading, maxNewLoads);\n      }\n    }\n\n    if (frameState && this.hasListener(RenderEventType.RENDERCOMPLETE) && !frameState.animate &&\n        !this.tileQueue_.getTilesLoading() && !this.getLoading()) {\n      this.renderer_.dispatchRenderEvent(RenderEventType.RENDERCOMPLETE, frameState);\n    }\n\n    const postRenderFunctions = this.postRenderFunctions_;\n    for (let i = 0, ii = postRenderFunctions.length; i < ii; ++i) {\n      postRenderFunctions[i](this, frameState);\n    }\n    postRenderFunctions.length = 0;\n  }\n\n  /**\n   * @private\n   */\n  handleSizeChanged_() {\n    if (this.getView()) {\n      this.getView().resolveConstraints(0);\n    }\n\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleTargetChanged_() {\n    // target may be undefined, null, a string or an Element.\n    // If it's a string we convert it to an Element before proceeding.\n    // If it's not now an Element we remove the viewport from the DOM.\n    // If it's an Element we append the viewport element to it.\n\n    let targetElement;\n    if (this.getTarget()) {\n      targetElement = this.getTargetElement();\n    }\n\n    if (this.keyHandlerKeys_) {\n      for (let i = 0, ii = this.keyHandlerKeys_.length; i < ii; ++i) {\n        unlistenByKey(this.keyHandlerKeys_[i]);\n      }\n      this.keyHandlerKeys_ = null;\n    }\n\n    if (!targetElement) {\n      if (this.renderer_) {\n        clearTimeout(this.postRenderTimeoutHandle_);\n        this.postRenderFunctions_.length = 0;\n        this.renderer_.dispose();\n        this.renderer_ = null;\n      }\n      if (this.animationDelayKey_) {\n        cancelAnimationFrame(this.animationDelayKey_);\n        this.animationDelayKey_ = undefined;\n      }\n      removeNode(this.viewport_);\n      if (this.handleResize_ !== undefined) {\n        removeEventListener(EventType.RESIZE, this.handleResize_, false);\n        this.handleResize_ = undefined;\n      }\n    } else {\n      targetElement.appendChild(this.viewport_);\n      if (!this.renderer_) {\n        this.renderer_ = this.createRenderer();\n      }\n\n      const keyboardEventTarget = !this.keyboardEventTarget_ ?\n        targetElement : this.keyboardEventTarget_;\n      this.keyHandlerKeys_ = [\n        listen(keyboardEventTarget, EventType.KEYDOWN, this.handleBrowserEvent, this),\n        listen(keyboardEventTarget, EventType.KEYPRESS, this.handleBrowserEvent, this)\n      ];\n\n      if (!this.handleResize_) {\n        this.handleResize_ = this.updateSize.bind(this);\n        window.addEventListener(EventType.RESIZE, this.handleResize_, false);\n      }\n    }\n\n    this.updateSize();\n    // updateSize calls setSize, so no need to call this.render\n    // ourselves here.\n  }\n\n  /**\n   * @private\n   */\n  handleTileChange_() {\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleViewPropertyChanged_() {\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleViewChanged_() {\n    if (this.viewPropertyListenerKey_) {\n      unlistenByKey(this.viewPropertyListenerKey_);\n      this.viewPropertyListenerKey_ = null;\n    }\n    if (this.viewChangeListenerKey_) {\n      unlistenByKey(this.viewChangeListenerKey_);\n      this.viewChangeListenerKey_ = null;\n    }\n    const view = this.getView();\n    if (view) {\n      this.viewport_.setAttribute('data-view', getUid(view));\n      this.viewPropertyListenerKey_ = listen(\n        view, ObjectEventType.PROPERTYCHANGE,\n        this.handleViewPropertyChanged_, this);\n      this.viewChangeListenerKey_ = listen(\n        view, EventType.CHANGE,\n        this.handleViewPropertyChanged_, this);\n\n      view.resolveConstraints(0);\n    }\n    this.render();\n  }\n\n  /**\n   * @private\n   */\n  handleLayerGroupChanged_() {\n    if (this.layerGroupPropertyListenerKeys_) {\n      this.layerGroupPropertyListenerKeys_.forEach(unlistenByKey);\n      this.layerGroupPropertyListenerKeys_ = null;\n    }\n    const layerGroup = this.getLayerGroup();\n    if (layerGroup) {\n      this.layerGroupPropertyListenerKeys_ = [\n        listen(\n          layerGroup, ObjectEventType.PROPERTYCHANGE,\n          this.render, this),\n        listen(\n          layerGroup, EventType.CHANGE,\n          this.render, this)\n      ];\n    }\n    this.render();\n  }\n\n  /**\n   * @return {boolean} Is rendered.\n   */\n  isRendered() {\n    return !!this.frameState_;\n  }\n\n  /**\n   * Requests an immediate render in a synchronous manner.\n   * @api\n   */\n  renderSync() {\n    if (this.animationDelayKey_) {\n      cancelAnimationFrame(this.animationDelayKey_);\n    }\n    this.animationDelay_();\n  }\n\n  /**\n   * Redraws all text after new fonts have loaded\n   */\n  redrawText() {\n    const layerStates = this.getLayerGroup().getLayerStatesArray();\n    for (let i = 0, ii = layerStates.length; i < ii; ++i) {\n      const layer = layerStates[i].layer;\n      if (layer.hasRenderer()) {\n        layer.getRenderer().handleFontsChanged();\n      }\n    }\n  }\n\n  /**\n   * Request a map rendering (at the next animation frame).\n   * @api\n   */\n  render() {\n    if (this.renderer_ && this.animationDelayKey_ === undefined) {\n      this.animationDelayKey_ = requestAnimationFrame(this.animationDelay_);\n    }\n  }\n\n  /**\n   * Remove the given control from the map.\n   * @param {import(\"./control/Control.js\").default} control Control.\n   * @return {import(\"./control/Control.js\").default|undefined} The removed control (or undefined\n   *     if the control was not found).\n   * @api\n   */\n  removeControl(control) {\n    return this.getControls().remove(control);\n  }\n\n  /**\n   * Remove the given interaction from the map.\n   * @param {import(\"./interaction/Interaction.js\").default} interaction Interaction to remove.\n   * @return {import(\"./interaction/Interaction.js\").default|undefined} The removed interaction (or\n   *     undefined if the interaction was not found).\n   * @api\n   */\n  removeInteraction(interaction) {\n    return this.getInteractions().remove(interaction);\n  }\n\n  /**\n   * Removes the given layer from the map.\n   * @param {import(\"./layer/Base.js\").default} layer Layer.\n   * @return {import(\"./layer/Base.js\").default|undefined} The removed layer (or undefined if the\n   *     layer was not found).\n   * @api\n   */\n  removeLayer(layer) {\n    const layers = this.getLayerGroup().getLayers();\n    return layers.remove(layer);\n  }\n\n  /**\n   * Remove the given overlay from the map.\n   * @param {import(\"./Overlay.js\").default} overlay Overlay.\n   * @return {import(\"./Overlay.js\").default|undefined} The removed overlay (or undefined\n   *     if the overlay was not found).\n   * @api\n   */\n  removeOverlay(overlay) {\n    return this.getOverlays().remove(overlay);\n  }\n\n  /**\n   * @param {number} time Time.\n   * @private\n   */\n  renderFrame_(time) {\n    const size = this.getSize();\n    const view = this.getView();\n    const previousFrameState = this.frameState_;\n    /** @type {?FrameState} */\n    let frameState = null;\n    if (size !== undefined && hasArea(size) && view && view.isDef()) {\n      const viewHints = view.getHints(this.frameState_ ? this.frameState_.viewHints : undefined);\n      const viewState = view.getState();\n      frameState = {\n        animate: false,\n        coordinateToPixelTransform: this.coordinateToPixelTransform_,\n        declutterItems: previousFrameState ? previousFrameState.declutterItems : [],\n        extent: getForViewAndSize(viewState.center, viewState.resolution, viewState.rotation, size),\n        index: this.frameIndex_++,\n        layerIndex: 0,\n        layerStatesArray: this.getLayerGroup().getLayerStatesArray(),\n        pixelRatio: this.pixelRatio_,\n        pixelToCoordinateTransform: this.pixelToCoordinateTransform_,\n        postRenderFunctions: [],\n        size: size,\n        tileQueue: this.tileQueue_,\n        time: time,\n        usedTiles: {},\n        viewState: viewState,\n        viewHints: viewHints,\n        wantedTiles: {}\n      };\n    }\n\n    this.frameState_ = frameState;\n    this.renderer_.renderFrame(frameState);\n\n    if (frameState) {\n      if (frameState.animate) {\n        this.render();\n      }\n      Array.prototype.push.apply(this.postRenderFunctions_, frameState.postRenderFunctions);\n\n      if (previousFrameState) {\n        const moveStart = !this.previousExtent_ ||\n                    (!isEmpty(this.previousExtent_) &&\n                    !equals(frameState.extent, this.previousExtent_));\n        if (moveStart) {\n          this.dispatchEvent(\n            new MapEvent(MapEventType.MOVESTART, this, previousFrameState));\n          this.previousExtent_ = createOrUpdateEmpty(this.previousExtent_);\n        }\n      }\n\n      const idle = this.previousExtent_ &&\n          !frameState.viewHints[ViewHint.ANIMATING] &&\n          !frameState.viewHints[ViewHint.INTERACTING] &&\n          !equals(frameState.extent, this.previousExtent_);\n\n      if (idle) {\n        this.dispatchEvent(new MapEvent(MapEventType.MOVEEND, this, frameState));\n        clone(frameState.extent, this.previousExtent_);\n      }\n    }\n\n    this.dispatchEvent(new MapEvent(MapEventType.POSTRENDER, this, frameState));\n\n    this.postRenderTimeoutHandle_ = setTimeout(this.handlePostRender.bind(this), 0);\n\n  }\n\n  /**\n   * Sets the layergroup of this map.\n   * @param {LayerGroup} layerGroup A layer group containing the layers in this map.\n   * @observable\n   * @api\n   */\n  setLayerGroup(layerGroup) {\n    this.set(MapProperty.LAYERGROUP, layerGroup);\n  }\n\n  /**\n   * Set the size of this map.\n   * @param {import(\"./size.js\").Size|undefined} size The size in pixels of the map in the DOM.\n   * @observable\n   * @api\n   */\n  setSize(size) {\n    this.set(MapProperty.SIZE, size);\n  }\n\n  /**\n   * Set the target element to render this map into.\n   * @param {HTMLElement|string|undefined} target The Element or id of the Element\n   *     that the map is rendered in.\n   * @observable\n   * @api\n   */\n  setTarget(target) {\n    this.set(MapProperty.TARGET, target);\n  }\n\n  /**\n   * Set the view for this map.\n   * @param {View} view The view that controls this map.\n   * @observable\n   * @api\n   */\n  setView(view) {\n    this.set(MapProperty.VIEW, view);\n  }\n\n  /**\n   * Force a recalculation of the map viewport size.  This should be called when\n   * third-party code changes the size of the map viewport.\n   * @api\n   */\n  updateSize() {\n    const targetElement = this.getTargetElement();\n\n    if (!targetElement) {\n      this.setSize(undefined);\n    } else {\n      const computedStyle = getComputedStyle(targetElement);\n      this.setSize([\n        targetElement.offsetWidth -\n            parseFloat(computedStyle['borderLeftWidth']) -\n            parseFloat(computedStyle['paddingLeft']) -\n            parseFloat(computedStyle['paddingRight']) -\n            parseFloat(computedStyle['borderRightWidth']),\n        targetElement.offsetHeight -\n            parseFloat(computedStyle['borderTopWidth']) -\n            parseFloat(computedStyle['paddingTop']) -\n            parseFloat(computedStyle['paddingBottom']) -\n            parseFloat(computedStyle['borderBottomWidth'])\n      ]);\n    }\n  }\n}\n\n\n/**\n * @param {MapOptions} options Map options.\n * @return {MapOptionsInternal} Internal map options.\n */\nfunction createOptionsInternal(options) {\n\n  /**\n   * @type {HTMLElement|Document}\n   */\n  let keyboardEventTarget = null;\n  if (options.keyboardEventTarget !== undefined) {\n    keyboardEventTarget = typeof options.keyboardEventTarget === 'string' ?\n      document.getElementById(options.keyboardEventTarget) :\n      options.keyboardEventTarget;\n  }\n\n  /**\n   * @type {Object<string, *>}\n   */\n  const values = {};\n\n  const layerGroup = options.layers && typeof /** @type {?} */ (options.layers).getLayers === 'function' ?\n    /** @type {LayerGroup} */ (options.layers) : new LayerGroup({layers: /** @type {Collection} */ (options.layers)});\n  values[MapProperty.LAYERGROUP] = layerGroup;\n\n  values[MapProperty.TARGET] = options.target;\n\n  values[MapProperty.VIEW] = options.view !== undefined ?\n    options.view : new View();\n\n  let controls;\n  if (options.controls !== undefined) {\n    if (Array.isArray(options.controls)) {\n      controls = new Collection(options.controls.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.controls).getArray === 'function',\n        47); // Expected `controls` to be an array or an `import(\"./Collection.js\").Collection`\n      controls = /** @type {Collection} */ (options.controls);\n    }\n  }\n\n  let interactions;\n  if (options.interactions !== undefined) {\n    if (Array.isArray(options.interactions)) {\n      interactions = new Collection(options.interactions.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.interactions).getArray === 'function',\n        48); // Expected `interactions` to be an array or an `import(\"./Collection.js\").Collection`\n      interactions = /** @type {Collection} */ (options.interactions);\n    }\n  }\n\n  let overlays;\n  if (options.overlays !== undefined) {\n    if (Array.isArray(options.overlays)) {\n      overlays = new Collection(options.overlays.slice());\n    } else {\n      assert(typeof /** @type {?} */ (options.overlays).getArray === 'function',\n        49); // Expected `overlays` to be an array or an `import(\"./Collection.js\").Collection`\n      overlays = options.overlays;\n    }\n  } else {\n    overlays = new Collection();\n  }\n\n  return {\n    controls: controls,\n    interactions: interactions,\n    keyboardEventTarget: keyboardEventTarget,\n    overlays: overlays,\n    values: values\n  };\n\n}\nexport default PluggableMap;\n","/**\n * @module ol/renderer/Map\n */\nimport {abstract} from '../util.js';\nimport Disposable from '../Disposable.js';\nimport {getWidth} from '../extent.js';\nimport {TRUE} from '../functions.js';\nimport {inView} from '../layer/Layer.js';\nimport {shared as iconImageCache} from '../style/IconImageCache.js';\nimport {compose as composeTransform, makeInverse} from '../transform.js';\nimport {renderDeclutterItems} from '../render.js';\n\n/**\n * @abstract\n */\nclass MapRenderer extends Disposable {\n\n  /**\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n  constructor(map) {\n    super();\n\n    /**\n     * @private\n     * @type {import(\"../PluggableMap.js\").default}\n     */\n    this.map_ = map;\n\n    /**\n     * @private\n     */\n    this.declutterTree_ = null;\n\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../render/EventType.js\").default} type Event type.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  dispatchRenderEvent(type, frameState) {\n    abstract();\n  }\n\n  /**\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @protected\n   */\n  calculateMatrices2D(frameState) {\n    const viewState = frameState.viewState;\n    const coordinateToPixelTransform = frameState.coordinateToPixelTransform;\n    const pixelToCoordinateTransform = frameState.pixelToCoordinateTransform;\n\n    composeTransform(coordinateToPixelTransform,\n      frameState.size[0] / 2, frameState.size[1] / 2,\n      1 / viewState.resolution, -1 / viewState.resolution,\n      -viewState.rotation,\n      -viewState.center[0], -viewState.center[1]);\n\n    makeInverse(pixelToCoordinateTransform, coordinateToPixelTransform);\n  }\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {boolean} checkWrapped Check for wrapped geometries.\n   * @param {function(this: S, import(\"../Feature.js\").FeatureLike,\n   *     import(\"../layer/Layer.js\").default): T} callback Feature callback.\n   * @param {S} thisArg Value to use as `this` when executing `callback`.\n   * @param {function(this: U, import(\"../layer/Layer.js\").default): boolean} layerFilter Layer filter\n   *     function, only layers which are visible and for which this function\n   *     returns `true` will be tested for features.  By default, all visible\n   *     layers will be tested.\n   * @param {U} thisArg2 Value to use as `this` when executing `layerFilter`.\n   * @return {T|undefined} Callback result.\n   * @template S,T,U\n   */\n  forEachFeatureAtCoordinate(\n    coordinate,\n    frameState,\n    hitTolerance,\n    checkWrapped,\n    callback,\n    thisArg,\n    layerFilter,\n    thisArg2\n  ) {\n    let result;\n    const viewState = frameState.viewState;\n\n    /**\n     * @param {boolean} managed Managed layer.\n     * @param {import(\"../Feature.js\").FeatureLike} feature Feature.\n     * @param {import(\"../layer/Layer.js\").default} layer Layer.\n     * @return {?} Callback result.\n     */\n    function forEachFeatureAtCoordinate(managed, feature, layer) {\n      return callback.call(thisArg, feature, managed ? layer : null);\n    }\n\n    const projection = viewState.projection;\n\n    let translatedCoordinate = coordinate;\n    const offsets = [[0, 0]];\n    if (projection.canWrapX()) {\n      const projectionExtent = projection.getExtent();\n      const worldWidth = getWidth(projectionExtent);\n      const x = coordinate[0];\n      if (x < projectionExtent[0] || x > projectionExtent[2]) {\n        const worldsAway = Math.ceil((projectionExtent[0] - x) / worldWidth);\n        translatedCoordinate = [x + worldWidth * worldsAway, coordinate[1]];\n      }\n      if (checkWrapped) {\n        offsets.push([-worldWidth, 0], [worldWidth, 0]);\n      }\n    }\n\n    const layerStates = frameState.layerStatesArray;\n    const numLayers = layerStates.length;\n    let declutteredFeatures;\n    if (this.declutterTree_) {\n      declutteredFeatures = this.declutterTree_.all().map(function(entry) {\n        return entry.value;\n      });\n    }\n\n    const tmpCoord = [];\n    for (let i = 0; i < offsets.length; i++) {\n      for (let j = numLayers - 1; j >= 0; --j) {\n        const layerState = layerStates[j];\n        const layer = /** @type {import(\"../layer/Layer.js\").default} */ (layerState.layer);\n        if (layer.hasRenderer() && inView(layerState, viewState) && layerFilter.call(thisArg2, layer)) {\n          const layerRenderer = layer.getRenderer();\n          const source = layer.getSource();\n          const coordinates = source.getWrapX() ? translatedCoordinate : coordinate;\n          if (layerRenderer && source) {\n            const callback = forEachFeatureAtCoordinate.bind(null, layerState.managed);\n            tmpCoord[0] = coordinates[0] + offsets[i][0];\n            tmpCoord[1] = coordinates[1] + offsets[i][1];\n            result = layerRenderer.forEachFeatureAtCoordinate(\n              tmpCoord,\n              frameState, hitTolerance, callback, declutteredFeatures);\n          }\n          if (result) {\n            return result;\n          }\n        }\n      }\n    }\n    return undefined;\n  }\n\n  /**\n   * @abstract\n   * @param {import(\"../pixel.js\").Pixel} pixel Pixel.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {function(this: S, import(\"../layer/Layer.js\").default, (Uint8ClampedArray|Uint8Array)): T} callback Layer\n   *     callback.\n   * @param {function(this: U, import(\"../layer/Layer.js\").default): boolean} layerFilter Layer filter\n   *     function, only layers which are visible and for which this function\n   *     returns `true` will be tested for features.  By default, all visible\n   *     layers will be tested.\n   * @return {T|undefined} Callback result.\n   * @template S,T,U\n   */\n  forEachLayerAtPixel(pixel, frameState, hitTolerance, callback, layerFilter) {\n    return abstract();\n  }\n\n  /**\n   * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState FrameState.\n   * @param {number} hitTolerance Hit tolerance in pixels.\n   * @param {boolean} checkWrapped Check for wrapped geometries.\n   * @param {function(this: U, import(\"../layer/Layer.js\").default): boolean} layerFilter Layer filter\n   *     function, only layers which are visible and for which this function\n   *     returns `true` will be tested for features.  By default, all visible\n   *     layers will be tested.\n   * @param {U} thisArg Value to use as `this` when executing `layerFilter`.\n   * @return {boolean} Is there a feature at the given coordinate?\n   * @template U\n   */\n  hasFeatureAtCoordinate(coordinate, frameState, hitTolerance, checkWrapped, layerFilter, thisArg) {\n    const hasFeature = this.forEachFeatureAtCoordinate(\n      coordinate, frameState, hitTolerance, checkWrapped, TRUE, this, layerFilter, thisArg);\n\n    return hasFeature !== undefined;\n  }\n\n  /**\n   * @return {import(\"../PluggableMap.js\").default} Map.\n   */\n  getMap() {\n    return this.map_;\n  }\n\n  /**\n   * Render.\n   * @param {?import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  renderFrame(frameState) {\n    this.declutterTree_ = renderDeclutterItems(frameState, this.declutterTree_);\n  }\n\n  /**\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   * @protected\n   */\n  scheduleExpireIconCache(frameState) {\n    if (iconImageCache.canExpireCache()) {\n      frameState.postRenderFunctions.push(expireIconCache);\n    }\n  }\n}\n\n\n/**\n * @param {import(\"../PluggableMap.js\").default} map Map.\n * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n */\nfunction expireIconCache(map, frameState) {\n  iconImageCache.expire();\n}\n\nexport default MapRenderer;\n","/**\n * @module ol/renderer/Composite\n */\nimport {CLASS_UNSELECTABLE} from '../css.js';\nimport {inView} from '../layer/Layer.js';\nimport RenderEvent from '../render/Event.js';\nimport RenderEventType from '../render/EventType.js';\nimport MapRenderer from './Map.js';\nimport SourceState from '../source/State.js';\nimport {replaceChildren} from '../dom.js';\nimport {labelCache} from '../render/canvas.js';\nimport EventType from '../events/EventType.js';\nimport {listen, unlistenByKey} from '../events.js';\n\n\n/**\n * @classdesc\n * Canvas map renderer.\n * @api\n */\nclass CompositeMapRenderer extends MapRenderer {\n\n  /**\n   * @param {import(\"../PluggableMap.js\").default} map Map.\n   */\n  constructor(map) {\n    super(map);\n\n    /**\n     * @type {import(\"../events.js\").EventsKey}\n     */\n    this.labelCacheKey_ = listen(labelCache, EventType.CLEAR, map.redrawText.bind(map));\n\n    /**\n     * @private\n     * @type {HTMLDivElement}\n     */\n    this.element_ = document.createElement('div');\n    const style = this.element_.style;\n    style.position = 'absolute';\n    style.width = '100%';\n    style.height = '100%';\n    style.zIndex = '0';\n\n    this.element_.className = CLASS_UNSELECTABLE + ' ol-layers';\n\n    const container = map.getViewport();\n    container.insertBefore(this.element_, container.firstChild || null);\n\n    /**\n     * @private\n     * @type {Array<HTMLElement>}\n     */\n    this.children_ = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderedVisible_ = true;\n  }\n\n  /**\n   * @param {import(\"../render/EventType.js\").default} type Event type.\n   * @param {import(\"../PluggableMap.js\").FrameState} frameState Frame state.\n   */\n  dispatchRenderEvent(type, frameState) {\n    const map = this.getMap();\n    if (map.hasListener(type)) {\n      const event = new RenderEvent(type, undefined, frameState);\n      map.dispatchEvent(event);\n    }\n  }\n\n  disposeInternal() {\n    unlistenByKey(this.labelCacheKey_);\n    super.disposeInternal();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  renderFrame(frameState) {\n    if (!frameState) {\n      if (this.renderedVisible_) {\n        this.element_.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n      return;\n    }\n\n    this.calculateMatrices2D(frameState);\n    this.dispatchRenderEvent(RenderEventType.PRECOMPOSE, frameState);\n\n    const layerStatesArray = frameState.layerStatesArray.sort(function(a, b) {\n      return a.zIndex - b.zIndex;\n    });\n    const viewState = frameState.viewState;\n\n    this.children_.length = 0;\n    let hasOverlay = false;\n    let previousElement = null;\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const layerState = layerStatesArray[i];\n      hasOverlay = hasOverlay || layerState.hasOverlay;\n      frameState.layerIndex = i;\n      if (!inView(layerState, viewState) ||\n        (layerState.sourceState != SourceState.READY && layerState.sourceState != SourceState.UNDEFINED)) {\n        continue;\n      }\n\n      const layer = layerState.layer;\n      const element = layer.render(frameState, previousElement);\n      if (!element) {\n        continue;\n      }\n      const childElementCount = element.childElementCount;\n      if ((element !== previousElement || i == ii - 1) && childElementCount === 2 && !hasOverlay) {\n        element.removeChild(element.lastElementChild);\n      }\n      if (element !== previousElement) {\n        this.children_.push(element);\n        hasOverlay = childElementCount === 2;\n        previousElement = element;\n      }\n    }\n    super.renderFrame(frameState);\n\n    replaceChildren(this.element_, this.children_);\n\n    this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE, frameState);\n\n    if (!this.renderedVisible_) {\n      this.element_.style.display = '';\n      this.renderedVisible_ = true;\n    }\n\n    this.scheduleExpireIconCache(frameState);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  forEachLayerAtPixel(pixel, frameState, hitTolerance, callback, layerFilter) {\n    const viewState = frameState.viewState;\n\n    const layerStates = frameState.layerStatesArray;\n    const numLayers = layerStates.length;\n\n    for (let i = numLayers - 1; i >= 0; --i) {\n      const layerState = layerStates[i];\n      const layer = layerState.layer;\n      if (layer.hasRenderer() && inView(layerState, viewState) && layerFilter(layer)) {\n        const layerRenderer = layer.getRenderer();\n        const data = layerRenderer.getDataAtPixel(pixel, frameState, hitTolerance);\n        if (data) {\n          const result = callback(layer, data);\n          if (result) {\n            return result;\n          }\n        }\n      }\n    }\n    return undefined;\n  }\n\n}\n\n\nexport default CompositeMapRenderer;\n","/**\n * @module ol/source/TileEventType\n */\n\n/**\n * @enum {string}\n */\nexport default {\n\n  /**\n   * Triggered when a tile starts loading.\n   * @event module:ol/source/Tile.TileSourceEvent#tileloadstart\n   * @api\n   */\n  TILELOADSTART: 'tileloadstart',\n\n  /**\n   * Triggered when a tile finishes loading, either when its data is loaded,\n   * or when loading was aborted because the tile is no longer needed.\n   * @event module:ol/source/Tile.TileSourceEvent#tileloadend\n   * @api\n   */\n  TILELOADEND: 'tileloadend',\n\n  /**\n   * Triggered if tile loading results in an error.\n   * @event module:ol/source/Tile.TileSourceEvent#tileloaderror\n   * @api\n   */\n  TILELOADERROR: 'tileloaderror'\n\n};\n","/**\n * @module ol/source/UrlTile\n */\nimport {getUid} from '../util.js';\nimport TileState from '../TileState.js';\nimport {expandUrl, createFromTemplates, nullTileUrlFunction} from '../tileurlfunction.js';\nimport TileSource, {TileSourceEvent} from './Tile.js';\nimport TileEventType from './TileEventType.js';\nimport {getKeyZXY} from '../tilecoord.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions]\n * @property {boolean} [attributionsCollapsible=true] Attributions are collapsible.\n * @property {number} [cacheSize]\n * @property {boolean} [opaque]\n * @property {import(\"../proj.js\").ProjectionLike} [projection]\n * @property {import(\"./State.js\").default} [state]\n * @property {import(\"../tilegrid/TileGrid.js\").default} [tileGrid]\n * @property {import(\"../Tile.js\").LoadFunction} tileLoadFunction\n * @property {number} [tilePixelRatio]\n * @property {import(\"../Tile.js\").UrlFunction} [tileUrlFunction]\n * @property {string} [url]\n * @property {Array<string>} [urls]\n * @property {boolean} [wrapX=true]\n * @property {number} [transition]\n * @property {string} [key]\n * @property {number} [zDirection=0]\n */\n\n\n/**\n * @classdesc\n * Base class for sources providing tiles divided into a tile grid over http.\n *\n * @fires import(\"./Tile.js\").TileSourceEvent\n */\nclass UrlTile extends TileSource {\n  /**\n   * @param {Options} options Image tile options.\n   */\n  constructor(options) {\n\n    super({\n      attributions: options.attributions,\n      cacheSize: options.cacheSize,\n      opaque: options.opaque,\n      projection: options.projection,\n      state: options.state,\n      tileGrid: options.tileGrid,\n      tilePixelRatio: options.tilePixelRatio,\n      wrapX: options.wrapX,\n      transition: options.transition,\n      key: options.key,\n      attributionsCollapsible: options.attributionsCollapsible,\n      zDirection: options.zDirection\n    });\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.generateTileUrlFunction_ = !options.tileUrlFunction;\n\n    /**\n     * @protected\n     * @type {import(\"../Tile.js\").LoadFunction}\n     */\n    this.tileLoadFunction = options.tileLoadFunction;\n\n    /**\n     * @protected\n     * @type {import(\"../Tile.js\").UrlFunction}\n     */\n    this.tileUrlFunction = options.tileUrlFunction ? options.tileUrlFunction.bind(this) : nullTileUrlFunction;\n\n    /**\n     * @protected\n     * @type {!Array<string>|null}\n     */\n    this.urls = null;\n\n    if (options.urls) {\n      this.setUrls(options.urls);\n    } else if (options.url) {\n      this.setUrl(options.url);\n    }\n\n    /**\n     * @private\n     * @type {!Object<string, boolean>}\n     */\n    this.tileLoadingKeys_ = {};\n\n  }\n\n  /**\n   * Return the tile load function of the source.\n   * @return {import(\"../Tile.js\").LoadFunction} TileLoadFunction\n   * @api\n   */\n  getTileLoadFunction() {\n    return this.tileLoadFunction;\n  }\n\n  /**\n   * Return the tile URL function of the source.\n   * @return {import(\"../Tile.js\").UrlFunction} TileUrlFunction\n   * @api\n   */\n  getTileUrlFunction() {\n    return this.tileUrlFunction;\n  }\n\n  /**\n   * Return the URLs used for this source.\n   * When a tileUrlFunction is used instead of url or urls,\n   * null will be returned.\n   * @return {!Array<string>|null} URLs.\n   * @api\n   */\n  getUrls() {\n    return this.urls;\n  }\n\n  /**\n   * Handle tile change events.\n   * @param {import(\"../events/Event.js\").default} event Event.\n   * @protected\n   */\n  handleTileChange(event) {\n    const tile = /** @type {import(\"../Tile.js\").default} */ (event.target);\n    const uid = getUid(tile);\n    const tileState = tile.getState();\n    let type;\n    if (tileState == TileState.LOADING) {\n      this.tileLoadingKeys_[uid] = true;\n      type = TileEventType.TILELOADSTART;\n    } else if (uid in this.tileLoadingKeys_) {\n      delete this.tileLoadingKeys_[uid];\n      type = tileState == TileState.ERROR ? TileEventType.TILELOADERROR :\n        (tileState == TileState.LOADED || tileState == TileState.ABORT) ?\n          TileEventType.TILELOADEND : undefined;\n    }\n    if (type != undefined) {\n      this.dispatchEvent(new TileSourceEvent(type, tile));\n    }\n  }\n\n  /**\n   * Set the tile load function of the source.\n   * @param {import(\"../Tile.js\").LoadFunction} tileLoadFunction Tile load function.\n   * @api\n   */\n  setTileLoadFunction(tileLoadFunction) {\n    this.tileCache.clear();\n    this.tileLoadFunction = tileLoadFunction;\n    this.changed();\n  }\n\n  /**\n   * Set the tile URL function of the source.\n   * @param {import(\"../Tile.js\").UrlFunction} tileUrlFunction Tile URL function.\n   * @param {string=} key Optional new tile key for the source.\n   * @api\n   */\n  setTileUrlFunction(tileUrlFunction, key) {\n    this.tileUrlFunction = tileUrlFunction;\n    this.tileCache.pruneExceptNewestZ();\n    if (typeof key !== 'undefined') {\n      this.setKey(key);\n    } else {\n      this.changed();\n    }\n  }\n\n  /**\n   * Set the URL to use for requests.\n   * @param {string} url URL.\n   * @api\n   */\n  setUrl(url) {\n    const urls = this.urls = expandUrl(url);\n    this.setUrls(urls);\n  }\n\n  /**\n   * Set the URLs to use for requests.\n   * @param {Array<string>} urls URLs.\n   * @api\n   */\n  setUrls(urls) {\n    this.urls = urls;\n    const key = urls.join('\\n');\n    if (this.generateTileUrlFunction_) {\n      this.setTileUrlFunction(createFromTemplates(urls, this.tileGrid), key);\n    } else {\n      this.setKey(key);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  useTile(z, x, y) {\n    const tileCoordKey = getKeyZXY(z, x, y);\n    if (this.tileCache.containsKey(tileCoordKey)) {\n      this.tileCache.get(tileCoordKey);\n    }\n  }\n}\n\n\nexport default UrlTile;\n","/**\n * @module ol/layer/Group\n */\nimport {getUid} from '../util.js';\nimport Collection from '../Collection.js';\nimport CollectionEventType from '../CollectionEventType.js';\nimport {getChangeEventType} from '../Object.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport {assert} from '../asserts.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport EventType from '../events/EventType.js';\nimport {getIntersection} from '../extent.js';\nimport BaseLayer from './Base.js';\nimport {assign, clear} from '../obj.js';\nimport SourceState from '../source/State.js';\n\n\n/**\n * @typedef {Object} Options\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {number} [minZoom] The minimum view zoom level (exclusive) above which this layer will be\n * visible.\n * @property {number} [maxZoom] The maximum view zoom level (inclusive) at which this layer will\n * be visible.\n * @property {Array<import(\"./Base.js\").default>|import(\"../Collection.js\").default<import(\"./Base.js\").default>} [layers] Child layers.\n */\n\n\n/**\n * @enum {string}\n * @private\n */\nconst Property = {\n  LAYERS: 'layers'\n};\n\n\n/**\n * @classdesc\n * A {@link module:ol/Collection~Collection} of layers that are handled together.\n *\n * A generic `change` event is triggered when the group/Collection changes.\n *\n * @api\n */\nclass LayerGroup extends BaseLayer {\n  /**\n   * @param {Options=} opt_options Layer options.\n   */\n  constructor(opt_options) {\n\n    const options = opt_options || {};\n    const baseOptions = /** @type {Options} */ (assign({}, options));\n    delete baseOptions.layers;\n\n    let layers = options.layers;\n\n    super(baseOptions);\n\n    /**\n     * @private\n     * @type {Array<import(\"../events.js\").EventsKey>}\n     */\n    this.layersListenerKeys_ = [];\n\n    /**\n     * @private\n     * @type {Object<string, Array<import(\"../events.js\").EventsKey>>}\n     */\n    this.listenerKeys_ = {};\n\n    this.addEventListener(getChangeEventType(Property.LAYERS), this.handleLayersChanged_);\n\n    if (layers) {\n      if (Array.isArray(layers)) {\n        layers = new Collection(layers.slice(), {unique: true});\n      } else {\n        assert(typeof /** @type {?} */ (layers).getArray === 'function',\n          43); // Expected `layers` to be an array or a `Collection`\n      }\n    } else {\n      layers = new Collection(undefined, {unique: true});\n    }\n\n    this.setLayers(layers);\n\n  }\n\n  /**\n   * @private\n   */\n  handleLayerChange_() {\n    this.changed();\n  }\n\n  /**\n   * @private\n   */\n  handleLayersChanged_() {\n    this.layersListenerKeys_.forEach(unlistenByKey);\n    this.layersListenerKeys_.length = 0;\n\n    const layers = this.getLayers();\n    this.layersListenerKeys_.push(\n      listen(layers, CollectionEventType.ADD, this.handleLayersAdd_, this),\n      listen(layers, CollectionEventType.REMOVE, this.handleLayersRemove_, this)\n    );\n\n    for (const id in this.listenerKeys_) {\n      this.listenerKeys_[id].forEach(unlistenByKey);\n    }\n    clear(this.listenerKeys_);\n\n    const layersArray = layers.getArray();\n    for (let i = 0, ii = layersArray.length; i < ii; i++) {\n      const layer = layersArray[i];\n      this.listenerKeys_[getUid(layer)] = [\n        listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n        listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n      ];\n    }\n\n    this.changed();\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent} collectionEvent CollectionEvent.\n   * @private\n   */\n  handleLayersAdd_(collectionEvent) {\n    const layer = /** @type {import(\"./Base.js\").default} */ (collectionEvent.element);\n    this.listenerKeys_[getUid(layer)] = [\n      listen(layer, ObjectEventType.PROPERTYCHANGE, this.handleLayerChange_, this),\n      listen(layer, EventType.CHANGE, this.handleLayerChange_, this)\n    ];\n    this.changed();\n  }\n\n  /**\n   * @param {import(\"../Collection.js\").CollectionEvent} collectionEvent CollectionEvent.\n   * @private\n   */\n  handleLayersRemove_(collectionEvent) {\n    const layer = /** @type {import(\"./Base.js\").default} */ (collectionEvent.element);\n    const key = getUid(layer);\n    this.listenerKeys_[key].forEach(unlistenByKey);\n    delete this.listenerKeys_[key];\n    this.changed();\n  }\n\n  /**\n   * Returns the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n   * in this group.\n   * @return {!import(\"../Collection.js\").default<import(\"./Base.js\").default>} Collection of\n   *   {@link module:ol/layer/Base layers} that are part of this group.\n   * @observable\n   * @api\n   */\n  getLayers() {\n    return (\n      /** @type {!import(\"../Collection.js\").default<import(\"./Base.js\").default>} */ (this.get(Property.LAYERS))\n    );\n  }\n\n  /**\n   * Set the {@link module:ol/Collection collection} of {@link module:ol/layer/Layer~Layer layers}\n   * in this group.\n   * @param {!import(\"../Collection.js\").default<import(\"./Base.js\").default>} layers Collection of\n   *   {@link module:ol/layer/Base layers} that are part of this group.\n   * @observable\n   * @api\n   */\n  setLayers(layers) {\n    this.set(Property.LAYERS, layers);\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getLayersArray(opt_array) {\n    const array = opt_array !== undefined ? opt_array : [];\n    this.getLayers().forEach(function(layer) {\n      layer.getLayersArray(array);\n    });\n    return array;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getLayerStatesArray(opt_states) {\n    const states = opt_states !== undefined ? opt_states : [];\n\n    const pos = states.length;\n\n    this.getLayers().forEach(function(layer) {\n      layer.getLayerStatesArray(states);\n    });\n\n    const ownLayerState = this.getLayerState();\n    for (let i = pos, ii = states.length; i < ii; i++) {\n      const layerState = states[i];\n      layerState.opacity *= ownLayerState.opacity;\n      layerState.visible = layerState.visible && ownLayerState.visible;\n      layerState.maxResolution = Math.min(\n        layerState.maxResolution, ownLayerState.maxResolution);\n      layerState.minResolution = Math.max(\n        layerState.minResolution, ownLayerState.minResolution);\n      layerState.minZoom = Math.max(\n        layerState.minZoom, ownLayerState.minZoom);\n      layerState.maxZoom = Math.min(\n        layerState.maxZoom, ownLayerState.maxZoom);\n      if (ownLayerState.extent !== undefined) {\n        if (layerState.extent !== undefined) {\n          layerState.extent = getIntersection(layerState.extent, ownLayerState.extent);\n        } else {\n          layerState.extent = ownLayerState.extent;\n        }\n      }\n    }\n\n    return states;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  getSourceState() {\n    return SourceState.READY;\n  }\n}\n\n\nexport default LayerGroup;\n","/**\n * @module ol/format/GPX\n */\nimport Feature from '../Feature.js';\nimport {includes} from '../array.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport XMLFeature from './XMLFeature.js';\nimport {readString, readDecimal, readNonNegativeInteger, readDateTime, writeStringTextNode, writeNonNegativeIntegerTextNode, writeDecimalTextNode, writeDateTimeTextNode} from './xsd.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport LineString from '../geom/LineString.js';\nimport MultiLineString from '../geom/MultiLineString.js';\nimport Point from '../geom/Point.js';\nimport {get as getProjection} from '../proj.js';\nimport {createElementNS, makeArrayPusher, makeArraySerializer, makeChildAppender,\n  makeObjectPropertySetter, makeSequence, makeSimpleNodeFactory, makeStructureNS,\n  OBJECT_PROPERTY_NODE_FACTORY, parseNode, pushParseAndPop, pushSerializeAndPop,\n  XML_SCHEMA_INSTANCE_URI} from '../xml.js';\n\n\n/**\n * @const\n * @type {Array<null|string>}\n */\nconst NAMESPACE_URIS = [\n  null,\n  'http://www.topografix.com/GPX/1/0',\n  'http://www.topografix.com/GPX/1/1'\n];\n\n\n/**\n * @const\n * @type {string}\n */\nconst SCHEMA_LOCATION = 'http://www.topografix.com/GPX/1/1 ' +\n    'http://www.topografix.com/GPX/1/1/gpx.xsd';\n\n\n/**\n * @const\n * @type {Object<string, function(Node, Array<*>): (Feature|undefined)>}\n */\nconst FEATURE_READER = {\n  'rte': readRte,\n  'trk': readTrk,\n  'wpt': readWpt\n};\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst GPX_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'rte': makeArrayPusher(readRte),\n    'trk': makeArrayPusher(readTrk),\n    'wpt': makeArrayPusher(readWpt)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst LINK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'text': makeObjectPropertySetter(readString, 'linkText'),\n    'type': makeObjectPropertySetter(readString, 'linkType')\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst GPX_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'rte': makeChildAppender(writeRte),\n    'trk': makeChildAppender(writeTrk),\n    'wpt': makeChildAppender(writeWpt)\n  });\n\n\n/**\n * @typedef {Object} Options\n * @property {function(Feature, Node)} [readExtensions] Callback function\n * to process `extensions` nodes. To prevent memory leaks, this callback function must\n * not store any references to the node. Note that the `extensions`\n * node is not allowed in GPX 1.0. Moreover, only `extensions`\n * nodes from `wpt`, `rte` and `trk` can be processed, as those are\n * directly mapped to a feature.\n */\n\n/**\n * @typedef {Object} LayoutOptions\n * @property {boolean} [hasZ]\n * @property {boolean} [hasM]\n */\n\n/**\n * @classdesc\n * Feature format for reading and writing data in the GPX format.\n *\n * Note that {@link module:ol/format/GPX~GPX#readFeature} only reads the first\n * feature of the source.\n *\n * When reading, routes (`<rte>`) are converted into LineString geometries, and\n * tracks (`<trk>`) into MultiLineString. Any properties on route and track\n * waypoints are ignored.\n *\n * When writing, LineString geometries are output as routes (`<rte>`), and\n * MultiLineString as tracks (`<trk>`).\n *\n * @api\n */\nclass GPX extends XMLFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n\n    /**\n     * @inheritDoc\n     */\n    this.dataProjection = getProjection('EPSG:4326');\n\n    /**\n     * @type {function(Feature, Node): void|undefined}\n     * @private\n     */\n    this.readExtensions_ = options.readExtensions;\n  }\n\n  /**\n   * @param {Array<Feature>} features List of features.\n   * @private\n   */\n  handleReadExtensions_(features) {\n    if (!features) {\n      features = [];\n    }\n    for (let i = 0, ii = features.length; i < ii; ++i) {\n      const feature = features[i];\n      if (this.readExtensions_) {\n        const extensionsNode = feature.get('extensionsNode_') || null;\n        this.readExtensions_(feature, extensionsNode);\n      }\n      feature.set('extensionsNode_', undefined);\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromNode(node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return null;\n    }\n    const featureReader = FEATURE_READER[node.localName];\n    if (!featureReader) {\n      return null;\n    }\n    const feature = featureReader(node, [this.getReadOptions(node, opt_options)]);\n    if (!feature) {\n      return null;\n    }\n    this.handleReadExtensions_([feature]);\n    return feature;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromNode(node, opt_options) {\n    if (!includes(NAMESPACE_URIS, node.namespaceURI)) {\n      return [];\n    }\n    if (node.localName == 'gpx') {\n      /** @type {Array<Feature>} */\n      const features = pushParseAndPop([], GPX_PARSERS,\n        node, [this.getReadOptions(node, opt_options)]);\n      if (features) {\n        this.handleReadExtensions_(features);\n        return features;\n      } else {\n        return [];\n      }\n    }\n    return [];\n  }\n\n  /**\n   * Encode an array of features in the GPX format as an XML node.\n   * LineString geometries are output as routes (`<rte>`), and MultiLineString\n   * as tracks (`<trk>`).\n   *\n   * @param {Array<Feature>} features Features.\n   * @param {import(\"./Feature.js\").WriteOptions=} opt_options Options.\n   * @return {Node} Node.\n   * @override\n   * @api\n   */\n  writeFeaturesNode(features, opt_options) {\n    opt_options = this.adaptOptions(opt_options);\n    //FIXME Serialize metadata\n    const gpx = createElementNS('http://www.topografix.com/GPX/1/1', 'gpx');\n    const xmlnsUri = 'http://www.w3.org/2000/xmlns/';\n    gpx.setAttributeNS(xmlnsUri, 'xmlns:xsi', XML_SCHEMA_INSTANCE_URI);\n    gpx.setAttributeNS(XML_SCHEMA_INSTANCE_URI, 'xsi:schemaLocation', SCHEMA_LOCATION);\n    gpx.setAttribute('version', '1.1');\n    gpx.setAttribute('creator', 'OpenLayers');\n\n    pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */\n      ({node: gpx}), GPX_SERIALIZERS, GPX_NODE_FACTORY, features, [opt_options]);\n    return gpx;\n  }\n}\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst RTE_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeObjectPropertySetter(readString),\n    'cmt': makeObjectPropertySetter(readString),\n    'desc': makeObjectPropertySetter(readString),\n    'src': makeObjectPropertySetter(readString),\n    'link': parseLink,\n    'number': makeObjectPropertySetter(readNonNegativeInteger),\n    'extensions': parseExtensions,\n    'type': makeObjectPropertySetter(readString),\n    'rtept': parseRtePt\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst RTEPT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeObjectPropertySetter(readDecimal),\n    'time': makeObjectPropertySetter(readDateTime)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TRK_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeObjectPropertySetter(readString),\n    'cmt': makeObjectPropertySetter(readString),\n    'desc': makeObjectPropertySetter(readString),\n    'src': makeObjectPropertySetter(readString),\n    'link': parseLink,\n    'number': makeObjectPropertySetter(readNonNegativeInteger),\n    'type': makeObjectPropertySetter(readString),\n    'extensions': parseExtensions,\n    'trkseg': parseTrkSeg\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TRKSEG_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'trkpt': parseTrkPt\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst TRKPT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeObjectPropertySetter(readDecimal),\n    'time': makeObjectPropertySetter(readDateTime)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Parser>>}\n */\n// @ts-ignore\nconst WPT_PARSERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeObjectPropertySetter(readDecimal),\n    'time': makeObjectPropertySetter(readDateTime),\n    'magvar': makeObjectPropertySetter(readDecimal),\n    'geoidheight': makeObjectPropertySetter(readDecimal),\n    'name': makeObjectPropertySetter(readString),\n    'cmt': makeObjectPropertySetter(readString),\n    'desc': makeObjectPropertySetter(readString),\n    'src': makeObjectPropertySetter(readString),\n    'link': parseLink,\n    'sym': makeObjectPropertySetter(readString),\n    'type': makeObjectPropertySetter(readString),\n    'fix': makeObjectPropertySetter(readString),\n    'sat': makeObjectPropertySetter(readNonNegativeInteger),\n    'hdop': makeObjectPropertySetter(readDecimal),\n    'vdop': makeObjectPropertySetter(readDecimal),\n    'pdop': makeObjectPropertySetter(readDecimal),\n    'ageofdgpsdata': makeObjectPropertySetter(readDecimal),\n    'dgpsid': makeObjectPropertySetter(readNonNegativeInteger),\n    'extensions': parseExtensions\n  });\n\n\n/**\n * @const\n * @type {Array<string>}\n */\nconst LINK_SEQUENCE = ['text', 'type'];\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst LINK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'text': makeChildAppender(writeStringTextNode),\n    'type': makeChildAppender(writeStringTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst RTE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'cmt', 'desc', 'src', 'link', 'number', 'type', 'rtept'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst RTE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeChildAppender(writeStringTextNode),\n    'cmt': makeChildAppender(writeStringTextNode),\n    'desc': makeChildAppender(writeStringTextNode),\n    'src': makeChildAppender(writeStringTextNode),\n    'link': makeChildAppender(writeLink),\n    'number': makeChildAppender(writeNonNegativeIntegerTextNode),\n    'type': makeChildAppender(writeStringTextNode),\n    'rtept': makeArraySerializer(makeChildAppender(writeWptType))\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst RTEPT_TYPE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'ele', 'time'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst TRK_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'name', 'cmt', 'desc', 'src', 'link', 'number', 'type', 'trkseg'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst TRK_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'name': makeChildAppender(writeStringTextNode),\n    'cmt': makeChildAppender(writeStringTextNode),\n    'desc': makeChildAppender(writeStringTextNode),\n    'src': makeChildAppender(writeStringTextNode),\n    'link': makeChildAppender(writeLink),\n    'number': makeChildAppender(writeNonNegativeIntegerTextNode),\n    'type': makeChildAppender(writeStringTextNode),\n    'trkseg': makeArraySerializer(makeChildAppender(writeTrkSeg))\n  });\n\n\n/**\n * @const\n * @type {function(*, Array<*>, string=): (Node|undefined)}\n */\nconst TRKSEG_NODE_FACTORY = makeSimpleNodeFactory('trkpt');\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst TRKSEG_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'trkpt': makeChildAppender(writeWptType)\n  });\n\n\n/**\n * @const\n * @type {Object<string, Array<string>>}\n */\n// @ts-ignore\nconst WPT_TYPE_SEQUENCE = makeStructureNS(\n  NAMESPACE_URIS, [\n    'ele', 'time', 'magvar', 'geoidheight', 'name', 'cmt', 'desc', 'src',\n    'link', 'sym', 'type', 'fix', 'sat', 'hdop', 'vdop', 'pdop',\n    'ageofdgpsdata', 'dgpsid'\n  ]);\n\n\n/**\n * @const\n * @type {Object<string, Object<string, import(\"../xml.js\").Serializer>>}\n */\n// @ts-ignore\nconst WPT_TYPE_SERIALIZERS = makeStructureNS(\n  NAMESPACE_URIS, {\n    'ele': makeChildAppender(writeDecimalTextNode),\n    'time': makeChildAppender(writeDateTimeTextNode),\n    'magvar': makeChildAppender(writeDecimalTextNode),\n    'geoidheight': makeChildAppender(writeDecimalTextNode),\n    'name': makeChildAppender(writeStringTextNode),\n    'cmt': makeChildAppender(writeStringTextNode),\n    'desc': makeChildAppender(writeStringTextNode),\n    'src': makeChildAppender(writeStringTextNode),\n    'link': makeChildAppender(writeLink),\n    'sym': makeChildAppender(writeStringTextNode),\n    'type': makeChildAppender(writeStringTextNode),\n    'fix': makeChildAppender(writeStringTextNode),\n    'sat': makeChildAppender(writeNonNegativeIntegerTextNode),\n    'hdop': makeChildAppender(writeDecimalTextNode),\n    'vdop': makeChildAppender(writeDecimalTextNode),\n    'pdop': makeChildAppender(writeDecimalTextNode),\n    'ageofdgpsdata': makeChildAppender(writeDecimalTextNode),\n    'dgpsid': makeChildAppender(writeNonNegativeIntegerTextNode)\n  });\n\n\n/**\n * @const\n * @type {Object<string, string>}\n */\nconst GEOMETRY_TYPE_TO_NODENAME = {\n  'Point': 'wpt',\n  'LineString': 'rte',\n  'MultiLineString': 'trk'\n};\n\n\n/**\n * @param {*} value Value.\n * @param {Array<*>} objectStack Object stack.\n * @param {string=} opt_nodeName Node name.\n * @return {Node|undefined} Node.\n */\nfunction GPX_NODE_FACTORY(value, objectStack, opt_nodeName) {\n  const geometry = /** @type {Feature} */ (value).getGeometry();\n  if (geometry) {\n    const nodeName = GEOMETRY_TYPE_TO_NODENAME[geometry.getType()];\n    if (nodeName) {\n      const parentNode = objectStack[objectStack.length - 1].node;\n      return createElementNS(parentNode.namespaceURI, nodeName);\n    }\n  }\n}\n\n\n/**\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {LayoutOptions} layoutOptions Layout options.\n * @param {Element} node Node.\n * @param {!Object} values Values.\n * @return {Array<number>} Flat coordinates.\n */\nfunction appendCoordinate(flatCoordinates, layoutOptions, node, values) {\n  flatCoordinates.push(\n    parseFloat(node.getAttribute('lon')),\n    parseFloat(node.getAttribute('lat')));\n  if ('ele' in values) {\n    flatCoordinates.push(/** @type {number} */ (values['ele']));\n    delete values['ele'];\n    layoutOptions.hasZ = true;\n  } else {\n    flatCoordinates.push(0);\n  }\n  if ('time' in values) {\n    flatCoordinates.push(/** @type {number} */ (values['time']));\n    delete values['time'];\n    layoutOptions.hasM = true;\n  } else {\n    flatCoordinates.push(0);\n  }\n  return flatCoordinates;\n}\n\n\n/**\n * Choose GeometryLayout based on flags in layoutOptions and adjust flatCoordinates\n * and ends arrays by shrinking them accordingly (removing unused zero entries).\n *\n * @param {LayoutOptions} layoutOptions Layout options.\n * @param {Array<number>} flatCoordinates Flat coordinates.\n * @param {Array<number>=} ends Ends.\n * @return {GeometryLayout} Layout.\n */\nfunction applyLayoutOptions(layoutOptions, flatCoordinates, ends) {\n  let layout = GeometryLayout.XY;\n  let stride = 2;\n  if (layoutOptions.hasZ && layoutOptions.hasM) {\n    layout = GeometryLayout.XYZM;\n    stride = 4;\n  } else if (layoutOptions.hasZ) {\n    layout = GeometryLayout.XYZ;\n    stride = 3;\n  } else if (layoutOptions.hasM) {\n    layout = GeometryLayout.XYM;\n    stride = 3;\n  }\n  if (stride !== 4) {\n    for (let i = 0, ii = flatCoordinates.length / 4; i < ii; i++) {\n      flatCoordinates[i * stride] = flatCoordinates[i * 4];\n      flatCoordinates[i * stride + 1] = flatCoordinates[i * 4 + 1];\n      if (layoutOptions.hasZ) {\n        flatCoordinates[i * stride + 2] = flatCoordinates[i * 4 + 2];\n      }\n      if (layoutOptions.hasM) {\n        flatCoordinates[i * stride + 2] = flatCoordinates[i * 4 + 3];\n      }\n    }\n    flatCoordinates.length = flatCoordinates.length / 4 * stride;\n    if (ends) {\n      for (let i = 0, ii = ends.length; i < ii; i++) {\n        ends[i] = ends[i] / 4 * stride;\n      }\n    }\n  }\n  return layout;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction parseLink(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  const href = node.getAttribute('href');\n  if (href !== null) {\n    values['link'] = href;\n  }\n  parseNode(LINK_PARSERS, node, objectStack);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction parseExtensions(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  values['extensionsNode_'] = node;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction parseRtePt(node, objectStack) {\n  const values = pushParseAndPop({}, RTEPT_PARSERS, node, objectStack);\n  if (values) {\n    const rteValues = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n    const flatCoordinates = /** @type {Array<number>} */ (rteValues['flatCoordinates']);\n    const layoutOptions = /** @type {LayoutOptions} */ (rteValues['layoutOptions']);\n    appendCoordinate(flatCoordinates, layoutOptions, node, values);\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction parseTrkPt(node, objectStack) {\n  const values = pushParseAndPop({}, TRKPT_PARSERS, node, objectStack);\n  if (values) {\n    const trkValues = /** @type {!Object} */ (objectStack[objectStack.length - 1]);\n    const flatCoordinates = /** @type {Array<number>} */ (trkValues['flatCoordinates']);\n    const layoutOptions = /** @type {LayoutOptions} */ (trkValues['layoutOptions']);\n    appendCoordinate(flatCoordinates, layoutOptions, node, values);\n  }\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction parseTrkSeg(node, objectStack) {\n  const values = /** @type {Object} */ (objectStack[objectStack.length - 1]);\n  parseNode(TRKSEG_PARSERS, node, objectStack);\n  const flatCoordinates = /** @type {Array<number>} */\n      (values['flatCoordinates']);\n  const ends = /** @type {Array<number>} */ (values['ends']);\n  ends.push(flatCoordinates.length);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Feature|undefined} Track.\n */\nfunction readRte(node, objectStack) {\n  const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (objectStack[0]);\n  const values = pushParseAndPop({\n    'flatCoordinates': [],\n    'layoutOptions': {}\n  }, RTE_PARSERS, node, objectStack);\n  if (!values) {\n    return undefined;\n  }\n  const flatCoordinates = /** @type {Array<number>} */\n      (values['flatCoordinates']);\n  delete values['flatCoordinates'];\n  const layoutOptions = /** @type {LayoutOptions} */ (values['layoutOptions']);\n  delete values['layoutOptions'];\n  const layout = applyLayoutOptions(layoutOptions, flatCoordinates);\n  const geometry = new LineString(flatCoordinates, layout);\n  transformGeometryWithOptions(geometry, false, options);\n  const feature = new Feature(geometry);\n  feature.setProperties(values, true);\n  return feature;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Feature|undefined} Track.\n */\nfunction readTrk(node, objectStack) {\n  const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (objectStack[0]);\n  const values = pushParseAndPop({\n    'flatCoordinates': [],\n    'ends': [],\n    'layoutOptions': {}\n  }, TRK_PARSERS, node, objectStack);\n  if (!values) {\n    return undefined;\n  }\n  const flatCoordinates = /** @type {Array<number>} */\n      (values['flatCoordinates']);\n  delete values['flatCoordinates'];\n  const ends = /** @type {Array<number>} */ (values['ends']);\n  delete values['ends'];\n  const layoutOptions = /** @type {LayoutOptions} */ (values['layoutOptions']);\n  delete values['layoutOptions'];\n  const layout = applyLayoutOptions(layoutOptions, flatCoordinates, ends);\n  const geometry = new MultiLineString(flatCoordinates, layout, ends);\n  transformGeometryWithOptions(geometry, false, options);\n  const feature = new Feature(geometry);\n  feature.setProperties(values, true);\n  return feature;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Array<*>} objectStack Object stack.\n * @return {Feature|undefined} Waypoint.\n */\nfunction readWpt(node, objectStack) {\n  const options = /** @type {import(\"./Feature.js\").ReadOptions} */ (objectStack[0]);\n  const values = pushParseAndPop({}, WPT_PARSERS, node, objectStack);\n  if (!values) {\n    return undefined;\n  }\n  const layoutOptions = /** @type {LayoutOptions} */ ({});\n  const coordinates = appendCoordinate([], layoutOptions, node, values);\n  const layout = applyLayoutOptions(layoutOptions, coordinates);\n  const geometry = new Point(coordinates, layout);\n  transformGeometryWithOptions(geometry, false, options);\n  const feature = new Feature(geometry);\n  feature.setProperties(values, true);\n  return feature;\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {string} value Value for the link's `href` attribute.\n * @param {Array<*>} objectStack Node stack.\n */\nfunction writeLink(node, value, objectStack) {\n  node.setAttribute('href', value);\n  const context = objectStack[objectStack.length - 1];\n  const properties = context['properties'];\n  const link = [\n    properties['linkText'],\n    properties['linkType']\n  ];\n  pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */ ({node: node}),\n    LINK_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    link, objectStack, LINK_SEQUENCE);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {import(\"../coordinate.js\").Coordinate} coordinate Coordinate.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeWptType(node, coordinate, objectStack) {\n  const context = objectStack[objectStack.length - 1];\n  const parentNode = context.node;\n  const namespaceURI = parentNode.namespaceURI;\n  const properties = context['properties'];\n  //FIXME Projection handling\n  node.setAttributeNS(null, 'lat', String(coordinate[1]));\n  node.setAttributeNS(null, 'lon', String(coordinate[0]));\n  const geometryLayout = context['geometryLayout'];\n  switch (geometryLayout) {\n    case GeometryLayout.XYZM:\n      if (coordinate[3] !== 0) {\n        properties['time'] = coordinate[3];\n      }\n      // fall through\n    case GeometryLayout.XYZ:\n      if (coordinate[2] !== 0) {\n        properties['ele'] = coordinate[2];\n      }\n      break;\n    case GeometryLayout.XYM:\n      if (coordinate[2] !== 0) {\n        properties['time'] = coordinate[2];\n      }\n      break;\n    default:\n      // pass\n  }\n  const orderedKeys = (node.nodeName == 'rtept') ?\n    RTEPT_TYPE_SEQUENCE[namespaceURI] :\n    WPT_TYPE_SEQUENCE[namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(/** @type {import(\"../xml.js\").NodeStackItem} */\n    ({node: node, 'properties': properties}),\n    WPT_TYPE_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeRte(node, feature, objectStack) {\n  const options = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[0]);\n  const properties = feature.getProperties();\n  const context = {node: node};\n  context['properties'] = properties;\n  const geometry = feature.getGeometry();\n  if (geometry.getType() == GeometryType.LINE_STRING) {\n    const lineString = /** @type {LineString} */ (transformGeometryWithOptions(geometry, true, options));\n    context['geometryLayout'] = lineString.getLayout();\n    properties['rtept'] = lineString.getCoordinates();\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = RTE_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context,\n    RTE_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeTrk(node, feature, objectStack) {\n  const options = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[0]);\n  const properties = feature.getProperties();\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const context = {node: node};\n  context['properties'] = properties;\n  const geometry = feature.getGeometry();\n  if (geometry.getType() == GeometryType.MULTI_LINE_STRING) {\n    const multiLineString = /** @type {MultiLineString} */ (transformGeometryWithOptions(geometry, true, options));\n    properties['trkseg'] = multiLineString.getLineStrings();\n  }\n  const parentNode = objectStack[objectStack.length - 1].node;\n  const orderedKeys = TRK_SEQUENCE[parentNode.namespaceURI];\n  const values = makeSequence(properties, orderedKeys);\n  pushSerializeAndPop(context,\n    TRK_SERIALIZERS, OBJECT_PROPERTY_NODE_FACTORY,\n    values, objectStack, orderedKeys);\n}\n\n\n/**\n * @param {Node} node Node.\n * @param {LineString} lineString LineString.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeTrkSeg(node, lineString, objectStack) {\n  /** @type {import(\"../xml.js\").NodeStackItem} */\n  const context = {node: node};\n  context['geometryLayout'] = lineString.getLayout();\n  context['properties'] = {};\n  pushSerializeAndPop(context,\n    TRKSEG_SERIALIZERS, TRKSEG_NODE_FACTORY,\n    lineString.getCoordinates(), objectStack);\n}\n\n\n/**\n * @param {Element} node Node.\n * @param {Feature} feature Feature.\n * @param {Array<*>} objectStack Object stack.\n */\nfunction writeWpt(node, feature, objectStack) {\n  const options = /** @type {import(\"./Feature.js\").WriteOptions} */ (objectStack[0]);\n  const context = objectStack[objectStack.length - 1];\n  context['properties'] = feature.getProperties();\n  const geometry = feature.getGeometry();\n  if (geometry.getType() == GeometryType.POINT) {\n    const point = /** @type {Point} */ (transformGeometryWithOptions(geometry, true, options));\n    context['geometryLayout'] = point.getLayout();\n    writeWptType(node, point.getCoordinates(), objectStack);\n  }\n}\n\n\nexport default GPX;\n","/**\n * @module ol/format/IGC\n */\nimport Feature from '../Feature.js';\nimport {transformGeometryWithOptions} from './Feature.js';\nimport TextFeature from './TextFeature.js';\nimport GeometryLayout from '../geom/GeometryLayout.js';\nimport LineString from '../geom/LineString.js';\nimport {get as getProjection} from '../proj.js';\n\n/**\n * IGC altitude/z. One of 'barometric', 'gps', 'none'.\n * @enum {string}\n */\nconst IGCZ = {\n  BAROMETRIC: 'barometric',\n  GPS: 'gps',\n  NONE: 'none'\n};\n\n/**\n * @const\n * @type {RegExp}\n */\nconst B_RECORD_RE =\n    /^B(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{5})([NS])(\\d{3})(\\d{5})([EW])([AV])(\\d{5})(\\d{5})/;\n\n\n/**\n * @const\n * @type {RegExp}\n */\nconst H_RECORD_RE = /^H.([A-Z]{3}).*?:(.*)/;\n\n\n/**\n * @const\n * @type {RegExp}\n */\nconst HFDTE_RECORD_RE = /^HFDTE(\\d{2})(\\d{2})(\\d{2})/;\n\n\n/**\n * A regular expression matching the newline characters `\\r\\n`, `\\r` and `\\n`.\n *\n * @const\n * @type {RegExp}\n */\nconst NEWLINE_RE = /\\r\\n|\\r|\\n/;\n\n\n/**\n * @typedef {Object} Options\n * @property {IGCZ|string} [altitudeMode='none'] Altitude mode. Possible\n * values are `'barometric'`, `'gps'`, and `'none'`.\n */\n\n\n/**\n * @classdesc\n * Feature format for `*.igc` flight recording files.\n *\n * As IGC sources contain a single feature,\n * {@link module:ol/format/IGC~IGC#readFeatures} will return the feature in an\n * array\n *\n * @api\n */\nclass IGC extends TextFeature {\n\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    super();\n\n    const options = opt_options ? opt_options : {};\n\n    /**\n     * @inheritDoc\n     */\n    this.dataProjection = getProjection('EPSG:4326');\n\n    /**\n     * @private\n     * @type {IGCZ}\n     */\n    this.altitudeMode_ = options.altitudeMode ? options.altitudeMode : IGCZ.NONE;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeatureFromText(text, opt_options) {\n    const altitudeMode = this.altitudeMode_;\n    const lines = text.split(NEWLINE_RE);\n    /** @type {Object<string, string>} */\n    const properties = {};\n    const flatCoordinates = [];\n    let year = 2000;\n    let month = 0;\n    let day = 1;\n    let lastDateTime = -1;\n    let i, ii;\n    for (i = 0, ii = lines.length; i < ii; ++i) {\n      const line = lines[i];\n      let m;\n      if (line.charAt(0) == 'B') {\n        m = B_RECORD_RE.exec(line);\n        if (m) {\n          const hour = parseInt(m[1], 10);\n          const minute = parseInt(m[2], 10);\n          const second = parseInt(m[3], 10);\n          let y = parseInt(m[4], 10) + parseInt(m[5], 10) / 60000;\n          if (m[6] == 'S') {\n            y = -y;\n          }\n          let x = parseInt(m[7], 10) + parseInt(m[8], 10) / 60000;\n          if (m[9] == 'W') {\n            x = -x;\n          }\n          flatCoordinates.push(x, y);\n          if (altitudeMode != IGCZ.NONE) {\n            let z;\n            if (altitudeMode == IGCZ.GPS) {\n              z = parseInt(m[11], 10);\n            } else if (altitudeMode == IGCZ.BAROMETRIC) {\n              z = parseInt(m[12], 10);\n            } else {\n              z = 0;\n            }\n            flatCoordinates.push(z);\n          }\n          let dateTime = Date.UTC(year, month, day, hour, minute, second);\n          // Detect UTC midnight wrap around.\n          if (dateTime < lastDateTime) {\n            dateTime = Date.UTC(year, month, day + 1, hour, minute, second);\n          }\n          flatCoordinates.push(dateTime / 1000);\n          lastDateTime = dateTime;\n        }\n      } else if (line.charAt(0) == 'H') {\n        m = HFDTE_RECORD_RE.exec(line);\n        if (m) {\n          day = parseInt(m[1], 10);\n          month = parseInt(m[2], 10) - 1;\n          year = 2000 + parseInt(m[3], 10);\n        } else {\n          m = H_RECORD_RE.exec(line);\n          if (m) {\n            properties[m[1]] = m[2].trim();\n          }\n        }\n      }\n    }\n    if (flatCoordinates.length === 0) {\n      return null;\n    }\n    const layout = altitudeMode == IGCZ.NONE ? GeometryLayout.XYM : GeometryLayout.XYZM;\n    const lineString = new LineString(flatCoordinates, layout);\n    const feature = new Feature(transformGeometryWithOptions(lineString, false, opt_options));\n    feature.setProperties(properties, true);\n    return feature;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  readFeaturesFromText(text, opt_options) {\n    const feature = this.readFeatureFromText(text, opt_options);\n    if (feature) {\n      return [feature];\n    } else {\n      return [];\n    }\n  }\n\n}\n\nexport default IGC;\n","/*!\n * PEP v0.5.3 | https://github.com/jquery/PEP\n * Copyright jQuery Foundation and other contributors | http://jquery.org/license\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.PointerEventsPolyfill = factory());\n}(this, function () { 'use strict';\n\n  /**\n   * This is the constructor for new PointerEvents.\n   *\n   * New Pointer Events must be given a type, and an optional dictionary of\n   * initialization properties.\n   *\n   * Due to certain platform requirements, events returned from the constructor\n   * identify as MouseEvents.\n   *\n   * @constructor\n   * @param {String} inType The type of the event to create.\n   * @param {Object} [inDict] An optional dictionary of initial event properties.\n   * @return {Event} A new PointerEvent of type `inType`, initialized with properties from `inDict`.\n   */\n  var MOUSE_PROPS = [\n    'bubbles',\n    'cancelable',\n    'view',\n    'screenX',\n    'screenY',\n    'clientX',\n    'clientY',\n    'ctrlKey',\n    'altKey',\n    'shiftKey',\n    'metaKey',\n    'button',\n    'relatedTarget',\n    'pageX',\n    'pageY'\n  ];\n\n  var MOUSE_DEFAULTS = [\n    false,\n    false,\n    null,\n    0,\n    0,\n    0,\n    0,\n    false,\n    false,\n    false,\n    false,\n    0,\n    null,\n    0,\n    0\n  ];\n\n  function PointerEvent(inType, inDict) {\n    inDict = inDict || Object.create(null);\n\n    var e = document.createEvent('Event');\n    e.initEvent(inType, inDict.bubbles || false, inDict.cancelable || false);\n\n    // define inherited MouseEvent properties\n    // skip bubbles and cancelable since they're set above in initEvent()\n    for (var i = 2, p; i < MOUSE_PROPS.length; i++) {\n      p = MOUSE_PROPS[i];\n      e[p] = inDict[p] || MOUSE_DEFAULTS[i];\n    }\n    e.buttons = inDict.buttons || 0;\n\n    // Spec requires that pointers without pressure specified use 0.5 for down\n    // state and 0 for up state.\n    var pressure = 0;\n\n    if (inDict.pressure !== undefined && e.buttons) {\n      pressure = inDict.pressure;\n    } else {\n      pressure = e.buttons ? 0.5 : 0;\n    }\n\n    // add x/y properties aliased to clientX/Y\n    e.x = e.clientX;\n    e.y = e.clientY;\n\n    // define the properties of the PointerEvent interface\n    e.pointerId = inDict.pointerId || 0;\n    e.width = inDict.width || 1;\n    e.height = inDict.height || 1;\n    e.pressure = pressure;\n    e.tiltX = inDict.tiltX || 0;\n    e.tiltY = inDict.tiltY || 0;\n    e.twist = inDict.twist || 0;\n    e.tangentialPressure = inDict.tangentialPressure || 0;\n    e.pointerType = inDict.pointerType || '';\n    e.hwTimestamp = inDict.hwTimestamp || 0;\n    e.isPrimary = inDict.isPrimary || false;\n    e.detail = 0;\n    return e;\n  }\n\n  /**\n   * This module implements a map of pointer states\n   */\n  var USE_MAP = window.Map && window.Map.prototype.forEach;\n  var PointerMap = USE_MAP ? Map : SparseArrayMap;\n\n  function SparseArrayMap() {\n    this.array = [];\n    this.size = 0;\n  }\n\n  SparseArrayMap.prototype = {\n    set: function(k, v) {\n      if (v === undefined) {\n        return this.delete(k);\n      }\n      if (!this.has(k)) {\n        this.size++;\n      }\n      this.array[k] = v;\n    },\n    has: function(k) {\n      return this.array[k] !== undefined;\n    },\n    delete: function(k) {\n      if (this.has(k)) {\n        delete this.array[k];\n        this.size--;\n      }\n    },\n    get: function(k) {\n      return this.array[k];\n    },\n    clear: function() {\n      this.array.length = 0;\n      this.size = 0;\n    },\n\n    // return value, key, map\n    forEach: function(callback, thisArg) {\n      return this.array.forEach(function(v, k) {\n        callback.call(thisArg, v, k, this);\n      }, this);\n    }\n  };\n\n  var CLONE_PROPS = [\n\n    // MouseEvent\n    'bubbles',\n    'cancelable',\n    'view',\n    'detail',\n    'screenX',\n    'screenY',\n    'clientX',\n    'clientY',\n    'ctrlKey',\n    'altKey',\n    'shiftKey',\n    'metaKey',\n    'button',\n    'relatedTarget',\n\n    // DOM Level 3\n    'buttons',\n\n    // PointerEvent\n    'pointerId',\n    'width',\n    'height',\n    'pressure',\n    'tiltX',\n    'tiltY',\n    'pointerType',\n    'hwTimestamp',\n    'isPrimary',\n\n    // event instance\n    'type',\n    'target',\n    'currentTarget',\n    'which',\n    'pageX',\n    'pageY',\n    'timeStamp'\n  ];\n\n  var CLONE_DEFAULTS = [\n\n    // MouseEvent\n    false,\n    false,\n    null,\n    null,\n    0,\n    0,\n    0,\n    0,\n    false,\n    false,\n    false,\n    false,\n    0,\n    null,\n\n    // DOM Level 3\n    0,\n\n    // PointerEvent\n    0,\n    0,\n    0,\n    0,\n    0,\n    0,\n    '',\n    0,\n    false,\n\n    // event instance\n    '',\n    null,\n    null,\n    0,\n    0,\n    0,\n    0\n  ];\n\n  var BOUNDARY_EVENTS = {\n    'pointerover': 1,\n    'pointerout': 1,\n    'pointerenter': 1,\n    'pointerleave': 1\n  };\n\n  var HAS_SVG_INSTANCE = (typeof SVGElementInstance !== 'undefined');\n\n  /**\n   * This module is for normalizing events. Mouse and Touch events will be\n   * collected here, and fire PointerEvents that have the same semantics, no\n   * matter the source.\n   * Events fired:\n   *   - pointerdown: a pointing is added\n   *   - pointerup: a pointer is removed\n   *   - pointermove: a pointer is moved\n   *   - pointerover: a pointer crosses into an element\n   *   - pointerout: a pointer leaves an element\n   *   - pointercancel: a pointer will no longer generate events\n   */\n  var dispatcher = {\n    pointermap: new PointerMap(),\n    eventMap: Object.create(null),\n    captureInfo: Object.create(null),\n\n    // Scope objects for native events.\n    // This exists for ease of testing.\n    eventSources: Object.create(null),\n    eventSourceList: [],\n    /**\n     * Add a new event source that will generate pointer events.\n     *\n     * `inSource` must contain an array of event names named `events`, and\n     * functions with the names specified in the `events` array.\n     * @param {string} name A name for the event source\n     * @param {Object} source A new source of platform events.\n     */\n    registerSource: function(name, source) {\n      var s = source;\n      var newEvents = s.events;\n      if (newEvents) {\n        newEvents.forEach(function(e) {\n          if (s[e]) {\n            this.eventMap[e] = s[e].bind(s);\n          }\n        }, this);\n        this.eventSources[name] = s;\n        this.eventSourceList.push(s);\n      }\n    },\n    register: function(element) {\n      var l = this.eventSourceList.length;\n      for (var i = 0, es; (i < l) && (es = this.eventSourceList[i]); i++) {\n\n        // call eventsource register\n        es.register.call(es, element);\n      }\n    },\n    unregister: function(element) {\n      var l = this.eventSourceList.length;\n      for (var i = 0, es; (i < l) && (es = this.eventSourceList[i]); i++) {\n\n        // call eventsource register\n        es.unregister.call(es, element);\n      }\n    },\n    contains: /*scope.external.contains || */function(container, contained) {\n      try {\n        return container.contains(contained);\n      } catch (ex) {\n\n        // most likely: https://bugzilla.mozilla.org/show_bug.cgi?id=208427\n        return false;\n      }\n    },\n\n    // EVENTS\n    down: function(inEvent) {\n      inEvent.bubbles = true;\n      this.fireEvent('pointerdown', inEvent);\n    },\n    move: function(inEvent) {\n      inEvent.bubbles = true;\n      this.fireEvent('pointermove', inEvent);\n    },\n    up: function(inEvent) {\n      inEvent.bubbles = true;\n      this.fireEvent('pointerup', inEvent);\n    },\n    enter: function(inEvent) {\n      inEvent.bubbles = false;\n      this.fireEvent('pointerenter', inEvent);\n    },\n    leave: function(inEvent) {\n      inEvent.bubbles = false;\n      this.fireEvent('pointerleave', inEvent);\n    },\n    over: function(inEvent) {\n      inEvent.bubbles = true;\n      this.fireEvent('pointerover', inEvent);\n    },\n    out: function(inEvent) {\n      inEvent.bubbles = true;\n      this.fireEvent('pointerout', inEvent);\n    },\n    cancel: function(inEvent) {\n      inEvent.bubbles = true;\n      this.fireEvent('pointercancel', inEvent);\n    },\n    leaveOut: function(event) {\n      this.out(event);\n      this.propagate(event, this.leave, false);\n    },\n    enterOver: function(event) {\n      this.over(event);\n      this.propagate(event, this.enter, true);\n    },\n\n    // LISTENER LOGIC\n    eventHandler: function(inEvent) {\n\n      // This is used to prevent multiple dispatch of pointerevents from\n      // platform events. This can happen when two elements in different scopes\n      // are set up to create pointer events, which is relevant to Shadow DOM.\n      if (inEvent._handledByPE) {\n        return;\n      }\n      var type = inEvent.type;\n      var fn = this.eventMap && this.eventMap[type];\n      if (fn) {\n        fn(inEvent);\n      }\n      inEvent._handledByPE = true;\n    },\n\n    // set up event listeners\n    listen: function(target, events) {\n      events.forEach(function(e) {\n        this.addEvent(target, e);\n      }, this);\n    },\n\n    // remove event listeners\n    unlisten: function(target, events) {\n      events.forEach(function(e) {\n        this.removeEvent(target, e);\n      }, this);\n    },\n    addEvent: /*scope.external.addEvent || */function(target, eventName) {\n      target.addEventListener(eventName, this.boundHandler);\n    },\n    removeEvent: /*scope.external.removeEvent || */function(target, eventName) {\n      target.removeEventListener(eventName, this.boundHandler);\n    },\n\n    // EVENT CREATION AND TRACKING\n    /**\n     * Creates a new Event of type `inType`, based on the information in\n     * `inEvent`.\n     *\n     * @param {string} inType A string representing the type of event to create\n     * @param {Event} inEvent A platform event with a target\n     * @return {Event} A PointerEvent of type `inType`\n     */\n    makeEvent: function(inType, inEvent) {\n\n      // relatedTarget must be null if pointer is captured\n      if (this.captureInfo[inEvent.pointerId]) {\n        inEvent.relatedTarget = null;\n      }\n      var e = new PointerEvent(inType, inEvent);\n      if (inEvent.preventDefault) {\n        e.preventDefault = inEvent.preventDefault;\n      }\n      e._target = e._target || inEvent.target;\n      return e;\n    },\n\n    // make and dispatch an event in one call\n    fireEvent: function(inType, inEvent) {\n      var e = this.makeEvent(inType, inEvent);\n      return this.dispatchEvent(e);\n    },\n    /**\n     * Returns a snapshot of inEvent, with writable properties.\n     *\n     * @param {Event} inEvent An event that contains properties to copy.\n     * @return {Object} An object containing shallow copies of `inEvent`'s\n     *    properties.\n     */\n    cloneEvent: function(inEvent) {\n      var eventCopy = Object.create(null);\n      var p;\n      for (var i = 0; i < CLONE_PROPS.length; i++) {\n        p = CLONE_PROPS[i];\n        eventCopy[p] = inEvent[p] || CLONE_DEFAULTS[i];\n\n        // Work around SVGInstanceElement shadow tree\n        // Return the <use> element that is represented by the instance for Safari, Chrome, IE.\n        // This is the behavior implemented by Firefox.\n        if (HAS_SVG_INSTANCE && (p === 'target' || p === 'relatedTarget')) {\n          if (eventCopy[p] instanceof SVGElementInstance) {\n            eventCopy[p] = eventCopy[p].correspondingUseElement;\n          }\n        }\n      }\n\n      // keep the semantics of preventDefault\n      if (inEvent.preventDefault) {\n        eventCopy.preventDefault = function() {\n          inEvent.preventDefault();\n        };\n      }\n      return eventCopy;\n    },\n    getTarget: function(inEvent) {\n      var capture = this.captureInfo[inEvent.pointerId];\n      if (!capture) {\n        return inEvent._target;\n      }\n      if (inEvent._target === capture || !(inEvent.type in BOUNDARY_EVENTS)) {\n        return capture;\n      }\n    },\n    propagate: function(event, fn, propagateDown) {\n      var target = event.target;\n      var targets = [];\n\n      // Order of conditions due to document.contains() missing in IE.\n      while (target != null && target !== document && !target.contains(event.relatedTarget)) {\n        targets.push(target);\n        target = target.parentNode;\n\n        // Touch: Do not propagate if node is detached.\n        if (!target) {\n          return;\n        }\n      }\n      if (propagateDown) {\n        targets.reverse();\n      }\n      targets.forEach(function(target) {\n        event.target = target;\n        fn.call(this, event);\n      }, this);\n    },\n    setCapture: function(inPointerId, inTarget, skipDispatch) {\n      if (this.captureInfo[inPointerId]) {\n        this.releaseCapture(inPointerId, skipDispatch);\n      }\n\n      this.captureInfo[inPointerId] = inTarget;\n      this.implicitRelease = this.releaseCapture.bind(this, inPointerId, skipDispatch);\n      document.addEventListener('pointerup', this.implicitRelease);\n      document.addEventListener('pointercancel', this.implicitRelease);\n\n      var e = new PointerEvent('gotpointercapture', { bubbles: true });\n      e.pointerId = inPointerId;\n      e._target = inTarget;\n\n      if (!skipDispatch) {\n        this.asyncDispatchEvent(e);\n      }\n    },\n    releaseCapture: function(inPointerId, skipDispatch) {\n      var t = this.captureInfo[inPointerId];\n      if (!t) {\n        return;\n      }\n\n      this.captureInfo[inPointerId] = undefined;\n      document.removeEventListener('pointerup', this.implicitRelease);\n      document.removeEventListener('pointercancel', this.implicitRelease);\n\n      var e = new PointerEvent('lostpointercapture', { bubbles: true });\n      e.pointerId = inPointerId;\n      e._target = t;\n\n      if (!skipDispatch) {\n        this.asyncDispatchEvent(e);\n      }\n    },\n    /**\n     * Dispatches the event to its target.\n     *\n     * @param {Event} inEvent The event to be dispatched.\n     * @return {Boolean} True if an event handler returns true, false otherwise.\n     */\n    dispatchEvent: /*scope.external.dispatchEvent || */function(inEvent) {\n      var t = this.getTarget(inEvent);\n      if (t) {\n        return t.dispatchEvent(inEvent);\n      }\n    },\n    asyncDispatchEvent: function(inEvent) {\n      requestAnimationFrame(this.dispatchEvent.bind(this, inEvent));\n    }\n  };\n  dispatcher.boundHandler = dispatcher.eventHandler.bind(dispatcher);\n\n  var targeting = {\n    shadow: function(inEl) {\n      if (inEl) {\n        return inEl.shadowRoot || inEl.webkitShadowRoot;\n      }\n    },\n    canTarget: function(shadow) {\n      return shadow && Boolean(shadow.elementFromPoint);\n    },\n    targetingShadow: function(inEl) {\n      var s = this.shadow(inEl);\n      if (this.canTarget(s)) {\n        return s;\n      }\n    },\n    olderShadow: function(shadow) {\n      var os = shadow.olderShadowRoot;\n      if (!os) {\n        var se = shadow.querySelector('shadow');\n        if (se) {\n          os = se.olderShadowRoot;\n        }\n      }\n      return os;\n    },\n    allShadows: function(element) {\n      var shadows = [];\n      var s = this.shadow(element);\n      while (s) {\n        shadows.push(s);\n        s = this.olderShadow(s);\n      }\n      return shadows;\n    },\n    searchRoot: function(inRoot, x, y) {\n      if (inRoot) {\n        var t = inRoot.elementFromPoint(x, y);\n        var st, sr;\n\n        // is element a shadow host?\n        sr = this.targetingShadow(t);\n        while (sr) {\n\n          // find the the element inside the shadow root\n          st = sr.elementFromPoint(x, y);\n          if (!st) {\n\n            // check for older shadows\n            sr = this.olderShadow(sr);\n          } else {\n\n            // shadowed element may contain a shadow root\n            var ssr = this.targetingShadow(st);\n            return this.searchRoot(ssr, x, y) || st;\n          }\n        }\n\n        // light dom element is the target\n        return t;\n      }\n    },\n    owner: function(element) {\n      var s = element;\n\n      // walk up until you hit the shadow root or document\n      while (s.parentNode) {\n        s = s.parentNode;\n      }\n\n      // the owner element is expected to be a Document or ShadowRoot\n      if (s.nodeType !== Node.DOCUMENT_NODE && s.nodeType !== Node.DOCUMENT_FRAGMENT_NODE) {\n        s = document;\n      }\n      return s;\n    },\n    findTarget: function(inEvent) {\n      var x = inEvent.clientX;\n      var y = inEvent.clientY;\n\n      // if the listener is in the shadow root, it is much faster to start there\n      var s = this.owner(inEvent.target);\n\n      // if x, y is not in this root, fall back to document search\n      if (!s.elementFromPoint(x, y)) {\n        s = document;\n      }\n      return this.searchRoot(s, x, y);\n    }\n  };\n\n  var forEach = Array.prototype.forEach.call.bind(Array.prototype.forEach);\n  var map = Array.prototype.map.call.bind(Array.prototype.map);\n  var toArray = Array.prototype.slice.call.bind(Array.prototype.slice);\n  var filter = Array.prototype.filter.call.bind(Array.prototype.filter);\n  var MO = window.MutationObserver || window.WebKitMutationObserver;\n  var SELECTOR = '[touch-action]';\n  var OBSERVER_INIT = {\n    subtree: true,\n    childList: true,\n    attributes: true,\n    attributeOldValue: true,\n    attributeFilter: ['touch-action']\n  };\n\n  function Installer(add, remove, changed, binder) {\n    this.addCallback = add.bind(binder);\n    this.removeCallback = remove.bind(binder);\n    this.changedCallback = changed.bind(binder);\n    if (MO) {\n      this.observer = new MO(this.mutationWatcher.bind(this));\n    }\n  }\n\n  Installer.prototype = {\n    watchSubtree: function(target) {\n\n      // Only watch scopes that can target find, as these are top-level.\n      // Otherwise we can see duplicate additions and removals that add noise.\n      //\n      // TODO(dfreedman): For some instances with ShadowDOMPolyfill, we can see\n      // a removal without an insertion when a node is redistributed among\n      // shadows. Since it all ends up correct in the document, watching only\n      // the document will yield the correct mutations to watch.\n      if (this.observer && targeting.canTarget(target)) {\n        this.observer.observe(target, OBSERVER_INIT);\n      }\n    },\n    enableOnSubtree: function(target) {\n      this.watchSubtree(target);\n      if (target === document && document.readyState !== 'complete') {\n        this.installOnLoad();\n      } else {\n        this.installNewSubtree(target);\n      }\n    },\n    installNewSubtree: function(target) {\n      forEach(this.findElements(target), this.addElement, this);\n    },\n    findElements: function(target) {\n      if (target.querySelectorAll) {\n        return target.querySelectorAll(SELECTOR);\n      }\n      return [];\n    },\n    removeElement: function(el) {\n      this.removeCallback(el);\n    },\n    addElement: function(el) {\n      this.addCallback(el);\n    },\n    elementChanged: function(el, oldValue) {\n      this.changedCallback(el, oldValue);\n    },\n    concatLists: function(accum, list) {\n      return accum.concat(toArray(list));\n    },\n\n    // register all touch-action = none nodes on document load\n    installOnLoad: function() {\n      document.addEventListener('readystatechange', function() {\n        if (document.readyState === 'complete') {\n          this.installNewSubtree(document);\n        }\n      }.bind(this));\n    },\n    isElement: function(n) {\n      return n.nodeType === Node.ELEMENT_NODE;\n    },\n    flattenMutationTree: function(inNodes) {\n\n      // find children with touch-action\n      var tree = map(inNodes, this.findElements, this);\n\n      // make sure the added nodes are accounted for\n      tree.push(filter(inNodes, this.isElement));\n\n      // flatten the list\n      return tree.reduce(this.concatLists, []);\n    },\n    mutationWatcher: function(mutations) {\n      mutations.forEach(this.mutationHandler, this);\n    },\n    mutationHandler: function(m) {\n      if (m.type === 'childList') {\n        var added = this.flattenMutationTree(m.addedNodes);\n        added.forEach(this.addElement, this);\n        var removed = this.flattenMutationTree(m.removedNodes);\n        removed.forEach(this.removeElement, this);\n      } else if (m.type === 'attributes') {\n        this.elementChanged(m.target, m.oldValue);\n      }\n    }\n  };\n\n  function shadowSelector(s) {\n    return 'body /shadow-deep/ ' + s;\n  }\n  function rule(v) {\n    return '{ -ms-touch-action: ' + v + '; touch-action: ' + v + '; }';\n  }\n  var attrib2css = [\n    { selector: '[touch-action=\"none\"]', value: 'none' },\n    { selector: '[touch-action=\"auto\"]', value: 'auto' },\n    { selector: '[touch-action~=\"pan-x\"]', value: 'pan-x' },\n    { selector: '[touch-action~=\"pan-y\"]', value: 'pan-y' },\n    { selector: '[touch-action~=\"pan-up\"]', value: 'pan-up' },\n    { selector: '[touch-action~=\"pan-down\"]', value: 'pan-down' },\n    { selector: '[touch-action~=\"pan-left\"]', value: 'pan-left' },\n    { selector: '[touch-action~=\"pan-right\"]', value: 'pan-right' }\n  ];\n  var styles = '';\n\n  // only install stylesheet if the browser has touch action support\n  var hasNativePE = window.PointerEvent || window.MSPointerEvent;\n\n  // only add shadow selectors if shadowdom is supported\n  var hasShadowRoot = !window.ShadowDOMPolyfill && document.head.createShadowRoot;\n\n  function applyAttributeStyles() {\n    if (hasNativePE) {\n      attrib2css.forEach(function(r) {\n        styles += r.selector + rule(r.value) + '\\n';\n        if (hasShadowRoot) {\n          styles += shadowSelector(r.selector) + rule(r.value) + '\\n';\n        }\n      });\n\n      var el = document.createElement('style');\n      el.textContent = styles;\n      document.head.appendChild(el);\n    }\n  }\n\n  var pointermap = dispatcher.pointermap;\n\n  // radius around touchend that swallows mouse events\n  var DEDUP_DIST = 25;\n\n  // left, middle, right, back, forward\n  var BUTTON_TO_BUTTONS = [1, 4, 2, 8, 16];\n\n  var HAS_BUTTONS = false;\n  try {\n    HAS_BUTTONS = new MouseEvent('test', { buttons: 1 }).buttons === 1;\n  } catch (e) {}\n\n  // handler block for native mouse events\n  var mouseEvents = {\n    POINTER_ID: 1,\n    POINTER_TYPE: 'mouse',\n    events: [\n      'mousedown',\n      'webkitmouseforcechanged',\n      'mousemove',\n      'mouseup',\n      'mouseover',\n      'mouseout'\n    ],\n    register: function(target) {\n      dispatcher.listen(target, this.events);\n    },\n    unregister: function(target) {\n      dispatcher.unlisten(target, this.events);\n    },\n    lastTouches: [],\n\n    // collide with the global mouse listener\n    isEventSimulatedFromTouch: function(inEvent) {\n      var lts = this.lastTouches;\n      var x = inEvent.clientX;\n      var y = inEvent.clientY;\n      for (var i = 0, l = lts.length, t; i < l && (t = lts[i]); i++) {\n\n        // simulated mouse events will be swallowed near a primary touchend\n        var dx = Math.abs(x - t.x);\n        var dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DIST && dy <= DEDUP_DIST) {\n          return true;\n        }\n      }\n    },\n    prepareEvent: function(inEvent) {\n      var e = dispatcher.cloneEvent(inEvent);\n\n      // forward mouse preventDefault\n      var pd = e.preventDefault;\n      e.preventDefault = function() {\n        inEvent.preventDefault();\n        pd();\n      };\n      e.pointerId = this.POINTER_ID;\n      e.isPrimary = true;\n      e.pointerType = this.POINTER_TYPE;\n      if ('webkitForce' in inEvent) {\n        e.pressure = inEvent.webkitForce - MouseEvent.WEBKIT_FORCE_AT_MOUSE_DOWN;\n      }\n      return e;\n    },\n    prepareButtonsForMove: function(e, inEvent) {\n      var p = pointermap.get(this.POINTER_ID);\n\n      // Update buttons state after possible out-of-document mouseup.\n      if (inEvent.which === 0 || !p) {\n        e.buttons = 0;\n      } else {\n        e.buttons = p.buttons;\n      }\n      inEvent.buttons = e.buttons;\n    },\n    mousedown: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var p = pointermap.get(this.POINTER_ID);\n        var e = this.prepareEvent(inEvent);\n        if (!HAS_BUTTONS) {\n          e.buttons = BUTTON_TO_BUTTONS[e.button];\n          if (p) { e.buttons |= p.buttons; }\n          inEvent.buttons = e.buttons;\n        }\n        pointermap.set(this.POINTER_ID, inEvent);\n        if (!p || p.buttons === 0) {\n          dispatcher.down(e);\n        } else {\n          dispatcher.move(e);\n        }\n      }\n    },\n\n    // This is called when the user force presses without moving x/y\n    webkitmouseforcechanged: function(inEvent) {\n      this.mousemove(inEvent);\n    },\n    mousemove: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var e = this.prepareEvent(inEvent);\n        if (!HAS_BUTTONS) { this.prepareButtonsForMove(e, inEvent); }\n        e.button = -1;\n        pointermap.set(this.POINTER_ID, inEvent);\n        dispatcher.move(e);\n      }\n    },\n    mouseup: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var p = pointermap.get(this.POINTER_ID);\n        var e = this.prepareEvent(inEvent);\n        if (!HAS_BUTTONS) {\n          var up = BUTTON_TO_BUTTONS[e.button];\n\n          // Produces wrong state of buttons in Browsers without `buttons` support\n          // when a mouse button that was pressed outside the document is released\n          // inside and other buttons are still pressed down.\n          e.buttons = p ? p.buttons & ~up : 0;\n          inEvent.buttons = e.buttons;\n        }\n        pointermap.set(this.POINTER_ID, inEvent);\n\n        // Support: Firefox <=44 only\n        // FF Ubuntu includes the lifted button in the `buttons` property on\n        // mouseup.\n        // https://bugzilla.mozilla.org/show_bug.cgi?id=1223366\n        e.buttons &= ~BUTTON_TO_BUTTONS[e.button];\n        if (e.buttons === 0) {\n          dispatcher.up(e);\n        } else {\n          dispatcher.move(e);\n        }\n      }\n    },\n    mouseover: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var e = this.prepareEvent(inEvent);\n        if (!HAS_BUTTONS) { this.prepareButtonsForMove(e, inEvent); }\n        e.button = -1;\n        pointermap.set(this.POINTER_ID, inEvent);\n        dispatcher.enterOver(e);\n      }\n    },\n    mouseout: function(inEvent) {\n      if (!this.isEventSimulatedFromTouch(inEvent)) {\n        var e = this.prepareEvent(inEvent);\n        if (!HAS_BUTTONS) { this.prepareButtonsForMove(e, inEvent); }\n        e.button = -1;\n        dispatcher.leaveOut(e);\n      }\n    },\n    cancel: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      dispatcher.cancel(e);\n      this.deactivateMouse();\n    },\n    deactivateMouse: function() {\n      pointermap.delete(this.POINTER_ID);\n    }\n  };\n\n  var captureInfo = dispatcher.captureInfo;\n  var findTarget = targeting.findTarget.bind(targeting);\n  var allShadows = targeting.allShadows.bind(targeting);\n  var pointermap$1 = dispatcher.pointermap;\n\n  // this should be long enough to ignore compat mouse events made by touch\n  var DEDUP_TIMEOUT = 2500;\n  var ATTRIB = 'touch-action';\n  var INSTALLER;\n\n  // bitmask for _scrollType\n  var UP = 1;\n  var DOWN = 2;\n  var LEFT = 4;\n  var RIGHT = 8;\n  var AUTO = UP | DOWN | LEFT | RIGHT;\n\n  // handler block for native touch events\n  var touchEvents = {\n    events: [\n      'touchstart',\n      'touchmove',\n      'touchforcechange',\n      'touchend',\n      'touchcancel'\n    ],\n    register: function(target) {\n      INSTALLER.enableOnSubtree(target);\n    },\n    unregister: function() {\n\n      // TODO(dfreedman): is it worth it to disconnect the MO?\n    },\n    elementAdded: function(el) {\n      var a = el.getAttribute(ATTRIB);\n      var st = this.touchActionToScrollType(a);\n      if (typeof st === \"number\") {\n        el._scrollType = st;\n        dispatcher.listen(el, this.events);\n\n        // set touch-action on shadows as well\n        allShadows(el).forEach(function(s) {\n          s._scrollType = st;\n          dispatcher.listen(s, this.events);\n        }, this);\n      }\n    },\n    elementRemoved: function(el) {\n\n      // In some cases, an element is removed before a touchend.\n      // When this is the case, we should wait for the touchend before unlistening,\n      // because we still want pointer events to bubble up after removing from DOM.\n      if (pointermap$1.size > 0) {\n        var evts = this.events;\n        el.addEventListener('touchend', function() {\n          el._scrollType = undefined;\n          dispatcher.unlisten(el, evts);\n        });\n      } else {\n        el._scrollType = undefined;\n        dispatcher.unlisten(el, this.events);\n      }\n\n      // remove touch-action from shadow\n      allShadows(el).forEach(function(s) {\n        s._scrollType = undefined;\n        dispatcher.unlisten(s, this.events);\n      }, this);\n    },\n    elementChanged: function(el, oldValue) {\n      var a = el.getAttribute(ATTRIB);\n      var st = this.touchActionToScrollType(a);\n      var oldSt = this.touchActionToScrollType(oldValue);\n\n      // simply update scrollType if listeners are already established\n      if (typeof st === \"number\" && typeof oldSt === \"number\") {\n        el._scrollType = st;\n        allShadows(el).forEach(function(s) {\n          s._scrollType = st;\n        }, this);\n      } else if (typeof oldSt === \"number\") {\n        this.elementRemoved(el);\n      } else if (typeof st === \"number\") {\n        this.elementAdded(el);\n      }\n    },\n    scrollTypes: {\n      UP: function(s) {\n        return s.includes('pan-y') || s.includes('pan-up') ? UP : 0;\n      },\n      DOWN: function(s) {\n        return s.includes('pan-y') || s.includes('pan-down') ? DOWN : 0;\n      },\n      LEFT: function(s) {\n        return s.includes('pan-x') || s.includes('pan-left') ? LEFT : 0;\n      },\n      RIGHT: function(s) {\n        return s.includes('pan-x') || s.includes('pan-right') ? RIGHT : 0;\n      }\n    },\n    touchActionToScrollType: function(touchAction) {\n      if (!touchAction) {\n        return;\n      }\n\n      if (touchAction === \"auto\") {\n        return AUTO;\n      }\n\n      if (touchAction === \"none\") {\n        return 0;\n      }\n\n      var s = touchAction.split(' ');\n      var st = this.scrollTypes;\n\n      // construct a bitmask of allowed scroll directions\n      return st.UP(s) | st.DOWN(s) | st.LEFT(s) | st.RIGHT(s);\n    },\n    POINTER_TYPE: 'touch',\n    firstTouch: null,\n    isPrimaryTouch: function(inTouch) {\n      return this.firstTouch === inTouch.identifier;\n    },\n    setPrimaryTouch: function(inTouch) {\n\n      // set primary touch if there no pointers, or the only pointer is the mouse\n      if (pointermap$1.size === 0 || (pointermap$1.size === 1 && pointermap$1.has(1))) {\n        this.firstTouch = inTouch.identifier;\n        this.firstXY = { X: inTouch.clientX, Y: inTouch.clientY };\n        this.scrolling = false;\n      }\n    },\n    removePrimaryPointer: function(inPointer) {\n      if (inPointer.isPrimary) {\n        this.firstTouch = null;\n        this.firstXY = null;\n      }\n    },\n    typeToButtons: function(type) {\n      var ret = 0;\n      if (type === 'touchstart' || type === 'touchmove' || type === 'touchforcechange') {\n        ret = 1;\n      }\n      return ret;\n    },\n    touchToPointer: function(inTouch) {\n      var cte = this.currentTouchEvent;\n      var e = dispatcher.cloneEvent(inTouch);\n\n      // We reserve pointerId 1 for Mouse.\n      // Touch identifiers can start at 0.\n      // Add 2 to the touch identifier for compatibility.\n      var id = e.pointerId = inTouch.identifier + 2;\n      e.target = captureInfo[id] || findTarget(e);\n      e.bubbles = true;\n      e.cancelable = true;\n      e.button = 0;\n      e.buttons = this.typeToButtons(cte.type);\n      e.width = (inTouch.radiusX || inTouch.webkitRadiusX || 0) * 2;\n      e.height = (inTouch.radiusY || inTouch.webkitRadiusY || 0) * 2;\n      e.pressure = inTouch.force !== undefined ?\n        inTouch.force :\n        inTouch.webkitForce !== undefined ?\n          inTouch.webkitForce : undefined;\n      e.isPrimary = this.isPrimaryTouch(inTouch);\n      if (inTouch.altitudeAngle) {\n        var tan = Math.tan(inTouch.altitudeAngle);\n        var radToDeg = 180 / Math.PI;\n        e.tiltX = Math.atan(Math.cos(inTouch.azimuthAngle) / tan) * radToDeg;\n        e.tiltY = Math.atan(Math.sin(inTouch.azimuthAngle) / tan) * radToDeg;\n      } else {\n        e.tiltX = 0;\n        e.tiltY = 0;\n      }\n      if (inTouch.touchType === 'stylus') {\n        e.pointerType = 'pen';\n      } else {\n        e.pointerType = this.POINTER_TYPE;\n      }\n\n      // forward modifier keys\n      e.altKey = cte.altKey;\n      e.ctrlKey = cte.ctrlKey;\n      e.metaKey = cte.metaKey;\n      e.shiftKey = cte.shiftKey;\n\n      // forward touch preventDefaults\n      var self = this;\n      e.preventDefault = function() {\n        self.scrolling = false;\n        self.firstXY = null;\n        cte.preventDefault();\n      };\n      return e;\n    },\n    processTouches: function(inEvent, inFunction) {\n      var tl = inEvent.changedTouches;\n      this.currentTouchEvent = inEvent;\n      for (var i = 0, t; i < tl.length; i++) {\n        t = tl[i];\n        inFunction.call(this, this.touchToPointer(t));\n      }\n    },\n\n    // For single axis scrollers, determines whether the element should emit\n    // pointer events or behave as a scroller\n    shouldScroll: function(inEvent) {\n      if (this.firstXY) {\n        var ret;\n        var st = inEvent.currentTarget._scrollType;\n        if (st === 0) {\n\n          // this element is a `touch-action: none`, should never scroll\n          ret = false;\n        } else if (st === AUTO) {\n\n          // this element is a `touch-action: auto`, should always scroll\n          ret = true;\n        } else {\n          var t = inEvent.changedTouches[0];\n\n          var dy = t.clientY - this.firstXY.Y;\n          var dya = Math.abs(dy);\n          var dx = t.clientX - this.firstXY.X;\n          var dxa = Math.abs(dx);\n\n          var up = st & UP;\n          var down = st & DOWN;\n          var left = st & LEFT;\n          var right = st & RIGHT;\n\n          if (left && right) {\n\n            // should scroll on the x axis\n            ret = dxa > dya;\n          } else if (left) {\n\n            // should scroll left\n            ret = dxa > dya && dx > 0;\n          } else if (right) {\n\n            // should scroll right\n            ret = dxa > dya && dx < 0;\n          }\n\n          if (!ret) {\n            if (up && down) {\n\n              // should scroll on the y axis\n              ret = dxa < dya;\n            } else if (up) {\n\n              // should scroll up\n              ret = dxa < dya && dy > 0;\n            } else if (down) {\n\n              // should scroll down\n              ret = dxa < dya && dy < 0;\n            }\n          }\n\n        }\n        this.firstXY = null;\n        return ret;\n      }\n    },\n    findTouch: function(inTL, inId) {\n      for (var i = 0, l = inTL.length, t; i < l && (t = inTL[i]); i++) {\n        if (t.identifier === inId) {\n          return true;\n        }\n      }\n    },\n\n    // In some instances, a touchstart can happen without a touchend. This\n    // leaves the pointermap in a broken state.\n    // Therefore, on every touchstart, we remove the touches that did not fire a\n    // touchend event.\n    // To keep state globally consistent, we fire a\n    // pointercancel for this \"abandoned\" touch\n    vacuumTouches: function(inEvent) {\n      var tl = inEvent.touches;\n\n      // pointermap.size should be < tl.length here, as the touchstart has not\n      // been processed yet.\n      if (pointermap$1.size >= tl.length) {\n        var d = [];\n        pointermap$1.forEach(function(value, key) {\n\n          // Never remove pointerId == 1, which is mouse.\n          // Touch identifiers are 2 smaller than their pointerId, which is the\n          // index in pointermap.\n          if (key !== 1 && !this.findTouch(tl, key - 2)) {\n            var p = value.out;\n            d.push(p);\n          }\n        }, this);\n        d.forEach(this.cancelOut, this);\n      }\n    },\n    touchstart: function(inEvent) {\n      this.vacuumTouches(inEvent);\n      this.setPrimaryTouch(inEvent.changedTouches[0]);\n      this.dedupSynthMouse(inEvent);\n      if (!this.scrolling) {\n        this.processTouches(inEvent, this.overDown);\n      }\n    },\n    overDown: function(inPointer) {\n      pointermap$1.set(inPointer.pointerId, {\n        target: inPointer.target,\n        out: inPointer,\n        outTarget: inPointer.target\n      });\n      dispatcher.enterOver(inPointer);\n      dispatcher.down(inPointer);\n    },\n\n    // Called when pressure or tilt changes without the x/y changing\n    touchforcechange: function(inEvent) {\n      this.touchmove(inEvent);\n    },\n    touchmove: function(inEvent) {\n      if (!this.scrolling) {\n        if (this.shouldScroll(inEvent)) {\n          this.scrolling = true;\n          this.touchcancel(inEvent);\n        } else {\n          if (inEvent.type !== 'touchforcechange') {\n            inEvent.preventDefault();\n          }\n          this.processTouches(inEvent, this.moveOverOut);\n        }\n      }\n    },\n    moveOverOut: function(inPointer) {\n      var event = inPointer;\n      var pointer = pointermap$1.get(event.pointerId);\n\n      // a finger drifted off the screen, ignore it\n      if (!pointer) {\n        return;\n      }\n      var outEvent = pointer.out;\n      var outTarget = pointer.outTarget;\n      dispatcher.move(event);\n      if (outEvent && outTarget !== event.target) {\n        outEvent.relatedTarget = event.target;\n        event.relatedTarget = outTarget;\n\n        // recover from retargeting by shadow\n        outEvent.target = outTarget;\n        if (event.target) {\n          dispatcher.leaveOut(outEvent);\n          dispatcher.enterOver(event);\n        } else {\n\n          // clean up case when finger leaves the screen\n          event.target = outTarget;\n          event.relatedTarget = null;\n          this.cancelOut(event);\n        }\n      }\n      pointer.out = event;\n      pointer.outTarget = event.target;\n    },\n    touchend: function(inEvent) {\n      this.dedupSynthMouse(inEvent);\n      this.processTouches(inEvent, this.upOut);\n    },\n    upOut: function(inPointer) {\n      if (!this.scrolling) {\n        dispatcher.up(inPointer);\n        dispatcher.leaveOut(inPointer);\n      }\n      this.cleanUpPointer(inPointer);\n    },\n    touchcancel: function(inEvent) {\n      this.processTouches(inEvent, this.cancelOut);\n    },\n    cancelOut: function(inPointer) {\n      dispatcher.cancel(inPointer);\n      dispatcher.leaveOut(inPointer);\n      this.cleanUpPointer(inPointer);\n    },\n    cleanUpPointer: function(inPointer) {\n      pointermap$1.delete(inPointer.pointerId);\n      this.removePrimaryPointer(inPointer);\n    },\n\n    // prevent synth mouse events from creating pointer events\n    dedupSynthMouse: function(inEvent) {\n      var lts = mouseEvents.lastTouches;\n      var t = inEvent.changedTouches[0];\n\n      // only the primary finger will synth mouse events\n      if (this.isPrimaryTouch(t)) {\n\n        // remember x/y of last touch\n        var lt = { x: t.clientX, y: t.clientY };\n        lts.push(lt);\n        var fn = (function(lts, lt) {\n          var i = lts.indexOf(lt);\n          if (i > -1) {\n            lts.splice(i, 1);\n          }\n        }).bind(null, lts, lt);\n        setTimeout(fn, DEDUP_TIMEOUT);\n      }\n    }\n  };\n\n  INSTALLER = new Installer(touchEvents.elementAdded, touchEvents.elementRemoved,\n    touchEvents.elementChanged, touchEvents);\n\n  var pointermap$2 = dispatcher.pointermap;\n  var HAS_BITMAP_TYPE = window.MSPointerEvent &&\n    typeof window.MSPointerEvent.MSPOINTER_TYPE_MOUSE === 'number';\n  var msEvents = {\n    events: [\n      'MSPointerDown',\n      'MSPointerMove',\n      'MSPointerUp',\n      'MSPointerOut',\n      'MSPointerOver',\n      'MSPointerCancel',\n      'MSGotPointerCapture',\n      'MSLostPointerCapture'\n    ],\n    register: function(target) {\n      dispatcher.listen(target, this.events);\n    },\n    unregister: function(target) {\n      dispatcher.unlisten(target, this.events);\n    },\n    POINTER_TYPES: [\n      '',\n      'unavailable',\n      'touch',\n      'pen',\n      'mouse'\n    ],\n    prepareEvent: function(inEvent) {\n      var e = inEvent;\n      if (HAS_BITMAP_TYPE) {\n        e = dispatcher.cloneEvent(inEvent);\n        e.pointerType = this.POINTER_TYPES[inEvent.pointerType];\n      }\n      return e;\n    },\n    cleanup: function(id) {\n      pointermap$2.delete(id);\n    },\n    MSPointerDown: function(inEvent) {\n      pointermap$2.set(inEvent.pointerId, inEvent);\n      var e = this.prepareEvent(inEvent);\n      dispatcher.down(e);\n    },\n    MSPointerMove: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      dispatcher.move(e);\n    },\n    MSPointerUp: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      dispatcher.up(e);\n      this.cleanup(inEvent.pointerId);\n    },\n    MSPointerOut: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      dispatcher.leaveOut(e);\n    },\n    MSPointerOver: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      dispatcher.enterOver(e);\n    },\n    MSPointerCancel: function(inEvent) {\n      var e = this.prepareEvent(inEvent);\n      dispatcher.cancel(e);\n      this.cleanup(inEvent.pointerId);\n    },\n    MSLostPointerCapture: function(inEvent) {\n      var e = dispatcher.makeEvent('lostpointercapture', inEvent);\n      dispatcher.dispatchEvent(e);\n    },\n    MSGotPointerCapture: function(inEvent) {\n      var e = dispatcher.makeEvent('gotpointercapture', inEvent);\n      dispatcher.dispatchEvent(e);\n    }\n  };\n\n  function applyPolyfill() {\n\n    // only activate if this platform does not have pointer events\n    if (!window.PointerEvent) {\n      window.PointerEvent = PointerEvent;\n\n      if (window.navigator.msPointerEnabled) {\n        var tp = window.navigator.msMaxTouchPoints;\n        Object.defineProperty(window.navigator, 'maxTouchPoints', {\n          value: tp,\n          enumerable: true\n        });\n        dispatcher.registerSource('ms', msEvents);\n      } else {\n        Object.defineProperty(window.navigator, 'maxTouchPoints', {\n          value: 0,\n          enumerable: true\n        });\n        dispatcher.registerSource('mouse', mouseEvents);\n        if (window.ontouchstart !== undefined) {\n          dispatcher.registerSource('touch', touchEvents);\n        }\n      }\n\n      dispatcher.register(document);\n    }\n  }\n\n  var n = window.navigator;\n  var s;\n  var r;\n  var h;\n  function assertActive(id) {\n    if (!dispatcher.pointermap.has(id)) {\n      var error = new Error('NotFoundError');\n      error.name = 'NotFoundError';\n      throw error;\n    }\n  }\n  function assertConnected(elem) {\n    var parent = elem.parentNode;\n    while (parent && parent !== elem.ownerDocument) {\n      parent = parent.parentNode;\n    }\n    if (!parent) {\n      var error = new Error('InvalidStateError');\n      error.name = 'InvalidStateError';\n      throw error;\n    }\n  }\n  function inActiveButtonState(id) {\n    var p = dispatcher.pointermap.get(id);\n    return p.buttons !== 0;\n  }\n  if (n.msPointerEnabled) {\n    s = function(pointerId) {\n      assertActive(pointerId);\n      assertConnected(this);\n      if (inActiveButtonState(pointerId)) {\n        dispatcher.setCapture(pointerId, this, true);\n        this.msSetPointerCapture(pointerId);\n      }\n    };\n    r = function(pointerId) {\n      assertActive(pointerId);\n      dispatcher.releaseCapture(pointerId, true);\n      this.msReleasePointerCapture(pointerId);\n    };\n  } else {\n    s = function setPointerCapture(pointerId) {\n      assertActive(pointerId);\n      assertConnected(this);\n      if (inActiveButtonState(pointerId)) {\n        dispatcher.setCapture(pointerId, this);\n      }\n    };\n    r = function releasePointerCapture(pointerId) {\n      assertActive(pointerId);\n      dispatcher.releaseCapture(pointerId);\n    };\n  }\n  h = function hasPointerCapture(pointerId) {\n    return !!dispatcher.captureInfo[pointerId];\n  };\n\n  function applyPolyfill$1() {\n    if (window.Element && !Element.prototype.setPointerCapture) {\n      Object.defineProperties(Element.prototype, {\n        'setPointerCapture': {\n          value: s\n        },\n        'releasePointerCapture': {\n          value: r\n        },\n        'hasPointerCapture': {\n          value: h\n        }\n      });\n    }\n  }\n\n  applyAttributeStyles();\n  applyPolyfill();\n  applyPolyfill$1();\n\n  var pointerevents = {\n    dispatcher: dispatcher,\n    Installer: Installer,\n    PointerEvent: PointerEvent,\n    PointerMap: PointerMap,\n    targetFinding: targeting\n  };\n\n  return pointerevents;\n\n}));","/**\n * @module ol/renderer/canvas/VectorImageLayer\n */\nimport ImageCanvas from '../../ImageCanvas.js';\nimport ViewHint from '../../ViewHint.js';\nimport {getHeight, getWidth, isEmpty, scaleFromCenter} from '../../extent.js';\nimport {assign} from '../../obj.js';\nimport CanvasImageLayerRenderer from './ImageLayer.js';\nimport CanvasVectorLayerRenderer from './VectorLayer.js';\nimport EventType from '../../events/EventType.js';\nimport ImageState from '../../ImageState.js';\nimport {renderDeclutterItems} from '../../render.js';\n\n/**\n * @classdesc\n * Canvas renderer for image layers.\n * @api\n */\nclass CanvasVectorImageLayerRenderer extends CanvasImageLayerRenderer {\n\n  /**\n   * @param {import(\"../../layer/VectorImage.js\").default} layer Vector image layer.\n   */\n  constructor(layer) {\n    super(layer);\n\n    /**\n     * @private\n     * @type {import(\"./VectorLayer.js\").default}\n     */\n    this.vectorRenderer_ = new CanvasVectorLayerRenderer(layer);\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.layerImageRatio_ = layer.getImageRatio();\n\n  }\n\n  /**\n   * @inheritDoc\n   */\n  disposeInternal() {\n    this.vectorRenderer_.dispose();\n    super.disposeInternal();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  handleFontsChanged() {\n    this.vectorRenderer_.handleFontsChanged();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  prepareFrame(frameState) {\n    const pixelRatio = frameState.pixelRatio;\n    const viewState = frameState.viewState;\n    const viewResolution = viewState.resolution;\n\n    const hints = frameState.viewHints;\n    const vectorRenderer = this.vectorRenderer_;\n    let renderedExtent = frameState.extent;\n    if (this.layerImageRatio_ !== 1) {\n      renderedExtent = renderedExtent.slice(0);\n      scaleFromCenter(renderedExtent, this.layerImageRatio_);\n    }\n\n    if (!hints[ViewHint.ANIMATING] && !hints[ViewHint.INTERACTING] && !isEmpty(renderedExtent)) {\n      vectorRenderer.useContainer(null, null, 1);\n      const context = vectorRenderer.context;\n      const imageFrameState = /** @type {import(\"../../PluggableMap.js\").FrameState} */ (assign({}, frameState, {\n        declutterItems: [],\n        size: [\n          getWidth(renderedExtent) / viewResolution,\n          getHeight(renderedExtent) / viewResolution\n        ],\n        viewState: /** @type {import(\"../../View.js\").State} */ (assign({}, frameState.viewState, {\n          rotation: 0\n        }))\n      }));\n      const image = new ImageCanvas(renderedExtent, viewResolution, pixelRatio, context.canvas, function(callback) {\n        if (vectorRenderer.prepareFrame(imageFrameState) && vectorRenderer.replayGroupChanged) {\n          vectorRenderer.renderFrame(imageFrameState, null);\n          renderDeclutterItems(imageFrameState, null);\n          callback();\n        }\n      });\n\n      image.addEventListener(EventType.CHANGE, function() {\n        if (image.getState() === ImageState.LOADED) {\n          this.image_ = image;\n        }\n      }.bind(this));\n      image.load();\n    }\n\n    if (this.image_) {\n      const image = this.image_;\n      const imageResolution = image.getResolution();\n      const imagePixelRatio = image.getPixelRatio();\n      this.renderedResolution = imageResolution * pixelRatio / imagePixelRatio;\n    }\n\n    return !!this.image_;\n  }\n\n  /**\n   * @override\n   */\n  preRender() {}\n\n  /**\n   * @override\n   */\n  postRender() {}\n\n  /**\n   * @inheritDoc\n   */\n  forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures) {\n    if (this.vectorRenderer_) {\n      return this.vectorRenderer_.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures);\n    } else {\n      return super.forEachFeatureAtCoordinate(coordinate, frameState, hitTolerance, callback, declutteredFeatures);\n    }\n  }\n}\n\n\nexport default CanvasVectorImageLayerRenderer;\n","/**\n * @module ol/layer/VectorImage\n */\nimport BaseVectorLayer from './BaseVector.js';\nimport {assign} from '../obj.js';\nimport CanvasVectorImageLayerRenderer from '../renderer/canvas/VectorImageLayer.js';\n\n/**\n * @typedef {Object} Options\n * @property {string} [className='ol-layer'] A CSS class name to set to the layer element.\n * @property {number} [opacity=1] Opacity (0, 1).\n * @property {boolean} [visible=true] Visibility.\n * @property {import(\"../extent.js\").Extent} [extent] The bounding extent for layer rendering.  The layer will not be\n * rendered outside of this extent.\n * @property {number} [zIndex] The z-index for layer rendering.  At rendering time, the layers\n * will be ordered, first by Z-index and then by position. When `undefined`, a `zIndex` of 0 is assumed\n * for layers that are added to the map's `layers` collection, or `Infinity` when the layer's `setMap()`\n * method was used.\n * @property {number} [minResolution] The minimum resolution (inclusive) at which this layer will be\n * visible.\n * @property {number} [maxResolution] The maximum resolution (exclusive) below which this layer will\n * be visible.\n * @property {import(\"../render.js\").OrderFunction} [renderOrder] Render order. Function to be used when sorting\n * features before rendering. By default features are drawn in the order that they are created. Use\n * `null` to avoid the sort, but get an undefined draw order.\n * @property {number} [renderBuffer=100] The buffer in pixels around the viewport extent used by the\n * renderer when getting features from the vector source for the rendering or hit-detection.\n * Recommended value: the size of the largest symbol, line width or label.\n * @property {import(\"../source/Vector.js\").default} [source] Source.\n * @property {import(\"../PluggableMap.js\").default} [map] Sets the layer as overlay on a map. The map will not manage\n * this layer in its layers collection, and the layer will be rendered on top. This is useful for\n * temporary layers. The standard way to add a layer to a map and have it managed by the map is to\n * use {@link module:ol/Map#addLayer}.\n * @property {boolean} [declutter=false] Declutter images and text on this layer. The priority is defined\n * by the `zIndex` of the style and the render order of features. Higher z-index means higher priority.\n * Within the same z-index, a feature rendered before another has higher priority.\n * @property {import(\"../style/Style.js\").StyleLike} [style] Layer style. See\n * {@link module:ol/style} for default style which will be used if this is not defined.\n * @property {boolean} [updateWhileAnimating=false] When set to `true`, feature batches will\n * be recreated during animations. This means that no vectors will be shown clipped, but the\n * setting will have a performance impact for large amounts of vector data. When set to `false`,\n * batches will be recreated when no animation is active.\n * @property {boolean} [updateWhileInteracting=false] When set to `true`, feature batches will\n * be recreated during interactions. See also `updateWhileAnimating`.\n * @property {number} [imageRatio=1] Ratio by which the rendered extent should be larger than the\n * viewport extent. A larger ratio avoids cut images during panning, but will cause a decrease in performance.\n */\n\n\n/**\n * @classdesc\n * Vector data that is rendered client-side.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @api\n */\nclass VectorImageLayer extends BaseVectorLayer {\n  /**\n   * @param {Options=} opt_options Options.\n   */\n  constructor(opt_options) {\n    const options = opt_options ? opt_options : {};\n\n    const baseOptions = assign({}, options);\n    delete baseOptions.imageRatio;\n    super(baseOptions);\n\n    /**\n     * @type {number}\n     * @private\n     */\n    this.imageRatio_ = options.imageRatio !== undefined ? options.imageRatio : 1;\n\n  }\n\n  /**\n   * @return {number} Ratio between rendered extent size and viewport extent size.\n   */\n  getImageRatio() {\n    return this.imageRatio_;\n  }\n\n  /**\n   * Create a renderer for this layer.\n   * @return {import(\"../renderer/Layer.js\").default} A layer renderer.\n   * @protected\n   */\n  createRenderer() {\n    return new CanvasVectorImageLayerRenderer(this);\n  }\n}\n\n\nexport default VectorImageLayer;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar getBlobFromURL_1 = __importDefault(require(\"./getBlobFromURL\"));\nvar utils_1 = require(\"./utils\");\nvar URL_REGEX = /url\\((['\"]?)([^'\"]+?)\\1\\)/g;\nfunction resolveUrl(url, baseUrl) {\n    // url is absolute already\n    if (url.match(/^[a-z]+:\\/\\//i)) {\n        return url;\n    }\n    // url is absolute already, without protocol\n    if (url.match(/^\\/\\//)) {\n        return window.location.protocol + url;\n    }\n    // dataURI, mailto:, tel:, etc.\n    if (url.match(/^[a-z]+:/i)) {\n        return url;\n    }\n    var doc = document.implementation.createHTMLDocument();\n    var base = doc.createElement('base');\n    var a = doc.createElement('a');\n    doc.head.appendChild(base);\n    doc.body.appendChild(a);\n    if (baseUrl) {\n        base.href = baseUrl;\n    }\n    a.href = url;\n    return a.href;\n}\nfunction escape(url) {\n    return url.replace(/([.*+?^${}()|\\[\\]\\/\\\\])/g, '\\\\$1');\n}\nfunction urlToRegex(url) {\n    return new RegExp(\"(url\\\\(['\\\"]?)(\" + escape(url) + \")(['\\\"]?\\\\))\", 'g');\n}\nfunction parseURLs(str) {\n    var result = [];\n    str.replace(URL_REGEX, function (raw, quotation, url) {\n        result.push(url);\n        return raw;\n    });\n    return result.filter(function (url) { return !utils_1.isDataUrl(url); });\n}\nfunction embed(cssString, resourceURL, baseURL, options) {\n    var resolvedURL = baseURL ? resolveUrl(resourceURL, baseURL) : resourceURL;\n    return Promise.resolve(resolvedURL)\n        .then(function (url) { return getBlobFromURL_1.default(url, options); })\n        .then(function (data) { return utils_1.toDataURL(data, utils_1.getMimeType(resourceURL)); })\n        .then(function (dataURL) { return cssString.replace(urlToRegex(resourceURL), \"$1\" + dataURL + \"$3\"); })\n        .then(function (content) { return content; }, function () { return resolvedURL; });\n}\nfunction shouldEmbed(string) {\n    return string.search(URL_REGEX) !== -1;\n}\nexports.shouldEmbed = shouldEmbed;\nfunction embedResources(cssString, baseUrl, options) {\n    if (!shouldEmbed(cssString)) {\n        return Promise.resolve(cssString);\n    }\n    return Promise.resolve(cssString)\n        .then(parseURLs)\n        .then(function (urls) { return urls.reduce(function (done, url) { return done.then(function (ret) { return embed(ret, url, baseUrl, options); }); }, Promise.resolve(cssString)); });\n}\nexports.default = embedResources;\n","\"use strict\";\n/* tslint:disable:max-line-length */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\n// KNOWN ISSUE\n// -----------\n// Can not handle redirect-url, such as when access 'http://something.com/avatar.png'\n// will redirect to 'http://something.com/65fc2ffcc8aea7ba65a1d1feda173540'\nvar TIMEOUT = 30000;\nfunction getBlobFromURL(url, options) {\n    // cache bypass so we dont have CORS issues with cached images\n    // ref: https://developer.mozilla.org/en/docs/Web/API/XMLHttpRequest/Using_XMLHttpRequest#Bypassing_the_cache\n    if (options.cacheBust) {\n        url += ((/\\?/).test(url) ? '&' : '?') + (new Date()).getTime(); // tslint:disable-line\n    }\n    var failed = function (reason) {\n        var placeholder = '';\n        if (options.imagePlaceholder) {\n            var split = options.imagePlaceholder.split(/,/);\n            if (split && split[1]) {\n                placeholder = split[1];\n            }\n        }\n        var msg = \"Failed to fetch resource: \" + url;\n        if (reason) {\n            msg = typeof reason === 'string' ? reason : reason.message;\n        }\n        if (msg) {\n            console.error(msg);\n        }\n        return placeholder;\n    };\n    var deferred = window.fetch\n        // fetch\n        ? window.fetch(url)\n            .then(function (response) { return response.blob(); })\n            .then(function (blob) { return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            reader.onloadend = function () { return resolve(reader.result); };\n            reader.onerror = reject;\n            reader.readAsDataURL(blob);\n        }); })\n            .then(utils_1.getDataURLContent)\n            .catch(function () { return new Promise(function (resolve, reject) {\n            reject();\n        }); })\n        // xhr\n        : new Promise((function (resolve, reject) {\n            var req = new XMLHttpRequest();\n            var timeout = function () {\n                reject(new Error(\"Timeout of \" + TIMEOUT + \"ms occured while fetching resource: \" + url));\n            };\n            var done = function () {\n                if (req.readyState !== 4) {\n                    return;\n                }\n                if (req.status !== 200) {\n                    reject(new Error(\"Failed to fetch resource: \" + url + \", status: \" + req.status));\n                    return;\n                }\n                var encoder = new FileReader();\n                encoder.onloadend = function () {\n                    resolve(utils_1.getDataURLContent(encoder.result));\n                };\n                encoder.readAsDataURL(req.response);\n            };\n            req.onreadystatechange = done;\n            req.ontimeout = timeout;\n            req.responseType = 'blob';\n            req.timeout = TIMEOUT;\n            req.open('GET', url, true);\n            req.send();\n        }));\n    return deferred.catch(failed);\n}\nexports.default = getBlobFromURL;\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var Processor = require('./processor');\n\nexports.Processor = Processor;\n","'use strict';\n\nmodule.exports = Pbf;\n\nvar ieee754 = require('ieee754');\n\nfunction Pbf(buf) {\n    this.buf = ArrayBuffer.isView && ArrayBuffer.isView(buf) ? buf : new Uint8Array(buf || 0);\n    this.pos = 0;\n    this.type = 0;\n    this.length = this.buf.length;\n}\n\nPbf.Varint  = 0; // varint: int32, int64, uint32, uint64, sint32, sint64, bool, enum\nPbf.Fixed64 = 1; // 64-bit: double, fixed64, sfixed64\nPbf.Bytes   = 2; // length-delimited: string, bytes, embedded messages, packed repeated fields\nPbf.Fixed32 = 5; // 32-bit: float, fixed32, sfixed32\n\nvar SHIFT_LEFT_32 = (1 << 16) * (1 << 16),\n    SHIFT_RIGHT_32 = 1 / SHIFT_LEFT_32;\n\nPbf.prototype = {\n\n    destroy: function() {\n        this.buf = null;\n    },\n\n    // === READING =================================================================\n\n    readFields: function(readField, result, end) {\n        end = end || this.length;\n\n        while (this.pos < end) {\n            var val = this.readVarint(),\n                tag = val >> 3,\n                startPos = this.pos;\n\n            this.type = val & 0x7;\n            readField(tag, result, this);\n\n            if (this.pos === startPos) this.skip(val);\n        }\n        return result;\n    },\n\n    readMessage: function(readField, result) {\n        return this.readFields(readField, result, this.readVarint() + this.pos);\n    },\n\n    readFixed32: function() {\n        var val = readUInt32(this.buf, this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    readSFixed32: function() {\n        var val = readInt32(this.buf, this.pos);\n        this.pos += 4;\n        return val;\n    },\n\n    // 64-bit int handling is based on github.com/dpw/node-buffer-more-ints (MIT-licensed)\n\n    readFixed64: function() {\n        var val = readUInt32(this.buf, this.pos) + readUInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readSFixed64: function() {\n        var val = readUInt32(this.buf, this.pos) + readInt32(this.buf, this.pos + 4) * SHIFT_LEFT_32;\n        this.pos += 8;\n        return val;\n    },\n\n    readFloat: function() {\n        var val = ieee754.read(this.buf, this.pos, true, 23, 4);\n        this.pos += 4;\n        return val;\n    },\n\n    readDouble: function() {\n        var val = ieee754.read(this.buf, this.pos, true, 52, 8);\n        this.pos += 8;\n        return val;\n    },\n\n    readVarint: function(isSigned) {\n        var buf = this.buf,\n            val, b;\n\n        b = buf[this.pos++]; val  =  b & 0x7f;        if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 7;  if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 14; if (b < 0x80) return val;\n        b = buf[this.pos++]; val |= (b & 0x7f) << 21; if (b < 0x80) return val;\n        b = buf[this.pos];   val |= (b & 0x0f) << 28;\n\n        return readVarintRemainder(val, isSigned, this);\n    },\n\n    readVarint64: function() { // for compatibility with v2.0.1\n        return this.readVarint(true);\n    },\n\n    readSVarint: function() {\n        var num = this.readVarint();\n        return num % 2 === 1 ? (num + 1) / -2 : num / 2; // zigzag encoding\n    },\n\n    readBoolean: function() {\n        return Boolean(this.readVarint());\n    },\n\n    readString: function() {\n        var end = this.readVarint() + this.pos,\n            str = readUtf8(this.buf, this.pos, end);\n        this.pos = end;\n        return str;\n    },\n\n    readBytes: function() {\n        var end = this.readVarint() + this.pos,\n            buffer = this.buf.subarray(this.pos, end);\n        this.pos = end;\n        return buffer;\n    },\n\n    // verbose for performance reasons; doesn't affect gzipped size\n\n    readPackedVarint: function(arr, isSigned) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readVarint(isSigned));\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readVarint(isSigned));\n        return arr;\n    },\n    readPackedSVarint: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readSVarint());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSVarint());\n        return arr;\n    },\n    readPackedBoolean: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readBoolean());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readBoolean());\n        return arr;\n    },\n    readPackedFloat: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readFloat());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFloat());\n        return arr;\n    },\n    readPackedDouble: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readDouble());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readDouble());\n        return arr;\n    },\n    readPackedFixed32: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readFixed32());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFixed32());\n        return arr;\n    },\n    readPackedSFixed32: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readSFixed32());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSFixed32());\n        return arr;\n    },\n    readPackedFixed64: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readFixed64());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readFixed64());\n        return arr;\n    },\n    readPackedSFixed64: function(arr) {\n        if (this.type !== Pbf.Bytes) return arr.push(this.readSFixed64());\n        var end = readPackedEnd(this);\n        arr = arr || [];\n        while (this.pos < end) arr.push(this.readSFixed64());\n        return arr;\n    },\n\n    skip: function(val) {\n        var type = val & 0x7;\n        if (type === Pbf.Varint) while (this.buf[this.pos++] > 0x7f) {}\n        else if (type === Pbf.Bytes) this.pos = this.readVarint() + this.pos;\n        else if (type === Pbf.Fixed32) this.pos += 4;\n        else if (type === Pbf.Fixed64) this.pos += 8;\n        else throw new Error('Unimplemented type: ' + type);\n    },\n\n    // === WRITING =================================================================\n\n    writeTag: function(tag, type) {\n        this.writeVarint((tag << 3) | type);\n    },\n\n    realloc: function(min) {\n        var length = this.length || 16;\n\n        while (length < this.pos + min) length *= 2;\n\n        if (length !== this.length) {\n            var buf = new Uint8Array(length);\n            buf.set(this.buf);\n            this.buf = buf;\n            this.length = length;\n        }\n    },\n\n    finish: function() {\n        this.length = this.pos;\n        this.pos = 0;\n        return this.buf.subarray(0, this.length);\n    },\n\n    writeFixed32: function(val) {\n        this.realloc(4);\n        writeInt32(this.buf, val, this.pos);\n        this.pos += 4;\n    },\n\n    writeSFixed32: function(val) {\n        this.realloc(4);\n        writeInt32(this.buf, val, this.pos);\n        this.pos += 4;\n    },\n\n    writeFixed64: function(val) {\n        this.realloc(8);\n        writeInt32(this.buf, val & -1, this.pos);\n        writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeSFixed64: function(val) {\n        this.realloc(8);\n        writeInt32(this.buf, val & -1, this.pos);\n        writeInt32(this.buf, Math.floor(val * SHIFT_RIGHT_32), this.pos + 4);\n        this.pos += 8;\n    },\n\n    writeVarint: function(val) {\n        val = +val || 0;\n\n        if (val > 0xfffffff || val < 0) {\n            writeBigVarint(val, this);\n            return;\n        }\n\n        this.realloc(4);\n\n        this.buf[this.pos++] =           val & 0x7f  | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] = ((val >>>= 7) & 0x7f) | (val > 0x7f ? 0x80 : 0); if (val <= 0x7f) return;\n        this.buf[this.pos++] =   (val >>> 7) & 0x7f;\n    },\n\n    writeSVarint: function(val) {\n        this.writeVarint(val < 0 ? -val * 2 - 1 : val * 2);\n    },\n\n    writeBoolean: function(val) {\n        this.writeVarint(Boolean(val));\n    },\n\n    writeString: function(str) {\n        str = String(str);\n        this.realloc(str.length * 4);\n\n        this.pos++; // reserve 1 byte for short string length\n\n        var startPos = this.pos;\n        // write the string directly to the buffer and see how much was written\n        this.pos = writeUtf8(this.buf, str, this.pos);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeFloat: function(val) {\n        this.realloc(4);\n        ieee754.write(this.buf, val, this.pos, true, 23, 4);\n        this.pos += 4;\n    },\n\n    writeDouble: function(val) {\n        this.realloc(8);\n        ieee754.write(this.buf, val, this.pos, true, 52, 8);\n        this.pos += 8;\n    },\n\n    writeBytes: function(buffer) {\n        var len = buffer.length;\n        this.writeVarint(len);\n        this.realloc(len);\n        for (var i = 0; i < len; i++) this.buf[this.pos++] = buffer[i];\n    },\n\n    writeRawMessage: function(fn, obj) {\n        this.pos++; // reserve 1 byte for short message length\n\n        // write the message directly to the buffer and see how much was written\n        var startPos = this.pos;\n        fn(obj, this);\n        var len = this.pos - startPos;\n\n        if (len >= 0x80) makeRoomForExtraLength(startPos, len, this);\n\n        // finally, write the message length in the reserved place and restore the position\n        this.pos = startPos - 1;\n        this.writeVarint(len);\n        this.pos += len;\n    },\n\n    writeMessage: function(tag, fn, obj) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeRawMessage(fn, obj);\n    },\n\n    writePackedVarint:   function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedVarint, arr);   },\n    writePackedSVarint:  function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedSVarint, arr);  },\n    writePackedBoolean:  function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedBoolean, arr);  },\n    writePackedFloat:    function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedFloat, arr);    },\n    writePackedDouble:   function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedDouble, arr);   },\n    writePackedFixed32:  function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedFixed32, arr);  },\n    writePackedSFixed32: function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedSFixed32, arr); },\n    writePackedFixed64:  function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedFixed64, arr);  },\n    writePackedSFixed64: function(tag, arr) { if (arr.length) this.writeMessage(tag, writePackedSFixed64, arr); },\n\n    writeBytesField: function(tag, buffer) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeBytes(buffer);\n    },\n    writeFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFixed32(val);\n    },\n    writeSFixed32Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeSFixed32(val);\n    },\n    writeFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeFixed64(val);\n    },\n    writeSFixed64Field: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeSFixed64(val);\n    },\n    writeVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeVarint(val);\n    },\n    writeSVarintField: function(tag, val) {\n        this.writeTag(tag, Pbf.Varint);\n        this.writeSVarint(val);\n    },\n    writeStringField: function(tag, str) {\n        this.writeTag(tag, Pbf.Bytes);\n        this.writeString(str);\n    },\n    writeFloatField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed32);\n        this.writeFloat(val);\n    },\n    writeDoubleField: function(tag, val) {\n        this.writeTag(tag, Pbf.Fixed64);\n        this.writeDouble(val);\n    },\n    writeBooleanField: function(tag, val) {\n        this.writeVarintField(tag, Boolean(val));\n    }\n};\n\nfunction readVarintRemainder(l, s, p) {\n    var buf = p.buf,\n        h, b;\n\n    b = buf[p.pos++]; h  = (b & 0x70) >> 4;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 3;  if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 10; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 17; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x7f) << 24; if (b < 0x80) return toNum(l, h, s);\n    b = buf[p.pos++]; h |= (b & 0x01) << 31; if (b < 0x80) return toNum(l, h, s);\n\n    throw new Error('Expected varint not more than 10 bytes');\n}\n\nfunction readPackedEnd(pbf) {\n    return pbf.type === Pbf.Bytes ?\n        pbf.readVarint() + pbf.pos : pbf.pos + 1;\n}\n\nfunction toNum(low, high, isSigned) {\n    if (isSigned) {\n        return high * 0x100000000 + (low >>> 0);\n    }\n\n    return ((high >>> 0) * 0x100000000) + (low >>> 0);\n}\n\nfunction writeBigVarint(val, pbf) {\n    var low, high;\n\n    if (val >= 0) {\n        low  = (val % 0x100000000) | 0;\n        high = (val / 0x100000000) | 0;\n    } else {\n        low  = ~(-val % 0x100000000);\n        high = ~(-val / 0x100000000);\n\n        if (low ^ 0xffffffff) {\n            low = (low + 1) | 0;\n        } else {\n            low = 0;\n            high = (high + 1) | 0;\n        }\n    }\n\n    if (val >= 0x10000000000000000 || val < -0x10000000000000000) {\n        throw new Error('Given varint doesn\\'t fit into 10 bytes');\n    }\n\n    pbf.realloc(10);\n\n    writeBigVarintLow(low, high, pbf);\n    writeBigVarintHigh(high, pbf);\n}\n\nfunction writeBigVarintLow(low, high, pbf) {\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos++] = low & 0x7f | 0x80; low >>>= 7;\n    pbf.buf[pbf.pos]   = low & 0x7f;\n}\n\nfunction writeBigVarintHigh(high, pbf) {\n    var lsb = (high & 0x07) << 4;\n\n    pbf.buf[pbf.pos++] |= lsb         | ((high >>>= 3) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f | ((high >>>= 7) ? 0x80 : 0); if (!high) return;\n    pbf.buf[pbf.pos++]  = high & 0x7f;\n}\n\nfunction makeRoomForExtraLength(startPos, len, pbf) {\n    var extraLen =\n        len <= 0x3fff ? 1 :\n        len <= 0x1fffff ? 2 :\n        len <= 0xfffffff ? 3 : Math.floor(Math.log(len) / (Math.LN2 * 7));\n\n    // if 1 byte isn't enough for encoding message length, shift the data to the right\n    pbf.realloc(extraLen);\n    for (var i = pbf.pos - 1; i >= startPos; i--) pbf.buf[i + extraLen] = pbf.buf[i];\n}\n\nfunction writePackedVarint(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeVarint(arr[i]);   }\nfunction writePackedSVarint(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeSVarint(arr[i]);  }\nfunction writePackedFloat(arr, pbf)    { for (var i = 0; i < arr.length; i++) pbf.writeFloat(arr[i]);    }\nfunction writePackedDouble(arr, pbf)   { for (var i = 0; i < arr.length; i++) pbf.writeDouble(arr[i]);   }\nfunction writePackedBoolean(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeBoolean(arr[i]);  }\nfunction writePackedFixed32(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed32(arr[i]);  }\nfunction writePackedSFixed32(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed32(arr[i]); }\nfunction writePackedFixed64(arr, pbf)  { for (var i = 0; i < arr.length; i++) pbf.writeFixed64(arr[i]);  }\nfunction writePackedSFixed64(arr, pbf) { for (var i = 0; i < arr.length; i++) pbf.writeSFixed64(arr[i]); }\n\n// Buffer code below from https://github.com/feross/buffer, MIT-licensed\n\nfunction readUInt32(buf, pos) {\n    return ((buf[pos]) |\n        (buf[pos + 1] << 8) |\n        (buf[pos + 2] << 16)) +\n        (buf[pos + 3] * 0x1000000);\n}\n\nfunction writeInt32(buf, val, pos) {\n    buf[pos] = val;\n    buf[pos + 1] = (val >>> 8);\n    buf[pos + 2] = (val >>> 16);\n    buf[pos + 3] = (val >>> 24);\n}\n\nfunction readInt32(buf, pos) {\n    return ((buf[pos]) |\n        (buf[pos + 1] << 8) |\n        (buf[pos + 2] << 16)) +\n        (buf[pos + 3] << 24);\n}\n\nfunction readUtf8(buf, pos, end) {\n    var str = '';\n    var i = pos;\n\n    while (i < end) {\n        var b0 = buf[i];\n        var c = null; // codepoint\n        var bytesPerSequence =\n            b0 > 0xEF ? 4 :\n            b0 > 0xDF ? 3 :\n            b0 > 0xBF ? 2 : 1;\n\n        if (i + bytesPerSequence > end) break;\n\n        var b1, b2, b3;\n\n        if (bytesPerSequence === 1) {\n            if (b0 < 0x80) {\n                c = b0;\n            }\n        } else if (bytesPerSequence === 2) {\n            b1 = buf[i + 1];\n            if ((b1 & 0xC0) === 0x80) {\n                c = (b0 & 0x1F) << 0x6 | (b1 & 0x3F);\n                if (c <= 0x7F) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 3) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0xC | (b1 & 0x3F) << 0x6 | (b2 & 0x3F);\n                if (c <= 0x7FF || (c >= 0xD800 && c <= 0xDFFF)) {\n                    c = null;\n                }\n            }\n        } else if (bytesPerSequence === 4) {\n            b1 = buf[i + 1];\n            b2 = buf[i + 2];\n            b3 = buf[i + 3];\n            if ((b1 & 0xC0) === 0x80 && (b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n                c = (b0 & 0xF) << 0x12 | (b1 & 0x3F) << 0xC | (b2 & 0x3F) << 0x6 | (b3 & 0x3F);\n                if (c <= 0xFFFF || c >= 0x110000) {\n                    c = null;\n                }\n            }\n        }\n\n        if (c === null) {\n            c = 0xFFFD;\n            bytesPerSequence = 1;\n\n        } else if (c > 0xFFFF) {\n            c -= 0x10000;\n            str += String.fromCharCode(c >>> 10 & 0x3FF | 0xD800);\n            c = 0xDC00 | c & 0x3FF;\n        }\n\n        str += String.fromCharCode(c);\n        i += bytesPerSequence;\n    }\n\n    return str;\n}\n\nfunction writeUtf8(buf, str, pos) {\n    for (var i = 0, c, lead; i < str.length; i++) {\n        c = str.charCodeAt(i); // code point\n\n        if (c > 0xD7FF && c < 0xE000) {\n            if (lead) {\n                if (c < 0xDC00) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                    lead = c;\n                    continue;\n                } else {\n                    c = lead - 0xD800 << 10 | c - 0xDC00 | 0x10000;\n                    lead = null;\n                }\n            } else {\n                if (c > 0xDBFF || (i + 1 === str.length)) {\n                    buf[pos++] = 0xEF;\n                    buf[pos++] = 0xBF;\n                    buf[pos++] = 0xBD;\n                } else {\n                    lead = c;\n                }\n                continue;\n            }\n        } else if (lead) {\n            buf[pos++] = 0xEF;\n            buf[pos++] = 0xBF;\n            buf[pos++] = 0xBD;\n            lead = null;\n        }\n\n        if (c < 0x80) {\n            buf[pos++] = c;\n        } else {\n            if (c < 0x800) {\n                buf[pos++] = c >> 0x6 | 0xC0;\n            } else {\n                if (c < 0x10000) {\n                    buf[pos++] = c >> 0xC | 0xE0;\n                } else {\n                    buf[pos++] = c >> 0x12 | 0xF0;\n                    buf[pos++] = c >> 0xC & 0x3F | 0x80;\n                }\n                buf[pos++] = c >> 0x6 & 0x3F | 0x80;\n            }\n            buf[pos++] = c & 0x3F | 0x80;\n        }\n    }\n    return pos;\n}\n","/**\n * @module ol/source/Cluster\n */\n\nimport {getUid} from '../util.js';\nimport {assert} from '../asserts.js';\nimport Feature from '../Feature.js';\nimport GeometryType from '../geom/GeometryType.js';\nimport {scale as scaleCoordinate, add as addCoordinate} from '../coordinate.js';\nimport EventType from '../events/EventType.js';\nimport {buffer, createEmpty, createOrUpdateFromCoordinate} from '../extent.js';\nimport Point from '../geom/Point.js';\nimport VectorSource from './Vector.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [distance=20] Minimum distance in pixels between clusters.\n * @property {function(Feature):Point} [geometryFunction]\n * Function that takes an {@link module:ol/Feature} as argument and returns an\n * {@link module:ol/geom/Point} as cluster calculation point for the feature. When a\n * feature should not be considered for clustering, the function should return\n * `null`. The default, which works when the underyling source contains point\n * features only, is\n * ```js\n * function(feature) {\n *   return feature.getGeometry();\n * }\n * ```\n * See {@link module:ol/geom/Polygon~Polygon#getInteriorPoint} for a way to get a cluster\n * calculation point for polygons.\n * @property {VectorSource} source Source.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n */\n\n\n/**\n * @classdesc\n * Layer source to cluster vector data. Works out of the box with point\n * geometries. For other geometry types, or if not all geometries should be\n * considered for clustering, a custom `geometryFunction` can be defined.\n * @api\n */\nclass Cluster extends VectorSource {\n  /**\n   * @param {Options} options Cluster options.\n   */\n  constructor(options) {\n    super({\n      attributions: options.attributions,\n      wrapX: options.wrapX\n    });\n\n    /**\n     * @type {number|undefined}\n     * @protected\n     */\n    this.resolution = undefined;\n\n    /**\n     * @type {number}\n     * @protected\n     */\n    this.distance = options.distance !== undefined ? options.distance : 20;\n\n    /**\n     * @type {Array<Feature>}\n     * @protected\n     */\n    this.features = [];\n\n    /**\n     * @param {Feature} feature Feature.\n     * @return {Point} Cluster calculation point.\n     * @protected\n     */\n    this.geometryFunction = options.geometryFunction || function(feature) {\n      const geometry = feature.getGeometry();\n      assert(geometry.getType() == GeometryType.POINT,\n        10); // The default `geometryFunction` can only handle `Point` geometries\n      return geometry;\n    };\n\n    /**\n     * @type {VectorSource}\n     * @protected\n     */\n    this.source = options.source;\n\n    this.source.addEventListener(EventType.CHANGE, this.refresh.bind(this));\n  }\n\n  /**\n   * Get the distance in pixels between clusters.\n   * @return {number} Distance.\n   * @api\n   */\n  getDistance() {\n    return this.distance;\n  }\n\n  /**\n   * Get a reference to the wrapped source.\n   * @return {VectorSource} Source.\n   * @api\n   */\n  getSource() {\n    return this.source;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  loadFeatures(extent, resolution, projection) {\n    this.source.loadFeatures(extent, resolution, projection);\n    if (resolution !== this.resolution) {\n      this.clear();\n      this.resolution = resolution;\n      this.cluster();\n      this.addFeatures(this.features);\n    }\n  }\n\n  /**\n   * Set the distance in pixels between clusters.\n   * @param {number} distance The distance in pixels.\n   * @api\n   */\n  setDistance(distance) {\n    this.distance = distance;\n    this.refresh();\n  }\n\n  /**\n   * handle the source changing\n   * @override\n   */\n  refresh() {\n    this.clear();\n    this.cluster();\n    this.addFeatures(this.features);\n  }\n\n  /**\n   * @protected\n   */\n  cluster() {\n    if (this.resolution === undefined) {\n      return;\n    }\n    this.features.length = 0;\n    const extent = createEmpty();\n    const mapDistance = this.distance * this.resolution;\n    const features = this.source.getFeatures();\n\n    /**\n     * @type {!Object<string, boolean>}\n     */\n    const clustered = {};\n\n    for (let i = 0, ii = features.length; i < ii; i++) {\n      const feature = features[i];\n      if (!(getUid(feature) in clustered)) {\n        const geometry = this.geometryFunction(feature);\n        if (geometry) {\n          const coordinates = geometry.getCoordinates();\n          createOrUpdateFromCoordinate(coordinates, extent);\n          buffer(extent, mapDistance, extent);\n\n          let neighbors = this.source.getFeaturesInExtent(extent);\n          neighbors = neighbors.filter(function(neighbor) {\n            const uid = getUid(neighbor);\n            if (!(uid in clustered)) {\n              clustered[uid] = true;\n              return true;\n            } else {\n              return false;\n            }\n          });\n          this.features.push(this.createCluster(neighbors));\n        }\n      }\n    }\n  }\n\n  /**\n   * @param {Array<Feature>} features Features\n   * @return {Feature} The cluster feature.\n   * @protected\n   */\n  createCluster(features) {\n    const centroid = [0, 0];\n    for (let i = features.length - 1; i >= 0; --i) {\n      const geometry = this.geometryFunction(features[i]);\n      if (geometry) {\n        addCoordinate(centroid, geometry.getCoordinates());\n      } else {\n        features.splice(i, 1);\n      }\n    }\n    scaleCoordinate(centroid, 1 / features.length);\n\n    const cluster = new Feature(new Point(centroid));\n    cluster.set('features', features);\n    return cluster;\n  }\n}\n\n\nexport default Cluster;\n","var newImageData = require('./util').newImageData;\n\n/**\n * Create a function for running operations.  This function is serialized for\n * use in a worker.\n * @param {function(Array, Object):*} operation The operation.\n * @return {function(Object):ArrayBuffer} A function that takes an object with\n * buffers, meta, imageOps, width, and height properties and returns an array\n * buffer.\n */\nfunction createMinion(operation) {\n  var workerHasImageData = true;\n  try {\n    new ImageData(10, 10);\n  } catch (_) {\n    workerHasImageData = false;\n  }\n\n  function newWorkerImageData(data, width, height) {\n    if (workerHasImageData) {\n      return new ImageData(data, width, height);\n    } else {\n      return {data: data, width: width, height: height};\n    }\n  }\n\n  return function(data) {\n    // bracket notation for minification support\n    var buffers = data['buffers'];\n    var meta = data['meta'];\n    var imageOps = data['imageOps'];\n    var width = data['width'];\n    var height = data['height'];\n\n    var numBuffers = buffers.length;\n    var numBytes = buffers[0].byteLength;\n    var output, b;\n\n    if (imageOps) {\n      var images = new Array(numBuffers);\n      for (b = 0; b < numBuffers; ++b) {\n        images[b] = newWorkerImageData(\n            new Uint8ClampedArray(buffers[b]), width, height);\n      }\n      output = operation(images, meta).data;\n    } else {\n      output = new Uint8ClampedArray(numBytes);\n      var arrays = new Array(numBuffers);\n      var pixels = new Array(numBuffers);\n      for (b = 0; b < numBuffers; ++b) {\n        arrays[b] = new Uint8ClampedArray(buffers[b]);\n        pixels[b] = [0, 0, 0, 0];\n      }\n      for (var i = 0; i < numBytes; i += 4) {\n        for (var j = 0; j < numBuffers; ++j) {\n          var array = arrays[j];\n          pixels[j][0] = array[i];\n          pixels[j][1] = array[i + 1];\n          pixels[j][2] = array[i + 2];\n          pixels[j][3] = array[i + 3];\n        }\n        var pixel = operation(pixels, meta);\n        output[i] = pixel[0];\n        output[i + 1] = pixel[1];\n        output[i + 2] = pixel[2];\n        output[i + 3] = pixel[3];\n      }\n    }\n    return output.buffer;\n  };\n}\n\n/**\n * Create a worker for running operations.\n * @param {Object} config Configuration.\n * @param {function(MessageEvent)} onMessage Called with a message event.\n * @return {Worker} The worker.\n */\nfunction createWorker(config, onMessage) {\n  var lib = Object.keys(config.lib || {}).map(function(name) {\n    return 'var ' + name + ' = ' + config.lib[name].toString() + ';';\n  });\n\n  var lines = lib.concat([\n    'var __minion__ = (' + createMinion.toString() + ')(', config.operation.toString(), ');',\n    'self.addEventListener(\"message\", function(event) {',\n    '  var buffer = __minion__(event.data);',\n    '  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);',\n    '});'\n  ]);\n\n  var blob = new Blob(lines, {type: 'text/javascript'});\n  var source = URL.createObjectURL(blob);\n  var worker = new Worker(source);\n  worker.addEventListener('message', onMessage);\n  return worker;\n}\n\n/**\n * Create a faux worker for running operations.\n * @param {Object} config Configuration.\n * @param {function(MessageEvent)} onMessage Called with a message event.\n * @return {Object} The faux worker.\n */\nfunction createFauxWorker(config, onMessage) {\n  var minion = createMinion(config.operation);\n  return {\n    postMessage: function(data) {\n      setTimeout(function() {\n        onMessage({'data': {'buffer': minion(data), 'meta': data['meta']}});\n      }, 0);\n    }\n  };\n}\n\n/**\n * A processor runs pixel or image operations in workers.\n * @param {Object} config Configuration.\n */\nfunction Processor(config) {\n  this._imageOps = !!config.imageOps;\n  var threads;\n  if (config.threads === 0) {\n    threads = 0;\n  } else if (this._imageOps) {\n    threads = 1;\n  } else {\n    threads = config.threads || 1;\n  }\n  var workers = [];\n  if (threads) {\n    for (var i = 0; i < threads; ++i) {\n      workers[i] = createWorker(config, this._onWorkerMessage.bind(this, i));\n    }\n  } else {\n    workers[0] = createFauxWorker(config, this._onWorkerMessage.bind(this, 0));\n  }\n  this._workers = workers;\n  this._queue = [];\n  this._maxQueueLength = config.queue || Infinity;\n  this._running = 0;\n  this._dataLookup = {};\n  this._job = null;\n}\n\n/**\n * Run operation on input data.\n * @param {Array.<Array|ImageData>} inputs Array of pixels or image data\n *     (depending on the operation type).\n * @param {Object} meta A user data object.  This is passed to all operations\n *     and must be serializable.\n * @param {function(Error, ImageData, Object)} callback Called when work\n *     completes.  The first argument is any error.  The second is the ImageData\n *     generated by operations.  The third is the user data object.\n */\nProcessor.prototype.process = function(inputs, meta, callback) {\n  this._enqueue({\n    inputs: inputs,\n    meta: meta,\n    callback: callback\n  });\n  this._dispatch();\n};\n\n/**\n * Stop responding to any completed work and destroy the processor.\n */\nProcessor.prototype.destroy = function() {\n  for (var key in this) {\n    this[key] = null;\n  }\n  this._destroyed = true;\n};\n\n/**\n * Add a job to the queue.\n * @param {Object} job The job.\n */\nProcessor.prototype._enqueue = function(job) {\n  this._queue.push(job);\n  while (this._queue.length > this._maxQueueLength) {\n    this._queue.shift().callback(null, null);\n  }\n};\n\n/**\n * Dispatch a job.\n */\nProcessor.prototype._dispatch = function() {\n  if (this._running === 0 && this._queue.length > 0) {\n    var job = this._job = this._queue.shift();\n    var width = job.inputs[0].width;\n    var height = job.inputs[0].height;\n    var buffers = job.inputs.map(function(input) {\n      return input.data.buffer;\n    });\n    var threads = this._workers.length;\n    this._running = threads;\n    if (threads === 1) {\n      this._workers[0].postMessage({\n        'buffers': buffers,\n        'meta': job.meta,\n        'imageOps': this._imageOps,\n        'width': width,\n        'height': height\n      }, buffers);\n    } else {\n      var length = job.inputs[0].data.length;\n      var segmentLength = 4 * Math.ceil(length / 4 / threads);\n      for (var i = 0; i < threads; ++i) {\n        var offset = i * segmentLength;\n        var slices = [];\n        for (var j = 0, jj = buffers.length; j < jj; ++j) {\n          slices.push(buffers[i].slice(offset, offset + segmentLength));\n        }\n        this._workers[i].postMessage({\n          'buffers': slices,\n          'meta': job.meta,\n          'imageOps': this._imageOps,\n          'width': width,\n          'height': height\n        }, slices);\n      }\n    }\n  }\n};\n\n/**\n * Handle messages from the worker.\n * @param {number} index The worker index.\n * @param {MessageEvent} event The message event.\n */\nProcessor.prototype._onWorkerMessage = function(index, event) {\n  if (this._destroyed) {\n    return;\n  }\n  this._dataLookup[index] = event.data;\n  --this._running;\n  if (this._running === 0) {\n    this._resolveJob();\n  }\n};\n\n/**\n * Resolve a job.  If there are no more worker threads, the processor callback\n * will be called.\n */\nProcessor.prototype._resolveJob = function() {\n  var job = this._job;\n  var threads = this._workers.length;\n  var data, meta;\n  if (threads === 1) {\n    data = new Uint8ClampedArray(this._dataLookup[0]['buffer']);\n    meta = this._dataLookup[0]['meta'];\n  } else {\n    var length = job.inputs[0].data.length;\n    data = new Uint8ClampedArray(length);\n    meta = new Array(length);\n    var segmentLength = 4 * Math.ceil(length / 4 / threads);\n    for (var i = 0; i < threads; ++i) {\n      var buffer = this._dataLookup[i]['buffer'];\n      var offset = i * segmentLength;\n      data.set(new Uint8ClampedArray(buffer), offset);\n      meta[i] = this._dataLookup[i]['meta'];\n    }\n  }\n  this._job = null;\n  this._dataLookup = {};\n  job.callback(null,\n      newImageData(data, job.inputs[0].width, job.inputs[0].height), meta);\n  this._dispatch();\n};\n\nmodule.exports = Processor;\n","var hasImageData = true;\ntry {\n  new ImageData(10, 10);\n} catch (_) {\n  hasImageData = false;\n}\n\nvar context = document.createElement('canvas').getContext('2d');\n\nfunction newImageData(data, width, height) {\n  if (hasImageData) {\n    return new ImageData(data, width, height);\n  } else {\n    var imageData = context.createImageData(width, height);\n    imageData.data.set(data);\n    return imageData;\n  }\n}\n\nexports.newImageData = newImageData;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nvar clonePseudoElements_1 = __importDefault(require(\"./clonePseudoElements\"));\nfunction cloneSingleNode(nativeNode) {\n    if (nativeNode instanceof HTMLCanvasElement) {\n        return utils_1.createImage(nativeNode.toDataURL());\n    }\n    if (nativeNode.tagName && nativeNode.tagName.toLowerCase() === 'svg') {\n        return Promise.resolve(nativeNode)\n            .then(function (svg) { return utils_1.svgToDataURL(svg); })\n            .then(utils_1.createImage);\n    }\n    return Promise.resolve(nativeNode.cloneNode(false));\n}\nfunction cloneChildren(nativeNode, clonedNode, filter) {\n    var children = utils_1.toArray(nativeNode.childNodes);\n    if (children.length === 0) {\n        return Promise.resolve(clonedNode);\n    }\n    // clone children in order\n    return children.reduce(function (done, child) { return done\n        .then(function () { return cloneNode(child, filter); })\n        .then(function (clonedChild) {\n        if (clonedChild) {\n            clonedNode.appendChild(clonedChild);\n        }\n    }); }, Promise.resolve())\n        .then(function () { return clonedNode; });\n}\nfunction cloneCssStyle(nativeNode, clonedNode) {\n    var source = window.getComputedStyle(nativeNode);\n    var target = clonedNode.style;\n    if (source.cssText) {\n        target.cssText = source.cssText;\n    }\n    else {\n        utils_1.toArray(source).forEach(function (name) {\n            target.setProperty(name, source.getPropertyValue(name), source.getPropertyPriority(name));\n        });\n    }\n}\nfunction cloneInputValue(nativeNode, clonedNode) {\n    if (nativeNode instanceof HTMLTextAreaElement) {\n        clonedNode.innerHTML = nativeNode.value;\n    }\n    if (nativeNode instanceof HTMLInputElement) {\n        clonedNode.setAttribute('value', nativeNode.value);\n    }\n}\nfunction decorate(nativeNode, clonedNode) {\n    if (!(clonedNode instanceof Element)) {\n        return clonedNode;\n    }\n    return Promise.resolve()\n        .then(function () { return cloneCssStyle(nativeNode, clonedNode); })\n        .then(function () { return clonePseudoElements_1.default(nativeNode, clonedNode); })\n        .then(function () { return cloneInputValue(nativeNode, clonedNode); })\n        .then(function () { return clonedNode; });\n}\nfunction cloneNode(domNode, filter, isRoot) {\n    if (!isRoot && filter && !filter(domNode)) {\n        return Promise.resolve(null);\n    }\n    return Promise.resolve(domNode)\n        .then(cloneSingleNode)\n        .then(function (clonedNode) { return cloneChildren(domNode, clonedNode, filter); })\n        .then(function (clonedNode) { return decorate(domNode, clonedNode); });\n}\nexports.default = cloneNode;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nfunction formatCssText(style) {\n    var content = style.getPropertyValue('content');\n    return style.cssText + \" content: \" + content + \";\";\n}\nfunction formatCssProperties(style) {\n    return utils_1.toArray(style).map(function (name) {\n        var value = style.getPropertyValue(name);\n        var priority = style.getPropertyPriority(name);\n        return name + \": \" + value + (priority ? ' !important' : '') + \";\";\n    }).join(' ');\n}\nfunction getPseudoElementStyle(className, pseudo, style) {\n    var selector = \".\" + className + \":\" + pseudo;\n    var cssText = style.cssText ? formatCssText(style) : formatCssProperties(style);\n    return document.createTextNode(selector + \"{\" + cssText + \"}\");\n}\nfunction clonePseudoElement(nativeNode, clonedNode, pseudo) {\n    var style = window.getComputedStyle(nativeNode, pseudo);\n    var content = style.getPropertyValue('content');\n    if (content === '' || content === 'none') {\n        return;\n    }\n    var className = utils_1.uuid();\n    var styleElement = document.createElement('style');\n    styleElement.appendChild(getPseudoElementStyle(className, pseudo, style));\n    clonedNode.className = clonedNode.className + \" \" + className;\n    clonedNode.appendChild(styleElement);\n}\nfunction clonePseudoElements(nativeNode, clonedNode) {\n    [\n        ':before',\n        ':after',\n    ].forEach(function (pseudo) { return clonePseudoElement(nativeNode, clonedNode, pseudo); });\n}\nexports.default = clonePseudoElements;\n","\"use strict\";\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\n    result[\"default\"] = mod;\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nvar embedResources_1 = __importStar(require(\"./embedResources\"));\nfunction getCssRules(styleSheets) {\n    var ret = [];\n    styleSheets.forEach(function (sheet) {\n        if (sheet.hasOwnProperty('cssRules')) {\n            try {\n                utils_1.toArray(sheet.cssRules).forEach(function (item) {\n                    ret.push(item);\n                });\n            }\n            catch (e) {\n                console.log(\"Error while reading CSS rules from \" + sheet.href, e.toString());\n            }\n        }\n    });\n    return ret;\n}\nfunction getWebFontRules(cssRules) {\n    return cssRules\n        .filter(function (rule) { return rule.type === CSSRule.FONT_FACE_RULE; })\n        .filter(function (rule) { return embedResources_1.shouldEmbed(rule.style.getPropertyValue('src')); });\n}\nfunction parseWebFontRules(clonedNode) {\n    return new Promise(function (resolve, reject) {\n        if (!clonedNode.ownerDocument) {\n            reject(new Error('Provided element is not within a Document'));\n        }\n        resolve(utils_1.toArray(clonedNode.ownerDocument.styleSheets));\n    })\n        .then(getCssRules)\n        .then(getWebFontRules);\n}\nexports.parseWebFontRules = parseWebFontRules;\nfunction embedWebFonts(clonedNode, options) {\n    return parseWebFontRules(clonedNode)\n        .then(function (rules) { return Promise.all(rules.map(function (rule) {\n        var baseUrl = rule.parentStyleSheet ? rule.parentStyleSheet.href : null;\n        return embedResources_1.default(rule.cssText, baseUrl, options);\n    })); })\n        .then(function (cssStrings) { return cssStrings.join('\\n'); })\n        .then(function (cssString) {\n        var styleNode = document.createElement('style');\n        var sytleContent = document.createTextNode(cssString);\n        styleNode.appendChild(sytleContent);\n        if (clonedNode.firstChild) {\n            clonedNode.insertBefore(styleNode, clonedNode.firstChild);\n        }\n        else {\n            clonedNode.appendChild(styleNode);\n        }\n        return clonedNode;\n    });\n}\nexports.default = embedWebFonts;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nvar getBlobFromURL_1 = __importDefault(require(\"./getBlobFromURL\"));\nvar embedResources_1 = __importDefault(require(\"./embedResources\"));\nfunction embedBackground(clonedNode, options) {\n    var background = clonedNode.style.getPropertyValue('background');\n    if (!background) {\n        return Promise.resolve(clonedNode);\n    }\n    return Promise.resolve(background)\n        .then(function (cssString) { return embedResources_1.default(cssString, null, options); })\n        .then(function (cssString) {\n        clonedNode.style.setProperty('background', cssString, clonedNode.style.getPropertyPriority('background'));\n        return clonedNode;\n    });\n}\nfunction embedImageNode(clonedNode, options) {\n    if (!(clonedNode instanceof HTMLImageElement) || utils_1.isDataUrl(clonedNode.src)) {\n        return Promise.resolve(clonedNode);\n    }\n    return Promise.resolve(clonedNode.src)\n        .then(function (url) { return getBlobFromURL_1.default(url, options); })\n        .then(function (data) { return utils_1.toDataURL(data, utils_1.getMimeType(clonedNode.src)); })\n        .then(function (dataURL) { return new Promise((function (resolve, reject) {\n        clonedNode.onload = resolve;\n        clonedNode.onerror = reject;\n        clonedNode.src = dataURL;\n    })); })\n        .then(function () { return clonedNode; }, function () { return clonedNode; });\n}\nfunction embedChildren(clonedNode, options) {\n    var children = utils_1.toArray(clonedNode.childNodes);\n    var deferreds = children.map(function (child) { return embedImages(child, options); });\n    return Promise.all(deferreds).then(function () { return clonedNode; });\n}\nfunction embedImages(clonedNode, options) {\n    if (!(clonedNode instanceof Element)) {\n        return Promise.resolve(clonedNode);\n    }\n    return Promise.resolve(clonedNode)\n        .then(function (node) { return embedBackground(node, options); })\n        .then(function (node) { return embedImageNode(node, options); })\n        .then(function (node) { return embedChildren(node, options); });\n}\nexports.default = embedImages;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar utils_1 = require(\"./utils\");\nfunction createSvgDataURL(clonedNode, width, height) {\n    var xmlns = 'http://www.w3.org/2000/svg';\n    var svg = document.createElementNS(xmlns, 'svg');\n    var foreignObject = document.createElementNS(xmlns, 'foreignObject');\n    svg.setAttributeNS('', 'width', \"\" + width);\n    svg.setAttributeNS('', 'height', \"\" + height);\n    foreignObject.setAttributeNS('', 'width', '100%');\n    foreignObject.setAttributeNS('', 'height', '100%');\n    foreignObject.setAttributeNS('', 'x', '0');\n    foreignObject.setAttributeNS('', 'y', '0');\n    foreignObject.setAttributeNS('', 'externalResourcesRequired', 'true');\n    svg.appendChild(foreignObject);\n    foreignObject.appendChild(clonedNode);\n    return utils_1.svgToDataURL(svg);\n}\nexports.default = createSvgDataURL;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction applyStyleWithOptions(clonedNode, options) {\n    var style = clonedNode.style;\n    if (options.backgroundColor) {\n        style.backgroundColor = options.backgroundColor;\n    }\n    if (options.width) {\n        style.width = options.width + \"px\";\n    }\n    if (options.height) {\n        style.height = options.height + \"px\";\n    }\n    if (options.style) {\n        Object.assign(style, options.style);\n    }\n    return clonedNode;\n}\nexports.default = applyStyleWithOptions;\n"],"sourceRoot":""}