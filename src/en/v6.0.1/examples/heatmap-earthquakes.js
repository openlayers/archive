(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{424:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n(2),i=n(99),o=n(35),u=n(30),s=n(22),d=n(12),l=n(146),f={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},g=["#00f","#0ff","#0f0","#ff0","#f00"];var c=function(e){function t(t){var n=t||{},r=Object(d.a)({},n);delete r.gradient,delete r.radius,delete r.blur,delete r.weight,e.call(this,r),this.gradient_=null,this.addEventListener(Object(o.b)(f.GRADIENT),this.handleGradientChanged_),this.setGradient(n.gradient?n.gradient:g),this.setBlur(void 0!==n.blur?n.blur:15),this.setRadius(void 0!==n.radius?n.radius:8);var a=n.weight?n.weight:"weight";this.weightFunction_="string"==typeof a?function(e){return e.get(a)}:a,this.setRenderOrder(null)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getBlur=function(){return this.get(f.BLUR)},t.prototype.getGradient=function(){return this.get(f.GRADIENT)},t.prototype.getRadius=function(){return this.get(f.RADIUS)},t.prototype.handleGradientChanged_=function(){this.gradient_=function(e){for(var t=Object(u.a)(1,256),n=t.createLinearGradient(0,0,1,256),r=1/(e.length-1),a=0,i=e.length;a<i;++a)n.addColorStop(a*r,e[a]);return t.fillStyle=n,t.fillRect(0,0,1,256),t.canvas}(this.getGradient())},t.prototype.setBlur=function(e){this.set(f.BLUR,e)},t.prototype.setGradient=function(e){this.set(f.GRADIENT,e)},t.prototype.setRadius=function(e){this.set(f.RADIUS,e)},t.prototype.createRenderer=function(){return new l.a(this,{attributes:[{name:"weight",callback:this.weightFunction_}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",uniforms:{u_size:function(){return 2*(this.get(f.RADIUS)+this.get(f.BLUR))}.bind(this),u_blurSlope:function(){return this.get(f.RADIUS)/Math.max(1,this.get(f.BLUR))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:this.gradient_}}]})},t}(s.a),h=n(5),p=n(64),_=n(10),v=document.getElementById("blur"),m=document.getElementById("radius"),x=new c({source:new _.a({url:"data/kml/2012_Earthquakes_Mag5.kml",format:new i.a({extractStyles:!1})}),blur:parseInt(v.value,10),radius:parseInt(m.value,10)});x.getSource().on("addfeature",function(e){var t=e.feature.get("name"),n=parseFloat(t.substr(2));e.feature.set("weight",n-5)});var w=new h.a({source:new p.a({layer:"toner"})}),b=(new r.a({layers:[w,x],target:"map",view:new a.a({center:[0,0],zoom:2})}),function(){x.setBlur(parseInt(v.value,10))});v.addEventListener("input",b),v.addEventListener("change",b);var y=function(){x.setRadius(parseInt(m.value,10))};m.addEventListener("input",y),m.addEventListener("change",y)}},[[424,0]]]);
//# sourceMappingURL=heatmap-earthquakes.js.map