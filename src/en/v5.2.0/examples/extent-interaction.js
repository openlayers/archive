(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{186:function(t,e,n){"use strict";var r=n(20),a=n(38),o=n(97),i=n(28),l=n(43),c=n(6),u=n(9),s=n(26),p=n(34),d=n(49),h=n(18),x=n(13),E=n(70),v={EXTENTCHANGED:"extentchanged"},_=function(t){function ExtentInteractionEvent(e){t.call(this,v.EXTENTCHANGED),this.extent=e}return t&&(ExtentInteractionEvent.__proto__=t),ExtentInteractionEvent.prototype=Object.create(t&&t.prototype),ExtentInteractionEvent.prototype.constructor=ExtentInteractionEvent,ExtentInteractionEvent}(l.a),f=function(t){function ExtentInteraction(e){t.call(this,{handleDownEvent:handleDownEvent,handleDragEvent:handleDragEvent,handleEvent:handleEvent,handleUpEvent:handleUpEvent});var n=e||{};this.extent_=null,this.pointerHandler_=null,this.pixelTolerance_=void 0!==n.pixelTolerance?n.pixelTolerance:10,this.snappedToVertex_=!1,this.extentFeature_=null,this.vertexFeature_=null,e||(e={}),this.extentOverlay_=new h.a({source:new x.b({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.boxStyle?e.boxStyle:function(){var t=Object(E.b)();return function(e,n){return t[u.a.POLYGON]}}(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.vertexOverlay_=new h.a({source:new x.b({useSpatialIndex:!1,wrapX:!!e.wrapX}),style:e.pointerStyle?e.pointerStyle:function(){var t=Object(E.b)();return function(e,n){return t[u.a.POINT]}}(),updateWhileAnimating:!0,updateWhileInteracting:!0}),e.extent&&this.setExtent(e.extent)}return t&&(ExtentInteraction.__proto__=t),ExtentInteraction.prototype=Object.create(t&&t.prototype),ExtentInteraction.prototype.constructor=ExtentInteraction,ExtentInteraction.prototype.snapToVertex_=function(t,e){var n=e.getCoordinateFromPixel(t),r=this.getExtent();if(r){var a=function(t){return[[[t[0],t[1]],[t[0],t[3]]],[[t[0],t[3]],[t[2],t[3]]],[[t[2],t[3]],[t[2],t[1]]],[[t[2],t[1]],[t[0],t[1]]]]}(r);a.sort(function(t,e){return Object(i.k)(n,t)-Object(i.k)(n,e)});var o=a[0],l=Object(i.c)(n,o),c=e.getPixelFromCoordinate(l);if(Object(i.f)(t,c)<=this.pixelTolerance_){var u=e.getPixelFromCoordinate(o[0]),s=e.getPixelFromCoordinate(o[1]),p=Object(i.j)(c,u),d=Object(i.j)(c,s),h=Math.sqrt(Math.min(p,d));return this.snappedToVertex_=h<=this.pixelTolerance_,this.snappedToVertex_&&(l=p>d?o[1]:o[0]),l}}return null},ExtentInteraction.prototype.handlePointerMove_=function(t){var e=t.pixel,n=t.map,r=this.snapToVertex_(e,n);r||(r=n.getCoordinateFromPixel(e)),this.createOrUpdatePointerFeature_(r)},ExtentInteraction.prototype.createOrUpdateExtentFeature_=function(t){var e=this.extentFeature_;return e?t?e.setGeometry(Object(p.d)(t)):e.setGeometry(void 0):(e=t?new r.a(Object(p.d)(t)):new r.a({}),this.extentFeature_=e,this.extentOverlay_.getSource().addFeature(e)),e},ExtentInteraction.prototype.createOrUpdatePointerFeature_=function(t){var e=this.vertexFeature_;e?e.getGeometry().setCoordinates(t):(e=new r.a(new s.a(t)),this.vertexFeature_=e,this.vertexOverlay_.getSource().addFeature(e));return e},ExtentInteraction.prototype.setMap=function(e){this.extentOverlay_.setMap(e),this.vertexOverlay_.setMap(e),t.prototype.setMap.call(this,e)},ExtentInteraction.prototype.getExtent=function(){return this.extent_},ExtentInteraction.prototype.setExtent=function(t){this.extent_=t||null,this.createOrUpdateExtentFeature_(t),this.dispatchEvent(new _(this.extent_))},ExtentInteraction}(d.b);function handleEvent(t){return!(t instanceof o.a)||(t.type!=a.a.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),d.c.call(this,t),!1)}function handleDownEvent(t){var e=t.pixel,n=t.map,r=this.getExtent(),a=this.snapToVertex_(e,n),o=function(t){var e=null,n=null;return t[0]==r[0]?e=r[2]:t[0]==r[2]&&(e=r[0]),t[1]==r[1]?n=r[3]:t[1]==r[3]&&(n=r[1]),null!==e&&null!==n?[e,n]:null};if(a&&r){var i=a[0]==r[0]||a[0]==r[2]?a[0]:null,l=a[1]==r[1]||a[1]==r[3]?a[1]:null;null!==i&&null!==l?this.pointerHandler_=getPointHandler(o(a)):null!==i?this.pointerHandler_=getEdgeHandler(o([i,r[1]]),o([i,r[3]])):null!==l&&(this.pointerHandler_=getEdgeHandler(o([r[0],l]),o([r[2],l])))}else a=n.getCoordinateFromPixel(e),this.setExtent([a[0],a[1],a[0],a[1]]),this.pointerHandler_=getPointHandler(a);return!0}function handleDragEvent(t){if(this.pointerHandler_){var e=t.coordinate;this.setExtent(this.pointerHandler_(e)),this.createOrUpdatePointerFeature_(e)}return!0}function handleUpEvent(t){this.pointerHandler_=null;var e=this.getExtent();return e&&0!==Object(c.u)(e)||this.setExtent(null),!1}function getPointHandler(t){return function(e){return Object(c.b)([t,e])}}function getEdgeHandler(t,e){return t[0]==e[0]?function(n){return Object(c.b)([t,[n[0],e[1]]])}:t[1]==e[1]?function(n){return Object(c.b)([t,[e[0],n[1]]])}:null}e.a=f},261:function(t,e,n){"use strict";n.r(e);var r=n(1),a=n(0),o=n(32),i=n(21),l=n(186),c=n(3),u=n(18),s=n(13),p=n(4),d=new s.b({url:"data/geojson/countries.geojson",format:new i.a}),h=new r.a({layers:[new c.a({source:new p.b}),new u.a({source:d})],target:"map",view:new a.a({center:[0,0],zoom:2})}),x=new l.a({condition:o.j});h.addInteraction(x),x.setActive(!1),window.addEventListener("keydown",function(t){16==t.keyCode&&x.setActive(!0)}),window.addEventListener("keyup",function(t){16==t.keyCode&&x.setActive(!1)})}},[[261,0]]]);
//# sourceMappingURL=extent-interaction.js.map