{"version":3,"sources":["webpack:///./vector-tile-selection.js"],"names":["selection","country","stroke","color","width","fill","selectedCountry","vtLayer","declutter","source","maxZoom","format","idProperty","url","style","map","layers","target","view","center","zoom","multiWorld","selectionLayer","renderMode","getSource","feature","getId","selectElement","document","getElementById","on","event","value","type","getFeatures","pixel","then","features","length","changed","const","fid","startsWith"],"mappings":"4FAAA,0EAQIA,EAAY,GAEVC,EAAU,IAAI,IAAM,CACxBC,OAAQ,IAAI,IAAO,CACjBC,MAAO,OACPC,MAAO,IAETC,KAAM,IAAI,IAAK,CACbF,MAAO,yBAGLG,EAAkB,IAAI,IAAM,CAChCJ,OAAQ,IAAI,IAAO,CACjBC,MAAO,sBACPC,MAAO,IAETC,KAAM,IAAI,IAAK,CACbF,MAAO,0BAILI,EAAU,IAAI,IAAgB,CAClCC,WAAW,EACXC,OAAQ,IAAI,IAAiB,CAC3BC,QAAS,GACTC,OAAQ,IAAI,IAAI,CACdC,WAAY,WAEdC,IAAK,wHAGPC,MAAOb,IAGHc,EAAM,IAAI,IAAI,CAClBC,OAAQ,CACNT,GAEFU,OAAQ,MACRC,KAAM,IAAI,IAAK,CACbC,OAAQ,CAAC,EAAG,GACZC,KAAM,EACNC,YAAY,MAKVC,EAAiB,IAAI,IAAgB,CACzCP,IAAKA,EACLQ,WAAY,SACZd,OAAQF,EAAQiB,YAChBV,MAAO,SAASW,GACd,GAAIA,EAAQC,UAAW1B,EACrB,OAAOM,KAKPqB,EAAgBC,SAASC,eAAe,QAE9Cd,EAAIe,GAAG,CAAC,QAAS,gBAAgB,SAASC,GACZ,uBAAxBJ,EAAcK,OAAiD,gBAAfD,EAAME,MAC9B,uBAAxBN,EAAcK,OAAiD,gBAAfD,EAAME,MAG1D1B,EAAQ2B,YAAYH,EAAMI,OAAOC,MAAK,SAASC,GAC7C,IAAKA,EAASC,OAGZ,OAFAtC,EAAY,QACZsB,EAAeiB,UAGjBC,IAAMf,EAAUY,EAAS,GACzB,GAAKZ,EAAL,CAGAe,IAAMC,EAAMhB,EAAQC,QAEhBC,EAAcK,MAAMU,WAAW,kBACjC1C,EAAY,IAGdA,EAAUyC,GAAOhB,EAEjBH,EAAeiB,mB","file":"vector-tile-selection.js","sourcesContent":["import Map from '../src/ol/Map.js';\nimport View from '../src/ol/View.js';\nimport MVT from '../src/ol/format/MVT.js';\nimport VectorTileLayer from '../src/ol/layer/VectorTile.js';\nimport VectorTileSource from '../src/ol/source/VectorTile.js';\nimport {Fill, Stroke, Style} from '../src/ol/style.js';\n\n// lookup for selection objects\nlet selection = {};\n\nconst country = new Style({\n  stroke: new Stroke({\n    color: 'gray',\n    width: 1\n  }),\n  fill: new Fill({\n    color: 'rgba(20,20,20,0.9)'\n  })\n});\nconst selectedCountry = new Style({\n  stroke: new Stroke({\n    color: 'rgba(200,20,20,0.8)',\n    width: 2\n  }),\n  fill: new Fill({\n    color: 'rgba(200,20,20,0.4)'\n  })\n});\n\nconst vtLayer = new VectorTileLayer({\n  declutter: true,\n  source: new VectorTileSource({\n    maxZoom: 15,\n    format: new MVT({\n      idProperty: 'iso_a3'\n    }),\n    url: 'https://ahocevar.com/geoserver/gwc/service/tms/1.0.0/' +\n      'ne:ne_10m_admin_0_countries@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf'\n  }),\n  style: country\n});\n\nconst map = new Map({\n  layers: [\n    vtLayer\n  ],\n  target: 'map',\n  view: new View({\n    center: [0, 0],\n    zoom: 2,\n    multiWorld: true\n  })\n});\n\n// Selection\nconst selectionLayer = new VectorTileLayer({\n  map: map,\n  renderMode: 'vector',\n  source: vtLayer.getSource(),\n  style: function(feature) {\n    if (feature.getId() in selection) {\n      return selectedCountry;\n    }\n  }\n});\n\nconst selectElement = document.getElementById('type');\n\nmap.on(['click', 'pointermove'], function(event) {\n  if (selectElement.value === 'singleselect-hover' && event.type !== 'pointermove' ||\n      selectElement.value !== 'singleselect-hover' && event.type === 'pointermove') {\n    return;\n  }\n  vtLayer.getFeatures(event.pixel).then(function(features) {\n    if (!features.length) {\n      selection = {};\n      selectionLayer.changed();\n      return;\n    }\n    const feature = features[0];\n    if (!feature) {\n      return;\n    }\n    const fid = feature.getId();\n\n    if (selectElement.value.startsWith('singleselect')) {\n      selection = {};\n    }\n    // add selected feature to lookup\n    selection[fid] = feature;\n\n    selectionLayer.changed();\n  });\n});\n"],"sourceRoot":""}